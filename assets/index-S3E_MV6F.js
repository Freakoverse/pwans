function _mergeNamespaces(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var jsxRuntime={exports:{}},reactJsxRuntime_production={};var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var u in s)u!=="key"&&(a[u]=s[u])}else a=s;return s=a.ref,{$$typeof:e,type:n,key:l,ref:s!==void 0?s:null,props:a}}return reactJsxRuntime_production.Fragment=t,reactJsxRuntime_production.jsx=r,reactJsxRuntime_production.jsxs=r,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),buffer={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$2=0,len=code.length;i$2<len;++i$2)lookup[i$2]=code[i$2],revLookup[code.charCodeAt(i$2)]=i$2;revLookup[45]=62;revLookup[95]=63;function getLens(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function byteLength(e){var t=getLens(e),r=t[0],n=t[1];return(r+n)*3/4-n}function _byteLength(e,t,r){return(t+r)*3/4-r}function toByteArray(e){var t,r=getLens(e),n=r[0],s=r[1],a=new Arr(_byteLength(e,n,s)),l=0,u=s>0?n-4:n,x;for(x=0;x<u;x+=4)t=revLookup[e.charCodeAt(x)]<<18|revLookup[e.charCodeAt(x+1)]<<12|revLookup[e.charCodeAt(x+2)]<<6|revLookup[e.charCodeAt(x+3)],a[l++]=t>>16&255,a[l++]=t>>8&255,a[l++]=t&255;return s===2&&(t=revLookup[e.charCodeAt(x)]<<2|revLookup[e.charCodeAt(x+1)]>>4,a[l++]=t&255),s===1&&(t=revLookup[e.charCodeAt(x)]<<10|revLookup[e.charCodeAt(x+1)]<<4|revLookup[e.charCodeAt(x+2)]>>2,a[l++]=t>>8&255,a[l++]=t&255),a}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[e&63]}function encodeChunk(e,t,r){for(var n,s=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(e[a+2]&255),s.push(tripletToBase64(n));return s.join("")}function fromByteArray(e){for(var t,r=e.length,n=r%3,s=[],a=16383,l=0,u=r-n;l<u;l+=a)s.push(encodeChunk(e,l,l+a>u?u:l+a));return n===1?(t=e[r-1],s.push(lookup[t>>2]+lookup[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],s.push(lookup[t>>10]+lookup[t>>4&63]+lookup[t<<2&63]+"=")),s.join("")}var ieee754={};ieee754.read=function(e,t,r,n,s){var a,l,u=s*8-n-1,x=(1<<u)-1,f=x>>1,p=-7,g=r?s-1:0,y=r?-1:1,w=e[t+g];for(g+=y,a=w&(1<<-p)-1,w>>=-p,p+=u;p>0;a=a*256+e[t+g],g+=y,p-=8);for(l=a&(1<<-p)-1,a>>=-p,p+=n;p>0;l=l*256+e[t+g],g+=y,p-=8);if(a===0)a=1-f;else{if(a===x)return l?NaN:(w?-1:1)*(1/0);l=l+Math.pow(2,n),a=a-f}return(w?-1:1)*l*Math.pow(2,a-n)};ieee754.write=function(e,t,r,n,s,a){var l,u,x,f=a*8-s-1,p=(1<<f)-1,g=p>>1,y=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:a-1,R=n?1:-1,I=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,l=p):(l=Math.floor(Math.log(t)/Math.LN2),t*(x=Math.pow(2,-l))<1&&(l--,x*=2),l+g>=1?t+=y/x:t+=y*Math.pow(2,1-g),t*x>=2&&(l++,x/=2),l+g>=p?(u=0,l=p):l+g>=1?(u=(t*x-1)*Math.pow(2,s),l=l+g):(u=t*Math.pow(2,g-1)*Math.pow(2,s),l=0));s>=8;e[r+w]=u&255,w+=R,u/=256,s-=8);for(l=l<<s|u,f+=s;f>0;e[r+w]=l&255,w+=R,l/=256,f-=8);e[r+w-R]|=I*128};(function(e){const t=base64Js,r=ieee754,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=p,e.SlowBuffer=We,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:a,ArrayBuffer:l,SharedArrayBuffer:u}=globalThis;p.TYPED_ARRAY_SUPPORT=x(),!p.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function x(){try{const yt=new a(1),Je={foo:function(){return 42}};return Object.setPrototypeOf(Je,a.prototype),Object.setPrototypeOf(yt,Je),yt.foo()===42}catch{return!1}}Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.byteOffset}});function f(yt){if(yt>s)throw new RangeError('The value "'+yt+'" is invalid for option "size"');const Je=new a(yt);return Object.setPrototypeOf(Je,p.prototype),Je}function p(yt,Je,ft){if(typeof yt=="number"){if(typeof Je=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return R(yt)}return g(yt,Je,ft)}p.poolSize=8192;function g(yt,Je,ft){if(typeof yt=="string")return I(yt,Je);if(l.isView(yt))return je(yt);if(yt==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof yt);if(cr(yt,l)||yt&&cr(yt.buffer,l)||typeof u<"u"&&(cr(yt,u)||yt&&cr(yt.buffer,u)))return Ve(yt,Je,ft);if(typeof yt=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const or=yt.valueOf&&yt.valueOf();if(or!=null&&or!==yt)return p.from(or,Je,ft);const Ar=q(yt);if(Ar)return Ar;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof yt[Symbol.toPrimitive]=="function")return p.from(yt[Symbol.toPrimitive]("string"),Je,ft);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof yt)}p.from=function(yt,Je,ft){return g(yt,Je,ft)},Object.setPrototypeOf(p.prototype,a.prototype),Object.setPrototypeOf(p,a);function y(yt){if(typeof yt!="number")throw new TypeError('"size" argument must be of type number');if(yt<0)throw new RangeError('The value "'+yt+'" is invalid for option "size"')}function w(yt,Je,ft){return y(yt),yt<=0?f(yt):Je!==void 0?typeof ft=="string"?f(yt).fill(Je,ft):f(yt).fill(Je):f(yt)}p.alloc=function(yt,Je,ft){return w(yt,Je,ft)};function R(yt){return y(yt),f(yt<0?0:$e(yt)|0)}p.allocUnsafe=function(yt){return R(yt)},p.allocUnsafeSlow=function(yt){return R(yt)};function I(yt,Je){if((typeof Je!="string"||Je==="")&&(Je="utf8"),!p.isEncoding(Je))throw new TypeError("Unknown encoding: "+Je);const ft=K(yt,Je)|0;let or=f(ft);const Ar=or.write(yt,Je);return Ar!==ft&&(or=or.slice(0,Ar)),or}function k(yt){const Je=yt.length<0?0:$e(yt.length)|0,ft=f(Je);for(let or=0;or<Je;or+=1)ft[or]=yt[or]&255;return ft}function je(yt){if(cr(yt,a)){const Je=new a(yt);return Ve(Je.buffer,Je.byteOffset,Je.byteLength)}return k(yt)}function Ve(yt,Je,ft){if(Je<0||yt.byteLength<Je)throw new RangeError('"offset" is outside of buffer bounds');if(yt.byteLength<Je+(ft||0))throw new RangeError('"length" is outside of buffer bounds');let or;return Je===void 0&&ft===void 0?or=new a(yt):ft===void 0?or=new a(yt,Je):or=new a(yt,Je,ft),Object.setPrototypeOf(or,p.prototype),or}function q(yt){if(p.isBuffer(yt)){const Je=$e(yt.length)|0,ft=f(Je);return ft.length===0||yt.copy(ft,0,0,Je),ft}if(yt.length!==void 0)return typeof yt.length!="number"||Br(yt.length)?f(0):k(yt);if(yt.type==="Buffer"&&Array.isArray(yt.data))return k(yt.data)}function $e(yt){if(yt>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return yt|0}function We(yt){return+yt!=yt&&(yt=0),p.alloc(+yt)}p.isBuffer=function(Je){return Je!=null&&Je._isBuffer===!0&&Je!==p.prototype},p.compare=function(Je,ft){if(cr(Je,a)&&(Je=p.from(Je,Je.offset,Je.byteLength)),cr(ft,a)&&(ft=p.from(ft,ft.offset,ft.byteLength)),!p.isBuffer(Je)||!p.isBuffer(ft))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Je===ft)return 0;let or=Je.length,Ar=ft.length;for(let _r=0,Nr=Math.min(or,Ar);_r<Nr;++_r)if(Je[_r]!==ft[_r]){or=Je[_r],Ar=ft[_r];break}return or<Ar?-1:Ar<or?1:0},p.isEncoding=function(Je){switch(String(Je).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(Je,ft){if(!Array.isArray(Je))throw new TypeError('"list" argument must be an Array of Buffers');if(Je.length===0)return p.alloc(0);let or;if(ft===void 0)for(ft=0,or=0;or<Je.length;++or)ft+=Je[or].length;const Ar=p.allocUnsafe(ft);let _r=0;for(or=0;or<Je.length;++or){let Nr=Je[or];if(cr(Nr,a))_r+Nr.length>Ar.length?(p.isBuffer(Nr)||(Nr=p.from(Nr)),Nr.copy(Ar,_r)):a.prototype.set.call(Ar,Nr,_r);else if(p.isBuffer(Nr))Nr.copy(Ar,_r);else throw new TypeError('"list" argument must be an Array of Buffers');_r+=Nr.length}return Ar};function K(yt,Je){if(p.isBuffer(yt))return yt.length;if(l.isView(yt)||cr(yt,l))return yt.byteLength;if(typeof yt!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof yt);const ft=yt.length,or=arguments.length>2&&arguments[2]===!0;if(!or&&ft===0)return 0;let Ar=!1;for(;;)switch(Je){case"ascii":case"latin1":case"binary":return ft;case"utf8":case"utf-8":return Cr(yt).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ft*2;case"hex":return ft>>>1;case"base64":return Dr(yt).length;default:if(Ar)return or?-1:Cr(yt).length;Je=(""+Je).toLowerCase(),Ar=!0}}p.byteLength=K;function W(yt,Je,ft){let or=!1;if((Je===void 0||Je<0)&&(Je=0),Je>this.length||((ft===void 0||ft>this.length)&&(ft=this.length),ft<=0)||(ft>>>=0,Je>>>=0,ft<=Je))return"";for(yt||(yt="utf8");;)switch(yt){case"hex":return st(this,Je,ft);case"utf8":case"utf-8":return Fe(this,Je,ft);case"ascii":return L(this,Je,ft);case"latin1":case"binary":return O(this,Je,ft);case"base64":return Re(this,Je,ft);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lt(this,Je,ft);default:if(or)throw new TypeError("Unknown encoding: "+yt);yt=(yt+"").toLowerCase(),or=!0}}p.prototype._isBuffer=!0;function Ye(yt,Je,ft){const or=yt[Je];yt[Je]=yt[ft],yt[ft]=or}p.prototype.swap16=function(){const Je=this.length;if(Je%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let ft=0;ft<Je;ft+=2)Ye(this,ft,ft+1);return this},p.prototype.swap32=function(){const Je=this.length;if(Je%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let ft=0;ft<Je;ft+=4)Ye(this,ft,ft+3),Ye(this,ft+1,ft+2);return this},p.prototype.swap64=function(){const Je=this.length;if(Je%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let ft=0;ft<Je;ft+=8)Ye(this,ft,ft+7),Ye(this,ft+1,ft+6),Ye(this,ft+2,ft+5),Ye(this,ft+3,ft+4);return this},p.prototype.toString=function(){const Je=this.length;return Je===0?"":arguments.length===0?Fe(this,0,Je):W.apply(this,arguments)},p.prototype.toLocaleString=p.prototype.toString,p.prototype.equals=function(Je){if(!p.isBuffer(Je))throw new TypeError("Argument must be a Buffer");return this===Je?!0:p.compare(this,Je)===0},p.prototype.inspect=function(){let Je="";const ft=e.INSPECT_MAX_BYTES;return Je=this.toString("hex",0,ft).replace(/(.{2})/g,"$1 ").trim(),this.length>ft&&(Je+=" ... "),"<Buffer "+Je+">"},n&&(p.prototype[n]=p.prototype.inspect),p.prototype.compare=function(Je,ft,or,Ar,_r){if(cr(Je,a)&&(Je=p.from(Je,Je.offset,Je.byteLength)),!p.isBuffer(Je))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Je);if(ft===void 0&&(ft=0),or===void 0&&(or=Je?Je.length:0),Ar===void 0&&(Ar=0),_r===void 0&&(_r=this.length),ft<0||or>Je.length||Ar<0||_r>this.length)throw new RangeError("out of range index");if(Ar>=_r&&ft>=or)return 0;if(Ar>=_r)return-1;if(ft>=or)return 1;if(ft>>>=0,or>>>=0,Ar>>>=0,_r>>>=0,this===Je)return 0;let Nr=_r-Ar,Hr=or-ft;const Gr=Math.min(Nr,Hr),Vr=this.slice(Ar,_r),zr=Je.slice(ft,or);for(let Zr=0;Zr<Gr;++Zr)if(Vr[Zr]!==zr[Zr]){Nr=Vr[Zr],Hr=zr[Zr];break}return Nr<Hr?-1:Hr<Nr?1:0};function Qe(yt,Je,ft,or,Ar){if(yt.length===0)return-1;if(typeof ft=="string"?(or=ft,ft=0):ft>2147483647?ft=2147483647:ft<-2147483648&&(ft=-2147483648),ft=+ft,Br(ft)&&(ft=Ar?0:yt.length-1),ft<0&&(ft=yt.length+ft),ft>=yt.length){if(Ar)return-1;ft=yt.length-1}else if(ft<0)if(Ar)ft=0;else return-1;if(typeof Je=="string"&&(Je=p.from(Je,or)),p.isBuffer(Je))return Je.length===0?-1:it(yt,Je,ft,or,Ar);if(typeof Je=="number")return Je=Je&255,typeof a.prototype.indexOf=="function"?Ar?a.prototype.indexOf.call(yt,Je,ft):a.prototype.lastIndexOf.call(yt,Je,ft):it(yt,[Je],ft,or,Ar);throw new TypeError("val must be string, number or Buffer")}function it(yt,Je,ft,or,Ar){let _r=1,Nr=yt.length,Hr=Je.length;if(or!==void 0&&(or=String(or).toLowerCase(),or==="ucs2"||or==="ucs-2"||or==="utf16le"||or==="utf-16le")){if(yt.length<2||Je.length<2)return-1;_r=2,Nr/=2,Hr/=2,ft/=2}function Gr(zr,Zr){return _r===1?zr[Zr]:zr.readUInt16BE(Zr*_r)}let Vr;if(Ar){let zr=-1;for(Vr=ft;Vr<Nr;Vr++)if(Gr(yt,Vr)===Gr(Je,zr===-1?0:Vr-zr)){if(zr===-1&&(zr=Vr),Vr-zr+1===Hr)return zr*_r}else zr!==-1&&(Vr-=Vr-zr),zr=-1}else for(ft+Hr>Nr&&(ft=Nr-Hr),Vr=ft;Vr>=0;Vr--){let zr=!0;for(let Zr=0;Zr<Hr;Zr++)if(Gr(yt,Vr+Zr)!==Gr(Je,Zr)){zr=!1;break}if(zr)return Vr}return-1}p.prototype.includes=function(Je,ft,or){return this.indexOf(Je,ft,or)!==-1},p.prototype.indexOf=function(Je,ft,or){return Qe(this,Je,ft,or,!0)},p.prototype.lastIndexOf=function(Je,ft,or){return Qe(this,Je,ft,or,!1)};function ze(yt,Je,ft,or){ft=Number(ft)||0;const Ar=yt.length-ft;or?(or=Number(or),or>Ar&&(or=Ar)):or=Ar;const _r=Je.length;or>_r/2&&(or=_r/2);let Nr;for(Nr=0;Nr<or;++Nr){const Hr=parseInt(Je.substr(Nr*2,2),16);if(Br(Hr))return Nr;yt[ft+Nr]=Hr}return Nr}function v(yt,Je,ft,or){return rr(Cr(Je,yt.length-ft),yt,ft,or)}function D(yt,Je,ft,or){return rr(wr(Je),yt,ft,or)}function _e(yt,Je,ft,or){return rr(Dr(Je),yt,ft,or)}function P(yt,Je,ft,or){return rr(kr(Je,yt.length-ft),yt,ft,or)}p.prototype.write=function(Je,ft,or,Ar){if(ft===void 0)Ar="utf8",or=this.length,ft=0;else if(or===void 0&&typeof ft=="string")Ar=ft,or=this.length,ft=0;else if(isFinite(ft))ft=ft>>>0,isFinite(or)?(or=or>>>0,Ar===void 0&&(Ar="utf8")):(Ar=or,or=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const _r=this.length-ft;if((or===void 0||or>_r)&&(or=_r),Je.length>0&&(or<0||ft<0)||ft>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ar||(Ar="utf8");let Nr=!1;for(;;)switch(Ar){case"hex":return ze(this,Je,ft,or);case"utf8":case"utf-8":return v(this,Je,ft,or);case"ascii":case"latin1":case"binary":return D(this,Je,ft,or);case"base64":return _e(this,Je,ft,or);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,Je,ft,or);default:if(Nr)throw new TypeError("Unknown encoding: "+Ar);Ar=(""+Ar).toLowerCase(),Nr=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Re(yt,Je,ft){return Je===0&&ft===yt.length?t.fromByteArray(yt):t.fromByteArray(yt.slice(Je,ft))}function Fe(yt,Je,ft){ft=Math.min(yt.length,ft);const or=[];let Ar=Je;for(;Ar<ft;){const _r=yt[Ar];let Nr=null,Hr=_r>239?4:_r>223?3:_r>191?2:1;if(Ar+Hr<=ft){let Gr,Vr,zr,Zr;switch(Hr){case 1:_r<128&&(Nr=_r);break;case 2:Gr=yt[Ar+1],(Gr&192)===128&&(Zr=(_r&31)<<6|Gr&63,Zr>127&&(Nr=Zr));break;case 3:Gr=yt[Ar+1],Vr=yt[Ar+2],(Gr&192)===128&&(Vr&192)===128&&(Zr=(_r&15)<<12|(Gr&63)<<6|Vr&63,Zr>2047&&(Zr<55296||Zr>57343)&&(Nr=Zr));break;case 4:Gr=yt[Ar+1],Vr=yt[Ar+2],zr=yt[Ar+3],(Gr&192)===128&&(Vr&192)===128&&(zr&192)===128&&(Zr=(_r&15)<<18|(Gr&63)<<12|(Vr&63)<<6|zr&63,Zr>65535&&Zr<1114112&&(Nr=Zr))}}Nr===null?(Nr=65533,Hr=1):Nr>65535&&(Nr-=65536,or.push(Nr>>>10&1023|55296),Nr=56320|Nr&1023),or.push(Nr),Ar+=Hr}return Ce(or)}const Le=4096;function Ce(yt){const Je=yt.length;if(Je<=Le)return String.fromCharCode.apply(String,yt);let ft="",or=0;for(;or<Je;)ft+=String.fromCharCode.apply(String,yt.slice(or,or+=Le));return ft}function L(yt,Je,ft){let or="";ft=Math.min(yt.length,ft);for(let Ar=Je;Ar<ft;++Ar)or+=String.fromCharCode(yt[Ar]&127);return or}function O(yt,Je,ft){let or="";ft=Math.min(yt.length,ft);for(let Ar=Je;Ar<ft;++Ar)or+=String.fromCharCode(yt[Ar]);return or}function st(yt,Je,ft){const or=yt.length;(!Je||Je<0)&&(Je=0),(!ft||ft<0||ft>or)&&(ft=or);let Ar="";for(let _r=Je;_r<ft;++_r)Ar+=br[yt[_r]];return Ar}function lt(yt,Je,ft){const or=yt.slice(Je,ft);let Ar="";for(let _r=0;_r<or.length-1;_r+=2)Ar+=String.fromCharCode(or[_r]+or[_r+1]*256);return Ar}p.prototype.slice=function(Je,ft){const or=this.length;Je=~~Je,ft=ft===void 0?or:~~ft,Je<0?(Je+=or,Je<0&&(Je=0)):Je>or&&(Je=or),ft<0?(ft+=or,ft<0&&(ft=0)):ft>or&&(ft=or),ft<Je&&(ft=Je);const Ar=this.subarray(Je,ft);return Object.setPrototypeOf(Ar,p.prototype),Ar};function Xe(yt,Je,ft){if(yt%1!==0||yt<0)throw new RangeError("offset is not uint");if(yt+Je>ft)throw new RangeError("Trying to access beyond buffer length")}p.prototype.readUintLE=p.prototype.readUIntLE=function(Je,ft,or){Je=Je>>>0,ft=ft>>>0,or||Xe(Je,ft,this.length);let Ar=this[Je],_r=1,Nr=0;for(;++Nr<ft&&(_r*=256);)Ar+=this[Je+Nr]*_r;return Ar},p.prototype.readUintBE=p.prototype.readUIntBE=function(Je,ft,or){Je=Je>>>0,ft=ft>>>0,or||Xe(Je,ft,this.length);let Ar=this[Je+--ft],_r=1;for(;ft>0&&(_r*=256);)Ar+=this[Je+--ft]*_r;return Ar},p.prototype.readUint8=p.prototype.readUInt8=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,1,this.length),this[Je]},p.prototype.readUint16LE=p.prototype.readUInt16LE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,2,this.length),this[Je]|this[Je+1]<<8},p.prototype.readUint16BE=p.prototype.readUInt16BE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,2,this.length),this[Je]<<8|this[Je+1]},p.prototype.readUint32LE=p.prototype.readUInt32LE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,4,this.length),(this[Je]|this[Je+1]<<8|this[Je+2]<<16)+this[Je+3]*16777216},p.prototype.readUint32BE=p.prototype.readUInt32BE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,4,this.length),this[Je]*16777216+(this[Je+1]<<16|this[Je+2]<<8|this[Je+3])},p.prototype.readBigUInt64LE=lr(function(Je){Je=Je>>>0,mr(Je,"offset");const ft=this[Je],or=this[Je+7];(ft===void 0||or===void 0)&&yr(Je,this.length-8);const Ar=ft+this[++Je]*2**8+this[++Je]*2**16+this[++Je]*2**24,_r=this[++Je]+this[++Je]*2**8+this[++Je]*2**16+or*2**24;return BigInt(Ar)+(BigInt(_r)<<BigInt(32))}),p.prototype.readBigUInt64BE=lr(function(Je){Je=Je>>>0,mr(Je,"offset");const ft=this[Je],or=this[Je+7];(ft===void 0||or===void 0)&&yr(Je,this.length-8);const Ar=ft*2**24+this[++Je]*2**16+this[++Je]*2**8+this[++Je],_r=this[++Je]*2**24+this[++Je]*2**16+this[++Je]*2**8+or;return(BigInt(Ar)<<BigInt(32))+BigInt(_r)}),p.prototype.readIntLE=function(Je,ft,or){Je=Je>>>0,ft=ft>>>0,or||Xe(Je,ft,this.length);let Ar=this[Je],_r=1,Nr=0;for(;++Nr<ft&&(_r*=256);)Ar+=this[Je+Nr]*_r;return _r*=128,Ar>=_r&&(Ar-=Math.pow(2,8*ft)),Ar},p.prototype.readIntBE=function(Je,ft,or){Je=Je>>>0,ft=ft>>>0,or||Xe(Je,ft,this.length);let Ar=ft,_r=1,Nr=this[Je+--Ar];for(;Ar>0&&(_r*=256);)Nr+=this[Je+--Ar]*_r;return _r*=128,Nr>=_r&&(Nr-=Math.pow(2,8*ft)),Nr},p.prototype.readInt8=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,1,this.length),this[Je]&128?(255-this[Je]+1)*-1:this[Je]},p.prototype.readInt16LE=function(Je,ft){Je=Je>>>0,ft||Xe(Je,2,this.length);const or=this[Je]|this[Je+1]<<8;return or&32768?or|4294901760:or},p.prototype.readInt16BE=function(Je,ft){Je=Je>>>0,ft||Xe(Je,2,this.length);const or=this[Je+1]|this[Je]<<8;return or&32768?or|4294901760:or},p.prototype.readInt32LE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,4,this.length),this[Je]|this[Je+1]<<8|this[Je+2]<<16|this[Je+3]<<24},p.prototype.readInt32BE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,4,this.length),this[Je]<<24|this[Je+1]<<16|this[Je+2]<<8|this[Je+3]},p.prototype.readBigInt64LE=lr(function(Je){Je=Je>>>0,mr(Je,"offset");const ft=this[Je],or=this[Je+7];(ft===void 0||or===void 0)&&yr(Je,this.length-8);const Ar=this[Je+4]+this[Je+5]*2**8+this[Je+6]*2**16+(or<<24);return(BigInt(Ar)<<BigInt(32))+BigInt(ft+this[++Je]*2**8+this[++Je]*2**16+this[++Je]*2**24)}),p.prototype.readBigInt64BE=lr(function(Je){Je=Je>>>0,mr(Je,"offset");const ft=this[Je],or=this[Je+7];(ft===void 0||or===void 0)&&yr(Je,this.length-8);const Ar=(ft<<24)+this[++Je]*2**16+this[++Je]*2**8+this[++Je];return(BigInt(Ar)<<BigInt(32))+BigInt(this[++Je]*2**24+this[++Je]*2**16+this[++Je]*2**8+or)}),p.prototype.readFloatLE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,4,this.length),r.read(this,Je,!0,23,4)},p.prototype.readFloatBE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,4,this.length),r.read(this,Je,!1,23,4)},p.prototype.readDoubleLE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,8,this.length),r.read(this,Je,!0,52,8)},p.prototype.readDoubleBE=function(Je,ft){return Je=Je>>>0,ft||Xe(Je,8,this.length),r.read(this,Je,!1,52,8)};function dt(yt,Je,ft,or,Ar,_r){if(!p.isBuffer(yt))throw new TypeError('"buffer" argument must be a Buffer instance');if(Je>Ar||Je<_r)throw new RangeError('"value" argument is out of bounds');if(ft+or>yt.length)throw new RangeError("Index out of range")}p.prototype.writeUintLE=p.prototype.writeUIntLE=function(Je,ft,or,Ar){if(Je=+Je,ft=ft>>>0,or=or>>>0,!Ar){const Hr=Math.pow(2,8*or)-1;dt(this,Je,ft,or,Hr,0)}let _r=1,Nr=0;for(this[ft]=Je&255;++Nr<or&&(_r*=256);)this[ft+Nr]=Je/_r&255;return ft+or},p.prototype.writeUintBE=p.prototype.writeUIntBE=function(Je,ft,or,Ar){if(Je=+Je,ft=ft>>>0,or=or>>>0,!Ar){const Hr=Math.pow(2,8*or)-1;dt(this,Je,ft,or,Hr,0)}let _r=or-1,Nr=1;for(this[ft+_r]=Je&255;--_r>=0&&(Nr*=256);)this[ft+_r]=Je/Nr&255;return ft+or},p.prototype.writeUint8=p.prototype.writeUInt8=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,1,255,0),this[ft]=Je&255,ft+1},p.prototype.writeUint16LE=p.prototype.writeUInt16LE=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,2,65535,0),this[ft]=Je&255,this[ft+1]=Je>>>8,ft+2},p.prototype.writeUint16BE=p.prototype.writeUInt16BE=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,2,65535,0),this[ft]=Je>>>8,this[ft+1]=Je&255,ft+2},p.prototype.writeUint32LE=p.prototype.writeUInt32LE=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,4,4294967295,0),this[ft+3]=Je>>>24,this[ft+2]=Je>>>16,this[ft+1]=Je>>>8,this[ft]=Je&255,ft+4},p.prototype.writeUint32BE=p.prototype.writeUInt32BE=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,4,4294967295,0),this[ft]=Je>>>24,this[ft+1]=Je>>>16,this[ft+2]=Je>>>8,this[ft+3]=Je&255,ft+4};function er(yt,Je,ft,or,Ar){gr(Je,or,Ar,yt,ft,7);let _r=Number(Je&BigInt(4294967295));yt[ft++]=_r,_r=_r>>8,yt[ft++]=_r,_r=_r>>8,yt[ft++]=_r,_r=_r>>8,yt[ft++]=_r;let Nr=Number(Je>>BigInt(32)&BigInt(4294967295));return yt[ft++]=Nr,Nr=Nr>>8,yt[ft++]=Nr,Nr=Nr>>8,yt[ft++]=Nr,Nr=Nr>>8,yt[ft++]=Nr,ft}function ar(yt,Je,ft,or,Ar){gr(Je,or,Ar,yt,ft,7);let _r=Number(Je&BigInt(4294967295));yt[ft+7]=_r,_r=_r>>8,yt[ft+6]=_r,_r=_r>>8,yt[ft+5]=_r,_r=_r>>8,yt[ft+4]=_r;let Nr=Number(Je>>BigInt(32)&BigInt(4294967295));return yt[ft+3]=Nr,Nr=Nr>>8,yt[ft+2]=Nr,Nr=Nr>>8,yt[ft+1]=Nr,Nr=Nr>>8,yt[ft]=Nr,ft+8}p.prototype.writeBigUInt64LE=lr(function(Je,ft=0){return er(this,Je,ft,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeBigUInt64BE=lr(function(Je,ft=0){return ar(this,Je,ft,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeIntLE=function(Je,ft,or,Ar){if(Je=+Je,ft=ft>>>0,!Ar){const Gr=Math.pow(2,8*or-1);dt(this,Je,ft,or,Gr-1,-Gr)}let _r=0,Nr=1,Hr=0;for(this[ft]=Je&255;++_r<or&&(Nr*=256);)Je<0&&Hr===0&&this[ft+_r-1]!==0&&(Hr=1),this[ft+_r]=(Je/Nr>>0)-Hr&255;return ft+or},p.prototype.writeIntBE=function(Je,ft,or,Ar){if(Je=+Je,ft=ft>>>0,!Ar){const Gr=Math.pow(2,8*or-1);dt(this,Je,ft,or,Gr-1,-Gr)}let _r=or-1,Nr=1,Hr=0;for(this[ft+_r]=Je&255;--_r>=0&&(Nr*=256);)Je<0&&Hr===0&&this[ft+_r+1]!==0&&(Hr=1),this[ft+_r]=(Je/Nr>>0)-Hr&255;return ft+or},p.prototype.writeInt8=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,1,127,-128),Je<0&&(Je=255+Je+1),this[ft]=Je&255,ft+1},p.prototype.writeInt16LE=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,2,32767,-32768),this[ft]=Je&255,this[ft+1]=Je>>>8,ft+2},p.prototype.writeInt16BE=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,2,32767,-32768),this[ft]=Je>>>8,this[ft+1]=Je&255,ft+2},p.prototype.writeInt32LE=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,4,2147483647,-2147483648),this[ft]=Je&255,this[ft+1]=Je>>>8,this[ft+2]=Je>>>16,this[ft+3]=Je>>>24,ft+4},p.prototype.writeInt32BE=function(Je,ft,or){return Je=+Je,ft=ft>>>0,or||dt(this,Je,ft,4,2147483647,-2147483648),Je<0&&(Je=4294967295+Je+1),this[ft]=Je>>>24,this[ft+1]=Je>>>16,this[ft+2]=Je>>>8,this[ft+3]=Je&255,ft+4},p.prototype.writeBigInt64LE=lr(function(Je,ft=0){return er(this,Je,ft,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),p.prototype.writeBigInt64BE=lr(function(Je,ft=0){return ar(this,Je,ft,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function dr(yt,Je,ft,or,Ar,_r){if(ft+or>yt.length)throw new RangeError("Index out of range");if(ft<0)throw new RangeError("Index out of range")}function ir(yt,Je,ft,or,Ar){return Je=+Je,ft=ft>>>0,Ar||dr(yt,Je,ft,4),r.write(yt,Je,ft,or,23,4),ft+4}p.prototype.writeFloatLE=function(Je,ft,or){return ir(this,Je,ft,!0,or)},p.prototype.writeFloatBE=function(Je,ft,or){return ir(this,Je,ft,!1,or)};function pt(yt,Je,ft,or,Ar){return Je=+Je,ft=ft>>>0,Ar||dr(yt,Je,ft,8),r.write(yt,Je,ft,or,52,8),ft+8}p.prototype.writeDoubleLE=function(Je,ft,or){return pt(this,Je,ft,!0,or)},p.prototype.writeDoubleBE=function(Je,ft,or){return pt(this,Je,ft,!1,or)},p.prototype.copy=function(Je,ft,or,Ar){if(!p.isBuffer(Je))throw new TypeError("argument should be a Buffer");if(or||(or=0),!Ar&&Ar!==0&&(Ar=this.length),ft>=Je.length&&(ft=Je.length),ft||(ft=0),Ar>0&&Ar<or&&(Ar=or),Ar===or||Je.length===0||this.length===0)return 0;if(ft<0)throw new RangeError("targetStart out of bounds");if(or<0||or>=this.length)throw new RangeError("Index out of range");if(Ar<0)throw new RangeError("sourceEnd out of bounds");Ar>this.length&&(Ar=this.length),Je.length-ft<Ar-or&&(Ar=Je.length-ft+or);const _r=Ar-or;return this===Je&&typeof a.prototype.copyWithin=="function"?this.copyWithin(ft,or,Ar):a.prototype.set.call(Je,this.subarray(or,Ar),ft),_r},p.prototype.fill=function(Je,ft,or,Ar){if(typeof Je=="string"){if(typeof ft=="string"?(Ar=ft,ft=0,or=this.length):typeof or=="string"&&(Ar=or,or=this.length),Ar!==void 0&&typeof Ar!="string")throw new TypeError("encoding must be a string");if(typeof Ar=="string"&&!p.isEncoding(Ar))throw new TypeError("Unknown encoding: "+Ar);if(Je.length===1){const Nr=Je.charCodeAt(0);(Ar==="utf8"&&Nr<128||Ar==="latin1")&&(Je=Nr)}}else typeof Je=="number"?Je=Je&255:typeof Je=="boolean"&&(Je=Number(Je));if(ft<0||this.length<ft||this.length<or)throw new RangeError("Out of range index");if(or<=ft)return this;ft=ft>>>0,or=or===void 0?this.length:or>>>0,Je||(Je=0);let _r;if(typeof Je=="number")for(_r=ft;_r<or;++_r)this[_r]=Je;else{const Nr=p.isBuffer(Je)?Je:p.from(Je,Ar),Hr=Nr.length;if(Hr===0)throw new TypeError('The value "'+Je+'" is invalid for argument "value"');for(_r=0;_r<or-ft;++_r)this[_r+ft]=Nr[_r%Hr]}return this};const tr={};function sr(yt,Je,ft){tr[yt]=class extends ft{constructor(){super(),Object.defineProperty(this,"message",{value:Je.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${yt}]`,this.stack,delete this.name}get code(){return yt}set code(Ar){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ar,writable:!0})}toString(){return`${this.name} [${yt}]: ${this.message}`}}}sr("ERR_BUFFER_OUT_OF_BOUNDS",function(yt){return yt?`${yt} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),sr("ERR_INVALID_ARG_TYPE",function(yt,Je){return`The "${yt}" argument must be of type number. Received type ${typeof Je}`},TypeError),sr("ERR_OUT_OF_RANGE",function(yt,Je,ft){let or=`The value of "${yt}" is out of range.`,Ar=ft;return Number.isInteger(ft)&&Math.abs(ft)>2**32?Ar=nr(String(ft)):typeof ft=="bigint"&&(Ar=String(ft),(ft>BigInt(2)**BigInt(32)||ft<-(BigInt(2)**BigInt(32)))&&(Ar=nr(Ar)),Ar+="n"),or+=` It must be ${Je}. Received ${Ar}`,or},RangeError);function nr(yt){let Je="",ft=yt.length;const or=yt[0]==="-"?1:0;for(;ft>=or+4;ft-=3)Je=`_${yt.slice(ft-3,ft)}${Je}`;return`${yt.slice(0,ft)}${Je}`}function pr(yt,Je,ft){mr(Je,"offset"),(yt[Je]===void 0||yt[Je+ft]===void 0)&&yr(Je,yt.length-(ft+1))}function gr(yt,Je,ft,or,Ar,_r){if(yt>ft||yt<Je){const Nr=typeof Je=="bigint"?"n":"";let Hr;throw Je===0||Je===BigInt(0)?Hr=`>= 0${Nr} and < 2${Nr} ** ${(_r+1)*8}${Nr}`:Hr=`>= -(2${Nr} ** ${(_r+1)*8-1}${Nr}) and < 2 ** ${(_r+1)*8-1}${Nr}`,new tr.ERR_OUT_OF_RANGE("value",Hr,yt)}pr(or,Ar,_r)}function mr(yt,Je){if(typeof yt!="number")throw new tr.ERR_INVALID_ARG_TYPE(Je,"number",yt)}function yr(yt,Je,ft){throw Math.floor(yt)!==yt?(mr(yt,ft),new tr.ERR_OUT_OF_RANGE("offset","an integer",yt)):Je<0?new tr.ERR_BUFFER_OUT_OF_BOUNDS:new tr.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${Je}`,yt)}const Er=/[^+/0-9A-Za-z-_]/g;function xr(yt){if(yt=yt.split("=")[0],yt=yt.trim().replace(Er,""),yt.length<2)return"";for(;yt.length%4!==0;)yt=yt+"=";return yt}function Cr(yt,Je){Je=Je||1/0;let ft;const or=yt.length;let Ar=null;const _r=[];for(let Nr=0;Nr<or;++Nr){if(ft=yt.charCodeAt(Nr),ft>55295&&ft<57344){if(!Ar){if(ft>56319){(Je-=3)>-1&&_r.push(239,191,189);continue}else if(Nr+1===or){(Je-=3)>-1&&_r.push(239,191,189);continue}Ar=ft;continue}if(ft<56320){(Je-=3)>-1&&_r.push(239,191,189),Ar=ft;continue}ft=(Ar-55296<<10|ft-56320)+65536}else Ar&&(Je-=3)>-1&&_r.push(239,191,189);if(Ar=null,ft<128){if((Je-=1)<0)break;_r.push(ft)}else if(ft<2048){if((Je-=2)<0)break;_r.push(ft>>6|192,ft&63|128)}else if(ft<65536){if((Je-=3)<0)break;_r.push(ft>>12|224,ft>>6&63|128,ft&63|128)}else if(ft<1114112){if((Je-=4)<0)break;_r.push(ft>>18|240,ft>>12&63|128,ft>>6&63|128,ft&63|128)}else throw new Error("Invalid code point")}return _r}function wr(yt){const Je=[];for(let ft=0;ft<yt.length;++ft)Je.push(yt.charCodeAt(ft)&255);return Je}function kr(yt,Je){let ft,or,Ar;const _r=[];for(let Nr=0;Nr<yt.length&&!((Je-=2)<0);++Nr)ft=yt.charCodeAt(Nr),or=ft>>8,Ar=ft%256,_r.push(Ar),_r.push(or);return _r}function Dr(yt){return t.toByteArray(xr(yt))}function rr(yt,Je,ft,or){let Ar;for(Ar=0;Ar<or&&!(Ar+ft>=Je.length||Ar>=yt.length);++Ar)Je[Ar+ft]=yt[Ar];return Ar}function cr(yt,Je){return yt instanceof Je||yt!=null&&yt.constructor!=null&&yt.constructor.name!=null&&yt.constructor.name===Je.name}function Br(yt){return yt!==yt}const br=(function(){const yt="0123456789abcdef",Je=new Array(256);for(let ft=0;ft<16;++ft){const or=ft*16;for(let Ar=0;Ar<16;++Ar)Je[or+Ar]=yt[ft]+yt[Ar]}return Je})();function lr(yt){return typeof BigInt>"u"?Sr:yt}function Sr(){throw new Error("BigInt not supported")}})(buffer);const Buffer=buffer.Buffer,Buffer$1=buffer.Buffer;globalThis.Buffer=Buffer$1;var client={exports:{}};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var browser$2={exports:{}},process=browser$2.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?cachedSetTimeout=setTimeout:cachedSetTimeout=defaultSetTimout}catch{cachedSetTimeout=defaultSetTimout}try{typeof clearTimeout=="function"?cachedClearTimeout=clearTimeout:cachedClearTimeout=defaultClearTimeout}catch{cachedClearTimeout=defaultClearTimeout}})();function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch{try{return cachedSetTimeout.call(null,e,0)}catch{return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch{try{return cachedClearTimeout.call(null,e)}catch{return cachedClearTimeout.call(this,e)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),queue.length===1&&!draining&&runTimeout(drainQueue)};function Item(e,t){this.fun=e,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=!0;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(e){return[]};process.binding=function(e){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(e){throw new Error("process.chdir is not supported")};process.umask=function(){return 0};var browserExports$2=browser$2.exports;const process$1=getDefaultExportFromCjs(browserExports$2);var reactDomClient_production={},scheduler={exports:{}},scheduler_production={};var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(e){function t(Re,Fe){var Le=Re.length;Re.push(Fe);e:for(;0<Le;){var Ce=Le-1>>>1,L=Re[Ce];if(0<s(L,Fe))Re[Ce]=Fe,Re[Le]=L,Le=Ce;else break e}}function r(Re){return Re.length===0?null:Re[0]}function n(Re){if(Re.length===0)return null;var Fe=Re[0],Le=Re.pop();if(Le!==Fe){Re[0]=Le;e:for(var Ce=0,L=Re.length,O=L>>>1;Ce<O;){var st=2*(Ce+1)-1,lt=Re[st],Xe=st+1,dt=Re[Xe];if(0>s(lt,Le))Xe<L&&0>s(dt,lt)?(Re[Ce]=dt,Re[Xe]=Le,Ce=Xe):(Re[Ce]=lt,Re[st]=Le,Ce=st);else if(Xe<L&&0>s(dt,Le))Re[Ce]=dt,Re[Xe]=Le,Ce=Xe;else break e}}return Fe}function s(Re,Fe){var Le=Re.sortIndex-Fe.sortIndex;return Le!==0?Le:Re.id-Fe.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var x=[],f=[],p=1,g=null,y=3,w=!1,R=!1,I=!1,k=!1,je=typeof setTimeout=="function"?setTimeout:null,Ve=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function $e(Re){for(var Fe=r(f);Fe!==null;){if(Fe.callback===null)n(f);else if(Fe.startTime<=Re)n(f),Fe.sortIndex=Fe.expirationTime,t(x,Fe);else break;Fe=r(f)}}function We(Re){if(I=!1,$e(Re),!R)if(r(x)!==null)R=!0,K||(K=!0,v());else{var Fe=r(f);Fe!==null&&P(We,Fe.startTime-Re)}}var K=!1,W=-1,Ye=5,Qe=-1;function it(){return k?!0:!(e.unstable_now()-Qe<Ye)}function ze(){if(k=!1,K){var Re=e.unstable_now();Qe=Re;var Fe=!0;try{e:{R=!1,I&&(I=!1,Ve(W),W=-1),w=!0;var Le=y;try{t:{for($e(Re),g=r(x);g!==null&&!(g.expirationTime>Re&&it());){var Ce=g.callback;if(typeof Ce=="function"){g.callback=null,y=g.priorityLevel;var L=Ce(g.expirationTime<=Re);if(Re=e.unstable_now(),typeof L=="function"){g.callback=L,$e(Re),Fe=!0;break t}g===r(x)&&n(x),$e(Re)}else n(x);g=r(x)}if(g!==null)Fe=!0;else{var O=r(f);O!==null&&P(We,O.startTime-Re),Fe=!1}}break e}finally{g=null,y=Le,w=!1}Fe=void 0}}finally{Fe?v():K=!1}}}var v;if(typeof q=="function")v=function(){q(ze)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,_e=D.port2;D.port1.onmessage=ze,v=function(){_e.postMessage(null)}}else v=function(){je(ze,0)};function P(Re,Fe){W=je(function(){Re(e.unstable_now())},Fe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Re){Re.callback=null},e.unstable_forceFrameRate=function(Re){0>Re||125<Re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ye=0<Re?Math.floor(1e3/Re):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(Re){switch(y){case 1:case 2:case 3:var Fe=3;break;default:Fe=y}var Le=y;y=Fe;try{return Re()}finally{y=Le}},e.unstable_requestPaint=function(){k=!0},e.unstable_runWithPriority=function(Re,Fe){switch(Re){case 1:case 2:case 3:case 4:case 5:break;default:Re=3}var Le=y;y=Re;try{return Fe()}finally{y=Le}},e.unstable_scheduleCallback=function(Re,Fe,Le){var Ce=e.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?Ce+Le:Ce):Le=Ce,Re){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=Le+L,Re={id:p++,callback:Fe,priorityLevel:Re,startTime:Le,expirationTime:L,sortIndex:-1},Le>Ce?(Re.sortIndex=Le,t(f,Re),r(x)===null&&Re===r(f)&&(I?(Ve(W),W=-1):I=!0,P(We,Le-Ce))):(Re.sortIndex=L,t(x,Re),R||w||(R=!0,K||(K=!0,v()))),Re},e.unstable_shouldYield=it,e.unstable_wrapCallback=function(Re){var Fe=y;return function(){var Le=y;y=Fe;try{return Re.apply(this,arguments)}finally{y=Le}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var react={exports:{}},react_production={},hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),y=Symbol.iterator;function w(O){return O===null||typeof O!="object"?null:(O=y&&O[y]||O["@@iterator"],typeof O=="function"?O:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,k={};function je(O,st,lt){this.props=O,this.context=st,this.refs=k,this.updater=lt||R}je.prototype.isReactComponent={},je.prototype.setState=function(O,st){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,st,"setState")},je.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function Ve(){}Ve.prototype=je.prototype;function q(O,st,lt){this.props=O,this.context=st,this.refs=k,this.updater=lt||R}var $e=q.prototype=new Ve;$e.constructor=q,I($e,je.prototype),$e.isPureReactComponent=!0;var We=Array.isArray;function K(){}var W={H:null,A:null,T:null,S:null},Ye=Object.prototype.hasOwnProperty;function Qe(O,st,lt){var Xe=lt.ref;return{$$typeof:e,type:O,key:st,ref:Xe!==void 0?Xe:null,props:lt}}function it(O,st){return Qe(O.type,st,O.props)}function ze(O){return typeof O=="object"&&O!==null&&O.$$typeof===e}function v(O){var st={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(lt){return st[lt]})}var D=/\/+/g;function _e(O,st){return typeof O=="object"&&O!==null&&O.key!=null?v(""+O.key):st.toString(36)}function P(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(K,K):(O.status="pending",O.then(function(st){O.status==="pending"&&(O.status="fulfilled",O.value=st)},function(st){O.status==="pending"&&(O.status="rejected",O.reason=st)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function Re(O,st,lt,Xe,dt){var er=typeof O;(er==="undefined"||er==="boolean")&&(O=null);var ar=!1;if(O===null)ar=!0;else switch(er){case"bigint":case"string":case"number":ar=!0;break;case"object":switch(O.$$typeof){case e:case t:ar=!0;break;case p:return ar=O._init,Re(ar(O._payload),st,lt,Xe,dt)}}if(ar)return dt=dt(O),ar=Xe===""?"."+_e(O,0):Xe,We(dt)?(lt="",ar!=null&&(lt=ar.replace(D,"$&/")+"/"),Re(dt,st,lt,"",function(pt){return pt})):dt!=null&&(ze(dt)&&(dt=it(dt,lt+(dt.key==null||O&&O.key===dt.key?"":(""+dt.key).replace(D,"$&/")+"/")+ar)),st.push(dt)),1;ar=0;var dr=Xe===""?".":Xe+":";if(We(O))for(var ir=0;ir<O.length;ir++)Xe=O[ir],er=dr+_e(Xe,ir),ar+=Re(Xe,st,lt,er,dt);else if(ir=w(O),typeof ir=="function")for(O=ir.call(O),ir=0;!(Xe=O.next()).done;)Xe=Xe.value,er=dr+_e(Xe,ir++),ar+=Re(Xe,st,lt,er,dt);else if(er==="object"){if(typeof O.then=="function")return Re(P(O),st,lt,Xe,dt);throw st=String(O),Error("Objects are not valid as a React child (found: "+(st==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":st)+"). If you meant to render a collection of children, use an array instead.")}return ar}function Fe(O,st,lt){if(O==null)return O;var Xe=[],dt=0;return Re(O,Xe,"","",function(er){return st.call(lt,er,dt++)}),Xe}function Le(O){if(O._status===-1){var st=O._result;st=st(),st.then(function(lt){(O._status===0||O._status===-1)&&(O._status=1,O._result=lt)},function(lt){(O._status===0||O._status===-1)&&(O._status=2,O._result=lt)}),O._status===-1&&(O._status=0,O._result=st)}if(O._status===1)return O._result.default;throw O._result}var Ce=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var st=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(st))return}else if(typeof process$1=="object"&&typeof process$1.emit=="function"){process$1.emit("uncaughtException",O);return}console.error(O)},L={map:Fe,forEach:function(O,st,lt){Fe(O,function(){st.apply(this,arguments)},lt)},count:function(O){var st=0;return Fe(O,function(){st++}),st},toArray:function(O){return Fe(O,function(st){return st})||[]},only:function(O){if(!ze(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return react_production.Activity=g,react_production.Children=L,react_production.Component=je,react_production.Fragment=r,react_production.Profiler=s,react_production.PureComponent=q,react_production.StrictMode=n,react_production.Suspense=x,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=W,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(O){return W.H.useMemoCache(O)}},react_production.cache=function(O){return function(){return O.apply(null,arguments)}},react_production.cacheSignal=function(){return null},react_production.cloneElement=function(O,st,lt){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var Xe=I({},O.props),dt=O.key;if(st!=null)for(er in st.key!==void 0&&(dt=""+st.key),st)!Ye.call(st,er)||er==="key"||er==="__self"||er==="__source"||er==="ref"&&st.ref===void 0||(Xe[er]=st[er]);var er=arguments.length-2;if(er===1)Xe.children=lt;else if(1<er){for(var ar=Array(er),dr=0;dr<er;dr++)ar[dr]=arguments[dr+2];Xe.children=ar}return Qe(O.type,dt,Xe)},react_production.createContext=function(O){return O={$$typeof:l,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:a,_context:O},O},react_production.createElement=function(O,st,lt){var Xe,dt={},er=null;if(st!=null)for(Xe in st.key!==void 0&&(er=""+st.key),st)Ye.call(st,Xe)&&Xe!=="key"&&Xe!=="__self"&&Xe!=="__source"&&(dt[Xe]=st[Xe]);var ar=arguments.length-2;if(ar===1)dt.children=lt;else if(1<ar){for(var dr=Array(ar),ir=0;ir<ar;ir++)dr[ir]=arguments[ir+2];dt.children=dr}if(O&&O.defaultProps)for(Xe in ar=O.defaultProps,ar)dt[Xe]===void 0&&(dt[Xe]=ar[Xe]);return Qe(O,er,dt)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(O){return{$$typeof:u,render:O}},react_production.isValidElement=ze,react_production.lazy=function(O){return{$$typeof:p,_payload:{_status:-1,_result:O},_init:Le}},react_production.memo=function(O,st){return{$$typeof:f,type:O,compare:st===void 0?null:st}},react_production.startTransition=function(O){var st=W.T,lt={};W.T=lt;try{var Xe=O(),dt=W.S;dt!==null&&dt(lt,Xe),typeof Xe=="object"&&Xe!==null&&typeof Xe.then=="function"&&Xe.then(K,Ce)}catch(er){Ce(er)}finally{st!==null&&lt.types!==null&&(st.types=lt.types),W.T=st}},react_production.unstable_useCacheRefresh=function(){return W.H.useCacheRefresh()},react_production.use=function(O){return W.H.use(O)},react_production.useActionState=function(O,st,lt){return W.H.useActionState(O,st,lt)},react_production.useCallback=function(O,st){return W.H.useCallback(O,st)},react_production.useContext=function(O){return W.H.useContext(O)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(O,st){return W.H.useDeferredValue(O,st)},react_production.useEffect=function(O,st){return W.H.useEffect(O,st)},react_production.useEffectEvent=function(O){return W.H.useEffectEvent(O)},react_production.useId=function(){return W.H.useId()},react_production.useImperativeHandle=function(O,st,lt){return W.H.useImperativeHandle(O,st,lt)},react_production.useInsertionEffect=function(O,st){return W.H.useInsertionEffect(O,st)},react_production.useLayoutEffect=function(O,st){return W.H.useLayoutEffect(O,st)},react_production.useMemo=function(O,st){return W.H.useMemo(O,st)},react_production.useOptimistic=function(O,st){return W.H.useOptimistic(O,st)},react_production.useReducer=function(O,st,lt){return W.H.useReducer(O,st,lt)},react_production.useRef=function(O){return W.H.useRef(O)},react_production.useState=function(O){return W.H.useState(O)},react_production.useSyncExternalStore=function(O,st,lt){return W.H.useSyncExternalStore(O,st,lt)},react_production.useTransition=function(){return W.H.useTransition()},react_production.version="19.2.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactDom={exports:{}},reactDom_production={};var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var e=requireReact();function t(x){var f="https://react.dev/errors/"+x;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+x+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(x,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:x,containerInfo:f,implementation:p}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(x,f){if(x==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,reactDom_production.createPortal=function(x,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(x,f,null,p)},reactDom_production.flushSync=function(x){var f=l.T,p=n.p;try{if(l.T=null,n.p=2,x)return x()}finally{l.T=f,n.p=p,n.d.f()}},reactDom_production.preconnect=function(x,f){typeof x=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(x,f))},reactDom_production.prefetchDNS=function(x){typeof x=="string"&&n.d.D(x)},reactDom_production.preinit=function(x,f){if(typeof x=="string"&&f&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,w=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?n.d.S(x,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:w}):p==="script"&&n.d.X(x,{crossOrigin:g,integrity:y,fetchPriority:w,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},reactDom_production.preinitModule=function(x,f){if(typeof x=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);n.d.M(x,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(x)},reactDom_production.preload=function(x,f){if(typeof x=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin);n.d.L(x,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},reactDom_production.preloadModule=function(x,f){if(typeof x=="string")if(f){var p=u(f.as,f.crossOrigin);n.d.m(x,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(x)},reactDom_production.requestFormReset=function(x){n.d.r(x)},reactDom_production.unstable_batchedUpdates=function(x,f){return x(f)},reactDom_production.useFormState=function(x,f,p){return l.H.useFormState(x,f,p)},reactDom_production.useFormStatus=function(){return l.H.useHostTransitionStatus()},reactDom_production.version="19.2.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),reactDom.exports=requireReactDom_production(),reactDom.exports}var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var e=requireScheduler(),t=requireReact(),r=requireReactDom();function n(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)c+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function a(o){var c=o,m=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(m=c.return),o=c.return;while(o)}return c.tag===3?m:null}function l(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function u(o){if(o.tag===31){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function x(o){if(a(o)!==o)throw Error(n(188))}function f(o){var c=o.alternate;if(!c){if(c=a(o),c===null)throw Error(n(188));return c!==o?null:o}for(var m=o,b=c;;){var Se=m.return;if(Se===null)break;var Ge=Se.alternate;if(Ge===null){if(b=Se.return,b!==null){m=b;continue}break}if(Se.child===Ge.child){for(Ge=Se.child;Ge;){if(Ge===m)return x(Se),o;if(Ge===b)return x(Se),c;Ge=Ge.sibling}throw Error(n(188))}if(m.return!==b.return)m=Se,b=Ge;else{for(var Ot=!1,hr=Se.child;hr;){if(hr===m){Ot=!0,m=Se,b=Ge;break}if(hr===b){Ot=!0,b=Se,m=Ge;break}hr=hr.sibling}if(!Ot){for(hr=Ge.child;hr;){if(hr===m){Ot=!0,m=Ge,b=Se;break}if(hr===b){Ot=!0,b=Ge,m=Se;break}hr=hr.sibling}if(!Ot)throw Error(n(189))}}if(m.alternate!==b)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?o:c}function p(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=p(o),c!==null)return c;o=o.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),R=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),je=Symbol.for("react.profiler"),Ve=Symbol.for("react.consumer"),q=Symbol.for("react.context"),$e=Symbol.for("react.forward_ref"),We=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),Ye=Symbol.for("react.lazy"),Qe=Symbol.for("react.activity"),it=Symbol.for("react.memo_cache_sentinel"),ze=Symbol.iterator;function v(o){return o===null||typeof o!="object"?null:(o=ze&&o[ze]||o["@@iterator"],typeof o=="function"?o:null)}var D=Symbol.for("react.client.reference");function _e(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===D?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case I:return"Fragment";case je:return"Profiler";case k:return"StrictMode";case We:return"Suspense";case K:return"SuspenseList";case Qe:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case R:return"Portal";case q:return o.displayName||"Context";case Ve:return(o._context.displayName||"Context")+".Consumer";case $e:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case W:return c=o.displayName||null,c!==null?c:_e(o.type)||"Memo";case Ye:c=o._payload,o=o._init;try{return _e(o(c))}catch{}}return null}var P=Array.isArray,Re=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Fe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Le={pending:!1,data:null,method:null,action:null},Ce=[],L=-1;function O(o){return{current:o}}function st(o){0>L||(o.current=Ce[L],Ce[L]=null,L--)}function lt(o,c){L++,Ce[L]=o.current,o.current=c}var Xe=O(null),dt=O(null),er=O(null),ar=O(null);function dr(o,c){switch(lt(er,c),lt(dt,o),lt(Xe,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?Qx(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=Qx(c),o=Jx(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}st(Xe),lt(Xe,o)}function ir(){st(Xe),st(dt),st(er)}function pt(o){o.memoizedState!==null&&lt(ar,o);var c=Xe.current,m=Jx(c,o.type);c!==m&&(lt(dt,o),lt(Xe,m))}function tr(o){dt.current===o&&(st(Xe),st(dt)),ar.current===o&&(st(ar),ma._currentValue=Le)}var sr,nr;function pr(o){if(sr===void 0)try{throw Error()}catch(m){var c=m.stack.trim().match(/\n( *(at )?)/);sr=c&&c[1]||"",nr=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+sr+o+nr}var gr=!1;function mr(o,c){if(!o||gr)return"";gr=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(c){var Kr=function(){throw Error()};if(Object.defineProperty(Kr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Kr,[])}catch(Ur){var Mr=Ur}Reflect.construct(o,[],Kr)}else{try{Kr.call()}catch(Ur){Mr=Ur}o.call(Kr.prototype)}}else{try{throw Error()}catch(Ur){Mr=Ur}(Kr=o())&&typeof Kr.catch=="function"&&Kr.catch(function(){})}}catch(Ur){if(Ur&&Mr&&typeof Ur.stack=="string")return[Ur.stack,Mr.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var Se=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");Se&&Se.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Ge=b.DetermineComponentFrameRoot(),Ot=Ge[0],hr=Ge[1];if(Ot&&hr){var Rr=Ot.split(`
`),Ir=hr.split(`
`);for(Se=b=0;b<Rr.length&&!Rr[b].includes("DetermineComponentFrameRoot");)b++;for(;Se<Ir.length&&!Ir[Se].includes("DetermineComponentFrameRoot");)Se++;if(b===Rr.length||Se===Ir.length)for(b=Rr.length-1,Se=Ir.length-1;1<=b&&0<=Se&&Rr[b]!==Ir[Se];)Se--;for(;1<=b&&0<=Se;b--,Se--)if(Rr[b]!==Ir[Se]){if(b!==1||Se!==1)do if(b--,Se--,0>Se||Rr[b]!==Ir[Se]){var Lr=`
`+Rr[b].replace(" at new "," at ");return o.displayName&&Lr.includes("<anonymous>")&&(Lr=Lr.replace("<anonymous>",o.displayName)),Lr}while(1<=b&&0<=Se);break}}}finally{gr=!1,Error.prepareStackTrace=m}return(m=o?o.displayName||o.name:"")?pr(m):""}function yr(o,c){switch(o.tag){case 26:case 27:case 5:return pr(o.type);case 16:return pr("Lazy");case 13:return o.child!==c&&c!==null?pr("Suspense Fallback"):pr("Suspense");case 19:return pr("SuspenseList");case 0:case 15:return mr(o.type,!1);case 11:return mr(o.type.render,!1);case 1:return mr(o.type,!0);case 31:return pr("Activity");default:return""}}function Er(o){try{var c="",m=null;do c+=yr(o,m),m=o,o=o.return;while(o);return c}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}var xr=Object.prototype.hasOwnProperty,Cr=e.unstable_scheduleCallback,wr=e.unstable_cancelCallback,kr=e.unstable_shouldYield,Dr=e.unstable_requestPaint,rr=e.unstable_now,cr=e.unstable_getCurrentPriorityLevel,Br=e.unstable_ImmediatePriority,br=e.unstable_UserBlockingPriority,lr=e.unstable_NormalPriority,Sr=e.unstable_LowPriority,yt=e.unstable_IdlePriority,Je=e.log,ft=e.unstable_setDisableYieldValue,or=null,Ar=null;function _r(o){if(typeof Je=="function"&&ft(o),Ar&&typeof Ar.setStrictMode=="function")try{Ar.setStrictMode(or,o)}catch{}}var Nr=Math.clz32?Math.clz32:Vr,Hr=Math.log,Gr=Math.LN2;function Vr(o){return o>>>=0,o===0?32:31-(Hr(o)/Gr|0)|0}var zr=256,Zr=262144,xn=4194304;function nn(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Yn(o,c,m){var b=o.pendingLanes;if(b===0)return 0;var Se=0,Ge=o.suspendedLanes,Ot=o.pingedLanes;o=o.warmLanes;var hr=b&134217727;return hr!==0?(b=hr&~Ge,b!==0?Se=nn(b):(Ot&=hr,Ot!==0?Se=nn(Ot):m||(m=hr&~o,m!==0&&(Se=nn(m))))):(hr=b&~Ge,hr!==0?Se=nn(hr):Ot!==0?Se=nn(Ot):m||(m=b&~o,m!==0&&(Se=nn(m)))),Se===0?0:c!==0&&c!==Se&&(c&Ge)===0&&(Ge=Se&-Se,m=c&-c,Ge>=m||Ge===32&&(m&4194048)!==0)?c:Se}function vn(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function gn(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ai(){var o=xn;return xn<<=1,(xn&62914560)===0&&(xn=4194304),o}function fr(o){for(var c=[],m=0;31>m;m++)c.push(o);return c}function ht(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Ft(o,c,m,b,Se,Ge){var Ot=o.pendingLanes;o.pendingLanes=m,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=m,o.entangledLanes&=m,o.errorRecoveryDisabledLanes&=m,o.shellSuspendCounter=0;var hr=o.entanglements,Rr=o.expirationTimes,Ir=o.hiddenUpdates;for(m=Ot&~m;0<m;){var Lr=31-Nr(m),Kr=1<<Lr;hr[Lr]=0,Rr[Lr]=-1;var Mr=Ir[Lr];if(Mr!==null)for(Ir[Lr]=null,Lr=0;Lr<Mr.length;Lr++){var Ur=Mr[Lr];Ur!==null&&(Ur.lane&=-536870913)}m&=~Kr}b!==0&&vr(o,b,0),Ge!==0&&Se===0&&o.tag!==0&&(o.suspendedLanes|=Ge&~(Ot&~c))}function vr(o,c,m){o.pendingLanes|=c,o.suspendedLanes&=~c;var b=31-Nr(c);o.entangledLanes|=c,o.entanglements[b]=o.entanglements[b]|1073741824|m&261930}function jr(o,c){var m=o.entangledLanes|=c;for(o=o.entanglements;m;){var b=31-Nr(m),Se=1<<b;Se&c|o[b]&c&&(o[b]|=c),m&=~Se}}function Pr(o,c){var m=c&-c;return m=(m&42)!==0?1:Or(m),(m&(o.suspendedLanes|c))!==0?0:m}function Or(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Xr(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function An(){var o=Fe.p;return o!==0?o:(o=window.event,o===void 0?32:vd(o.type))}function tn(o,c){var m=Fe.p;try{return Fe.p=o,c()}finally{Fe.p=m}}var Jr=Math.random().toString(36).slice(2),rn="__reactFiber$"+Jr,dn="__reactProps$"+Jr,_n="__reactContainer$"+Jr,Bi="__reactEvents$"+Jr,ko="__reactListeners$"+Jr,Do="__reactHandles$"+Jr,qi="__reactResources$"+Jr,Ts="__reactMarker$"+Jr;function Ci(o){delete o[rn],delete o[dn],delete o[Bi],delete o[ko],delete o[Do]}function Ss(o){var c=o[rn];if(c)return c;for(var m=o.parentNode;m;){if(c=m[_n]||m[rn]){if(m=c.alternate,c.child!==null||m!==null&&m.child!==null)for(o=od(o);o!==null;){if(m=o[rn])return m;o=od(o)}return c}o=m,m=o.parentNode}return null}function _s(o){if(o=o[rn]||o[_n]){var c=o.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return o}return null}function $s(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(n(33))}function Rs(o){var c=o[qi];return c||(c=o[qi]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function jn(o){o[Ts]=!0}var Ki=new Set,zi={};function vs(o,c){ks(o,c),ks(o+"Capture",c)}function ks(o,c){for(zi[o]=c,o=0;o<c.length;o++)Ki.add(c[o])}var No=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vi={},Gi={};function jo(o){return xr.call(Gi,o)?!0:xr.call(Vi,o)?!1:No.test(o)?Gi[o]=!0:(Vi[o]=!0,!1)}function ba(o,c,m){if(jo(c))if(m===null)o.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var b=c.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+m)}}function wa(o,c,m){if(m===null)o.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+m)}}function Is(o,c,m,b){if(b===null)o.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(m);return}o.setAttributeNS(c,m,""+b)}}function fs(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function q0(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function uh(o,c,m){var b=Object.getOwnPropertyDescriptor(o.constructor.prototype,c);if(!o.hasOwnProperty(c)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var Se=b.get,Ge=b.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return Se.call(this)},set:function(Ot){m=""+Ot,Ge.call(this,Ot)}}),Object.defineProperty(o,c,{enumerable:b.enumerable}),{getValue:function(){return m},setValue:function(Ot){m=""+Ot},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function $c(o){if(!o._valueTracker){var c=q0(o)?"checked":"value";o._valueTracker=uh(o,c,""+o[c])}}function K0(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var m=c.getValue(),b="";return o&&(b=q0(o)?o.checked?"true":"false":o.value),o=b,o!==m?(c.setValue(o),!0):!1}function va(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var fh=/[\n"\\]/g;function xs(o){return o.replace(fh,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Ic(o,c,m,b,Se,Ge,Ot,hr){o.name="",Ot!=null&&typeof Ot!="function"&&typeof Ot!="symbol"&&typeof Ot!="boolean"?o.type=Ot:o.removeAttribute("type"),c!=null?Ot==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+fs(c)):o.value!==""+fs(c)&&(o.value=""+fs(c)):Ot!=="submit"&&Ot!=="reset"||o.removeAttribute("value"),c!=null?Mc(o,Ot,fs(c)):m!=null?Mc(o,Ot,fs(m)):b!=null&&o.removeAttribute("value"),Se==null&&Ge!=null&&(o.defaultChecked=!!Ge),Se!=null&&(o.checked=Se&&typeof Se!="function"&&typeof Se!="symbol"),hr!=null&&typeof hr!="function"&&typeof hr!="symbol"&&typeof hr!="boolean"?o.name=""+fs(hr):o.removeAttribute("name")}function z0(o,c,m,b,Se,Ge,Ot,hr){if(Ge!=null&&typeof Ge!="function"&&typeof Ge!="symbol"&&typeof Ge!="boolean"&&(o.type=Ge),c!=null||m!=null){if(!(Ge!=="submit"&&Ge!=="reset"||c!=null)){$c(o);return}m=m!=null?""+fs(m):"",c=c!=null?""+fs(c):m,hr||c===o.value||(o.value=c),o.defaultValue=c}b=b??Se,b=typeof b!="function"&&typeof b!="symbol"&&!!b,o.checked=hr?o.checked:!!b,o.defaultChecked=!!b,Ot!=null&&typeof Ot!="function"&&typeof Ot!="symbol"&&typeof Ot!="boolean"&&(o.name=Ot),$c(o)}function Mc(o,c,m){c==="number"&&va(o.ownerDocument)===o||o.defaultValue===""+m||(o.defaultValue=""+m)}function Wi(o,c,m,b){if(o=o.options,c){c={};for(var Se=0;Se<m.length;Se++)c["$"+m[Se]]=!0;for(m=0;m<o.length;m++)Se=c.hasOwnProperty("$"+o[m].value),o[m].selected!==Se&&(o[m].selected=Se),Se&&b&&(o[m].defaultSelected=!0)}else{for(m=""+fs(m),c=null,Se=0;Se<o.length;Se++){if(o[Se].value===m){o[Se].selected=!0,b&&(o[Se].defaultSelected=!0);return}c!==null||o[Se].disabled||(c=o[Se])}c!==null&&(c.selected=!0)}}function V0(o,c,m){if(c!=null&&(c=""+fs(c),c!==o.value&&(o.value=c),m==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=m!=null?""+fs(m):""}function G0(o,c,m,b){if(c==null){if(b!=null){if(m!=null)throw Error(n(92));if(P(b)){if(1<b.length)throw Error(n(93));b=b[0]}m=b}m==null&&(m=""),c=m}m=fs(c),o.defaultValue=m,b=o.textContent,b===m&&b!==""&&b!==null&&(o.value=b),$c(o)}function Xi(o,c){if(c){var m=o.firstChild;if(m&&m===o.lastChild&&m.nodeType===3){m.nodeValue=c;return}}o.textContent=c}var xh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function W0(o,c,m){var b=c.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?b?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":b?o.setProperty(c,m):typeof m!="number"||m===0||xh.has(c)?c==="float"?o.cssFloat=m:o[c]=(""+m).trim():o[c]=m+"px"}function X0(o,c,m){if(c!=null&&typeof c!="object")throw Error(n(62));if(o=o.style,m!=null){for(var b in m)!m.hasOwnProperty(b)||c!=null&&c.hasOwnProperty(b)||(b.indexOf("--")===0?o.setProperty(b,""):b==="float"?o.cssFloat="":o[b]="");for(var Se in c)b=c[Se],c.hasOwnProperty(Se)&&m[Se]!==b&&W0(o,Se,b)}else for(var Ge in c)c.hasOwnProperty(Ge)&&W0(o,Ge,c[Ge])}function Pc(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Aa(o){return hh.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function Ms(){}var Uc=null;function Oc(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Yi=null,Zi=null;function Y0(o){var c=_s(o);if(c&&(o=c.stateNode)){var m=o[dn]||null;e:switch(o=c.stateNode,c.type){case"input":if(Ic(o,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),c=m.name,m.type==="radio"&&c!=null){for(m=o;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+xs(""+c)+'"][type="radio"]'),c=0;c<m.length;c++){var b=m[c];if(b!==o&&b.form===o.form){var Se=b[dn]||null;if(!Se)throw Error(n(90));Ic(b,Se.value,Se.defaultValue,Se.defaultValue,Se.checked,Se.defaultChecked,Se.type,Se.name)}}for(c=0;c<m.length;c++)b=m[c],b.form===o.form&&K0(b)}break e;case"textarea":V0(o,m.value,m.defaultValue);break e;case"select":c=m.value,c!=null&&Wi(o,!!m.multiple,c,!1)}}}var Lc=!1;function Z0(o,c,m){if(Lc)return o(c,m);Lc=!0;try{var b=o(c);return b}finally{if(Lc=!1,(Yi!==null||Zi!==null)&&(fc(),Yi&&(c=Yi,o=Zi,Zi=Yi=null,Y0(c),o)))for(c=0;c<o.length;c++)Y0(o[c])}}function Fo(o,c){var m=o.stateNode;if(m===null)return null;var b=m[dn]||null;if(b===null)return null;m=b[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(o=o.type,b=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!b;break e;default:o=!1}if(o)return null;if(m&&typeof m!="function")throw Error(n(231,c,typeof m));return m}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hc=!1;if(Ps)try{var To={};Object.defineProperty(To,"passive",{get:function(){Hc=!0}}),window.addEventListener("test",To,To),window.removeEventListener("test",To,To)}catch{Hc=!1}var ei=null,qc=null,Ba=null;function Q0(){if(Ba)return Ba;var o,c=qc,m=c.length,b,Se="value"in ei?ei.value:ei.textContent,Ge=Se.length;for(o=0;o<m&&c[o]===Se[o];o++);var Ot=m-o;for(b=1;b<=Ot&&c[m-b]===Se[Ge-b];b++);return Ba=Se.slice(o,1<b?1-b:void 0)}function Ca(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Sa(){return!0}function J0(){return!1}function Zn(o){function c(m,b,Se,Ge,Ot){this._reactName=m,this._targetInst=Se,this.type=b,this.nativeEvent=Ge,this.target=Ot,this.currentTarget=null;for(var hr in o)o.hasOwnProperty(hr)&&(m=o[hr],this[hr]=m?m(Ge):Ge[hr]);return this.isDefaultPrevented=(Ge.defaultPrevented!=null?Ge.defaultPrevented:Ge.returnValue===!1)?Sa:J0,this.isPropagationStopped=J0,this}return g(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Sa)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Sa)},persist:function(){},isPersistent:Sa}),c}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ra=Zn(Si),$o=g({},Si,{view:0,detail:0}),ph=Zn($o),Kc,zc,Io,ka=g({},$o,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gc,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Io&&(Io&&o.type==="mousemove"?(Kc=o.screenX-Io.screenX,zc=o.screenY-Io.screenY):zc=Kc=0,Io=o),Kc)},movementY:function(o){return"movementY"in o?o.movementY:zc}}),eu=Zn(ka),mh=g({},ka,{dataTransfer:0}),gh=Zn(mh),yh=g({},$o,{relatedTarget:0}),Vc=Zn(yh),Eh=g({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),bh=Zn(Eh),wh=g({},Si,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),vh=Zn(wh),Ah=g({},Si,{data:0}),tu=Zn(Ah),Bh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ch={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _h(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=Sh[o])?!!c[o]:!1}function Gc(){return _h}var Rh=g({},$o,{key:function(o){if(o.key){var c=Bh[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=Ca(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Ch[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gc,charCode:function(o){return o.type==="keypress"?Ca(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Ca(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),kh=Zn(Rh),Dh=g({},ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ru=Zn(Dh),Nh=g({},$o,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gc}),jh=Zn(Nh),Fh=g({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),Th=Zn(Fh),$h=g({},ka,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Ih=Zn($h),Mh=g({},Si,{newState:0,oldState:0}),Ph=Zn(Mh),Uh=[9,13,27,32],Wc=Ps&&"CompositionEvent"in window,Mo=null;Ps&&"documentMode"in document&&(Mo=document.documentMode);var Oh=Ps&&"TextEvent"in window&&!Mo,nu=Ps&&(!Wc||Mo&&8<Mo&&11>=Mo),su=" ",iu=!1;function ou(o,c){switch(o){case"keyup":return Uh.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function au(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Qi=!1;function Lh(o,c){switch(o){case"compositionend":return au(c);case"keypress":return c.which!==32?null:(iu=!0,su);case"textInput":return o=c.data,o===su&&iu?null:o;default:return null}}function Hh(o,c){if(Qi)return o==="compositionend"||!Wc&&ou(o,c)?(o=Q0(),Ba=qc=ei=null,Qi=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return nu&&c.locale!=="ko"?null:c.data;default:return null}}var qh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cu(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!qh[o.type]:c==="textarea"}function lu(o,c,m,b){Yi?Zi?Zi.push(b):Zi=[b]:Yi=b,c=yc(c,"onChange"),0<c.length&&(m=new Ra("onChange","change",null,m,b),o.push({event:m,listeners:c}))}var Po=null,Uo=null;function Kh(o){Vx(o,0)}function Da(o){var c=$s(o);if(K0(c))return o}function uu(o,c){if(o==="change")return c}var fu=!1;if(Ps){var Xc;if(Ps){var Yc="oninput"in document;if(!Yc){var xu=document.createElement("div");xu.setAttribute("oninput","return;"),Yc=typeof xu.oninput=="function"}Xc=Yc}else Xc=!1;fu=Xc&&(!document.documentMode||9<document.documentMode)}function du(){Po&&(Po.detachEvent("onpropertychange",hu),Uo=Po=null)}function hu(o){if(o.propertyName==="value"&&Da(Uo)){var c=[];lu(c,Uo,o,Oc(o)),Z0(Kh,c)}}function zh(o,c,m){o==="focusin"?(du(),Po=c,Uo=m,Po.attachEvent("onpropertychange",hu)):o==="focusout"&&du()}function Vh(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Da(Uo)}function Gh(o,c){if(o==="click")return Da(c)}function Wh(o,c){if(o==="input"||o==="change")return Da(c)}function Xh(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var ns=typeof Object.is=="function"?Object.is:Xh;function Oo(o,c){if(ns(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var m=Object.keys(o),b=Object.keys(c);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var Se=m[b];if(!xr.call(c,Se)||!ns(o[Se],c[Se]))return!1}return!0}function pu(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function mu(o,c){var m=pu(o);o=0;for(var b;m;){if(m.nodeType===3){if(b=o+m.textContent.length,o<=c&&b>=c)return{node:m,offset:c-o};o=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=pu(m)}}function gu(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?gu(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function yu(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=va(o.document);c instanceof o.HTMLIFrameElement;){try{var m=typeof c.contentWindow.location.href=="string"}catch{m=!1}if(m)o=c.contentWindow;else break;c=va(o.document)}return c}function Zc(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var Yh=Ps&&"documentMode"in document&&11>=document.documentMode,Ji=null,Qc=null,Lo=null,Jc=!1;function Eu(o,c,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Jc||Ji==null||Ji!==va(b)||(b=Ji,"selectionStart"in b&&Zc(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),Lo&&Oo(Lo,b)||(Lo=b,b=yc(Qc,"onSelect"),0<b.length&&(c=new Ra("onSelect","select",null,c,m),o.push({event:c,listeners:b}),c.target=Ji)))}function _i(o,c){var m={};return m[o.toLowerCase()]=c.toLowerCase(),m["Webkit"+o]="webkit"+c,m["Moz"+o]="moz"+c,m}var eo={animationend:_i("Animation","AnimationEnd"),animationiteration:_i("Animation","AnimationIteration"),animationstart:_i("Animation","AnimationStart"),transitionrun:_i("Transition","TransitionRun"),transitionstart:_i("Transition","TransitionStart"),transitioncancel:_i("Transition","TransitionCancel"),transitionend:_i("Transition","TransitionEnd")},el={},bu={};Ps&&(bu=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function Ri(o){if(el[o])return el[o];if(!eo[o])return o;var c=eo[o],m;for(m in c)if(c.hasOwnProperty(m)&&m in bu)return el[o]=c[m];return o}var wu=Ri("animationend"),vu=Ri("animationiteration"),Au=Ri("animationstart"),Zh=Ri("transitionrun"),Qh=Ri("transitionstart"),Jh=Ri("transitioncancel"),Bu=Ri("transitionend"),Cu=new Map,tl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");tl.push("scrollEnd");function As(o,c){Cu.set(o,c),vs(c,[o])}var Na=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process$1=="object"&&typeof process$1.emit=="function"){process$1.emit("uncaughtException",o);return}console.error(o)},ds=[],to=0,rl=0;function ja(){for(var o=to,c=rl=to=0;c<o;){var m=ds[c];ds[c++]=null;var b=ds[c];ds[c++]=null;var Se=ds[c];ds[c++]=null;var Ge=ds[c];if(ds[c++]=null,b!==null&&Se!==null){var Ot=b.pending;Ot===null?Se.next=Se:(Se.next=Ot.next,Ot.next=Se),b.pending=Se}Ge!==0&&Su(m,Se,Ge)}}function Fa(o,c,m,b){ds[to++]=o,ds[to++]=c,ds[to++]=m,ds[to++]=b,rl|=b,o.lanes|=b,o=o.alternate,o!==null&&(o.lanes|=b)}function nl(o,c,m,b){return Fa(o,c,m,b),Ta(o)}function ki(o,c){return Fa(o,null,null,c),Ta(o)}function Su(o,c,m){o.lanes|=m;var b=o.alternate;b!==null&&(b.lanes|=m);for(var Se=!1,Ge=o.return;Ge!==null;)Ge.childLanes|=m,b=Ge.alternate,b!==null&&(b.childLanes|=m),Ge.tag===22&&(o=Ge.stateNode,o===null||o._visibility&1||(Se=!0)),o=Ge,Ge=Ge.return;return o.tag===3?(Ge=o.stateNode,Se&&c!==null&&(Se=31-Nr(m),o=Ge.hiddenUpdates,b=o[Se],b===null?o[Se]=[c]:b.push(c),c.lane=m|536870912),Ge):null}function Ta(o){if(50<la)throw la=0,x0=null,Error(n(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var ro={};function ep(o,c,m,b){this.tag=o,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ss(o,c,m,b){return new ep(o,c,m,b)}function sl(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Us(o,c){var m=o.alternate;return m===null?(m=ss(o.tag,c,o.key,o.mode),m.elementType=o.elementType,m.type=o.type,m.stateNode=o.stateNode,m.alternate=o,o.alternate=m):(m.pendingProps=c,m.type=o.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=o.flags&65011712,m.childLanes=o.childLanes,m.lanes=o.lanes,m.child=o.child,m.memoizedProps=o.memoizedProps,m.memoizedState=o.memoizedState,m.updateQueue=o.updateQueue,c=o.dependencies,m.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},m.sibling=o.sibling,m.index=o.index,m.ref=o.ref,m.refCleanup=o.refCleanup,m}function _u(o,c){o.flags&=65011714;var m=o.alternate;return m===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=m.childLanes,o.lanes=m.lanes,o.child=m.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=m.memoizedProps,o.memoizedState=m.memoizedState,o.updateQueue=m.updateQueue,o.type=m.type,c=m.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function $a(o,c,m,b,Se,Ge){var Ot=0;if(b=o,typeof o=="function")sl(o)&&(Ot=1);else if(typeof o=="string")Ot=om(o,m,Xe.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case Qe:return o=ss(31,m,c,Se),o.elementType=Qe,o.lanes=Ge,o;case I:return Di(m.children,Se,Ge,c);case k:Ot=8,Se|=24;break;case je:return o=ss(12,m,c,Se|2),o.elementType=je,o.lanes=Ge,o;case We:return o=ss(13,m,c,Se),o.elementType=We,o.lanes=Ge,o;case K:return o=ss(19,m,c,Se),o.elementType=K,o.lanes=Ge,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case q:Ot=10;break e;case Ve:Ot=9;break e;case $e:Ot=11;break e;case W:Ot=14;break e;case Ye:Ot=16,b=null;break e}Ot=29,m=Error(n(130,o===null?"null":typeof o,"")),b=null}return c=ss(Ot,m,c,Se),c.elementType=o,c.type=b,c.lanes=Ge,c}function Di(o,c,m,b){return o=ss(7,o,b,c),o.lanes=m,o}function il(o,c,m){return o=ss(6,o,null,c),o.lanes=m,o}function Ru(o){var c=ss(18,null,null,0);return c.stateNode=o,c}function ol(o,c,m){return c=ss(4,o.children!==null?o.children:[],o.key,c),c.lanes=m,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var ku=new WeakMap;function hs(o,c){if(typeof o=="object"&&o!==null){var m=ku.get(o);return m!==void 0?m:(c={value:o,source:c,stack:Er(c)},ku.set(o,c),c)}return{value:o,source:c,stack:Er(c)}}var no=[],so=0,Ia=null,Ho=0,ps=[],gs=0,ti=null,Ds=1,Ns="";function Os(o,c){no[so++]=Ho,no[so++]=Ia,Ia=o,Ho=c}function Du(o,c,m){ps[gs++]=Ds,ps[gs++]=Ns,ps[gs++]=ti,ti=o;var b=Ds;o=Ns;var Se=32-Nr(b)-1;b&=~(1<<Se),m+=1;var Ge=32-Nr(c)+Se;if(30<Ge){var Ot=Se-Se%5;Ge=(b&(1<<Ot)-1).toString(32),b>>=Ot,Se-=Ot,Ds=1<<32-Nr(c)+Se|m<<Se|b,Ns=Ge+o}else Ds=1<<Ge|m<<Se|b,Ns=o}function al(o){o.return!==null&&(Os(o,1),Du(o,1,0))}function cl(o){for(;o===Ia;)Ia=no[--so],no[so]=null,Ho=no[--so],no[so]=null;for(;o===ti;)ti=ps[--gs],ps[gs]=null,Ns=ps[--gs],ps[gs]=null,Ds=ps[--gs],ps[gs]=null}function Nu(o,c){ps[gs++]=Ds,ps[gs++]=Ns,ps[gs++]=ti,Ds=c.id,Ns=c.overflow,ti=o}var zn=null,kn=null,hn=!1,ri=null,ys=!1,ll=Error(n(519));function ni(o){var c=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw qo(hs(c,o)),ll}function ju(o){var c=o.stateNode,m=o.type,b=o.memoizedProps;switch(c[rn]=o,c[dn]=b,m){case"dialog":cn("cancel",c),cn("close",c);break;case"iframe":case"object":case"embed":cn("load",c);break;case"video":case"audio":for(m=0;m<fa.length;m++)cn(fa[m],c);break;case"source":cn("error",c);break;case"img":case"image":case"link":cn("error",c),cn("load",c);break;case"details":cn("toggle",c);break;case"input":cn("invalid",c),z0(c,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0);break;case"select":cn("invalid",c);break;case"textarea":cn("invalid",c),G0(c,b.value,b.defaultValue,b.children)}m=b.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||c.textContent===""+m||b.suppressHydrationWarning===!0||Yx(c.textContent,m)?(b.popover!=null&&(cn("beforetoggle",c),cn("toggle",c)),b.onScroll!=null&&cn("scroll",c),b.onScrollEnd!=null&&cn("scrollend",c),b.onClick!=null&&(c.onclick=Ms),c=!0):c=!1,c||ni(o,!0)}function Fu(o){for(zn=o.return;zn;)switch(zn.tag){case 5:case 31:case 13:ys=!1;return;case 27:case 3:ys=!0;return;default:zn=zn.return}}function io(o){if(o!==zn)return!1;if(!hn)return Fu(o),hn=!0,!1;var c=o.tag,m;if((m=c!==3&&c!==27)&&((m=c===5)&&(m=o.type,m=!(m!=="form"&&m!=="button")||_0(o.type,o.memoizedProps)),m=!m),m&&kn&&ni(o),Fu(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));kn=id(o)}else if(c===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));kn=id(o)}else c===27?(c=kn,gi(o.type)?(o=j0,j0=null,kn=o):kn=c):kn=zn?bs(o.stateNode.nextSibling):null;return!0}function Ni(){kn=zn=null,hn=!1}function ul(){var o=ri;return o!==null&&(ts===null?ts=o:ts.push.apply(ts,o),ri=null),o}function qo(o){ri===null?ri=[o]:ri.push(o)}var fl=O(null),ji=null,Ls=null;function si(o,c,m){lt(fl,c._currentValue),c._currentValue=m}function Hs(o){o._currentValue=fl.current,st(fl)}function xl(o,c,m){for(;o!==null;){var b=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,b!==null&&(b.childLanes|=c)):b!==null&&(b.childLanes&c)!==c&&(b.childLanes|=c),o===m)break;o=o.return}}function dl(o,c,m,b){var Se=o.child;for(Se!==null&&(Se.return=o);Se!==null;){var Ge=Se.dependencies;if(Ge!==null){var Ot=Se.child;Ge=Ge.firstContext;e:for(;Ge!==null;){var hr=Ge;Ge=Se;for(var Rr=0;Rr<c.length;Rr++)if(hr.context===c[Rr]){Ge.lanes|=m,hr=Ge.alternate,hr!==null&&(hr.lanes|=m),xl(Ge.return,m,o),b||(Ot=null);break e}Ge=hr.next}}else if(Se.tag===18){if(Ot=Se.return,Ot===null)throw Error(n(341));Ot.lanes|=m,Ge=Ot.alternate,Ge!==null&&(Ge.lanes|=m),xl(Ot,m,o),Ot=null}else Ot=Se.child;if(Ot!==null)Ot.return=Se;else for(Ot=Se;Ot!==null;){if(Ot===o){Ot=null;break}if(Se=Ot.sibling,Se!==null){Se.return=Ot.return,Ot=Se;break}Ot=Ot.return}Se=Ot}}function oo(o,c,m,b){o=null;for(var Se=c,Ge=!1;Se!==null;){if(!Ge){if((Se.flags&524288)!==0)Ge=!0;else if((Se.flags&262144)!==0)break}if(Se.tag===10){var Ot=Se.alternate;if(Ot===null)throw Error(n(387));if(Ot=Ot.memoizedProps,Ot!==null){var hr=Se.type;ns(Se.pendingProps.value,Ot.value)||(o!==null?o.push(hr):o=[hr])}}else if(Se===ar.current){if(Ot=Se.alternate,Ot===null)throw Error(n(387));Ot.memoizedState.memoizedState!==Se.memoizedState.memoizedState&&(o!==null?o.push(ma):o=[ma])}Se=Se.return}o!==null&&dl(c,o,m,b),c.flags|=262144}function Ma(o){for(o=o.firstContext;o!==null;){if(!ns(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Fi(o){ji=o,Ls=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Vn(o){return Tu(ji,o)}function Pa(o,c){return ji===null&&Fi(o),Tu(o,c)}function Tu(o,c){var m=c._currentValue;if(c={context:c,memoizedValue:m,next:null},Ls===null){if(o===null)throw Error(n(308));Ls=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else Ls=Ls.next=c;return m}var tp=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(m,b){o.push(b)}};this.abort=function(){c.aborted=!0,o.forEach(function(m){return m()})}},rp=e.unstable_scheduleCallback,np=e.unstable_NormalPriority,Un={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hl(){return{controller:new tp,data:new Map,refCount:0}}function Ko(o){o.refCount--,o.refCount===0&&rp(np,function(){o.controller.abort()})}var zo=null,pl=0,ao=0,co=null;function sp(o,c){if(zo===null){var m=zo=[];pl=0,ao=y0(),co={status:"pending",value:void 0,then:function(b){m.push(b)}}}return pl++,c.then($u,$u),c}function $u(){if(--pl===0&&zo!==null){co!==null&&(co.status="fulfilled");var o=zo;zo=null,ao=0,co=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function ip(o,c){var m=[],b={status:"pending",value:null,reason:null,then:function(Se){m.push(Se)}};return o.then(function(){b.status="fulfilled",b.value=c;for(var Se=0;Se<m.length;Se++)(0,m[Se])(c)},function(Se){for(b.status="rejected",b.reason=Se,Se=0;Se<m.length;Se++)(0,m[Se])(void 0)}),b}var Iu=Re.S;Re.S=function(o,c){bx=rr(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&sp(o,c),Iu!==null&&Iu(o,c)};var Ti=O(null);function ml(){var o=Ti.current;return o!==null?o:Rn.pooledCache}function Ua(o,c){c===null?lt(Ti,Ti.current):lt(Ti,c.pool)}function Mu(){var o=ml();return o===null?null:{parent:Un._currentValue,pool:o}}var lo=Error(n(460)),gl=Error(n(474)),Oa=Error(n(542)),La={then:function(){}};function Pu(o){return o=o.status,o==="fulfilled"||o==="rejected"}function Uu(o,c,m){switch(m=o[m],m===void 0?o.push(c):m!==c&&(c.then(Ms,Ms),c=m),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,Lu(o),o;default:if(typeof c.status=="string")c.then(Ms,Ms);else{if(o=Rn,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=c,o.status="pending",o.then(function(b){if(c.status==="pending"){var Se=c;Se.status="fulfilled",Se.value=b}},function(b){if(c.status==="pending"){var Se=c;Se.status="rejected",Se.reason=b}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,Lu(o),o}throw Ii=c,lo}}function $i(o){try{var c=o._init;return c(o._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(Ii=m,lo):m}}var Ii=null;function Ou(){if(Ii===null)throw Error(n(459));var o=Ii;return Ii=null,o}function Lu(o){if(o===lo||o===Oa)throw Error(n(483))}var uo=null,Vo=0;function Ha(o){var c=Vo;return Vo+=1,uo===null&&(uo=[]),Uu(uo,o,c)}function Go(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function qa(o,c){throw c.$$typeof===y?Error(n(525)):(o=Object.prototype.toString.call(c),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function Hu(o){function c(Tr,Fr){if(o){var $r=Tr.deletions;$r===null?(Tr.deletions=[Fr],Tr.flags|=16):$r.push(Fr)}}function m(Tr,Fr){if(!o)return null;for(;Fr!==null;)c(Tr,Fr),Fr=Fr.sibling;return null}function b(Tr){for(var Fr=new Map;Tr!==null;)Tr.key!==null?Fr.set(Tr.key,Tr):Fr.set(Tr.index,Tr),Tr=Tr.sibling;return Fr}function Se(Tr,Fr){return Tr=Us(Tr,Fr),Tr.index=0,Tr.sibling=null,Tr}function Ge(Tr,Fr,$r){return Tr.index=$r,o?($r=Tr.alternate,$r!==null?($r=$r.index,$r<Fr?(Tr.flags|=67108866,Fr):$r):(Tr.flags|=67108866,Fr)):(Tr.flags|=1048576,Fr)}function Ot(Tr){return o&&Tr.alternate===null&&(Tr.flags|=67108866),Tr}function hr(Tr,Fr,$r,qr){return Fr===null||Fr.tag!==6?(Fr=il($r,Tr.mode,qr),Fr.return=Tr,Fr):(Fr=Se(Fr,$r),Fr.return=Tr,Fr)}function Rr(Tr,Fr,$r,qr){var Qr=$r.type;return Qr===I?Lr(Tr,Fr,$r.props.children,qr,$r.key):Fr!==null&&(Fr.elementType===Qr||typeof Qr=="object"&&Qr!==null&&Qr.$$typeof===Ye&&$i(Qr)===Fr.type)?(Fr=Se(Fr,$r.props),Go(Fr,$r),Fr.return=Tr,Fr):(Fr=$a($r.type,$r.key,$r.props,null,Tr.mode,qr),Go(Fr,$r),Fr.return=Tr,Fr)}function Ir(Tr,Fr,$r,qr){return Fr===null||Fr.tag!==4||Fr.stateNode.containerInfo!==$r.containerInfo||Fr.stateNode.implementation!==$r.implementation?(Fr=ol($r,Tr.mode,qr),Fr.return=Tr,Fr):(Fr=Se(Fr,$r.children||[]),Fr.return=Tr,Fr)}function Lr(Tr,Fr,$r,qr,Qr){return Fr===null||Fr.tag!==7?(Fr=Di($r,Tr.mode,qr,Qr),Fr.return=Tr,Fr):(Fr=Se(Fr,$r),Fr.return=Tr,Fr)}function Kr(Tr,Fr,$r){if(typeof Fr=="string"&&Fr!==""||typeof Fr=="number"||typeof Fr=="bigint")return Fr=il(""+Fr,Tr.mode,$r),Fr.return=Tr,Fr;if(typeof Fr=="object"&&Fr!==null){switch(Fr.$$typeof){case w:return $r=$a(Fr.type,Fr.key,Fr.props,null,Tr.mode,$r),Go($r,Fr),$r.return=Tr,$r;case R:return Fr=ol(Fr,Tr.mode,$r),Fr.return=Tr,Fr;case Ye:return Fr=$i(Fr),Kr(Tr,Fr,$r)}if(P(Fr)||v(Fr))return Fr=Di(Fr,Tr.mode,$r,null),Fr.return=Tr,Fr;if(typeof Fr.then=="function")return Kr(Tr,Ha(Fr),$r);if(Fr.$$typeof===q)return Kr(Tr,Pa(Tr,Fr),$r);qa(Tr,Fr)}return null}function Mr(Tr,Fr,$r,qr){var Qr=Fr!==null?Fr.key:null;if(typeof $r=="string"&&$r!==""||typeof $r=="number"||typeof $r=="bigint")return Qr!==null?null:hr(Tr,Fr,""+$r,qr);if(typeof $r=="object"&&$r!==null){switch($r.$$typeof){case w:return $r.key===Qr?Rr(Tr,Fr,$r,qr):null;case R:return $r.key===Qr?Ir(Tr,Fr,$r,qr):null;case Ye:return $r=$i($r),Mr(Tr,Fr,$r,qr)}if(P($r)||v($r))return Qr!==null?null:Lr(Tr,Fr,$r,qr,null);if(typeof $r.then=="function")return Mr(Tr,Fr,Ha($r),qr);if($r.$$typeof===q)return Mr(Tr,Fr,Pa(Tr,$r),qr);qa(Tr,$r)}return null}function Ur(Tr,Fr,$r,qr,Qr){if(typeof qr=="string"&&qr!==""||typeof qr=="number"||typeof qr=="bigint")return Tr=Tr.get($r)||null,hr(Fr,Tr,""+qr,Qr);if(typeof qr=="object"&&qr!==null){switch(qr.$$typeof){case w:return Tr=Tr.get(qr.key===null?$r:qr.key)||null,Rr(Fr,Tr,qr,Qr);case R:return Tr=Tr.get(qr.key===null?$r:qr.key)||null,Ir(Fr,Tr,qr,Qr);case Ye:return qr=$i(qr),Ur(Tr,Fr,$r,qr,Qr)}if(P(qr)||v(qr))return Tr=Tr.get($r)||null,Lr(Fr,Tr,qr,Qr,null);if(typeof qr.then=="function")return Ur(Tr,Fr,$r,Ha(qr),Qr);if(qr.$$typeof===q)return Ur(Tr,Fr,$r,Pa(Fr,qr),Qr);qa(Fr,qr)}return null}function Wr(Tr,Fr,$r,qr){for(var Qr=null,pn=null,Yr=Fr,on=Fr=0,fn=null;Yr!==null&&on<$r.length;on++){Yr.index>on?(fn=Yr,Yr=null):fn=Yr.sibling;var mn=Mr(Tr,Yr,$r[on],qr);if(mn===null){Yr===null&&(Yr=fn);break}o&&Yr&&mn.alternate===null&&c(Tr,Yr),Fr=Ge(mn,Fr,on),pn===null?Qr=mn:pn.sibling=mn,pn=mn,Yr=fn}if(on===$r.length)return m(Tr,Yr),hn&&Os(Tr,on),Qr;if(Yr===null){for(;on<$r.length;on++)Yr=Kr(Tr,$r[on],qr),Yr!==null&&(Fr=Ge(Yr,Fr,on),pn===null?Qr=Yr:pn.sibling=Yr,pn=Yr);return hn&&Os(Tr,on),Qr}for(Yr=b(Yr);on<$r.length;on++)fn=Ur(Yr,Tr,on,$r[on],qr),fn!==null&&(o&&fn.alternate!==null&&Yr.delete(fn.key===null?on:fn.key),Fr=Ge(fn,Fr,on),pn===null?Qr=fn:pn.sibling=fn,pn=fn);return o&&Yr.forEach(function(vi){return c(Tr,vi)}),hn&&Os(Tr,on),Qr}function en(Tr,Fr,$r,qr){if($r==null)throw Error(n(151));for(var Qr=null,pn=null,Yr=Fr,on=Fr=0,fn=null,mn=$r.next();Yr!==null&&!mn.done;on++,mn=$r.next()){Yr.index>on?(fn=Yr,Yr=null):fn=Yr.sibling;var vi=Mr(Tr,Yr,mn.value,qr);if(vi===null){Yr===null&&(Yr=fn);break}o&&Yr&&vi.alternate===null&&c(Tr,Yr),Fr=Ge(vi,Fr,on),pn===null?Qr=vi:pn.sibling=vi,pn=vi,Yr=fn}if(mn.done)return m(Tr,Yr),hn&&Os(Tr,on),Qr;if(Yr===null){for(;!mn.done;on++,mn=$r.next())mn=Kr(Tr,mn.value,qr),mn!==null&&(Fr=Ge(mn,Fr,on),pn===null?Qr=mn:pn.sibling=mn,pn=mn);return hn&&Os(Tr,on),Qr}for(Yr=b(Yr);!mn.done;on++,mn=$r.next())mn=Ur(Yr,Tr,on,mn.value,qr),mn!==null&&(o&&mn.alternate!==null&&Yr.delete(mn.key===null?on:mn.key),Fr=Ge(mn,Fr,on),pn===null?Qr=mn:pn.sibling=mn,pn=mn);return o&&Yr.forEach(function(gm){return c(Tr,gm)}),hn&&Os(Tr,on),Qr}function Sn(Tr,Fr,$r,qr){if(typeof $r=="object"&&$r!==null&&$r.type===I&&$r.key===null&&($r=$r.props.children),typeof $r=="object"&&$r!==null){switch($r.$$typeof){case w:e:{for(var Qr=$r.key;Fr!==null;){if(Fr.key===Qr){if(Qr=$r.type,Qr===I){if(Fr.tag===7){m(Tr,Fr.sibling),qr=Se(Fr,$r.props.children),qr.return=Tr,Tr=qr;break e}}else if(Fr.elementType===Qr||typeof Qr=="object"&&Qr!==null&&Qr.$$typeof===Ye&&$i(Qr)===Fr.type){m(Tr,Fr.sibling),qr=Se(Fr,$r.props),Go(qr,$r),qr.return=Tr,Tr=qr;break e}m(Tr,Fr);break}else c(Tr,Fr);Fr=Fr.sibling}$r.type===I?(qr=Di($r.props.children,Tr.mode,qr,$r.key),qr.return=Tr,Tr=qr):(qr=$a($r.type,$r.key,$r.props,null,Tr.mode,qr),Go(qr,$r),qr.return=Tr,Tr=qr)}return Ot(Tr);case R:e:{for(Qr=$r.key;Fr!==null;){if(Fr.key===Qr)if(Fr.tag===4&&Fr.stateNode.containerInfo===$r.containerInfo&&Fr.stateNode.implementation===$r.implementation){m(Tr,Fr.sibling),qr=Se(Fr,$r.children||[]),qr.return=Tr,Tr=qr;break e}else{m(Tr,Fr);break}else c(Tr,Fr);Fr=Fr.sibling}qr=ol($r,Tr.mode,qr),qr.return=Tr,Tr=qr}return Ot(Tr);case Ye:return $r=$i($r),Sn(Tr,Fr,$r,qr)}if(P($r))return Wr(Tr,Fr,$r,qr);if(v($r)){if(Qr=v($r),typeof Qr!="function")throw Error(n(150));return $r=Qr.call($r),en(Tr,Fr,$r,qr)}if(typeof $r.then=="function")return Sn(Tr,Fr,Ha($r),qr);if($r.$$typeof===q)return Sn(Tr,Fr,Pa(Tr,$r),qr);qa(Tr,$r)}return typeof $r=="string"&&$r!==""||typeof $r=="number"||typeof $r=="bigint"?($r=""+$r,Fr!==null&&Fr.tag===6?(m(Tr,Fr.sibling),qr=Se(Fr,$r),qr.return=Tr,Tr=qr):(m(Tr,Fr),qr=il($r,Tr.mode,qr),qr.return=Tr,Tr=qr),Ot(Tr)):m(Tr,Fr)}return function(Tr,Fr,$r,qr){try{Vo=0;var Qr=Sn(Tr,Fr,$r,qr);return uo=null,Qr}catch(Yr){if(Yr===lo||Yr===Oa)throw Yr;var pn=ss(29,Yr,null,Tr.mode);return pn.lanes=qr,pn.return=Tr,pn}finally{}}}var Mi=Hu(!0),qu=Hu(!1),ii=!1;function yl(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function El(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function oi(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function ai(o,c,m){var b=o.updateQueue;if(b===null)return null;if(b=b.shared,(yn&2)!==0){var Se=b.pending;return Se===null?c.next=c:(c.next=Se.next,Se.next=c),b.pending=c,c=Ta(o),Su(o,null,m),c}return Fa(o,b,c,m),Ta(o)}function Wo(o,c,m){if(c=c.updateQueue,c!==null&&(c=c.shared,(m&4194048)!==0)){var b=c.lanes;b&=o.pendingLanes,m|=b,c.lanes=m,jr(o,m)}}function bl(o,c){var m=o.updateQueue,b=o.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var Se=null,Ge=null;if(m=m.firstBaseUpdate,m!==null){do{var Ot={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};Ge===null?Se=Ge=Ot:Ge=Ge.next=Ot,m=m.next}while(m!==null);Ge===null?Se=Ge=c:Ge=Ge.next=c}else Se=Ge=c;m={baseState:b.baseState,firstBaseUpdate:Se,lastBaseUpdate:Ge,shared:b.shared,callbacks:b.callbacks},o.updateQueue=m;return}o=m.lastBaseUpdate,o===null?m.firstBaseUpdate=c:o.next=c,m.lastBaseUpdate=c}var wl=!1;function Xo(){if(wl){var o=co;if(o!==null)throw o}}function Yo(o,c,m,b){wl=!1;var Se=o.updateQueue;ii=!1;var Ge=Se.firstBaseUpdate,Ot=Se.lastBaseUpdate,hr=Se.shared.pending;if(hr!==null){Se.shared.pending=null;var Rr=hr,Ir=Rr.next;Rr.next=null,Ot===null?Ge=Ir:Ot.next=Ir,Ot=Rr;var Lr=o.alternate;Lr!==null&&(Lr=Lr.updateQueue,hr=Lr.lastBaseUpdate,hr!==Ot&&(hr===null?Lr.firstBaseUpdate=Ir:hr.next=Ir,Lr.lastBaseUpdate=Rr))}if(Ge!==null){var Kr=Se.baseState;Ot=0,Lr=Ir=Rr=null,hr=Ge;do{var Mr=hr.lane&-536870913,Ur=Mr!==hr.lane;if(Ur?(un&Mr)===Mr:(b&Mr)===Mr){Mr!==0&&Mr===ao&&(wl=!0),Lr!==null&&(Lr=Lr.next={lane:0,tag:hr.tag,payload:hr.payload,callback:null,next:null});e:{var Wr=o,en=hr;Mr=c;var Sn=m;switch(en.tag){case 1:if(Wr=en.payload,typeof Wr=="function"){Kr=Wr.call(Sn,Kr,Mr);break e}Kr=Wr;break e;case 3:Wr.flags=Wr.flags&-65537|128;case 0:if(Wr=en.payload,Mr=typeof Wr=="function"?Wr.call(Sn,Kr,Mr):Wr,Mr==null)break e;Kr=g({},Kr,Mr);break e;case 2:ii=!0}}Mr=hr.callback,Mr!==null&&(o.flags|=64,Ur&&(o.flags|=8192),Ur=Se.callbacks,Ur===null?Se.callbacks=[Mr]:Ur.push(Mr))}else Ur={lane:Mr,tag:hr.tag,payload:hr.payload,callback:hr.callback,next:null},Lr===null?(Ir=Lr=Ur,Rr=Kr):Lr=Lr.next=Ur,Ot|=Mr;if(hr=hr.next,hr===null){if(hr=Se.shared.pending,hr===null)break;Ur=hr,hr=Ur.next,Ur.next=null,Se.lastBaseUpdate=Ur,Se.shared.pending=null}}while(!0);Lr===null&&(Rr=Kr),Se.baseState=Rr,Se.firstBaseUpdate=Ir,Se.lastBaseUpdate=Lr,Ge===null&&(Se.shared.lanes=0),xi|=Ot,o.lanes=Ot,o.memoizedState=Kr}}function Ku(o,c){if(typeof o!="function")throw Error(n(191,o));o.call(c)}function zu(o,c){var m=o.callbacks;if(m!==null)for(o.callbacks=null,o=0;o<m.length;o++)Ku(m[o],c)}var fo=O(null),Ka=O(0);function Vu(o,c){o=Zs,lt(Ka,o),lt(fo,c),Zs=o|c.baseLanes}function vl(){lt(Ka,Zs),lt(fo,fo.current)}function Al(){Zs=Ka.current,st(fo),st(Ka)}var os=O(null),Es=null;function ci(o){var c=o.alternate;lt(Mn,Mn.current&1),lt(os,o),Es===null&&(c===null||fo.current!==null||c.memoizedState!==null)&&(Es=o)}function Bl(o){lt(Mn,Mn.current),lt(os,o),Es===null&&(Es=o)}function Gu(o){o.tag===22?(lt(Mn,Mn.current),lt(os,o),Es===null&&(Es=o)):li()}function li(){lt(Mn,Mn.current),lt(os,os.current)}function as(o){st(os),Es===o&&(Es=null),st(Mn)}var Mn=O(0);function za(o){for(var c=o;c!==null;){if(c.tag===13){var m=c.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||D0(m)||N0(m)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var qs=0,sn=null,Bn=null,On=null,Va=!1,xo=!1,Pi=!1,Ga=0,Zo=0,ho=null,op=0;function Tn(){throw Error(n(321))}function Cl(o,c){if(c===null)return!1;for(var m=0;m<c.length&&m<o.length;m++)if(!ns(o[m],c[m]))return!1;return!0}function Sl(o,c,m,b,Se,Ge){return qs=Ge,sn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Re.H=o===null||o.memoizedState===null?Nf:Ll,Pi=!1,Ge=m(b,Se),Pi=!1,xo&&(Ge=Xu(c,m,b,Se)),Wu(o),Ge}function Wu(o){Re.H=ea;var c=Bn!==null&&Bn.next!==null;if(qs=0,On=Bn=sn=null,Va=!1,Zo=0,ho=null,c)throw Error(n(300));o===null||Ln||(o=o.dependencies,o!==null&&Ma(o)&&(Ln=!0))}function Xu(o,c,m,b){sn=o;var Se=0;do{if(xo&&(ho=null),Zo=0,xo=!1,25<=Se)throw Error(n(301));if(Se+=1,On=Bn=null,o.updateQueue!=null){var Ge=o.updateQueue;Ge.lastEffect=null,Ge.events=null,Ge.stores=null,Ge.memoCache!=null&&(Ge.memoCache.index=0)}Re.H=jf,Ge=c(m,b)}while(xo);return Ge}function ap(){var o=Re.H,c=o.useState()[0];return c=typeof c.then=="function"?Qo(c):c,o=o.useState()[0],(Bn!==null?Bn.memoizedState:null)!==o&&(sn.flags|=1024),c}function _l(){var o=Ga!==0;return Ga=0,o}function Rl(o,c,m){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~m}function kl(o){if(Va){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}Va=!1}qs=0,On=Bn=sn=null,xo=!1,Zo=Ga=0,ho=null}function Xn(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return On===null?sn.memoizedState=On=o:On=On.next=o,On}function Pn(){if(Bn===null){var o=sn.alternate;o=o!==null?o.memoizedState:null}else o=Bn.next;var c=On===null?sn.memoizedState:On.next;if(c!==null)On=c,Bn=o;else{if(o===null)throw sn.alternate===null?Error(n(467)):Error(n(310));Bn=o,o={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},On===null?sn.memoizedState=On=o:On=On.next=o}return On}function Wa(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qo(o){var c=Zo;return Zo+=1,ho===null&&(ho=[]),o=Uu(ho,o,c),c=sn,(On===null?c.memoizedState:On.next)===null&&(c=c.alternate,Re.H=c===null||c.memoizedState===null?Nf:Ll),o}function Xa(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Qo(o);if(o.$$typeof===q)return Vn(o)}throw Error(n(438,String(o)))}function Dl(o){var c=null,m=sn.updateQueue;if(m!==null&&(c=m.memoCache),c==null){var b=sn.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(c={data:b.data.map(function(Se){return Se.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),m===null&&(m=Wa(),sn.updateQueue=m),m.memoCache=c,m=c.data[c.index],m===void 0)for(m=c.data[c.index]=Array(o),b=0;b<o;b++)m[b]=it;return c.index++,m}function Ks(o,c){return typeof c=="function"?c(o):c}function Ya(o){var c=Pn();return Nl(c,Bn,o)}function Nl(o,c,m){var b=o.queue;if(b===null)throw Error(n(311));b.lastRenderedReducer=m;var Se=o.baseQueue,Ge=b.pending;if(Ge!==null){if(Se!==null){var Ot=Se.next;Se.next=Ge.next,Ge.next=Ot}c.baseQueue=Se=Ge,b.pending=null}if(Ge=o.baseState,Se===null)o.memoizedState=Ge;else{c=Se.next;var hr=Ot=null,Rr=null,Ir=c,Lr=!1;do{var Kr=Ir.lane&-536870913;if(Kr!==Ir.lane?(un&Kr)===Kr:(qs&Kr)===Kr){var Mr=Ir.revertLane;if(Mr===0)Rr!==null&&(Rr=Rr.next={lane:0,revertLane:0,gesture:null,action:Ir.action,hasEagerState:Ir.hasEagerState,eagerState:Ir.eagerState,next:null}),Kr===ao&&(Lr=!0);else if((qs&Mr)===Mr){Ir=Ir.next,Mr===ao&&(Lr=!0);continue}else Kr={lane:0,revertLane:Ir.revertLane,gesture:null,action:Ir.action,hasEagerState:Ir.hasEagerState,eagerState:Ir.eagerState,next:null},Rr===null?(hr=Rr=Kr,Ot=Ge):Rr=Rr.next=Kr,sn.lanes|=Mr,xi|=Mr;Kr=Ir.action,Pi&&m(Ge,Kr),Ge=Ir.hasEagerState?Ir.eagerState:m(Ge,Kr)}else Mr={lane:Kr,revertLane:Ir.revertLane,gesture:Ir.gesture,action:Ir.action,hasEagerState:Ir.hasEagerState,eagerState:Ir.eagerState,next:null},Rr===null?(hr=Rr=Mr,Ot=Ge):Rr=Rr.next=Mr,sn.lanes|=Kr,xi|=Kr;Ir=Ir.next}while(Ir!==null&&Ir!==c);if(Rr===null?Ot=Ge:Rr.next=hr,!ns(Ge,o.memoizedState)&&(Ln=!0,Lr&&(m=co,m!==null)))throw m;o.memoizedState=Ge,o.baseState=Ot,o.baseQueue=Rr,b.lastRenderedState=Ge}return Se===null&&(b.lanes=0),[o.memoizedState,b.dispatch]}function jl(o){var c=Pn(),m=c.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=o;var b=m.dispatch,Se=m.pending,Ge=c.memoizedState;if(Se!==null){m.pending=null;var Ot=Se=Se.next;do Ge=o(Ge,Ot.action),Ot=Ot.next;while(Ot!==Se);ns(Ge,c.memoizedState)||(Ln=!0),c.memoizedState=Ge,c.baseQueue===null&&(c.baseState=Ge),m.lastRenderedState=Ge}return[Ge,b]}function Yu(o,c,m){var b=sn,Se=Pn(),Ge=hn;if(Ge){if(m===void 0)throw Error(n(407));m=m()}else m=c();var Ot=!ns((Bn||Se).memoizedState,m);if(Ot&&(Se.memoizedState=m,Ln=!0),Se=Se.queue,$l(Ju.bind(null,b,Se,o),[o]),Se.getSnapshot!==c||Ot||On!==null&&On.memoizedState.tag&1){if(b.flags|=2048,po(9,{destroy:void 0},Qu.bind(null,b,Se,m,c),null),Rn===null)throw Error(n(349));Ge||(qs&127)!==0||Zu(b,c,m)}return m}function Zu(o,c,m){o.flags|=16384,o={getSnapshot:c,value:m},c=sn.updateQueue,c===null?(c=Wa(),sn.updateQueue=c,c.stores=[o]):(m=c.stores,m===null?c.stores=[o]:m.push(o))}function Qu(o,c,m,b){c.value=m,c.getSnapshot=b,ef(c)&&tf(o)}function Ju(o,c,m){return m(function(){ef(c)&&tf(o)})}function ef(o){var c=o.getSnapshot;o=o.value;try{var m=c();return!ns(o,m)}catch{return!0}}function tf(o){var c=ki(o,2);c!==null&&rs(c,o,2)}function Fl(o){var c=Xn();if(typeof o=="function"){var m=o;if(o=m(),Pi){_r(!0);try{m()}finally{_r(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:o},c}function rf(o,c,m,b){return o.baseState=m,Nl(o,Bn,typeof b=="function"?b:Ks)}function cp(o,c,m,b,Se){if(Ja(o))throw Error(n(485));if(o=c.action,o!==null){var Ge={payload:Se,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Ot){Ge.listeners.push(Ot)}};Re.T!==null?m(!0):Ge.isTransition=!1,b(Ge),m=c.pending,m===null?(Ge.next=c.pending=Ge,nf(c,Ge)):(Ge.next=m.next,c.pending=m.next=Ge)}}function nf(o,c){var m=c.action,b=c.payload,Se=o.state;if(c.isTransition){var Ge=Re.T,Ot={};Re.T=Ot;try{var hr=m(Se,b),Rr=Re.S;Rr!==null&&Rr(Ot,hr),sf(o,c,hr)}catch(Ir){Tl(o,c,Ir)}finally{Ge!==null&&Ot.types!==null&&(Ge.types=Ot.types),Re.T=Ge}}else try{Ge=m(Se,b),sf(o,c,Ge)}catch(Ir){Tl(o,c,Ir)}}function sf(o,c,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(b){of(o,c,b)},function(b){return Tl(o,c,b)}):of(o,c,m)}function of(o,c,m){c.status="fulfilled",c.value=m,af(c),o.state=m,c=o.pending,c!==null&&(m=c.next,m===c?o.pending=null:(m=m.next,c.next=m,nf(o,m)))}function Tl(o,c,m){var b=o.pending;if(o.pending=null,b!==null){b=b.next;do c.status="rejected",c.reason=m,af(c),c=c.next;while(c!==b)}o.action=null}function af(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function cf(o,c){return c}function lf(o,c){if(hn){var m=Rn.formState;if(m!==null){e:{var b=sn;if(hn){if(kn){t:{for(var Se=kn,Ge=ys;Se.nodeType!==8;){if(!Ge){Se=null;break t}if(Se=bs(Se.nextSibling),Se===null){Se=null;break t}}Ge=Se.data,Se=Ge==="F!"||Ge==="F"?Se:null}if(Se){kn=bs(Se.nextSibling),b=Se.data==="F!";break e}}ni(b)}b=!1}b&&(c=m[0])}}return m=Xn(),m.memoizedState=m.baseState=c,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cf,lastRenderedState:c},m.queue=b,m=Rf.bind(null,sn,b),b.dispatch=m,b=Fl(!1),Ge=Ol.bind(null,sn,!1,b.queue),b=Xn(),Se={state:c,dispatch:null,action:o,pending:null},b.queue=Se,m=cp.bind(null,sn,Se,Ge,m),Se.dispatch=m,b.memoizedState=o,[c,m,!1]}function uf(o){var c=Pn();return ff(c,Bn,o)}function ff(o,c,m){if(c=Nl(o,c,cf)[0],o=Ya(Ks)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var b=Qo(c)}catch(Ot){throw Ot===lo?Oa:Ot}else b=c;c=Pn();var Se=c.queue,Ge=Se.dispatch;return m!==c.memoizedState&&(sn.flags|=2048,po(9,{destroy:void 0},lp.bind(null,Se,m),null)),[b,Ge,o]}function lp(o,c){o.action=c}function xf(o){var c=Pn(),m=Bn;if(m!==null)return ff(c,m,o);Pn(),c=c.memoizedState,m=Pn();var b=m.queue.dispatch;return m.memoizedState=o,[c,b,!1]}function po(o,c,m,b){return o={tag:o,create:m,deps:b,inst:c,next:null},c=sn.updateQueue,c===null&&(c=Wa(),sn.updateQueue=c),m=c.lastEffect,m===null?c.lastEffect=o.next=o:(b=m.next,m.next=o,o.next=b,c.lastEffect=o),o}function df(){return Pn().memoizedState}function Za(o,c,m,b){var Se=Xn();sn.flags|=o,Se.memoizedState=po(1|c,{destroy:void 0},m,b===void 0?null:b)}function Qa(o,c,m,b){var Se=Pn();b=b===void 0?null:b;var Ge=Se.memoizedState.inst;Bn!==null&&b!==null&&Cl(b,Bn.memoizedState.deps)?Se.memoizedState=po(c,Ge,m,b):(sn.flags|=o,Se.memoizedState=po(1|c,Ge,m,b))}function hf(o,c){Za(8390656,8,o,c)}function $l(o,c){Qa(2048,8,o,c)}function up(o){sn.flags|=4;var c=sn.updateQueue;if(c===null)c=Wa(),sn.updateQueue=c,c.events=[o];else{var m=c.events;m===null?c.events=[o]:m.push(o)}}function pf(o){var c=Pn().memoizedState;return up({ref:c,nextImpl:o}),function(){if((yn&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}function mf(o,c){return Qa(4,2,o,c)}function gf(o,c){return Qa(4,4,o,c)}function yf(o,c){if(typeof c=="function"){o=o();var m=c(o);return function(){typeof m=="function"?m():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function Ef(o,c,m){m=m!=null?m.concat([o]):null,Qa(4,4,yf.bind(null,c,o),m)}function Il(){}function bf(o,c){var m=Pn();c=c===void 0?null:c;var b=m.memoizedState;return c!==null&&Cl(c,b[1])?b[0]:(m.memoizedState=[o,c],o)}function wf(o,c){var m=Pn();c=c===void 0?null:c;var b=m.memoizedState;if(c!==null&&Cl(c,b[1]))return b[0];if(b=o(),Pi){_r(!0);try{o()}finally{_r(!1)}}return m.memoizedState=[b,c],b}function Ml(o,c,m){return m===void 0||(qs&1073741824)!==0&&(un&261930)===0?o.memoizedState=c:(o.memoizedState=m,o=vx(),sn.lanes|=o,xi|=o,m)}function vf(o,c,m,b){return ns(m,c)?m:fo.current!==null?(o=Ml(o,m,b),ns(o,c)||(Ln=!0),o):(qs&42)===0||(qs&1073741824)!==0&&(un&261930)===0?(Ln=!0,o.memoizedState=m):(o=vx(),sn.lanes|=o,xi|=o,c)}function Af(o,c,m,b,Se){var Ge=Fe.p;Fe.p=Ge!==0&&8>Ge?Ge:8;var Ot=Re.T,hr={};Re.T=hr,Ol(o,!1,c,m);try{var Rr=Se(),Ir=Re.S;if(Ir!==null&&Ir(hr,Rr),Rr!==null&&typeof Rr=="object"&&typeof Rr.then=="function"){var Lr=ip(Rr,b);Jo(o,c,Lr,us(o))}else Jo(o,c,b,us(o))}catch(Kr){Jo(o,c,{then:function(){},status:"rejected",reason:Kr},us())}finally{Fe.p=Ge,Ot!==null&&hr.types!==null&&(Ot.types=hr.types),Re.T=Ot}}function fp(){}function Pl(o,c,m,b){if(o.tag!==5)throw Error(n(476));var Se=Bf(o).queue;Af(o,Se,c,Le,m===null?fp:function(){return Cf(o),m(b)})}function Bf(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:Le,baseState:Le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:Le},next:null};var m={};return c.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:m},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function Cf(o){var c=Bf(o);c.next===null&&(c=o.alternate.memoizedState),Jo(o,c.next.queue,{},us())}function Ul(){return Vn(ma)}function Sf(){return Pn().memoizedState}function _f(){return Pn().memoizedState}function xp(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var m=us();o=oi(m);var b=ai(c,o,m);b!==null&&(rs(b,c,m),Wo(b,c,m)),c={cache:hl()},o.payload=c;return}c=c.return}}function dp(o,c,m){var b=us();m={lane:b,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Ja(o)?kf(c,m):(m=nl(o,c,m,b),m!==null&&(rs(m,o,b),Df(m,c,b)))}function Rf(o,c,m){var b=us();Jo(o,c,m,b)}function Jo(o,c,m,b){var Se={lane:b,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(Ja(o))kf(c,Se);else{var Ge=o.alternate;if(o.lanes===0&&(Ge===null||Ge.lanes===0)&&(Ge=c.lastRenderedReducer,Ge!==null))try{var Ot=c.lastRenderedState,hr=Ge(Ot,m);if(Se.hasEagerState=!0,Se.eagerState=hr,ns(hr,Ot))return Fa(o,c,Se,0),Rn===null&&ja(),!1}catch{}finally{}if(m=nl(o,c,Se,b),m!==null)return rs(m,o,b),Df(m,c,b),!0}return!1}function Ol(o,c,m,b){if(b={lane:2,revertLane:y0(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Ja(o)){if(c)throw Error(n(479))}else c=nl(o,m,b,2),c!==null&&rs(c,o,2)}function Ja(o){var c=o.alternate;return o===sn||c!==null&&c===sn}function kf(o,c){xo=Va=!0;var m=o.pending;m===null?c.next=c:(c.next=m.next,m.next=c),o.pending=c}function Df(o,c,m){if((m&4194048)!==0){var b=c.lanes;b&=o.pendingLanes,m|=b,c.lanes=m,jr(o,m)}}var ea={readContext:Vn,use:Xa,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useLayoutEffect:Tn,useInsertionEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useSyncExternalStore:Tn,useId:Tn,useHostTransitionStatus:Tn,useFormState:Tn,useActionState:Tn,useOptimistic:Tn,useMemoCache:Tn,useCacheRefresh:Tn};ea.useEffectEvent=Tn;var Nf={readContext:Vn,use:Xa,useCallback:function(o,c){return Xn().memoizedState=[o,c===void 0?null:c],o},useContext:Vn,useEffect:hf,useImperativeHandle:function(o,c,m){m=m!=null?m.concat([o]):null,Za(4194308,4,yf.bind(null,c,o),m)},useLayoutEffect:function(o,c){return Za(4194308,4,o,c)},useInsertionEffect:function(o,c){Za(4,2,o,c)},useMemo:function(o,c){var m=Xn();c=c===void 0?null:c;var b=o();if(Pi){_r(!0);try{o()}finally{_r(!1)}}return m.memoizedState=[b,c],b},useReducer:function(o,c,m){var b=Xn();if(m!==void 0){var Se=m(c);if(Pi){_r(!0);try{m(c)}finally{_r(!1)}}}else Se=c;return b.memoizedState=b.baseState=Se,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:Se},b.queue=o,o=o.dispatch=dp.bind(null,sn,o),[b.memoizedState,o]},useRef:function(o){var c=Xn();return o={current:o},c.memoizedState=o},useState:function(o){o=Fl(o);var c=o.queue,m=Rf.bind(null,sn,c);return c.dispatch=m,[o.memoizedState,m]},useDebugValue:Il,useDeferredValue:function(o,c){var m=Xn();return Ml(m,o,c)},useTransition:function(){var o=Fl(!1);return o=Af.bind(null,sn,o.queue,!0,!1),Xn().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,m){var b=sn,Se=Xn();if(hn){if(m===void 0)throw Error(n(407));m=m()}else{if(m=c(),Rn===null)throw Error(n(349));(un&127)!==0||Zu(b,c,m)}Se.memoizedState=m;var Ge={value:m,getSnapshot:c};return Se.queue=Ge,hf(Ju.bind(null,b,Ge,o),[o]),b.flags|=2048,po(9,{destroy:void 0},Qu.bind(null,b,Ge,m,c),null),m},useId:function(){var o=Xn(),c=Rn.identifierPrefix;if(hn){var m=Ns,b=Ds;m=(b&~(1<<32-Nr(b)-1)).toString(32)+m,c="_"+c+"R_"+m,m=Ga++,0<m&&(c+="H"+m.toString(32)),c+="_"}else m=op++,c="_"+c+"r_"+m.toString(32)+"_";return o.memoizedState=c},useHostTransitionStatus:Ul,useFormState:lf,useActionState:lf,useOptimistic:function(o){var c=Xn();c.memoizedState=c.baseState=o;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=m,c=Ol.bind(null,sn,!0,m),m.dispatch=c,[o,c]},useMemoCache:Dl,useCacheRefresh:function(){return Xn().memoizedState=xp.bind(null,sn)},useEffectEvent:function(o){var c=Xn(),m={impl:o};return c.memoizedState=m,function(){if((yn&2)!==0)throw Error(n(440));return m.impl.apply(void 0,arguments)}}},Ll={readContext:Vn,use:Xa,useCallback:bf,useContext:Vn,useEffect:$l,useImperativeHandle:Ef,useInsertionEffect:mf,useLayoutEffect:gf,useMemo:wf,useReducer:Ya,useRef:df,useState:function(){return Ya(Ks)},useDebugValue:Il,useDeferredValue:function(o,c){var m=Pn();return vf(m,Bn.memoizedState,o,c)},useTransition:function(){var o=Ya(Ks)[0],c=Pn().memoizedState;return[typeof o=="boolean"?o:Qo(o),c]},useSyncExternalStore:Yu,useId:Sf,useHostTransitionStatus:Ul,useFormState:uf,useActionState:uf,useOptimistic:function(o,c){var m=Pn();return rf(m,Bn,o,c)},useMemoCache:Dl,useCacheRefresh:_f};Ll.useEffectEvent=pf;var jf={readContext:Vn,use:Xa,useCallback:bf,useContext:Vn,useEffect:$l,useImperativeHandle:Ef,useInsertionEffect:mf,useLayoutEffect:gf,useMemo:wf,useReducer:jl,useRef:df,useState:function(){return jl(Ks)},useDebugValue:Il,useDeferredValue:function(o,c){var m=Pn();return Bn===null?Ml(m,o,c):vf(m,Bn.memoizedState,o,c)},useTransition:function(){var o=jl(Ks)[0],c=Pn().memoizedState;return[typeof o=="boolean"?o:Qo(o),c]},useSyncExternalStore:Yu,useId:Sf,useHostTransitionStatus:Ul,useFormState:xf,useActionState:xf,useOptimistic:function(o,c){var m=Pn();return Bn!==null?rf(m,Bn,o,c):(m.baseState=o,[o,m.queue.dispatch])},useMemoCache:Dl,useCacheRefresh:_f};jf.useEffectEvent=pf;function Hl(o,c,m,b){c=o.memoizedState,m=m(b,c),m=m==null?c:g({},c,m),o.memoizedState=m,o.lanes===0&&(o.updateQueue.baseState=m)}var ql={enqueueSetState:function(o,c,m){o=o._reactInternals;var b=us(),Se=oi(b);Se.payload=c,m!=null&&(Se.callback=m),c=ai(o,Se,b),c!==null&&(rs(c,o,b),Wo(c,o,b))},enqueueReplaceState:function(o,c,m){o=o._reactInternals;var b=us(),Se=oi(b);Se.tag=1,Se.payload=c,m!=null&&(Se.callback=m),c=ai(o,Se,b),c!==null&&(rs(c,o,b),Wo(c,o,b))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var m=us(),b=oi(m);b.tag=2,c!=null&&(b.callback=c),c=ai(o,b,m),c!==null&&(rs(c,o,m),Wo(c,o,m))}};function Ff(o,c,m,b,Se,Ge,Ot){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(b,Ge,Ot):c.prototype&&c.prototype.isPureReactComponent?!Oo(m,b)||!Oo(Se,Ge):!0}function Tf(o,c,m,b){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(m,b),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(m,b),c.state!==o&&ql.enqueueReplaceState(c,c.state,null)}function Ui(o,c){var m=c;if("ref"in c){m={};for(var b in c)b!=="ref"&&(m[b]=c[b])}if(o=o.defaultProps){m===c&&(m=g({},m));for(var Se in o)m[Se]===void 0&&(m[Se]=o[Se])}return m}function $f(o){Na(o)}function If(o){console.error(o)}function Mf(o){Na(o)}function ec(o,c){try{var m=o.onUncaughtError;m(c.value,{componentStack:c.stack})}catch(b){setTimeout(function(){throw b})}}function Pf(o,c,m){try{var b=o.onCaughtError;b(m.value,{componentStack:m.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(Se){setTimeout(function(){throw Se})}}function Kl(o,c,m){return m=oi(m),m.tag=3,m.payload={element:null},m.callback=function(){ec(o,c)},m}function Uf(o){return o=oi(o),o.tag=3,o}function Of(o,c,m,b){var Se=m.type.getDerivedStateFromError;if(typeof Se=="function"){var Ge=b.value;o.payload=function(){return Se(Ge)},o.callback=function(){Pf(c,m,b)}}var Ot=m.stateNode;Ot!==null&&typeof Ot.componentDidCatch=="function"&&(o.callback=function(){Pf(c,m,b),typeof Se!="function"&&(di===null?di=new Set([this]):di.add(this));var hr=b.stack;this.componentDidCatch(b.value,{componentStack:hr!==null?hr:""})})}function hp(o,c,m,b,Se){if(m.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(c=m.alternate,c!==null&&oo(c,m,Se,!0),m=os.current,m!==null){switch(m.tag){case 31:case 13:return Es===null?xc():m.alternate===null&&$n===0&&($n=3),m.flags&=-257,m.flags|=65536,m.lanes=Se,b===La?m.flags|=16384:(c=m.updateQueue,c===null?m.updateQueue=new Set([b]):c.add(b),p0(o,b,Se)),!1;case 22:return m.flags|=65536,b===La?m.flags|=16384:(c=m.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([b])},m.updateQueue=c):(m=c.retryQueue,m===null?c.retryQueue=new Set([b]):m.add(b)),p0(o,b,Se)),!1}throw Error(n(435,m.tag))}return p0(o,b,Se),xc(),!1}if(hn)return c=os.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=Se,b!==ll&&(o=Error(n(422),{cause:b}),qo(hs(o,m)))):(b!==ll&&(c=Error(n(423),{cause:b}),qo(hs(c,m))),o=o.current.alternate,o.flags|=65536,Se&=-Se,o.lanes|=Se,b=hs(b,m),Se=Kl(o.stateNode,b,Se),bl(o,Se),$n!==4&&($n=2)),!1;var Ge=Error(n(520),{cause:b});if(Ge=hs(Ge,m),ca===null?ca=[Ge]:ca.push(Ge),$n!==4&&($n=2),c===null)return!0;b=hs(b,m),m=c;do{switch(m.tag){case 3:return m.flags|=65536,o=Se&-Se,m.lanes|=o,o=Kl(m.stateNode,b,o),bl(m,o),!1;case 1:if(c=m.type,Ge=m.stateNode,(m.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||Ge!==null&&typeof Ge.componentDidCatch=="function"&&(di===null||!di.has(Ge))))return m.flags|=65536,Se&=-Se,m.lanes|=Se,Se=Uf(Se),Of(Se,o,m,b),bl(m,Se),!1}m=m.return}while(m!==null);return!1}var zl=Error(n(461)),Ln=!1;function Gn(o,c,m,b){c.child=o===null?qu(c,null,m,b):Mi(c,o.child,m,b)}function Lf(o,c,m,b,Se){m=m.render;var Ge=c.ref;if("ref"in b){var Ot={};for(var hr in b)hr!=="ref"&&(Ot[hr]=b[hr])}else Ot=b;return Fi(c),b=Sl(o,c,m,Ot,Ge,Se),hr=_l(),o!==null&&!Ln?(Rl(o,c,Se),zs(o,c,Se)):(hn&&hr&&al(c),c.flags|=1,Gn(o,c,b,Se),c.child)}function Hf(o,c,m,b,Se){if(o===null){var Ge=m.type;return typeof Ge=="function"&&!sl(Ge)&&Ge.defaultProps===void 0&&m.compare===null?(c.tag=15,c.type=Ge,qf(o,c,Ge,b,Se)):(o=$a(m.type,null,b,c,c.mode,Se),o.ref=c.ref,o.return=c,c.child=o)}if(Ge=o.child,!Jl(o,Se)){var Ot=Ge.memoizedProps;if(m=m.compare,m=m!==null?m:Oo,m(Ot,b)&&o.ref===c.ref)return zs(o,c,Se)}return c.flags|=1,o=Us(Ge,b),o.ref=c.ref,o.return=c,c.child=o}function qf(o,c,m,b,Se){if(o!==null){var Ge=o.memoizedProps;if(Oo(Ge,b)&&o.ref===c.ref)if(Ln=!1,c.pendingProps=b=Ge,Jl(o,Se))(o.flags&131072)!==0&&(Ln=!0);else return c.lanes=o.lanes,zs(o,c,Se)}return Vl(o,c,m,b,Se)}function Kf(o,c,m,b){var Se=b.children,Ge=o!==null?o.memoizedState:null;if(o===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((c.flags&128)!==0){if(Ge=Ge!==null?Ge.baseLanes|m:m,o!==null){for(b=c.child=o.child,Se=0;b!==null;)Se=Se|b.lanes|b.childLanes,b=b.sibling;b=Se&~Ge}else b=0,c.child=null;return zf(o,c,Ge,m,b)}if((m&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&Ua(c,Ge!==null?Ge.cachePool:null),Ge!==null?Vu(c,Ge):vl(),Gu(c);else return b=c.lanes=536870912,zf(o,c,Ge!==null?Ge.baseLanes|m:m,m,b)}else Ge!==null?(Ua(c,Ge.cachePool),Vu(c,Ge),li(),c.memoizedState=null):(o!==null&&Ua(c,null),vl(),li());return Gn(o,c,Se,m),c.child}function ta(o,c){return o!==null&&o.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function zf(o,c,m,b,Se){var Ge=ml();return Ge=Ge===null?null:{parent:Un._currentValue,pool:Ge},c.memoizedState={baseLanes:m,cachePool:Ge},o!==null&&Ua(c,null),vl(),Gu(c),o!==null&&oo(o,c,b,!0),c.childLanes=Se,null}function tc(o,c){return c=nc({mode:c.mode,children:c.children},o.mode),c.ref=o.ref,o.child=c,c.return=o,c}function Vf(o,c,m){return Mi(c,o.child,null,m),o=tc(c,c.pendingProps),o.flags|=2,as(c),c.memoizedState=null,o}function pp(o,c,m){var b=c.pendingProps,Se=(c.flags&128)!==0;if(c.flags&=-129,o===null){if(hn){if(b.mode==="hidden")return o=tc(c,b),c.lanes=536870912,ta(null,o);if(Bl(c),(o=kn)?(o=sd(o,ys),o=o!==null&&o.data==="&"?o:null,o!==null&&(c.memoizedState={dehydrated:o,treeContext:ti!==null?{id:Ds,overflow:Ns}:null,retryLane:536870912,hydrationErrors:null},m=Ru(o),m.return=c,c.child=m,zn=c,kn=null)):o=null,o===null)throw ni(c);return c.lanes=536870912,null}return tc(c,b)}var Ge=o.memoizedState;if(Ge!==null){var Ot=Ge.dehydrated;if(Bl(c),Se)if(c.flags&256)c.flags&=-257,c=Vf(o,c,m);else if(c.memoizedState!==null)c.child=o.child,c.flags|=128,c=null;else throw Error(n(558));else if(Ln||oo(o,c,m,!1),Se=(m&o.childLanes)!==0,Ln||Se){if(b=Rn,b!==null&&(Ot=Pr(b,m),Ot!==0&&Ot!==Ge.retryLane))throw Ge.retryLane=Ot,ki(o,Ot),rs(b,o,Ot),zl;xc(),c=Vf(o,c,m)}else o=Ge.treeContext,kn=bs(Ot.nextSibling),zn=c,hn=!0,ri=null,ys=!1,o!==null&&Nu(c,o),c=tc(c,b),c.flags|=4096;return c}return o=Us(o.child,{mode:b.mode,children:b.children}),o.ref=c.ref,c.child=o,o.return=c,o}function rc(o,c){var m=c.ref;if(m===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(n(284));(o===null||o.ref!==m)&&(c.flags|=4194816)}}function Vl(o,c,m,b,Se){return Fi(c),m=Sl(o,c,m,b,void 0,Se),b=_l(),o!==null&&!Ln?(Rl(o,c,Se),zs(o,c,Se)):(hn&&b&&al(c),c.flags|=1,Gn(o,c,m,Se),c.child)}function Gf(o,c,m,b,Se,Ge){return Fi(c),c.updateQueue=null,m=Xu(c,b,m,Se),Wu(o),b=_l(),o!==null&&!Ln?(Rl(o,c,Ge),zs(o,c,Ge)):(hn&&b&&al(c),c.flags|=1,Gn(o,c,m,Ge),c.child)}function Wf(o,c,m,b,Se){if(Fi(c),c.stateNode===null){var Ge=ro,Ot=m.contextType;typeof Ot=="object"&&Ot!==null&&(Ge=Vn(Ot)),Ge=new m(b,Ge),c.memoizedState=Ge.state!==null&&Ge.state!==void 0?Ge.state:null,Ge.updater=ql,c.stateNode=Ge,Ge._reactInternals=c,Ge=c.stateNode,Ge.props=b,Ge.state=c.memoizedState,Ge.refs={},yl(c),Ot=m.contextType,Ge.context=typeof Ot=="object"&&Ot!==null?Vn(Ot):ro,Ge.state=c.memoizedState,Ot=m.getDerivedStateFromProps,typeof Ot=="function"&&(Hl(c,m,Ot,b),Ge.state=c.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof Ge.getSnapshotBeforeUpdate=="function"||typeof Ge.UNSAFE_componentWillMount!="function"&&typeof Ge.componentWillMount!="function"||(Ot=Ge.state,typeof Ge.componentWillMount=="function"&&Ge.componentWillMount(),typeof Ge.UNSAFE_componentWillMount=="function"&&Ge.UNSAFE_componentWillMount(),Ot!==Ge.state&&ql.enqueueReplaceState(Ge,Ge.state,null),Yo(c,b,Ge,Se),Xo(),Ge.state=c.memoizedState),typeof Ge.componentDidMount=="function"&&(c.flags|=4194308),b=!0}else if(o===null){Ge=c.stateNode;var hr=c.memoizedProps,Rr=Ui(m,hr);Ge.props=Rr;var Ir=Ge.context,Lr=m.contextType;Ot=ro,typeof Lr=="object"&&Lr!==null&&(Ot=Vn(Lr));var Kr=m.getDerivedStateFromProps;Lr=typeof Kr=="function"||typeof Ge.getSnapshotBeforeUpdate=="function",hr=c.pendingProps!==hr,Lr||typeof Ge.UNSAFE_componentWillReceiveProps!="function"&&typeof Ge.componentWillReceiveProps!="function"||(hr||Ir!==Ot)&&Tf(c,Ge,b,Ot),ii=!1;var Mr=c.memoizedState;Ge.state=Mr,Yo(c,b,Ge,Se),Xo(),Ir=c.memoizedState,hr||Mr!==Ir||ii?(typeof Kr=="function"&&(Hl(c,m,Kr,b),Ir=c.memoizedState),(Rr=ii||Ff(c,m,Rr,b,Mr,Ir,Ot))?(Lr||typeof Ge.UNSAFE_componentWillMount!="function"&&typeof Ge.componentWillMount!="function"||(typeof Ge.componentWillMount=="function"&&Ge.componentWillMount(),typeof Ge.UNSAFE_componentWillMount=="function"&&Ge.UNSAFE_componentWillMount()),typeof Ge.componentDidMount=="function"&&(c.flags|=4194308)):(typeof Ge.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=b,c.memoizedState=Ir),Ge.props=b,Ge.state=Ir,Ge.context=Ot,b=Rr):(typeof Ge.componentDidMount=="function"&&(c.flags|=4194308),b=!1)}else{Ge=c.stateNode,El(o,c),Ot=c.memoizedProps,Lr=Ui(m,Ot),Ge.props=Lr,Kr=c.pendingProps,Mr=Ge.context,Ir=m.contextType,Rr=ro,typeof Ir=="object"&&Ir!==null&&(Rr=Vn(Ir)),hr=m.getDerivedStateFromProps,(Ir=typeof hr=="function"||typeof Ge.getSnapshotBeforeUpdate=="function")||typeof Ge.UNSAFE_componentWillReceiveProps!="function"&&typeof Ge.componentWillReceiveProps!="function"||(Ot!==Kr||Mr!==Rr)&&Tf(c,Ge,b,Rr),ii=!1,Mr=c.memoizedState,Ge.state=Mr,Yo(c,b,Ge,Se),Xo();var Ur=c.memoizedState;Ot!==Kr||Mr!==Ur||ii||o!==null&&o.dependencies!==null&&Ma(o.dependencies)?(typeof hr=="function"&&(Hl(c,m,hr,b),Ur=c.memoizedState),(Lr=ii||Ff(c,m,Lr,b,Mr,Ur,Rr)||o!==null&&o.dependencies!==null&&Ma(o.dependencies))?(Ir||typeof Ge.UNSAFE_componentWillUpdate!="function"&&typeof Ge.componentWillUpdate!="function"||(typeof Ge.componentWillUpdate=="function"&&Ge.componentWillUpdate(b,Ur,Rr),typeof Ge.UNSAFE_componentWillUpdate=="function"&&Ge.UNSAFE_componentWillUpdate(b,Ur,Rr)),typeof Ge.componentDidUpdate=="function"&&(c.flags|=4),typeof Ge.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof Ge.componentDidUpdate!="function"||Ot===o.memoizedProps&&Mr===o.memoizedState||(c.flags|=4),typeof Ge.getSnapshotBeforeUpdate!="function"||Ot===o.memoizedProps&&Mr===o.memoizedState||(c.flags|=1024),c.memoizedProps=b,c.memoizedState=Ur),Ge.props=b,Ge.state=Ur,Ge.context=Rr,b=Lr):(typeof Ge.componentDidUpdate!="function"||Ot===o.memoizedProps&&Mr===o.memoizedState||(c.flags|=4),typeof Ge.getSnapshotBeforeUpdate!="function"||Ot===o.memoizedProps&&Mr===o.memoizedState||(c.flags|=1024),b=!1)}return Ge=b,rc(o,c),b=(c.flags&128)!==0,Ge||b?(Ge=c.stateNode,m=b&&typeof m.getDerivedStateFromError!="function"?null:Ge.render(),c.flags|=1,o!==null&&b?(c.child=Mi(c,o.child,null,Se),c.child=Mi(c,null,m,Se)):Gn(o,c,m,Se),c.memoizedState=Ge.state,o=c.child):o=zs(o,c,Se),o}function Xf(o,c,m,b){return Ni(),c.flags|=256,Gn(o,c,m,b),c.child}var Gl={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wl(o){return{baseLanes:o,cachePool:Mu()}}function Xl(o,c,m){return o=o!==null?o.childLanes&~m:0,c&&(o|=ls),o}function Yf(o,c,m){var b=c.pendingProps,Se=!1,Ge=(c.flags&128)!==0,Ot;if((Ot=Ge)||(Ot=o!==null&&o.memoizedState===null?!1:(Mn.current&2)!==0),Ot&&(Se=!0,c.flags&=-129),Ot=(c.flags&32)!==0,c.flags&=-33,o===null){if(hn){if(Se?ci(c):li(),(o=kn)?(o=sd(o,ys),o=o!==null&&o.data!=="&"?o:null,o!==null&&(c.memoizedState={dehydrated:o,treeContext:ti!==null?{id:Ds,overflow:Ns}:null,retryLane:536870912,hydrationErrors:null},m=Ru(o),m.return=c,c.child=m,zn=c,kn=null)):o=null,o===null)throw ni(c);return N0(o)?c.lanes=32:c.lanes=536870912,null}var hr=b.children;return b=b.fallback,Se?(li(),Se=c.mode,hr=nc({mode:"hidden",children:hr},Se),b=Di(b,Se,m,null),hr.return=c,b.return=c,hr.sibling=b,c.child=hr,b=c.child,b.memoizedState=Wl(m),b.childLanes=Xl(o,Ot,m),c.memoizedState=Gl,ta(null,b)):(ci(c),Yl(c,hr))}var Rr=o.memoizedState;if(Rr!==null&&(hr=Rr.dehydrated,hr!==null)){if(Ge)c.flags&256?(ci(c),c.flags&=-257,c=Zl(o,c,m)):c.memoizedState!==null?(li(),c.child=o.child,c.flags|=128,c=null):(li(),hr=b.fallback,Se=c.mode,b=nc({mode:"visible",children:b.children},Se),hr=Di(hr,Se,m,null),hr.flags|=2,b.return=c,hr.return=c,b.sibling=hr,c.child=b,Mi(c,o.child,null,m),b=c.child,b.memoizedState=Wl(m),b.childLanes=Xl(o,Ot,m),c.memoizedState=Gl,c=ta(null,b));else if(ci(c),N0(hr)){if(Ot=hr.nextSibling&&hr.nextSibling.dataset,Ot)var Ir=Ot.dgst;Ot=Ir,b=Error(n(419)),b.stack="",b.digest=Ot,qo({value:b,source:null,stack:null}),c=Zl(o,c,m)}else if(Ln||oo(o,c,m,!1),Ot=(m&o.childLanes)!==0,Ln||Ot){if(Ot=Rn,Ot!==null&&(b=Pr(Ot,m),b!==0&&b!==Rr.retryLane))throw Rr.retryLane=b,ki(o,b),rs(Ot,o,b),zl;D0(hr)||xc(),c=Zl(o,c,m)}else D0(hr)?(c.flags|=192,c.child=o.child,c=null):(o=Rr.treeContext,kn=bs(hr.nextSibling),zn=c,hn=!0,ri=null,ys=!1,o!==null&&Nu(c,o),c=Yl(c,b.children),c.flags|=4096);return c}return Se?(li(),hr=b.fallback,Se=c.mode,Rr=o.child,Ir=Rr.sibling,b=Us(Rr,{mode:"hidden",children:b.children}),b.subtreeFlags=Rr.subtreeFlags&65011712,Ir!==null?hr=Us(Ir,hr):(hr=Di(hr,Se,m,null),hr.flags|=2),hr.return=c,b.return=c,b.sibling=hr,c.child=b,ta(null,b),b=c.child,hr=o.child.memoizedState,hr===null?hr=Wl(m):(Se=hr.cachePool,Se!==null?(Rr=Un._currentValue,Se=Se.parent!==Rr?{parent:Rr,pool:Rr}:Se):Se=Mu(),hr={baseLanes:hr.baseLanes|m,cachePool:Se}),b.memoizedState=hr,b.childLanes=Xl(o,Ot,m),c.memoizedState=Gl,ta(o.child,b)):(ci(c),m=o.child,o=m.sibling,m=Us(m,{mode:"visible",children:b.children}),m.return=c,m.sibling=null,o!==null&&(Ot=c.deletions,Ot===null?(c.deletions=[o],c.flags|=16):Ot.push(o)),c.child=m,c.memoizedState=null,m)}function Yl(o,c){return c=nc({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function nc(o,c){return o=ss(22,o,null,c),o.lanes=0,o}function Zl(o,c,m){return Mi(c,o.child,null,m),o=Yl(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function Zf(o,c,m){o.lanes|=c;var b=o.alternate;b!==null&&(b.lanes|=c),xl(o.return,c,m)}function Ql(o,c,m,b,Se,Ge){var Ot=o.memoizedState;Ot===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:Se,treeForkCount:Ge}:(Ot.isBackwards=c,Ot.rendering=null,Ot.renderingStartTime=0,Ot.last=b,Ot.tail=m,Ot.tailMode=Se,Ot.treeForkCount=Ge)}function Qf(o,c,m){var b=c.pendingProps,Se=b.revealOrder,Ge=b.tail;b=b.children;var Ot=Mn.current,hr=(Ot&2)!==0;if(hr?(Ot=Ot&1|2,c.flags|=128):Ot&=1,lt(Mn,Ot),Gn(o,c,b,m),b=hn?Ho:0,!hr&&o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Zf(o,m,c);else if(o.tag===19)Zf(o,m,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(Se){case"forwards":for(m=c.child,Se=null;m!==null;)o=m.alternate,o!==null&&za(o)===null&&(Se=m),m=m.sibling;m=Se,m===null?(Se=c.child,c.child=null):(Se=m.sibling,m.sibling=null),Ql(c,!1,Se,m,Ge,b);break;case"backwards":case"unstable_legacy-backwards":for(m=null,Se=c.child,c.child=null;Se!==null;){if(o=Se.alternate,o!==null&&za(o)===null){c.child=Se;break}o=Se.sibling,Se.sibling=m,m=Se,Se=o}Ql(c,!0,m,null,Ge,b);break;case"together":Ql(c,!1,null,null,void 0,b);break;default:c.memoizedState=null}return c.child}function zs(o,c,m){if(o!==null&&(c.dependencies=o.dependencies),xi|=c.lanes,(m&c.childLanes)===0)if(o!==null){if(oo(o,c,m,!1),(m&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(n(153));if(c.child!==null){for(o=c.child,m=Us(o,o.pendingProps),c.child=m,m.return=c;o.sibling!==null;)o=o.sibling,m=m.sibling=Us(o,o.pendingProps),m.return=c;m.sibling=null}return c.child}function Jl(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&Ma(o)))}function mp(o,c,m){switch(c.tag){case 3:dr(c,c.stateNode.containerInfo),si(c,Un,o.memoizedState.cache),Ni();break;case 27:case 5:pt(c);break;case 4:dr(c,c.stateNode.containerInfo);break;case 10:si(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,Bl(c),null;break;case 13:var b=c.memoizedState;if(b!==null)return b.dehydrated!==null?(ci(c),c.flags|=128,null):(m&c.child.childLanes)!==0?Yf(o,c,m):(ci(c),o=zs(o,c,m),o!==null?o.sibling:null);ci(c);break;case 19:var Se=(o.flags&128)!==0;if(b=(m&c.childLanes)!==0,b||(oo(o,c,m,!1),b=(m&c.childLanes)!==0),Se){if(b)return Qf(o,c,m);c.flags|=128}if(Se=c.memoizedState,Se!==null&&(Se.rendering=null,Se.tail=null,Se.lastEffect=null),lt(Mn,Mn.current),b)break;return null;case 22:return c.lanes=0,Kf(o,c,m,c.pendingProps);case 24:si(c,Un,o.memoizedState.cache)}return zs(o,c,m)}function Jf(o,c,m){if(o!==null)if(o.memoizedProps!==c.pendingProps)Ln=!0;else{if(!Jl(o,m)&&(c.flags&128)===0)return Ln=!1,mp(o,c,m);Ln=(o.flags&131072)!==0}else Ln=!1,hn&&(c.flags&1048576)!==0&&Du(c,Ho,c.index);switch(c.lanes=0,c.tag){case 16:e:{var b=c.pendingProps;if(o=$i(c.elementType),c.type=o,typeof o=="function")sl(o)?(b=Ui(o,b),c.tag=1,c=Wf(null,c,o,b,m)):(c.tag=0,c=Vl(null,c,o,b,m));else{if(o!=null){var Se=o.$$typeof;if(Se===$e){c.tag=11,c=Lf(null,c,o,b,m);break e}else if(Se===W){c.tag=14,c=Hf(null,c,o,b,m);break e}}throw c=_e(o)||o,Error(n(306,c,""))}}return c;case 0:return Vl(o,c,c.type,c.pendingProps,m);case 1:return b=c.type,Se=Ui(b,c.pendingProps),Wf(o,c,b,Se,m);case 3:e:{if(dr(c,c.stateNode.containerInfo),o===null)throw Error(n(387));b=c.pendingProps;var Ge=c.memoizedState;Se=Ge.element,El(o,c),Yo(c,b,null,m);var Ot=c.memoizedState;if(b=Ot.cache,si(c,Un,b),b!==Ge.cache&&dl(c,[Un],m,!0),Xo(),b=Ot.element,Ge.isDehydrated)if(Ge={element:b,isDehydrated:!1,cache:Ot.cache},c.updateQueue.baseState=Ge,c.memoizedState=Ge,c.flags&256){c=Xf(o,c,b,m);break e}else if(b!==Se){Se=hs(Error(n(424)),c),qo(Se),c=Xf(o,c,b,m);break e}else{switch(o=c.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(kn=bs(o.firstChild),zn=c,hn=!0,ri=null,ys=!0,m=qu(c,null,b,m),c.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(Ni(),b===Se){c=zs(o,c,m);break e}Gn(o,c,b,m)}c=c.child}return c;case 26:return rc(o,c),o===null?(m=ud(c.type,null,c.pendingProps,null))?c.memoizedState=m:hn||(m=c.type,o=c.pendingProps,b=Ec(er.current).createElement(m),b[rn]=c,b[dn]=o,Wn(b,m,o),jn(b),c.stateNode=b):c.memoizedState=ud(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return pt(c),o===null&&hn&&(b=c.stateNode=ad(c.type,c.pendingProps,er.current),zn=c,ys=!0,Se=kn,gi(c.type)?(j0=Se,kn=bs(b.firstChild)):kn=Se),Gn(o,c,c.pendingProps.children,m),rc(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&hn&&((Se=b=kn)&&(b=Gp(b,c.type,c.pendingProps,ys),b!==null?(c.stateNode=b,zn=c,kn=bs(b.firstChild),ys=!1,Se=!0):Se=!1),Se||ni(c)),pt(c),Se=c.type,Ge=c.pendingProps,Ot=o!==null?o.memoizedProps:null,b=Ge.children,_0(Se,Ge)?b=null:Ot!==null&&_0(Se,Ot)&&(c.flags|=32),c.memoizedState!==null&&(Se=Sl(o,c,ap,null,null,m),ma._currentValue=Se),rc(o,c),Gn(o,c,b,m),c.child;case 6:return o===null&&hn&&((o=m=kn)&&(m=Wp(m,c.pendingProps,ys),m!==null?(c.stateNode=m,zn=c,kn=null,o=!0):o=!1),o||ni(c)),null;case 13:return Yf(o,c,m);case 4:return dr(c,c.stateNode.containerInfo),b=c.pendingProps,o===null?c.child=Mi(c,null,b,m):Gn(o,c,b,m),c.child;case 11:return Lf(o,c,c.type,c.pendingProps,m);case 7:return Gn(o,c,c.pendingProps,m),c.child;case 8:return Gn(o,c,c.pendingProps.children,m),c.child;case 12:return Gn(o,c,c.pendingProps.children,m),c.child;case 10:return b=c.pendingProps,si(c,c.type,b.value),Gn(o,c,b.children,m),c.child;case 9:return Se=c.type._context,b=c.pendingProps.children,Fi(c),Se=Vn(Se),b=b(Se),c.flags|=1,Gn(o,c,b,m),c.child;case 14:return Hf(o,c,c.type,c.pendingProps,m);case 15:return qf(o,c,c.type,c.pendingProps,m);case 19:return Qf(o,c,m);case 31:return pp(o,c,m);case 22:return Kf(o,c,m,c.pendingProps);case 24:return Fi(c),b=Vn(Un),o===null?(Se=ml(),Se===null&&(Se=Rn,Ge=hl(),Se.pooledCache=Ge,Ge.refCount++,Ge!==null&&(Se.pooledCacheLanes|=m),Se=Ge),c.memoizedState={parent:b,cache:Se},yl(c),si(c,Un,Se)):((o.lanes&m)!==0&&(El(o,c),Yo(c,null,null,m),Xo()),Se=o.memoizedState,Ge=c.memoizedState,Se.parent!==b?(Se={parent:b,cache:b},c.memoizedState=Se,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=Se),si(c,Un,b)):(b=Ge.cache,si(c,Un,b),b!==Se.cache&&dl(c,[Un],m,!0))),Gn(o,c,c.pendingProps.children,m),c.child;case 29:throw c.pendingProps}throw Error(n(156,c.tag))}function Vs(o){o.flags|=4}function e0(o,c,m,b,Se){if((c=(o.mode&32)!==0)&&(c=!1),c){if(o.flags|=16777216,(Se&335544128)===Se)if(o.stateNode.complete)o.flags|=8192;else if(Sx())o.flags|=8192;else throw Ii=La,gl}else o.flags&=-16777217}function ex(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!pd(c))if(Sx())o.flags|=8192;else throw Ii=La,gl}function sc(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?Ai():536870912,o.lanes|=c,Eo|=c)}function ra(o,c){if(!hn)switch(o.tailMode){case"hidden":c=o.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?o.tail=null:m.sibling=null;break;case"collapsed":m=o.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:b.sibling=null}}function Dn(o){var c=o.alternate!==null&&o.alternate.child===o.child,m=0,b=0;if(c)for(var Se=o.child;Se!==null;)m|=Se.lanes|Se.childLanes,b|=Se.subtreeFlags&65011712,b|=Se.flags&65011712,Se.return=o,Se=Se.sibling;else for(Se=o.child;Se!==null;)m|=Se.lanes|Se.childLanes,b|=Se.subtreeFlags,b|=Se.flags,Se.return=o,Se=Se.sibling;return o.subtreeFlags|=b,o.childLanes=m,c}function gp(o,c,m){var b=c.pendingProps;switch(cl(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dn(c),null;case 1:return Dn(c),null;case 3:return m=c.stateNode,b=null,o!==null&&(b=o.memoizedState.cache),c.memoizedState.cache!==b&&(c.flags|=2048),Hs(Un),ir(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(o===null||o.child===null)&&(io(c)?Vs(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,ul())),Dn(c),null;case 26:var Se=c.type,Ge=c.memoizedState;return o===null?(Vs(c),Ge!==null?(Dn(c),ex(c,Ge)):(Dn(c),e0(c,Se,null,b,m))):Ge?Ge!==o.memoizedState?(Vs(c),Dn(c),ex(c,Ge)):(Dn(c),c.flags&=-16777217):(o=o.memoizedProps,o!==b&&Vs(c),Dn(c),e0(c,Se,o,b,m)),null;case 27:if(tr(c),m=er.current,Se=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==b&&Vs(c);else{if(!b){if(c.stateNode===null)throw Error(n(166));return Dn(c),null}o=Xe.current,io(c)?ju(c):(o=ad(Se,b,m),c.stateNode=o,Vs(c))}return Dn(c),null;case 5:if(tr(c),Se=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==b&&Vs(c);else{if(!b){if(c.stateNode===null)throw Error(n(166));return Dn(c),null}if(Ge=Xe.current,io(c))ju(c);else{var Ot=Ec(er.current);switch(Ge){case 1:Ge=Ot.createElementNS("http://www.w3.org/2000/svg",Se);break;case 2:Ge=Ot.createElementNS("http://www.w3.org/1998/Math/MathML",Se);break;default:switch(Se){case"svg":Ge=Ot.createElementNS("http://www.w3.org/2000/svg",Se);break;case"math":Ge=Ot.createElementNS("http://www.w3.org/1998/Math/MathML",Se);break;case"script":Ge=Ot.createElement("div"),Ge.innerHTML="<script><\/script>",Ge=Ge.removeChild(Ge.firstChild);break;case"select":Ge=typeof b.is=="string"?Ot.createElement("select",{is:b.is}):Ot.createElement("select"),b.multiple?Ge.multiple=!0:b.size&&(Ge.size=b.size);break;default:Ge=typeof b.is=="string"?Ot.createElement(Se,{is:b.is}):Ot.createElement(Se)}}Ge[rn]=c,Ge[dn]=b;e:for(Ot=c.child;Ot!==null;){if(Ot.tag===5||Ot.tag===6)Ge.appendChild(Ot.stateNode);else if(Ot.tag!==4&&Ot.tag!==27&&Ot.child!==null){Ot.child.return=Ot,Ot=Ot.child;continue}if(Ot===c)break e;for(;Ot.sibling===null;){if(Ot.return===null||Ot.return===c)break e;Ot=Ot.return}Ot.sibling.return=Ot.return,Ot=Ot.sibling}c.stateNode=Ge;e:switch(Wn(Ge,Se,b),Se){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}b&&Vs(c)}}return Dn(c),e0(c,c.type,o===null?null:o.memoizedProps,c.pendingProps,m),null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==b&&Vs(c);else{if(typeof b!="string"&&c.stateNode===null)throw Error(n(166));if(o=er.current,io(c)){if(o=c.stateNode,m=c.memoizedProps,b=null,Se=zn,Se!==null)switch(Se.tag){case 27:case 5:b=Se.memoizedProps}o[rn]=c,o=!!(o.nodeValue===m||b!==null&&b.suppressHydrationWarning===!0||Yx(o.nodeValue,m)),o||ni(c,!0)}else o=Ec(o).createTextNode(b),o[rn]=c,c.stateNode=o}return Dn(c),null;case 31:if(m=c.memoizedState,o===null||o.memoizedState!==null){if(b=io(c),m!==null){if(o===null){if(!b)throw Error(n(318));if(o=c.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(557));o[rn]=c}else Ni(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Dn(c),o=!1}else m=ul(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=m),o=!0;if(!o)return c.flags&256?(as(c),c):(as(c),null);if((c.flags&128)!==0)throw Error(n(558))}return Dn(c),null;case 13:if(b=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Se=io(c),b!==null&&b.dehydrated!==null){if(o===null){if(!Se)throw Error(n(318));if(Se=c.memoizedState,Se=Se!==null?Se.dehydrated:null,!Se)throw Error(n(317));Se[rn]=c}else Ni(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Dn(c),Se=!1}else Se=ul(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=Se),Se=!0;if(!Se)return c.flags&256?(as(c),c):(as(c),null)}return as(c),(c.flags&128)!==0?(c.lanes=m,c):(m=b!==null,o=o!==null&&o.memoizedState!==null,m&&(b=c.child,Se=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(Se=b.alternate.memoizedState.cachePool.pool),Ge=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(Ge=b.memoizedState.cachePool.pool),Ge!==Se&&(b.flags|=2048)),m!==o&&m&&(c.child.flags|=8192),sc(c,c.updateQueue),Dn(c),null);case 4:return ir(),o===null&&v0(c.stateNode.containerInfo),Dn(c),null;case 10:return Hs(c.type),Dn(c),null;case 19:if(st(Mn),b=c.memoizedState,b===null)return Dn(c),null;if(Se=(c.flags&128)!==0,Ge=b.rendering,Ge===null)if(Se)ra(b,!1);else{if($n!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(Ge=za(o),Ge!==null){for(c.flags|=128,ra(b,!1),o=Ge.updateQueue,c.updateQueue=o,sc(c,o),c.subtreeFlags=0,o=m,m=c.child;m!==null;)_u(m,o),m=m.sibling;return lt(Mn,Mn.current&1|2),hn&&Os(c,b.treeForkCount),c.child}o=o.sibling}b.tail!==null&&rr()>lc&&(c.flags|=128,Se=!0,ra(b,!1),c.lanes=4194304)}else{if(!Se)if(o=za(Ge),o!==null){if(c.flags|=128,Se=!0,o=o.updateQueue,c.updateQueue=o,sc(c,o),ra(b,!0),b.tail===null&&b.tailMode==="hidden"&&!Ge.alternate&&!hn)return Dn(c),null}else 2*rr()-b.renderingStartTime>lc&&m!==536870912&&(c.flags|=128,Se=!0,ra(b,!1),c.lanes=4194304);b.isBackwards?(Ge.sibling=c.child,c.child=Ge):(o=b.last,o!==null?o.sibling=Ge:c.child=Ge,b.last=Ge)}return b.tail!==null?(o=b.tail,b.rendering=o,b.tail=o.sibling,b.renderingStartTime=rr(),o.sibling=null,m=Mn.current,lt(Mn,Se?m&1|2:m&1),hn&&Os(c,b.treeForkCount),o):(Dn(c),null);case 22:case 23:return as(c),Al(),b=c.memoizedState!==null,o!==null?o.memoizedState!==null!==b&&(c.flags|=8192):b&&(c.flags|=8192),b?(m&536870912)!==0&&(c.flags&128)===0&&(Dn(c),c.subtreeFlags&6&&(c.flags|=8192)):Dn(c),m=c.updateQueue,m!==null&&sc(c,m.retryQueue),m=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(m=o.memoizedState.cachePool.pool),b=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(b=c.memoizedState.cachePool.pool),b!==m&&(c.flags|=2048),o!==null&&st(Ti),null;case 24:return m=null,o!==null&&(m=o.memoizedState.cache),c.memoizedState.cache!==m&&(c.flags|=2048),Hs(Un),Dn(c),null;case 25:return null;case 30:return null}throw Error(n(156,c.tag))}function yp(o,c){switch(cl(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return Hs(Un),ir(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return tr(c),null;case 31:if(c.memoizedState!==null){if(as(c),c.alternate===null)throw Error(n(340));Ni()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 13:if(as(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(n(340));Ni()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return st(Mn),null;case 4:return ir(),null;case 10:return Hs(c.type),null;case 22:case 23:return as(c),Al(),o!==null&&st(Ti),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return Hs(Un),null;case 25:return null;default:return null}}function tx(o,c){switch(cl(c),c.tag){case 3:Hs(Un),ir();break;case 26:case 27:case 5:tr(c);break;case 4:ir();break;case 31:c.memoizedState!==null&&as(c);break;case 13:as(c);break;case 19:st(Mn);break;case 10:Hs(c.type);break;case 22:case 23:as(c),Al(),o!==null&&st(Ti);break;case 24:Hs(Un)}}function na(o,c){try{var m=c.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var Se=b.next;m=Se;do{if((m.tag&o)===o){b=void 0;var Ge=m.create,Ot=m.inst;b=Ge(),Ot.destroy=b}m=m.next}while(m!==Se)}}catch(hr){wn(c,c.return,hr)}}function ui(o,c,m){try{var b=c.updateQueue,Se=b!==null?b.lastEffect:null;if(Se!==null){var Ge=Se.next;b=Ge;do{if((b.tag&o)===o){var Ot=b.inst,hr=Ot.destroy;if(hr!==void 0){Ot.destroy=void 0,Se=c;var Rr=m,Ir=hr;try{Ir()}catch(Lr){wn(Se,Rr,Lr)}}}b=b.next}while(b!==Ge)}}catch(Lr){wn(c,c.return,Lr)}}function rx(o){var c=o.updateQueue;if(c!==null){var m=o.stateNode;try{zu(c,m)}catch(b){wn(o,o.return,b)}}}function nx(o,c,m){m.props=Ui(o.type,o.memoizedProps),m.state=o.memoizedState;try{m.componentWillUnmount()}catch(b){wn(o,c,b)}}function sa(o,c){try{var m=o.ref;if(m!==null){switch(o.tag){case 26:case 27:case 5:var b=o.stateNode;break;case 30:b=o.stateNode;break;default:b=o.stateNode}typeof m=="function"?o.refCleanup=m(b):m.current=b}}catch(Se){wn(o,c,Se)}}function js(o,c){var m=o.ref,b=o.refCleanup;if(m!==null)if(typeof b=="function")try{b()}catch(Se){wn(o,c,Se)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(Se){wn(o,c,Se)}else m.current=null}function sx(o){var c=o.type,m=o.memoizedProps,b=o.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":m.autoFocus&&b.focus();break e;case"img":m.src?b.src=m.src:m.srcSet&&(b.srcset=m.srcSet)}}catch(Se){wn(o,o.return,Se)}}function t0(o,c,m){try{var b=o.stateNode;Lp(b,o.type,m,c),b[dn]=c}catch(Se){wn(o,o.return,Se)}}function ix(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&gi(o.type)||o.tag===4}function r0(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||ix(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&gi(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function n0(o,c,m){var b=o.tag;if(b===5||b===6)o=o.stateNode,c?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(o,c):(c=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,c.appendChild(o),m=m._reactRootContainer,m!=null||c.onclick!==null||(c.onclick=Ms));else if(b!==4&&(b===27&&gi(o.type)&&(m=o.stateNode,c=null),o=o.child,o!==null))for(n0(o,c,m),o=o.sibling;o!==null;)n0(o,c,m),o=o.sibling}function ic(o,c,m){var b=o.tag;if(b===5||b===6)o=o.stateNode,c?m.insertBefore(o,c):m.appendChild(o);else if(b!==4&&(b===27&&gi(o.type)&&(m=o.stateNode),o=o.child,o!==null))for(ic(o,c,m),o=o.sibling;o!==null;)ic(o,c,m),o=o.sibling}function ox(o){var c=o.stateNode,m=o.memoizedProps;try{for(var b=o.type,Se=c.attributes;Se.length;)c.removeAttributeNode(Se[0]);Wn(c,b,m),c[rn]=o,c[dn]=m}catch(Ge){wn(o,o.return,Ge)}}var Gs=!1,Hn=!1,s0=!1,ax=typeof WeakSet=="function"?WeakSet:Set,Kn=null;function Ep(o,c){if(o=o.containerInfo,C0=Sc,o=yu(o),Zc(o)){if("selectionStart"in o)var m={start:o.selectionStart,end:o.selectionEnd};else e:{m=(m=o.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var Se=b.anchorOffset,Ge=b.focusNode;b=b.focusOffset;try{m.nodeType,Ge.nodeType}catch{m=null;break e}var Ot=0,hr=-1,Rr=-1,Ir=0,Lr=0,Kr=o,Mr=null;t:for(;;){for(var Ur;Kr!==m||Se!==0&&Kr.nodeType!==3||(hr=Ot+Se),Kr!==Ge||b!==0&&Kr.nodeType!==3||(Rr=Ot+b),Kr.nodeType===3&&(Ot+=Kr.nodeValue.length),(Ur=Kr.firstChild)!==null;)Mr=Kr,Kr=Ur;for(;;){if(Kr===o)break t;if(Mr===m&&++Ir===Se&&(hr=Ot),Mr===Ge&&++Lr===b&&(Rr=Ot),(Ur=Kr.nextSibling)!==null)break;Kr=Mr,Mr=Kr.parentNode}Kr=Ur}m=hr===-1||Rr===-1?null:{start:hr,end:Rr}}else m=null}m=m||{start:0,end:0}}else m=null;for(S0={focusedElem:o,selectionRange:m},Sc=!1,Kn=c;Kn!==null;)if(c=Kn,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,Kn=o;else for(;Kn!==null;){switch(c=Kn,Ge=c.alternate,o=c.flags,c.tag){case 0:if((o&4)!==0&&(o=c.updateQueue,o=o!==null?o.events:null,o!==null))for(m=0;m<o.length;m++)Se=o[m],Se.ref.impl=Se.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&Ge!==null){o=void 0,m=c,Se=Ge.memoizedProps,Ge=Ge.memoizedState,b=m.stateNode;try{var Wr=Ui(m.type,Se);o=b.getSnapshotBeforeUpdate(Wr,Ge),b.__reactInternalSnapshotBeforeUpdate=o}catch(en){wn(m,m.return,en)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,m=o.nodeType,m===9)k0(o);else if(m===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":k0(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=c.sibling,o!==null){o.return=c.return,Kn=o;break}Kn=c.return}}function cx(o,c,m){var b=m.flags;switch(m.tag){case 0:case 11:case 15:Xs(o,m),b&4&&na(5,m);break;case 1:if(Xs(o,m),b&4)if(o=m.stateNode,c===null)try{o.componentDidMount()}catch(Ot){wn(m,m.return,Ot)}else{var Se=Ui(m.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(Se,c,o.__reactInternalSnapshotBeforeUpdate)}catch(Ot){wn(m,m.return,Ot)}}b&64&&rx(m),b&512&&sa(m,m.return);break;case 3:if(Xs(o,m),b&64&&(o=m.updateQueue,o!==null)){if(c=null,m.child!==null)switch(m.child.tag){case 27:case 5:c=m.child.stateNode;break;case 1:c=m.child.stateNode}try{zu(o,c)}catch(Ot){wn(m,m.return,Ot)}}break;case 27:c===null&&b&4&&ox(m);case 26:case 5:Xs(o,m),c===null&&b&4&&sx(m),b&512&&sa(m,m.return);break;case 12:Xs(o,m);break;case 31:Xs(o,m),b&4&&fx(o,m);break;case 13:Xs(o,m),b&4&&xx(o,m),b&64&&(o=m.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(m=Rp.bind(null,m),Xp(o,m))));break;case 22:if(b=m.memoizedState!==null||Gs,!b){c=c!==null&&c.memoizedState!==null||Hn,Se=Gs;var Ge=Hn;Gs=b,(Hn=c)&&!Ge?Ys(o,m,(m.subtreeFlags&8772)!==0):Xs(o,m),Gs=Se,Hn=Ge}break;case 30:break;default:Xs(o,m)}}function lx(o){var c=o.alternate;c!==null&&(o.alternate=null,lx(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&Ci(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Nn=null,Qn=!1;function Ws(o,c,m){for(m=m.child;m!==null;)ux(o,c,m),m=m.sibling}function ux(o,c,m){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(or,m)}catch{}switch(m.tag){case 26:Hn||js(m,c),Ws(o,c,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Hn||js(m,c);var b=Nn,Se=Qn;gi(m.type)&&(Nn=m.stateNode,Qn=!1),Ws(o,c,m),da(m.stateNode),Nn=b,Qn=Se;break;case 5:Hn||js(m,c);case 6:if(b=Nn,Se=Qn,Nn=null,Ws(o,c,m),Nn=b,Qn=Se,Nn!==null)if(Qn)try{(Nn.nodeType===9?Nn.body:Nn.nodeName==="HTML"?Nn.ownerDocument.body:Nn).removeChild(m.stateNode)}catch(Ge){wn(m,c,Ge)}else try{Nn.removeChild(m.stateNode)}catch(Ge){wn(m,c,Ge)}break;case 18:Nn!==null&&(Qn?(o=Nn,rd(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,m.stateNode),_o(o)):rd(Nn,m.stateNode));break;case 4:b=Nn,Se=Qn,Nn=m.stateNode.containerInfo,Qn=!0,Ws(o,c,m),Nn=b,Qn=Se;break;case 0:case 11:case 14:case 15:ui(2,m,c),Hn||ui(4,m,c),Ws(o,c,m);break;case 1:Hn||(js(m,c),b=m.stateNode,typeof b.componentWillUnmount=="function"&&nx(m,c,b)),Ws(o,c,m);break;case 21:Ws(o,c,m);break;case 22:Hn=(b=Hn)||m.memoizedState!==null,Ws(o,c,m),Hn=b;break;default:Ws(o,c,m)}}function fx(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{_o(o)}catch(m){wn(c,c.return,m)}}}function xx(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{_o(o)}catch(m){wn(c,c.return,m)}}function bp(o){switch(o.tag){case 31:case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new ax),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new ax),c;default:throw Error(n(435,o.tag))}}function oc(o,c){var m=bp(o);c.forEach(function(b){if(!m.has(b)){m.add(b);var Se=kp.bind(null,o,b);b.then(Se,Se)}})}function Jn(o,c){var m=c.deletions;if(m!==null)for(var b=0;b<m.length;b++){var Se=m[b],Ge=o,Ot=c,hr=Ot;e:for(;hr!==null;){switch(hr.tag){case 27:if(gi(hr.type)){Nn=hr.stateNode,Qn=!1;break e}break;case 5:Nn=hr.stateNode,Qn=!1;break e;case 3:case 4:Nn=hr.stateNode.containerInfo,Qn=!0;break e}hr=hr.return}if(Nn===null)throw Error(n(160));ux(Ge,Ot,Se),Nn=null,Qn=!1,Ge=Se.alternate,Ge!==null&&(Ge.return=null),Se.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)dx(c,o),c=c.sibling}var Bs=null;function dx(o,c){var m=o.alternate,b=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Jn(c,o),es(o),b&4&&(ui(3,o,o.return),na(3,o),ui(5,o,o.return));break;case 1:Jn(c,o),es(o),b&512&&(Hn||m===null||js(m,m.return)),b&64&&Gs&&(o=o.updateQueue,o!==null&&(b=o.callbacks,b!==null&&(m=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=m===null?b:m.concat(b))));break;case 26:var Se=Bs;if(Jn(c,o),es(o),b&512&&(Hn||m===null||js(m,m.return)),b&4){var Ge=m!==null?m.memoizedState:null;if(b=o.memoizedState,m===null)if(b===null)if(o.stateNode===null){e:{b=o.type,m=o.memoizedProps,Se=Se.ownerDocument||Se;t:switch(b){case"title":Ge=Se.getElementsByTagName("title")[0],(!Ge||Ge[Ts]||Ge[rn]||Ge.namespaceURI==="http://www.w3.org/2000/svg"||Ge.hasAttribute("itemprop"))&&(Ge=Se.createElement(b),Se.head.insertBefore(Ge,Se.querySelector("head > title"))),Wn(Ge,b,m),Ge[rn]=o,jn(Ge),b=Ge;break e;case"link":var Ot=dd("link","href",Se).get(b+(m.href||""));if(Ot){for(var hr=0;hr<Ot.length;hr++)if(Ge=Ot[hr],Ge.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&Ge.getAttribute("rel")===(m.rel==null?null:m.rel)&&Ge.getAttribute("title")===(m.title==null?null:m.title)&&Ge.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){Ot.splice(hr,1);break t}}Ge=Se.createElement(b),Wn(Ge,b,m),Se.head.appendChild(Ge);break;case"meta":if(Ot=dd("meta","content",Se).get(b+(m.content||""))){for(hr=0;hr<Ot.length;hr++)if(Ge=Ot[hr],Ge.getAttribute("content")===(m.content==null?null:""+m.content)&&Ge.getAttribute("name")===(m.name==null?null:m.name)&&Ge.getAttribute("property")===(m.property==null?null:m.property)&&Ge.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&Ge.getAttribute("charset")===(m.charSet==null?null:m.charSet)){Ot.splice(hr,1);break t}}Ge=Se.createElement(b),Wn(Ge,b,m),Se.head.appendChild(Ge);break;default:throw Error(n(468,b))}Ge[rn]=o,jn(Ge),b=Ge}o.stateNode=b}else hd(Se,o.type,o.stateNode);else o.stateNode=xd(Se,b,o.memoizedProps);else Ge!==b?(Ge===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):Ge.count--,b===null?hd(Se,o.type,o.stateNode):xd(Se,b,o.memoizedProps)):b===null&&o.stateNode!==null&&t0(o,o.memoizedProps,m.memoizedProps)}break;case 27:Jn(c,o),es(o),b&512&&(Hn||m===null||js(m,m.return)),m!==null&&b&4&&t0(o,o.memoizedProps,m.memoizedProps);break;case 5:if(Jn(c,o),es(o),b&512&&(Hn||m===null||js(m,m.return)),o.flags&32){Se=o.stateNode;try{Xi(Se,"")}catch(Wr){wn(o,o.return,Wr)}}b&4&&o.stateNode!=null&&(Se=o.memoizedProps,t0(o,Se,m!==null?m.memoizedProps:Se)),b&1024&&(s0=!0);break;case 6:if(Jn(c,o),es(o),b&4){if(o.stateNode===null)throw Error(n(162));b=o.memoizedProps,m=o.stateNode;try{m.nodeValue=b}catch(Wr){wn(o,o.return,Wr)}}break;case 3:if(vc=null,Se=Bs,Bs=bc(c.containerInfo),Jn(c,o),Bs=Se,es(o),b&4&&m!==null&&m.memoizedState.isDehydrated)try{_o(c.containerInfo)}catch(Wr){wn(o,o.return,Wr)}s0&&(s0=!1,hx(o));break;case 4:b=Bs,Bs=bc(o.stateNode.containerInfo),Jn(c,o),es(o),Bs=b;break;case 12:Jn(c,o),es(o);break;case 31:Jn(c,o),es(o),b&4&&(b=o.updateQueue,b!==null&&(o.updateQueue=null,oc(o,b)));break;case 13:Jn(c,o),es(o),o.child.flags&8192&&o.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(cc=rr()),b&4&&(b=o.updateQueue,b!==null&&(o.updateQueue=null,oc(o,b)));break;case 22:Se=o.memoizedState!==null;var Rr=m!==null&&m.memoizedState!==null,Ir=Gs,Lr=Hn;if(Gs=Ir||Se,Hn=Lr||Rr,Jn(c,o),Hn=Lr,Gs=Ir,es(o),b&8192)e:for(c=o.stateNode,c._visibility=Se?c._visibility&-2:c._visibility|1,Se&&(m===null||Rr||Gs||Hn||Oi(o)),m=null,c=o;;){if(c.tag===5||c.tag===26){if(m===null){Rr=m=c;try{if(Ge=Rr.stateNode,Se)Ot=Ge.style,typeof Ot.setProperty=="function"?Ot.setProperty("display","none","important"):Ot.display="none";else{hr=Rr.stateNode;var Kr=Rr.memoizedProps.style,Mr=Kr!=null&&Kr.hasOwnProperty("display")?Kr.display:null;hr.style.display=Mr==null||typeof Mr=="boolean"?"":(""+Mr).trim()}}catch(Wr){wn(Rr,Rr.return,Wr)}}}else if(c.tag===6){if(m===null){Rr=c;try{Rr.stateNode.nodeValue=Se?"":Rr.memoizedProps}catch(Wr){wn(Rr,Rr.return,Wr)}}}else if(c.tag===18){if(m===null){Rr=c;try{var Ur=Rr.stateNode;Se?nd(Ur,!0):nd(Rr.stateNode,!1)}catch(Wr){wn(Rr,Rr.return,Wr)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break e;for(;c.sibling===null;){if(c.return===null||c.return===o)break e;m===c&&(m=null),c=c.return}m===c&&(m=null),c.sibling.return=c.return,c=c.sibling}b&4&&(b=o.updateQueue,b!==null&&(m=b.retryQueue,m!==null&&(b.retryQueue=null,oc(o,m))));break;case 19:Jn(c,o),es(o),b&4&&(b=o.updateQueue,b!==null&&(o.updateQueue=null,oc(o,b)));break;case 30:break;case 21:break;default:Jn(c,o),es(o)}}function es(o){var c=o.flags;if(c&2){try{for(var m,b=o.return;b!==null;){if(ix(b)){m=b;break}b=b.return}if(m==null)throw Error(n(160));switch(m.tag){case 27:var Se=m.stateNode,Ge=r0(o);ic(o,Ge,Se);break;case 5:var Ot=m.stateNode;m.flags&32&&(Xi(Ot,""),m.flags&=-33);var hr=r0(o);ic(o,hr,Ot);break;case 3:case 4:var Rr=m.stateNode.containerInfo,Ir=r0(o);n0(o,Ir,Rr);break;default:throw Error(n(161))}}catch(Lr){wn(o,o.return,Lr)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function hx(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;hx(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function Xs(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)cx(o,c.alternate,c),c=c.sibling}function Oi(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:ui(4,c,c.return),Oi(c);break;case 1:js(c,c.return);var m=c.stateNode;typeof m.componentWillUnmount=="function"&&nx(c,c.return,m),Oi(c);break;case 27:da(c.stateNode);case 26:case 5:js(c,c.return),Oi(c);break;case 22:c.memoizedState===null&&Oi(c);break;case 30:Oi(c);break;default:Oi(c)}o=o.sibling}}function Ys(o,c,m){for(m=m&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var b=c.alternate,Se=o,Ge=c,Ot=Ge.flags;switch(Ge.tag){case 0:case 11:case 15:Ys(Se,Ge,m),na(4,Ge);break;case 1:if(Ys(Se,Ge,m),b=Ge,Se=b.stateNode,typeof Se.componentDidMount=="function")try{Se.componentDidMount()}catch(Ir){wn(b,b.return,Ir)}if(b=Ge,Se=b.updateQueue,Se!==null){var hr=b.stateNode;try{var Rr=Se.shared.hiddenCallbacks;if(Rr!==null)for(Se.shared.hiddenCallbacks=null,Se=0;Se<Rr.length;Se++)Ku(Rr[Se],hr)}catch(Ir){wn(b,b.return,Ir)}}m&&Ot&64&&rx(Ge),sa(Ge,Ge.return);break;case 27:ox(Ge);case 26:case 5:Ys(Se,Ge,m),m&&b===null&&Ot&4&&sx(Ge),sa(Ge,Ge.return);break;case 12:Ys(Se,Ge,m);break;case 31:Ys(Se,Ge,m),m&&Ot&4&&fx(Se,Ge);break;case 13:Ys(Se,Ge,m),m&&Ot&4&&xx(Se,Ge);break;case 22:Ge.memoizedState===null&&Ys(Se,Ge,m),sa(Ge,Ge.return);break;case 30:break;default:Ys(Se,Ge,m)}c=c.sibling}}function i0(o,c){var m=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(m=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==m&&(o!=null&&o.refCount++,m!=null&&Ko(m))}function o0(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&Ko(o))}function Cs(o,c,m,b){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)px(o,c,m,b),c=c.sibling}function px(o,c,m,b){var Se=c.flags;switch(c.tag){case 0:case 11:case 15:Cs(o,c,m,b),Se&2048&&na(9,c);break;case 1:Cs(o,c,m,b);break;case 3:Cs(o,c,m,b),Se&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&Ko(o)));break;case 12:if(Se&2048){Cs(o,c,m,b),o=c.stateNode;try{var Ge=c.memoizedProps,Ot=Ge.id,hr=Ge.onPostCommit;typeof hr=="function"&&hr(Ot,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(Rr){wn(c,c.return,Rr)}}else Cs(o,c,m,b);break;case 31:Cs(o,c,m,b);break;case 13:Cs(o,c,m,b);break;case 23:break;case 22:Ge=c.stateNode,Ot=c.alternate,c.memoizedState!==null?Ge._visibility&2?Cs(o,c,m,b):ia(o,c):Ge._visibility&2?Cs(o,c,m,b):(Ge._visibility|=2,mo(o,c,m,b,(c.subtreeFlags&10256)!==0||!1)),Se&2048&&i0(Ot,c);break;case 24:Cs(o,c,m,b),Se&2048&&o0(c.alternate,c);break;default:Cs(o,c,m,b)}}function mo(o,c,m,b,Se){for(Se=Se&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var Ge=o,Ot=c,hr=m,Rr=b,Ir=Ot.flags;switch(Ot.tag){case 0:case 11:case 15:mo(Ge,Ot,hr,Rr,Se),na(8,Ot);break;case 23:break;case 22:var Lr=Ot.stateNode;Ot.memoizedState!==null?Lr._visibility&2?mo(Ge,Ot,hr,Rr,Se):ia(Ge,Ot):(Lr._visibility|=2,mo(Ge,Ot,hr,Rr,Se)),Se&&Ir&2048&&i0(Ot.alternate,Ot);break;case 24:mo(Ge,Ot,hr,Rr,Se),Se&&Ir&2048&&o0(Ot.alternate,Ot);break;default:mo(Ge,Ot,hr,Rr,Se)}c=c.sibling}}function ia(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var m=o,b=c,Se=b.flags;switch(b.tag){case 22:ia(m,b),Se&2048&&i0(b.alternate,b);break;case 24:ia(m,b),Se&2048&&o0(b.alternate,b);break;default:ia(m,b)}c=c.sibling}}var oa=8192;function go(o,c,m){if(o.subtreeFlags&oa)for(o=o.child;o!==null;)mx(o,c,m),o=o.sibling}function mx(o,c,m){switch(o.tag){case 26:go(o,c,m),o.flags&oa&&o.memoizedState!==null&&am(m,Bs,o.memoizedState,o.memoizedProps);break;case 5:go(o,c,m);break;case 3:case 4:var b=Bs;Bs=bc(o.stateNode.containerInfo),go(o,c,m),Bs=b;break;case 22:o.memoizedState===null&&(b=o.alternate,b!==null&&b.memoizedState!==null?(b=oa,oa=16777216,go(o,c,m),oa=b):go(o,c,m));break;default:go(o,c,m)}}function gx(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function aa(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var m=0;m<c.length;m++){var b=c[m];Kn=b,Ex(b,o)}gx(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)yx(o),o=o.sibling}function yx(o){switch(o.tag){case 0:case 11:case 15:aa(o),o.flags&2048&&ui(9,o,o.return);break;case 3:aa(o);break;case 12:aa(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,ac(o)):aa(o);break;default:aa(o)}}function ac(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var m=0;m<c.length;m++){var b=c[m];Kn=b,Ex(b,o)}gx(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:ui(8,c,c.return),ac(c);break;case 22:m=c.stateNode,m._visibility&2&&(m._visibility&=-3,ac(c));break;default:ac(c)}o=o.sibling}}function Ex(o,c){for(;Kn!==null;){var m=Kn;switch(m.tag){case 0:case 11:case 15:ui(8,m,c);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var b=m.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:Ko(m.memoizedState.cache)}if(b=m.child,b!==null)b.return=m,Kn=b;else e:for(m=o;Kn!==null;){b=Kn;var Se=b.sibling,Ge=b.return;if(lx(b),b===m){Kn=null;break e}if(Se!==null){Se.return=Ge,Kn=Se;break e}Kn=Ge}}}var wp={getCacheForType:function(o){var c=Vn(Un),m=c.data.get(o);return m===void 0&&(m=o(),c.data.set(o,m)),m},cacheSignal:function(){return Vn(Un).controller.signal}},vp=typeof WeakMap=="function"?WeakMap:Map,yn=0,Rn=null,an=null,un=0,En=0,cs=null,fi=!1,yo=!1,a0=!1,Zs=0,$n=0,xi=0,Li=0,c0=0,ls=0,Eo=0,ca=null,ts=null,l0=!1,cc=0,bx=0,lc=1/0,uc=null,di=null,qn=0,hi=null,bo=null,Qs=0,u0=0,f0=null,wx=null,la=0,x0=null;function us(){return(yn&2)!==0&&un!==0?un&-un:Re.T!==null?y0():An()}function vx(){if(ls===0)if((un&536870912)===0||hn){var o=Zr;Zr<<=1,(Zr&3932160)===0&&(Zr=262144),ls=o}else ls=536870912;return o=os.current,o!==null&&(o.flags|=32),ls}function rs(o,c,m){(o===Rn&&(En===2||En===9)||o.cancelPendingCommit!==null)&&(wo(o,0),pi(o,un,ls,!1)),ht(o,m),((yn&2)===0||o!==Rn)&&(o===Rn&&((yn&2)===0&&(Li|=m),$n===4&&pi(o,un,ls,!1)),Fs(o))}function Ax(o,c,m){if((yn&6)!==0)throw Error(n(327));var b=!m&&(c&127)===0&&(c&o.expiredLanes)===0||vn(o,c),Se=b?Cp(o,c):h0(o,c,!0),Ge=b;do{if(Se===0){yo&&!b&&pi(o,c,0,!1);break}else{if(m=o.current.alternate,Ge&&!Ap(m)){Se=h0(o,c,!1),Ge=!1;continue}if(Se===2){if(Ge=c,o.errorRecoveryDisabledLanes&Ge)var Ot=0;else Ot=o.pendingLanes&-536870913,Ot=Ot!==0?Ot:Ot&536870912?536870912:0;if(Ot!==0){c=Ot;e:{var hr=o;Se=ca;var Rr=hr.current.memoizedState.isDehydrated;if(Rr&&(wo(hr,Ot).flags|=256),Ot=h0(hr,Ot,!1),Ot!==2){if(a0&&!Rr){hr.errorRecoveryDisabledLanes|=Ge,Li|=Ge,Se=4;break e}Ge=ts,ts=Se,Ge!==null&&(ts===null?ts=Ge:ts.push.apply(ts,Ge))}Se=Ot}if(Ge=!1,Se!==2)continue}}if(Se===1){wo(o,0),pi(o,c,0,!0);break}e:{switch(b=o,Ge=Se,Ge){case 0:case 1:throw Error(n(345));case 4:if((c&4194048)!==c)break;case 6:pi(b,c,ls,!fi);break e;case 2:ts=null;break;case 3:case 5:break;default:throw Error(n(329))}if((c&62914560)===c&&(Se=cc+300-rr(),10<Se)){if(pi(b,c,ls,!fi),Yn(b,0,!0)!==0)break e;Qs=c,b.timeoutHandle=ed(Bx.bind(null,b,m,ts,uc,l0,c,ls,Li,Eo,fi,Ge,"Throttled",-0,0),Se);break e}Bx(b,m,ts,uc,l0,c,ls,Li,Eo,fi,Ge,null,-0,0)}}break}while(!0);Fs(o)}function Bx(o,c,m,b,Se,Ge,Ot,hr,Rr,Ir,Lr,Kr,Mr,Ur){if(o.timeoutHandle=-1,Kr=c.subtreeFlags,Kr&8192||(Kr&16785408)===16785408){Kr={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ms},mx(c,Ge,Kr);var Wr=(Ge&62914560)===Ge?cc-rr():(Ge&4194048)===Ge?bx-rr():0;if(Wr=cm(Kr,Wr),Wr!==null){Qs=Ge,o.cancelPendingCommit=Wr(jx.bind(null,o,c,Ge,m,b,Se,Ot,hr,Rr,Lr,Kr,null,Mr,Ur)),pi(o,Ge,Ot,!Ir);return}}jx(o,c,Ge,m,b,Se,Ot,hr,Rr)}function Ap(o){for(var c=o;;){var m=c.tag;if((m===0||m===11||m===15)&&c.flags&16384&&(m=c.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var b=0;b<m.length;b++){var Se=m[b],Ge=Se.getSnapshot;Se=Se.value;try{if(!ns(Ge(),Se))return!1}catch{return!1}}if(m=c.child,c.subtreeFlags&16384&&m!==null)m.return=c,c=m;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function pi(o,c,m,b){c&=~c0,c&=~Li,o.suspendedLanes|=c,o.pingedLanes&=~c,b&&(o.warmLanes|=c),b=o.expirationTimes;for(var Se=c;0<Se;){var Ge=31-Nr(Se),Ot=1<<Ge;b[Ge]=-1,Se&=~Ot}m!==0&&vr(o,m,c)}function fc(){return(yn&6)===0?(ua(0),!1):!0}function d0(){if(an!==null){if(En===0)var o=an.return;else o=an,Ls=ji=null,kl(o),uo=null,Vo=0,o=an;for(;o!==null;)tx(o.alternate,o),o=o.return;an=null}}function wo(o,c){var m=o.timeoutHandle;m!==-1&&(o.timeoutHandle=-1,Kp(m)),m=o.cancelPendingCommit,m!==null&&(o.cancelPendingCommit=null,m()),Qs=0,d0(),Rn=o,an=m=Us(o.current,null),un=c,En=0,cs=null,fi=!1,yo=vn(o,c),a0=!1,Eo=ls=c0=Li=xi=$n=0,ts=ca=null,l0=!1,(c&8)!==0&&(c|=c&32);var b=o.entangledLanes;if(b!==0)for(o=o.entanglements,b&=c;0<b;){var Se=31-Nr(b),Ge=1<<Se;c|=o[Se],b&=~Ge}return Zs=c,ja(),m}function Cx(o,c){sn=null,Re.H=ea,c===lo||c===Oa?(c=Ou(),En=3):c===gl?(c=Ou(),En=4):En=c===zl?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,cs=c,an===null&&($n=1,ec(o,hs(c,o.current)))}function Sx(){var o=os.current;return o===null?!0:(un&4194048)===un?Es===null:(un&62914560)===un||(un&536870912)!==0?o===Es:!1}function _x(){var o=Re.H;return Re.H=ea,o===null?ea:o}function Rx(){var o=Re.A;return Re.A=wp,o}function xc(){$n=4,fi||(un&4194048)!==un&&os.current!==null||(yo=!0),(xi&134217727)===0&&(Li&134217727)===0||Rn===null||pi(Rn,un,ls,!1)}function h0(o,c,m){var b=yn;yn|=2;var Se=_x(),Ge=Rx();(Rn!==o||un!==c)&&(uc=null,wo(o,c)),c=!1;var Ot=$n;e:do try{if(En!==0&&an!==null){var hr=an,Rr=cs;switch(En){case 8:d0(),Ot=6;break e;case 3:case 2:case 9:case 6:os.current===null&&(c=!0);var Ir=En;if(En=0,cs=null,vo(o,hr,Rr,Ir),m&&yo){Ot=0;break e}break;default:Ir=En,En=0,cs=null,vo(o,hr,Rr,Ir)}}Bp(),Ot=$n;break}catch(Lr){Cx(o,Lr)}while(!0);return c&&o.shellSuspendCounter++,Ls=ji=null,yn=b,Re.H=Se,Re.A=Ge,an===null&&(Rn=null,un=0,ja()),Ot}function Bp(){for(;an!==null;)kx(an)}function Cp(o,c){var m=yn;yn|=2;var b=_x(),Se=Rx();Rn!==o||un!==c?(uc=null,lc=rr()+500,wo(o,c)):yo=vn(o,c);e:do try{if(En!==0&&an!==null){c=an;var Ge=cs;t:switch(En){case 1:En=0,cs=null,vo(o,c,Ge,1);break;case 2:case 9:if(Pu(Ge)){En=0,cs=null,Dx(c);break}c=function(){En!==2&&En!==9||Rn!==o||(En=7),Fs(o)},Ge.then(c,c);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:Pu(Ge)?(En=0,cs=null,Dx(c)):(En=0,cs=null,vo(o,c,Ge,7));break;case 5:var Ot=null;switch(an.tag){case 26:Ot=an.memoizedState;case 5:case 27:var hr=an;if(Ot?pd(Ot):hr.stateNode.complete){En=0,cs=null;var Rr=hr.sibling;if(Rr!==null)an=Rr;else{var Ir=hr.return;Ir!==null?(an=Ir,dc(Ir)):an=null}break t}}En=0,cs=null,vo(o,c,Ge,5);break;case 6:En=0,cs=null,vo(o,c,Ge,6);break;case 8:d0(),$n=6;break e;default:throw Error(n(462))}}Sp();break}catch(Lr){Cx(o,Lr)}while(!0);return Ls=ji=null,Re.H=b,Re.A=Se,yn=m,an!==null?0:(Rn=null,un=0,ja(),$n)}function Sp(){for(;an!==null&&!kr();)kx(an)}function kx(o){var c=Jf(o.alternate,o,Zs);o.memoizedProps=o.pendingProps,c===null?dc(o):an=c}function Dx(o){var c=o,m=c.alternate;switch(c.tag){case 15:case 0:c=Gf(m,c,c.pendingProps,c.type,void 0,un);break;case 11:c=Gf(m,c,c.pendingProps,c.type.render,c.ref,un);break;case 5:kl(c);default:tx(m,c),c=an=_u(c,Zs),c=Jf(m,c,Zs)}o.memoizedProps=o.pendingProps,c===null?dc(o):an=c}function vo(o,c,m,b){Ls=ji=null,kl(c),uo=null,Vo=0;var Se=c.return;try{if(hp(o,Se,c,m,un)){$n=1,ec(o,hs(m,o.current)),an=null;return}}catch(Ge){if(Se!==null)throw an=Se,Ge;$n=1,ec(o,hs(m,o.current)),an=null;return}c.flags&32768?(hn||b===1?o=!0:yo||(un&536870912)!==0?o=!1:(fi=o=!0,(b===2||b===9||b===3||b===6)&&(b=os.current,b!==null&&b.tag===13&&(b.flags|=16384))),Nx(c,o)):dc(c)}function dc(o){var c=o;do{if((c.flags&32768)!==0){Nx(c,fi);return}o=c.return;var m=gp(c.alternate,c,Zs);if(m!==null){an=m;return}if(c=c.sibling,c!==null){an=c;return}an=c=o}while(c!==null);$n===0&&($n=5)}function Nx(o,c){do{var m=yp(o.alternate,o);if(m!==null){m.flags&=32767,an=m;return}if(m=o.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!c&&(o=o.sibling,o!==null)){an=o;return}an=o=m}while(o!==null);$n=6,an=null}function jx(o,c,m,b,Se,Ge,Ot,hr,Rr){o.cancelPendingCommit=null;do hc();while(qn!==0);if((yn&6)!==0)throw Error(n(327));if(c!==null){if(c===o.current)throw Error(n(177));if(Ge=c.lanes|c.childLanes,Ge|=rl,Ft(o,m,Ge,Ot,hr,Rr),o===Rn&&(an=Rn=null,un=0),bo=c,hi=o,Qs=m,u0=Ge,f0=Se,wx=b,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,Dp(lr,function(){return Mx(),null})):(o.callbackNode=null,o.callbackPriority=0),b=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||b){b=Re.T,Re.T=null,Se=Fe.p,Fe.p=2,Ot=yn,yn|=4;try{Ep(o,c,m)}finally{yn=Ot,Fe.p=Se,Re.T=b}}qn=1,Fx(),Tx(),$x()}}function Fx(){if(qn===1){qn=0;var o=hi,c=bo,m=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||m){m=Re.T,Re.T=null;var b=Fe.p;Fe.p=2;var Se=yn;yn|=4;try{dx(c,o);var Ge=S0,Ot=yu(o.containerInfo),hr=Ge.focusedElem,Rr=Ge.selectionRange;if(Ot!==hr&&hr&&hr.ownerDocument&&gu(hr.ownerDocument.documentElement,hr)){if(Rr!==null&&Zc(hr)){var Ir=Rr.start,Lr=Rr.end;if(Lr===void 0&&(Lr=Ir),"selectionStart"in hr)hr.selectionStart=Ir,hr.selectionEnd=Math.min(Lr,hr.value.length);else{var Kr=hr.ownerDocument||document,Mr=Kr&&Kr.defaultView||window;if(Mr.getSelection){var Ur=Mr.getSelection(),Wr=hr.textContent.length,en=Math.min(Rr.start,Wr),Sn=Rr.end===void 0?en:Math.min(Rr.end,Wr);!Ur.extend&&en>Sn&&(Ot=Sn,Sn=en,en=Ot);var Tr=mu(hr,en),Fr=mu(hr,Sn);if(Tr&&Fr&&(Ur.rangeCount!==1||Ur.anchorNode!==Tr.node||Ur.anchorOffset!==Tr.offset||Ur.focusNode!==Fr.node||Ur.focusOffset!==Fr.offset)){var $r=Kr.createRange();$r.setStart(Tr.node,Tr.offset),Ur.removeAllRanges(),en>Sn?(Ur.addRange($r),Ur.extend(Fr.node,Fr.offset)):($r.setEnd(Fr.node,Fr.offset),Ur.addRange($r))}}}}for(Kr=[],Ur=hr;Ur=Ur.parentNode;)Ur.nodeType===1&&Kr.push({element:Ur,left:Ur.scrollLeft,top:Ur.scrollTop});for(typeof hr.focus=="function"&&hr.focus(),hr=0;hr<Kr.length;hr++){var qr=Kr[hr];qr.element.scrollLeft=qr.left,qr.element.scrollTop=qr.top}}Sc=!!C0,S0=C0=null}finally{yn=Se,Fe.p=b,Re.T=m}}o.current=c,qn=2}}function Tx(){if(qn===2){qn=0;var o=hi,c=bo,m=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||m){m=Re.T,Re.T=null;var b=Fe.p;Fe.p=2;var Se=yn;yn|=4;try{cx(o,c.alternate,c)}finally{yn=Se,Fe.p=b,Re.T=m}}qn=3}}function $x(){if(qn===4||qn===3){qn=0,Dr();var o=hi,c=bo,m=Qs,b=wx;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?qn=5:(qn=0,bo=hi=null,Ix(o,o.pendingLanes));var Se=o.pendingLanes;if(Se===0&&(di=null),Xr(m),c=c.stateNode,Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(or,c,void 0,(c.current.flags&128)===128)}catch{}if(b!==null){c=Re.T,Se=Fe.p,Fe.p=2,Re.T=null;try{for(var Ge=o.onRecoverableError,Ot=0;Ot<b.length;Ot++){var hr=b[Ot];Ge(hr.value,{componentStack:hr.stack})}}finally{Re.T=c,Fe.p=Se}}(Qs&3)!==0&&hc(),Fs(o),Se=o.pendingLanes,(m&261930)!==0&&(Se&42)!==0?o===x0?la++:(la=0,x0=o):la=0,ua(0)}}function Ix(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,Ko(c)))}function hc(){return Fx(),Tx(),$x(),Mx()}function Mx(){if(qn!==5)return!1;var o=hi,c=u0;u0=0;var m=Xr(Qs),b=Re.T,Se=Fe.p;try{Fe.p=32>m?32:m,Re.T=null,m=f0,f0=null;var Ge=hi,Ot=Qs;if(qn=0,bo=hi=null,Qs=0,(yn&6)!==0)throw Error(n(331));var hr=yn;if(yn|=4,yx(Ge.current),px(Ge,Ge.current,Ot,m),yn=hr,ua(0,!1),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(or,Ge)}catch{}return!0}finally{Fe.p=Se,Re.T=b,Ix(o,c)}}function Px(o,c,m){c=hs(m,c),c=Kl(o.stateNode,c,2),o=ai(o,c,2),o!==null&&(ht(o,2),Fs(o))}function wn(o,c,m){if(o.tag===3)Px(o,o,m);else for(;c!==null;){if(c.tag===3){Px(c,o,m);break}else if(c.tag===1){var b=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(di===null||!di.has(b))){o=hs(m,o),m=Uf(2),b=ai(c,m,2),b!==null&&(Of(m,b,c,o),ht(b,2),Fs(b));break}}c=c.return}}function p0(o,c,m){var b=o.pingCache;if(b===null){b=o.pingCache=new vp;var Se=new Set;b.set(c,Se)}else Se=b.get(c),Se===void 0&&(Se=new Set,b.set(c,Se));Se.has(m)||(a0=!0,Se.add(m),o=_p.bind(null,o,c,m),c.then(o,o))}function _p(o,c,m){var b=o.pingCache;b!==null&&b.delete(c),o.pingedLanes|=o.suspendedLanes&m,o.warmLanes&=~m,Rn===o&&(un&m)===m&&($n===4||$n===3&&(un&62914560)===un&&300>rr()-cc?(yn&2)===0&&wo(o,0):c0|=m,Eo===un&&(Eo=0)),Fs(o)}function Ux(o,c){c===0&&(c=Ai()),o=ki(o,c),o!==null&&(ht(o,c),Fs(o))}function Rp(o){var c=o.memoizedState,m=0;c!==null&&(m=c.retryLane),Ux(o,m)}function kp(o,c){var m=0;switch(o.tag){case 31:case 13:var b=o.stateNode,Se=o.memoizedState;Se!==null&&(m=Se.retryLane);break;case 19:b=o.stateNode;break;case 22:b=o.stateNode._retryCache;break;default:throw Error(n(314))}b!==null&&b.delete(c),Ux(o,m)}function Dp(o,c){return Cr(o,c)}var pc=null,Ao=null,m0=!1,mc=!1,g0=!1,mi=0;function Fs(o){o!==Ao&&o.next===null&&(Ao===null?pc=Ao=o:Ao=Ao.next=o),mc=!0,m0||(m0=!0,jp())}function ua(o,c){if(!g0&&mc){g0=!0;do for(var m=!1,b=pc;b!==null;){if(o!==0){var Se=b.pendingLanes;if(Se===0)var Ge=0;else{var Ot=b.suspendedLanes,hr=b.pingedLanes;Ge=(1<<31-Nr(42|o)+1)-1,Ge&=Se&~(Ot&~hr),Ge=Ge&201326741?Ge&201326741|1:Ge?Ge|2:0}Ge!==0&&(m=!0,qx(b,Ge))}else Ge=un,Ge=Yn(b,b===Rn?Ge:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(Ge&3)===0||vn(b,Ge)||(m=!0,qx(b,Ge));b=b.next}while(m);g0=!1}}function Np(){Ox()}function Ox(){mc=m0=!1;var o=0;mi!==0&&qp()&&(o=mi);for(var c=rr(),m=null,b=pc;b!==null;){var Se=b.next,Ge=Lx(b,c);Ge===0?(b.next=null,m===null?pc=Se:m.next=Se,Se===null&&(Ao=m)):(m=b,(o!==0||(Ge&3)!==0)&&(mc=!0)),b=Se}qn!==0&&qn!==5||ua(o),mi!==0&&(mi=0)}function Lx(o,c){for(var m=o.suspendedLanes,b=o.pingedLanes,Se=o.expirationTimes,Ge=o.pendingLanes&-62914561;0<Ge;){var Ot=31-Nr(Ge),hr=1<<Ot,Rr=Se[Ot];Rr===-1?((hr&m)===0||(hr&b)!==0)&&(Se[Ot]=gn(hr,c)):Rr<=c&&(o.expiredLanes|=hr),Ge&=~hr}if(c=Rn,m=un,m=Yn(o,o===c?m:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),b=o.callbackNode,m===0||o===c&&(En===2||En===9)||o.cancelPendingCommit!==null)return b!==null&&b!==null&&wr(b),o.callbackNode=null,o.callbackPriority=0;if((m&3)===0||vn(o,m)){if(c=m&-m,c===o.callbackPriority)return c;switch(b!==null&&wr(b),Xr(m)){case 2:case 8:m=br;break;case 32:m=lr;break;case 268435456:m=yt;break;default:m=lr}return b=Hx.bind(null,o),m=Cr(m,b),o.callbackPriority=c,o.callbackNode=m,c}return b!==null&&b!==null&&wr(b),o.callbackPriority=2,o.callbackNode=null,2}function Hx(o,c){if(qn!==0&&qn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var m=o.callbackNode;if(hc()&&o.callbackNode!==m)return null;var b=un;return b=Yn(o,o===Rn?b:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),b===0?null:(Ax(o,b,c),Lx(o,rr()),o.callbackNode!=null&&o.callbackNode===m?Hx.bind(null,o):null)}function qx(o,c){if(hc())return null;Ax(o,c,!0)}function jp(){zp(function(){(yn&6)!==0?Cr(Br,Np):Ox()})}function y0(){if(mi===0){var o=ao;o===0&&(o=zr,zr<<=1,(zr&261888)===0&&(zr=256)),mi=o}return mi}function Kx(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Aa(""+o)}function zx(o,c){var m=c.ownerDocument.createElement("input");return m.name=c.name,m.value=c.value,o.id&&m.setAttribute("form",o.id),c.parentNode.insertBefore(m,c),o=new FormData(o),m.parentNode.removeChild(m),o}function Tp(o,c,m,b,Se){if(c==="submit"&&m&&m.stateNode===Se){var Ge=Kx((Se[dn]||null).action),Ot=b.submitter;Ot&&(c=(c=Ot[dn]||null)?Kx(c.formAction):Ot.getAttribute("formAction"),c!==null&&(Ge=c,Ot=null));var hr=new Ra("action","action",null,b,Se);o.push({event:hr,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(mi!==0){var Rr=Ot?zx(Se,Ot):new FormData(Se);Pl(m,{pending:!0,data:Rr,method:Se.method,action:Ge},null,Rr)}}else typeof Ge=="function"&&(hr.preventDefault(),Rr=Ot?zx(Se,Ot):new FormData(Se),Pl(m,{pending:!0,data:Rr,method:Se.method,action:Ge},Ge,Rr))},currentTarget:Se}]})}}for(var E0=0;E0<tl.length;E0++){var b0=tl[E0],$p=b0.toLowerCase(),Ip=b0[0].toUpperCase()+b0.slice(1);As($p,"on"+Ip)}As(wu,"onAnimationEnd"),As(vu,"onAnimationIteration"),As(Au,"onAnimationStart"),As("dblclick","onDoubleClick"),As("focusin","onFocus"),As("focusout","onBlur"),As(Zh,"onTransitionRun"),As(Qh,"onTransitionStart"),As(Jh,"onTransitionCancel"),As(Bu,"onTransitionEnd"),ks("onMouseEnter",["mouseout","mouseover"]),ks("onMouseLeave",["mouseout","mouseover"]),ks("onPointerEnter",["pointerout","pointerover"]),ks("onPointerLeave",["pointerout","pointerover"]),vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vs("onBeforeInput",["compositionend","keypress","textInput","paste"]),vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fa));function Vx(o,c){c=(c&4)!==0;for(var m=0;m<o.length;m++){var b=o[m],Se=b.event;b=b.listeners;e:{var Ge=void 0;if(c)for(var Ot=b.length-1;0<=Ot;Ot--){var hr=b[Ot],Rr=hr.instance,Ir=hr.currentTarget;if(hr=hr.listener,Rr!==Ge&&Se.isPropagationStopped())break e;Ge=hr,Se.currentTarget=Ir;try{Ge(Se)}catch(Lr){Na(Lr)}Se.currentTarget=null,Ge=Rr}else for(Ot=0;Ot<b.length;Ot++){if(hr=b[Ot],Rr=hr.instance,Ir=hr.currentTarget,hr=hr.listener,Rr!==Ge&&Se.isPropagationStopped())break e;Ge=hr,Se.currentTarget=Ir;try{Ge(Se)}catch(Lr){Na(Lr)}Se.currentTarget=null,Ge=Rr}}}}function cn(o,c){var m=c[Bi];m===void 0&&(m=c[Bi]=new Set);var b=o+"__bubble";m.has(b)||(Gx(c,o,2,!1),m.add(b))}function w0(o,c,m){var b=0;c&&(b|=4),Gx(m,o,b,c)}var gc="_reactListening"+Math.random().toString(36).slice(2);function v0(o){if(!o[gc]){o[gc]=!0,Ki.forEach(function(m){m!=="selectionchange"&&(Mp.has(m)||w0(m,!1,o),w0(m,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[gc]||(c[gc]=!0,w0("selectionchange",!1,c))}}function Gx(o,c,m,b){switch(vd(c)){case 2:var Se=fm;break;case 8:Se=xm;break;default:Se=M0}m=Se.bind(null,c,m,o),Se=void 0,!Hc||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(Se=!0),b?Se!==void 0?o.addEventListener(c,m,{capture:!0,passive:Se}):o.addEventListener(c,m,!0):Se!==void 0?o.addEventListener(c,m,{passive:Se}):o.addEventListener(c,m,!1)}function A0(o,c,m,b,Se){var Ge=b;if((c&1)===0&&(c&2)===0&&b!==null)e:for(;;){if(b===null)return;var Ot=b.tag;if(Ot===3||Ot===4){var hr=b.stateNode.containerInfo;if(hr===Se)break;if(Ot===4)for(Ot=b.return;Ot!==null;){var Rr=Ot.tag;if((Rr===3||Rr===4)&&Ot.stateNode.containerInfo===Se)return;Ot=Ot.return}for(;hr!==null;){if(Ot=Ss(hr),Ot===null)return;if(Rr=Ot.tag,Rr===5||Rr===6||Rr===26||Rr===27){b=Ge=Ot;continue e}hr=hr.parentNode}}b=b.return}Z0(function(){var Ir=Ge,Lr=Oc(m),Kr=[];e:{var Mr=Cu.get(o);if(Mr!==void 0){var Ur=Ra,Wr=o;switch(o){case"keypress":if(Ca(m)===0)break e;case"keydown":case"keyup":Ur=kh;break;case"focusin":Wr="focus",Ur=Vc;break;case"focusout":Wr="blur",Ur=Vc;break;case"beforeblur":case"afterblur":Ur=Vc;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ur=eu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ur=gh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ur=jh;break;case wu:case vu:case Au:Ur=bh;break;case Bu:Ur=Th;break;case"scroll":case"scrollend":Ur=ph;break;case"wheel":Ur=Ih;break;case"copy":case"cut":case"paste":Ur=vh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ur=ru;break;case"toggle":case"beforetoggle":Ur=Ph}var en=(c&4)!==0,Sn=!en&&(o==="scroll"||o==="scrollend"),Tr=en?Mr!==null?Mr+"Capture":null:Mr;en=[];for(var Fr=Ir,$r;Fr!==null;){var qr=Fr;if($r=qr.stateNode,qr=qr.tag,qr!==5&&qr!==26&&qr!==27||$r===null||Tr===null||(qr=Fo(Fr,Tr),qr!=null&&en.push(xa(Fr,qr,$r))),Sn)break;Fr=Fr.return}0<en.length&&(Mr=new Ur(Mr,Wr,null,m,Lr),Kr.push({event:Mr,listeners:en}))}}if((c&7)===0){e:{if(Mr=o==="mouseover"||o==="pointerover",Ur=o==="mouseout"||o==="pointerout",Mr&&m!==Uc&&(Wr=m.relatedTarget||m.fromElement)&&(Ss(Wr)||Wr[_n]))break e;if((Ur||Mr)&&(Mr=Lr.window===Lr?Lr:(Mr=Lr.ownerDocument)?Mr.defaultView||Mr.parentWindow:window,Ur?(Wr=m.relatedTarget||m.toElement,Ur=Ir,Wr=Wr?Ss(Wr):null,Wr!==null&&(Sn=a(Wr),en=Wr.tag,Wr!==Sn||en!==5&&en!==27&&en!==6)&&(Wr=null)):(Ur=null,Wr=Ir),Ur!==Wr)){if(en=eu,qr="onMouseLeave",Tr="onMouseEnter",Fr="mouse",(o==="pointerout"||o==="pointerover")&&(en=ru,qr="onPointerLeave",Tr="onPointerEnter",Fr="pointer"),Sn=Ur==null?Mr:$s(Ur),$r=Wr==null?Mr:$s(Wr),Mr=new en(qr,Fr+"leave",Ur,m,Lr),Mr.target=Sn,Mr.relatedTarget=$r,qr=null,Ss(Lr)===Ir&&(en=new en(Tr,Fr+"enter",Wr,m,Lr),en.target=$r,en.relatedTarget=Sn,qr=en),Sn=qr,Ur&&Wr)t:{for(en=Pp,Tr=Ur,Fr=Wr,$r=0,qr=Tr;qr;qr=en(qr))$r++;qr=0;for(var Qr=Fr;Qr;Qr=en(Qr))qr++;for(;0<$r-qr;)Tr=en(Tr),$r--;for(;0<qr-$r;)Fr=en(Fr),qr--;for(;$r--;){if(Tr===Fr||Fr!==null&&Tr===Fr.alternate){en=Tr;break t}Tr=en(Tr),Fr=en(Fr)}en=null}else en=null;Ur!==null&&Wx(Kr,Mr,Ur,en,!1),Wr!==null&&Sn!==null&&Wx(Kr,Sn,Wr,en,!0)}}e:{if(Mr=Ir?$s(Ir):window,Ur=Mr.nodeName&&Mr.nodeName.toLowerCase(),Ur==="select"||Ur==="input"&&Mr.type==="file")var pn=uu;else if(cu(Mr))if(fu)pn=Wh;else{pn=Vh;var Yr=zh}else Ur=Mr.nodeName,!Ur||Ur.toLowerCase()!=="input"||Mr.type!=="checkbox"&&Mr.type!=="radio"?Ir&&Pc(Ir.elementType)&&(pn=uu):pn=Gh;if(pn&&(pn=pn(o,Ir))){lu(Kr,pn,m,Lr);break e}Yr&&Yr(o,Mr,Ir),o==="focusout"&&Ir&&Mr.type==="number"&&Ir.memoizedProps.value!=null&&Mc(Mr,"number",Mr.value)}switch(Yr=Ir?$s(Ir):window,o){case"focusin":(cu(Yr)||Yr.contentEditable==="true")&&(Ji=Yr,Qc=Ir,Lo=null);break;case"focusout":Lo=Qc=Ji=null;break;case"mousedown":Jc=!0;break;case"contextmenu":case"mouseup":case"dragend":Jc=!1,Eu(Kr,m,Lr);break;case"selectionchange":if(Yh)break;case"keydown":case"keyup":Eu(Kr,m,Lr)}var on;if(Wc)e:{switch(o){case"compositionstart":var fn="onCompositionStart";break e;case"compositionend":fn="onCompositionEnd";break e;case"compositionupdate":fn="onCompositionUpdate";break e}fn=void 0}else Qi?ou(o,m)&&(fn="onCompositionEnd"):o==="keydown"&&m.keyCode===229&&(fn="onCompositionStart");fn&&(nu&&m.locale!=="ko"&&(Qi||fn!=="onCompositionStart"?fn==="onCompositionEnd"&&Qi&&(on=Q0()):(ei=Lr,qc="value"in ei?ei.value:ei.textContent,Qi=!0)),Yr=yc(Ir,fn),0<Yr.length&&(fn=new tu(fn,o,null,m,Lr),Kr.push({event:fn,listeners:Yr}),on?fn.data=on:(on=au(m),on!==null&&(fn.data=on)))),(on=Oh?Lh(o,m):Hh(o,m))&&(fn=yc(Ir,"onBeforeInput"),0<fn.length&&(Yr=new tu("onBeforeInput","beforeinput",null,m,Lr),Kr.push({event:Yr,listeners:fn}),Yr.data=on)),Tp(Kr,o,Ir,m,Lr)}Vx(Kr,c)})}function xa(o,c,m){return{instance:o,listener:c,currentTarget:m}}function yc(o,c){for(var m=c+"Capture",b=[];o!==null;){var Se=o,Ge=Se.stateNode;if(Se=Se.tag,Se!==5&&Se!==26&&Se!==27||Ge===null||(Se=Fo(o,m),Se!=null&&b.unshift(xa(o,Se,Ge)),Se=Fo(o,c),Se!=null&&b.push(xa(o,Se,Ge))),o.tag===3)return b;o=o.return}return[]}function Pp(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function Wx(o,c,m,b,Se){for(var Ge=c._reactName,Ot=[];m!==null&&m!==b;){var hr=m,Rr=hr.alternate,Ir=hr.stateNode;if(hr=hr.tag,Rr!==null&&Rr===b)break;hr!==5&&hr!==26&&hr!==27||Ir===null||(Rr=Ir,Se?(Ir=Fo(m,Ge),Ir!=null&&Ot.unshift(xa(m,Ir,Rr))):Se||(Ir=Fo(m,Ge),Ir!=null&&Ot.push(xa(m,Ir,Rr)))),m=m.return}Ot.length!==0&&o.push({event:c,listeners:Ot})}var Up=/\r\n?/g,Op=/\u0000|\uFFFD/g;function Xx(o){return(typeof o=="string"?o:""+o).replace(Up,`
`).replace(Op,"")}function Yx(o,c){return c=Xx(c),Xx(o)===c}function Cn(o,c,m,b,Se,Ge){switch(m){case"children":typeof b=="string"?c==="body"||c==="textarea"&&b===""||Xi(o,b):(typeof b=="number"||typeof b=="bigint")&&c!=="body"&&Xi(o,""+b);break;case"className":wa(o,"class",b);break;case"tabIndex":wa(o,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":wa(o,m,b);break;case"style":X0(o,b,Ge);break;case"data":if(c!=="object"){wa(o,"data",b);break}case"src":case"href":if(b===""&&(c!=="a"||m!=="href")){o.removeAttribute(m);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){o.removeAttribute(m);break}b=Aa(""+b),o.setAttribute(m,b);break;case"action":case"formAction":if(typeof b=="function"){o.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof Ge=="function"&&(m==="formAction"?(c!=="input"&&Cn(o,c,"name",Se.name,Se,null),Cn(o,c,"formEncType",Se.formEncType,Se,null),Cn(o,c,"formMethod",Se.formMethod,Se,null),Cn(o,c,"formTarget",Se.formTarget,Se,null)):(Cn(o,c,"encType",Se.encType,Se,null),Cn(o,c,"method",Se.method,Se,null),Cn(o,c,"target",Se.target,Se,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){o.removeAttribute(m);break}b=Aa(""+b),o.setAttribute(m,b);break;case"onClick":b!=null&&(o.onclick=Ms);break;case"onScroll":b!=null&&cn("scroll",o);break;case"onScrollEnd":b!=null&&cn("scrollend",o);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(n(61));if(m=b.__html,m!=null){if(Se.children!=null)throw Error(n(60));o.innerHTML=m}}break;case"multiple":o.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":o.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){o.removeAttribute("xlink:href");break}m=Aa(""+b),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?o.setAttribute(m,""+b):o.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?o.setAttribute(m,""):o.removeAttribute(m);break;case"capture":case"download":b===!0?o.setAttribute(m,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?o.setAttribute(m,b):o.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?o.setAttribute(m,b):o.removeAttribute(m);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?o.removeAttribute(m):o.setAttribute(m,b);break;case"popover":cn("beforetoggle",o),cn("toggle",o),ba(o,"popover",b);break;case"xlinkActuate":Is(o,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":Is(o,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":Is(o,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":Is(o,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":Is(o,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":Is(o,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":Is(o,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":Is(o,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":Is(o,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":ba(o,"is",b);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=dh.get(m)||m,ba(o,m,b))}}function B0(o,c,m,b,Se,Ge){switch(m){case"style":X0(o,b,Ge);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(n(61));if(m=b.__html,m!=null){if(Se.children!=null)throw Error(n(60));o.innerHTML=m}}break;case"children":typeof b=="string"?Xi(o,b):(typeof b=="number"||typeof b=="bigint")&&Xi(o,""+b);break;case"onScroll":b!=null&&cn("scroll",o);break;case"onScrollEnd":b!=null&&cn("scrollend",o);break;case"onClick":b!=null&&(o.onclick=Ms);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zi.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(Se=m.endsWith("Capture"),c=m.slice(2,Se?m.length-7:void 0),Ge=o[dn]||null,Ge=Ge!=null?Ge[m]:null,typeof Ge=="function"&&o.removeEventListener(c,Ge,Se),typeof b=="function")){typeof Ge!="function"&&Ge!==null&&(m in o?o[m]=null:o.hasAttribute(m)&&o.removeAttribute(m)),o.addEventListener(c,b,Se);break e}m in o?o[m]=b:b===!0?o.setAttribute(m,""):ba(o,m,b)}}}function Wn(o,c,m){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":cn("error",o),cn("load",o);var b=!1,Se=!1,Ge;for(Ge in m)if(m.hasOwnProperty(Ge)){var Ot=m[Ge];if(Ot!=null)switch(Ge){case"src":b=!0;break;case"srcSet":Se=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:Cn(o,c,Ge,Ot,m,null)}}Se&&Cn(o,c,"srcSet",m.srcSet,m,null),b&&Cn(o,c,"src",m.src,m,null);return;case"input":cn("invalid",o);var hr=Ge=Ot=Se=null,Rr=null,Ir=null;for(b in m)if(m.hasOwnProperty(b)){var Lr=m[b];if(Lr!=null)switch(b){case"name":Se=Lr;break;case"type":Ot=Lr;break;case"checked":Rr=Lr;break;case"defaultChecked":Ir=Lr;break;case"value":Ge=Lr;break;case"defaultValue":hr=Lr;break;case"children":case"dangerouslySetInnerHTML":if(Lr!=null)throw Error(n(137,c));break;default:Cn(o,c,b,Lr,m,null)}}z0(o,Ge,hr,Rr,Ir,Ot,Se,!1);return;case"select":cn("invalid",o),b=Ot=Ge=null;for(Se in m)if(m.hasOwnProperty(Se)&&(hr=m[Se],hr!=null))switch(Se){case"value":Ge=hr;break;case"defaultValue":Ot=hr;break;case"multiple":b=hr;default:Cn(o,c,Se,hr,m,null)}c=Ge,m=Ot,o.multiple=!!b,c!=null?Wi(o,!!b,c,!1):m!=null&&Wi(o,!!b,m,!0);return;case"textarea":cn("invalid",o),Ge=Se=b=null;for(Ot in m)if(m.hasOwnProperty(Ot)&&(hr=m[Ot],hr!=null))switch(Ot){case"value":b=hr;break;case"defaultValue":Se=hr;break;case"children":Ge=hr;break;case"dangerouslySetInnerHTML":if(hr!=null)throw Error(n(91));break;default:Cn(o,c,Ot,hr,m,null)}G0(o,b,Se,Ge);return;case"option":for(Rr in m)if(m.hasOwnProperty(Rr)&&(b=m[Rr],b!=null))switch(Rr){case"selected":o.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:Cn(o,c,Rr,b,m,null)}return;case"dialog":cn("beforetoggle",o),cn("toggle",o),cn("cancel",o),cn("close",o);break;case"iframe":case"object":cn("load",o);break;case"video":case"audio":for(b=0;b<fa.length;b++)cn(fa[b],o);break;case"image":cn("error",o),cn("load",o);break;case"details":cn("toggle",o);break;case"embed":case"source":case"link":cn("error",o),cn("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ir in m)if(m.hasOwnProperty(Ir)&&(b=m[Ir],b!=null))switch(Ir){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:Cn(o,c,Ir,b,m,null)}return;default:if(Pc(c)){for(Lr in m)m.hasOwnProperty(Lr)&&(b=m[Lr],b!==void 0&&B0(o,c,Lr,b,m,void 0));return}}for(hr in m)m.hasOwnProperty(hr)&&(b=m[hr],b!=null&&Cn(o,c,hr,b,m,null))}function Lp(o,c,m,b){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var Se=null,Ge=null,Ot=null,hr=null,Rr=null,Ir=null,Lr=null;for(Ur in m){var Kr=m[Ur];if(m.hasOwnProperty(Ur)&&Kr!=null)switch(Ur){case"checked":break;case"value":break;case"defaultValue":Rr=Kr;default:b.hasOwnProperty(Ur)||Cn(o,c,Ur,null,b,Kr)}}for(var Mr in b){var Ur=b[Mr];if(Kr=m[Mr],b.hasOwnProperty(Mr)&&(Ur!=null||Kr!=null))switch(Mr){case"type":Ge=Ur;break;case"name":Se=Ur;break;case"checked":Ir=Ur;break;case"defaultChecked":Lr=Ur;break;case"value":Ot=Ur;break;case"defaultValue":hr=Ur;break;case"children":case"dangerouslySetInnerHTML":if(Ur!=null)throw Error(n(137,c));break;default:Ur!==Kr&&Cn(o,c,Mr,Ur,b,Kr)}}Ic(o,Ot,hr,Rr,Ir,Lr,Ge,Se);return;case"select":Ur=Ot=hr=Mr=null;for(Ge in m)if(Rr=m[Ge],m.hasOwnProperty(Ge)&&Rr!=null)switch(Ge){case"value":break;case"multiple":Ur=Rr;default:b.hasOwnProperty(Ge)||Cn(o,c,Ge,null,b,Rr)}for(Se in b)if(Ge=b[Se],Rr=m[Se],b.hasOwnProperty(Se)&&(Ge!=null||Rr!=null))switch(Se){case"value":Mr=Ge;break;case"defaultValue":hr=Ge;break;case"multiple":Ot=Ge;default:Ge!==Rr&&Cn(o,c,Se,Ge,b,Rr)}c=hr,m=Ot,b=Ur,Mr!=null?Wi(o,!!m,Mr,!1):!!b!=!!m&&(c!=null?Wi(o,!!m,c,!0):Wi(o,!!m,m?[]:"",!1));return;case"textarea":Ur=Mr=null;for(hr in m)if(Se=m[hr],m.hasOwnProperty(hr)&&Se!=null&&!b.hasOwnProperty(hr))switch(hr){case"value":break;case"children":break;default:Cn(o,c,hr,null,b,Se)}for(Ot in b)if(Se=b[Ot],Ge=m[Ot],b.hasOwnProperty(Ot)&&(Se!=null||Ge!=null))switch(Ot){case"value":Mr=Se;break;case"defaultValue":Ur=Se;break;case"children":break;case"dangerouslySetInnerHTML":if(Se!=null)throw Error(n(91));break;default:Se!==Ge&&Cn(o,c,Ot,Se,b,Ge)}V0(o,Mr,Ur);return;case"option":for(var Wr in m)if(Mr=m[Wr],m.hasOwnProperty(Wr)&&Mr!=null&&!b.hasOwnProperty(Wr))switch(Wr){case"selected":o.selected=!1;break;default:Cn(o,c,Wr,null,b,Mr)}for(Rr in b)if(Mr=b[Rr],Ur=m[Rr],b.hasOwnProperty(Rr)&&Mr!==Ur&&(Mr!=null||Ur!=null))switch(Rr){case"selected":o.selected=Mr&&typeof Mr!="function"&&typeof Mr!="symbol";break;default:Cn(o,c,Rr,Mr,b,Ur)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var en in m)Mr=m[en],m.hasOwnProperty(en)&&Mr!=null&&!b.hasOwnProperty(en)&&Cn(o,c,en,null,b,Mr);for(Ir in b)if(Mr=b[Ir],Ur=m[Ir],b.hasOwnProperty(Ir)&&Mr!==Ur&&(Mr!=null||Ur!=null))switch(Ir){case"children":case"dangerouslySetInnerHTML":if(Mr!=null)throw Error(n(137,c));break;default:Cn(o,c,Ir,Mr,b,Ur)}return;default:if(Pc(c)){for(var Sn in m)Mr=m[Sn],m.hasOwnProperty(Sn)&&Mr!==void 0&&!b.hasOwnProperty(Sn)&&B0(o,c,Sn,void 0,b,Mr);for(Lr in b)Mr=b[Lr],Ur=m[Lr],!b.hasOwnProperty(Lr)||Mr===Ur||Mr===void 0&&Ur===void 0||B0(o,c,Lr,Mr,b,Ur);return}}for(var Tr in m)Mr=m[Tr],m.hasOwnProperty(Tr)&&Mr!=null&&!b.hasOwnProperty(Tr)&&Cn(o,c,Tr,null,b,Mr);for(Kr in b)Mr=b[Kr],Ur=m[Kr],!b.hasOwnProperty(Kr)||Mr===Ur||Mr==null&&Ur==null||Cn(o,c,Kr,Mr,b,Ur)}function Zx(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Hp(){if(typeof performance.getEntriesByType=="function"){for(var o=0,c=0,m=performance.getEntriesByType("resource"),b=0;b<m.length;b++){var Se=m[b],Ge=Se.transferSize,Ot=Se.initiatorType,hr=Se.duration;if(Ge&&hr&&Zx(Ot)){for(Ot=0,hr=Se.responseEnd,b+=1;b<m.length;b++){var Rr=m[b],Ir=Rr.startTime;if(Ir>hr)break;var Lr=Rr.transferSize,Kr=Rr.initiatorType;Lr&&Zx(Kr)&&(Rr=Rr.responseEnd,Ot+=Lr*(Rr<hr?1:(hr-Ir)/(Rr-Ir)))}if(--b,c+=8*(Ge+Ot)/(Se.duration/1e3),o++,10<o)break}}if(0<o)return c/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var C0=null,S0=null;function Ec(o){return o.nodeType===9?o:o.ownerDocument}function Qx(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jx(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function _0(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var R0=null;function qp(){var o=window.event;return o&&o.type==="popstate"?o===R0?!1:(R0=o,!0):(R0=null,!1)}var ed=typeof setTimeout=="function"?setTimeout:void 0,Kp=typeof clearTimeout=="function"?clearTimeout:void 0,td=typeof Promise=="function"?Promise:void 0,zp=typeof queueMicrotask=="function"?queueMicrotask:typeof td<"u"?function(o){return td.resolve(null).then(o).catch(Vp)}:ed;function Vp(o){setTimeout(function(){throw o})}function gi(o){return o==="head"}function rd(o,c){var m=c,b=0;do{var Se=m.nextSibling;if(o.removeChild(m),Se&&Se.nodeType===8)if(m=Se.data,m==="/$"||m==="/&"){if(b===0){o.removeChild(Se),_o(c);return}b--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")b++;else if(m==="html")da(o.ownerDocument.documentElement);else if(m==="head"){m=o.ownerDocument.head,da(m);for(var Ge=m.firstChild;Ge;){var Ot=Ge.nextSibling,hr=Ge.nodeName;Ge[Ts]||hr==="SCRIPT"||hr==="STYLE"||hr==="LINK"&&Ge.rel.toLowerCase()==="stylesheet"||m.removeChild(Ge),Ge=Ot}}else m==="body"&&da(o.ownerDocument.body);m=Se}while(m);_o(c)}function nd(o,c){var m=o;o=0;do{var b=m.nextSibling;if(m.nodeType===1?c?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(c?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),b&&b.nodeType===8)if(m=b.data,m==="/$"){if(o===0)break;o--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||o++;m=b}while(m)}function k0(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var m=c;switch(c=c.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":k0(m),Ci(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}o.removeChild(m)}}function Gp(o,c,m,b){for(;o.nodeType===1;){var Se=m;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!b&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(b){if(!o[Ts])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(Ge=o.getAttribute("rel"),Ge==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(Ge!==Se.rel||o.getAttribute("href")!==(Se.href==null||Se.href===""?null:Se.href)||o.getAttribute("crossorigin")!==(Se.crossOrigin==null?null:Se.crossOrigin)||o.getAttribute("title")!==(Se.title==null?null:Se.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(Ge=o.getAttribute("src"),(Ge!==(Se.src==null?null:Se.src)||o.getAttribute("type")!==(Se.type==null?null:Se.type)||o.getAttribute("crossorigin")!==(Se.crossOrigin==null?null:Se.crossOrigin))&&Ge&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var Ge=Se.name==null?null:""+Se.name;if(Se.type==="hidden"&&o.getAttribute("name")===Ge)return o}else return o;if(o=bs(o.nextSibling),o===null)break}return null}function Wp(o,c,m){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!m||(o=bs(o.nextSibling),o===null))return null;return o}function sd(o,c){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!c||(o=bs(o.nextSibling),o===null))return null;return o}function D0(o){return o.data==="$?"||o.data==="$~"}function N0(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function Xp(o,c){var m=o.ownerDocument;if(o.data==="$~")o._reactRetry=c;else if(o.data!=="$?"||m.readyState!=="loading")c();else{var b=function(){c(),m.removeEventListener("DOMContentLoaded",b)};m.addEventListener("DOMContentLoaded",b),o._reactRetry=b}}function bs(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return o}var j0=null;function id(o){o=o.nextSibling;for(var c=0;o;){if(o.nodeType===8){var m=o.data;if(m==="/$"||m==="/&"){if(c===0)return bs(o.nextSibling);c--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||c++}o=o.nextSibling}return null}function od(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var m=o.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(c===0)return o;c--}else m!=="/$"&&m!=="/&"||c++}o=o.previousSibling}return null}function ad(o,c,m){switch(c=Ec(m),o){case"html":if(o=c.documentElement,!o)throw Error(n(452));return o;case"head":if(o=c.head,!o)throw Error(n(453));return o;case"body":if(o=c.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function da(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);Ci(o)}var ws=new Map,cd=new Set;function bc(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Js=Fe.d;Fe.d={f:Yp,r:Zp,D:Qp,C:Jp,L:em,m:tm,X:nm,S:rm,M:sm};function Yp(){var o=Js.f(),c=fc();return o||c}function Zp(o){var c=_s(o);c!==null&&c.tag===5&&c.type==="form"?Cf(c):Js.r(o)}var Bo=typeof document>"u"?null:document;function ld(o,c,m){var b=Bo;if(b&&typeof c=="string"&&c){var Se=xs(c);Se='link[rel="'+o+'"][href="'+Se+'"]',typeof m=="string"&&(Se+='[crossorigin="'+m+'"]'),cd.has(Se)||(cd.add(Se),o={rel:o,crossOrigin:m,href:c},b.querySelector(Se)===null&&(c=b.createElement("link"),Wn(c,"link",o),jn(c),b.head.appendChild(c)))}}function Qp(o){Js.D(o),ld("dns-prefetch",o,null)}function Jp(o,c){Js.C(o,c),ld("preconnect",o,c)}function em(o,c,m){Js.L(o,c,m);var b=Bo;if(b&&o&&c){var Se='link[rel="preload"][as="'+xs(c)+'"]';c==="image"&&m&&m.imageSrcSet?(Se+='[imagesrcset="'+xs(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(Se+='[imagesizes="'+xs(m.imageSizes)+'"]')):Se+='[href="'+xs(o)+'"]';var Ge=Se;switch(c){case"style":Ge=Co(o);break;case"script":Ge=So(o)}ws.has(Ge)||(o=g({rel:"preload",href:c==="image"&&m&&m.imageSrcSet?void 0:o,as:c},m),ws.set(Ge,o),b.querySelector(Se)!==null||c==="style"&&b.querySelector(ha(Ge))||c==="script"&&b.querySelector(pa(Ge))||(c=b.createElement("link"),Wn(c,"link",o),jn(c),b.head.appendChild(c)))}}function tm(o,c){Js.m(o,c);var m=Bo;if(m&&o){var b=c&&typeof c.as=="string"?c.as:"script",Se='link[rel="modulepreload"][as="'+xs(b)+'"][href="'+xs(o)+'"]',Ge=Se;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":Ge=So(o)}if(!ws.has(Ge)&&(o=g({rel:"modulepreload",href:o},c),ws.set(Ge,o),m.querySelector(Se)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(pa(Ge)))return}b=m.createElement("link"),Wn(b,"link",o),jn(b),m.head.appendChild(b)}}}function rm(o,c,m){Js.S(o,c,m);var b=Bo;if(b&&o){var Se=Rs(b).hoistableStyles,Ge=Co(o);c=c||"default";var Ot=Se.get(Ge);if(!Ot){var hr={loading:0,preload:null};if(Ot=b.querySelector(ha(Ge)))hr.loading=5;else{o=g({rel:"stylesheet",href:o,"data-precedence":c},m),(m=ws.get(Ge))&&F0(o,m);var Rr=Ot=b.createElement("link");jn(Rr),Wn(Rr,"link",o),Rr._p=new Promise(function(Ir,Lr){Rr.onload=Ir,Rr.onerror=Lr}),Rr.addEventListener("load",function(){hr.loading|=1}),Rr.addEventListener("error",function(){hr.loading|=2}),hr.loading|=4,wc(Ot,c,b)}Ot={type:"stylesheet",instance:Ot,count:1,state:hr},Se.set(Ge,Ot)}}}function nm(o,c){Js.X(o,c);var m=Bo;if(m&&o){var b=Rs(m).hoistableScripts,Se=So(o),Ge=b.get(Se);Ge||(Ge=m.querySelector(pa(Se)),Ge||(o=g({src:o,async:!0},c),(c=ws.get(Se))&&T0(o,c),Ge=m.createElement("script"),jn(Ge),Wn(Ge,"link",o),m.head.appendChild(Ge)),Ge={type:"script",instance:Ge,count:1,state:null},b.set(Se,Ge))}}function sm(o,c){Js.M(o,c);var m=Bo;if(m&&o){var b=Rs(m).hoistableScripts,Se=So(o),Ge=b.get(Se);Ge||(Ge=m.querySelector(pa(Se)),Ge||(o=g({src:o,async:!0,type:"module"},c),(c=ws.get(Se))&&T0(o,c),Ge=m.createElement("script"),jn(Ge),Wn(Ge,"link",o),m.head.appendChild(Ge)),Ge={type:"script",instance:Ge,count:1,state:null},b.set(Se,Ge))}}function ud(o,c,m,b){var Se=(Se=er.current)?bc(Se):null;if(!Se)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(c=Co(m.href),m=Rs(Se).hoistableStyles,b=m.get(c),b||(b={type:"style",instance:null,count:0,state:null},m.set(c,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){o=Co(m.href);var Ge=Rs(Se).hoistableStyles,Ot=Ge.get(o);if(Ot||(Se=Se.ownerDocument||Se,Ot={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},Ge.set(o,Ot),(Ge=Se.querySelector(ha(o)))&&!Ge._p&&(Ot.instance=Ge,Ot.state.loading=5),ws.has(o)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},ws.set(o,m),Ge||im(Se,o,m,Ot.state))),c&&b===null)throw Error(n(528,""));return Ot}if(c&&b!==null)throw Error(n(529,""));return null;case"script":return c=m.async,m=m.src,typeof m=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=So(m),m=Rs(Se).hoistableScripts,b=m.get(c),b||(b={type:"script",instance:null,count:0,state:null},m.set(c,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function Co(o){return'href="'+xs(o)+'"'}function ha(o){return'link[rel="stylesheet"]['+o+"]"}function fd(o){return g({},o,{"data-precedence":o.precedence,precedence:null})}function im(o,c,m,b){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?b.loading=1:(c=o.createElement("link"),b.preload=c,c.addEventListener("load",function(){return b.loading|=1}),c.addEventListener("error",function(){return b.loading|=2}),Wn(c,"link",m),jn(c),o.head.appendChild(c))}function So(o){return'[src="'+xs(o)+'"]'}function pa(o){return"script[async]"+o}function xd(o,c,m){if(c.count++,c.instance===null)switch(c.type){case"style":var b=o.querySelector('style[data-href~="'+xs(m.href)+'"]');if(b)return c.instance=b,jn(b),b;var Se=g({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return b=(o.ownerDocument||o).createElement("style"),jn(b),Wn(b,"style",Se),wc(b,m.precedence,o),c.instance=b;case"stylesheet":Se=Co(m.href);var Ge=o.querySelector(ha(Se));if(Ge)return c.state.loading|=4,c.instance=Ge,jn(Ge),Ge;b=fd(m),(Se=ws.get(Se))&&F0(b,Se),Ge=(o.ownerDocument||o).createElement("link"),jn(Ge);var Ot=Ge;return Ot._p=new Promise(function(hr,Rr){Ot.onload=hr,Ot.onerror=Rr}),Wn(Ge,"link",b),c.state.loading|=4,wc(Ge,m.precedence,o),c.instance=Ge;case"script":return Ge=So(m.src),(Se=o.querySelector(pa(Ge)))?(c.instance=Se,jn(Se),Se):(b=m,(Se=ws.get(Ge))&&(b=g({},m),T0(b,Se)),o=o.ownerDocument||o,Se=o.createElement("script"),jn(Se),Wn(Se,"link",b),o.head.appendChild(Se),c.instance=Se);case"void":return null;default:throw Error(n(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(b=c.instance,c.state.loading|=4,wc(b,m.precedence,o));return c.instance}function wc(o,c,m){for(var b=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),Se=b.length?b[b.length-1]:null,Ge=Se,Ot=0;Ot<b.length;Ot++){var hr=b[Ot];if(hr.dataset.precedence===c)Ge=hr;else if(Ge!==Se)break}Ge?Ge.parentNode.insertBefore(o,Ge.nextSibling):(c=m.nodeType===9?m.head:m,c.insertBefore(o,c.firstChild))}function F0(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function T0(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var vc=null;function dd(o,c,m){if(vc===null){var b=new Map,Se=vc=new Map;Se.set(m,b)}else Se=vc,b=Se.get(m),b||(b=new Map,Se.set(m,b));if(b.has(o))return b;for(b.set(o,null),m=m.getElementsByTagName(o),Se=0;Se<m.length;Se++){var Ge=m[Se];if(!(Ge[Ts]||Ge[rn]||o==="link"&&Ge.getAttribute("rel")==="stylesheet")&&Ge.namespaceURI!=="http://www.w3.org/2000/svg"){var Ot=Ge.getAttribute(c)||"";Ot=o+Ot;var hr=b.get(Ot);hr?hr.push(Ge):b.set(Ot,[Ge])}}return b}function hd(o,c,m){o=o.ownerDocument||o,o.head.insertBefore(m,c==="title"?o.querySelector("head > title"):null)}function om(o,c,m){if(m===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return o=c.disabled,typeof c.precedence=="string"&&o==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function pd(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function am(o,c,m,b){if(m.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var Se=Co(b.href),Ge=c.querySelector(ha(Se));if(Ge){c=Ge._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(o.count++,o=Ac.bind(o),c.then(o,o)),m.state.loading|=4,m.instance=Ge,jn(Ge);return}Ge=c.ownerDocument||c,b=fd(b),(Se=ws.get(Se))&&F0(b,Se),Ge=Ge.createElement("link"),jn(Ge);var Ot=Ge;Ot._p=new Promise(function(hr,Rr){Ot.onload=hr,Ot.onerror=Rr}),Wn(Ge,"link",b),m.instance=Ge}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(m,c),(c=m.state.preload)&&(m.state.loading&3)===0&&(o.count++,m=Ac.bind(o),c.addEventListener("load",m),c.addEventListener("error",m))}}var $0=0;function cm(o,c){return o.stylesheets&&o.count===0&&Cc(o,o.stylesheets),0<o.count||0<o.imgCount?function(m){var b=setTimeout(function(){if(o.stylesheets&&Cc(o,o.stylesheets),o.unsuspend){var Ge=o.unsuspend;o.unsuspend=null,Ge()}},6e4+c);0<o.imgBytes&&$0===0&&($0=62500*Hp());var Se=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&Cc(o,o.stylesheets),o.unsuspend)){var Ge=o.unsuspend;o.unsuspend=null,Ge()}},(o.imgBytes>$0?50:800)+c);return o.unsuspend=m,function(){o.unsuspend=null,clearTimeout(b),clearTimeout(Se)}}:null}function Ac(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cc(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Bc=null;function Cc(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Bc=new Map,c.forEach(lm,o),Bc=null,Ac.call(o))}function lm(o,c){if(!(c.state.loading&4)){var m=Bc.get(o);if(m)var b=m.get(null);else{m=new Map,Bc.set(o,m);for(var Se=o.querySelectorAll("link[data-precedence],style[data-precedence]"),Ge=0;Ge<Se.length;Ge++){var Ot=Se[Ge];(Ot.nodeName==="LINK"||Ot.getAttribute("media")!=="not all")&&(m.set(Ot.dataset.precedence,Ot),b=Ot)}b&&m.set(null,b)}Se=c.instance,Ot=Se.getAttribute("data-precedence"),Ge=m.get(Ot)||b,Ge===b&&m.set(null,Se),m.set(Ot,Se),this.count++,b=Ac.bind(this),Se.addEventListener("load",b),Se.addEventListener("error",b),Ge?Ge.parentNode.insertBefore(Se,Ge.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(Se,o.firstChild)),c.state.loading|=4}}var ma={$$typeof:q,Provider:null,Consumer:null,_currentValue:Le,_currentValue2:Le,_threadCount:0};function um(o,c,m,b,Se,Ge,Ot,hr,Rr){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fr(0),this.hiddenUpdates=fr(null),this.identifierPrefix=b,this.onUncaughtError=Se,this.onCaughtError=Ge,this.onRecoverableError=Ot,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Rr,this.incompleteTransitions=new Map}function md(o,c,m,b,Se,Ge,Ot,hr,Rr,Ir,Lr,Kr){return o=new um(o,c,m,Ot,Rr,Ir,Lr,Kr,hr),c=1,Ge===!0&&(c|=24),Ge=ss(3,null,null,c),o.current=Ge,Ge.stateNode=o,c=hl(),c.refCount++,o.pooledCache=c,c.refCount++,Ge.memoizedState={element:b,isDehydrated:m,cache:c},yl(Ge),o}function gd(o){return o?(o=ro,o):ro}function yd(o,c,m,b,Se,Ge){Se=gd(Se),b.context===null?b.context=Se:b.pendingContext=Se,b=oi(c),b.payload={element:m},Ge=Ge===void 0?null:Ge,Ge!==null&&(b.callback=Ge),m=ai(o,b,c),m!==null&&(rs(m,o,c),Wo(m,o,c))}function Ed(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var m=o.retryLane;o.retryLane=m!==0&&m<c?m:c}}function I0(o,c){Ed(o,c),(o=o.alternate)&&Ed(o,c)}function bd(o){if(o.tag===13||o.tag===31){var c=ki(o,67108864);c!==null&&rs(c,o,67108864),I0(o,67108864)}}function wd(o){if(o.tag===13||o.tag===31){var c=us();c=Or(c);var m=ki(o,c);m!==null&&rs(m,o,c),I0(o,c)}}var Sc=!0;function fm(o,c,m,b){var Se=Re.T;Re.T=null;var Ge=Fe.p;try{Fe.p=2,M0(o,c,m,b)}finally{Fe.p=Ge,Re.T=Se}}function xm(o,c,m,b){var Se=Re.T;Re.T=null;var Ge=Fe.p;try{Fe.p=8,M0(o,c,m,b)}finally{Fe.p=Ge,Re.T=Se}}function M0(o,c,m,b){if(Sc){var Se=P0(b);if(Se===null)A0(o,c,b,_c,m),Ad(o,b);else if(hm(Se,o,c,m,b))b.stopPropagation();else if(Ad(o,b),c&4&&-1<dm.indexOf(o)){for(;Se!==null;){var Ge=_s(Se);if(Ge!==null)switch(Ge.tag){case 3:if(Ge=Ge.stateNode,Ge.current.memoizedState.isDehydrated){var Ot=nn(Ge.pendingLanes);if(Ot!==0){var hr=Ge;for(hr.pendingLanes|=2,hr.entangledLanes|=2;Ot;){var Rr=1<<31-Nr(Ot);hr.entanglements[1]|=Rr,Ot&=~Rr}Fs(Ge),(yn&6)===0&&(lc=rr()+500,ua(0))}}break;case 31:case 13:hr=ki(Ge,2),hr!==null&&rs(hr,Ge,2),fc(),I0(Ge,2)}if(Ge=P0(b),Ge===null&&A0(o,c,b,_c,m),Ge===Se)break;Se=Ge}Se!==null&&b.stopPropagation()}else A0(o,c,b,null,m)}}function P0(o){return o=Oc(o),U0(o)}var _c=null;function U0(o){if(_c=null,o=Ss(o),o!==null){var c=a(o);if(c===null)o=null;else{var m=c.tag;if(m===13){if(o=l(c),o!==null)return o;o=null}else if(m===31){if(o=u(c),o!==null)return o;o=null}else if(m===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return _c=o,null}function vd(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(cr()){case Br:return 2;case br:return 8;case lr:case Sr:return 32;case yt:return 268435456;default:return 32}default:return 32}}var O0=!1,yi=null,Ei=null,bi=null,ga=new Map,ya=new Map,wi=[],dm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ad(o,c){switch(o){case"focusin":case"focusout":yi=null;break;case"dragenter":case"dragleave":Ei=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":ga.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ya.delete(c.pointerId)}}function Ea(o,c,m,b,Se,Ge){return o===null||o.nativeEvent!==Ge?(o={blockedOn:c,domEventName:m,eventSystemFlags:b,nativeEvent:Ge,targetContainers:[Se]},c!==null&&(c=_s(c),c!==null&&bd(c)),o):(o.eventSystemFlags|=b,c=o.targetContainers,Se!==null&&c.indexOf(Se)===-1&&c.push(Se),o)}function hm(o,c,m,b,Se){switch(c){case"focusin":return yi=Ea(yi,o,c,m,b,Se),!0;case"dragenter":return Ei=Ea(Ei,o,c,m,b,Se),!0;case"mouseover":return bi=Ea(bi,o,c,m,b,Se),!0;case"pointerover":var Ge=Se.pointerId;return ga.set(Ge,Ea(ga.get(Ge)||null,o,c,m,b,Se)),!0;case"gotpointercapture":return Ge=Se.pointerId,ya.set(Ge,Ea(ya.get(Ge)||null,o,c,m,b,Se)),!0}return!1}function Bd(o){var c=Ss(o.target);if(c!==null){var m=a(c);if(m!==null){if(c=m.tag,c===13){if(c=l(m),c!==null){o.blockedOn=c,tn(o.priority,function(){wd(m)});return}}else if(c===31){if(c=u(m),c!==null){o.blockedOn=c,tn(o.priority,function(){wd(m)});return}}else if(c===3&&m.stateNode.current.memoizedState.isDehydrated){o.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Rc(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var m=P0(o.nativeEvent);if(m===null){m=o.nativeEvent;var b=new m.constructor(m.type,m);Uc=b,m.target.dispatchEvent(b),Uc=null}else return c=_s(m),c!==null&&bd(c),o.blockedOn=m,!1;c.shift()}return!0}function Cd(o,c,m){Rc(o)&&m.delete(c)}function pm(){O0=!1,yi!==null&&Rc(yi)&&(yi=null),Ei!==null&&Rc(Ei)&&(Ei=null),bi!==null&&Rc(bi)&&(bi=null),ga.forEach(Cd),ya.forEach(Cd)}function kc(o,c){o.blockedOn===c&&(o.blockedOn=null,O0||(O0=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,pm)))}var Dc=null;function Sd(o){Dc!==o&&(Dc=o,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Dc===o&&(Dc=null);for(var c=0;c<o.length;c+=3){var m=o[c],b=o[c+1],Se=o[c+2];if(typeof b!="function"){if(U0(b||m)===null)continue;break}var Ge=_s(m);Ge!==null&&(o.splice(c,3),c-=3,Pl(Ge,{pending:!0,data:Se,method:m.method,action:b},b,Se))}}))}function _o(o){function c(Rr){return kc(Rr,o)}yi!==null&&kc(yi,o),Ei!==null&&kc(Ei,o),bi!==null&&kc(bi,o),ga.forEach(c),ya.forEach(c);for(var m=0;m<wi.length;m++){var b=wi[m];b.blockedOn===o&&(b.blockedOn=null)}for(;0<wi.length&&(m=wi[0],m.blockedOn===null);)Bd(m),m.blockedOn===null&&wi.shift();if(m=(o.ownerDocument||o).$$reactFormReplay,m!=null)for(b=0;b<m.length;b+=3){var Se=m[b],Ge=m[b+1],Ot=Se[dn]||null;if(typeof Ge=="function")Ot||Sd(m);else if(Ot){var hr=null;if(Ge&&Ge.hasAttribute("formAction")){if(Se=Ge,Ot=Ge[dn]||null)hr=Ot.formAction;else if(U0(Se)!==null)continue}else hr=Ot.action;typeof hr=="function"?m[b+1]=hr:(m.splice(b,3),b-=3),Sd(m)}}}function _d(){function o(Ge){Ge.canIntercept&&Ge.info==="react-transition"&&Ge.intercept({handler:function(){return new Promise(function(Ot){return Se=Ot})},focusReset:"manual",scroll:"manual"})}function c(){Se!==null&&(Se(),Se=null),b||setTimeout(m,20)}function m(){if(!b&&!navigation.transition){var Ge=navigation.currentEntry;Ge&&Ge.url!=null&&navigation.navigate(Ge.url,{state:Ge.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var b=!1,Se=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(m,100),function(){b=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),Se!==null&&(Se(),Se=null)}}}function L0(o){this._internalRoot=o}Nc.prototype.render=L0.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(n(409));var m=c.current,b=us();yd(m,b,o,c,null,null)},Nc.prototype.unmount=L0.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;yd(o.current,2,null,o,null,null),fc(),c[_n]=null}};function Nc(o){this._internalRoot=o}Nc.prototype.unstable_scheduleHydration=function(o){if(o){var c=An();o={blockedOn:null,target:o,priority:c};for(var m=0;m<wi.length&&c!==0&&c<wi[m].priority;m++);wi.splice(m,0,o),m===0&&Bd(o)}};var Rd=t.version;if(Rd!=="19.2.0")throw Error(n(527,Rd,"19.2.0"));Fe.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=f(c),o=o!==null?p(o):null,o=o===null?null:o.stateNode,o};var mm={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Re,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jc.isDisabled&&jc.supportsFiber)try{or=jc.inject(mm),Ar=jc}catch{}}return reactDomClient_production.createRoot=function(o,c){if(!s(o))throw Error(n(299));var m=!1,b="",Se=$f,Ge=If,Ot=Mf;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(b=c.identifierPrefix),c.onUncaughtError!==void 0&&(Se=c.onUncaughtError),c.onCaughtError!==void 0&&(Ge=c.onCaughtError),c.onRecoverableError!==void 0&&(Ot=c.onRecoverableError)),c=md(o,1,!1,null,null,m,b,null,Se,Ge,Ot,_d),o[_n]=c.current,v0(o),new L0(c)},reactDomClient_production.hydrateRoot=function(o,c,m){if(!s(o))throw Error(n(299));var b=!1,Se="",Ge=$f,Ot=If,hr=Mf,Rr=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(Se=m.identifierPrefix),m.onUncaughtError!==void 0&&(Ge=m.onUncaughtError),m.onCaughtError!==void 0&&(Ot=m.onCaughtError),m.onRecoverableError!==void 0&&(hr=m.onRecoverableError),m.formState!==void 0&&(Rr=m.formState)),c=md(o,1,!0,c,m??null,b,Se,Rr,Ge,Ot,hr,_d),c.context=gd(null),m=c.current,b=us(),b=Or(b),Se=oi(b),Se.callback=null,ai(m,Se,b),m=b,c.current.lanes=m,ht(c,m),Fs(c),o[_n]=c.current,v0(o),new Nc(c)},reactDomClient_production.version="19.2.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient(),reactExports=requireReact();const React=getDefaultExportFromCjs$1(reactExports),createStoreImpl=e=>{let t;const r=new Set,n=(f,p)=>{const g=typeof f=="function"?f(t):f;if(!Object.is(g,t)){const y=t;t=p??(typeof g!="object"||g===null)?g:Object.assign({},t,g),r.forEach(w=>w(t,y))}},s=()=>t,u={setState:n,getState:s,getInitialState:()=>x,subscribe:f=>(r.add(f),()=>r.delete(f))},x=t=e(n,s,u);return u},createStore$1=(e=>e?createStoreImpl(e):createStoreImpl),identity=e=>e;function useStore(e,t=identity){const r=React.useSyncExternalStore(e.subscribe,React.useCallback(()=>t(e.getState()),[e,t]),React.useCallback(()=>t(e.getInitialState()),[e,t]));return React.useDebugValue(r),r}const createImpl=e=>{const t=createStore$1(e),r=n=>useStore(t,n);return Object.assign(r,t),r},create=(e=>e?createImpl(e):createImpl);function createJSONStorage(e,t){let r;try{r=e()}catch{return}return{getItem:s=>{var a;const l=x=>x===null?null:JSON.parse(x,void 0),u=(a=r.getItem(s))!=null?a:null;return u instanceof Promise?u.then(l):l(u)},setItem:(s,a)=>r.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>r.removeItem(s)}}const toThenable=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return toThenable(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return toThenable(n)(r)}}}},persistImpl=(e,t)=>(r,n,s)=>{let a={storage:createJSONStorage(()=>localStorage),partialize:I=>I,version:0,merge:(I,k)=>({...k,...I}),...t},l=!1;const u=new Set,x=new Set;let f=a.storage;if(!f)return e((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...I)},n,s);const p=()=>{const I=a.partialize({...n()});return f.setItem(a.name,{state:I,version:a.version})},g=s.setState;s.setState=(I,k)=>(g(I,k),p());const y=e((...I)=>(r(...I),p()),n,s);s.getInitialState=()=>y;let w;const R=()=>{var I,k;if(!f)return;l=!1,u.forEach(Ve=>{var q;return Ve((q=n())!=null?q:y)});const je=((k=a.onRehydrateStorage)==null?void 0:k.call(a,(I=n())!=null?I:y))||void 0;return toThenable(f.getItem.bind(f))(a.name).then(Ve=>{if(Ve)if(typeof Ve.version=="number"&&Ve.version!==a.version){if(a.migrate){const q=a.migrate(Ve.state,Ve.version);return q instanceof Promise?q.then($e=>[!0,$e]):[!0,q]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,Ve.state];return[!1,void 0]}).then(Ve=>{var q;const[$e,We]=Ve;if(w=a.merge(We,(q=n())!=null?q:y),r(w,!0),$e)return p()}).then(()=>{je?.(w,void 0),w=n(),l=!0,x.forEach(Ve=>Ve(w))}).catch(Ve=>{je?.(void 0,Ve)})};return s.persist={setOptions:I=>{a={...a,...I},I.storage&&(f=I.storage)},clearStorage:()=>{f?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>R(),hasHydrated:()=>l,onHydrate:I=>(u.add(I),()=>{u.delete(I)}),onFinishHydration:I=>(x.add(I),()=>{x.delete(I)})},a.skipHydration||R(),w||y},persist=persistImpl,scriptRel="modulepreload",assetsURL=function(e,t){return new URL(e,t).href},seen={},__vitePreload=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let f=function(p){return Promise.all(p.map(g=>Promise.resolve(g).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};const l=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),x=u?.nonce||u?.getAttribute("nonce");s=f(r.map(p=>{if(p=assetsURL(p,n),p in seen)return;seen[p]=!0;const g=p.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(n)for(let R=l.length-1;R>=0;R--){const I=l[R];if(I.href===p&&(!g||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${p}"]${y}`))return;const w=document.createElement("link");if(w.rel=g?"stylesheet":scriptRel,g||(w.as="script"),w.crossOrigin="",w.href=p,x&&w.setAttribute("nonce",x),document.head.appendChild(w),g)return new Promise((R,I)=>{w.addEventListener("load",R),w.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return s.then(l=>{for(const u of l||[])u.status==="rejected"&&a(u.reason);return t().catch(a)})},crypto$5=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function isBytes$6(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber$5(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function abytes$2(e,...t){if(!isBytes$6(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ahash$2(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");anumber$5(e.outputLen),anumber$5(e.blockLen)}function aexists$2(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput$2(e,t){abytes$2(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function clean$2(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView$5(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr$4(e,t){return e<<32-t|e>>>t}function rotl$3(e,t){return e<<t|e>>>32-t>>>0}const hasHexBuiltin$1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes$4=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$5(e){if(abytes$2(e),hasHexBuiltin$1)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=hexes$4[e[r]];return t}const asciis$2={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16$2(e){if(e>=asciis$2._0&&e<=asciis$2._9)return e-asciis$2._0;if(e>=asciis$2.A&&e<=asciis$2.F)return e-(asciis$2.A-10);if(e>=asciis$2.a&&e<=asciis$2.f)return e-(asciis$2.a-10)}function hexToBytes$7(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(hasHexBuiltin$1)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let s=0,a=0;s<r;s++,a+=2){const l=asciiToBase16$2(e.charCodeAt(a)),u=asciiToBase16$2(e.charCodeAt(a+1));if(l===void 0||u===void 0){const x=e[a]+e[a+1];throw new Error('hex string expected, got non-hex character "'+x+'" at index '+a)}n[s]=l*16+u}return n}function utf8ToBytes$5(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function toBytes$3(e){return typeof e=="string"&&(e=utf8ToBytes$5(e)),abytes$2(e),e}function concatBytes$4(...e){let t=0;for(let n=0;n<e.length;n++){const s=e[n];abytes$2(s),t+=s.length}const r=new Uint8Array(t);for(let n=0,s=0;n<e.length;n++){const a=e[n];r.set(a,s),s+=a.length}return r}let Hash$2=class{};function createHasher$2(e){const t=n=>e().update(toBytes$3(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function randomBytes$4(e=32){if(crypto$5&&typeof crypto$5.getRandomValues=="function")return crypto$5.getRandomValues(new Uint8Array(e));if(crypto$5&&typeof crypto$5.randomBytes=="function")return Uint8Array.from(crypto$5.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$3(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const s=BigInt(32),a=BigInt(4294967295),l=Number(r>>s&a),u=Number(r&a),x=n?4:0,f=n?0:4;e.setUint32(t+x,l,n),e.setUint32(t+f,u,n)}function Chi$4(e,t,r){return e&t^~e&r}function Maj$4(e,t,r){return e&t^e&r^t&r}let HashMD$2=class extends Hash$2{constructor(t,r,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(t),this.view=createView$5(this.buffer)}update(t){aexists$2(this),t=toBytes$3(t),abytes$2(t);const{view:r,buffer:n,blockLen:s}=this,a=t.length;for(let l=0;l<a;){const u=Math.min(s-this.pos,a-l);if(u===s){const x=createView$5(t);for(;s<=a-l;l+=s)this.process(x,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists$2(this),aoutput$2(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:a}=this;let{pos:l}=this;r[l++]=128,clean$2(this.buffer.subarray(l)),this.padOffset>s-l&&(this.process(n,0),l=0);for(let g=l;g<s;g++)r[g]=0;setBigUint64$3(n,s-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$5(t),x=this.outputLen;if(x%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=x/4,p=this.get();if(f>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<f;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:a,destroyed:l,pos:u}=this;return t.destroyed=l,t.finished=a,t.length=s,t.pos=u,s%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}};const SHA256_IV$2=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA512_IV$2=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),U32_MASK64$2=BigInt(2**32-1),_32n$2=BigInt(32);function fromBig$2(e,t=!1){return t?{h:Number(e&U32_MASK64$2),l:Number(e>>_32n$2&U32_MASK64$2)}:{h:Number(e>>_32n$2&U32_MASK64$2)|0,l:Number(e&U32_MASK64$2)|0}}function split$2(e,t=!1){const r=e.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let a=0;a<r;a++){const{h:l,l:u}=fromBig$2(e[a],t);[n[a],s[a]]=[l,u]}return[n,s]}const shrSH$2=(e,t,r)=>e>>>r,shrSL$2=(e,t,r)=>e<<32-r|t>>>r,rotrSH$2=(e,t,r)=>e>>>r|t<<32-r,rotrSL$2=(e,t,r)=>e<<32-r|t>>>r,rotrBH$2=(e,t,r)=>e<<64-r|t>>>r-32,rotrBL$2=(e,t,r)=>e>>>r-32|t<<64-r;function add$2(e,t,r,n){const s=(t>>>0)+(n>>>0);return{h:e+r+(s/2**32|0)|0,l:s|0}}const add3L$2=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H$2=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L$2=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H$2=(e,t,r,n,s)=>t+r+n+s+(e/2**32|0)|0,add5L$2=(e,t,r,n,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(s>>>0),add5H$2=(e,t,r,n,s,a)=>t+r+n+s+a+(e/2**32|0)|0,SHA256_K$4=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W$4=new Uint32Array(64);let SHA256$2=class extends HashMD$2{constructor(t=32){super(64,t,8,!1),this.A=SHA256_IV$2[0]|0,this.B=SHA256_IV$2[1]|0,this.C=SHA256_IV$2[2]|0,this.D=SHA256_IV$2[3]|0,this.E=SHA256_IV$2[4]|0,this.F=SHA256_IV$2[5]|0,this.G=SHA256_IV$2[6]|0,this.H=SHA256_IV$2[7]|0}get(){const{A:t,B:r,C:n,D:s,E:a,F:l,G:u,H:x}=this;return[t,r,n,s,a,l,u,x]}set(t,r,n,s,a,l,u,x){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=x|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W$4[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W$4[g-15],w=SHA256_W$4[g-2],R=rotr$4(y,7)^rotr$4(y,18)^y>>>3,I=rotr$4(w,17)^rotr$4(w,19)^w>>>10;SHA256_W$4[g]=I+SHA256_W$4[g-7]+R+SHA256_W$4[g-16]|0}let{A:n,B:s,C:a,D:l,E:u,F:x,G:f,H:p}=this;for(let g=0;g<64;g++){const y=rotr$4(u,6)^rotr$4(u,11)^rotr$4(u,25),w=p+y+Chi$4(u,x,f)+SHA256_K$4[g]+SHA256_W$4[g]|0,I=(rotr$4(n,2)^rotr$4(n,13)^rotr$4(n,22))+Maj$4(n,s,a)|0;p=f,f=x,x=u,u=l+w|0,l=a,a=s,s=n,n=w+I|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,x=x+this.F|0,f=f+this.G|0,p=p+this.H|0,this.set(n,s,a,l,u,x,f,p)}roundClean(){clean$2(SHA256_W$4)}destroy(){this.set(0,0,0,0,0,0,0,0),clean$2(this.buffer)}};const K512$2=split$2(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),SHA512_Kh$2=K512$2[0],SHA512_Kl$2=K512$2[1],SHA512_W_H$2=new Uint32Array(80),SHA512_W_L$2=new Uint32Array(80);class SHA512 extends HashMD$2{constructor(t=64){super(128,t,16,!1),this.Ah=SHA512_IV$2[0]|0,this.Al=SHA512_IV$2[1]|0,this.Bh=SHA512_IV$2[2]|0,this.Bl=SHA512_IV$2[3]|0,this.Ch=SHA512_IV$2[4]|0,this.Cl=SHA512_IV$2[5]|0,this.Dh=SHA512_IV$2[6]|0,this.Dl=SHA512_IV$2[7]|0,this.Eh=SHA512_IV$2[8]|0,this.El=SHA512_IV$2[9]|0,this.Fh=SHA512_IV$2[10]|0,this.Fl=SHA512_IV$2[11]|0,this.Gh=SHA512_IV$2[12]|0,this.Gl=SHA512_IV$2[13]|0,this.Hh=SHA512_IV$2[14]|0,this.Hl=SHA512_IV$2[15]|0}get(){const{Ah:t,Al:r,Bh:n,Bl:s,Ch:a,Cl:l,Dh:u,Dl:x,Eh:f,El:p,Fh:g,Fl:y,Gh:w,Gl:R,Hh:I,Hl:k}=this;return[t,r,n,s,a,l,u,x,f,p,g,y,w,R,I,k]}set(t,r,n,s,a,l,u,x,f,p,g,y,w,R,I,k){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=a|0,this.Cl=l|0,this.Dh=u|0,this.Dl=x|0,this.Eh=f|0,this.El=p|0,this.Fh=g|0,this.Fl=y|0,this.Gh=w|0,this.Gl=R|0,this.Hh=I|0,this.Hl=k|0}process(t,r){for(let q=0;q<16;q++,r+=4)SHA512_W_H$2[q]=t.getUint32(r),SHA512_W_L$2[q]=t.getUint32(r+=4);for(let q=16;q<80;q++){const $e=SHA512_W_H$2[q-15]|0,We=SHA512_W_L$2[q-15]|0,K=rotrSH$2($e,We,1)^rotrSH$2($e,We,8)^shrSH$2($e,We,7),W=rotrSL$2($e,We,1)^rotrSL$2($e,We,8)^shrSL$2($e,We,7),Ye=SHA512_W_H$2[q-2]|0,Qe=SHA512_W_L$2[q-2]|0,it=rotrSH$2(Ye,Qe,19)^rotrBH$2(Ye,Qe,61)^shrSH$2(Ye,Qe,6),ze=rotrSL$2(Ye,Qe,19)^rotrBL$2(Ye,Qe,61)^shrSL$2(Ye,Qe,6),v=add4L$2(W,ze,SHA512_W_L$2[q-7],SHA512_W_L$2[q-16]),D=add4H$2(v,K,it,SHA512_W_H$2[q-7],SHA512_W_H$2[q-16]);SHA512_W_H$2[q]=D|0,SHA512_W_L$2[q]=v|0}let{Ah:n,Al:s,Bh:a,Bl:l,Ch:u,Cl:x,Dh:f,Dl:p,Eh:g,El:y,Fh:w,Fl:R,Gh:I,Gl:k,Hh:je,Hl:Ve}=this;for(let q=0;q<80;q++){const $e=rotrSH$2(g,y,14)^rotrSH$2(g,y,18)^rotrBH$2(g,y,41),We=rotrSL$2(g,y,14)^rotrSL$2(g,y,18)^rotrBL$2(g,y,41),K=g&w^~g&I,W=y&R^~y&k,Ye=add5L$2(Ve,We,W,SHA512_Kl$2[q],SHA512_W_L$2[q]),Qe=add5H$2(Ye,je,$e,K,SHA512_Kh$2[q],SHA512_W_H$2[q]),it=Ye|0,ze=rotrSH$2(n,s,28)^rotrBH$2(n,s,34)^rotrBH$2(n,s,39),v=rotrSL$2(n,s,28)^rotrBL$2(n,s,34)^rotrBL$2(n,s,39),D=n&a^n&u^a&u,_e=s&l^s&x^l&x;je=I|0,Ve=k|0,I=w|0,k=R|0,w=g|0,R=y|0,{h:g,l:y}=add$2(f|0,p|0,Qe|0,it|0),f=u|0,p=x|0,u=a|0,x=l|0,a=n|0,l=s|0;const P=add3L$2(it,v,_e);n=add3H$2(P,Qe,ze,D),s=P|0}({h:n,l:s}=add$2(this.Ah|0,this.Al|0,n|0,s|0)),{h:a,l}=add$2(this.Bh|0,this.Bl|0,a|0,l|0),{h:u,l:x}=add$2(this.Ch|0,this.Cl|0,u|0,x|0),{h:f,l:p}=add$2(this.Dh|0,this.Dl|0,f|0,p|0),{h:g,l:y}=add$2(this.Eh|0,this.El|0,g|0,y|0),{h:w,l:R}=add$2(this.Fh|0,this.Fl|0,w|0,R|0),{h:I,l:k}=add$2(this.Gh|0,this.Gl|0,I|0,k|0),{h:je,l:Ve}=add$2(this.Hh|0,this.Hl|0,je|0,Ve|0),this.set(n,s,a,l,u,x,f,p,g,y,w,R,I,k,je,Ve)}roundClean(){clean$2(SHA512_W_H$2,SHA512_W_L$2)}destroy(){clean$2(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const sha256$6=createHasher$2(()=>new SHA256$2),sha512$3=createHasher$2(()=>new SHA512);let HMAC$2=class extends Hash$2{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,ahash$2(t);const n=toBytes$3(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(n.length>s?t.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=t.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),clean$2(a)}update(t){return aexists$2(this),this.iHash.update(t),this}digestInto(t){aexists$2(this),abytes$2(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=s,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$5=(e,t,r)=>new HMAC$2(e,t).update(r).digest();hmac$5.create=(e,t)=>new HMAC$2(e,t);const _0n$d=BigInt(0),_1n$d=BigInt(1);function _abool2(e,t=""){if(typeof e!="boolean"){const r=t&&`"${t}"`;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function _abytes2(e,t,r=""){const n=isBytes$6(e),s=e?.length,a=t!==void 0;if(!n||a&&s!==t){const l=r&&`"${r}" `,u=a?` of length ${t}`:"",x=n?`length=${s}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+u+", got "+x)}return e}function numberToHexUnpadded$2(e){const t=e.toString(16);return t.length&1?"0"+t:t}function hexToNumber$2(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?_0n$d:BigInt("0x"+e)}function bytesToNumberBE$2(e){return hexToNumber$2(bytesToHex$5(e))}function bytesToNumberLE$2(e){return abytes$2(e),hexToNumber$2(bytesToHex$5(Uint8Array.from(e).reverse()))}function numberToBytesBE$2(e,t){return hexToBytes$7(e.toString(16).padStart(t*2,"0"))}function numberToBytesLE$2(e,t){return numberToBytesBE$2(e,t).reverse()}function ensureBytes$1(e,t,r){let n;if(typeof t=="string")try{n=hexToBytes$7(t)}catch(a){throw new Error(e+" must be hex string or Uint8Array, cause: "+a)}else if(isBytes$6(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(e+" of length "+r+" expected, got "+s);return n}const isPosBig$1=e=>typeof e=="bigint"&&_0n$d<=e;function inRange$1(e,t,r){return isPosBig$1(e)&&isPosBig$1(t)&&isPosBig$1(r)&&t<=e&&e<r}function aInRange$1(e,t,r,n){if(!inRange$1(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function bitLen$2(e){let t;for(t=0;e>_0n$d;e>>=_1n$d,t+=1);return t}const bitMask$2=e=>(_1n$d<<BigInt(e))-_1n$d;function createHmacDrbg$2(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");const n=w=>new Uint8Array(w),s=w=>Uint8Array.of(w);let a=n(e),l=n(e),u=0;const x=()=>{a.fill(1),l.fill(0),u=0},f=(...w)=>r(l,a,...w),p=(w=n(0))=>{l=f(s(0),w),a=f(),w.length!==0&&(l=f(s(1),w),a=f())},g=()=>{if(u++>=1e3)throw new Error("drbg: tried 1000 values");let w=0;const R=[];for(;w<t;){a=f();const I=a.slice();R.push(I),w+=a.length}return concatBytes$4(...R)};return(w,R)=>{x(),p(w);let I;for(;!(I=R(g()));)p();return x(),I}}function _validateObject(e,t,r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(s,a,l){const u=e[s];if(l&&u===void 0)return;const x=typeof u;if(x!==a||u===null)throw new Error(`param "${s}" is invalid: expected ${a}, got ${x}`)}Object.entries(t).forEach(([s,a])=>n(s,a,!1)),Object.entries(r).forEach(([s,a])=>n(s,a,!0))}function memoized$1(e){const t=new WeakMap;return(r,...n)=>{const s=t.get(r);if(s!==void 0)return s;const a=e(r,...n);return t.set(r,a),a}}const _0n$c=BigInt(0),_1n$c=BigInt(1),_2n$8=BigInt(2),_3n$5=BigInt(3),_4n$4=BigInt(4),_5n$2=BigInt(5),_7n$1=BigInt(7),_8n$2=BigInt(8),_9n$1=BigInt(9),_16n$1=BigInt(16);function mod$2(e,t){const r=e%t;return r>=_0n$c?r:t+r}function pow2$2(e,t,r){let n=e;for(;t-- >_0n$c;)n*=n,n%=r;return n}function invert$2(e,t){if(e===_0n$c)throw new Error("invert: expected non-zero number");if(t<=_0n$c)throw new Error("invert: expected positive modulus, got "+t);let r=mod$2(e,t),n=t,s=_0n$c,a=_1n$c;for(;r!==_0n$c;){const u=n/r,x=n%r,f=s-a*u;n=r,r=x,s=a,a=f}if(n!==_1n$c)throw new Error("invert: does not exist");return mod$2(s,t)}function assertIsSquare$1(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function sqrt3mod4$1(e,t){const r=(e.ORDER+_1n$c)/_4n$4,n=e.pow(t,r);return assertIsSquare$1(e,n,t),n}function sqrt5mod8$1(e,t){const r=(e.ORDER-_5n$2)/_8n$2,n=e.mul(t,_2n$8),s=e.pow(n,r),a=e.mul(t,s),l=e.mul(e.mul(a,_2n$8),s),u=e.mul(a,e.sub(l,e.ONE));return assertIsSquare$1(e,u,t),u}function sqrt9mod16$1(e){const t=Field$2(e),r=tonelliShanks$2(e),n=r(t,t.neg(t.ONE)),s=r(t,n),a=r(t,t.neg(n)),l=(e+_7n$1)/_16n$1;return(u,x)=>{let f=u.pow(x,l),p=u.mul(f,n);const g=u.mul(f,s),y=u.mul(f,a),w=u.eql(u.sqr(p),x),R=u.eql(u.sqr(g),x);f=u.cmov(f,p,w),p=u.cmov(y,g,R);const I=u.eql(u.sqr(p),x),k=u.cmov(f,p,I);return assertIsSquare$1(u,k,x),k}}function tonelliShanks$2(e){if(e<_3n$5)throw new Error("sqrt is not defined for small field");let t=e-_1n$c,r=0;for(;t%_2n$8===_0n$c;)t/=_2n$8,r++;let n=_2n$8;const s=Field$2(e);for(;FpLegendre$1(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return sqrt3mod4$1;let a=s.pow(n,t);const l=(t+_1n$c)/_2n$8;return function(x,f){if(x.is0(f))return f;if(FpLegendre$1(x,f)!==1)throw new Error("Cannot find square root");let p=r,g=x.mul(x.ONE,a),y=x.pow(f,t),w=x.pow(f,l);for(;!x.eql(y,x.ONE);){if(x.is0(y))return x.ZERO;let R=1,I=x.sqr(y);for(;!x.eql(I,x.ONE);)if(R++,I=x.sqr(I),R===p)throw new Error("Cannot find square root");const k=_1n$c<<BigInt(p-R-1),je=x.pow(g,k);p=R,g=x.sqr(je),y=x.mul(y,g),w=x.mul(w,je)}return w}}function FpSqrt$2(e){return e%_4n$4===_3n$5?sqrt3mod4$1:e%_8n$2===_5n$2?sqrt5mod8$1:e%_16n$1===_9n$1?sqrt9mod16$1(e):tonelliShanks$2(e)}const FIELD_FIELDS$2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$2(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=FIELD_FIELDS$2.reduce((n,s)=>(n[s]="function",n),t);return _validateObject(e,r),e}function FpPow$2(e,t,r){if(r<_0n$c)throw new Error("invalid exponent, negatives unsupported");if(r===_0n$c)return e.ONE;if(r===_1n$c)return t;let n=e.ONE,s=t;for(;r>_0n$c;)r&_1n$c&&(n=e.mul(n,s)),s=e.sqr(s),r>>=_1n$c;return n}function FpInvertBatch$2(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),s=t.reduce((l,u,x)=>e.is0(u)?l:(n[x]=l,e.mul(l,u)),e.ONE),a=e.inv(s);return t.reduceRight((l,u,x)=>e.is0(u)?l:(n[x]=e.mul(l,n[x]),e.mul(l,u)),a),n}function FpLegendre$1(e,t){const r=(e.ORDER-_1n$c)/_2n$8,n=e.pow(t,r),s=e.eql(n,e.ONE),a=e.eql(n,e.ZERO),l=e.eql(n,e.neg(e.ONE));if(!s&&!a&&!l)throw new Error("invalid Legendre symbol result");return s?1:a?0:-1}function nLength$2(e,t){t!==void 0&&anumber$5(t);const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Field$2(e,t,r=!1,n={}){if(e<=_0n$c)throw new Error("invalid field: expected ORDER > 0, got "+e);let s,a,l=!1,u;if(typeof t=="object"&&t!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const y=t;y.BITS&&(s=y.BITS),y.sqrt&&(a=y.sqrt),typeof y.isLE=="boolean"&&(r=y.isLE),typeof y.modFromBytes=="boolean"&&(l=y.modFromBytes),u=y.allowedLengths}else typeof t=="number"&&(s=t),n.sqrt&&(a=n.sqrt);const{nBitLength:x,nByteLength:f}=nLength$2(e,s);if(f>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let p;const g=Object.freeze({ORDER:e,isLE:r,BITS:x,BYTES:f,MASK:bitMask$2(x),ZERO:_0n$c,ONE:_1n$c,allowedLengths:u,create:y=>mod$2(y,e),isValid:y=>{if(typeof y!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof y);return _0n$c<=y&&y<e},is0:y=>y===_0n$c,isValidNot0:y=>!g.is0(y)&&g.isValid(y),isOdd:y=>(y&_1n$c)===_1n$c,neg:y=>mod$2(-y,e),eql:(y,w)=>y===w,sqr:y=>mod$2(y*y,e),add:(y,w)=>mod$2(y+w,e),sub:(y,w)=>mod$2(y-w,e),mul:(y,w)=>mod$2(y*w,e),pow:(y,w)=>FpPow$2(g,y,w),div:(y,w)=>mod$2(y*invert$2(w,e),e),sqrN:y=>y*y,addN:(y,w)=>y+w,subN:(y,w)=>y-w,mulN:(y,w)=>y*w,inv:y=>invert$2(y,e),sqrt:a||(y=>(p||(p=FpSqrt$2(e)),p(g,y))),toBytes:y=>r?numberToBytesLE$2(y,f):numberToBytesBE$2(y,f),fromBytes:(y,w=!0)=>{if(u){if(!u.includes(y.length)||y.length>f)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+y.length);const I=new Uint8Array(f);I.set(y,r?0:I.length-y.length),y=I}if(y.length!==f)throw new Error("Field.fromBytes: expected "+f+" bytes, got "+y.length);let R=r?bytesToNumberLE$2(y):bytesToNumberBE$2(y);if(l&&(R=mod$2(R,e)),!w&&!g.isValid(R))throw new Error("invalid field element: outside of range 0..ORDER");return R},invertBatch:y=>FpInvertBatch$2(g,y),cmov:(y,w,R)=>R?w:y});return Object.freeze(g)}function getFieldBytesLength$2(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength$2(e){const t=getFieldBytesLength$2(e);return t+Math.ceil(t/2)}function mapHashToField$2(e,t,r=!1){const n=e.length,s=getFieldBytesLength$2(t),a=getMinHashLength$2(t);if(n<16||n<a||n>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+n);const l=r?bytesToNumberLE$2(e):bytesToNumberBE$2(e),u=mod$2(l,t-_1n$c)+_1n$c;return r?numberToBytesLE$2(u,s):numberToBytesBE$2(u,s)}const _0n$b=BigInt(0),_1n$b=BigInt(1);function negateCt$1(e,t){const r=t.negate();return e?r:t}function normalizeZ$1(e,t){const r=FpInvertBatch$2(e.Fp,t.map(n=>n.Z));return t.map((n,s)=>e.fromAffine(n.toAffine(r[s])))}function validateW$1(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function calcWOpts$1(e,t){validateW$1(e,t);const r=Math.ceil(t/e)+1,n=2**(e-1),s=2**e,a=bitMask$2(e),l=BigInt(e);return{windows:r,windowSize:n,mask:a,maxNumber:s,shiftBy:l}}function calcOffsets$1(e,t,r){const{windowSize:n,mask:s,maxNumber:a,shiftBy:l}=r;let u=Number(e&s),x=e>>l;u>n&&(u-=a,x+=_1n$b);const f=t*n,p=f+Math.abs(u)-1,g=u===0,y=u<0,w=t%2!==0;return{nextN:x,offset:p,isZero:g,isNeg:y,isNegF:w,offsetF:f}}function validateMSMPoints(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function validateMSMScalars(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}const pointPrecomputes$1=new WeakMap,pointWindowSizes$1=new WeakMap;function getW$1(e){return pointWindowSizes$1.get(e)||1}function assert0$1(e){if(e!==_0n$b)throw new Error("invalid wNAF")}let wNAF$2=class{constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let s=t;for(;r>_0n$b;)r&_1n$b&&(n=n.add(s)),s=s.double(),r>>=_1n$b;return n}precomputeWindow(t,r){const{windows:n,windowSize:s}=calcWOpts$1(r,this.bits),a=[];let l=t,u=l;for(let x=0;x<n;x++){u=l,a.push(u);for(let f=1;f<s;f++)u=u.add(l),a.push(u);l=u.double()}return a}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,a=this.BASE;const l=calcWOpts$1(t,this.bits);for(let u=0;u<l.windows;u++){const{nextN:x,offset:f,isZero:p,isNeg:g,isNegF:y,offsetF:w}=calcOffsets$1(n,u,l);n=x,p?a=a.add(negateCt$1(y,r[w])):s=s.add(negateCt$1(g,r[f]))}return assert0$1(n),{p:s,f:a}}wNAFUnsafe(t,r,n,s=this.ZERO){const a=calcWOpts$1(t,this.bits);for(let l=0;l<a.windows&&n!==_0n$b;l++){const{nextN:u,offset:x,isZero:f,isNeg:p}=calcOffsets$1(n,l,a);if(n=u,!f){const g=r[x];s=s.add(p?g.negate():g)}}return assert0$1(n),s}getPrecomputes(t,r,n){let s=pointPrecomputes$1.get(r);return s||(s=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(s=n(s)),pointPrecomputes$1.set(r,s))),s}cached(t,r,n){const s=getW$1(t);return this.wNAF(s,this.getPrecomputes(s,t,n),r)}unsafe(t,r,n,s){const a=getW$1(t);return a===1?this._unsafeLadder(t,r,s):this.wNAFUnsafe(a,this.getPrecomputes(a,t,n),r,s)}createCache(t,r){validateW$1(r,this.bits),pointWindowSizes$1.set(t,r),pointPrecomputes$1.delete(t)}hasCache(t){return getW$1(t)!==1}};function mulEndoUnsafe$1(e,t,r,n){let s=t,a=e.ZERO,l=e.ZERO;for(;r>_0n$b||n>_0n$b;)r&_1n$b&&(a=a.add(s)),n&_1n$b&&(l=l.add(s)),s=s.double(),r>>=_1n$b,n>>=_1n$b;return{p1:a,p2:l}}function pippenger(e,t,r,n){validateMSMPoints(r,e),validateMSMScalars(n,t);const s=r.length,a=n.length;if(s!==a)throw new Error("arrays of points and scalars must have equal length");const l=e.ZERO,u=bitLen$2(BigInt(s));let x=1;u>12?x=u-3:u>4?x=u-2:u>0&&(x=2);const f=bitMask$2(x),p=new Array(Number(f)+1).fill(l),g=Math.floor((t.BITS-1)/x)*x;let y=l;for(let w=g;w>=0;w-=x){p.fill(l);for(let I=0;I<a;I++){const k=n[I],je=Number(k>>BigInt(w)&f);p[je]=p[je].add(r[I])}let R=l;for(let I=p.length-1,k=l;I>0;I--)k=k.add(p[I]),R=R.add(k);if(y=y.add(R),w!==0)for(let I=0;I<x;I++)y=y.double()}return y}function createField$1(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField$2(t),t}else return Field$2(e,{isLE:r})}function _createCurveFields(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const x of["p","n","h"]){const f=t[x];if(!(typeof f=="bigint"&&f>_0n$b))throw new Error(`CURVE.${x} must be positive bigint`)}const s=createField$1(t.p,r.Fp,n),a=createField$1(t.n,r.Fn,n),u=["Gx","Gy","a","b"];for(const x of u)if(!s.isValid(t[x]))throw new Error(`CURVE.${x} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:s,Fn:a}}const divNearest$2=(e,t)=>(e+(e>=0?t:-t)/_2n$7)/t;function _splitEndoScalar$1(e,t,r){const[[n,s],[a,l]]=t,u=divNearest$2(l*e,r),x=divNearest$2(-s*e,r);let f=e-u*n-x*a,p=-u*s-x*l;const g=f<_0n$a,y=p<_0n$a;g&&(f=-f),y&&(p=-p);const w=bitMask$2(Math.ceil(bitLen$2(r)/2))+_1n$a;if(f<_0n$a||f>=w||p<_0n$a||p>=w)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:g,k1:f,k2neg:y,k2:p}}function validateSigFormat$1(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function validateSigOpts$1(e,t){const r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return _abool2(r.lowS,"lowS"),_abool2(r.prehash,"prehash"),r.format!==void 0&&validateSigFormat$1(r.format),r}let DERErr$1=class extends Error{constructor(t=""){super(t)}};const DER$2={Err:DERErr$1,_tlv:{encode:(e,t)=>{const{Err:r}=DER$2;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");const n=t.length/2,s=numberToHexUnpadded$2(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const a=n>127?numberToHexUnpadded$2(s.length/2|128):"";return numberToHexUnpadded$2(e)+a+s+t},decode(e,t){const{Err:r}=DER$2;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const s=t[n++],a=!!(s&128);let l=0;if(!a)l=s;else{const x=s&127;if(!x)throw new r("tlv.decode(long): indefinite length not supported");if(x>4)throw new r("tlv.decode(long): byte length is too big");const f=t.subarray(n,n+x);if(f.length!==x)throw new r("tlv.decode: length bytes not complete");if(f[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const p of f)l=l<<8|p;if(n+=x,l<128)throw new r("tlv.decode(long): not minimal encoding")}const u=t.subarray(n,n+l);if(u.length!==l)throw new r("tlv.decode: wrong value length");return{v:u,l:t.subarray(n+l)}}},_int:{encode(e){const{Err:t}=DER$2;if(e<_0n$a)throw new t("integer: negative integers are not allowed");let r=numberToHexUnpadded$2(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=DER$2;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return bytesToNumberBE$2(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=DER$2,s=ensureBytes$1("signature",e),{v:a,l}=n.decode(48,s);if(l.length)throw new t("invalid signature: left bytes after parsing");const{v:u,l:x}=n.decode(2,a),{v:f,l:p}=n.decode(2,x);if(p.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(u),s:r.decode(f)}},hexFromSig(e){const{_tlv:t,_int:r}=DER$2,n=t.encode(2,r.encode(e.r)),s=t.encode(2,r.encode(e.s)),a=n+s;return t.encode(48,a)}},_0n$a=BigInt(0),_1n$a=BigInt(1),_2n$7=BigInt(2),_3n$4=BigInt(3),_4n$3=BigInt(4);function _normFnElement(e,t){const{BYTES:r}=e;let n;if(typeof t=="bigint")n=t;else{let s=ensureBytes$1("private key",t);try{n=e.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!e.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function weierstrassN(e,t={}){const r=_createCurveFields("weierstrass",e,t),{Fp:n,Fn:s}=r;let a=r.CURVE;const{h:l,n:u}=a;_validateObject(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:x}=t;if(x&&(!n.is0(a.a)||typeof x.beta!="bigint"||!Array.isArray(x.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const f=getWLengths$1(n,s);function p(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function g(v,D,_e){const{x:P,y:Re}=D.toAffine(),Fe=n.toBytes(P);if(_abool2(_e,"isCompressed"),_e){p();const Le=!n.isOdd(Re);return concatBytes$4(pprefix$1(Le),Fe)}else return concatBytes$4(Uint8Array.of(4),Fe,n.toBytes(Re))}function y(v){_abytes2(v,void 0,"Point");const{publicKey:D,publicKeyUncompressed:_e}=f,P=v.length,Re=v[0],Fe=v.subarray(1);if(P===D&&(Re===2||Re===3)){const Le=n.fromBytes(Fe);if(!n.isValid(Le))throw new Error("bad point: is not on curve, wrong x");const Ce=I(Le);let L;try{L=n.sqrt(Ce)}catch(lt){const Xe=lt instanceof Error?": "+lt.message:"";throw new Error("bad point: is not on curve, sqrt error"+Xe)}p();const O=n.isOdd(L);return(Re&1)===1!==O&&(L=n.neg(L)),{x:Le,y:L}}else if(P===_e&&Re===4){const Le=n.BYTES,Ce=n.fromBytes(Fe.subarray(0,Le)),L=n.fromBytes(Fe.subarray(Le,Le*2));if(!k(Ce,L))throw new Error("bad point: is not on curve");return{x:Ce,y:L}}else throw new Error(`bad point: got length ${P}, expected compressed=${D} or uncompressed=${_e}`)}const w=t.toBytes||g,R=t.fromBytes||y;function I(v){const D=n.sqr(v),_e=n.mul(D,v);return n.add(n.add(_e,n.mul(v,a.a)),a.b)}function k(v,D){const _e=n.sqr(D),P=I(v);return n.eql(_e,P)}if(!k(a.Gx,a.Gy))throw new Error("bad curve params: generator point");const je=n.mul(n.pow(a.a,_3n$4),_4n$3),Ve=n.mul(n.sqr(a.b),BigInt(27));if(n.is0(n.add(je,Ve)))throw new Error("bad curve params: a or b");function q(v,D,_e=!1){if(!n.isValid(D)||_e&&n.is0(D))throw new Error(`bad point coordinate ${v}`);return D}function $e(v){if(!(v instanceof Qe))throw new Error("ProjectivePoint expected")}function We(v){if(!x||!x.basises)throw new Error("no endo");return _splitEndoScalar$1(v,x.basises,s.ORDER)}const K=memoized$1((v,D)=>{const{X:_e,Y:P,Z:Re}=v;if(n.eql(Re,n.ONE))return{x:_e,y:P};const Fe=v.is0();D==null&&(D=Fe?n.ONE:n.inv(Re));const Le=n.mul(_e,D),Ce=n.mul(P,D),L=n.mul(Re,D);if(Fe)return{x:n.ZERO,y:n.ZERO};if(!n.eql(L,n.ONE))throw new Error("invZ was invalid");return{x:Le,y:Ce}}),W=memoized$1(v=>{if(v.is0()){if(t.allowInfinityPoint&&!n.is0(v.Y))return;throw new Error("bad point: ZERO")}const{x:D,y:_e}=v.toAffine();if(!n.isValid(D)||!n.isValid(_e))throw new Error("bad point: x or y not field elements");if(!k(D,_e))throw new Error("bad point: equation left != right");if(!v.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function Ye(v,D,_e,P,Re){return _e=new Qe(n.mul(_e.X,v),_e.Y,_e.Z),D=negateCt$1(P,D),_e=negateCt$1(Re,_e),D.add(_e)}class Qe{constructor(D,_e,P){this.X=q("x",D),this.Y=q("y",_e,!0),this.Z=q("z",P),Object.freeze(this)}static CURVE(){return a}static fromAffine(D){const{x:_e,y:P}=D||{};if(!D||!n.isValid(_e)||!n.isValid(P))throw new Error("invalid affine point");if(D instanceof Qe)throw new Error("projective point not allowed");return n.is0(_e)&&n.is0(P)?Qe.ZERO:new Qe(_e,P,n.ONE)}static fromBytes(D){const _e=Qe.fromAffine(R(_abytes2(D,void 0,"point")));return _e.assertValidity(),_e}static fromHex(D){return Qe.fromBytes(ensureBytes$1("pointHex",D))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(D=8,_e=!0){return ze.createCache(this,D),_e||this.multiply(_3n$4),this}assertValidity(){W(this)}hasEvenY(){const{y:D}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(D)}equals(D){$e(D);const{X:_e,Y:P,Z:Re}=this,{X:Fe,Y:Le,Z:Ce}=D,L=n.eql(n.mul(_e,Ce),n.mul(Fe,Re)),O=n.eql(n.mul(P,Ce),n.mul(Le,Re));return L&&O}negate(){return new Qe(this.X,n.neg(this.Y),this.Z)}double(){const{a:D,b:_e}=a,P=n.mul(_e,_3n$4),{X:Re,Y:Fe,Z:Le}=this;let Ce=n.ZERO,L=n.ZERO,O=n.ZERO,st=n.mul(Re,Re),lt=n.mul(Fe,Fe),Xe=n.mul(Le,Le),dt=n.mul(Re,Fe);return dt=n.add(dt,dt),O=n.mul(Re,Le),O=n.add(O,O),Ce=n.mul(D,O),L=n.mul(P,Xe),L=n.add(Ce,L),Ce=n.sub(lt,L),L=n.add(lt,L),L=n.mul(Ce,L),Ce=n.mul(dt,Ce),O=n.mul(P,O),Xe=n.mul(D,Xe),dt=n.sub(st,Xe),dt=n.mul(D,dt),dt=n.add(dt,O),O=n.add(st,st),st=n.add(O,st),st=n.add(st,Xe),st=n.mul(st,dt),L=n.add(L,st),Xe=n.mul(Fe,Le),Xe=n.add(Xe,Xe),st=n.mul(Xe,dt),Ce=n.sub(Ce,st),O=n.mul(Xe,lt),O=n.add(O,O),O=n.add(O,O),new Qe(Ce,L,O)}add(D){$e(D);const{X:_e,Y:P,Z:Re}=this,{X:Fe,Y:Le,Z:Ce}=D;let L=n.ZERO,O=n.ZERO,st=n.ZERO;const lt=a.a,Xe=n.mul(a.b,_3n$4);let dt=n.mul(_e,Fe),er=n.mul(P,Le),ar=n.mul(Re,Ce),dr=n.add(_e,P),ir=n.add(Fe,Le);dr=n.mul(dr,ir),ir=n.add(dt,er),dr=n.sub(dr,ir),ir=n.add(_e,Re);let pt=n.add(Fe,Ce);return ir=n.mul(ir,pt),pt=n.add(dt,ar),ir=n.sub(ir,pt),pt=n.add(P,Re),L=n.add(Le,Ce),pt=n.mul(pt,L),L=n.add(er,ar),pt=n.sub(pt,L),st=n.mul(lt,ir),L=n.mul(Xe,ar),st=n.add(L,st),L=n.sub(er,st),st=n.add(er,st),O=n.mul(L,st),er=n.add(dt,dt),er=n.add(er,dt),ar=n.mul(lt,ar),ir=n.mul(Xe,ir),er=n.add(er,ar),ar=n.sub(dt,ar),ar=n.mul(lt,ar),ir=n.add(ir,ar),dt=n.mul(er,ir),O=n.add(O,dt),dt=n.mul(pt,ir),L=n.mul(dr,L),L=n.sub(L,dt),dt=n.mul(dr,er),st=n.mul(pt,st),st=n.add(st,dt),new Qe(L,O,st)}subtract(D){return this.add(D.negate())}is0(){return this.equals(Qe.ZERO)}multiply(D){const{endo:_e}=t;if(!s.isValidNot0(D))throw new Error("invalid scalar: out of range");let P,Re;const Fe=Le=>ze.cached(this,Le,Ce=>normalizeZ$1(Qe,Ce));if(_e){const{k1neg:Le,k1:Ce,k2neg:L,k2:O}=We(D),{p:st,f:lt}=Fe(Ce),{p:Xe,f:dt}=Fe(O);Re=lt.add(dt),P=Ye(_e.beta,st,Xe,Le,L)}else{const{p:Le,f:Ce}=Fe(D);P=Le,Re=Ce}return normalizeZ$1(Qe,[P,Re])[0]}multiplyUnsafe(D){const{endo:_e}=t,P=this;if(!s.isValid(D))throw new Error("invalid scalar: out of range");if(D===_0n$a||P.is0())return Qe.ZERO;if(D===_1n$a)return P;if(ze.hasCache(this))return this.multiply(D);if(_e){const{k1neg:Re,k1:Fe,k2neg:Le,k2:Ce}=We(D),{p1:L,p2:O}=mulEndoUnsafe$1(Qe,P,Fe,Ce);return Ye(_e.beta,L,O,Re,Le)}else return ze.unsafe(P,D)}multiplyAndAddUnsafe(D,_e,P){const Re=this.multiplyUnsafe(_e).add(D.multiplyUnsafe(P));return Re.is0()?void 0:Re}toAffine(D){return K(this,D)}isTorsionFree(){const{isTorsionFree:D}=t;return l===_1n$a?!0:D?D(Qe,this):ze.unsafe(this,u).is0()}clearCofactor(){const{clearCofactor:D}=t;return l===_1n$a?this:D?D(Qe,this):this.multiplyUnsafe(l)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}toBytes(D=!0){return _abool2(D,"isCompressed"),this.assertValidity(),w(Qe,this,D)}toHex(D=!0){return bytesToHex$5(this.toBytes(D))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(D=!0){return this.toBytes(D)}_setWindowSize(D){this.precompute(D)}static normalizeZ(D){return normalizeZ$1(Qe,D)}static msm(D,_e){return pippenger(Qe,s,D,_e)}static fromPrivateKey(D){return Qe.BASE.multiply(_normFnElement(s,D))}}Qe.BASE=new Qe(a.Gx,a.Gy,n.ONE),Qe.ZERO=new Qe(n.ZERO,n.ONE,n.ZERO),Qe.Fp=n,Qe.Fn=s;const it=s.BITS,ze=new wNAF$2(Qe,t.endo?Math.ceil(it/2):it);return Qe.BASE.precompute(8),Qe}function pprefix$1(e){return Uint8Array.of(e?2:3)}function getWLengths$1(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function ecdh$1(e,t={}){const{Fn:r}=e,n=t.randomBytes||randomBytes$4,s=Object.assign(getWLengths$1(e.Fp,r),{seed:getMinHashLength$2(r.ORDER)});function a(w){try{return!!_normFnElement(r,w)}catch{return!1}}function l(w,R){const{publicKey:I,publicKeyUncompressed:k}=s;try{const je=w.length;return R===!0&&je!==I||R===!1&&je!==k?!1:!!e.fromBytes(w)}catch{return!1}}function u(w=n(s.seed)){return mapHashToField$2(_abytes2(w,s.seed,"seed"),r.ORDER)}function x(w,R=!0){return e.BASE.multiply(_normFnElement(r,w)).toBytes(R)}function f(w){const R=u(w);return{secretKey:R,publicKey:x(R)}}function p(w){if(typeof w=="bigint")return!1;if(w instanceof e)return!0;const{secretKey:R,publicKey:I,publicKeyUncompressed:k}=s;if(r.allowedLengths||R===I)return;const je=ensureBytes$1("key",w).length;return je===I||je===k}function g(w,R,I=!0){if(p(w)===!0)throw new Error("first arg must be private key");if(p(R)===!1)throw new Error("second arg must be public key");const k=_normFnElement(r,w);return e.fromHex(R).multiply(k).toBytes(I)}return Object.freeze({getPublicKey:x,getSharedSecret:g,keygen:f,Point:e,utils:{isValidSecretKey:a,isValidPublicKey:l,randomSecretKey:u,isValidPrivateKey:a,randomPrivateKey:u,normPrivateKeyToScalar:w=>_normFnElement(r,w),precompute(w=8,R=e.BASE){return R.precompute(w,!1)}},lengths:s})}function ecdsa$1(e,t,r={}){ahash$2(t),_validateObject(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||randomBytes$4,s=r.hmac||((_e,...P)=>hmac$5(t,_e,concatBytes$4(...P))),{Fp:a,Fn:l}=e,{ORDER:u,BITS:x}=l,{keygen:f,getPublicKey:p,getSharedSecret:g,utils:y,lengths:w}=ecdh$1(e,r),R={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},I="compact";function k(_e){const P=u>>_1n$a;return _e>P}function je(_e,P){if(!l.isValidNot0(P))throw new Error(`invalid signature ${_e}: out of range 1..Point.Fn.ORDER`);return P}function Ve(_e,P){validateSigFormat$1(P);const Re=w.signature,Fe=P==="compact"?Re:P==="recovered"?Re+1:void 0;return _abytes2(_e,Fe,`${P} signature`)}class q{constructor(P,Re,Fe){this.r=je("r",P),this.s=je("s",Re),Fe!=null&&(this.recovery=Fe),Object.freeze(this)}static fromBytes(P,Re=I){Ve(P,Re);let Fe;if(Re==="der"){const{r:O,s:st}=DER$2.toSig(_abytes2(P));return new q(O,st)}Re==="recovered"&&(Fe=P[0],Re="compact",P=P.subarray(1));const Le=l.BYTES,Ce=P.subarray(0,Le),L=P.subarray(Le,Le*2);return new q(l.fromBytes(Ce),l.fromBytes(L),Fe)}static fromHex(P,Re){return this.fromBytes(hexToBytes$7(P),Re)}addRecoveryBit(P){return new q(this.r,this.s,P)}recoverPublicKey(P){const Re=a.ORDER,{r:Fe,s:Le,recovery:Ce}=this;if(Ce==null||![0,1,2,3].includes(Ce))throw new Error("recovery id invalid");if(u*_2n$7<Re&&Ce>1)throw new Error("recovery id is ambiguous for h>1 curve");const O=Ce===2||Ce===3?Fe+u:Fe;if(!a.isValid(O))throw new Error("recovery id 2 or 3 invalid");const st=a.toBytes(O),lt=e.fromBytes(concatBytes$4(pprefix$1((Ce&1)===0),st)),Xe=l.inv(O),dt=We(ensureBytes$1("msgHash",P)),er=l.create(-dt*Xe),ar=l.create(Le*Xe),dr=e.BASE.multiplyUnsafe(er).add(lt.multiplyUnsafe(ar));if(dr.is0())throw new Error("point at infinify");return dr.assertValidity(),dr}hasHighS(){return k(this.s)}toBytes(P=I){if(validateSigFormat$1(P),P==="der")return hexToBytes$7(DER$2.hexFromSig(this));const Re=l.toBytes(this.r),Fe=l.toBytes(this.s);if(P==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return concatBytes$4(Uint8Array.of(this.recovery),Re,Fe)}return concatBytes$4(Re,Fe)}toHex(P){return bytesToHex$5(this.toBytes(P))}assertValidity(){}static fromCompact(P){return q.fromBytes(ensureBytes$1("sig",P),"compact")}static fromDER(P){return q.fromBytes(ensureBytes$1("sig",P),"der")}normalizeS(){return this.hasHighS()?new q(this.r,l.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return bytesToHex$5(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return bytesToHex$5(this.toBytes("compact"))}}const $e=r.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const Re=bytesToNumberBE$2(P),Fe=P.length*8-x;return Fe>0?Re>>BigInt(Fe):Re},We=r.bits2int_modN||function(P){return l.create($e(P))},K=bitMask$2(x);function W(_e){return aInRange$1("num < 2^"+x,_e,_0n$a,K),l.toBytes(_e)}function Ye(_e,P){return _abytes2(_e,void 0,"message"),P?_abytes2(t(_e),void 0,"prehashed message"):_e}function Qe(_e,P,Re){if(["recovered","canonical"].some(er=>er in Re))throw new Error("sign() legacy options not supported");const{lowS:Fe,prehash:Le,extraEntropy:Ce}=validateSigOpts$1(Re,R);_e=Ye(_e,Le);const L=We(_e),O=_normFnElement(l,P),st=[W(O),W(L)];if(Ce!=null&&Ce!==!1){const er=Ce===!0?n(w.secretKey):Ce;st.push(ensureBytes$1("extraEntropy",er))}const lt=concatBytes$4(...st),Xe=L;function dt(er){const ar=$e(er);if(!l.isValidNot0(ar))return;const dr=l.inv(ar),ir=e.BASE.multiply(ar).toAffine(),pt=l.create(ir.x);if(pt===_0n$a)return;const tr=l.create(dr*l.create(Xe+pt*O));if(tr===_0n$a)return;let sr=(ir.x===pt?0:2)|Number(ir.y&_1n$a),nr=tr;return Fe&&k(tr)&&(nr=l.neg(tr),sr^=1),new q(pt,nr,sr)}return{seed:lt,k2sig:dt}}function it(_e,P,Re={}){_e=ensureBytes$1("message",_e);const{seed:Fe,k2sig:Le}=Qe(_e,P,Re);return createHmacDrbg$2(t.outputLen,l.BYTES,s)(Fe,Le)}function ze(_e){let P;const Re=typeof _e=="string"||isBytes$6(_e),Fe=!Re&&_e!==null&&typeof _e=="object"&&typeof _e.r=="bigint"&&typeof _e.s=="bigint";if(!Re&&!Fe)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(Fe)P=new q(_e.r,_e.s);else if(Re){try{P=q.fromBytes(ensureBytes$1("sig",_e),"der")}catch(Le){if(!(Le instanceof DER$2.Err))throw Le}if(!P)try{P=q.fromBytes(ensureBytes$1("sig",_e),"compact")}catch{return!1}}return P||!1}function v(_e,P,Re,Fe={}){const{lowS:Le,prehash:Ce,format:L}=validateSigOpts$1(Fe,R);if(Re=ensureBytes$1("publicKey",Re),P=Ye(ensureBytes$1("message",P),Ce),"strict"in Fe)throw new Error("options.strict was renamed to lowS");const O=L===void 0?ze(_e):q.fromBytes(ensureBytes$1("sig",_e),L);if(O===!1)return!1;try{const st=e.fromBytes(Re);if(Le&&O.hasHighS())return!1;const{r:lt,s:Xe}=O,dt=We(P),er=l.inv(Xe),ar=l.create(dt*er),dr=l.create(lt*er),ir=e.BASE.multiplyUnsafe(ar).add(st.multiplyUnsafe(dr));return ir.is0()?!1:l.create(ir.x)===lt}catch{return!1}}function D(_e,P,Re={}){const{prehash:Fe}=validateSigOpts$1(Re,R);return P=Ye(P,Fe),q.fromBytes(_e,"recovered").recoverPublicKey(P).toBytes()}return Object.freeze({keygen:f,getPublicKey:p,getSharedSecret:g,utils:y,lengths:w,Point:e,sign:it,verify:v,recoverPublicKey:D,Signature:q,hash:t})}function _weierstrass_legacy_opts_to_new(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp;let n=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(l=>Math.ceil(l/2)))):void 0;const s=Field$2(t.n,{BITS:e.nBitLength,allowedLengths:n,modFromBytes:e.wrapPrivateKey}),a={Fp:r,Fn:s,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:a}}function _ecdsa_legacy_opts_to_new(e){const{CURVE:t,curveOpts:r}=_weierstrass_legacy_opts_to_new(e),n={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:n}}function _ecdsa_new_output_to_legacy(e,t){const r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,nLength$2(r.Fn.ORDER,r.Fn.BITS))})}function weierstrass$3(e){const{CURVE:t,curveOpts:r,hash:n,ecdsaOpts:s}=_ecdsa_legacy_opts_to_new(e),a=weierstrassN(t,r),l=ecdsa$1(a,n,s);return _ecdsa_new_output_to_legacy(e,l)}function createCurve$1(e,t){const r=n=>weierstrass$3({...e,hash:n});return{...r(t),create:r}}const secp256k1_CURVE$1={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO$1={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_0n$9=BigInt(0),_1n$9=BigInt(1),_2n$6=BigInt(2);function sqrtMod$2(e){const t=secp256k1_CURVE$1.p,r=BigInt(3),n=BigInt(6),s=BigInt(11),a=BigInt(22),l=BigInt(23),u=BigInt(44),x=BigInt(88),f=e*e*e%t,p=f*f*e%t,g=pow2$2(p,r,t)*p%t,y=pow2$2(g,r,t)*p%t,w=pow2$2(y,_2n$6,t)*f%t,R=pow2$2(w,s,t)*w%t,I=pow2$2(R,a,t)*R%t,k=pow2$2(I,u,t)*I%t,je=pow2$2(k,x,t)*k%t,Ve=pow2$2(je,u,t)*I%t,q=pow2$2(Ve,r,t)*p%t,$e=pow2$2(q,l,t)*R%t,We=pow2$2($e,n,t)*f%t,K=pow2$2(We,_2n$6,t);if(!Fpk1$1.eql(Fpk1$1.sqr(K),e))throw new Error("Cannot find square root");return K}const Fpk1$1=Field$2(secp256k1_CURVE$1.p,{sqrt:sqrtMod$2}),secp256k1$3=createCurve$1({...secp256k1_CURVE$1,Fp:Fpk1$1,lowS:!0,endo:secp256k1_ENDO$1},sha256$6),TAGGED_HASH_PREFIXES$2={};function taggedHash$2(e,...t){let r=TAGGED_HASH_PREFIXES$2[e];if(r===void 0){const n=sha256$6(utf8ToBytes$5(e));r=concatBytes$4(n,n),TAGGED_HASH_PREFIXES$2[e]=r}return sha256$6(concatBytes$4(r,...t))}const pointToBytes$1=e=>e.toBytes(!0).slice(1),Pointk1$1=secp256k1$3.Point,hasEven=e=>e%_2n$6===_0n$9;function schnorrGetExtPubKey$1(e){const{Fn:t,BASE:r}=Pointk1$1,n=_normFnElement(t,e),s=r.multiply(n);return{scalar:hasEven(s.y)?n:t.neg(n),bytes:pointToBytes$1(s)}}function lift_x$1(e){const t=Fpk1$1;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x  p");const r=t.create(e*e),n=t.create(r*e+BigInt(7));let s=t.sqrt(n);hasEven(s)||(s=t.neg(s));const a=Pointk1$1.fromAffine({x:e,y:s});return a.assertValidity(),a}const num=bytesToNumberBE$2;function challenge$1(...e){return Pointk1$1.Fn.create(num(taggedHash$2("BIP0340/challenge",...e)))}function schnorrGetPublicKey$1(e){return schnorrGetExtPubKey$1(e).bytes}function schnorrSign$1(e,t,r=randomBytes$4(32)){const{Fn:n}=Pointk1$1,s=ensureBytes$1("message",e),{bytes:a,scalar:l}=schnorrGetExtPubKey$1(t),u=ensureBytes$1("auxRand",r,32),x=n.toBytes(l^num(taggedHash$2("BIP0340/aux",u))),f=taggedHash$2("BIP0340/nonce",x,a,s),{bytes:p,scalar:g}=schnorrGetExtPubKey$1(f),y=challenge$1(p,a,s),w=new Uint8Array(64);if(w.set(p,0),w.set(n.toBytes(n.create(g+y*l)),32),!schnorrVerify$1(w,s,a))throw new Error("sign: Invalid signature produced");return w}function schnorrVerify$1(e,t,r){const{Fn:n,BASE:s}=Pointk1$1,a=ensureBytes$1("signature",e,64),l=ensureBytes$1("message",t),u=ensureBytes$1("publicKey",r,32);try{const x=lift_x$1(num(u)),f=num(a.subarray(0,32));if(!inRange$1(f,_1n$9,secp256k1_CURVE$1.p))return!1;const p=num(a.subarray(32,64));if(!inRange$1(p,_1n$9,secp256k1_CURVE$1.n))return!1;const g=challenge$1(n.toBytes(f),pointToBytes$1(x),l),y=s.multiplyUnsafe(p).add(x.multiplyUnsafe(n.neg(g))),{x:w,y:R}=y.toAffine();return!(y.is0()||!hasEven(R)||w!==f)}catch{return!1}}const schnorr$1=(()=>{const r=(s=randomBytes$4(48))=>mapHashToField$2(s,secp256k1_CURVE$1.n);secp256k1$3.utils.randomSecretKey;function n(s){const a=r(s);return{secretKey:a,publicKey:schnorrGetPublicKey$1(a)}}return{keygen:n,getPublicKey:schnorrGetPublicKey$1,sign:schnorrSign$1,verify:schnorrVerify$1,Point:Pointk1$1,utils:{randomSecretKey:r,randomPrivateKey:r,taggedHash:taggedHash$2,lift_x:lift_x$1,pointToBytes:pointToBytes$1,numberToBytesBE:numberToBytesBE$2,bytesToNumberBE:bytesToNumberBE$2,mod:mod$2},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})(),sha256$5=sha256$6,bytesToHex$4=bytesToHex$5,hexToBytes$6=hexToBytes$7,Rho160$1=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Id160$1=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),Pi160$1=Id160$1.map(e=>(9*e+5)%16),idxLR$1=(()=>{const r=[[Id160$1],[Pi160$1]];for(let n=0;n<4;n++)for(let s of r)s.push(s[n].map(a=>Rho160$1[a]));return r})(),idxL$1=idxLR$1[0],idxR$1=idxLR$1[1],shifts160$1=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),shiftsL160$1=idxL$1.map((e,t)=>e.map(r=>shifts160$1[t][r])),shiftsR160$1=idxR$1.map((e,t)=>e.map(r=>shifts160$1[t][r])),Kl160$1=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Kr160$1=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ripemd_f$1(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}const BUF_160$1=new Uint32Array(16);class RIPEMD160 extends HashMD$2{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:r,h2:n,h3:s,h4:a}=this;return[t,r,n,s,a]}set(t,r,n,s,a){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=s|0,this.h4=a|0}process(t,r){for(let w=0;w<16;w++,r+=4)BUF_160$1[w]=t.getUint32(r,!0);let n=this.h0|0,s=n,a=this.h1|0,l=a,u=this.h2|0,x=u,f=this.h3|0,p=f,g=this.h4|0,y=g;for(let w=0;w<5;w++){const R=4-w,I=Kl160$1[w],k=Kr160$1[w],je=idxL$1[w],Ve=idxR$1[w],q=shiftsL160$1[w],$e=shiftsR160$1[w];for(let We=0;We<16;We++){const K=rotl$3(n+ripemd_f$1(w,a,u,f)+BUF_160$1[je[We]]+I,q[We])+g|0;n=g,g=f,f=rotl$3(u,10)|0,u=a,a=K}for(let We=0;We<16;We++){const K=rotl$3(s+ripemd_f$1(R,l,x,p)+BUF_160$1[Ve[We]]+k,$e[We])+y|0;s=y,y=p,p=rotl$3(x,10)|0,x=l,l=K}}this.set(this.h1+u+p|0,this.h2+f+y|0,this.h3+g+s|0,this.h4+n+l|0,this.h0+a+x|0)}roundClean(){clean$2(BUF_160$1)}destroy(){this.destroyed=!0,clean$2(this.buffer),this.set(0,0,0,0,0)}}const ripemd160$2=createHasher$2(()=>new RIPEMD160);function isBytes$5(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function isArrayOf$2(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(r=>typeof r=="string"):t.every(r=>Number.isSafeInteger(r)):!1}function afn$2(e){if(typeof e!="function")throw new Error("function expected");return!0}function astr$2(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function anumber$4(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function aArr$2(e){if(!Array.isArray(e))throw new Error("array expected")}function astrArr$2(e,t){if(!isArrayOf$2(!0,t))throw new Error(`${e}: array of strings expected`)}function anumArr$2(e,t){if(!isArrayOf$2(!1,t))throw new Error(`${e}: array of numbers expected`)}function chain$3(...e){const t=a=>a,r=(a,l)=>u=>a(l(u)),n=e.map(a=>a.encode).reduceRight(r,t),s=e.map(a=>a.decode).reduce(r,t);return{encode:n,decode:s}}function alphabet$3(e){const t=typeof e=="string"?e.split(""):e,r=t.length;astrArr$2("alphabet",t);const n=new Map(t.map((s,a)=>[s,a]));return{encode:s=>(aArr$2(s),s.map(a=>{if(!Number.isSafeInteger(a)||a<0||a>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${a}". Allowed: ${e}`);return t[a]})),decode:s=>(aArr$2(s),s.map(a=>{astr$2("alphabet.decode",a);const l=n.get(a);if(l===void 0)throw new Error(`Unknown letter: "${a}". Allowed: ${e}`);return l}))}}function join$3(e=""){return astr$2("join",e),{encode:t=>(astrArr$2("join.decode",t),t.join(e)),decode:t=>(astr$2("join.decode",t),t.split(e))}}function convertRadix$3(e,t,r){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: invalid to=${r}, base cannot be less than 2`);if(aArr$2(e),!e.length)return[];let n=0;const s=[],a=Array.from(e,u=>{if(anumber$4(u),u<0||u>=t)throw new Error(`invalid integer: ${u}`);return u}),l=a.length;for(;;){let u=0,x=!0;for(let f=n;f<l;f++){const p=a[f],g=t*u,y=g+p;if(!Number.isSafeInteger(y)||g/t!==u||y-p!==g)throw new Error("convertRadix: carry overflow");const w=y/r;u=y%r;const R=Math.floor(w);if(a[f]=R,!Number.isSafeInteger(R)||R*r+u!==y)throw new Error("convertRadix: carry overflow");if(x)R?x=!1:n=f;else continue}if(s.push(u),x)break}for(let u=0;u<e.length-1&&e[u]===0;u++)s.push(0);return s.reverse()}function radix$3(e){anumber$4(e);const t=2**8;return{encode:r=>{if(!isBytes$5(r))throw new Error("radix.encode input should be Uint8Array");return convertRadix$3(Array.from(r),t,e)},decode:r=>(anumArr$2("radix.decode",r),Uint8Array.from(convertRadix$3(r,e,t)))}}function checksum$2(e,t){return anumber$4(e),afn$2(t),{encode(r){if(!isBytes$5(r))throw new Error("checksum.encode: input should be Uint8Array");const n=t(r).slice(0,e),s=new Uint8Array(r.length+e);return s.set(r),s.set(n,r.length),s},decode(r){if(!isBytes$5(r))throw new Error("checksum.decode: input should be Uint8Array");const n=r.slice(0,-e),s=r.slice(-e),a=t(n).slice(0,e);for(let l=0;l<e;l++)if(a[l]!==s[l])throw new Error("Invalid checksum");return n}}}const genBase58$2=e=>chain$3(radix$3(58),alphabet$3(e),join$3("")),base58$3=genBase58$2("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),createBase58check$1=e=>chain$3(checksum$2(4,t=>e(e(t))),base58$3);const Point$2=secp256k1$3.ProjectivePoint,base58check$1=createBase58check$1(sha256$6);function bytesToNumber(e){abytes$2(e);const t=e.length===0?"0":bytesToHex$5(e);return BigInt("0x"+t)}function numberToBytes(e){if(typeof e!="bigint")throw new Error("bigint expected");return hexToBytes$7(e.toString(16).padStart(64,"0"))}const MASTER_SECRET$1=utf8ToBytes$5("Bitcoin seed"),BITCOIN_VERSIONS$1={private:76066276,public:76067358},HARDENED_OFFSET$1=2147483648,hash160$2=e=>ripemd160$2(sha256$6(e)),fromU32$1=e=>createView$5(e).getUint32(0,!1),toU32$1=e=>{if(!Number.isSafeInteger(e)||e<0||e>2**32-1)throw new Error("invalid number, should be from 0 to 2**32-1, got "+e);const t=new Uint8Array(4);return createView$5(t).setUint32(0,e,!1),t};let HDKey$1=class Ro{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return fromU32$1(this.pubHash)}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this.privKeyBytes||null}get publicKey(){return this.pubKey||null}get privateExtendedKey(){const t=this.privateKey;if(!t)throw new Error("No private key");return base58check$1.encode(this.serialize(this.versions.private,concatBytes$4(new Uint8Array([0]),t)))}get publicExtendedKey(){if(!this.pubKey)throw new Error("No public key");return base58check$1.encode(this.serialize(this.versions.public,this.pubKey))}static fromMasterSeed(t,r=BITCOIN_VERSIONS$1){if(abytes$2(t),8*t.length<128||8*t.length>512)throw new Error("HDKey: seed length must be between 128 and 512 bits; 256 bits is advised, got "+t.length);const n=hmac$5(sha512$3,MASTER_SECRET$1,t);return new Ro({versions:r,chainCode:n.slice(32),privateKey:n.slice(0,32)})}static fromExtendedKey(t,r=BITCOIN_VERSIONS$1){const n=base58check$1.decode(t),s=createView$5(n),a=s.getUint32(0,!1),l={versions:r,depth:n[4],parentFingerprint:s.getUint32(5,!1),index:s.getUint32(9,!1),chainCode:n.slice(13,45)},u=n.slice(45),x=u[0]===0;if(a!==r[x?"private":"public"])throw new Error("Version mismatch");return x?new Ro({...l,privateKey:u.slice(1)}):new Ro({...l,publicKey:u})}static fromJSON(t){return Ro.fromExtendedKey(t.xpriv)}constructor(t){if(this.depth=0,this.index=0,this.chainCode=null,this.parentFingerprint=0,!t||typeof t!="object")throw new Error("HDKey.constructor must not be called directly");if(this.versions=t.versions||BITCOIN_VERSIONS$1,this.depth=t.depth||0,this.chainCode=t.chainCode||null,this.index=t.index||0,this.parentFingerprint=t.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(t.publicKey&&t.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(t.privateKey){if(!secp256k1$3.utils.isValidPrivateKey(t.privateKey))throw new Error("Invalid private key");this.privKey=typeof t.privateKey=="bigint"?t.privateKey:bytesToNumber(t.privateKey),this.privKeyBytes=numberToBytes(this.privKey),this.pubKey=secp256k1$3.getPublicKey(t.privateKey,!0)}else if(t.publicKey)this.pubKey=Point$2.fromHex(t.publicKey).toRawBytes(!0);else throw new Error("HDKey: no public or private key provided");this.pubHash=hash160$2(this.pubKey)}derive(t){if(!/^[mM]'?/.test(t))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(t))return this;const r=t.replace(/^[mM]'?\//,"").split("/");let n=this;for(const s of r){const a=/^(\d+)('?)$/.exec(s),l=a&&a[1];if(!a||a.length!==3||typeof l!="string")throw new Error("invalid child index: "+s);let u=+l;if(!Number.isSafeInteger(u)||u>=HARDENED_OFFSET$1)throw new Error("Invalid index");a[2]==="'"&&(u+=HARDENED_OFFSET$1),n=n.deriveChild(u)}return n}deriveChild(t){if(!this.pubKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let r=toU32$1(t);if(t>=HARDENED_OFFSET$1){const u=this.privateKey;if(!u)throw new Error("Could not derive hardened child key");r=concatBytes$4(new Uint8Array([0]),u,r)}else r=concatBytes$4(this.pubKey,r);const n=hmac$5(sha512$3,this.chainCode,r),s=bytesToNumber(n.slice(0,32)),a=n.slice(32);if(!secp256k1$3.utils.isValidPrivateKey(s))throw new Error("Tweak bigger than curve order");const l={versions:this.versions,chainCode:a,depth:this.depth+1,parentFingerprint:this.fingerprint,index:t};try{if(this.privateKey){const u=mod$2(this.privKey+s,secp256k1$3.CURVE.n);if(!secp256k1$3.utils.isValidPrivateKey(u))throw new Error("The tweak was out of range or the resulted private key is invalid");l.privateKey=u}else{const u=Point$2.fromHex(this.pubKey).add(Point$2.fromPrivateKey(s));if(u.equals(Point$2.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");l.publicKey=u.toRawBytes(!0)}return new Ro(l)}catch{return this.deriveChild(t+1)}}sign(t){if(!this.privateKey)throw new Error("No privateKey set!");return abytes$2(t,32),secp256k1$3.sign(t,this.privKey).toCompactRawBytes()}verify(t,r){if(abytes$2(t,32),abytes$2(r,64),!this.publicKey)throw new Error("No publicKey set!");let n;try{n=secp256k1$3.Signature.fromCompact(r)}catch{return!1}return secp256k1$3.verify(n,t,this.publicKey)}wipePrivateData(){return this.privKey=void 0,this.privKeyBytes&&(this.privKeyBytes.fill(0),this.privKeyBytes=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(t,r){if(!this.chainCode)throw new Error("No chainCode set");return abytes$2(r,33),concatBytes$4(toU32$1(t),new Uint8Array([this.depth]),toU32$1(this.parentFingerprint),toU32$1(this.index),this.chainCode,r)}};function Q(e){return Et(bytesToHex$4(e))}function Et(e){return BigInt(`0x${e}`)}function Rt(e){return Buffer$1.from(e,"base64")}const Qt=hexToBytes$6("536563703235366b315f48617368546f43757276655f43617368755f");function H(e){const t=sha256$5(Buffer$1.concat([Qt,e])),r=new Uint32Array(1),n=2**16;for(let s=0;s<n;s++){const a=new Uint8Array(r.buffer),l=sha256$5(Buffer$1.concat([t,a]));try{return B(bytesToHex$4(Buffer$1.concat([new Uint8Array([2]),l])))}catch{r[0]++}}throw new Error("No valid point found")}function Lt(e){const t=e.map(r=>r.toHex(!1)).join("");return sha256$5(new TextEncoder().encode(t))}function B(e){return secp256k1$3.ProjectivePoint.fromHex(e)}const Wt=e=>{let t;return/^[a-fA-F0-9]+$/.test(e)?t=Et(e)%BigInt(2**31-1):t=Q(Rt(e))%BigInt(2**31-1),t};function Ct(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const $t=(e,t,r,n)=>{const s=secp256k1$3.ProjectivePoint.fromPrivateKey(bytesToHex$4(e.s)),a=n.multiply(Q(e.e)),l=t.multiply(Q(e.s)),u=r.multiply(Q(e.e)),x=s.subtract(a),f=l.subtract(u),p=Lt([x,f,n,r]);return Ct(p,e.e)},jt=(e,t,r,n)=>{if(t.r===void 0)throw new Error("verifyDLEQProof_reblind: Undefined blinding factor");const s=H(e),a=r.add(n.multiply(t.r)),l=secp256k1$3.ProjectivePoint.fromPrivateKey(t.r),u=s.add(l);return $t(t,u,a,n)};function Ht(e){return Buffer$1.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function St(e){return Buffer$1.from(e,"base64")}function Pt(e){const t=JSON.stringify(e);return Vt(Buffer$1.from(t).toString("base64"))}function zt(e){const t=Buffer$1.from(Gt(e),"base64").toString();return JSON.parse(t)}function Gt(e){return e.replace(/-/g,"+").replace(/_/g,"/").split("=")[0]}function Vt(e){return e.replace(/\+/g,"-").replace(/\//g,"_").split("=")[0]}function Jt(e){return typeof e=="number"||typeof e=="string"}function nt(e){const t=[];return rt(e,t),new Uint8Array(t)}function rt(e,t){if(e===null)t.push(246);else if(e===void 0)t.push(247);else if(typeof e=="boolean")t.push(e?245:244);else if(typeof e=="number")At(e,t);else if(typeof e=="string")vt(e,t);else if(Array.isArray(e))Xt(e,t);else if(e instanceof Uint8Array)Yt(e,t);else if(typeof e=="object")Zt(e,t);else throw new Error("Unsupported type")}function At(e,t){if(e<24)t.push(e);else if(e<256)t.push(24,e);else if(e<65536)t.push(25,e>>8,e&255);else if(e<4294967296)t.push(26,e>>24,e>>16&255,e>>8&255,e&255);else throw new Error("Unsupported integer size")}function Yt(e,t){const r=e.length;if(r<24)t.push(64+r);else if(r<256)t.push(88,r);else if(r<65536)t.push(89,r>>8&255,r&255);else if(r<4294967296)t.push(90,r>>24&255,r>>16&255,r>>8&255,r&255);else throw new Error("Byte string too long to encode");for(let n=0;n<e.length;n++)t.push(e[n])}function vt(e,t){const r=new TextEncoder().encode(e),n=r.length;if(n<24)t.push(96+n);else if(n<256)t.push(120,n);else if(n<65536)t.push(121,n>>8&255,n&255);else if(n<4294967296)t.push(122,n>>24&255,n>>16&255,n>>8&255,n&255);else throw new Error("String too long to encode");for(let s=0;s<r.length;s++)t.push(r[s])}function Xt(e,t){const r=e.length;if(r<24)t.push(128|r);else if(r<256)t.push(152,r);else if(r<65536)t.push(153,r>>8,r&255);else throw new Error("Unsupported array length");for(const n of e)rt(n,t)}function Zt(e,t){const r=Object.keys(e);At(r.length,t),t[t.length-1]|=160;for(const n of r)vt(n,t),rt(e[n],t)}function ot(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);return z(t,0).value}function z(e,t){if(t>=e.byteLength)throw new Error("Unexpected end of data");const r=e.getUint8(t++),n=r>>5,s=r&31;switch(n){case 0:return te(e,t,s);case 1:return ee$1(e,t,s);case 2:return se(e,t,s);case 3:return ne(e,t,s);case 4:return re(e,t,s);case 5:return oe(e,t,s);case 7:return ce(e,t,s);default:throw new Error(`Unsupported major type: ${n}`)}}function F(e,t,r){if(r<24)return{value:r,offset:t};if(r===24)return{value:e.getUint8(t++),offset:t};if(r===25){const n=e.getUint16(t,!1);return t+=2,{value:n,offset:t}}if(r===26){const n=e.getUint32(t,!1);return t+=4,{value:n,offset:t}}if(r===27){const n=e.getUint32(t,!1),s=e.getUint32(t+4,!1);return t+=8,{value:n*2**32+s,offset:t}}throw new Error(`Unsupported length: ${r}`)}function te(e,t,r){const{value:n,offset:s}=F(e,t,r);return{value:n,offset:s}}function ee$1(e,t,r){const{value:n,offset:s}=F(e,t,r);return{value:-1-n,offset:s}}function se(e,t,r){const{value:n,offset:s}=F(e,t,r);if(s+n>e.byteLength)throw new Error("Byte string length exceeds data length");return{value:new Uint8Array(e.buffer,e.byteOffset+s,n),offset:s+n}}function ne(e,t,r){const{value:n,offset:s}=F(e,t,r);if(s+n>e.byteLength)throw new Error("String length exceeds data length");const a=new Uint8Array(e.buffer,e.byteOffset+s,n);return{value:new TextDecoder().decode(a),offset:s+n}}function re(e,t,r){const{value:n,offset:s}=F(e,t,r),a=[];let l=s;for(let u=0;u<n;u++){const x=z(e,l);a.push(x.value),l=x.offset}return{value:a,offset:l}}function oe(e,t,r){const{value:n,offset:s}=F(e,t,r),a={};let l=s;for(let u=0;u<n;u++){const x=z(e,l);if(!Jt(x.value))throw new Error("Invalid key type");const f=z(e,x.offset);a[x.value]=f.value,l=f.offset}return{value:a,offset:l}}function ie(e){const t=(e&31744)>>10,r=e&1023,n=e&32768?-1:1;return t===0?n*2**-14*(r/1024):t===31?r?NaN:n*(1/0):n*2**(t-15)*(1+r/1024)}function ce(e,t,r){if(r<24)switch(r){case 20:return{value:!1,offset:t};case 21:return{value:!0,offset:t};case 22:return{value:null,offset:t};case 23:return{value:void 0,offset:t};default:throw new Error(`Unknown simple value: ${r}`)}if(r===24)return{value:e.getUint8(t++),offset:t};if(r===25){const n=ie(e.getUint16(t,!1));return t+=2,{value:n,offset:t}}if(r===26){const n=e.getFloat32(t,!1);return t+=4,{value:n,offset:t}}if(r===27){const n=e.getFloat64(t,!1);return t+=8,{value:n,offset:t}}throw new Error(`Unknown simple or float value: ${r}`)}const ae="A",ue="cashu";function A(e,t,r,n){if(r){const s=kt(r);if(s>e)throw new Error(`Split is greater than total amount: ${s} > ${e}`);if(r.some(a=>!Tt(a,t)))throw new Error("Provided amount preferences do not match the amounts of the mint keyset.");e=e-kt(r)}else r=[];return It(t,"desc").forEach(s=>{const a=Math.floor(e/s);for(let l=0;l<a;++l)r?.push(s);e%=s}),r.sort((s,a)=>s-a)}function mt(e,t,r,n){const s=[],a=e.map(u=>u.amount);It(r,"asc").forEach(u=>{const x=a.filter(p=>p===u).length,f=Math.max(n-x,0);for(let p=0;p<f&&!(s.reduce((g,y)=>g+y,0)+u>t);++p)s.push(u)});const l=t-s.reduce((u,x)=>u+x,0);return l&&A(l,r).forEach(u=>{s.push(u)}),s.sort((u,x)=>u-x)}function It(e,t="desc"){return t=="desc"?Object.keys(e).map(r=>parseInt(r)).sort((r,n)=>n-r):Object.keys(e).map(r=>parseInt(r)).sort((r,n)=>r-n)}function Tt(e,t){return e in t}function he(e){return Kt(bytesToHex$4(e))}function Kt(e){return BigInt(`0x${e}`)}function de(e){return e.toString(16).padStart(64,"0")}function gt(e){return/^[a-f0-9]*$/i.test(e)}function Mt(e){return Array.isArray(e)?e.some(t=>!gt(t.id)):gt(e.id)}function le(e){const t={token:[{mint:e.mint,proofs:e.proofs}]};return e.unit&&(t.unit=e.unit),e.memo&&(t.memo=e.memo),ue+ae+Pt(t)}function He(e,t){if(Mt(e.proofs)||t?.version===3){if(t?.version===4)throw new Error("can not encode to v4 token if proofs contain non-hex keyset id");return le(e)}return fe$1(e)}function fe$1(e){if(e.proofs.forEach(l=>{if(l.dleq&&l.dleq.r==null)throw new Error("Missing blinding factor in included DLEQ proof")}),Mt(e.proofs))throw new Error("can not encode to v4 token if proofs contain non-hex keyset id");const t=qt(e),r=nt(t),n="cashu",s="B",a=Ht(r);return n+s+a}function qt(e){const t={},r=e.mint;for(let s=0;s<e.proofs.length;s++){const a=e.proofs[s];t[a.id]?t[a.id].push(a):t[a.id]=[a]}const n={m:r,u:e.unit||"sat",t:Object.keys(t).map(s=>({i:hexToBytes$6(s),p:t[s].map(a=>({a:a.amount,s:a.secret,c:hexToBytes$6(a.C),...a.dleq&&{d:{e:hexToBytes$6(a.dleq.e),s:hexToBytes$6(a.dleq.s),r:hexToBytes$6(a.dleq.r??"00")}},...a.witness&&{w:JSON.stringify(a.witness)}}))}))};return e.memo&&(n.d=e.memo),n}function Dt(e){const t=[];e.t.forEach(n=>n.p.forEach(s=>{t.push({secret:s.s,C:bytesToHex$4(s.c),amount:s.a,id:bytesToHex$4(n.i),...s.d&&{dleq:{r:bytesToHex$4(s.d.r),s:bytesToHex$4(s.d.s),e:bytesToHex$4(s.d.e)}},...s.w&&{witness:s.w}})}));const r={mint:e.m,proofs:t,unit:e.u||"sat"};return e.d&&(r.memo=e.d),r}function pe(e){return["web+cashu://","cashu://","cashu:","cashu"].forEach(t=>{e.startsWith(t)&&(e=e.slice(t.length))}),ye(e)}function ye(e){const t=e.slice(0,1),r=e.slice(1);if(t==="A"){const n=zt(r);if(n.token.length>1)throw new Error("Multi entry token are not supported");const s=n.token[0],a={mint:s.mint,proofs:s.proofs,unit:n.unit||"sat"};return n.memo&&(a.memo=n.memo),a}else if(t==="B"){const n=St(r),s=ot(n);return Dt(s)}throw new Error("Token version is not supported")}function wt(e){return me(e.keys)===e.id}function me(e){const t=Object.entries(e).sort((n,s)=>+n[0]-+s[0]).map(([,n])=>hexToBytes$6(n)).reduce((n,s)=>ge$1(n,s),new Uint8Array),r=sha256$5(t);return"00"+Buffer.from(r).toString("hex").slice(0,14)}function ge$1(e,t){const r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function T(e){return typeof e=="object"}function _(...e){return e.map(t=>t.replace(/(^\/+|\/+$)/g,"")).join("/")}function Ut(e){return e.replace(/\/$/,"")}function U(e){return e.reduce((t,r)=>t+r.amount,0)}class we{get value(){return this._value}set value(t){this._value=t}get next(){return this._next}set next(t){this._next=t}constructor(t){this._value=t,this._next=null}}class ke{get first(){return this._first}set first(t){this._first=t}get last(){return this._last}set last(t){this._last=t}get size(){return this._size}set size(t){this._size=t}constructor(){this._first=null,this._last=null,this._size=0}enqueue(t){const r=new we(t);return this._size===0||!this._last?(this._first=r,this._last=r):(this._last.next=r,this._last=r),this._size++,!0}dequeue(){if(this._size===0||!this._first)return null;const t=this._first;return this._first=t.next,t.next=null,this._size--,t.value}}function j(e){return e.map(t=>{const r={...t};return delete r.dleq,r})}function Bt(e,t){if(e.dleq==null)return!1;const r={e:hexToBytes$6(e.dleq.e),s:hexToBytes$6(e.dleq.s),r:Kt(e.dleq.r??"00")};if(!Tt(e.amount,t.keys))throw new Error(`undefined key for amount ${e.amount}`);const n=t.keys[e.amount];return!!jt(new TextEncoder().encode(e.secret),r,B(e.C),B(n))}function kt(e){return e.reduce((t,r)=>t+r,0)}let ct;typeof WebSocket<"u"&&(ct=WebSocket);function be(){return ct}class N{constructor(){this.connectionMap=new Map}static getInstance(){return N.instace||(N.instace=new N),N.instace}getConnection(t){if(this.connectionMap.has(t))return this.connectionMap.get(t);const r=new Ee(t);return this.connectionMap.set(t,r),r}}class Ee{constructor(t){this.subListeners={},this.rpcListeners={},this.rpcId=0,this._WS=be(),this.url=new URL(t),this.messageQueue=new ke}connect(){return this.connectionPromise||(this.connectionPromise=new Promise((t,r)=>{try{this.ws=new this._WS(this.url.toString())}catch(n){r(n);return}this.ws.onopen=()=>{t()},this.ws.onerror=()=>{r(new Error("Failed to open WebSocket"))},this.ws.onmessage=n=>{this.messageQueue.enqueue(n.data),this.handlingInterval||(this.handlingInterval=setInterval(this.handleNextMesage.bind(this),0))},this.ws.onclose=()=>{this.connectionPromise=void 0}})),this.connectionPromise}sendRequest(t,r){if(this.ws?.readyState!==1)throw new Error("Socket not open...");const n=this.rpcId;this.rpcId++;const s=JSON.stringify({jsonrpc:"2.0",method:t,params:r,id:n});this.ws?.send(s)}closeSubscription(t){this.ws?.send(JSON.stringify(["CLOSE",t]))}addSubListener(t,r){(this.subListeners[t]=this.subListeners[t]||[]).push(r)}addRpcListener(t,r,n){this.rpcListeners[n]={callback:t,errorCallback:r}}removeRpcListener(t){delete this.rpcListeners[t]}removeListener(t,r){if(this.subListeners[t]){if(this.subListeners[t].length===1){delete this.subListeners[t];return}this.subListeners[t]=this.subListeners[t].filter(n=>n!==r)}}async ensureConnection(){this.ws?.readyState!==1&&await this.connect()}handleNextMesage(){if(this.messageQueue.size===0){clearInterval(this.handlingInterval),this.handlingInterval=void 0;return}const t=this.messageQueue.dequeue();let r;try{if(r=JSON.parse(t),"result"in r&&r.id!=null)this.rpcListeners[r.id]&&(this.rpcListeners[r.id].callback(),this.removeRpcListener(r.id));else if("error"in r&&r.id!=null)this.rpcListeners[r.id]&&(this.rpcListeners[r.id].errorCallback(r.error),this.removeRpcListener(r.id));else if("method"in r&&!("id"in r)){const n=r.params.subId;if(!n)return;if(this.subListeners[n]?.length>0){const s=r;this.subListeners[n].forEach(a=>a(s.params.payload))}}}catch(n){console.error(n);return}}createSubscription(t,r,n){if(this.ws?.readyState!==1)return n(new Error("Socket is not open"));const s=(Math.random()+1).toString(36).substring(7);return this.addRpcListener(()=>{this.addSubListener(s,r)},a=>{n(new Error(a.message))},this.rpcId),this.sendRequest("subscribe",{...t,subId:s}),this.rpcId++,s}cancelSubscription(t,r){this.removeRpcListener(t),this.removeListener(t,r),this.rpcId++,this.sendRequest("unsubscribe",{subId:t})}get activeSubscriptions(){return Object.keys(this.subListeners)}close(){this.ws&&this.ws?.close()}}const C={UNPAID:"UNPAID",PENDING:"PENDING",PAID:"PAID"},Z={UNPAID:"UNPAID",PAID:"PAID"};class $ extends Error{constructor(t,r){super(t),this.status=r,this.name="HttpResponseError",Object.setPrototypeOf(this,$.prototype)}}class at extends Error{constructor(t){super(t),this.name="NetworkError",Object.setPrototypeOf(this,at.prototype)}}let ut$1=class kd extends ${constructor(t,r){super(r||"Unknown mint operation error",400),this.code=t,this.name="MintOperationError",Object.setPrototypeOf(this,kd.prototype)}},xt={};async function Pe({endpoint:e,requestBody:t,headers:r,...n}){const s=t?JSON.stringify(t):void 0,a={Accept:"application/json, text/plain, */*",...s?{"Content-Type":"application/json"}:void 0,...r};let l;try{l=await fetch(e,{body:s,headers:a,...n})}catch(u){throw new at(u instanceof Error?u.message:"Network request failed")}if(!l.ok){const u=await l.json().catch(()=>({error:"bad response"}));throw l.status===400&&"code"in u&&"detail"in u?new ut$1(u.code,u.detail):new $("error"in u?u.error:u.detail||"HTTP request failed",l.status)}try{return await l.json()}catch(u){throw console.error("Failed to parse HTTP response",u),new $("bad response",l.status)}}async function E(e){return await Pe({...e,...xt})}function G(e){return e.state||(console.warn("Field 'state' not found in MeltQuoteResponse. Update NUT-05 of mint: https://github.com/cashubtc/nuts/pull/136)"),typeof e.paid=="boolean"&&(e.state=e.paid?C.PAID:C.UNPAID)),e}function _t(e){return e.state||(console.warn("Field 'state' not found in MintQuoteResponse. Update NUT-04 of mint: https://github.com/cashubtc/nuts/pull/141)"),typeof e.paid=="boolean"&&(e.state=e.paid?Z.PAID:Z.UNPAID)),e}function Ae(e){return Array.isArray(e?.contact)&&e?.contact.length>0&&(e.contact=e.contact.map(t=>Array.isArray(t)&&t.length===2&&typeof t[0]=="string"&&typeof t[1]=="string"?(console.warn("Mint returned deprecated 'contact' field: Update NUT-06: https://github.com/cashubtc/nuts/pull/117"),{method:t[0],info:t[1]}):t)),e}class tt{constructor(t){this._mintInfo=t,t.nuts[22]&&(this._protectedEnpoints={cache:{},apiReturn:t.nuts[22].protected_endpoints.map(r=>({method:r.method,regex:new RegExp(r.path)}))})}isSupported(t){switch(t){case 4:case 5:return this.checkMintMelt(t);case 7:case 8:case 9:case 10:case 11:case 12:case 14:case 20:return this.checkGenericNut(t);case 17:return this.checkNut17();case 15:return this.checkNut15();default:throw new Error("nut is not supported by cashu-ts")}}requiresBlindAuthToken(t){if(!this._protectedEnpoints)return!1;if(typeof this._protectedEnpoints.cache[t]=="boolean")return this._protectedEnpoints.cache[t];const r=this._protectedEnpoints.apiReturn.some(n=>n.regex.test(t));return this._protectedEnpoints.cache[t]=r,r}checkGenericNut(t){return this._mintInfo.nuts[t]?.supported?{supported:!0}:{supported:!1}}checkMintMelt(t){const r=this._mintInfo.nuts[t];return r&&r.methods.length>0&&!r.disabled?{disabled:!1,params:r.methods}:{disabled:!0,params:r.methods}}checkNut17(){return this._mintInfo.nuts[17]&&this._mintInfo.nuts[17].supported.length>0?{supported:!0,params:this._mintInfo.nuts[17].supported}:{supported:!1}}checkNut15(){return this._mintInfo.nuts[15]&&this._mintInfo.nuts[15].methods.length>0?{supported:!0,params:this._mintInfo.nuts[15].methods}:{supported:!1}}get contact(){return this._mintInfo.contact}get description(){return this._mintInfo.description}get description_long(){return this._mintInfo.description_long}get name(){return this._mintInfo.name}get pubkey(){return this._mintInfo.pubkey}get nuts(){return this._mintInfo.nuts}get version(){return this._mintInfo.version}get motd(){return this._mintInfo.motd}}class S{constructor(t,r,n){this._mintUrl=t,this._customRequest=r,this._checkNut22=!1,this._mintUrl=Ut(t),this._customRequest=r,n&&(this._checkNut22=!0,this._authTokenGetter=n)}get mintUrl(){return this._mintUrl}static async getInfo(t,r){const n=await(r||E)({endpoint:_(t,"/v1/info")});return Ae(n)}async getInfo(){return S.getInfo(this._mintUrl,this._customRequest)}async getLazyMintInfo(){if(this._mintInfo)return this._mintInfo;const t=await S.getInfo(this._mintUrl,this._customRequest);return this._mintInfo=new tt(t),this._mintInfo}static async swap(t,r,n,s){const a=n||E,l=s?{"Blind-auth":s}:{},u=await a({endpoint:_(t,"/v1/swap"),method:"POST",requestBody:r,headers:l});if(!T(u)||!Array.isArray(u?.signatures))throw new Error(u.detail??"bad response");return u}async swap(t){const r=await this.handleBlindAuth("/v1/swap");return S.swap(this._mintUrl,t,this._customRequest,r)}static async createMintQuote(t,r,n,s){const a=n||E,l=s?{"Blind-auth":s}:{},u=await a({endpoint:_(t,"/v1/mint/quote/bolt11"),method:"POST",requestBody:r,headers:l});return _t(u)}async createMintQuote(t){const r=await this.handleBlindAuth("/v1/mint/quote/bolt11");return S.createMintQuote(this._mintUrl,t,this._customRequest,r)}static async checkMintQuote(t,r,n,s){const a=n||E,l=s?{"Blind-auth":s}:{},u=await a({endpoint:_(t,"/v1/mint/quote/bolt11",r),method:"GET",headers:l});return _t(u)}async checkMintQuote(t){const r=await this.handleBlindAuth(`/v1/mint/quote/bolt11/${t}`);return S.checkMintQuote(this._mintUrl,t,this._customRequest,r)}static async mint(t,r,n,s){const a=n||E,l=s?{"Blind-auth":s}:{},u=await a({endpoint:_(t,"/v1/mint/bolt11"),method:"POST",requestBody:r,headers:l});if(!T(u)||!Array.isArray(u?.signatures))throw new Error("bad response");return u}async mint(t){const r=await this.handleBlindAuth("/v1/mint/bolt11");return S.mint(this._mintUrl,t,this._customRequest,r)}static async createMeltQuote(t,r,n,s){const a=n||E,l=s?{"Blind-auth":s}:{},u=await a({endpoint:_(t,"/v1/melt/quote/bolt11"),method:"POST",requestBody:r,headers:l}),x=G(u);if(!T(x)||typeof x?.amount!="number"||typeof x?.fee_reserve!="number"||typeof x?.quote!="string")throw new Error("bad response");return x}async createMeltQuote(t){const r=await this.handleBlindAuth("/v1/melt/quote/bolt11");return S.createMeltQuote(this._mintUrl,t,this._customRequest,r)}static async checkMeltQuote(t,r,n,s){const a=n||E,l=s?{"Blind-auth":s}:{},u=await a({endpoint:_(t,"/v1/melt/quote/bolt11",r),method:"GET",headers:l}),x=G(u);if(!T(x)||typeof x?.amount!="number"||typeof x?.fee_reserve!="number"||typeof x?.quote!="string"||typeof x?.state!="string"||!Object.values(C).includes(x.state))throw new Error("bad response");return x}async checkMeltQuote(t){const r=await this.handleBlindAuth(`/v1/melt/quote/bolt11/${t}`);return S.checkMeltQuote(this._mintUrl,t,this._customRequest,r)}static async melt(t,r,n,s){const a=n||E,l=s?{"Blind-auth":s}:{},u=await a({endpoint:_(t,"/v1/melt/bolt11"),method:"POST",requestBody:r,headers:l}),x=G(u);if(!T(x)||typeof x?.state!="string"||!Object.values(C).includes(x.state))throw new Error("bad response");return x}async melt(t){const r=await this.handleBlindAuth("/v1/melt/bolt11");return S.melt(this._mintUrl,t,this._customRequest,r)}static async check(t,r,n){const s=await(n||E)({endpoint:_(t,"/v1/checkstate"),method:"POST",requestBody:r});if(!T(s)||!Array.isArray(s?.states))throw new Error("bad response");return s}static async getKeys(t,r,n){r&&(r=r.replace(/\//g,"_").replace(/\+/g,"-"));const s=await(n||E)({endpoint:r?_(t,"/v1/keys",r):_(t,"/v1/keys")});if(!T(s)||!Array.isArray(s.keysets))throw new Error("bad response");return s}async getKeys(t,r){return await S.getKeys(r||this._mintUrl,t,this._customRequest)}static async getKeySets(t,r){return(r||E)({endpoint:_(t,"/v1/keysets")})}async getKeySets(){return S.getKeySets(this._mintUrl,this._customRequest)}async check(t){return S.check(this._mintUrl,t,this._customRequest)}static async restore(t,r,n){const s=await(n||E)({endpoint:_(t,"/v1/restore"),method:"POST",requestBody:r});if(!T(s)||!Array.isArray(s?.outputs)||!Array.isArray(s?.signatures))throw new Error("bad response");return s}async restore(t){return S.restore(this._mintUrl,t,this._customRequest)}async connectWebSocket(){if(this.ws)await this.ws.ensureConnection();else{const t=new URL(this._mintUrl),r="v1/ws";t.pathname&&(t.pathname.endsWith("/")?t.pathname+=r:t.pathname+="/"+r),this.ws=N.getInstance().getConnection(`${t.protocol==="https:"?"wss":"ws"}://${t.host}${t.pathname}`);try{await this.ws.connect()}catch(n){throw console.log(n),new Error("Failed to connect to WebSocket...")}}}disconnectWebSocket(){this.ws&&this.ws.close()}get webSocketConnection(){return this.ws}async handleBlindAuth(t){if(this._checkNut22&&(await this.getLazyMintInfo()).requiresBlindAuthToken(t)){if(!this._authTokenGetter)throw new Error("Can not call a protected endpoint without authProofGetter");return this._authTokenGetter()}}}const ve=e=>{try{return e instanceof Uint8Array&&(e=new TextDecoder().decode(e)),JSON.parse(e)}catch{throw new Error("can't parse secret")}},Ie=(e,t)=>{const r=sha256$5(new TextDecoder().decode(e));return schnorr$1.sign(r,t)},bt=(e,t)=>{let r=[],n="";if(t instanceof Array)for(const s of t)r.push({priv:s,pub:bytesToHex$4(schnorr$1.getPublicKey(s))});else n=t;return e.map(s=>{try{const a=ve(s.secret);if(a[0]!=="P2PK")throw new Error("unknown secret type");if(r.length){const l=r.find(u=>a[1].data===u.pub)?.priv;if(l)n=l;else throw new Error("no matching key found")}return Te(s,hexToBytes$6(n))}catch{return s}})},Te=(e,t)=>(e.witness||(e.witness={signatures:[bytesToHex$4(Ie(e.secret,t))]}),e);function V(e,t,r){const n=H(e);t||(t=Q(secp256k1$3.utils.randomPrivateKey()));const s=secp256k1$3.ProjectivePoint.BASE.multiply(t);return{B_:n.add(s),r:t,secret:e}}function Ke(e,t,r){return e.subtract(r.multiply(t))}function Me(e,t,r,n){const s=n,a=Ke(e.C_,t,s);return{id:e.id,amount:e.amount,secret:r,C:a}}const et=e=>({amount:e.amount,C:e.C.toHex(!0),id:e.id,secret:new TextDecoder().decode(e.secret),witness:JSON.stringify(e.witness)});function qe(e,t){let r=e;for(const s of t)r+=s.B_;const n=new TextEncoder().encode(r);return sha256$5(n)}function De(e,t,r){const n=qe(t,r),s=hexToBytes$7(e),a=schnorr$1.sign(n,s);return bytesToHex$5(a)}class J{constructor(t,r,n){this.amount=t,this.B_=r,this.id=n}getSerializedBlindedMessage(){return{amount:this.amount,B_:this.B_.toHex(!0),id:this.id}}}const Ue="m/129372'/0'",Be=(e,t,r)=>Nt(e,t,r,0),xe=(e,t,r)=>Nt(e,t,r,1),Nt=(e,t,r,n)=>{const s=HDKey$1.fromMasterSeed(e),a=Wt(t),l=`${Ue}/${a}'/${r}'/${n}`,u=s.derive(l);if(u.privateKey===null)throw new Error("Could not derive private key");return u.privateKey};function Y(e){return typeof e=="function"}class M{constructor(t,r,n){this.secret=n,this.blindingFactor=r,this.blindedMessage=t}toProof(t,r){let n;t.dleq&&(n={s:hexToBytes$7(t.dleq.s),e:hexToBytes$7(t.dleq.e),r:this.blindingFactor});const s={id:t.id,amount:t.amount,C_:B(t.C_)},a=B(r.keys[t.amount]),l=Me(s,this.blindingFactor,this.secret,a);return{...et(l),...n&&{dleq:{s:bytesToHex$5(n.s),e:bytesToHex$5(n.e),r:de(n.r??BigInt(0))}}}}static createP2PKData(t,r,n,s){return A(r,n.keys,s).map(a=>this.createSingleP2PKData(t,a,n.id))}static createSingleP2PKData(t,r,n){const s=["P2PK",{nonce:bytesToHex$5(randomBytes$4(32)),data:t.pubkey,tags:[]}];t.locktime&&s[1].tags.push(["locktime",t.locktime]),t.refundKeys&&s[1].tags.push(["refund",...t.refundKeys]);const a=JSON.stringify(s),l=new TextEncoder().encode(a),{r:u,B_:x}=V(l);return new M(new J(r,x,n).getSerializedBlindedMessage(),u,l)}static createRandomData(t,r,n){return A(t,r.keys,n).map(s=>this.createSingleRandomData(s,r.id))}static createSingleRandomData(t,r){const n=bytesToHex$5(randomBytes$4(32)),s=new TextEncoder().encode(n),{r:a,B_:l}=V(s);return new M(new J(t,l,r).getSerializedBlindedMessage(),a,s)}static createDeterministicData(t,r,n,s,a){return A(t,s.keys,a).map((l,u)=>this.createSingleDeterministicData(l,r,n+u,s.id))}static createSingleDeterministicData(t,r,n,s){const a=Be(r,s,n),l=bytesToHex$5(a),u=new TextEncoder().encode(l),x=he(xe(r,s,n)),{r:f,B_:p}=V(u,x);return new M(new J(t,p,s).getSerializedBlindedMessage(),f,u)}}const Ne=3,Oe="sat";class Ze{constructor(t,r){this._keys=new Map,this._keysets=[],this._seed=void 0,this._unit=Oe,this._mintInfo=void 0,this._denominationTarget=Ne,this.mint=t;let n=[];if(r?.keys&&!Array.isArray(r.keys)?n=[r.keys]:r?.keys&&Array.isArray(r?.keys)&&(n=r?.keys),n&&n.forEach(s=>this._keys.set(s.id,s)),r?.unit&&(this._unit=r?.unit),r?.keysets&&(this._keysets=r.keysets),r?.mintInfo&&(this._mintInfo=new tt(r.mintInfo)),r?.denominationTarget&&(this._denominationTarget=r.denominationTarget),r?.bip39seed){if(r.bip39seed instanceof Uint8Array){this._seed=r.bip39seed;return}throw new Error("bip39seed must be a valid UInt8Array")}r?.keepFactory&&(this._keepFactory=r.keepFactory)}get unit(){return this._unit}get keys(){return this._keys}get keysetId(){if(!this._keysetId)throw new Error("No keysetId set");return this._keysetId}set keysetId(t){this._keysetId=t}get keysets(){return this._keysets}get mintInfo(){if(!this._mintInfo)throw new Error("Mint info not loaded");return this._mintInfo}async getMintInfo(){const t=await this.mint.getInfo();return this._mintInfo=new tt(t),this._mintInfo}async lazyGetMintInfo(){return this._mintInfo?this._mintInfo:await this.getMintInfo()}async loadMint(){await this.getMintInfo(),await this.getKeySets(),await this.getKeys()}getActiveKeyset(t){let r=t.filter(s=>s.active);r=r.filter(s=>s.id.startsWith("00"));const n=r.sort((s,a)=>(s.input_fee_ppk??0)-(a.input_fee_ppk??0))[0];if(!n)throw new Error("No active keyset found");return n}async getKeySets(){const t=(await this.mint.getKeySets()).keysets.filter(r=>r.unit===this._unit);return this._keysets=t,this._keysets}async getAllKeys(){const t=await this.mint.getKeys();return t.keysets.forEach(r=>{if(!wt(r))throw new Error(`Couldn't verify keyset ID ${r.id}`)}),this._keys=new Map(t.keysets.map(r=>[r.id,r])),this.keysetId=this.getActiveKeyset(this._keysets).id,t.keysets}async getKeys(t,r){if((!(this._keysets.length>0)||r)&&await this.getKeySets(),t||(t=this.getActiveKeyset(this._keysets).id),!this._keysets.find(n=>n.id===t)&&(await this.getKeySets(),!this._keysets.find(n=>n.id===t)))throw new Error(`could not initialize keys. No keyset with id '${t}' found`);if(!this._keys.get(t)){const n=await this.mint.getKeys(t);if(!wt(n.keysets[0]))throw new Error(`Couldn't verify keyset ID ${n.keysets[0].id}`);this._keys.set(t,n.keysets[0])}return this.keysetId=t,this._keys.get(t)}async receive(t,r){const{requireDleq:n,keysetId:s,outputAmounts:a,counter:l,pubkey:u,privkey:x,outputData:f,p2pk:p}=r||{};typeof t=="string"&&(t=pe(t));const g=await this.getKeys(s);if(n&&t.proofs.some(Ve=>!Bt(Ve,g)))throw new Error("Token contains proofs with invalid DLEQ");const y=U(t.proofs)-this.getFeesForProofs(t.proofs);let w;f?w={send:f}:this._keepFactory&&(w={send:this._keepFactory});const R=this.createSwapPayload(y,t.proofs,g,a,l,u,x,w,p),{signatures:I}=await this.mint.swap(R.payload),k=R.outputData.map((Ve,q)=>Ve.toProof(I[q],g)),je=[];return R.sortedIndices.forEach((Ve,q)=>{je[Ve]=k[q]}),je}async send(t,r,n){const{proofsWeHave:s,offline:a,includeFees:l,includeDleq:u,keysetId:x,outputAmounts:f,pubkey:p,privkey:g,outputData:y}=n||{};if(u&&(r=r.filter(k=>k.dleq!=null)),U(r)<t)throw new Error("Not enough funds available to send");const{keep:w,send:R}=this.selectProofsToSend(r,t,n?.includeFees),I=l?this.getFeesForProofs(R):0;if(!a&&(U(R)!=t+I||f||p||g||x||y)){const{keep:k,send:je}=this.selectProofsToSend(r,t,!0);s?.push(...k);const Ve=await this.swap(t,je,n);let{keep:q,send:$e}=Ve;const We=Ve.serialized;return q=k.concat(q),u||($e=j($e)),{keep:q,send:$e,serialized:We}}if(U(R)<t+I)throw new Error("Not enough funds available to send");return u?{keep:w,send:R}:{keep:w,send:j(R)}}selectProofsToSend(t,r,n){const s=t.sort((y,w)=>y.amount-w.amount),a=s.filter(y=>y.amount<=r).sort((y,w)=>w.amount-y.amount),l=s.filter(y=>y.amount>r).sort((y,w)=>y.amount-w.amount)[0];if(!a.length&&l)return{keep:t.filter(y=>y.secret!==l.secret),send:[l]};if(!a.length&&!l)return{keep:t,send:[]};let u=r,x=[a[0]];const f=[],p=n?this.getFeesForProofs(x):0;if(u-=x[0].amount-p/1e3,u>0){const{keep:y,send:w}=this.selectProofsToSend(a.slice(1),u,n);x.push(...w),f.push(...y)}const g=n?this.getFeesForProofs(x):0;return U(x)<r+g&&l&&(x=[l]),{keep:t.filter(y=>!x.includes(y)),send:x}}getFeesForProofs(t){if(!this._keysets.length)throw new Error("Could not calculate fees. No keysets found");return new Set(t.map(r=>r.id)).forEach(r=>{if(!this._keysets.find(n=>n.id===r))throw new Error(`Could not calculate fees. No keyset found with id: ${r}`)}),Math.floor(Math.max((t.reduce((r,n)=>r+(this._keysets.find(s=>s.id===n.id)?.input_fee_ppk||0),0)+999)/1e3,0))}getFeesForKeyset(t,r){return Math.floor(Math.max((t*(this._keysets.find(n=>n.id===r)?.input_fee_ppk||0)+999)/1e3,0))}async swap(t,r,n){let{outputAmounts:s}=n||{};const{includeFees:a,keysetId:l,counter:u,pubkey:x,privkey:f,proofsWeHave:p,outputData:g,p2pk:y}=n||{},w=await this.getKeys(l),R=r;let I=t;const k=U(r);let je=k-I-this.getFeesForProofs(R),Ve=s?.sendAmounts||A(I,w.keys);if(a){let D=this.getFeesForKeyset(Ve.length,w.id),_e=A(D,w.keys);for(;this.getFeesForKeyset(Ve.concat(_e).length,w.id)>D;)D++,_e=A(D,w.keys);Ve=Ve.concat(_e),I+=D,je-=D}let q;if(!s?.keepAmounts&&p)q=mt(p,je,w.keys,this._denominationTarget);else if(s){if(s.keepAmounts?.reduce((D,_e)=>D+_e,0)!=je)throw new Error("Keep amounts do not match amount to keep");q=s.keepAmounts}if(I+this.getFeesForProofs(R)>k)throw console.error(`Not enough funds available (${k}) for swap amountToSend: ${I} + fee: ${this.getFeesForProofs(R)} | length: ${R.length}`),new Error("Not enough funds available for swap");if(I+this.getFeesForProofs(R)+je!=k)throw new Error("Amounts do not match for swap");s={keepAmounts:q,sendAmounts:Ve};const $e=g?.keep||this._keepFactory,We=g?.send,K=this.createSwapPayload(I,R,w,s,u,x,f,{keep:$e,send:We},y),{signatures:W}=await this.mint.swap(K.payload),Ye=K.outputData.map((D,_e)=>D.toProof(W[_e],w)),Qe=[],it=[],ze=Array(K.keepVector.length),v=Array(Ye.length);return K.sortedIndices.forEach((D,_e)=>{ze[D]=K.keepVector[_e],v[D]=Ye[_e]}),v.forEach((D,_e)=>{ze[_e]?Qe.push(D):it.push(D)}),{keep:Qe,send:it}}async batchRestore(t=300,r=100,n=0,s){const a=Math.ceil(t/r),l=[];let u,x=0;for(;x<a;){const f=await this.restore(n,r,{keysetId:s});f.proofs.length>0?(x=0,l.push(...f.proofs),u=f.lastCounterWithSignature):x++,n+=r}return{proofs:l,lastCounterWithSignature:u}}async restore(t,r,n){const{keysetId:s}=n||{},a=await this.getKeys(s);if(!this._seed)throw new Error("CashuWallet must be initialized with a seed to use restore");const l=Array(r).fill(1),u=M.createDeterministicData(l.length,this._seed,t,a,l),{outputs:x,signatures:f}=await this.mint.restore({outputs:u.map(w=>w.blindedMessage)}),p={};x.forEach((w,R)=>p[w.B_]=f[R]);const g=[];let y;for(let w=0;w<u.length;w++){const R=p[u[w].blindedMessage.B_];R&&(y=t+w,u[w].blindedMessage.amount=R.amount,g.push(u[w].toProof(R,a)))}return{proofs:g,lastCounterWithSignature:y}}async createMintQuote(t,r){const n={unit:this._unit,amount:t,description:r},s=await this.mint.createMintQuote(n);return{...s,amount:s.amount||t,unit:s.unit||this.unit}}async createLockedMintQuote(t,r,n){const{supported:s}=(await this.getMintInfo()).isSupported(20);if(!s)throw new Error("Mint does not support NUT-20");const a={unit:this._unit,amount:t,description:n,pubkey:r},l=await this.mint.createMintQuote(a);if(typeof l.pubkey!="string")throw new Error("Mint returned unlocked mint quote");{const u=l.pubkey;return{...l,pubkey:u,amount:l.amount||t,unit:l.unit||this.unit}}}async checkMintQuote(t){const r=typeof t=="string"?t:t.quote,n=await this.mint.checkMintQuote(r);return typeof t=="string"?n:{...n,amount:n.amount||t.amount,unit:n.unit||t.unit}}async mintProofs(t,r,n){let{outputAmounts:s}=n||{};const{counter:a,pubkey:l,p2pk:u,keysetId:x,proofsWeHave:f,outputData:p,privateKey:g}=n||{},y=await this.getKeys(x);!s&&f&&(s={keepAmounts:mt(f,t,y.keys,this._denominationTarget),sendAmounts:[]});let w=[];if(p)if(Y(p)){const k=A(t,y.keys,s?.keepAmounts);for(let je=0;je<k.length;je++)w.push(p(k[je],y))}else w=p;else if(this._keepFactory){const k=A(t,y.keys,s?.keepAmounts);for(let je=0;je<k.length;je++)w.push(this._keepFactory(k[je],y))}else w=this.createOutputData(t,y,a,l,s?.keepAmounts,u);let R;if(typeof r!="string"){if(!g)throw new Error("Can not sign locked quote without private key");const k=w.map(Ve=>Ve.blindedMessage),je=De(g,r.quote,k);R={outputs:k,quote:r.quote,signature:je}}else R={outputs:w.map(k=>k.blindedMessage),quote:r};const{signatures:I}=await this.mint.mint(R);return w.map((k,je)=>k.toProof(I[je],y))}async createMeltQuote(t){const r={unit:this._unit,request:t},n=await this.mint.createMeltQuote(r);return{...n,unit:n.unit||this.unit,request:n.request||t}}async createMultiPathMeltQuote(t,r){const{supported:n,params:s}=(await this.lazyGetMintInfo()).isSupported(15);if(!n)throw new Error("Mint does not support NUT-15");if(!s?.some(u=>u.method==="bolt11"&&u.unit===this.unit))throw new Error(`Mint does not support MPP for bolt11 and ${this.unit}`);const a={mpp:{amount:r}},l={unit:this._unit,request:t,options:a};return{...await this.mint.createMeltQuote(l),request:t,unit:this._unit}}async checkMeltQuote(t){const r=typeof t=="string"?t:t.quote,n=await this.mint.checkMeltQuote(r);return typeof t=="string"?n:{...n,request:t.request,unit:t.unit}}async meltProofs(t,r,n){const{keysetId:s,counter:a,privkey:l}=n||{},u=await this.getKeys(s),x=this.createBlankOutputs(U(r)-t.amount,u,a,this._keepFactory);l!=null&&(r=bt(r.map(g=>({amount:g.amount,C:B(g.C),id:g.id,secret:new TextEncoder().encode(g.secret)})),l).map(g=>et(g))),r=j(r);const f={quote:t.quote,inputs:r,outputs:x.map(g=>g.blindedMessage)},p=await this.mint.melt(f);return{quote:{...p,unit:t.unit,request:t.request},change:p.change?.map((g,y)=>x[y].toProof(g,u))??[]}}createSwapPayload(t,r,n,s,a,l,u,x,f){const p=r.reduce((q,$e)=>q+$e.amount,0);s&&s.sendAmounts&&!s.keepAmounts&&(s.keepAmounts=A(p-t-this.getFeesForProofs(r),n.keys));const g=p-t-this.getFeesForProofs(r);let y=[],w=[];if(x?.keep)if(Y(x.keep)){const q=x.keep;A(g,n.keys).forEach($e=>{y.push(q($e,n))})}else y=x.keep;else y=this.createOutputData(g,n,a,void 0,s?.keepAmounts,void 0,this._keepFactory);if(x?.send)if(Y(x.send)){const q=x.send;A(t,n.keys).forEach($e=>{w.push(q($e,n))})}else w=x.send;else w=this.createOutputData(t,n,a?a+y.length:void 0,l,s?.sendAmounts,f);u&&(r=bt(r.map(q=>({amount:q.amount,C:B(q.C),id:q.id,secret:new TextEncoder().encode(q.secret)})),u).map(q=>et(q))),r=j(r);const R=[...y,...w],I=R.map((q,$e)=>$e).sort((q,$e)=>R[q].blindedMessage.amount-R[$e].blindedMessage.amount),k=[...Array(y.length).fill(!0),...Array(w.length).fill(!1)],je=I.map(q=>R[q]),Ve=I.map(q=>k[q]);return{payload:{inputs:r,outputs:je.map(q=>q.blindedMessage)},outputData:je,keepVector:Ve,sortedIndices:I}}async checkProofsStates(t){const r=new TextEncoder,n=t.map(l=>H(r.encode(l.secret)).toHex(!0)),s=100,a=[];for(let l=0;l<n.length;l+=s){const u=n.slice(l,l+s),{states:x}=await this.mint.check({Ys:u}),f={};x.forEach(p=>{f[p.Y]=p});for(let p=0;p<u.length;p++){const g=f[u[p]];if(!g)throw new Error("Could not find state for proof with Y: "+u[p]);a.push(g)}}return a}async onMintQuoteUpdates(t,r,n){if(await this.mint.connectWebSocket(),!this.mint.webSocketConnection)throw new Error("failed to establish WebSocket connection.");const s=this.mint.webSocketConnection.createSubscription({kind:"bolt11_mint_quote",filters:t},r,n);return()=>{this.mint.webSocketConnection?.cancelSubscription(s,r)}}async onMeltQuotePaid(t,r,n){return this.onMeltQuoteUpdates([t],s=>{s.state===C.PAID&&r(s)},n)}async onMintQuotePaid(t,r,n){return this.onMintQuoteUpdates([t],s=>{s.state===Z.PAID&&r(s)},n)}async onMeltQuoteUpdates(t,r,n){if(await this.mint.connectWebSocket(),!this.mint.webSocketConnection)throw new Error("failed to establish WebSocket connection.");const s=this.mint.webSocketConnection.createSubscription({kind:"bolt11_melt_quote",filters:t},r,n);return()=>{this.mint.webSocketConnection?.cancelSubscription(s,r)}}async onProofStateUpdates(t,r,n){if(await this.mint.connectWebSocket(),!this.mint.webSocketConnection)throw new Error("failed to establish WebSocket connection.");const s=new TextEncoder,a={};for(let x=0;x<t.length;x++){const f=H(s.encode(t[x].secret)).toHex(!0);a[f]=t[x]}const l=Object.keys(a),u=this.mint.webSocketConnection.createSubscription({kind:"proof_state",filters:l},x=>{r({...x,proof:a[x.Y]})},n);return()=>{this.mint.webSocketConnection?.cancelSubscription(u,r)}}createOutputData(t,r,n,s,a,l,u){let x;if(s)x=M.createP2PKData({pubkey:s},t,r,a);else if(n||n===0){if(!this._seed)throw new Error("cannot create deterministic messages without seed");x=M.createDeterministicData(t,this._seed,n,r,a)}else l?x=M.createP2PKData(l,t,r,a):u?x=A(t,r.keys).map(f=>u(f,r)):x=M.createRandomData(t,r,a);return x}createBlankOutputs(t,r,n,s){let a=Math.ceil(Math.log2(t))||1;a<0&&(a=0);const l=a?Array(a).fill(1):[];return this.createOutputData(l.length,r,n,void 0,l,void 0,s)}}let publishTimer=null;const useEcashStore=create()((e,t)=>({mints:{},proofs:[],history:[],discoveredMints:{},pendingSends:[],addMint:(r,n)=>e(s=>({mints:{...s.mints,[r]:{url:r,keys:n,active:!0}}})),removeMint:r=>e(n=>{const{[r]:s,...a}=n.mints;return{mints:a}}),addProofs:(r,n=!1)=>{e(s=>{const a=new Set(s.proofs.map(u=>u.secret)),l=r.filter(u=>!a.has(u.secret));return{proofs:[...s.proofs,...l]}}),n||t().publishProofsToNostr()},removeProofs:(r,n=!1)=>{e(s=>{const a=new Set(r.map(l=>l.secret));return{proofs:s.proofs.filter(l=>!a.has(l.secret))}}),n||t().publishProofsToNostr()},mergeWalletState:r=>{const n=new Set(t().proofs.map(u=>u.secret)),s=r.proofs.filter(u=>!n.has(u.secret)),a=new Set(t().history.map(u=>u.id)),l=r.history.filter(u=>!a.has(u.id));s.length>0||l.length>0?(console.log(` Merging ${s.length} new proofs + ${l.length} new history entries from NIP-60`),e(u=>({proofs:[...u.proofs,...s],history:[...l,...u.history]}))):console.log(" All NIP-60 wallet state already present")},addHistoryItem:r=>e(n=>n.history.some(s=>s.id===r.id)?(console.log(` Skipping duplicate history entry: ${r.id}`),n):{history:[r,...n.history]}),addPendingSend:r=>e(n=>({pendingSends:[...n.pendingSends,r]})),removePendingSend:r=>e(n=>({pendingSends:n.pendingSends.filter(s=>s.id!==r)})),updatePendingSendAttempt:(r,n)=>e(s=>({pendingSends:s.pendingSends.map(a=>a.id===r?{...a,attempts:a.attempts+1,lastError:n}:a)})),addDiscoveredMint:r=>e(n=>n.discoveredMints[r.url]?n:{discoveredMints:{...n.discoveredMints,[r.url]:r}}),updateMintStatus:(r,n)=>e(s=>{const a=s.discoveredMints[r];return a?{discoveredMints:{...s.discoveredMints,[r]:{...a,status:n}}}:s}),updateMintTrust:(r,n)=>e(s=>{const a=s.discoveredMints[r];return a?{discoveredMints:{...s.discoveredMints,[r]:{...a,trustScore:a.trustScore+n,reviews:a.reviews+1}}}:s}),getBalance:()=>{const{proofs:r}=t();return r.reduce((n,s)=>n+s.amount,0)},getMintBalance:r=>{const{proofs:n}=t();return n.reduce((s,a)=>s+a.amount,0)},publishProofsToNostr:async(r=!1)=>{publishTimer&&clearTimeout(publishTimer),publishTimer=setTimeout(async()=>{try{const{useAuthStore:n}=await __vitePreload(async()=>{const{useAuthStore:R}=await Promise.resolve().then(()=>auth);return{useAuthStore:R}},void 0,import.meta.url),{Nip60Service:s}=await __vitePreload(async()=>{const{Nip60Service:R}=await Promise.resolve().then(()=>nip61);return{Nip60Service:R}},void 0,import.meta.url),a=(await __vitePreload(async()=>{const{default:R}=await Promise.resolve().then(()=>index$1);return{default:R}},void 0,import.meta.url)).default,{NDKPrivateKeySigner:l}=await __vitePreload(async()=>{const{NDKPrivateKeySigner:R}=await Promise.resolve().then(()=>index$1);return{NDKPrivateKeySigner:R}},void 0,import.meta.url),{decryptedKey:u,publicKey:x}=n.getState(),{proofs:f,history:p}=t();if(!u||!x){console.log(" Skipping NIP-60 publish (wallet locked)");return}console.log(` Publishing ${f.length} proofs + ${p.length} history entries to Nostr...`);const g=new a({explicitRelayUrls:["wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band","wss://relay.primal.net","wss://relay.snort.social","wss://purplepag.es"],signer:new l(u)});await g.connect(2e3);let y=[...f],w=[...p];if(r)console.log(" Skipping merge, publishing current state directly (consolidation mode)");else{console.log(" Fetching existing NIP-60 state from Nostr...");const R=await g.fetchEvents({kinds:[30078],authors:[x],"#d":["proofs"]});if(R.size>0){console.log(` Found ${R.size} existing NIP-60 event(s), merging all...`);for(const je of R)try{const Ve=await s.decryptWalletState(je.content,u,x),q=new Set(y.map(W=>W.secret)),$e=Ve.proofs.filter(W=>!q.has(W.secret));y=[...y,...$e];const We=new Set(w.map(W=>W.id)),K=Ve.history.filter(W=>!We.has(W.id));w=[...w,...K],($e.length>0||K.length>0)&&console.log(`   Event ${je.id.substring(0,8)}: +${$e.length} proofs, +${K.length} history`)}catch(Ve){console.error(` Failed to decrypt event ${je.id.substring(0,8)}:`,Ve)}const I=y.length-f.length,k=w.length-p.length;console.log(` Total merged: ${y.length} proofs (+${I} from Nostr), ${w.length} history (+${k} from Nostr)`)}else console.log(" No existing NIP-60 event found, publishing fresh state")}await s.publishWalletState(g,{proofs:y,history:w},u,x),!r&&y.length>f.length&&(console.log(` Updating local state with ${y.length-f.length} proofs from Nostr`),e({proofs:y,history:w}))}catch(n){console.error("Failed to publish wallet state to Nostr:",n)}},2e3)},reset:()=>e({mints:{},proofs:[],history:[],discoveredMints:{}}),saveSession:r=>{const n=t(),s={mints:n.mints,proofs:n.proofs,history:n.history,discoveredMints:n.discoveredMints,pendingSends:n.pendingSends};localStorage.setItem(`ecash-backup-${r}`,JSON.stringify(s)),console.log(` Saved eCash session for ${r.slice(0,8)}`)},loadSession:r=>{const n=localStorage.getItem(`ecash-backup-${r}`);if(n)try{const s=JSON.parse(n);e({mints:s.mints||{},proofs:s.proofs||[],history:s.history||[],discoveredMints:s.discoveredMints||{},pendingSends:s.pendingSends||[]}),console.log(` Loaded eCash session for ${r.slice(0,8)}`)}catch(s){console.error("Failed to load session:",s),t().reset()}else console.log(` New session for ${r.slice(0,8)}`),t().reset()}})),useAuthStore=create()(persist((e,t)=>({encryptedKey:null,publicKey:null,isUnlocked:!1,decryptedKey:null,password:null,setEncryptedKey:(r,n)=>e({encryptedKey:r,publicKey:n}),unlock:(r,n,s)=>e({isUnlocked:!0,decryptedKey:r,publicKey:n,password:s||null}),lock:()=>e({isUnlocked:!1,decryptedKey:null,password:null}),logout:()=>{const{publicKey:r}=t();r&&useEcashStore.getState().saveSession(r),useEcashStore.getState().reset(),e({encryptedKey:null,publicKey:null,isUnlocked:!1,decryptedKey:null,password:null})}}),{name:"amber-auth-storage",partialize:e=>({encryptedKey:e.encryptedKey,publicKey:e.publicKey})})),auth=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore},Symbol.toStringTag,{value:"Module"})),useWalletStore=create()(persist((e,t)=>({wallets:[],currentWalletId:null,currentKeypairId:null,addWallet:r=>e(n=>({wallets:[...n.wallets,r]})),removeWallet:r=>e(n=>({wallets:n.wallets.filter(s=>s.id!==r),currentWalletId:n.currentWalletId===r?null:n.currentWalletId})),updateWallet:(r,n)=>e(s=>({wallets:s.wallets.map(a=>a.id===r?{...a,...n}:a)})),getWallet:r=>t().wallets.find(n=>n.id===r),setCurrentWallet:r=>e(n=>{const a=n.wallets.find(l=>l.id===r)?.keypairs[0]?.id||null;return{currentWalletId:r,currentKeypairId:a}}),setCurrentKeypair:r=>e({currentKeypairId:r}),addKeypair:(r,n)=>e(s=>({wallets:s.wallets.map(a=>a.id===r?{...a,keypairs:[...a.keypairs,n]}:a)})),removeKeypair:(r,n)=>e(s=>({wallets:s.wallets.map(a=>a.id===r?{...a,keypairs:a.keypairs.filter(l=>l.id!==n)}:a),currentKeypairId:s.currentKeypairId===n?null:s.currentKeypairId})),updateKeypair:(r,n,s)=>e(a=>({wallets:a.wallets.map(l=>l.id===r?{...l,keypairs:l.keypairs.map(u=>u.id===n?{...u,...s}:u)}:l)})),getKeypair:r=>{for(const n of t().wallets){const s=n.keypairs.find(a=>a.id===r);if(s)return s}},getCurrentKeypair:()=>{const{currentKeypairId:r}=t();if(r)return t().getKeypair(r)}}),{name:"wallet-storage",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-awXA2Uq6.js");return{storage:r}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:r}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-awXA2Uq6.js");return{storage:n}},[],import.meta.url);return r.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-awXA2Uq6.js");return{storage:r}},[],import.meta.url);return t.removeItem(e)}}))}));function isBytes$4(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber$3(e,t=""){if(!Number.isSafeInteger(e)||e<0){const r=t&&`"${t}" `;throw new Error(`${r}expected integer >= 0, got ${e}`)}}function abytes$1(e,t,r=""){const n=isBytes$4(e),s=e?.length,a=t!==void 0;if(!n||a&&s!==t){const l=r&&`"${r}" `,u=a?` of length ${t}`:"",x=n?`length=${s}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+u+", got "+x)}return e}function ahash$1(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");anumber$3(e.outputLen),anumber$3(e.blockLen)}function aexists$1(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput$1(e,t){abytes$1(e,void 0,"digestInto() output");const r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function clean$1(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView$4(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr$3(e,t){return e<<32-t|e>>>t}function utf8ToBytes$4(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function kdfInputToBytes(e,t=""){return typeof e=="string"?utf8ToBytes$4(e):abytes$1(e,void 0,t)}function checkOpts$2(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}function createHasher$1(e,t={}){const r=(s,a)=>e(a).update(s).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=s=>e(s),Object.assign(r,t),Object.freeze(r)}function randomBytes$3(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const oidNist$1=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});let _HMAC$1=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(ahash$1(t),abytes$1(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(r.length>n?t.create().update(r).digest():r);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),clean$1(s)}update(t){return aexists$1(this),this.iHash.update(t),this}digestInto(t){aexists$1(this),abytes$1(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:n,finished:s,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=s,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$4=(e,t,r)=>new _HMAC$1(e,t).update(r).digest();hmac$4.create=(e,t)=>new _HMAC$1(e,t);function pbkdf2Init$1(e,t,r,n){ahash$1(e);const s=checkOpts$2({dkLen:32,asyncTick:10},n),{c:a,dkLen:l,asyncTick:u}=s;if(anumber$3(a,"c"),anumber$3(l,"dkLen"),anumber$3(u,"asyncTick"),a<1)throw new Error("iterations (c) must be >= 1");const x=kdfInputToBytes(t,"password"),f=kdfInputToBytes(r,"salt"),p=new Uint8Array(l),g=hmac$4.create(e,x),y=g._cloneInto().update(f);return{c:a,dkLen:l,asyncTick:u,DK:p,PRF:g,PRFSalt:y}}function pbkdf2Output$1(e,t,r,n,s){return e.destroy(),t.destroy(),n&&n.destroy(),clean$1(s),r}function pbkdf2$1(e,t,r,n){const{c:s,dkLen:a,DK:l,PRF:u,PRFSalt:x}=pbkdf2Init$1(e,t,r,n);let f;const p=new Uint8Array(4),g=createView$4(p),y=new Uint8Array(u.outputLen);for(let w=1,R=0;R<a;w++,R+=u.outputLen){const I=l.subarray(R,R+u.outputLen);g.setInt32(0,w,!1),(f=x._cloneInto(f)).update(p).digestInto(y),I.set(y.subarray(0,I.length));for(let k=1;k<s;k++){u._cloneInto(f).update(y).digestInto(y);for(let je=0;je<I.length;je++)I[je]^=y[je]}}return pbkdf2Output$1(u,x,l,f,y)}function Chi$3(e,t,r){return e&t^~e&r}function Maj$3(e,t,r){return e&t^e&r^t&r}let HashMD$1=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,s){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(t),this.view=createView$4(this.buffer)}update(t){aexists$1(this),abytes$1(t);const{view:r,buffer:n,blockLen:s}=this,a=t.length;for(let l=0;l<a;){const u=Math.min(s-this.pos,a-l);if(u===s){const x=createView$4(t);for(;s<=a-l;l+=s)this.process(x,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists$1(this),aoutput$1(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:a}=this;let{pos:l}=this;r[l++]=128,clean$1(this.buffer.subarray(l)),this.padOffset>s-l&&(this.process(n,0),l=0);for(let g=l;g<s;g++)r[g]=0;n.setBigUint64(s-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$4(t),x=this.outputLen;if(x%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const f=x/4,p=this.get();if(f>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<f;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:a,destroyed:l,pos:u}=this;return t.destroyed=l,t.finished=a,t.length=s,t.pos=u,s%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}};const SHA256_IV$1=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA512_IV$1=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),U32_MASK64$1=BigInt(2**32-1),_32n$1=BigInt(32);function fromBig$1(e,t=!1){return t?{h:Number(e&U32_MASK64$1),l:Number(e>>_32n$1&U32_MASK64$1)}:{h:Number(e>>_32n$1&U32_MASK64$1)|0,l:Number(e&U32_MASK64$1)|0}}function split$1(e,t=!1){const r=e.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let a=0;a<r;a++){const{h:l,l:u}=fromBig$1(e[a],t);[n[a],s[a]]=[l,u]}return[n,s]}const shrSH$1=(e,t,r)=>e>>>r,shrSL$1=(e,t,r)=>e<<32-r|t>>>r,rotrSH$1=(e,t,r)=>e>>>r|t<<32-r,rotrSL$1=(e,t,r)=>e<<32-r|t>>>r,rotrBH$1=(e,t,r)=>e<<64-r|t>>>r-32,rotrBL$1=(e,t,r)=>e>>>r-32|t<<64-r;function add$1(e,t,r,n){const s=(t>>>0)+(n>>>0);return{h:e+r+(s/2**32|0)|0,l:s|0}}const add3L$1=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H$1=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L$1=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H$1=(e,t,r,n,s)=>t+r+n+s+(e/2**32|0)|0,add5L$1=(e,t,r,n,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(s>>>0),add5H$1=(e,t,r,n,s,a)=>t+r+n+s+a+(e/2**32|0)|0,SHA256_K$3=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W$3=new Uint32Array(64);let SHA2_32B$1=class extends HashMD$1{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:r,C:n,D:s,E:a,F:l,G:u,H:x}=this;return[t,r,n,s,a,l,u,x]}set(t,r,n,s,a,l,u,x){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=x|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W$3[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W$3[g-15],w=SHA256_W$3[g-2],R=rotr$3(y,7)^rotr$3(y,18)^y>>>3,I=rotr$3(w,17)^rotr$3(w,19)^w>>>10;SHA256_W$3[g]=I+SHA256_W$3[g-7]+R+SHA256_W$3[g-16]|0}let{A:n,B:s,C:a,D:l,E:u,F:x,G:f,H:p}=this;for(let g=0;g<64;g++){const y=rotr$3(u,6)^rotr$3(u,11)^rotr$3(u,25),w=p+y+Chi$3(u,x,f)+SHA256_K$3[g]+SHA256_W$3[g]|0,I=(rotr$3(n,2)^rotr$3(n,13)^rotr$3(n,22))+Maj$3(n,s,a)|0;p=f,f=x,x=u,u=l+w|0,l=a,a=s,s=n,n=w+I|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,x=x+this.F|0,f=f+this.G|0,p=p+this.H|0,this.set(n,s,a,l,u,x,f,p)}roundClean(){clean$1(SHA256_W$3)}destroy(){this.set(0,0,0,0,0,0,0,0),clean$1(this.buffer)}},_SHA256$1=class extends SHA2_32B$1{A=SHA256_IV$1[0]|0;B=SHA256_IV$1[1]|0;C=SHA256_IV$1[2]|0;D=SHA256_IV$1[3]|0;E=SHA256_IV$1[4]|0;F=SHA256_IV$1[5]|0;G=SHA256_IV$1[6]|0;H=SHA256_IV$1[7]|0;constructor(){super(32)}};const K512$1=split$1(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),SHA512_Kh$1=K512$1[0],SHA512_Kl$1=K512$1[1],SHA512_W_H$1=new Uint32Array(80),SHA512_W_L$1=new Uint32Array(80);let SHA2_64B$1=class extends HashMD$1{constructor(t){super(128,t,16,!1)}get(){const{Ah:t,Al:r,Bh:n,Bl:s,Ch:a,Cl:l,Dh:u,Dl:x,Eh:f,El:p,Fh:g,Fl:y,Gh:w,Gl:R,Hh:I,Hl:k}=this;return[t,r,n,s,a,l,u,x,f,p,g,y,w,R,I,k]}set(t,r,n,s,a,l,u,x,f,p,g,y,w,R,I,k){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=a|0,this.Cl=l|0,this.Dh=u|0,this.Dl=x|0,this.Eh=f|0,this.El=p|0,this.Fh=g|0,this.Fl=y|0,this.Gh=w|0,this.Gl=R|0,this.Hh=I|0,this.Hl=k|0}process(t,r){for(let q=0;q<16;q++,r+=4)SHA512_W_H$1[q]=t.getUint32(r),SHA512_W_L$1[q]=t.getUint32(r+=4);for(let q=16;q<80;q++){const $e=SHA512_W_H$1[q-15]|0,We=SHA512_W_L$1[q-15]|0,K=rotrSH$1($e,We,1)^rotrSH$1($e,We,8)^shrSH$1($e,We,7),W=rotrSL$1($e,We,1)^rotrSL$1($e,We,8)^shrSL$1($e,We,7),Ye=SHA512_W_H$1[q-2]|0,Qe=SHA512_W_L$1[q-2]|0,it=rotrSH$1(Ye,Qe,19)^rotrBH$1(Ye,Qe,61)^shrSH$1(Ye,Qe,6),ze=rotrSL$1(Ye,Qe,19)^rotrBL$1(Ye,Qe,61)^shrSL$1(Ye,Qe,6),v=add4L$1(W,ze,SHA512_W_L$1[q-7],SHA512_W_L$1[q-16]),D=add4H$1(v,K,it,SHA512_W_H$1[q-7],SHA512_W_H$1[q-16]);SHA512_W_H$1[q]=D|0,SHA512_W_L$1[q]=v|0}let{Ah:n,Al:s,Bh:a,Bl:l,Ch:u,Cl:x,Dh:f,Dl:p,Eh:g,El:y,Fh:w,Fl:R,Gh:I,Gl:k,Hh:je,Hl:Ve}=this;for(let q=0;q<80;q++){const $e=rotrSH$1(g,y,14)^rotrSH$1(g,y,18)^rotrBH$1(g,y,41),We=rotrSL$1(g,y,14)^rotrSL$1(g,y,18)^rotrBL$1(g,y,41),K=g&w^~g&I,W=y&R^~y&k,Ye=add5L$1(Ve,We,W,SHA512_Kl$1[q],SHA512_W_L$1[q]),Qe=add5H$1(Ye,je,$e,K,SHA512_Kh$1[q],SHA512_W_H$1[q]),it=Ye|0,ze=rotrSH$1(n,s,28)^rotrBH$1(n,s,34)^rotrBH$1(n,s,39),v=rotrSL$1(n,s,28)^rotrBL$1(n,s,34)^rotrBL$1(n,s,39),D=n&a^n&u^a&u,_e=s&l^s&x^l&x;je=I|0,Ve=k|0,I=w|0,k=R|0,w=g|0,R=y|0,{h:g,l:y}=add$1(f|0,p|0,Qe|0,it|0),f=u|0,p=x|0,u=a|0,x=l|0,a=n|0,l=s|0;const P=add3L$1(it,v,_e);n=add3H$1(P,Qe,ze,D),s=P|0}({h:n,l:s}=add$1(this.Ah|0,this.Al|0,n|0,s|0)),{h:a,l}=add$1(this.Bh|0,this.Bl|0,a|0,l|0),{h:u,l:x}=add$1(this.Ch|0,this.Cl|0,u|0,x|0),{h:f,l:p}=add$1(this.Dh|0,this.Dl|0,f|0,p|0),{h:g,l:y}=add$1(this.Eh|0,this.El|0,g|0,y|0),{h:w,l:R}=add$1(this.Fh|0,this.Fl|0,w|0,R|0),{h:I,l:k}=add$1(this.Gh|0,this.Gl|0,I|0,k|0),{h:je,l:Ve}=add$1(this.Hh|0,this.Hl|0,je|0,Ve|0),this.set(n,s,a,l,u,x,f,p,g,y,w,R,I,k,je,Ve)}roundClean(){clean$1(SHA512_W_H$1,SHA512_W_L$1)}destroy(){clean$1(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},_SHA512$1=class extends SHA2_64B$1{Ah=SHA512_IV$1[0]|0;Al=SHA512_IV$1[1]|0;Bh=SHA512_IV$1[2]|0;Bl=SHA512_IV$1[3]|0;Ch=SHA512_IV$1[4]|0;Cl=SHA512_IV$1[5]|0;Dh=SHA512_IV$1[6]|0;Dl=SHA512_IV$1[7]|0;Eh=SHA512_IV$1[8]|0;El=SHA512_IV$1[9]|0;Fh=SHA512_IV$1[10]|0;Fl=SHA512_IV$1[11]|0;Gh=SHA512_IV$1[12]|0;Gl=SHA512_IV$1[13]|0;Hh=SHA512_IV$1[14]|0;Hl=SHA512_IV$1[15]|0;constructor(){super(64)}};const sha256$4=createHasher$1(()=>new _SHA256$1,oidNist$1(1)),sha512$2=createHasher$1(()=>new _SHA512$1,oidNist$1(3));function isBytes$3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function isArrayOf$1(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(r=>typeof r=="string"):t.every(r=>Number.isSafeInteger(r)):!1}function afn$1(e){if(typeof e!="function")throw new Error("function expected");return!0}function astr$1(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function anumber$2(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function aArr$1(e){if(!Array.isArray(e))throw new Error("array expected")}function astrArr$1(e,t){if(!isArrayOf$1(!0,t))throw new Error(`${e}: array of strings expected`)}function anumArr$1(e,t){if(!isArrayOf$1(!1,t))throw new Error(`${e}: array of numbers expected`)}function chain$2(...e){const t=a=>a,r=(a,l)=>u=>a(l(u)),n=e.map(a=>a.encode).reduceRight(r,t),s=e.map(a=>a.decode).reduce(r,t);return{encode:n,decode:s}}function alphabet$2(e){const t=typeof e=="string"?e.split(""):e,r=t.length;astrArr$1("alphabet",t);const n=new Map(t.map((s,a)=>[s,a]));return{encode:s=>(aArr$1(s),s.map(a=>{if(!Number.isSafeInteger(a)||a<0||a>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${a}". Allowed: ${e}`);return t[a]})),decode:s=>(aArr$1(s),s.map(a=>{astr$1("alphabet.decode",a);const l=n.get(a);if(l===void 0)throw new Error(`Unknown letter: "${a}". Allowed: ${e}`);return l}))}}function join$2(e=""){return astr$1("join",e),{encode:t=>(astrArr$1("join.decode",t),t.join(e)),decode:t=>(astr$1("join.decode",t),t.split(e))}}function padding$1(e,t="="){return anumber$2(e),astr$1("padding",t),{encode(r){for(astrArr$1("padding.encode",r);r.length*e%8;)r.push(t);return r},decode(r){astrArr$1("padding.decode",r);let n=r.length;if(n*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if((n-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,n)}}}function convertRadix$2(e,t,r){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: invalid to=${r}, base cannot be less than 2`);if(aArr$1(e),!e.length)return[];let n=0;const s=[],a=Array.from(e,u=>{if(anumber$2(u),u<0||u>=t)throw new Error(`invalid integer: ${u}`);return u}),l=a.length;for(;;){let u=0,x=!0;for(let f=n;f<l;f++){const p=a[f],g=t*u,y=g+p;if(!Number.isSafeInteger(y)||g/t!==u||y-p!==g)throw new Error("convertRadix: carry overflow");const w=y/r;u=y%r;const R=Math.floor(w);if(a[f]=R,!Number.isSafeInteger(R)||R*r+u!==y)throw new Error("convertRadix: carry overflow");if(x)R?x=!1:n=f;else continue}if(s.push(u),x)break}for(let u=0;u<e.length-1&&e[u]===0;u++)s.push(0);return s.reverse()}const gcd$1=(e,t)=>t===0?e:gcd$1(t,e%t),radix2carry$1=(e,t)=>e+(t-gcd$1(e,t)),powers=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function convertRadix2$1(e,t,r,n){if(aArr$1(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(radix2carry$1(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${radix2carry$1(t,r)}`);let s=0,a=0;const l=powers[t],u=powers[r]-1,x=[];for(const f of e){if(anumber$2(f),f>=l)throw new Error(`convertRadix2: invalid data word=${f} from=${t}`);if(s=s<<t|f,a+t>32)throw new Error(`convertRadix2: carry overflow pos=${a} from=${t}`);for(a+=t;a>=r;a-=r)x.push((s>>a-r&u)>>>0);const p=powers[a];if(p===void 0)throw new Error("invalid carry");s&=p-1}if(s=s<<r-a&u,!n&&a>=t)throw new Error("Excess padding");if(!n&&s>0)throw new Error(`Non-zero padding: ${s}`);return n&&a>0&&x.push(s>>>0),x}function radix$2(e){anumber$2(e);const t=2**8;return{encode:r=>{if(!isBytes$3(r))throw new Error("radix.encode input should be Uint8Array");return convertRadix$2(Array.from(r),t,e)},decode:r=>(anumArr$1("radix.decode",r),Uint8Array.from(convertRadix$2(r,e,t)))}}function radix2$1(e,t=!1){if(anumber$2(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry$1(8,e)>32||radix2carry$1(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!isBytes$3(r))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2$1(Array.from(r),8,e,!t)},decode:r=>(anumArr$1("radix2.decode",r),Uint8Array.from(convertRadix2$1(r,e,8,t)))}}function checksum$1(e,t){return anumber$2(e),afn$1(t),{encode(r){if(!isBytes$3(r))throw new Error("checksum.encode: input should be Uint8Array");const n=t(r).slice(0,e),s=new Uint8Array(r.length+e);return s.set(r),s.set(n,r.length),s},decode(r){if(!isBytes$3(r))throw new Error("checksum.decode: input should be Uint8Array");const n=r.slice(0,-e),s=r.slice(-e),a=t(n).slice(0,e);for(let l=0;l<e;l++)if(a[l]!==s[l])throw new Error("Invalid checksum");return n}}}const utils$8={alphabet:alphabet$2,chain:chain$2,checksum:checksum$1,convertRadix:convertRadix$2,convertRadix2:convertRadix2$1,radix:radix$2,radix2:radix2$1,join:join$2,padding:padding$1};const isJapanese=e=>e[0]==="";function nfkd(e){if(typeof e!="string")throw new TypeError("invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function normalize$2(e){const t=nfkd(e),r=t.split(" ");if(![12,15,18,21,24].includes(r.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:r}}function aentropy(e){if(abytes$1(e),![16,20,24,28,32].includes(e.length))throw new Error("invalid entropy length")}function generateMnemonic(e,t=128){if(anumber$3(t),t%32!==0||t>256)throw new TypeError("Invalid entropy");return entropyToMnemonic(randomBytes$3(t/8),e)}const calcChecksum=e=>{const t=8-e.length/4;return new Uint8Array([sha256$4(e)[0]>>t<<t])};function getCoder(e){if(!Array.isArray(e)||e.length!==2048||typeof e[0]!="string")throw new Error("Wordlist: expected array of 2048 strings");return e.forEach(t=>{if(typeof t!="string")throw new Error("wordlist: non-string element: "+t)}),utils$8.chain(utils$8.checksum(1,calcChecksum),utils$8.radix2(11,!0),utils$8.alphabet(e))}function mnemonicToEntropy(e,t){const{words:r}=normalize$2(e),n=getCoder(t).decode(r);return aentropy(n),n}function entropyToMnemonic(e,t){return aentropy(e),getCoder(t).encode(e).join(isJapanese(t)?"":" ")}function validateMnemonic(e,t){try{mnemonicToEntropy(e,t)}catch{return!1}return!0}const psalt=e=>nfkd("mnemonic"+e);function mnemonicToSeedSync(e,t=""){return pbkdf2$1(sha512$2,normalize$2(e).nfkd,psalt(t),{c:2048,dkLen:64})}const wordlist=`abandon
ability
able
about
above
absent
absorb
abstract
absurd
abuse
access
accident
account
accuse
achieve
acid
acoustic
acquire
across
act
action
actor
actress
actual
adapt
add
addict
address
adjust
admit
adult
advance
advice
aerobic
affair
afford
afraid
again
age
agent
agree
ahead
aim
air
airport
aisle
alarm
album
alcohol
alert
alien
all
alley
allow
almost
alone
alpha
already
also
alter
always
amateur
amazing
among
amount
amused
analyst
anchor
ancient
anger
angle
angry
animal
ankle
announce
annual
another
answer
antenna
antique
anxiety
any
apart
apology
appear
apple
approve
april
arch
arctic
area
arena
argue
arm
armed
armor
army
around
arrange
arrest
arrive
arrow
art
artefact
artist
artwork
ask
aspect
assault
asset
assist
assume
asthma
athlete
atom
attack
attend
attitude
attract
auction
audit
august
aunt
author
auto
autumn
average
avocado
avoid
awake
aware
away
awesome
awful
awkward
axis
baby
bachelor
bacon
badge
bag
balance
balcony
ball
bamboo
banana
banner
bar
barely
bargain
barrel
base
basic
basket
battle
beach
bean
beauty
because
become
beef
before
begin
behave
behind
believe
below
belt
bench
benefit
best
betray
better
between
beyond
bicycle
bid
bike
bind
biology
bird
birth
bitter
black
blade
blame
blanket
blast
bleak
bless
blind
blood
blossom
blouse
blue
blur
blush
board
boat
body
boil
bomb
bone
bonus
book
boost
border
boring
borrow
boss
bottom
bounce
box
boy
bracket
brain
brand
brass
brave
bread
breeze
brick
bridge
brief
bright
bring
brisk
broccoli
broken
bronze
broom
brother
brown
brush
bubble
buddy
budget
buffalo
build
bulb
bulk
bullet
bundle
bunker
burden
burger
burst
bus
business
busy
butter
buyer
buzz
cabbage
cabin
cable
cactus
cage
cake
call
calm
camera
camp
can
canal
cancel
candy
cannon
canoe
canvas
canyon
capable
capital
captain
car
carbon
card
cargo
carpet
carry
cart
case
cash
casino
castle
casual
cat
catalog
catch
category
cattle
caught
cause
caution
cave
ceiling
celery
cement
census
century
cereal
certain
chair
chalk
champion
change
chaos
chapter
charge
chase
chat
cheap
check
cheese
chef
cherry
chest
chicken
chief
child
chimney
choice
choose
chronic
chuckle
chunk
churn
cigar
cinnamon
circle
citizen
city
civil
claim
clap
clarify
claw
clay
clean
clerk
clever
click
client
cliff
climb
clinic
clip
clock
clog
close
cloth
cloud
clown
club
clump
cluster
clutch
coach
coast
coconut
code
coffee
coil
coin
collect
color
column
combine
come
comfort
comic
common
company
concert
conduct
confirm
congress
connect
consider
control
convince
cook
cool
copper
copy
coral
core
corn
correct
cost
cotton
couch
country
couple
course
cousin
cover
coyote
crack
cradle
craft
cram
crane
crash
crater
crawl
crazy
cream
credit
creek
crew
cricket
crime
crisp
critic
crop
cross
crouch
crowd
crucial
cruel
cruise
crumble
crunch
crush
cry
crystal
cube
culture
cup
cupboard
curious
current
curtain
curve
cushion
custom
cute
cycle
dad
damage
damp
dance
danger
daring
dash
daughter
dawn
day
deal
debate
debris
decade
december
decide
decline
decorate
decrease
deer
defense
define
defy
degree
delay
deliver
demand
demise
denial
dentist
deny
depart
depend
deposit
depth
deputy
derive
describe
desert
design
desk
despair
destroy
detail
detect
develop
device
devote
diagram
dial
diamond
diary
dice
diesel
diet
differ
digital
dignity
dilemma
dinner
dinosaur
direct
dirt
disagree
discover
disease
dish
dismiss
disorder
display
distance
divert
divide
divorce
dizzy
doctor
document
dog
doll
dolphin
domain
donate
donkey
donor
door
dose
double
dove
draft
dragon
drama
drastic
draw
dream
dress
drift
drill
drink
drip
drive
drop
drum
dry
duck
dumb
dune
during
dust
dutch
duty
dwarf
dynamic
eager
eagle
early
earn
earth
easily
east
easy
echo
ecology
economy
edge
edit
educate
effort
egg
eight
either
elbow
elder
electric
elegant
element
elephant
elevator
elite
else
embark
embody
embrace
emerge
emotion
employ
empower
empty
enable
enact
end
endless
endorse
enemy
energy
enforce
engage
engine
enhance
enjoy
enlist
enough
enrich
enroll
ensure
enter
entire
entry
envelope
episode
equal
equip
era
erase
erode
erosion
error
erupt
escape
essay
essence
estate
eternal
ethics
evidence
evil
evoke
evolve
exact
example
excess
exchange
excite
exclude
excuse
execute
exercise
exhaust
exhibit
exile
exist
exit
exotic
expand
expect
expire
explain
expose
express
extend
extra
eye
eyebrow
fabric
face
faculty
fade
faint
faith
fall
false
fame
family
famous
fan
fancy
fantasy
farm
fashion
fat
fatal
father
fatigue
fault
favorite
feature
february
federal
fee
feed
feel
female
fence
festival
fetch
fever
few
fiber
fiction
field
figure
file
film
filter
final
find
fine
finger
finish
fire
firm
first
fiscal
fish
fit
fitness
fix
flag
flame
flash
flat
flavor
flee
flight
flip
float
flock
floor
flower
fluid
flush
fly
foam
focus
fog
foil
fold
follow
food
foot
force
forest
forget
fork
fortune
forum
forward
fossil
foster
found
fox
fragile
frame
frequent
fresh
friend
fringe
frog
front
frost
frown
frozen
fruit
fuel
fun
funny
furnace
fury
future
gadget
gain
galaxy
gallery
game
gap
garage
garbage
garden
garlic
garment
gas
gasp
gate
gather
gauge
gaze
general
genius
genre
gentle
genuine
gesture
ghost
giant
gift
giggle
ginger
giraffe
girl
give
glad
glance
glare
glass
glide
glimpse
globe
gloom
glory
glove
glow
glue
goat
goddess
gold
good
goose
gorilla
gospel
gossip
govern
gown
grab
grace
grain
grant
grape
grass
gravity
great
green
grid
grief
grit
grocery
group
grow
grunt
guard
guess
guide
guilt
guitar
gun
gym
habit
hair
half
hammer
hamster
hand
happy
harbor
hard
harsh
harvest
hat
have
hawk
hazard
head
health
heart
heavy
hedgehog
height
hello
helmet
help
hen
hero
hidden
high
hill
hint
hip
hire
history
hobby
hockey
hold
hole
holiday
hollow
home
honey
hood
hope
horn
horror
horse
hospital
host
hotel
hour
hover
hub
huge
human
humble
humor
hundred
hungry
hunt
hurdle
hurry
hurt
husband
hybrid
ice
icon
idea
identify
idle
ignore
ill
illegal
illness
image
imitate
immense
immune
impact
impose
improve
impulse
inch
include
income
increase
index
indicate
indoor
industry
infant
inflict
inform
inhale
inherit
initial
inject
injury
inmate
inner
innocent
input
inquiry
insane
insect
inside
inspire
install
intact
interest
into
invest
invite
involve
iron
island
isolate
issue
item
ivory
jacket
jaguar
jar
jazz
jealous
jeans
jelly
jewel
job
join
joke
journey
joy
judge
juice
jump
jungle
junior
junk
just
kangaroo
keen
keep
ketchup
key
kick
kid
kidney
kind
kingdom
kiss
kit
kitchen
kite
kitten
kiwi
knee
knife
knock
know
lab
label
labor
ladder
lady
lake
lamp
language
laptop
large
later
latin
laugh
laundry
lava
law
lawn
lawsuit
layer
lazy
leader
leaf
learn
leave
lecture
left
leg
legal
legend
leisure
lemon
lend
length
lens
leopard
lesson
letter
level
liar
liberty
library
license
life
lift
light
like
limb
limit
link
lion
liquid
list
little
live
lizard
load
loan
lobster
local
lock
logic
lonely
long
loop
lottery
loud
lounge
love
loyal
lucky
luggage
lumber
lunar
lunch
luxury
lyrics
machine
mad
magic
magnet
maid
mail
main
major
make
mammal
man
manage
mandate
mango
mansion
manual
maple
marble
march
margin
marine
market
marriage
mask
mass
master
match
material
math
matrix
matter
maximum
maze
meadow
mean
measure
meat
mechanic
medal
media
melody
melt
member
memory
mention
menu
mercy
merge
merit
merry
mesh
message
metal
method
middle
midnight
milk
million
mimic
mind
minimum
minor
minute
miracle
mirror
misery
miss
mistake
mix
mixed
mixture
mobile
model
modify
mom
moment
monitor
monkey
monster
month
moon
moral
more
morning
mosquito
mother
motion
motor
mountain
mouse
move
movie
much
muffin
mule
multiply
muscle
museum
mushroom
music
must
mutual
myself
mystery
myth
naive
name
napkin
narrow
nasty
nation
nature
near
neck
need
negative
neglect
neither
nephew
nerve
nest
net
network
neutral
never
news
next
nice
night
noble
noise
nominee
noodle
normal
north
nose
notable
note
nothing
notice
novel
now
nuclear
number
nurse
nut
oak
obey
object
oblige
obscure
observe
obtain
obvious
occur
ocean
october
odor
off
offer
office
often
oil
okay
old
olive
olympic
omit
once
one
onion
online
only
open
opera
opinion
oppose
option
orange
orbit
orchard
order
ordinary
organ
orient
original
orphan
ostrich
other
outdoor
outer
output
outside
oval
oven
over
own
owner
oxygen
oyster
ozone
pact
paddle
page
pair
palace
palm
panda
panel
panic
panther
paper
parade
parent
park
parrot
party
pass
patch
path
patient
patrol
pattern
pause
pave
payment
peace
peanut
pear
peasant
pelican
pen
penalty
pencil
people
pepper
perfect
permit
person
pet
phone
photo
phrase
physical
piano
picnic
picture
piece
pig
pigeon
pill
pilot
pink
pioneer
pipe
pistol
pitch
pizza
place
planet
plastic
plate
play
please
pledge
pluck
plug
plunge
poem
poet
point
polar
pole
police
pond
pony
pool
popular
portion
position
possible
post
potato
pottery
poverty
powder
power
practice
praise
predict
prefer
prepare
present
pretty
prevent
price
pride
primary
print
priority
prison
private
prize
problem
process
produce
profit
program
project
promote
proof
property
prosper
protect
proud
provide
public
pudding
pull
pulp
pulse
pumpkin
punch
pupil
puppy
purchase
purity
purpose
purse
push
put
puzzle
pyramid
quality
quantum
quarter
question
quick
quit
quiz
quote
rabbit
raccoon
race
rack
radar
radio
rail
rain
raise
rally
ramp
ranch
random
range
rapid
rare
rate
rather
raven
raw
razor
ready
real
reason
rebel
rebuild
recall
receive
recipe
record
recycle
reduce
reflect
reform
refuse
region
regret
regular
reject
relax
release
relief
rely
remain
remember
remind
remove
render
renew
rent
reopen
repair
repeat
replace
report
require
rescue
resemble
resist
resource
response
result
retire
retreat
return
reunion
reveal
review
reward
rhythm
rib
ribbon
rice
rich
ride
ridge
rifle
right
rigid
ring
riot
ripple
risk
ritual
rival
river
road
roast
robot
robust
rocket
romance
roof
rookie
room
rose
rotate
rough
round
route
royal
rubber
rude
rug
rule
run
runway
rural
sad
saddle
sadness
safe
sail
salad
salmon
salon
salt
salute
same
sample
sand
satisfy
satoshi
sauce
sausage
save
say
scale
scan
scare
scatter
scene
scheme
school
science
scissors
scorpion
scout
scrap
screen
script
scrub
sea
search
season
seat
second
secret
section
security
seed
seek
segment
select
sell
seminar
senior
sense
sentence
series
service
session
settle
setup
seven
shadow
shaft
shallow
share
shed
shell
sheriff
shield
shift
shine
ship
shiver
shock
shoe
shoot
shop
short
shoulder
shove
shrimp
shrug
shuffle
shy
sibling
sick
side
siege
sight
sign
silent
silk
silly
silver
similar
simple
since
sing
siren
sister
situate
six
size
skate
sketch
ski
skill
skin
skirt
skull
slab
slam
sleep
slender
slice
slide
slight
slim
slogan
slot
slow
slush
small
smart
smile
smoke
smooth
snack
snake
snap
sniff
snow
soap
soccer
social
sock
soda
soft
solar
soldier
solid
solution
solve
someone
song
soon
sorry
sort
soul
sound
soup
source
south
space
spare
spatial
spawn
speak
special
speed
spell
spend
sphere
spice
spider
spike
spin
spirit
split
spoil
sponsor
spoon
sport
spot
spray
spread
spring
spy
square
squeeze
squirrel
stable
stadium
staff
stage
stairs
stamp
stand
start
state
stay
steak
steel
stem
step
stereo
stick
still
sting
stock
stomach
stone
stool
story
stove
strategy
street
strike
strong
struggle
student
stuff
stumble
style
subject
submit
subway
success
such
sudden
suffer
sugar
suggest
suit
summer
sun
sunny
sunset
super
supply
supreme
sure
surface
surge
surprise
surround
survey
suspect
sustain
swallow
swamp
swap
swarm
swear
sweet
swift
swim
swing
switch
sword
symbol
symptom
syrup
system
table
tackle
tag
tail
talent
talk
tank
tape
target
task
taste
tattoo
taxi
teach
team
tell
ten
tenant
tennis
tent
term
test
text
thank
that
theme
then
theory
there
they
thing
this
thought
three
thrive
throw
thumb
thunder
ticket
tide
tiger
tilt
timber
time
tiny
tip
tired
tissue
title
toast
tobacco
today
toddler
toe
together
toilet
token
tomato
tomorrow
tone
tongue
tonight
tool
tooth
top
topic
topple
torch
tornado
tortoise
toss
total
tourist
toward
tower
town
toy
track
trade
traffic
tragic
train
transfer
trap
trash
travel
tray
treat
tree
trend
trial
tribe
trick
trigger
trim
trip
trophy
trouble
truck
true
truly
trumpet
trust
truth
try
tube
tuition
tumble
tuna
tunnel
turkey
turn
turtle
twelve
twenty
twice
twin
twist
two
type
typical
ugly
umbrella
unable
unaware
uncle
uncover
under
undo
unfair
unfold
unhappy
uniform
unique
unit
universe
unknown
unlock
until
unusual
unveil
update
upgrade
uphold
upon
upper
upset
urban
urge
usage
use
used
useful
useless
usual
utility
vacant
vacuum
vague
valid
valley
valve
van
vanish
vapor
various
vast
vault
vehicle
velvet
vendor
venture
venue
verb
verify
version
very
vessel
veteran
viable
vibrant
vicious
victory
video
view
village
vintage
violin
virtual
virus
visa
visit
visual
vital
vivid
vocal
voice
void
volcano
volume
vote
voyage
wage
wagon
wait
walk
wall
walnut
want
warfare
warm
warrior
wash
wasp
waste
water
wave
way
wealth
weapon
wear
weasel
weather
web
wedding
weekend
weird
welcome
west
wet
whale
what
wheat
wheel
when
where
whip
whisper
wide
width
wife
wild
will
win
window
wine
wing
wink
winner
winter
wire
wisdom
wise
wish
witness
wolf
woman
wonder
wood
wool
word
work
world
worry
worth
wrap
wreck
wrestle
wrist
write
wrong
yard
year
yellow
you
young
youth
zebra
zero
zone
zoo`.split(`
`);function isBytes$2(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber$1(e,t=""){if(!Number.isSafeInteger(e)||e<0){const r=t&&`"${t}" `;throw new Error(`${r}expected integer >= 0, got ${e}`)}}function abytes(e,t,r=""){const n=isBytes$2(e),s=e?.length,a=t!==void 0;if(!n||a&&s!==t){const l=r&&`"${r}" `,u=a?` of length ${t}`:"",x=n?`length=${s}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+u+", got "+x)}return e}function ahash(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");anumber$1(e.outputLen),anumber$1(e.blockLen)}function aexists(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput(e,t){abytes(e,void 0,"digestInto() output");const r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function clean(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView$3(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr$2(e,t){return e<<32-t|e>>>t}function rotl$2(e,t){return e<<t|e>>>32-t>>>0}const hasHexBuiltin=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes$3=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$3(e){if(abytes(e),hasHexBuiltin)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=hexes$3[e[r]];return t}const asciis$1={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16$1(e){if(e>=asciis$1._0&&e<=asciis$1._9)return e-asciis$1._0;if(e>=asciis$1.A&&e<=asciis$1.F)return e-(asciis$1.A-10);if(e>=asciis$1.a&&e<=asciis$1.f)return e-(asciis$1.a-10)}function hexToBytes$5(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(hasHexBuiltin)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let s=0,a=0;s<r;s++,a+=2){const l=asciiToBase16$1(e.charCodeAt(a)),u=asciiToBase16$1(e.charCodeAt(a+1));if(l===void 0||u===void 0){const x=e[a]+e[a+1];throw new Error('hex string expected, got non-hex character "'+x+'" at index '+a)}n[s]=l*16+u}return n}function concatBytes$3(...e){let t=0;for(let n=0;n<e.length;n++){const s=e[n];abytes(s),t+=s.length}const r=new Uint8Array(t);for(let n=0,s=0;n<e.length;n++){const a=e[n];r.set(a,s),s+=a.length}return r}function createHasher(e,t={}){const r=(s,a)=>e(a).update(s).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=s=>e(s),Object.assign(r,t),Object.freeze(r)}function randomBytes$2(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const oidNist=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function Chi$2(e,t,r){return e&t^~e&r}function Maj$2(e,t,r){return e&t^e&r^t&r}class HashMD{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,s){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(t),this.view=createView$3(this.buffer)}update(t){aexists(this),abytes(t);const{view:r,buffer:n,blockLen:s}=this,a=t.length;for(let l=0;l<a;){const u=Math.min(s-this.pos,a-l);if(u===s){const x=createView$3(t);for(;s<=a-l;l+=s)this.process(x,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists(this),aoutput(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:a}=this;let{pos:l}=this;r[l++]=128,clean(this.buffer.subarray(l)),this.padOffset>s-l&&(this.process(n,0),l=0);for(let g=l;g<s;g++)r[g]=0;n.setBigUint64(s-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$3(t),x=this.outputLen;if(x%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const f=x/4,p=this.get();if(f>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<f;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:a,destroyed:l,pos:u}=this;return t.destroyed=l,t.finished=a,t.length=s,t.pos=u,s%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(e,t=!1){return t?{h:Number(e&U32_MASK64),l:Number(e>>_32n&U32_MASK64)}:{h:Number(e>>_32n&U32_MASK64)|0,l:Number(e&U32_MASK64)|0}}function split(e,t=!1){const r=e.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let a=0;a<r;a++){const{h:l,l:u}=fromBig(e[a],t);[n[a],s[a]]=[l,u]}return[n,s]}const shrSH=(e,t,r)=>e>>>r,shrSL=(e,t,r)=>e<<32-r|t>>>r,rotrSH=(e,t,r)=>e>>>r|t<<32-r,rotrSL=(e,t,r)=>e<<32-r|t>>>r,rotrBH=(e,t,r)=>e<<64-r|t>>>r-32,rotrBL=(e,t,r)=>e>>>r-32|t<<64-r;function add(e,t,r,n){const s=(t>>>0)+(n>>>0);return{h:e+r+(s/2**32|0)|0,l:s|0}}const add3L=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H=(e,t,r,n,s)=>t+r+n+s+(e/2**32|0)|0,add5L=(e,t,r,n,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(s>>>0),add5H=(e,t,r,n,s,a)=>t+r+n+s+a+(e/2**32|0)|0,SHA256_K$2=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W$2=new Uint32Array(64);class SHA2_32B extends HashMD{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:r,C:n,D:s,E:a,F:l,G:u,H:x}=this;return[t,r,n,s,a,l,u,x]}set(t,r,n,s,a,l,u,x){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=x|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W$2[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W$2[g-15],w=SHA256_W$2[g-2],R=rotr$2(y,7)^rotr$2(y,18)^y>>>3,I=rotr$2(w,17)^rotr$2(w,19)^w>>>10;SHA256_W$2[g]=I+SHA256_W$2[g-7]+R+SHA256_W$2[g-16]|0}let{A:n,B:s,C:a,D:l,E:u,F:x,G:f,H:p}=this;for(let g=0;g<64;g++){const y=rotr$2(u,6)^rotr$2(u,11)^rotr$2(u,25),w=p+y+Chi$2(u,x,f)+SHA256_K$2[g]+SHA256_W$2[g]|0,I=(rotr$2(n,2)^rotr$2(n,13)^rotr$2(n,22))+Maj$2(n,s,a)|0;p=f,f=x,x=u,u=l+w|0,l=a,a=s,s=n,n=w+I|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,x=x+this.F|0,f=f+this.G|0,p=p+this.H|0,this.set(n,s,a,l,u,x,f,p)}roundClean(){clean(SHA256_W$2)}destroy(){this.set(0,0,0,0,0,0,0,0),clean(this.buffer)}}class _SHA256 extends SHA2_32B{A=SHA256_IV[0]|0;B=SHA256_IV[1]|0;C=SHA256_IV[2]|0;D=SHA256_IV[3]|0;E=SHA256_IV[4]|0;F=SHA256_IV[5]|0;G=SHA256_IV[6]|0;H=SHA256_IV[7]|0;constructor(){super(32)}}const K512=split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),SHA512_Kh=K512[0],SHA512_Kl=K512[1],SHA512_W_H=new Uint32Array(80),SHA512_W_L=new Uint32Array(80);class SHA2_64B extends HashMD{constructor(t){super(128,t,16,!1)}get(){const{Ah:t,Al:r,Bh:n,Bl:s,Ch:a,Cl:l,Dh:u,Dl:x,Eh:f,El:p,Fh:g,Fl:y,Gh:w,Gl:R,Hh:I,Hl:k}=this;return[t,r,n,s,a,l,u,x,f,p,g,y,w,R,I,k]}set(t,r,n,s,a,l,u,x,f,p,g,y,w,R,I,k){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=a|0,this.Cl=l|0,this.Dh=u|0,this.Dl=x|0,this.Eh=f|0,this.El=p|0,this.Fh=g|0,this.Fl=y|0,this.Gh=w|0,this.Gl=R|0,this.Hh=I|0,this.Hl=k|0}process(t,r){for(let q=0;q<16;q++,r+=4)SHA512_W_H[q]=t.getUint32(r),SHA512_W_L[q]=t.getUint32(r+=4);for(let q=16;q<80;q++){const $e=SHA512_W_H[q-15]|0,We=SHA512_W_L[q-15]|0,K=rotrSH($e,We,1)^rotrSH($e,We,8)^shrSH($e,We,7),W=rotrSL($e,We,1)^rotrSL($e,We,8)^shrSL($e,We,7),Ye=SHA512_W_H[q-2]|0,Qe=SHA512_W_L[q-2]|0,it=rotrSH(Ye,Qe,19)^rotrBH(Ye,Qe,61)^shrSH(Ye,Qe,6),ze=rotrSL(Ye,Qe,19)^rotrBL(Ye,Qe,61)^shrSL(Ye,Qe,6),v=add4L(W,ze,SHA512_W_L[q-7],SHA512_W_L[q-16]),D=add4H(v,K,it,SHA512_W_H[q-7],SHA512_W_H[q-16]);SHA512_W_H[q]=D|0,SHA512_W_L[q]=v|0}let{Ah:n,Al:s,Bh:a,Bl:l,Ch:u,Cl:x,Dh:f,Dl:p,Eh:g,El:y,Fh:w,Fl:R,Gh:I,Gl:k,Hh:je,Hl:Ve}=this;for(let q=0;q<80;q++){const $e=rotrSH(g,y,14)^rotrSH(g,y,18)^rotrBH(g,y,41),We=rotrSL(g,y,14)^rotrSL(g,y,18)^rotrBL(g,y,41),K=g&w^~g&I,W=y&R^~y&k,Ye=add5L(Ve,We,W,SHA512_Kl[q],SHA512_W_L[q]),Qe=add5H(Ye,je,$e,K,SHA512_Kh[q],SHA512_W_H[q]),it=Ye|0,ze=rotrSH(n,s,28)^rotrBH(n,s,34)^rotrBH(n,s,39),v=rotrSL(n,s,28)^rotrBL(n,s,34)^rotrBL(n,s,39),D=n&a^n&u^a&u,_e=s&l^s&x^l&x;je=I|0,Ve=k|0,I=w|0,k=R|0,w=g|0,R=y|0,{h:g,l:y}=add(f|0,p|0,Qe|0,it|0),f=u|0,p=x|0,u=a|0,x=l|0,a=n|0,l=s|0;const P=add3L(it,v,_e);n=add3H(P,Qe,ze,D),s=P|0}({h:n,l:s}=add(this.Ah|0,this.Al|0,n|0,s|0)),{h:a,l}=add(this.Bh|0,this.Bl|0,a|0,l|0),{h:u,l:x}=add(this.Ch|0,this.Cl|0,u|0,x|0),{h:f,l:p}=add(this.Dh|0,this.Dl|0,f|0,p|0),{h:g,l:y}=add(this.Eh|0,this.El|0,g|0,y|0),{h:w,l:R}=add(this.Fh|0,this.Fl|0,w|0,R|0),{h:I,l:k}=add(this.Gh|0,this.Gl|0,I|0,k|0),{h:je,l:Ve}=add(this.Hh|0,this.Hl|0,je|0,Ve|0),this.set(n,s,a,l,u,x,f,p,g,y,w,R,I,k,je,Ve)}roundClean(){clean(SHA512_W_H,SHA512_W_L)}destroy(){clean(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class _SHA512 extends SHA2_64B{Ah=SHA512_IV[0]|0;Al=SHA512_IV[1]|0;Bh=SHA512_IV[2]|0;Bl=SHA512_IV[3]|0;Ch=SHA512_IV[4]|0;Cl=SHA512_IV[5]|0;Dh=SHA512_IV[6]|0;Dl=SHA512_IV[7]|0;Eh=SHA512_IV[8]|0;El=SHA512_IV[9]|0;Fh=SHA512_IV[10]|0;Fl=SHA512_IV[11]|0;Gh=SHA512_IV[12]|0;Gl=SHA512_IV[13]|0;Hh=SHA512_IV[14]|0;Hl=SHA512_IV[15]|0;constructor(){super(64)}}const sha256$3=createHasher(()=>new _SHA256,oidNist(1)),sha512$1=createHasher(()=>new _SHA512,oidNist(3));const _0n$8=BigInt(0),_1n$8=BigInt(1);function abool(e,t=""){if(typeof e!="boolean"){const r=t&&`"${t}" `;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function abignumber(e){if(typeof e=="bigint"){if(!isPosBig(e))throw new Error("positive bigint expected, got "+e)}else anumber$1(e);return e}function numberToHexUnpadded$1(e){const t=abignumber(e).toString(16);return t.length&1?"0"+t:t}function hexToNumber$1(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?_0n$8:BigInt("0x"+e)}function bytesToNumberBE$1(e){return hexToNumber$1(bytesToHex$3(e))}function bytesToNumberLE$1(e){return hexToNumber$1(bytesToHex$3(copyBytes(abytes(e)).reverse()))}function numberToBytesBE$1(e,t){anumber$1(t),e=abignumber(e);const r=hexToBytes$5(e.toString(16).padStart(t*2,"0"));if(r.length!==t)throw new Error("number too large");return r}function numberToBytesLE$1(e,t){return numberToBytesBE$1(e,t).reverse()}function copyBytes(e){return Uint8Array.from(e)}const isPosBig=e=>typeof e=="bigint"&&_0n$8<=e;function inRange(e,t,r){return isPosBig(e)&&isPosBig(t)&&isPosBig(r)&&t<=e&&e<r}function aInRange(e,t,r,n){if(!inRange(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function bitLen$1(e){let t;for(t=0;e>_0n$8;e>>=_1n$8,t+=1);return t}const bitMask$1=e=>(_1n$8<<BigInt(e))-_1n$8;function createHmacDrbg$1(e,t,r){if(anumber$1(e,"hashLen"),anumber$1(t,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");const n=k=>new Uint8Array(k),s=Uint8Array.of(),a=Uint8Array.of(0),l=Uint8Array.of(1),u=1e3;let x=n(e),f=n(e),p=0;const g=()=>{x.fill(1),f.fill(0),p=0},y=(...k)=>r(f,concatBytes$3(x,...k)),w=(k=s)=>{f=y(a,k),x=y(),k.length!==0&&(f=y(l,k),x=y())},R=()=>{if(p++>=u)throw new Error("drbg: tried max amount of iterations");let k=0;const je=[];for(;k<t;){x=y();const Ve=x.slice();je.push(Ve),k+=x.length}return concatBytes$3(...je)};return(k,je)=>{g(),w(k);let Ve;for(;!(Ve=je(R()));)w();return g(),Ve}}function validateObject$1(e,t={},r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(a,l,u){const x=e[a];if(u&&x===void 0)return;const f=typeof x;if(f!==l||x===null)throw new Error(`param "${a}" is invalid: expected ${l}, got ${f}`)}const s=(a,l)=>Object.entries(a).forEach(([u,x])=>n(u,x,l));s(t,!1),s(r,!0)}function memoized(e){const t=new WeakMap;return(r,...n)=>{const s=t.get(r);if(s!==void 0)return s;const a=e(r,...n);return t.set(r,a),a}}const _0n$7=BigInt(0),_1n$7=BigInt(1),_2n$5=BigInt(2),_3n$3=BigInt(3),_4n$2=BigInt(4),_5n$1=BigInt(5),_7n=BigInt(7),_8n$1=BigInt(8),_9n=BigInt(9),_16n=BigInt(16);function mod$1(e,t){const r=e%t;return r>=_0n$7?r:t+r}function pow2$1(e,t,r){let n=e;for(;t-- >_0n$7;)n*=n,n%=r;return n}function invert$1(e,t){if(e===_0n$7)throw new Error("invert: expected non-zero number");if(t<=_0n$7)throw new Error("invert: expected positive modulus, got "+t);let r=mod$1(e,t),n=t,s=_0n$7,a=_1n$7;for(;r!==_0n$7;){const u=n/r,x=n%r,f=s-a*u;n=r,r=x,s=a,a=f}if(n!==_1n$7)throw new Error("invert: does not exist");return mod$1(s,t)}function assertIsSquare(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function sqrt3mod4(e,t){const r=(e.ORDER+_1n$7)/_4n$2,n=e.pow(t,r);return assertIsSquare(e,n,t),n}function sqrt5mod8(e,t){const r=(e.ORDER-_5n$1)/_8n$1,n=e.mul(t,_2n$5),s=e.pow(n,r),a=e.mul(t,s),l=e.mul(e.mul(a,_2n$5),s),u=e.mul(a,e.sub(l,e.ONE));return assertIsSquare(e,u,t),u}function sqrt9mod16(e){const t=Field$1(e),r=tonelliShanks$1(e),n=r(t,t.neg(t.ONE)),s=r(t,n),a=r(t,t.neg(n)),l=(e+_7n)/_16n;return(u,x)=>{let f=u.pow(x,l),p=u.mul(f,n);const g=u.mul(f,s),y=u.mul(f,a),w=u.eql(u.sqr(p),x),R=u.eql(u.sqr(g),x);f=u.cmov(f,p,w),p=u.cmov(y,g,R);const I=u.eql(u.sqr(p),x),k=u.cmov(f,p,I);return assertIsSquare(u,k,x),k}}function tonelliShanks$1(e){if(e<_3n$3)throw new Error("sqrt is not defined for small field");let t=e-_1n$7,r=0;for(;t%_2n$5===_0n$7;)t/=_2n$5,r++;let n=_2n$5;const s=Field$1(e);for(;FpLegendre(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return sqrt3mod4;let a=s.pow(n,t);const l=(t+_1n$7)/_2n$5;return function(x,f){if(x.is0(f))return f;if(FpLegendre(x,f)!==1)throw new Error("Cannot find square root");let p=r,g=x.mul(x.ONE,a),y=x.pow(f,t),w=x.pow(f,l);for(;!x.eql(y,x.ONE);){if(x.is0(y))return x.ZERO;let R=1,I=x.sqr(y);for(;!x.eql(I,x.ONE);)if(R++,I=x.sqr(I),R===p)throw new Error("Cannot find square root");const k=_1n$7<<BigInt(p-R-1),je=x.pow(g,k);p=R,g=x.sqr(je),y=x.mul(y,g),w=x.mul(w,je)}return w}}function FpSqrt$1(e){return e%_4n$2===_3n$3?sqrt3mod4:e%_8n$1===_5n$1?sqrt5mod8:e%_16n===_9n?sqrt9mod16(e):tonelliShanks$1(e)}const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(e){const t={ORDER:"bigint",BYTES:"number",BITS:"number"},r=FIELD_FIELDS$1.reduce((n,s)=>(n[s]="function",n),t);return validateObject$1(e,r),e}function FpPow$1(e,t,r){if(r<_0n$7)throw new Error("invalid exponent, negatives unsupported");if(r===_0n$7)return e.ONE;if(r===_1n$7)return t;let n=e.ONE,s=t;for(;r>_0n$7;)r&_1n$7&&(n=e.mul(n,s)),s=e.sqr(s),r>>=_1n$7;return n}function FpInvertBatch$1(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),s=t.reduce((l,u,x)=>e.is0(u)?l:(n[x]=l,e.mul(l,u)),e.ONE),a=e.inv(s);return t.reduceRight((l,u,x)=>e.is0(u)?l:(n[x]=e.mul(l,n[x]),e.mul(l,u)),a),n}function FpLegendre(e,t){const r=(e.ORDER-_1n$7)/_2n$5,n=e.pow(t,r),s=e.eql(n,e.ONE),a=e.eql(n,e.ZERO),l=e.eql(n,e.neg(e.ONE));if(!s&&!a&&!l)throw new Error("invalid Legendre symbol result");return s?1:a?0:-1}function nLength$1(e,t){t!==void 0&&anumber$1(t);const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}class _Field{ORDER;BITS;BYTES;isLE;ZERO=_0n$7;ONE=_1n$7;_lengths;_sqrt;_mod;constructor(t,r={}){if(t<=_0n$7)throw new Error("invalid field: expected ORDER > 0, got "+t);let n;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(n=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));const{nBitLength:s,nByteLength:a}=nLength$1(t,n);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=s,this.BYTES=a,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return mod$1(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return _0n$7<=t&&t<this.ORDER}is0(t){return t===_0n$7}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&_1n$7)===_1n$7}neg(t){return mod$1(-t,this.ORDER)}eql(t,r){return t===r}sqr(t){return mod$1(t*t,this.ORDER)}add(t,r){return mod$1(t+r,this.ORDER)}sub(t,r){return mod$1(t-r,this.ORDER)}mul(t,r){return mod$1(t*r,this.ORDER)}pow(t,r){return FpPow$1(this,t,r)}div(t,r){return mod$1(t*invert$1(r,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,r){return t+r}subN(t,r){return t-r}mulN(t,r){return t*r}inv(t){return invert$1(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=FpSqrt$1(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?numberToBytesLE$1(t,this.BYTES):numberToBytesBE$1(t,this.BYTES)}fromBytes(t,r=!1){abytes(t);const{_lengths:n,BYTES:s,isLE:a,ORDER:l,_mod:u}=this;if(n){if(!n.includes(t.length)||t.length>s)throw new Error("Field.fromBytes: expected "+n+" bytes, got "+t.length);const f=new Uint8Array(s);f.set(t,a?0:f.length-t.length),t=f}if(t.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+t.length);let x=a?bytesToNumberLE$1(t):bytesToNumberBE$1(t);if(u&&(x=mod$1(x,l)),!r&&!this.isValid(x))throw new Error("invalid field element: outside of range 0..ORDER");return x}invertBatch(t){return FpInvertBatch$1(this,t)}cmov(t,r,n){return n?r:t}}function Field$1(e,t={}){return new _Field(e,t)}function getFieldBytesLength$1(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength$1(e){const t=getFieldBytesLength$1(e);return t+Math.ceil(t/2)}function mapHashToField$1(e,t,r=!1){abytes(e);const n=e.length,s=getFieldBytesLength$1(t),a=getMinHashLength$1(t);if(n<16||n<a||n>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+n);const l=r?bytesToNumberLE$1(e):bytesToNumberBE$1(e),u=mod$1(l,t-_1n$7)+_1n$7;return r?numberToBytesLE$1(u,s):numberToBytesBE$1(u,s)}const _0n$6=BigInt(0),_1n$6=BigInt(1);function negateCt(e,t){const r=t.negate();return e?r:t}function normalizeZ(e,t){const r=FpInvertBatch$1(e.Fp,t.map(n=>n.Z));return t.map((n,s)=>e.fromAffine(n.toAffine(r[s])))}function validateW(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function calcWOpts(e,t){validateW(e,t);const r=Math.ceil(t/e)+1,n=2**(e-1),s=2**e,a=bitMask$1(e),l=BigInt(e);return{windows:r,windowSize:n,mask:a,maxNumber:s,shiftBy:l}}function calcOffsets(e,t,r){const{windowSize:n,mask:s,maxNumber:a,shiftBy:l}=r;let u=Number(e&s),x=e>>l;u>n&&(u-=a,x+=_1n$6);const f=t*n,p=f+Math.abs(u)-1,g=u===0,y=u<0,w=t%2!==0;return{nextN:x,offset:p,isZero:g,isNeg:y,isNegF:w,offsetF:f}}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(e){return pointWindowSizes.get(e)||1}function assert0(e){if(e!==_0n$6)throw new Error("invalid wNAF")}let wNAF$1=class{BASE;ZERO;Fn;bits;constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let s=t;for(;r>_0n$6;)r&_1n$6&&(n=n.add(s)),s=s.double(),r>>=_1n$6;return n}precomputeWindow(t,r){const{windows:n,windowSize:s}=calcWOpts(r,this.bits),a=[];let l=t,u=l;for(let x=0;x<n;x++){u=l,a.push(u);for(let f=1;f<s;f++)u=u.add(l),a.push(u);l=u.double()}return a}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,a=this.BASE;const l=calcWOpts(t,this.bits);for(let u=0;u<l.windows;u++){const{nextN:x,offset:f,isZero:p,isNeg:g,isNegF:y,offsetF:w}=calcOffsets(n,u,l);n=x,p?a=a.add(negateCt(y,r[w])):s=s.add(negateCt(g,r[f]))}return assert0(n),{p:s,f:a}}wNAFUnsafe(t,r,n,s=this.ZERO){const a=calcWOpts(t,this.bits);for(let l=0;l<a.windows&&n!==_0n$6;l++){const{nextN:u,offset:x,isZero:f,isNeg:p}=calcOffsets(n,l,a);if(n=u,!f){const g=r[x];s=s.add(p?g.negate():g)}}return assert0(n),s}getPrecomputes(t,r,n){let s=pointPrecomputes.get(r);return s||(s=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(s=n(s)),pointPrecomputes.set(r,s))),s}cached(t,r,n){const s=getW(t);return this.wNAF(s,this.getPrecomputes(s,t,n),r)}unsafe(t,r,n,s){const a=getW(t);return a===1?this._unsafeLadder(t,r,s):this.wNAFUnsafe(a,this.getPrecomputes(a,t,n),r,s)}createCache(t,r){validateW(r,this.bits),pointWindowSizes.set(t,r),pointPrecomputes.delete(t)}hasCache(t){return getW(t)!==1}};function mulEndoUnsafe(e,t,r,n){let s=t,a=e.ZERO,l=e.ZERO;for(;r>_0n$6||n>_0n$6;)r&_1n$6&&(a=a.add(s)),n&_1n$6&&(l=l.add(s)),s=s.double(),r>>=_1n$6,n>>=_1n$6;return{p1:a,p2:l}}function createField(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField$1(t),t}else return Field$1(e,{isLE:r})}function createCurveFields(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const x of["p","n","h"]){const f=t[x];if(!(typeof f=="bigint"&&f>_0n$6))throw new Error(`CURVE.${x} must be positive bigint`)}const s=createField(t.p,r.Fp,n),a=createField(t.n,r.Fn,n),u=["Gx","Gy","a","b"];for(const x of u)if(!s.isValid(t[x]))throw new Error(`CURVE.${x} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:s,Fn:a}}function createKeygen(e,t){return function(n){const s=e(n);return{secretKey:s,publicKey:t(s)}}}class _HMAC{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(ahash(t),abytes(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(r.length>n?t.create().update(r).digest():r);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),clean(s)}update(t){return aexists(this),this.iHash.update(t),this}digestInto(t){aexists(this),abytes(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:n,finished:s,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=s,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac$3=(e,t,r)=>new _HMAC(e,t).update(r).digest();hmac$3.create=(e,t)=>new _HMAC(e,t);const divNearest$1=(e,t)=>(e+(e>=0?t:-t)/_2n$4)/t;function _splitEndoScalar(e,t,r){const[[n,s],[a,l]]=t,u=divNearest$1(l*e,r),x=divNearest$1(-s*e,r);let f=e-u*n-x*a,p=-u*s-x*l;const g=f<_0n$5,y=p<_0n$5;g&&(f=-f),y&&(p=-p);const w=bitMask$1(Math.ceil(bitLen$1(r)/2))+_1n$5;if(f<_0n$5||f>=w||p<_0n$5||p>=w)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:g,k1:f,k2neg:y,k2:p}}function validateSigFormat(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function validateSigOpts(e,t){const r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return abool(r.lowS,"lowS"),abool(r.prehash,"prehash"),r.format!==void 0&&validateSigFormat(r.format),r}class DERErr extends Error{constructor(t=""){super(t)}}const DER$1={Err:DERErr,_tlv:{encode:(e,t)=>{const{Err:r}=DER$1;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");const n=t.length/2,s=numberToHexUnpadded$1(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const a=n>127?numberToHexUnpadded$1(s.length/2|128):"";return numberToHexUnpadded$1(e)+a+s+t},decode(e,t){const{Err:r}=DER$1;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const s=t[n++],a=!!(s&128);let l=0;if(!a)l=s;else{const x=s&127;if(!x)throw new r("tlv.decode(long): indefinite length not supported");if(x>4)throw new r("tlv.decode(long): byte length is too big");const f=t.subarray(n,n+x);if(f.length!==x)throw new r("tlv.decode: length bytes not complete");if(f[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const p of f)l=l<<8|p;if(n+=x,l<128)throw new r("tlv.decode(long): not minimal encoding")}const u=t.subarray(n,n+l);if(u.length!==l)throw new r("tlv.decode: wrong value length");return{v:u,l:t.subarray(n+l)}}},_int:{encode(e){const{Err:t}=DER$1;if(e<_0n$5)throw new t("integer: negative integers are not allowed");let r=numberToHexUnpadded$1(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=DER$1;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return bytesToNumberBE$1(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=DER$1,s=abytes(e,void 0,"signature"),{v:a,l}=n.decode(48,s);if(l.length)throw new t("invalid signature: left bytes after parsing");const{v:u,l:x}=n.decode(2,a),{v:f,l:p}=n.decode(2,x);if(p.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(u),s:r.decode(f)}},hexFromSig(e){const{_tlv:t,_int:r}=DER$1,n=t.encode(2,r.encode(e.r)),s=t.encode(2,r.encode(e.s)),a=n+s;return t.encode(48,a)}},_0n$5=BigInt(0),_1n$5=BigInt(1),_2n$4=BigInt(2),_3n$2=BigInt(3),_4n$1=BigInt(4);function weierstrass$2(e,t={}){const r=createCurveFields("weierstrass",e,t),{Fp:n,Fn:s}=r;let a=r.CURVE;const{h:l,n:u}=a;validateObject$1(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});const{endo:x}=t;if(x&&(!n.is0(a.a)||typeof x.beta!="bigint"||!Array.isArray(x.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const f=getWLengths(n,s);function p(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function g(v,D,_e){const{x:P,y:Re}=D.toAffine(),Fe=n.toBytes(P);if(abool(_e,"isCompressed"),_e){p();const Le=!n.isOdd(Re);return concatBytes$3(pprefix(Le),Fe)}else return concatBytes$3(Uint8Array.of(4),Fe,n.toBytes(Re))}function y(v){abytes(v,void 0,"Point");const{publicKey:D,publicKeyUncompressed:_e}=f,P=v.length,Re=v[0],Fe=v.subarray(1);if(P===D&&(Re===2||Re===3)){const Le=n.fromBytes(Fe);if(!n.isValid(Le))throw new Error("bad point: is not on curve, wrong x");const Ce=I(Le);let L;try{L=n.sqrt(Ce)}catch(lt){const Xe=lt instanceof Error?": "+lt.message:"";throw new Error("bad point: is not on curve, sqrt error"+Xe)}p();const O=n.isOdd(L);return(Re&1)===1!==O&&(L=n.neg(L)),{x:Le,y:L}}else if(P===_e&&Re===4){const Le=n.BYTES,Ce=n.fromBytes(Fe.subarray(0,Le)),L=n.fromBytes(Fe.subarray(Le,Le*2));if(!k(Ce,L))throw new Error("bad point: is not on curve");return{x:Ce,y:L}}else throw new Error(`bad point: got length ${P}, expected compressed=${D} or uncompressed=${_e}`)}const w=t.toBytes||g,R=t.fromBytes||y;function I(v){const D=n.sqr(v),_e=n.mul(D,v);return n.add(n.add(_e,n.mul(v,a.a)),a.b)}function k(v,D){const _e=n.sqr(D),P=I(v);return n.eql(_e,P)}if(!k(a.Gx,a.Gy))throw new Error("bad curve params: generator point");const je=n.mul(n.pow(a.a,_3n$2),_4n$1),Ve=n.mul(n.sqr(a.b),BigInt(27));if(n.is0(n.add(je,Ve)))throw new Error("bad curve params: a or b");function q(v,D,_e=!1){if(!n.isValid(D)||_e&&n.is0(D))throw new Error(`bad point coordinate ${v}`);return D}function $e(v){if(!(v instanceof Qe))throw new Error("Weierstrass Point expected")}function We(v){if(!x||!x.basises)throw new Error("no endo");return _splitEndoScalar(v,x.basises,s.ORDER)}const K=memoized((v,D)=>{const{X:_e,Y:P,Z:Re}=v;if(n.eql(Re,n.ONE))return{x:_e,y:P};const Fe=v.is0();D==null&&(D=Fe?n.ONE:n.inv(Re));const Le=n.mul(_e,D),Ce=n.mul(P,D),L=n.mul(Re,D);if(Fe)return{x:n.ZERO,y:n.ZERO};if(!n.eql(L,n.ONE))throw new Error("invZ was invalid");return{x:Le,y:Ce}}),W=memoized(v=>{if(v.is0()){if(t.allowInfinityPoint&&!n.is0(v.Y))return;throw new Error("bad point: ZERO")}const{x:D,y:_e}=v.toAffine();if(!n.isValid(D)||!n.isValid(_e))throw new Error("bad point: x or y not field elements");if(!k(D,_e))throw new Error("bad point: equation left != right");if(!v.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function Ye(v,D,_e,P,Re){return _e=new Qe(n.mul(_e.X,v),_e.Y,_e.Z),D=negateCt(P,D),_e=negateCt(Re,_e),D.add(_e)}class Qe{static BASE=new Qe(a.Gx,a.Gy,n.ONE);static ZERO=new Qe(n.ZERO,n.ONE,n.ZERO);static Fp=n;static Fn=s;X;Y;Z;constructor(D,_e,P){this.X=q("x",D),this.Y=q("y",_e,!0),this.Z=q("z",P),Object.freeze(this)}static CURVE(){return a}static fromAffine(D){const{x:_e,y:P}=D||{};if(!D||!n.isValid(_e)||!n.isValid(P))throw new Error("invalid affine point");if(D instanceof Qe)throw new Error("projective point not allowed");return n.is0(_e)&&n.is0(P)?Qe.ZERO:new Qe(_e,P,n.ONE)}static fromBytes(D){const _e=Qe.fromAffine(R(abytes(D,void 0,"point")));return _e.assertValidity(),_e}static fromHex(D){return Qe.fromBytes(hexToBytes$5(D))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(D=8,_e=!0){return ze.createCache(this,D),_e||this.multiply(_3n$2),this}assertValidity(){W(this)}hasEvenY(){const{y:D}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(D)}equals(D){$e(D);const{X:_e,Y:P,Z:Re}=this,{X:Fe,Y:Le,Z:Ce}=D,L=n.eql(n.mul(_e,Ce),n.mul(Fe,Re)),O=n.eql(n.mul(P,Ce),n.mul(Le,Re));return L&&O}negate(){return new Qe(this.X,n.neg(this.Y),this.Z)}double(){const{a:D,b:_e}=a,P=n.mul(_e,_3n$2),{X:Re,Y:Fe,Z:Le}=this;let Ce=n.ZERO,L=n.ZERO,O=n.ZERO,st=n.mul(Re,Re),lt=n.mul(Fe,Fe),Xe=n.mul(Le,Le),dt=n.mul(Re,Fe);return dt=n.add(dt,dt),O=n.mul(Re,Le),O=n.add(O,O),Ce=n.mul(D,O),L=n.mul(P,Xe),L=n.add(Ce,L),Ce=n.sub(lt,L),L=n.add(lt,L),L=n.mul(Ce,L),Ce=n.mul(dt,Ce),O=n.mul(P,O),Xe=n.mul(D,Xe),dt=n.sub(st,Xe),dt=n.mul(D,dt),dt=n.add(dt,O),O=n.add(st,st),st=n.add(O,st),st=n.add(st,Xe),st=n.mul(st,dt),L=n.add(L,st),Xe=n.mul(Fe,Le),Xe=n.add(Xe,Xe),st=n.mul(Xe,dt),Ce=n.sub(Ce,st),O=n.mul(Xe,lt),O=n.add(O,O),O=n.add(O,O),new Qe(Ce,L,O)}add(D){$e(D);const{X:_e,Y:P,Z:Re}=this,{X:Fe,Y:Le,Z:Ce}=D;let L=n.ZERO,O=n.ZERO,st=n.ZERO;const lt=a.a,Xe=n.mul(a.b,_3n$2);let dt=n.mul(_e,Fe),er=n.mul(P,Le),ar=n.mul(Re,Ce),dr=n.add(_e,P),ir=n.add(Fe,Le);dr=n.mul(dr,ir),ir=n.add(dt,er),dr=n.sub(dr,ir),ir=n.add(_e,Re);let pt=n.add(Fe,Ce);return ir=n.mul(ir,pt),pt=n.add(dt,ar),ir=n.sub(ir,pt),pt=n.add(P,Re),L=n.add(Le,Ce),pt=n.mul(pt,L),L=n.add(er,ar),pt=n.sub(pt,L),st=n.mul(lt,ir),L=n.mul(Xe,ar),st=n.add(L,st),L=n.sub(er,st),st=n.add(er,st),O=n.mul(L,st),er=n.add(dt,dt),er=n.add(er,dt),ar=n.mul(lt,ar),ir=n.mul(Xe,ir),er=n.add(er,ar),ar=n.sub(dt,ar),ar=n.mul(lt,ar),ir=n.add(ir,ar),dt=n.mul(er,ir),O=n.add(O,dt),dt=n.mul(pt,ir),L=n.mul(dr,L),L=n.sub(L,dt),dt=n.mul(dr,er),st=n.mul(pt,st),st=n.add(st,dt),new Qe(L,O,st)}subtract(D){return this.add(D.negate())}is0(){return this.equals(Qe.ZERO)}multiply(D){const{endo:_e}=t;if(!s.isValidNot0(D))throw new Error("invalid scalar: out of range");let P,Re;const Fe=Le=>ze.cached(this,Le,Ce=>normalizeZ(Qe,Ce));if(_e){const{k1neg:Le,k1:Ce,k2neg:L,k2:O}=We(D),{p:st,f:lt}=Fe(Ce),{p:Xe,f:dt}=Fe(O);Re=lt.add(dt),P=Ye(_e.beta,st,Xe,Le,L)}else{const{p:Le,f:Ce}=Fe(D);P=Le,Re=Ce}return normalizeZ(Qe,[P,Re])[0]}multiplyUnsafe(D){const{endo:_e}=t,P=this;if(!s.isValid(D))throw new Error("invalid scalar: out of range");if(D===_0n$5||P.is0())return Qe.ZERO;if(D===_1n$5)return P;if(ze.hasCache(this))return this.multiply(D);if(_e){const{k1neg:Re,k1:Fe,k2neg:Le,k2:Ce}=We(D),{p1:L,p2:O}=mulEndoUnsafe(Qe,P,Fe,Ce);return Ye(_e.beta,L,O,Re,Le)}else return ze.unsafe(P,D)}toAffine(D){return K(this,D)}isTorsionFree(){const{isTorsionFree:D}=t;return l===_1n$5?!0:D?D(Qe,this):ze.unsafe(this,u).is0()}clearCofactor(){const{clearCofactor:D}=t;return l===_1n$5?this:D?D(Qe,this):this.multiplyUnsafe(l)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}toBytes(D=!0){return abool(D,"isCompressed"),this.assertValidity(),w(Qe,this,D)}toHex(D=!0){return bytesToHex$3(this.toBytes(D))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const it=s.BITS,ze=new wNAF$1(Qe,t.endo?Math.ceil(it/2):it);return Qe.BASE.precompute(8),Qe}function pprefix(e){return Uint8Array.of(e?2:3)}function getWLengths(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function ecdh(e,t={}){const{Fn:r}=e,n=t.randomBytes||randomBytes$2,s=Object.assign(getWLengths(e.Fp,r),{seed:getMinHashLength$1(r.ORDER)});function a(w){try{const R=r.fromBytes(w);return r.isValidNot0(R)}catch{return!1}}function l(w,R){const{publicKey:I,publicKeyUncompressed:k}=s;try{const je=w.length;return R===!0&&je!==I||R===!1&&je!==k?!1:!!e.fromBytes(w)}catch{return!1}}function u(w=n(s.seed)){return mapHashToField$1(abytes(w,s.seed,"seed"),r.ORDER)}function x(w,R=!0){return e.BASE.multiply(r.fromBytes(w)).toBytes(R)}function f(w){const{secretKey:R,publicKey:I,publicKeyUncompressed:k}=s;if(!isBytes$2(w)||"_lengths"in r&&r._lengths||R===I)return;const je=abytes(w,void 0,"key").length;return je===I||je===k}function p(w,R,I=!0){if(f(w)===!0)throw new Error("first arg must be private key");if(f(R)===!1)throw new Error("second arg must be public key");const k=r.fromBytes(w);return e.fromBytes(R).multiply(k).toBytes(I)}const g={isValidSecretKey:a,isValidPublicKey:l,randomSecretKey:u},y=createKeygen(u,x);return Object.freeze({getPublicKey:x,getSharedSecret:p,keygen:y,Point:e,utils:g,lengths:s})}function ecdsa(e,t,r={}){ahash(t),validateObject$1(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);const n=r.randomBytes||randomBytes$2,s=r.hmac||((_e,P)=>hmac$3(t,_e,P)),{Fp:a,Fn:l}=e,{ORDER:u,BITS:x}=l,{keygen:f,getPublicKey:p,getSharedSecret:g,utils:y,lengths:w}=ecdh(e,r),R={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},I=u*_2n$4<a.ORDER;function k(_e){const P=u>>_1n$5;return _e>P}function je(_e,P){if(!l.isValidNot0(P))throw new Error(`invalid signature ${_e}: out of range 1..Point.Fn.ORDER`);return P}function Ve(){if(I)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function q(_e,P){validateSigFormat(P);const Re=w.signature,Fe=P==="compact"?Re:P==="recovered"?Re+1:void 0;return abytes(_e,Fe)}class $e{r;s;recovery;constructor(P,Re,Fe){if(this.r=je("r",P),this.s=je("s",Re),Fe!=null){if(Ve(),![0,1,2,3].includes(Fe))throw new Error("invalid recovery id");this.recovery=Fe}Object.freeze(this)}static fromBytes(P,Re=R.format){q(P,Re);let Fe;if(Re==="der"){const{r:O,s:st}=DER$1.toSig(abytes(P));return new $e(O,st)}Re==="recovered"&&(Fe=P[0],Re="compact",P=P.subarray(1));const Le=w.signature/2,Ce=P.subarray(0,Le),L=P.subarray(Le,Le*2);return new $e(l.fromBytes(Ce),l.fromBytes(L),Fe)}static fromHex(P,Re){return this.fromBytes(hexToBytes$5(P),Re)}assertRecovery(){const{recovery:P}=this;if(P==null)throw new Error("invalid recovery id: must be present");return P}addRecoveryBit(P){return new $e(this.r,this.s,P)}recoverPublicKey(P){const{r:Re,s:Fe}=this,Le=this.assertRecovery(),Ce=Le===2||Le===3?Re+u:Re;if(!a.isValid(Ce))throw new Error("invalid recovery id: sig.r+curve.n != R.x");const L=a.toBytes(Ce),O=e.fromBytes(concatBytes$3(pprefix((Le&1)===0),L)),st=l.inv(Ce),lt=K(abytes(P,void 0,"msgHash")),Xe=l.create(-lt*st),dt=l.create(Fe*st),er=e.BASE.multiplyUnsafe(Xe).add(O.multiplyUnsafe(dt));if(er.is0())throw new Error("invalid recovery: point at infinify");return er.assertValidity(),er}hasHighS(){return k(this.s)}toBytes(P=R.format){if(validateSigFormat(P),P==="der")return hexToBytes$5(DER$1.hexFromSig(this));const{r:Re,s:Fe}=this,Le=l.toBytes(Re),Ce=l.toBytes(Fe);return P==="recovered"?(Ve(),concatBytes$3(Uint8Array.of(this.assertRecovery()),Le,Ce)):concatBytes$3(Le,Ce)}toHex(P){return bytesToHex$3(this.toBytes(P))}}const We=r.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const Re=bytesToNumberBE$1(P),Fe=P.length*8-x;return Fe>0?Re>>BigInt(Fe):Re},K=r.bits2int_modN||function(P){return l.create(We(P))},W=bitMask$1(x);function Ye(_e){return aInRange("num < 2^"+x,_e,_0n$5,W),l.toBytes(_e)}function Qe(_e,P){return abytes(_e,void 0,"message"),P?abytes(t(_e),void 0,"prehashed message"):_e}function it(_e,P,Re){const{lowS:Fe,prehash:Le,extraEntropy:Ce}=validateSigOpts(Re,R);_e=Qe(_e,Le);const L=K(_e),O=l.fromBytes(P);if(!l.isValidNot0(O))throw new Error("invalid private key");const st=[Ye(O),Ye(L)];if(Ce!=null&&Ce!==!1){const er=Ce===!0?n(w.secretKey):Ce;st.push(abytes(er,void 0,"extraEntropy"))}const lt=concatBytes$3(...st),Xe=L;function dt(er){const ar=We(er);if(!l.isValidNot0(ar))return;const dr=l.inv(ar),ir=e.BASE.multiply(ar).toAffine(),pt=l.create(ir.x);if(pt===_0n$5)return;const tr=l.create(dr*l.create(Xe+pt*O));if(tr===_0n$5)return;let sr=(ir.x===pt?0:2)|Number(ir.y&_1n$5),nr=tr;return Fe&&k(tr)&&(nr=l.neg(tr),sr^=1),new $e(pt,nr,I?void 0:sr)}return{seed:lt,k2sig:dt}}function ze(_e,P,Re={}){const{seed:Fe,k2sig:Le}=it(_e,P,Re);return createHmacDrbg$1(t.outputLen,l.BYTES,s)(Fe,Le).toBytes(Re.format)}function v(_e,P,Re,Fe={}){const{lowS:Le,prehash:Ce,format:L}=validateSigOpts(Fe,R);if(Re=abytes(Re,void 0,"publicKey"),P=Qe(P,Ce),!isBytes$2(_e)){const O=_e instanceof $e?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+O)}q(_e,L);try{const O=$e.fromBytes(_e,L),st=e.fromBytes(Re);if(Le&&O.hasHighS())return!1;const{r:lt,s:Xe}=O,dt=K(P),er=l.inv(Xe),ar=l.create(dt*er),dr=l.create(lt*er),ir=e.BASE.multiplyUnsafe(ar).add(st.multiplyUnsafe(dr));return ir.is0()?!1:l.create(ir.x)===lt}catch{return!1}}function D(_e,P,Re={}){const{prehash:Fe}=validateSigOpts(Re,R);return P=Qe(P,Fe),$e.fromBytes(_e,"recovered").recoverPublicKey(P).toBytes()}return Object.freeze({keygen:f,getPublicKey:p,getSharedSecret:g,utils:y,lengths:w,Point:e,sign:ze,verify:v,recoverPublicKey:D,Signature:$e,hash:t})}const secp256k1_CURVE={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_2n$3=BigInt(2);function sqrtMod$1(e){const t=secp256k1_CURVE.p,r=BigInt(3),n=BigInt(6),s=BigInt(11),a=BigInt(22),l=BigInt(23),u=BigInt(44),x=BigInt(88),f=e*e*e%t,p=f*f*e%t,g=pow2$1(p,r,t)*p%t,y=pow2$1(g,r,t)*p%t,w=pow2$1(y,_2n$3,t)*f%t,R=pow2$1(w,s,t)*w%t,I=pow2$1(R,a,t)*R%t,k=pow2$1(I,u,t)*I%t,je=pow2$1(k,x,t)*k%t,Ve=pow2$1(je,u,t)*I%t,q=pow2$1(Ve,r,t)*p%t,$e=pow2$1(q,l,t)*R%t,We=pow2$1($e,n,t)*f%t,K=pow2$1(We,_2n$3,t);if(!Fpk1.eql(Fpk1.sqr(K),e))throw new Error("Cannot find square root");return K}const Fpk1=Field$1(secp256k1_CURVE.p,{sqrt:sqrtMod$1}),Pointk1=weierstrass$2(secp256k1_CURVE,{Fp:Fpk1,endo:secp256k1_ENDO}),secp256k1$2=ecdsa(Pointk1,sha256$3),Rho160=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Id160=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),Pi160=Id160.map(e=>(9*e+5)%16),idxLR=(()=>{const r=[[Id160],[Pi160]];for(let n=0;n<4;n++)for(let s of r)s.push(s[n].map(a=>Rho160[a]));return r})(),idxL=idxLR[0],idxR=idxLR[1],shifts160=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),shiftsL160=idxL.map((e,t)=>e.map(r=>shifts160[t][r])),shiftsR160=idxR.map((e,t)=>e.map(r=>shifts160[t][r])),Kl160=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Kr160=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ripemd_f(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}const BUF_160=new Uint32Array(16);class _RIPEMD160 extends HashMD{h0=1732584193;h1=-271733879;h2=-1732584194;h3=271733878;h4=-1009589776;constructor(){super(64,20,8,!0)}get(){const{h0:t,h1:r,h2:n,h3:s,h4:a}=this;return[t,r,n,s,a]}set(t,r,n,s,a){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=s|0,this.h4=a|0}process(t,r){for(let w=0;w<16;w++,r+=4)BUF_160[w]=t.getUint32(r,!0);let n=this.h0|0,s=n,a=this.h1|0,l=a,u=this.h2|0,x=u,f=this.h3|0,p=f,g=this.h4|0,y=g;for(let w=0;w<5;w++){const R=4-w,I=Kl160[w],k=Kr160[w],je=idxL[w],Ve=idxR[w],q=shiftsL160[w],$e=shiftsR160[w];for(let We=0;We<16;We++){const K=rotl$2(n+ripemd_f(w,a,u,f)+BUF_160[je[We]]+I,q[We])+g|0;n=g,g=f,f=rotl$2(u,10)|0,u=a,a=K}for(let We=0;We<16;We++){const K=rotl$2(s+ripemd_f(R,l,x,p)+BUF_160[Ve[We]]+k,$e[We])+y|0;s=y,y=p,p=rotl$2(x,10)|0,x=l,l=K}}this.set(this.h1+u+p|0,this.h2+f+y|0,this.h3+g+s|0,this.h4+n+l|0,this.h0+a+x|0)}roundClean(){clean(BUF_160)}destroy(){this.destroyed=!0,clean(this.buffer),this.set(0,0,0,0,0)}}const ripemd160$1=createHasher(()=>new _RIPEMD160);function isBytes$1(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function isArrayOf(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(r=>typeof r=="string"):t.every(r=>Number.isSafeInteger(r)):!1}function afn(e){if(typeof e!="function")throw new Error("function expected");return!0}function astr(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function anumber(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function aArr(e){if(!Array.isArray(e))throw new Error("array expected")}function astrArr(e,t){if(!isArrayOf(!0,t))throw new Error(`${e}: array of strings expected`)}function anumArr(e,t){if(!isArrayOf(!1,t))throw new Error(`${e}: array of numbers expected`)}function chain$1(...e){const t=a=>a,r=(a,l)=>u=>a(l(u)),n=e.map(a=>a.encode).reduceRight(r,t),s=e.map(a=>a.decode).reduce(r,t);return{encode:n,decode:s}}function alphabet$1(e){const t=typeof e=="string"?e.split(""):e,r=t.length;astrArr("alphabet",t);const n=new Map(t.map((s,a)=>[s,a]));return{encode:s=>(aArr(s),s.map(a=>{if(!Number.isSafeInteger(a)||a<0||a>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${a}". Allowed: ${e}`);return t[a]})),decode:s=>(aArr(s),s.map(a=>{astr("alphabet.decode",a);const l=n.get(a);if(l===void 0)throw new Error(`Unknown letter: "${a}". Allowed: ${e}`);return l}))}}function join$1(e=""){return astr("join",e),{encode:t=>(astrArr("join.decode",t),t.join(e)),decode:t=>(astr("join.decode",t),t.split(e))}}function convertRadix$1(e,t,r){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: invalid to=${r}, base cannot be less than 2`);if(aArr(e),!e.length)return[];let n=0;const s=[],a=Array.from(e,u=>{if(anumber(u),u<0||u>=t)throw new Error(`invalid integer: ${u}`);return u}),l=a.length;for(;;){let u=0,x=!0;for(let f=n;f<l;f++){const p=a[f],g=t*u,y=g+p;if(!Number.isSafeInteger(y)||g/t!==u||y-p!==g)throw new Error("convertRadix: carry overflow");const w=y/r;u=y%r;const R=Math.floor(w);if(a[f]=R,!Number.isSafeInteger(R)||R*r+u!==y)throw new Error("convertRadix: carry overflow");if(x)R?x=!1:n=f;else continue}if(s.push(u),x)break}for(let u=0;u<e.length-1&&e[u]===0;u++)s.push(0);return s.reverse()}function radix$1(e){anumber(e);const t=2**8;return{encode:r=>{if(!isBytes$1(r))throw new Error("radix.encode input should be Uint8Array");return convertRadix$1(Array.from(r),t,e)},decode:r=>(anumArr("radix.decode",r),Uint8Array.from(convertRadix$1(r,e,t)))}}function checksum(e,t){return anumber(e),afn(t),{encode(r){if(!isBytes$1(r))throw new Error("checksum.encode: input should be Uint8Array");const n=t(r).slice(0,e),s=new Uint8Array(r.length+e);return s.set(r),s.set(n,r.length),s},decode(r){if(!isBytes$1(r))throw new Error("checksum.decode: input should be Uint8Array");const n=r.slice(0,-e),s=r.slice(-e),a=t(n).slice(0,e);for(let l=0;l<e;l++)if(a[l]!==s[l])throw new Error("Invalid checksum");return n}}}const genBase58$1=e=>chain$1(radix$1(58),alphabet$1(e),join$1("")),base58$2=genBase58$1("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),createBase58check=e=>chain$1(checksum(4,t=>e(e(t))),base58$2);const Point$1=secp256k1$2.Point,{Fn}=Point$1,base58check=createBase58check(sha256$3),MASTER_SECRET=Uint8Array.from("Bitcoin seed".split(""),e=>e.charCodeAt(0)),BITCOIN_VERSIONS={private:76066276,public:76067358},HARDENED_OFFSET=2147483648,hash160$1=e=>ripemd160$1(sha256$3(e)),fromU32=e=>createView$3(e).getUint32(0,!1),toU32=e=>{if(!Number.isSafeInteger(e)||e<0||e>2**32-1)throw new Error("invalid number, should be from 0 to 2**32-1, got "+e);const t=new Uint8Array(4);return createView$3(t).setUint32(0,e,!1),t};class HDKey{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return fromU32(this.pubHash)}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this._privateKey||null}get publicKey(){return this._publicKey||null}get privateExtendedKey(){const t=this._privateKey;if(!t)throw new Error("No private key");return base58check.encode(this.serialize(this.versions.private,concatBytes$3(Uint8Array.of(0),t)))}get publicExtendedKey(){if(!this._publicKey)throw new Error("No public key");return base58check.encode(this.serialize(this.versions.public,this._publicKey))}static fromMasterSeed(t,r=BITCOIN_VERSIONS){if(abytes(t),8*t.length<128||8*t.length>512)throw new Error("HDKey: seed length must be between 128 and 512 bits; 256 bits is advised, got "+t.length);const n=hmac$3(sha512$1,MASTER_SECRET,t),s=n.slice(0,32),a=n.slice(32);return new HDKey({versions:r,chainCode:a,privateKey:s})}static fromExtendedKey(t,r=BITCOIN_VERSIONS){const n=base58check.decode(t),s=createView$3(n),a=s.getUint32(0,!1),l={versions:r,depth:n[4],parentFingerprint:s.getUint32(5,!1),index:s.getUint32(9,!1),chainCode:n.slice(13,45)},u=n.slice(45),x=u[0]===0;if(a!==r[x?"private":"public"])throw new Error("Version mismatch");return x?new HDKey({...l,privateKey:u.slice(1)}):new HDKey({...l,publicKey:u})}static fromJSON(t){return HDKey.fromExtendedKey(t.xpriv)}versions;depth=0;index=0;chainCode=null;parentFingerprint=0;_privateKey;_publicKey;pubHash;constructor(t){if(!t||typeof t!="object")throw new Error("HDKey.constructor must not be called directly");if(this.versions=t.versions||BITCOIN_VERSIONS,this.depth=t.depth||0,this.chainCode=t.chainCode||null,this.index=t.index||0,this.parentFingerprint=t.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(this.depth>255)throw new Error("HDKey: depth exceeds the serializable value 255");if(t.publicKey&&t.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(t.privateKey){if(!secp256k1$2.utils.isValidSecretKey(t.privateKey))throw new Error("Invalid private key");this._privateKey=t.privateKey,this._publicKey=secp256k1$2.getPublicKey(t.privateKey,!0)}else if(t.publicKey)this._publicKey=Point$1.fromBytes(t.publicKey).toBytes(!0);else throw new Error("HDKey: no public or private key provided");this.pubHash=hash160$1(this._publicKey)}derive(t){if(!/^[mM]'?/.test(t))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(t))return this;const r=t.replace(/^[mM]'?\//,"").split("/");let n=this;for(const s of r){const a=/^(\d+)('?)$/.exec(s),l=a&&a[1];if(!a||a.length!==3||typeof l!="string")throw new Error("invalid child index: "+s);let u=+l;if(!Number.isSafeInteger(u)||u>=HARDENED_OFFSET)throw new Error("Invalid index");a[2]==="'"&&(u+=HARDENED_OFFSET),n=n.deriveChild(u)}return n}deriveChild(t){if(!this._publicKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let r=toU32(t);if(t>=HARDENED_OFFSET){const x=this._privateKey;if(!x)throw new Error("Could not derive hardened child key");r=concatBytes$3(Uint8Array.of(0),x,r)}else r=concatBytes$3(this._publicKey,r);const n=hmac$3(sha512$1,this.chainCode,r),s=n.slice(0,32),a=n.slice(32);if(!secp256k1$2.utils.isValidSecretKey(s))throw new Error("Tweak bigger than curve order");const l={versions:this.versions,chainCode:a,depth:this.depth+1,parentFingerprint:this.fingerprint,index:t},u=Fn.fromBytes(s);try{if(this._privateKey){const x=Fn.create(Fn.fromBytes(this._privateKey)+u);if(!Fn.isValidNot0(x))throw new Error("The tweak was out of range or the resulted private key is invalid");l.privateKey=Fn.toBytes(x)}else{const x=Point$1.fromBytes(this._publicKey).add(Point$1.BASE.multiply(u));if(x.equals(Point$1.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");l.publicKey=x.toBytes(!0)}return new HDKey(l)}catch{return this.deriveChild(t+1)}}sign(t){if(!this._privateKey)throw new Error("No privateKey set!");return abytes(t,32),secp256k1$2.sign(t,this._privateKey,{prehash:!1})}verify(t,r){if(abytes(t,32),abytes(r,64),!this._publicKey)throw new Error("No publicKey set!");return secp256k1$2.verify(r,t,this._publicKey,{prehash:!1})}wipePrivateData(){return this._privateKey&&(this._privateKey.fill(0),this._privateKey=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(t,r){if(!this.chainCode)throw new Error("No chainCode set");return abytes(r,33),concatBytes$3(toU32(t),new Uint8Array([this.depth]),toU32(this.parentFingerprint),toU32(this.index),this.chainCode,r)}}function number$4(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bytes$2(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$2(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$4(e.outputLen),number$4(e.blockLen)}function exists$2(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$2(e,t){bytes$2(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const crypto$4=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const u8a$2=e=>e instanceof Uint8Array,createView$2=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$1=(e,t)=>e<<32-t|e>>>t,isLE$2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$2)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$3(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$2(e){if(typeof e=="string"&&(e=utf8ToBytes$3(e)),!u8a$2(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function concatBytes$2(...e){const t=new Uint8Array(e.reduce((n,s)=>n+s.length,0));let r=0;return e.forEach(n=>{if(!u8a$2(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}let Hash$1=class{clone(){return this._cloneInto()}};function wrapConstructor$1(e){const t=n=>e().update(toBytes$2(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function randomBytes$1(e=32){if(crypto$4&&typeof crypto$4.getRandomValues=="function")return crypto$4.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$2(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const s=BigInt(32),a=BigInt(4294967295),l=Number(r>>s&a),u=Number(r&a),x=n?4:0,f=n?0:4;e.setUint32(t+x,l,n),e.setUint32(t+f,u,n)}let SHA2$1=class extends Hash$1{constructor(t,r,n,s){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=createView$2(this.buffer)}update(t){exists$2(this);const{view:r,buffer:n,blockLen:s}=this;t=toBytes$2(t);const a=t.length;for(let l=0;l<a;){const u=Math.min(s-this.pos,a-l);if(u===s){const x=createView$2(t);for(;s<=a-l;l+=s)this.process(x,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){exists$2(this),output$2(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:a}=this;let{pos:l}=this;r[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>s-l&&(this.process(n,0),l=0);for(let g=l;g<s;g++)r[g]=0;setBigUint64$2(n,s-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$2(t),x=this.outputLen;if(x%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=x/4,p=this.get();if(f>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<f;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:a,destroyed:l,pos:u}=this;return t.length=s,t.pos=u,t.finished=a,t.destroyed=l,s%r&&t.buffer.set(n),t}};const Chi$1=(e,t,r)=>e&t^~e&r,Maj$1=(e,t,r)=>e&t^e&r^t&r,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends SHA2$1{constructor(){super(64,32,8,!1),this.A=IV$1[0]|0,this.B=IV$1[1]|0,this.C=IV$1[2]|0,this.D=IV$1[3]|0,this.E=IV$1[4]|0,this.F=IV$1[5]|0,this.G=IV$1[6]|0,this.H=IV$1[7]|0}get(){const{A:t,B:r,C:n,D:s,E:a,F:l,G:u,H:x}=this;return[t,r,n,s,a,l,u,x]}set(t,r,n,s,a,l,u,x){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=x|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W$1[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W$1[g-15],w=SHA256_W$1[g-2],R=rotr$1(y,7)^rotr$1(y,18)^y>>>3,I=rotr$1(w,17)^rotr$1(w,19)^w>>>10;SHA256_W$1[g]=I+SHA256_W$1[g-7]+R+SHA256_W$1[g-16]|0}let{A:n,B:s,C:a,D:l,E:u,F:x,G:f,H:p}=this;for(let g=0;g<64;g++){const y=rotr$1(u,6)^rotr$1(u,11)^rotr$1(u,25),w=p+y+Chi$1(u,x,f)+SHA256_K$1[g]+SHA256_W$1[g]|0,I=(rotr$1(n,2)^rotr$1(n,13)^rotr$1(n,22))+Maj$1(n,s,a)|0;p=f,f=x,x=u,u=l+w|0,l=a,a=s,s=n,n=w+I|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,x=x+this.F|0,f=f+this.G|0,p=p+this.H|0,this.set(n,s,a,l,u,x,f,p)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$2=wrapConstructor$1(()=>new SHA256$1);const _0n$4=BigInt(0),_1n$4=BigInt(1),_2n$2=BigInt(2),u8a$1=e=>e instanceof Uint8Array,hexes$2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$2(e){if(!u8a$1(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=hexes$2[e[r]];return t}function numberToHexUnpadded(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function hexToNumber(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function hexToBytes$4(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){const s=n*2,a=e.slice(s,s+2),l=Number.parseInt(a,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");r[n]=l}return r}function bytesToNumberBE(e){return hexToNumber(bytesToHex$2(e))}function bytesToNumberLE(e){if(!u8a$1(e))throw new Error("Uint8Array expected");return hexToNumber(bytesToHex$2(Uint8Array.from(e).reverse()))}function numberToBytesBE(e,t){return hexToBytes$4(e.toString(16).padStart(t*2,"0"))}function numberToBytesLE(e,t){return numberToBytesBE(e,t).reverse()}function numberToVarBytesBE(e){return hexToBytes$4(numberToHexUnpadded(e))}function ensureBytes(e,t,r){let n;if(typeof t=="string")try{n=hexToBytes$4(t)}catch(a){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${a}`)}else if(u8a$1(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(`${e} expected ${r} bytes, got ${s}`);return n}function concatBytes$1(...e){const t=new Uint8Array(e.reduce((n,s)=>n+s.length,0));let r=0;return e.forEach(n=>{if(!u8a$1(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}function equalBytes$1(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function utf8ToBytes$2(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function bitLen(e){let t;for(t=0;e>_0n$4;e>>=_1n$4,t+=1);return t}function bitGet(e,t){return e>>BigInt(t)&_1n$4}const bitSet=(e,t,r)=>e|(r?_1n$4:_0n$4)<<BigInt(t),bitMask=e=>(_2n$2<<BigInt(e-1))-_1n$4,u8n=e=>new Uint8Array(e),u8fr=e=>Uint8Array.from(e);function createHmacDrbg(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=u8n(e),s=u8n(e),a=0;const l=()=>{n.fill(1),s.fill(0),a=0},u=(...g)=>r(s,n,...g),x=(g=u8n())=>{s=u(u8fr([0]),g),n=u(),g.length!==0&&(s=u(u8fr([1]),g),n=u())},f=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let g=0;const y=[];for(;g<t;){n=u();const w=n.slice();y.push(w),g+=n.length}return concatBytes$1(...y)};return(g,y)=>{l(),x(g);let w;for(;!(w=y(f()));)x();return l(),w}}const validatorFns={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function validateObject(e,t,r={}){const n=(s,a,l)=>{const u=validatorFns[a];if(typeof u!="function")throw new Error(`Invalid validator "${a}", expected function`);const x=e[s];if(!(l&&x===void 0)&&!u(x,e))throw new Error(`Invalid param ${String(s)}=${x} (${typeof x}), expected ${a}`)};for(const[s,a]of Object.entries(t))n(s,a,!1);for(const[s,a]of Object.entries(r))n(s,a,!0);return e}const ut=Object.freeze(Object.defineProperty({__proto__:null,bitGet,bitLen,bitMask,bitSet,bytesToHex:bytesToHex$2,bytesToNumberBE,bytesToNumberLE,concatBytes:concatBytes$1,createHmacDrbg,ensureBytes,equalBytes:equalBytes$1,hexToBytes:hexToBytes$4,hexToNumber,numberToBytesBE,numberToBytesLE,numberToHexUnpadded,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$2,validateObject},Symbol.toStringTag,{value:"Module"}));const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$1=BigInt(2),_3n$1=BigInt(3),_4n=BigInt(4),_5n=BigInt(5),_8n=BigInt(8);BigInt(9);BigInt(16);function mod(e,t){const r=e%t;return r>=_0n$3?r:t+r}function pow$1(e,t,r){if(r<=_0n$3||t<_0n$3)throw new Error("Expected power/modulo > 0");if(r===_1n$3)return _0n$3;let n=_1n$3;for(;t>_0n$3;)t&_1n$3&&(n=n*e%r),e=e*e%r,t>>=_1n$3;return n}function pow2(e,t,r){let n=e;for(;t-- >_0n$3;)n*=n,n%=r;return n}function invert(e,t){if(e===_0n$3||t<=_0n$3)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=mod(e,t),n=t,s=_0n$3,a=_1n$3;for(;r!==_0n$3;){const u=n/r,x=n%r,f=s-a*u;n=r,r=x,s=a,a=f}if(n!==_1n$3)throw new Error("invert: does not exist");return mod(s,t)}function tonelliShanks(e){const t=(e-_1n$3)/_2n$1;let r,n,s;for(r=e-_1n$3,n=0;r%_2n$1===_0n$3;r/=_2n$1,n++);for(s=_2n$1;s<e&&pow$1(s,t,e)!==e-_1n$3;s++);if(n===1){const l=(e+_1n$3)/_4n;return function(x,f){const p=x.pow(f,l);if(!x.eql(x.sqr(p),f))throw new Error("Cannot find square root");return p}}const a=(r+_1n$3)/_2n$1;return function(u,x){if(u.pow(x,t)===u.neg(u.ONE))throw new Error("Cannot find square root");let f=n,p=u.pow(u.mul(u.ONE,s),r),g=u.pow(x,a),y=u.pow(x,r);for(;!u.eql(y,u.ONE);){if(u.eql(y,u.ZERO))return u.ZERO;let w=1;for(let I=u.sqr(y);w<f&&!u.eql(I,u.ONE);w++)I=u.sqr(I);const R=u.pow(p,_1n$3<<BigInt(f-w-1));p=u.sqr(R),g=u.mul(g,R),y=u.mul(y,p),f=w}return g}}function FpSqrt(e){if(e%_4n===_3n$1){const t=(e+_1n$3)/_4n;return function(n,s){const a=n.pow(s,t);if(!n.eql(n.sqr(a),s))throw new Error("Cannot find square root");return a}}if(e%_8n===_5n){const t=(e-_5n)/_8n;return function(n,s){const a=n.mul(s,_2n$1),l=n.pow(a,t),u=n.mul(s,l),x=n.mul(n.mul(u,_2n$1),l),f=n.mul(u,n.sub(x,n.ONE));if(!n.eql(n.sqr(f),s))throw new Error("Cannot find square root");return f}}return tonelliShanks(e)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=FIELD_FIELDS.reduce((n,s)=>(n[s]="function",n),t);return validateObject(e,r)}function FpPow(e,t,r){if(r<_0n$3)throw new Error("Expected power > 0");if(r===_0n$3)return e.ONE;if(r===_1n$3)return t;let n=e.ONE,s=t;for(;r>_0n$3;)r&_1n$3&&(n=e.mul(n,s)),s=e.sqr(s),r>>=_1n$3;return n}function FpInvertBatch(e,t){const r=new Array(t.length),n=t.reduce((a,l,u)=>e.is0(l)?a:(r[u]=a,e.mul(a,l)),e.ONE),s=e.inv(n);return t.reduceRight((a,l,u)=>e.is0(l)?a:(r[u]=e.mul(a,r[u]),e.mul(a,l)),s),r}function nLength(e,t){const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Field(e,t,r=!1,n={}){if(e<=_0n$3)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:s,nByteLength:a}=nLength(e,t);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const l=FpSqrt(e),u=Object.freeze({ORDER:e,BITS:s,BYTES:a,MASK:bitMask(s),ZERO:_0n$3,ONE:_1n$3,create:x=>mod(x,e),isValid:x=>{if(typeof x!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof x}`);return _0n$3<=x&&x<e},is0:x=>x===_0n$3,isOdd:x=>(x&_1n$3)===_1n$3,neg:x=>mod(-x,e),eql:(x,f)=>x===f,sqr:x=>mod(x*x,e),add:(x,f)=>mod(x+f,e),sub:(x,f)=>mod(x-f,e),mul:(x,f)=>mod(x*f,e),pow:(x,f)=>FpPow(u,x,f),div:(x,f)=>mod(x*invert(f,e),e),sqrN:x=>x*x,addN:(x,f)=>x+f,subN:(x,f)=>x-f,mulN:(x,f)=>x*f,inv:x=>invert(x,e),sqrt:n.sqrt||(x=>l(u,x)),invertBatch:x=>FpInvertBatch(u,x),cmov:(x,f,p)=>p?f:x,toBytes:x=>r?numberToBytesLE(x,a):numberToBytesBE(x,a),fromBytes:x=>{if(x.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${x.length}`);return r?bytesToNumberLE(x):bytesToNumberBE(x)}});return Object.freeze(u)}function getFieldBytesLength(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength(e){const t=getFieldBytesLength(e);return t+Math.ceil(t/2)}function mapHashToField(e,t,r=!1){const n=e.length,s=getFieldBytesLength(t),a=getMinHashLength(t);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);const l=r?bytesToNumberBE(e):bytesToNumberLE(e),u=mod(l,t-_1n$3)+_1n$3;return r?numberToBytesLE(u,s):numberToBytesBE(u,s)}const _0n$2=BigInt(0),_1n$2=BigInt(1);function wNAF(e,t){const r=(s,a)=>{const l=a.negate();return s?l:a},n=s=>{const a=Math.ceil(t/s)+1,l=2**(s-1);return{windows:a,windowSize:l}};return{constTimeNegate:r,unsafeLadder(s,a){let l=e.ZERO,u=s;for(;a>_0n$2;)a&_1n$2&&(l=l.add(u)),u=u.double(),a>>=_1n$2;return l},precomputeWindow(s,a){const{windows:l,windowSize:u}=n(a),x=[];let f=s,p=f;for(let g=0;g<l;g++){p=f,x.push(p);for(let y=1;y<u;y++)p=p.add(f),x.push(p);f=p.double()}return x},wNAF(s,a,l){const{windows:u,windowSize:x}=n(s);let f=e.ZERO,p=e.BASE;const g=BigInt(2**s-1),y=2**s,w=BigInt(s);for(let R=0;R<u;R++){const I=R*x;let k=Number(l&g);l>>=w,k>x&&(k-=y,l+=_1n$2);const je=I,Ve=I+Math.abs(k)-1,q=R%2!==0,$e=k<0;k===0?p=p.add(r(q,a[je])):f=f.add(r($e,a[Ve]))}return{p:f,f:p}},wNAFCached(s,a,l,u){const x=s._WINDOW_SIZE||1;let f=a.get(s);return f||(f=this.precomputeWindow(s,x),x!==1&&a.set(s,u(f))),this.wNAF(x,f,l)}}}function validateBasic(e){return validateField(e.Fp),validateObject(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function validatePointOpts(e){const t=validateBasic(e);validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:s}=t;if(r){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut,DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){const{Err:t}=DER;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");const r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:b2n(n),l:e.subarray(r+2)}},toSig(e){const{Err:t}=DER,r=typeof e=="string"?h2b(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");const{d:s,l:a}=DER._parseInt(r.subarray(2)),{d:l,l:u}=DER._parseInt(a);if(u.length)throw new t("Invalid signature: left bytes after parsing");return{r:s,s:l}},hexFromSig(e){const t=f=>Number.parseInt(f[0],16)&8?"00"+f:f,r=f=>{const p=f.toString(16);return p.length&1?`0${p}`:p},n=t(r(e.s)),s=t(r(e.r)),a=n.length/2,l=s.length/2,u=r(a),x=r(l);return`30${r(l+a+4)}02${x}${s}02${u}${n}`}},_0n$1=BigInt(0),_1n$1=BigInt(1);BigInt(2);const _3n=BigInt(3);BigInt(4);function weierstrassPoints(e){const t=validatePointOpts(e),{Fp:r}=t,n=t.toBytes||((R,I,k)=>{const je=I.toAffine();return concatBytes$1(Uint8Array.from([4]),r.toBytes(je.x),r.toBytes(je.y))}),s=t.fromBytes||(R=>{const I=R.subarray(1),k=r.fromBytes(I.subarray(0,r.BYTES)),je=r.fromBytes(I.subarray(r.BYTES,2*r.BYTES));return{x:k,y:je}});function a(R){const{a:I,b:k}=t,je=r.sqr(R),Ve=r.mul(je,R);return r.add(r.add(Ve,r.mul(R,I)),k)}if(!r.eql(r.sqr(t.Gy),a(t.Gx)))throw new Error("bad generator point: equation left != right");function l(R){return typeof R=="bigint"&&_0n$1<R&&R<t.n}function u(R){if(!l(R))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function x(R){const{allowedPrivateKeyLengths:I,nByteLength:k,wrapPrivateKey:je,n:Ve}=t;if(I&&typeof R!="bigint"){if(R instanceof Uint8Array&&(R=bytesToHex$2(R)),typeof R!="string"||!I.includes(R.length))throw new Error("Invalid key");R=R.padStart(k*2,"0")}let q;try{q=typeof R=="bigint"?R:bytesToNumberBE(ensureBytes("private key",R,k))}catch{throw new Error(`private key must be ${k} bytes, hex or bigint, not ${typeof R}`)}return je&&(q=mod(q,Ve)),u(q),q}const f=new Map;function p(R){if(!(R instanceof g))throw new Error("ProjectivePoint expected")}class g{constructor(I,k,je){if(this.px=I,this.py=k,this.pz=je,I==null||!r.isValid(I))throw new Error("x required");if(k==null||!r.isValid(k))throw new Error("y required");if(je==null||!r.isValid(je))throw new Error("z required")}static fromAffine(I){const{x:k,y:je}=I||{};if(!I||!r.isValid(k)||!r.isValid(je))throw new Error("invalid affine point");if(I instanceof g)throw new Error("projective point not allowed");const Ve=q=>r.eql(q,r.ZERO);return Ve(k)&&Ve(je)?g.ZERO:new g(k,je,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(I){const k=r.invertBatch(I.map(je=>je.pz));return I.map((je,Ve)=>je.toAffine(k[Ve])).map(g.fromAffine)}static fromHex(I){const k=g.fromAffine(s(ensureBytes("pointHex",I)));return k.assertValidity(),k}static fromPrivateKey(I){return g.BASE.multiply(x(I))}_setWindowSize(I){this._WINDOW_SIZE=I,f.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:I,y:k}=this.toAffine();if(!r.isValid(I)||!r.isValid(k))throw new Error("bad point: x or y not FE");const je=r.sqr(k),Ve=a(I);if(!r.eql(je,Ve))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:I}=this.toAffine();if(r.isOdd)return!r.isOdd(I);throw new Error("Field doesn't support isOdd")}equals(I){p(I);const{px:k,py:je,pz:Ve}=this,{px:q,py:$e,pz:We}=I,K=r.eql(r.mul(k,We),r.mul(q,Ve)),W=r.eql(r.mul(je,We),r.mul($e,Ve));return K&&W}negate(){return new g(this.px,r.neg(this.py),this.pz)}double(){const{a:I,b:k}=t,je=r.mul(k,_3n),{px:Ve,py:q,pz:$e}=this;let We=r.ZERO,K=r.ZERO,W=r.ZERO,Ye=r.mul(Ve,Ve),Qe=r.mul(q,q),it=r.mul($e,$e),ze=r.mul(Ve,q);return ze=r.add(ze,ze),W=r.mul(Ve,$e),W=r.add(W,W),We=r.mul(I,W),K=r.mul(je,it),K=r.add(We,K),We=r.sub(Qe,K),K=r.add(Qe,K),K=r.mul(We,K),We=r.mul(ze,We),W=r.mul(je,W),it=r.mul(I,it),ze=r.sub(Ye,it),ze=r.mul(I,ze),ze=r.add(ze,W),W=r.add(Ye,Ye),Ye=r.add(W,Ye),Ye=r.add(Ye,it),Ye=r.mul(Ye,ze),K=r.add(K,Ye),it=r.mul(q,$e),it=r.add(it,it),Ye=r.mul(it,ze),We=r.sub(We,Ye),W=r.mul(it,Qe),W=r.add(W,W),W=r.add(W,W),new g(We,K,W)}add(I){p(I);const{px:k,py:je,pz:Ve}=this,{px:q,py:$e,pz:We}=I;let K=r.ZERO,W=r.ZERO,Ye=r.ZERO;const Qe=t.a,it=r.mul(t.b,_3n);let ze=r.mul(k,q),v=r.mul(je,$e),D=r.mul(Ve,We),_e=r.add(k,je),P=r.add(q,$e);_e=r.mul(_e,P),P=r.add(ze,v),_e=r.sub(_e,P),P=r.add(k,Ve);let Re=r.add(q,We);return P=r.mul(P,Re),Re=r.add(ze,D),P=r.sub(P,Re),Re=r.add(je,Ve),K=r.add($e,We),Re=r.mul(Re,K),K=r.add(v,D),Re=r.sub(Re,K),Ye=r.mul(Qe,P),K=r.mul(it,D),Ye=r.add(K,Ye),K=r.sub(v,Ye),Ye=r.add(v,Ye),W=r.mul(K,Ye),v=r.add(ze,ze),v=r.add(v,ze),D=r.mul(Qe,D),P=r.mul(it,P),v=r.add(v,D),D=r.sub(ze,D),D=r.mul(Qe,D),P=r.add(P,D),ze=r.mul(v,P),W=r.add(W,ze),ze=r.mul(Re,P),K=r.mul(_e,K),K=r.sub(K,ze),ze=r.mul(_e,v),Ye=r.mul(Re,Ye),Ye=r.add(Ye,ze),new g(K,W,Ye)}subtract(I){return this.add(I.negate())}is0(){return this.equals(g.ZERO)}wNAF(I){return w.wNAFCached(this,f,I,k=>{const je=r.invertBatch(k.map(Ve=>Ve.pz));return k.map((Ve,q)=>Ve.toAffine(je[q])).map(g.fromAffine)})}multiplyUnsafe(I){const k=g.ZERO;if(I===_0n$1)return k;if(u(I),I===_1n$1)return this;const{endo:je}=t;if(!je)return w.unsafeLadder(this,I);let{k1neg:Ve,k1:q,k2neg:$e,k2:We}=je.splitScalar(I),K=k,W=k,Ye=this;for(;q>_0n$1||We>_0n$1;)q&_1n$1&&(K=K.add(Ye)),We&_1n$1&&(W=W.add(Ye)),Ye=Ye.double(),q>>=_1n$1,We>>=_1n$1;return Ve&&(K=K.negate()),$e&&(W=W.negate()),W=new g(r.mul(W.px,je.beta),W.py,W.pz),K.add(W)}multiply(I){u(I);let k=I,je,Ve;const{endo:q}=t;if(q){const{k1neg:$e,k1:We,k2neg:K,k2:W}=q.splitScalar(k);let{p:Ye,f:Qe}=this.wNAF(We),{p:it,f:ze}=this.wNAF(W);Ye=w.constTimeNegate($e,Ye),it=w.constTimeNegate(K,it),it=new g(r.mul(it.px,q.beta),it.py,it.pz),je=Ye.add(it),Ve=Qe.add(ze)}else{const{p:$e,f:We}=this.wNAF(k);je=$e,Ve=We}return g.normalizeZ([je,Ve])[0]}multiplyAndAddUnsafe(I,k,je){const Ve=g.BASE,q=(We,K)=>K===_0n$1||K===_1n$1||!We.equals(Ve)?We.multiplyUnsafe(K):We.multiply(K),$e=q(this,k).add(q(I,je));return $e.is0()?void 0:$e}toAffine(I){const{px:k,py:je,pz:Ve}=this,q=this.is0();I==null&&(I=q?r.ONE:r.inv(Ve));const $e=r.mul(k,I),We=r.mul(je,I),K=r.mul(Ve,I);if(q)return{x:r.ZERO,y:r.ZERO};if(!r.eql(K,r.ONE))throw new Error("invZ was invalid");return{x:$e,y:We}}isTorsionFree(){const{h:I,isTorsionFree:k}=t;if(I===_1n$1)return!0;if(k)return k(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:I,clearCofactor:k}=t;return I===_1n$1?this:k?k(g,this):this.multiplyUnsafe(t.h)}toRawBytes(I=!0){return this.assertValidity(),n(g,this,I)}toHex(I=!0){return bytesToHex$2(this.toRawBytes(I))}}g.BASE=new g(t.Gx,t.Gy,r.ONE),g.ZERO=new g(r.ZERO,r.ONE,r.ZERO);const y=t.nBitLength,w=wNAF(g,t.endo?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:g,normPrivateKeyToScalar:x,weierstrassEquation:a,isWithinCurveOrder:l}}function validateOpts(e){const t=validateBasic(e);return validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass$1(e){const t=validateOpts(e),{Fp:r,n}=t,s=r.BYTES+1,a=2*r.BYTES+1;function l(P){return _0n$1<P&&P<r.ORDER}function u(P){return mod(P,n)}function x(P){return invert(P,n)}const{ProjectivePoint:f,normPrivateKeyToScalar:p,weierstrassEquation:g,isWithinCurveOrder:y}=weierstrassPoints({...t,toBytes(P,Re,Fe){const Le=Re.toAffine(),Ce=r.toBytes(Le.x),L=concatBytes$1;return Fe?L(Uint8Array.from([Re.hasEvenY()?2:3]),Ce):L(Uint8Array.from([4]),Ce,r.toBytes(Le.y))},fromBytes(P){const Re=P.length,Fe=P[0],Le=P.subarray(1);if(Re===s&&(Fe===2||Fe===3)){const Ce=bytesToNumberBE(Le);if(!l(Ce))throw new Error("Point is not on curve");const L=g(Ce);let O=r.sqrt(L);const st=(O&_1n$1)===_1n$1;return(Fe&1)===1!==st&&(O=r.neg(O)),{x:Ce,y:O}}else if(Re===a&&Fe===4){const Ce=r.fromBytes(Le.subarray(0,r.BYTES)),L=r.fromBytes(Le.subarray(r.BYTES,2*r.BYTES));return{x:Ce,y:L}}else throw new Error(`Point of length ${Re} was invalid. Expected ${s} compressed bytes or ${a} uncompressed bytes`)}}),w=P=>bytesToHex$2(numberToBytesBE(P,t.nByteLength));function R(P){const Re=n>>_1n$1;return P>Re}function I(P){return R(P)?u(-P):P}const k=(P,Re,Fe)=>bytesToNumberBE(P.slice(Re,Fe));class je{constructor(Re,Fe,Le){this.r=Re,this.s=Fe,this.recovery=Le,this.assertValidity()}static fromCompact(Re){const Fe=t.nByteLength;return Re=ensureBytes("compactSignature",Re,Fe*2),new je(k(Re,0,Fe),k(Re,Fe,2*Fe))}static fromDER(Re){const{r:Fe,s:Le}=DER.toSig(ensureBytes("DER",Re));return new je(Fe,Le)}assertValidity(){if(!y(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!y(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(Re){return new je(this.r,this.s,Re)}recoverPublicKey(Re){const{r:Fe,s:Le,recovery:Ce}=this,L=W(ensureBytes("msgHash",Re));if(Ce==null||![0,1,2,3].includes(Ce))throw new Error("recovery id invalid");const O=Ce===2||Ce===3?Fe+t.n:Fe;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const st=(Ce&1)===0?"02":"03",lt=f.fromHex(st+w(O)),Xe=x(O),dt=u(-L*Xe),er=u(Le*Xe),ar=f.BASE.multiplyAndAddUnsafe(lt,dt,er);if(!ar)throw new Error("point at infinify");return ar.assertValidity(),ar}hasHighS(){return R(this.s)}normalizeS(){return this.hasHighS()?new je(this.r,u(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$4(this.toDERHex())}toDERHex(){return DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$4(this.toCompactHex())}toCompactHex(){return w(this.r)+w(this.s)}}const Ve={isValidPrivateKey(P){try{return p(P),!0}catch{return!1}},normPrivateKeyToScalar:p,randomPrivateKey:()=>{const P=getMinHashLength(t.n);return mapHashToField(t.randomBytes(P),t.n)},precompute(P=8,Re=f.BASE){return Re._setWindowSize(P),Re.multiply(BigInt(3)),Re}};function q(P,Re=!0){return f.fromPrivateKey(P).toRawBytes(Re)}function $e(P){const Re=P instanceof Uint8Array,Fe=typeof P=="string",Le=(Re||Fe)&&P.length;return Re?Le===s||Le===a:Fe?Le===2*s||Le===2*a:P instanceof f}function We(P,Re,Fe=!0){if($e(P))throw new Error("first arg must be private key");if(!$e(Re))throw new Error("second arg must be public key");return f.fromHex(Re).multiply(p(P)).toRawBytes(Fe)}const K=t.bits2int||function(P){const Re=bytesToNumberBE(P),Fe=P.length*8-t.nBitLength;return Fe>0?Re>>BigInt(Fe):Re},W=t.bits2int_modN||function(P){return u(K(P))},Ye=bitMask(t.nBitLength);function Qe(P){if(typeof P!="bigint")throw new Error("bigint expected");if(!(_0n$1<=P&&P<Ye))throw new Error(`bigint expected < 2^${t.nBitLength}`);return numberToBytesBE(P,t.nByteLength)}function it(P,Re,Fe=ze){if(["recovered","canonical"].some(ir=>ir in Fe))throw new Error("sign() legacy options not supported");const{hash:Le,randomBytes:Ce}=t;let{lowS:L,prehash:O,extraEntropy:st}=Fe;L==null&&(L=!0),P=ensureBytes("msgHash",P),O&&(P=ensureBytes("prehashed msgHash",Le(P)));const lt=W(P),Xe=p(Re),dt=[Qe(Xe),Qe(lt)];if(st!=null){const ir=st===!0?Ce(r.BYTES):st;dt.push(ensureBytes("extraEntropy",ir))}const er=concatBytes$1(...dt),ar=lt;function dr(ir){const pt=K(ir);if(!y(pt))return;const tr=x(pt),sr=f.BASE.multiply(pt).toAffine(),nr=u(sr.x);if(nr===_0n$1)return;const pr=u(tr*u(ar+nr*Xe));if(pr===_0n$1)return;let gr=(sr.x===nr?0:2)|Number(sr.y&_1n$1),mr=pr;return L&&R(pr)&&(mr=I(pr),gr^=1),new je(nr,mr,gr)}return{seed:er,k2sig:dr}}const ze={lowS:t.lowS,prehash:!1},v={lowS:t.lowS,prehash:!1};function D(P,Re,Fe=ze){const{seed:Le,k2sig:Ce}=it(P,Re,Fe),L=t;return createHmacDrbg(L.hash.outputLen,L.nByteLength,L.hmac)(Le,Ce)}f.BASE._setWindowSize(8);function _e(P,Re,Fe,Le=v){const Ce=P;if(Re=ensureBytes("msgHash",Re),Fe=ensureBytes("publicKey",Fe),"strict"in Le)throw new Error("options.strict was renamed to lowS");const{lowS:L,prehash:O}=Le;let st,lt;try{if(typeof Ce=="string"||Ce instanceof Uint8Array)try{st=je.fromDER(Ce)}catch(sr){if(!(sr instanceof DER.Err))throw sr;st=je.fromCompact(Ce)}else if(typeof Ce=="object"&&typeof Ce.r=="bigint"&&typeof Ce.s=="bigint"){const{r:sr,s:nr}=Ce;st=new je(sr,nr)}else throw new Error("PARSE");lt=f.fromHex(Fe)}catch(sr){if(sr.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(L&&st.hasHighS())return!1;O&&(Re=t.hash(Re));const{r:Xe,s:dt}=st,er=W(Re),ar=x(dt),dr=u(er*ar),ir=u(Xe*ar),pt=f.BASE.multiplyAndAddUnsafe(lt,dr,ir)?.toAffine();return pt?u(pt.x)===Xe:!1}return{CURVE:t,getPublicKey:q,getSharedSecret:We,sign:D,verify:_e,ProjectivePoint:f,Signature:je,utils:Ve}}let HMAC$1=class extends Hash$1{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,hash$2(t);const n=toBytes$2(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(n.length>s?t.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=t.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),a.fill(0)}update(t){return exists$2(this),this.iHash.update(t),this}digestInto(t){exists$2(this),bytes$2(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=s,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$2=(e,t,r)=>new HMAC$1(e,t).update(r).digest();hmac$2.create=(e,t)=>new HMAC$1(e,t);function getHash(e){return{hash:e,hmac:(t,...r)=>hmac$2(e,t,concatBytes$2(...r)),randomBytes:randomBytes$1}}function createCurve(e,t){const r=n=>weierstrass$1({...e,...getHash(n)});return Object.freeze({...r(t),create:r})}const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n=BigInt(1),_2n=BigInt(2),divNearest=(e,t)=>(e+t/_2n)/t;function sqrtMod(e){const t=secp256k1P,r=BigInt(3),n=BigInt(6),s=BigInt(11),a=BigInt(22),l=BigInt(23),u=BigInt(44),x=BigInt(88),f=e*e*e%t,p=f*f*e%t,g=pow2(p,r,t)*p%t,y=pow2(g,r,t)*p%t,w=pow2(y,_2n,t)*f%t,R=pow2(w,s,t)*w%t,I=pow2(R,a,t)*R%t,k=pow2(I,u,t)*I%t,je=pow2(k,x,t)*k%t,Ve=pow2(je,u,t)*I%t,q=pow2(Ve,r,t)*p%t,$e=pow2(q,l,t)*R%t,We=pow2($e,n,t)*f%t,K=pow2(We,_2n,t);if(!Fp.eql(Fp.sqr(K),e))throw new Error("Cannot find square root");return K}const Fp=Field(secp256k1P,void 0,void 0,{sqrt:sqrtMod}),secp256k1$1=createCurve({a:BigInt(0),b:BigInt(7),Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=secp256k1N,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-_1n*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,l=BigInt("0x100000000000000000000000000000000"),u=divNearest(a*e,t),x=divNearest(-n*e,t);let f=mod(e-u*r-x*s,t),p=mod(-u*n-x*a,t);const g=f>l,y=p>l;if(g&&(f=t-f),y&&(p=t-p),f>l||p>l)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:g,k1:f,k2neg:y,k2:p}}}},sha256$2),_0n=BigInt(0),fe=e=>typeof e=="bigint"&&_0n<e&&e<secp256k1P,ge=e=>typeof e=="bigint"&&_0n<e&&e<secp256k1N,TAGGED_HASH_PREFIXES$1={};function taggedHash$1(e,...t){let r=TAGGED_HASH_PREFIXES$1[e];if(r===void 0){const n=sha256$2(Uint8Array.from(e,s=>s.charCodeAt(0)));r=concatBytes$1(n,n),TAGGED_HASH_PREFIXES$1[e]=r}return sha256$2(concatBytes$1(r,...t))}const pointToBytes=e=>e.toRawBytes(!0).slice(1),numTo32b=e=>numberToBytesBE(e,32),modP=e=>mod(e,secp256k1P),modN=e=>mod(e,secp256k1N),Point=secp256k1$1.ProjectivePoint,GmulAdd=(e,t,r)=>Point.BASE.multiplyAndAddUnsafe(e,t,r);function schnorrGetExtPubKey(e){let t=secp256k1$1.utils.normPrivateKeyToScalar(e),r=Point.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:modN(-t),bytes:pointToBytes(r)}}function lift_x(e){if(!fe(e))throw new Error("bad x: need 0 < x < p");const t=modP(e*e),r=modP(t*e+BigInt(7));let n=sqrtMod(r);n%_2n!==_0n&&(n=modP(-n));const s=new Point(e,n,_1n);return s.assertValidity(),s}function challenge(...e){return modN(bytesToNumberBE(taggedHash$1("BIP0340/challenge",...e)))}function schnorrGetPublicKey(e){return schnorrGetExtPubKey(e).bytes}function schnorrSign(e,t,r=randomBytes$1(32)){const n=ensureBytes("message",e),{bytes:s,scalar:a}=schnorrGetExtPubKey(t),l=ensureBytes("auxRand",r,32),u=numTo32b(a^bytesToNumberBE(taggedHash$1("BIP0340/aux",l))),x=taggedHash$1("BIP0340/nonce",u,s,n),f=modN(bytesToNumberBE(x));if(f===_0n)throw new Error("sign failed: k is zero");const{bytes:p,scalar:g}=schnorrGetExtPubKey(f),y=challenge(p,s,n),w=new Uint8Array(64);if(w.set(p,0),w.set(numTo32b(modN(g+y*a)),32),!schnorrVerify(w,n,s))throw new Error("sign: Invalid signature produced");return w}function schnorrVerify(e,t,r){const n=ensureBytes("signature",e,64),s=ensureBytes("message",t),a=ensureBytes("publicKey",r,32);try{const l=lift_x(bytesToNumberBE(a)),u=bytesToNumberBE(n.subarray(0,32));if(!fe(u))return!1;const x=bytesToNumberBE(n.subarray(32,64));if(!ge(x))return!1;const f=challenge(numTo32b(u),pointToBytes(l),s),p=GmulAdd(l,x,modN(-f));return!(!p||!p.hasEvenY()||p.toAffine().x!==u)}catch{return!1}}const schnorr={getPublicKey:schnorrGetPublicKey,sign:schnorrSign,verify:schnorrVerify,utils:{randomPrivateKey:secp256k1$1.utils.randomPrivateKey,lift_x,pointToBytes,numberToBytesBE,bytesToNumberBE,taggedHash:taggedHash$1,mod}},crypto$3=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const u8a=e=>e instanceof Uint8Array,u32$1=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),createView$1=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr=(e,t)=>e<<32-t|e>>>t,isLE$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$1)throw new Error("Non little-endian hardware is not supported");const hexes$1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$1(e){if(!u8a(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=hexes$1[e[r]];return t}function hexToBytes$3(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){const s=n*2,a=e.slice(s,s+2),l=Number.parseInt(a,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");r[n]=l}return r}function utf8ToBytes$1(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$1(e){if(typeof e=="string"&&(e=utf8ToBytes$1(e)),!u8a(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function concatBytes(...e){const t=new Uint8Array(e.reduce((n,s)=>n+s.length,0));let r=0;return e.forEach(n=>{if(!u8a(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}class Hash{clone(){return this._cloneInto()}}const isPlainObject=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function checkOpts$1(e,t){if(t!==void 0&&(typeof t!="object"||!isPlainObject(t)))throw new Error("Options should be object or undefined");return Object.assign(e,t)}function wrapConstructor(e){const t=n=>e().update(toBytes$1(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function randomBytes(e=32){if(crypto$3&&typeof crypto$3.getRandomValues=="function")return crypto$3.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function number$3(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bool$1(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function bytes$1(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$1(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$3(e.outputLen),number$3(e.blockLen)}function exists$1(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$1(e,t){bytes$1(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const assert$3={number:number$3,bool:bool$1,bytes:bytes$1,hash:hash$1,exists:exists$1,output:output$1};function setBigUint64$1(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const s=BigInt(32),a=BigInt(4294967295),l=Number(r>>s&a),u=Number(r&a),x=n?4:0,f=n?0:4;e.setUint32(t+x,l,n),e.setUint32(t+f,u,n)}class SHA2 extends Hash{constructor(t,r,n,s){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=createView$1(this.buffer)}update(t){assert$3.exists(this);const{view:r,buffer:n,blockLen:s}=this;t=toBytes$1(t);const a=t.length;for(let l=0;l<a;){const u=Math.min(s-this.pos,a-l);if(u===s){const x=createView$1(t);for(;s<=a-l;l+=s)this.process(x,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){assert$3.exists(this),assert$3.output(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:a}=this;let{pos:l}=this;r[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>s-l&&(this.process(n,0),l=0);for(let g=l;g<s;g++)r[g]=0;setBigUint64$1(n,s-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$1(t),x=this.outputLen;if(x%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=x/4,p=this.get();if(f>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<f;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:a,destroyed:l,pos:u}=this;return t.length=s,t.pos=u,t.finished=a,t.destroyed=l,s%r&&t.buffer.set(n),t}}const Chi=(e,t,r)=>e&t^~e&r,Maj=(e,t,r)=>e&t^e&r^t&r,SHA256_K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W=new Uint32Array(64);class SHA256 extends SHA2{constructor(){super(64,32,8,!1),this.A=IV[0]|0,this.B=IV[1]|0,this.C=IV[2]|0,this.D=IV[3]|0,this.E=IV[4]|0,this.F=IV[5]|0,this.G=IV[6]|0,this.H=IV[7]|0}get(){const{A:t,B:r,C:n,D:s,E:a,F:l,G:u,H:x}=this;return[t,r,n,s,a,l,u,x]}set(t,r,n,s,a,l,u,x){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=x|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W[g-15],w=SHA256_W[g-2],R=rotr(y,7)^rotr(y,18)^y>>>3,I=rotr(w,17)^rotr(w,19)^w>>>10;SHA256_W[g]=I+SHA256_W[g-7]+R+SHA256_W[g-16]|0}let{A:n,B:s,C:a,D:l,E:u,F:x,G:f,H:p}=this;for(let g=0;g<64;g++){const y=rotr(u,6)^rotr(u,11)^rotr(u,25),w=p+y+Chi(u,x,f)+SHA256_K[g]+SHA256_W[g]|0,I=(rotr(n,2)^rotr(n,13)^rotr(n,22))+Maj(n,s,a)|0;p=f,f=x,x=u,u=l+w|0,l=a,a=s,s=n,n=w+I|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,x=x+this.F|0,f=f+this.G|0,p=p+this.H|0,this.set(n,s,a,l,u,x,f,p)}roundClean(){SHA256_W.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class SHA224 extends SHA256{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const sha256$1=wrapConstructor(()=>new SHA256);wrapConstructor(()=>new SHA224);function assertNumber(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function chain(...e){const t=(s,a)=>l=>s(a(l)),r=Array.from(e).reverse().reduce((s,a)=>s?t(s,a.encode):a.encode,void 0),n=e.reduce((s,a)=>s?t(s,a.decode):a.decode,void 0);return{encode:r,decode:n}}function alphabet(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(r=>{if(assertNumber(r),r<0||r>=e.length)throw new Error(`Digit index outside alphabet: ${r} (alphabet: ${e.length})`);return e[r]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(r=>{if(typeof r!="string")throw new Error(`alphabet.decode: not string element=${r}`);const n=e.indexOf(r);if(n===-1)throw new Error(`Unknown letter: "${r}". Allowed: ${e}`);return n})}}}function join(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let r of t)if(typeof r!="string")throw new Error(`join.encode: non-string input=${r}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function padding(e,t="="){if(assertNumber(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let n of r)if(typeof n!="string")throw new Error(`padding.encode: non-string input=${n}`);for(;r.length*e%8;)r.push(t);return r},decode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let s of r)if(typeof s!="string")throw new Error(`padding.decode: non-string input=${s}`);let n=r.length;if(n*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if(!((n-1)*e%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function normalize$1(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function convertRadix(e,t,r){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let n=0;const s=[],a=Array.from(e);for(a.forEach(l=>{if(assertNumber(l),l<0||l>=t)throw new Error(`Wrong integer: ${l}`)});;){let l=0,u=!0;for(let x=n;x<a.length;x++){const f=a[x],p=t*l+f;if(!Number.isSafeInteger(p)||t*l/t!==l||p-f!==t*l)throw new Error("convertRadix: carry overflow");if(l=p%r,a[x]=Math.floor(p/r),!Number.isSafeInteger(a[x])||a[x]*r+l!==p)throw new Error("convertRadix: carry overflow");if(u)a[x]?u=!1:n=x;else continue}if(s.push(l),u)break}for(let l=0;l<e.length-1&&e[l]===0;l++)s.push(0);return s.reverse()}const gcd=(e,t)=>t?gcd(t,e%t):e,radix2carry=(e,t)=>e+(t-gcd(e,t));function convertRadix2(e,t,r,n){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(radix2carry(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${radix2carry(t,r)}`);let s=0,a=0;const l=2**r-1,u=[];for(const x of e){if(assertNumber(x),x>=2**t)throw new Error(`convertRadix2: invalid data word=${x} from=${t}`);if(s=s<<t|x,a+t>32)throw new Error(`convertRadix2: carry overflow pos=${a} from=${t}`);for(a+=t;a>=r;a-=r)u.push((s>>a-r&l)>>>0);s&=2**a-1}if(s=s<<r-a&l,!n&&a>=t)throw new Error("Excess padding");if(!n&&s)throw new Error(`Non-zero padding: ${s}`);return n&&a>0&&u.push(s>>>0),u}function radix(e){return assertNumber(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(convertRadix(t,e,2**8))}}}function radix2(e,t=!1){if(assertNumber(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,e)>32||radix2carry(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(r),8,e,!t)},decode:r=>{if(!Array.isArray(r)||r.length&&typeof r[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(convertRadix2(r,e,8,t))}}}function unsafeWrapper(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}const base16=chain(radix2(4),alphabet("0123456789ABCDEF"),join("")),base32=chain(radix2(5),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHIJKLMNOPQRSTUV"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),join(""),normalize$1(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const base64=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),padding(6),join("")),base64url=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),padding(6),join("")),genBase58=e=>chain(radix(58),alphabet(e),join("")),base58$1=genBase58("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");genBase58("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");genBase58("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const XMR_BLOCK_LEN=[0,2,3,5,6,7,9,10,11],base58xmr={encode(e){let t="";for(let r=0;r<e.length;r+=8){const n=e.subarray(r,r+8);t+=base58$1.encode(n).padStart(XMR_BLOCK_LEN[n.length],"1")}return t},decode(e){let t=[];for(let r=0;r<e.length;r+=11){const n=e.slice(r,r+11),s=XMR_BLOCK_LEN.indexOf(n.length),a=base58$1.decode(n);for(let l=0;l<a.length-s;l++)if(a[l]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(a.slice(a.length-s)))}return Uint8Array.from(t)}},BECH_ALPHABET=chain(alphabet("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join("")),POLYMOD_GENERATORS=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod(e){const t=e>>25;let r=(e&33554431)<<5;for(let n=0;n<POLYMOD_GENERATORS.length;n++)(t>>n&1)===1&&(r^=POLYMOD_GENERATORS[n]);return r}function bechChecksum(e,t,r=1){const n=e.length;let s=1;for(let a=0;a<n;a++){const l=e.charCodeAt(a);if(l<33||l>126)throw new Error(`Invalid prefix (${e})`);s=bech32Polymod(s)^l>>5}s=bech32Polymod(s);for(let a=0;a<n;a++)s=bech32Polymod(s)^e.charCodeAt(a)&31;for(let a of t)s=bech32Polymod(s)^a;for(let a=0;a<6;a++)s=bech32Polymod(s);return s^=r,BECH_ALPHABET.encode(convertRadix2([s%2**30],30,5,!1))}function genBech32(e){const t=e==="bech32"?1:734539939,r=radix2(5),n=r.decode,s=r.encode,a=unsafeWrapper(n);function l(p,g,y=90){if(typeof p!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof p}`);if(!Array.isArray(g)||g.length&&typeof g[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof g}`);const w=p.length+7+g.length;if(y!==!1&&w>y)throw new TypeError(`Length ${w} exceeds limit ${y}`);return p=p.toLowerCase(),`${p}1${BECH_ALPHABET.encode(g)}${bechChecksum(p,g,t)}`}function u(p,g=90){if(typeof p!="string")throw new Error(`bech32.decode input should be string, not ${typeof p}`);if(p.length<8||g!==!1&&p.length>g)throw new TypeError(`Wrong string length: ${p.length} (${p}). Expected (8..${g})`);const y=p.toLowerCase();if(p!==y&&p!==p.toUpperCase())throw new Error("String must be lowercase or uppercase");p=y;const w=p.lastIndexOf("1");if(w===0||w===-1)throw new Error('Letter "1" must be present between prefix and data only');const R=p.slice(0,w),I=p.slice(w+1);if(I.length<6)throw new Error("Data must be at least 6 characters long");const k=BECH_ALPHABET.decode(I).slice(0,-6),je=bechChecksum(R,k,t);if(!I.endsWith(je))throw new Error(`Invalid checksum in ${p}: expected "${je}"`);return{prefix:R,words:k}}const x=unsafeWrapper(u);function f(p){const{prefix:g,words:y}=u(p,!1);return{prefix:g,words:y,bytes:n(y)}}return{encode:l,decode:u,decodeToBytes:f,decodeUnsafe:x,fromWords:n,fromWordsUnsafe:a,toWords:s}}const bech32$1=genBech32("bech32");genBech32("bech32m");const utf8={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},hex=chain(radix2(4),alphabet("0123456789abcdef"),join(""),normalize$1(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),CODERS={utf8,hex,base16,base32,base64,base64url,base58:base58$1,base58xmr};`${Object.keys(CODERS).join(", ")}`;function number$2(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function bool(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function isBytes(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function bytes(e,...t){if(!isBytes(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function exists(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output(e,t){bytes(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),createView=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");const hexes=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex(e){bytes(e);let t="";for(let r=0;r<e.length;r++)t+=hexes[e[r]];return t}const asciis={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16(e){if(e>=asciis._0&&e<=asciis._9)return e-asciis._0;if(e>=asciis._A&&e<=asciis._F)return e-(asciis._A-10);if(e>=asciis._a&&e<=asciis._f)return e-(asciis._a-10)}function hexToBytes$2(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let s=0,a=0;s<r;s++,a+=2){const l=asciiToBase16(e.charCodeAt(a)),u=asciiToBase16(e.charCodeAt(a+1));if(l===void 0||u===void 0){const x=e[a]+e[a+1];throw new Error('hex string expected, got non-hex character "'+x+'" at index '+a)}n[s]=l*16+u}return n}function utf8ToBytes(e){if(typeof e!="string")throw new Error(`string expected, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes(e){if(typeof e=="string")e=utf8ToBytes(e);else if(isBytes(e))e=e.slice();else throw new Error(`Uint8Array expected, got ${typeof e}`);return e}function checkOpts(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function equalBytes(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}const wrapCipher=(e,t)=>(Object.assign(t,e),t);function setBigUint64(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const s=BigInt(32),a=BigInt(4294967295),l=Number(r>>s&a),u=Number(r&a),x=4,f=0;e.setUint32(t+x,l,n),e.setUint32(t+f,u,n)}const BLOCK_SIZE=16,POLY=283;function mul2(e){return e<<1^POLY&-(e>>7)}function mul(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(t&1),e=mul2(e);return r}const sbox=(()=>{let e=new Uint8Array(256);for(let r=0,n=1;r<256;r++,n^=mul2(n))e[r]=n;const t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return t})(),invSbox=sbox.map((e,t)=>sbox.indexOf(t)),rotr32_8=e=>e<<24|e>>>8,rotl32_8=e=>e<<8|e>>>24;function genTtable(e,t){if(e.length!==256)throw new Error("Wrong sbox length");const r=new Uint32Array(256).map((f,p)=>t(e[p])),n=r.map(rotl32_8),s=n.map(rotl32_8),a=s.map(rotl32_8),l=new Uint32Array(256*256),u=new Uint32Array(256*256),x=new Uint16Array(256*256);for(let f=0;f<256;f++)for(let p=0;p<256;p++){const g=f*256+p;l[g]=r[f]^n[p],u[g]=s[f]^a[p],x[g]=e[f]<<8|e[p]}return{sbox:e,sbox2:x,T0:r,T1:n,T2:s,T3:a,T01:l,T23:u}}const tableEncoding=genTtable(sbox,e=>mul(e,3)<<24|e<<16|e<<8|mul(e,2)),tableDecoding=genTtable(invSbox,e=>mul(e,11)<<24|mul(e,13)<<16|mul(e,9)<<8|mul(e,14)),xPowers=(()=>{const e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=mul2(r))e[t]=r;return e})();function expandKeyLE(e){bytes(e);const t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);const{sbox2:r}=tableEncoding,n=u32(e),s=n.length,a=u=>applySbox(r,u,u,u,u),l=new Uint32Array(t+28);l.set(n);for(let u=s;u<l.length;u++){let x=l[u-1];u%s===0?x=a(rotr32_8(x))^xPowers[u/s-1]:s>6&&u%s===4&&(x=a(x)),l[u]=l[u-s]^x}return l}function expandKeyDecLE(e){const t=expandKeyLE(e),r=t.slice(),n=t.length,{sbox2:s}=tableEncoding,{T0:a,T1:l,T2:u,T3:x}=tableDecoding;for(let f=0;f<n;f+=4)for(let p=0;p<4;p++)r[f+p]=t[n-f-4+p];t.fill(0);for(let f=4;f<n-4;f++){const p=r[f],g=applySbox(s,p,p,p,p);r[f]=a[g&255]^l[g>>>8&255]^u[g>>>16&255]^x[g>>>24]}return r}function apply0123(e,t,r,n,s,a){return e[r<<8&65280|n>>>8&255]^t[s>>>8&65280|a>>>24&255]}function applySbox(e,t,r,n,s){return e[t&255|r&65280]|e[n>>>16&255|s>>>16&65280]<<16}function encrypt$3(e,t,r,n,s){const{sbox2:a,T01:l,T23:u}=tableEncoding;let x=0;t^=e[x++],r^=e[x++],n^=e[x++],s^=e[x++];const f=e.length/4-2;for(let R=0;R<f;R++){const I=e[x++]^apply0123(l,u,t,r,n,s),k=e[x++]^apply0123(l,u,r,n,s,t),je=e[x++]^apply0123(l,u,n,s,t,r),Ve=e[x++]^apply0123(l,u,s,t,r,n);t=I,r=k,n=je,s=Ve}const p=e[x++]^applySbox(a,t,r,n,s),g=e[x++]^applySbox(a,r,n,s,t),y=e[x++]^applySbox(a,n,s,t,r),w=e[x++]^applySbox(a,s,t,r,n);return{s0:p,s1:g,s2:y,s3:w}}function decrypt$3(e,t,r,n,s){const{sbox2:a,T01:l,T23:u}=tableDecoding;let x=0;t^=e[x++],r^=e[x++],n^=e[x++],s^=e[x++];const f=e.length/4-2;for(let R=0;R<f;R++){const I=e[x++]^apply0123(l,u,t,s,n,r),k=e[x++]^apply0123(l,u,r,t,s,n),je=e[x++]^apply0123(l,u,n,r,t,s),Ve=e[x++]^apply0123(l,u,s,n,r,t);t=I,r=k,n=je,s=Ve}const p=e[x++]^applySbox(a,t,s,n,r),g=e[x++]^applySbox(a,r,t,s,n),y=e[x++]^applySbox(a,n,r,t,s),w=e[x++]^applySbox(a,s,n,r,t);return{s0:p,s1:g,s2:y,s3:w}}function getDst(e,t){if(!t)return new Uint8Array(e);if(bytes(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function validateBlockDecrypt(e){if(bytes(e),e.length%BLOCK_SIZE!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${BLOCK_SIZE}`)}function validateBlockEncrypt(e,t,r){let n=e.length;const s=n%BLOCK_SIZE;if(!t&&s!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const a=u32(e);if(t){let x=BLOCK_SIZE-s;x||(x=BLOCK_SIZE),n=n+x}const l=getDst(n,r),u=u32(l);return{b:a,o:u,out:l}}function validatePCKS(e,t){if(!t)return e;const r=e.length;if(!r)throw new Error("aes/pcks5: empty ciphertext not allowed");const n=e[r-1];if(n<=0||n>16)throw new Error(`aes/pcks5: wrong padding byte: ${n}`);const s=e.subarray(0,-n);for(let a=0;a<n;a++)if(e[r-a-1]!==n)throw new Error("aes/pcks5: wrong padding");return s}function padPCKS(e){const t=new Uint8Array(16),r=u32(t);t.set(e);const n=BLOCK_SIZE-e.length;for(let s=BLOCK_SIZE-n;s<BLOCK_SIZE;s++)t[s]=n;return r}const cbc=wrapCipher({blockSize:16,nonceLength:16},function(t,r,n={}){bytes(t),bytes(r,16);const s=!n.disablePadding;return{encrypt:(a,l)=>{const u=expandKeyLE(t),{b:x,o:f,out:p}=validateBlockEncrypt(a,s,l),g=u32(r);let y=g[0],w=g[1],R=g[2],I=g[3],k=0;for(;k+4<=x.length;)y^=x[k+0],w^=x[k+1],R^=x[k+2],I^=x[k+3],{s0:y,s1:w,s2:R,s3:I}=encrypt$3(u,y,w,R,I),f[k++]=y,f[k++]=w,f[k++]=R,f[k++]=I;if(s){const je=padPCKS(a.subarray(k*4));y^=je[0],w^=je[1],R^=je[2],I^=je[3],{s0:y,s1:w,s2:R,s3:I}=encrypt$3(u,y,w,R,I),f[k++]=y,f[k++]=w,f[k++]=R,f[k++]=I}return u.fill(0),p},decrypt:(a,l)=>{validateBlockDecrypt(a);const u=expandKeyDecLE(t),x=u32(r),f=getDst(a.length,l),p=u32(a),g=u32(f);let y=x[0],w=x[1],R=x[2],I=x[3];for(let k=0;k+4<=p.length;){const je=y,Ve=w,q=R,$e=I;y=p[k+0],w=p[k+1],R=p[k+2],I=p[k+3];const{s0:We,s1:K,s2:W,s3:Ye}=decrypt$3(u,y,w,R,I);g[k++]=We^je,g[k++]=K^Ve,g[k++]=W^q,g[k++]=Ye^$e}return u.fill(0),validatePCKS(f,s)}}}),u8to16=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class Poly1305{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=toBytes(t),bytes(t,32);const r=u8to16(t,0),n=u8to16(t,2),s=u8to16(t,4),a=u8to16(t,6),l=u8to16(t,8),u=u8to16(t,10),x=u8to16(t,12),f=u8to16(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|a<<9)&8191,this.r[4]=(a>>>4|l<<12)&255,this.r[5]=l>>>1&8190,this.r[6]=(l>>>14|u<<2)&8191,this.r[7]=(u>>>11|x<<5)&8065,this.r[8]=(x>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let p=0;p<8;p++)this.pad[p]=u8to16(t,16+2*p)}process(t,r,n=!1){const s=n?0:2048,{h:a,r:l}=this,u=l[0],x=l[1],f=l[2],p=l[3],g=l[4],y=l[5],w=l[6],R=l[7],I=l[8],k=l[9],je=u8to16(t,r+0),Ve=u8to16(t,r+2),q=u8to16(t,r+4),$e=u8to16(t,r+6),We=u8to16(t,r+8),K=u8to16(t,r+10),W=u8to16(t,r+12),Ye=u8to16(t,r+14);let Qe=a[0]+(je&8191),it=a[1]+((je>>>13|Ve<<3)&8191),ze=a[2]+((Ve>>>10|q<<6)&8191),v=a[3]+((q>>>7|$e<<9)&8191),D=a[4]+(($e>>>4|We<<12)&8191),_e=a[5]+(We>>>1&8191),P=a[6]+((We>>>14|K<<2)&8191),Re=a[7]+((K>>>11|W<<5)&8191),Fe=a[8]+((W>>>8|Ye<<8)&8191),Le=a[9]+(Ye>>>5|s),Ce=0,L=Ce+Qe*u+it*(5*k)+ze*(5*I)+v*(5*R)+D*(5*w);Ce=L>>>13,L&=8191,L+=_e*(5*y)+P*(5*g)+Re*(5*p)+Fe*(5*f)+Le*(5*x),Ce+=L>>>13,L&=8191;let O=Ce+Qe*x+it*u+ze*(5*k)+v*(5*I)+D*(5*R);Ce=O>>>13,O&=8191,O+=_e*(5*w)+P*(5*y)+Re*(5*g)+Fe*(5*p)+Le*(5*f),Ce+=O>>>13,O&=8191;let st=Ce+Qe*f+it*x+ze*u+v*(5*k)+D*(5*I);Ce=st>>>13,st&=8191,st+=_e*(5*R)+P*(5*w)+Re*(5*y)+Fe*(5*g)+Le*(5*p),Ce+=st>>>13,st&=8191;let lt=Ce+Qe*p+it*f+ze*x+v*u+D*(5*k);Ce=lt>>>13,lt&=8191,lt+=_e*(5*I)+P*(5*R)+Re*(5*w)+Fe*(5*y)+Le*(5*g),Ce+=lt>>>13,lt&=8191;let Xe=Ce+Qe*g+it*p+ze*f+v*x+D*u;Ce=Xe>>>13,Xe&=8191,Xe+=_e*(5*k)+P*(5*I)+Re*(5*R)+Fe*(5*w)+Le*(5*y),Ce+=Xe>>>13,Xe&=8191;let dt=Ce+Qe*y+it*g+ze*p+v*f+D*x;Ce=dt>>>13,dt&=8191,dt+=_e*u+P*(5*k)+Re*(5*I)+Fe*(5*R)+Le*(5*w),Ce+=dt>>>13,dt&=8191;let er=Ce+Qe*w+it*y+ze*g+v*p+D*f;Ce=er>>>13,er&=8191,er+=_e*x+P*u+Re*(5*k)+Fe*(5*I)+Le*(5*R),Ce+=er>>>13,er&=8191;let ar=Ce+Qe*R+it*w+ze*y+v*g+D*p;Ce=ar>>>13,ar&=8191,ar+=_e*f+P*x+Re*u+Fe*(5*k)+Le*(5*I),Ce+=ar>>>13,ar&=8191;let dr=Ce+Qe*I+it*R+ze*w+v*y+D*g;Ce=dr>>>13,dr&=8191,dr+=_e*p+P*f+Re*x+Fe*u+Le*(5*k),Ce+=dr>>>13,dr&=8191;let ir=Ce+Qe*k+it*I+ze*R+v*w+D*y;Ce=ir>>>13,ir&=8191,ir+=_e*g+P*p+Re*f+Fe*x+Le*u,Ce+=ir>>>13,ir&=8191,Ce=(Ce<<2)+Ce|0,Ce=Ce+L|0,L=Ce&8191,Ce=Ce>>>13,O+=Ce,a[0]=L,a[1]=O,a[2]=st,a[3]=lt,a[4]=Xe,a[5]=dt,a[6]=er,a[7]=ar,a[8]=dr,a[9]=ir}finalize(){const{h:t,pad:r}=this,n=new Uint16Array(10);let s=t[1]>>>13;t[1]&=8191;for(let u=2;u<10;u++)t[u]+=s,s=t[u]>>>13,t[u]&=8191;t[0]+=s*5,s=t[0]>>>13,t[0]&=8191,t[1]+=s,s=t[1]>>>13,t[1]&=8191,t[2]+=s,n[0]=t[0]+5,s=n[0]>>>13,n[0]&=8191;for(let u=1;u<10;u++)n[u]=t[u]+s,s=n[u]>>>13,n[u]&=8191;n[9]-=8192;let a=(s^1)-1;for(let u=0;u<10;u++)n[u]&=a;a=~a;for(let u=0;u<10;u++)t[u]=t[u]&a|n[u];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let l=t[0]+r[0];t[0]=l&65535;for(let u=1;u<8;u++)l=(t[u]+r[u]|0)+(l>>>16)|0,t[u]=l&65535}update(t){exists(this);const{buffer:r,blockLen:n}=this;t=toBytes(t);const s=t.length;for(let a=0;a<s;){const l=Math.min(n-this.pos,s-a);if(l===n){for(;n<=s-a;a+=n)this.process(t,a);continue}r.set(t.subarray(a,a+l),this.pos),this.pos+=l,a+=l,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){exists(this),output(t,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:s}=this;if(s){for(r[s++]=1;s<16;s++)r[s]=0;this.process(r,0,!0)}this.finalize();let a=0;for(let l=0;l<8;l++)t[a++]=n[l]>>>0,t[a++]=n[l]>>>8;return t}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}}function wrapConstructorWithKey(e){const t=(n,s)=>e(s).update(toBytes(n)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}const poly1305=wrapConstructorWithKey(e=>new Poly1305(e)),_utf8ToBytes=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),sigma16=_utf8ToBytes("expand 16-byte k"),sigma32=_utf8ToBytes("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32);sigma32_32.slice();function rotl$1(e,t){return e<<t|e>>>32-t}function isAligned32(e){return e.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(e,t,r,n,s,a,l,u){const x=s.length,f=new Uint8Array(BLOCK_LEN),p=u32(f),g=isAligned32(s)&&isAligned32(a),y=g?u32(s):U32_EMPTY,w=g?u32(a):U32_EMPTY;for(let R=0;R<x;l++){if(e(t,r,n,p,l,u),l>=MAX_COUNTER)throw new Error("arx: counter overflow");const I=Math.min(BLOCK_LEN,x-R);if(g&&I===BLOCK_LEN){const k=R/4;if(R%4!==0)throw new Error("arx: invalid block position");for(let je=0,Ve;je<BLOCK_LEN32;je++)Ve=k+je,w[Ve]=y[Ve]^p[je];R+=BLOCK_LEN;continue}for(let k=0,je;k<I;k++)je=R+k,a[je]=s[je]^f[k];R+=I}}function createCipher(e,t){const{allowShortKeys:r,extendNonceFn:n,counterLength:s,counterRight:a,rounds:l}=checkOpts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return number$2(s),number$2(l),bool(a),bool(r),(u,x,f,p,g=0)=>{bytes(u),bytes(x),bytes(f);const y=f.length;if(p||(p=new Uint8Array(y)),bytes(p),number$2(g),g<0||g>=MAX_COUNTER)throw new Error("arx: counter overflow");if(p.length<y)throw new Error(`arx: output (${p.length}) is shorter than data (${y})`);const w=[];let R=u.length,I,k;if(R===32)I=u.slice(),w.push(I),k=sigma32_32;else if(R===16&&r)I=new Uint8Array(32),I.set(u),I.set(u,16),k=sigma16_32,w.push(I);else throw new Error(`arx: invalid 32-byte key, got length=${R}`);isAligned32(x)||(x=x.slice(),w.push(x));const je=u32(I);if(n){if(x.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(k,je,u32(x.subarray(0,16)),je),x=x.subarray(16)}const Ve=16-s;if(Ve!==x.length)throw new Error(`arx: nonce must be ${Ve} or 16 bytes`);if(Ve!==12){const $e=new Uint8Array(12);$e.set(x,a?0:12-x.length),x=$e,w.push(x)}const q=u32(x);for(runCipher(e,k,je,q,f,p,g,l);w.length>0;)w.pop().fill(0);return p}}function chachaCore(e,t,r,n,s,a=20){let l=e[0],u=e[1],x=e[2],f=e[3],p=t[0],g=t[1],y=t[2],w=t[3],R=t[4],I=t[5],k=t[6],je=t[7],Ve=s,q=r[0],$e=r[1],We=r[2],K=l,W=u,Ye=x,Qe=f,it=p,ze=g,v=y,D=w,_e=R,P=I,Re=k,Fe=je,Le=Ve,Ce=q,L=$e,O=We;for(let lt=0;lt<a;lt+=2)K=K+it|0,Le=rotl$1(Le^K,16),_e=_e+Le|0,it=rotl$1(it^_e,12),K=K+it|0,Le=rotl$1(Le^K,8),_e=_e+Le|0,it=rotl$1(it^_e,7),W=W+ze|0,Ce=rotl$1(Ce^W,16),P=P+Ce|0,ze=rotl$1(ze^P,12),W=W+ze|0,Ce=rotl$1(Ce^W,8),P=P+Ce|0,ze=rotl$1(ze^P,7),Ye=Ye+v|0,L=rotl$1(L^Ye,16),Re=Re+L|0,v=rotl$1(v^Re,12),Ye=Ye+v|0,L=rotl$1(L^Ye,8),Re=Re+L|0,v=rotl$1(v^Re,7),Qe=Qe+D|0,O=rotl$1(O^Qe,16),Fe=Fe+O|0,D=rotl$1(D^Fe,12),Qe=Qe+D|0,O=rotl$1(O^Qe,8),Fe=Fe+O|0,D=rotl$1(D^Fe,7),K=K+ze|0,O=rotl$1(O^K,16),Re=Re+O|0,ze=rotl$1(ze^Re,12),K=K+ze|0,O=rotl$1(O^K,8),Re=Re+O|0,ze=rotl$1(ze^Re,7),W=W+v|0,Le=rotl$1(Le^W,16),Fe=Fe+Le|0,v=rotl$1(v^Fe,12),W=W+v|0,Le=rotl$1(Le^W,8),Fe=Fe+Le|0,v=rotl$1(v^Fe,7),Ye=Ye+D|0,Ce=rotl$1(Ce^Ye,16),_e=_e+Ce|0,D=rotl$1(D^_e,12),Ye=Ye+D|0,Ce=rotl$1(Ce^Ye,8),_e=_e+Ce|0,D=rotl$1(D^_e,7),Qe=Qe+it|0,L=rotl$1(L^Qe,16),P=P+L|0,it=rotl$1(it^P,12),Qe=Qe+it|0,L=rotl$1(L^Qe,8),P=P+L|0,it=rotl$1(it^P,7);let st=0;n[st++]=l+K|0,n[st++]=u+W|0,n[st++]=x+Ye|0,n[st++]=f+Qe|0,n[st++]=p+it|0,n[st++]=g+ze|0,n[st++]=y+v|0,n[st++]=w+D|0,n[st++]=R+_e|0,n[st++]=I+P|0,n[st++]=k+Re|0,n[st++]=je+Fe|0,n[st++]=Ve+Le|0,n[st++]=q+Ce|0,n[st++]=$e+L|0,n[st++]=We+O|0}function hchacha(e,t,r,n){let s=e[0],a=e[1],l=e[2],u=e[3],x=t[0],f=t[1],p=t[2],g=t[3],y=t[4],w=t[5],R=t[6],I=t[7],k=r[0],je=r[1],Ve=r[2],q=r[3];for(let We=0;We<20;We+=2)s=s+x|0,k=rotl$1(k^s,16),y=y+k|0,x=rotl$1(x^y,12),s=s+x|0,k=rotl$1(k^s,8),y=y+k|0,x=rotl$1(x^y,7),a=a+f|0,je=rotl$1(je^a,16),w=w+je|0,f=rotl$1(f^w,12),a=a+f|0,je=rotl$1(je^a,8),w=w+je|0,f=rotl$1(f^w,7),l=l+p|0,Ve=rotl$1(Ve^l,16),R=R+Ve|0,p=rotl$1(p^R,12),l=l+p|0,Ve=rotl$1(Ve^l,8),R=R+Ve|0,p=rotl$1(p^R,7),u=u+g|0,q=rotl$1(q^u,16),I=I+q|0,g=rotl$1(g^I,12),u=u+g|0,q=rotl$1(q^u,8),I=I+q|0,g=rotl$1(g^I,7),s=s+f|0,q=rotl$1(q^s,16),R=R+q|0,f=rotl$1(f^R,12),s=s+f|0,q=rotl$1(q^s,8),R=R+q|0,f=rotl$1(f^R,7),a=a+p|0,k=rotl$1(k^a,16),I=I+k|0,p=rotl$1(p^I,12),a=a+p|0,k=rotl$1(k^a,8),I=I+k|0,p=rotl$1(p^I,7),l=l+g|0,je=rotl$1(je^l,16),y=y+je|0,g=rotl$1(g^y,12),l=l+g|0,je=rotl$1(je^l,8),y=y+je|0,g=rotl$1(g^y,7),u=u+x|0,Ve=rotl$1(Ve^u,16),w=w+Ve|0,x=rotl$1(x^w,12),u=u+x|0,Ve=rotl$1(Ve^u,8),w=w+Ve|0,x=rotl$1(x^w,7);let $e=0;n[$e++]=s,n[$e++]=a,n[$e++]=l,n[$e++]=u,n[$e++]=k,n[$e++]=je,n[$e++]=Ve,n[$e++]=q}const chacha20=createCipher(chachaCore,{counterRight:!1,counterLength:4,allowShortKeys:!1}),xchacha20=createCipher(chachaCore,{counterRight:!1,counterLength:8,extendNonceFn:hchacha,allowShortKeys:!1}),ZEROS16=new Uint8Array(16),updatePadded=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(ZEROS16.subarray(r))},ZEROS32=new Uint8Array(32);function computeTag(e,t,r,n,s){const a=e(t,r,ZEROS32),l=poly1305.create(a);s&&updatePadded(l,s),updatePadded(l,n);const u=new Uint8Array(16),x=createView(u);setBigUint64(x,0,BigInt(s?s.length:0),!0),setBigUint64(x,8,BigInt(n.length),!0),l.update(u);const f=l.digest();return a.fill(0),f}const _poly1305_aead=e=>(t,r,n)=>(bytes(t,32),bytes(r),{encrypt:(a,l)=>{const u=a.length,x=u+16;l?bytes(l,x):l=new Uint8Array(x),e(t,r,a,l,1);const f=computeTag(e,t,r,l.subarray(0,-16),n);return l.set(f,u),l},decrypt:(a,l)=>{const u=a.length,x=u-16;if(u<16)throw new Error("encrypted data must be at least 16 bytes");l?bytes(l,x):l=new Uint8Array(x);const f=a.subarray(0,-16),p=a.subarray(-16),g=computeTag(e,t,r,f,n);if(!equalBytes(p,g))throw new Error("invalid tag");return e(t,r,f,l,1),l}}),xchacha20poly1305=wrapCipher({blockSize:64,nonceLength:24,tagLength:16},_poly1305_aead(xchacha20));class HMAC extends Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,assert$3.hash(t);const n=toBytes$1(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(n.length>s?t.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=t.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),a.fill(0)}update(t){return assert$3.exists(this),this.iHash.update(t),this}digestInto(t){assert$3.exists(this),assert$3.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=s,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac$1=(e,t,r)=>new HMAC(e,t).update(r).digest();hmac$1.create=(e,t)=>new HMAC(e,t);function extract(e,t,r){return assert$3.hash(e),hmac$1(e,toBytes$1(r),toBytes$1(t))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER$3=new Uint8Array;function expand(e,t,r,n=32){if(assert$3.hash(e),assert$3.number(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/e.outputLen);r===void 0&&(r=EMPTY_BUFFER$3);const a=new Uint8Array(s*e.outputLen),l=hmac$1.create(e,t),u=l._cloneInto(),x=new Uint8Array(l.outputLen);for(let f=0;f<s;f++)HKDF_COUNTER[0]=f+1,u.update(f===0?EMPTY_BUFFER$3:x).update(r).update(HKDF_COUNTER).digestInto(x),a.set(x,e.outputLen*f),l._cloneInto(u);return l.destroy(),u.destroy(),x.fill(0),HKDF_COUNTER.fill(0),a.slice(0,n)}var __defProp$2=Object.defineProperty,__export=(e,t)=>{for(var r in t)__defProp$2(e,r,{get:t[r],enumerable:!0})},verifiedSymbol=Symbol("verified"),isRecord=e=>e instanceof Object;function validateEvent(e){if(!isRecord(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let r=e.tags[t];if(!Array.isArray(r))return!1;for(let n=0;n<r.length;n++)if(typeof r[n]!="string")return!1}return!0}var utils_exports={};__export(utils_exports,{Queue:()=>Queue$1,QueueNode:()=>QueueNode,binarySearch:()=>binarySearch,bytesToHex:()=>bytesToHex$1,hexToBytes:()=>hexToBytes$3,insertEventIntoAscendingList:()=>insertEventIntoAscendingList,insertEventIntoDescendingList:()=>insertEventIntoDescendingList,normalizeURL:()=>normalizeURL,utf8Decoder:()=>utf8Decoder$1,utf8Encoder:()=>utf8Encoder$1});var utf8Decoder$1=new TextDecoder("utf-8"),utf8Encoder$1=new TextEncoder;function normalizeURL(e){try{e.indexOf("://")===-1&&(e="wss://"+e);let t=new URL(e);return t.protocol==="http:"?t.protocol="ws:":t.protocol==="https:"&&(t.protocol="wss:"),t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}catch{throw new Error(`Invalid URL: ${e}`)}}function insertEventIntoDescendingList(e,t){const[r,n]=binarySearch(e,s=>t.id===s.id?0:t.created_at===s.created_at?-1:s.created_at-t.created_at);return n||e.splice(r,0,t),e}function insertEventIntoAscendingList(e,t){const[r,n]=binarySearch(e,s=>t.id===s.id?0:t.created_at===s.created_at?-1:t.created_at-s.created_at);return n||e.splice(r,0,t),e}function binarySearch(e,t){let r=0,n=e.length-1;for(;r<=n;){const s=Math.floor((r+n)/2),a=t(e[s]);if(a===0)return[s,!0];a<0?n=s-1:r=s+1}return[r,!1]}var QueueNode=class{value;next=null;prev=null;constructor(e){this.value=e}},Queue$1=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const r=new QueueNode(t);return this.last?this.last===this.first?(this.last=r,this.last.prev=this.first,this.first.next=r):(r.prev=this.last,this.last.next=r,this.last=r):(this.first=r,this.last=r),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const r=this.first;return this.first=null,this.last=null,r.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}},JS=class{generateSecretKey(){return schnorr.utils.randomPrivateKey()}getPublicKey(e){return bytesToHex$1(schnorr.getPublicKey(e))}finalizeEvent(e,t){const r=e;return r.pubkey=bytesToHex$1(schnorr.getPublicKey(t)),r.id=getEventHash$1(r),r.sig=bytesToHex$1(schnorr.sign(getEventHash$1(r),t)),r[verifiedSymbol]=!0,r}verifyEvent(e){if(typeof e[verifiedSymbol]=="boolean")return e[verifiedSymbol];const t=getEventHash$1(e);if(t!==e.id)return e[verifiedSymbol]=!1,!1;try{const r=schnorr.verify(e.sig,t,e.pubkey);return e[verifiedSymbol]=r,r}catch{return e[verifiedSymbol]=!1,!1}}};function serializeEvent(e){if(!validateEvent(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function getEventHash$1(e){let t=sha256$1(utf8Encoder$1.encode(serializeEvent(e)));return bytesToHex$1(t)}var i$1=new JS,generateSecretKey=i$1.generateSecretKey,getPublicKey=i$1.getPublicKey,finalizeEvent=i$1.finalizeEvent,verifyEvent=i$1.verifyEvent,kinds_exports={};__export(kinds_exports,{Application:()=>Application,BadgeAward:()=>BadgeAward,BadgeDefinition:()=>BadgeDefinition,BlockedRelaysList:()=>BlockedRelaysList,BookmarkList:()=>BookmarkList,Bookmarksets:()=>Bookmarksets,Calendar:()=>Calendar,CalendarEventRSVP:()=>CalendarEventRSVP,ChannelCreation:()=>ChannelCreation,ChannelHideMessage:()=>ChannelHideMessage,ChannelMessage:()=>ChannelMessage,ChannelMetadata:()=>ChannelMetadata,ChannelMuteUser:()=>ChannelMuteUser,ClassifiedListing:()=>ClassifiedListing,ClientAuth:()=>ClientAuth,CommunitiesList:()=>CommunitiesList,CommunityDefinition:()=>CommunityDefinition,CommunityPostApproval:()=>CommunityPostApproval,Contacts:()=>Contacts,CreateOrUpdateProduct:()=>CreateOrUpdateProduct,CreateOrUpdateStall:()=>CreateOrUpdateStall,Curationsets:()=>Curationsets,Date:()=>Date2,DirectMessageRelaysList:()=>DirectMessageRelaysList,DraftClassifiedListing:()=>DraftClassifiedListing,DraftLong:()=>DraftLong,Emojisets:()=>Emojisets,EncryptedDirectMessage:()=>EncryptedDirectMessage,EventDeletion:()=>EventDeletion,FileMetadata:()=>FileMetadata,FileServerPreference:()=>FileServerPreference,Followsets:()=>Followsets,GenericRepost:()=>GenericRepost,Genericlists:()=>Genericlists,GiftWrap:()=>GiftWrap,HTTPAuth:()=>HTTPAuth,Handlerinformation:()=>Handlerinformation,Handlerrecommendation:()=>Handlerrecommendation,Highlights:()=>Highlights,InterestsList:()=>InterestsList,Interestsets:()=>Interestsets,JobFeedback:()=>JobFeedback,JobRequest:()=>JobRequest,JobResult:()=>JobResult,Label:()=>Label,LightningPubRPC:()=>LightningPubRPC,LiveChatMessage:()=>LiveChatMessage,LiveEvent:()=>LiveEvent,LongFormArticle:()=>LongFormArticle,Metadata:()=>Metadata,Mutelist:()=>Mutelist,NWCWalletInfo:()=>NWCWalletInfo,NWCWalletRequest:()=>NWCWalletRequest,NWCWalletResponse:()=>NWCWalletResponse,NostrConnect:()=>NostrConnect,OpenTimestamps:()=>OpenTimestamps,Pinlist:()=>Pinlist,PrivateDirectMessage:()=>PrivateDirectMessage,ProblemTracker:()=>ProblemTracker,ProfileBadges:()=>ProfileBadges,PublicChatsList:()=>PublicChatsList,Reaction:()=>Reaction,RecommendRelay:()=>RecommendRelay,RelayList:()=>RelayList,Relaysets:()=>Relaysets,Report:()=>Report,Reporting:()=>Reporting,Repost:()=>Repost,Seal:()=>Seal,SearchRelaysList:()=>SearchRelaysList,ShortTextNote:()=>ShortTextNote,Time:()=>Time,UserEmojiList:()=>UserEmojiList,UserStatuses:()=>UserStatuses,Zap:()=>Zap$1,ZapGoal:()=>ZapGoal,ZapRequest:()=>ZapRequest,classifyKind:()=>classifyKind,isAddressableKind:()=>isAddressableKind,isEphemeralKind:()=>isEphemeralKind,isKind:()=>isKind,isRegularKind:()=>isRegularKind,isReplaceableKind:()=>isReplaceableKind});function isRegularKind(e){return e<1e4&&e!==0&&e!==3}function isReplaceableKind(e){return e===0||e===3||1e4<=e&&e<2e4}function isEphemeralKind(e){return 2e4<=e&&e<3e4}function isAddressableKind(e){return 3e4<=e&&e<4e4}function classifyKind(e){return isRegularKind(e)?"regular":isReplaceableKind(e)?"replaceable":isEphemeralKind(e)?"ephemeral":isAddressableKind(e)?"parameterized":"unknown"}function isKind(e,t){const r=t instanceof Array?t:[t];return validateEvent(e)&&r.includes(e.kind)||!1}var Metadata=0,ShortTextNote=1,RecommendRelay=2,Contacts=3,EncryptedDirectMessage=4,EventDeletion=5,Repost=6,Reaction=7,BadgeAward=8,Seal=13,PrivateDirectMessage=14,GenericRepost=16,ChannelCreation=40,ChannelMetadata=41,ChannelMessage=42,ChannelHideMessage=43,ChannelMuteUser=44,OpenTimestamps=1040,GiftWrap=1059,FileMetadata=1063,LiveChatMessage=1311,ProblemTracker=1971,Report=1984,Reporting=1984,Label=1985,CommunityPostApproval=4550,JobRequest=5999,JobResult=6999,JobFeedback=7e3,ZapGoal=9041,ZapRequest=9734,Zap$1=9735,Highlights=9802,Mutelist=1e4,Pinlist=10001,RelayList=10002,BookmarkList=10003,CommunitiesList=10004,PublicChatsList=10005,BlockedRelaysList=10006,SearchRelaysList=10007,InterestsList=10015,UserEmojiList=10030,DirectMessageRelaysList=10050,FileServerPreference=10096,NWCWalletInfo=13194,LightningPubRPC=21e3,ClientAuth=22242,NWCWalletRequest=23194,NWCWalletResponse=23195,NostrConnect=24133,HTTPAuth=27235,Followsets=3e4,Genericlists=30001,Relaysets=30002,Bookmarksets=30003,Curationsets=30004,ProfileBadges=30008,BadgeDefinition=30009,Interestsets=30015,CreateOrUpdateStall=30017,CreateOrUpdateProduct=30018,LongFormArticle=30023,DraftLong=30024,Emojisets=30030,Application=30078,LiveEvent=30311,UserStatuses=30315,ClassifiedListing=30402,DraftClassifiedListing=30403,Date2=31922,Time=31923,Calendar=31924,CalendarEventRSVP=31925,Handlerrecommendation=31989,Handlerinformation=31990,CommunityDefinition=34550;function matchFilter(e,t){if(e.ids&&e.ids.indexOf(t.id)===-1||e.kinds&&e.kinds.indexOf(t.kind)===-1||e.authors&&e.authors.indexOf(t.pubkey)===-1)return!1;for(let r in e)if(r[0]==="#"){let n=r.slice(1),s=e[`#${n}`];if(s&&!t.tags.find(([a,l])=>a===r.slice(1)&&s.indexOf(l)!==-1))return!1}return!(e.since&&t.created_at<e.since||e.until&&t.created_at>e.until)}function matchFilters(e,t){for(let r=0;r<e.length;r++)if(matchFilter(e[r],t))return!0;return!1}var fakejson_exports={};__export(fakejson_exports,{getHex64:()=>getHex64,getInt:()=>getInt,getSubscriptionId:()=>getSubscriptionId,matchEventId:()=>matchEventId,matchEventKind:()=>matchEventKind,matchEventPubkey:()=>matchEventPubkey});function getHex64(e,t){let r=t.length+3,n=e.indexOf(`"${t}":`)+r,s=e.slice(n).indexOf('"')+n+1;return e.slice(s,s+64)}function getInt(e,t){let r=t.length,n=e.indexOf(`"${t}":`)+r+3,s=e.slice(n),a=Math.min(s.indexOf(","),s.indexOf("}"));return parseInt(s.slice(0,a),10)}function getSubscriptionId(e){let t=e.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let r=e.slice(t+7+1).indexOf('"');if(r===-1)return null;let n=t+7+1+r,s=e.slice(n+1,80).indexOf('"');if(s===-1)return null;let a=n+1+s;return e.slice(n+1,a)}function matchEventId(e,t){return t===getHex64(e,"id")}function matchEventPubkey(e,t){return t===getHex64(e,"pubkey")}function matchEventKind(e,t){return t===getInt(e,"kind")}var nip42_exports={};__export(nip42_exports,{makeAuthEvent:()=>makeAuthEvent});function makeAuthEvent(e,t){return{kind:ClientAuth,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}var _WebSocket;try{_WebSocket=WebSocket}catch{}var _WebSocket2;try{_WebSocket2=WebSocket}catch{}var nip19_exports$1={};__export(nip19_exports$1,{BECH32_REGEX:()=>BECH32_REGEX$2,Bech32MaxSize:()=>Bech32MaxSize$2,NostrTypeGuard:()=>NostrTypeGuard$1,decode:()=>decode$k,decodeNostrURI:()=>decodeNostrURI$1,encodeBytes:()=>encodeBytes$2,naddrEncode:()=>naddrEncode$1,neventEncode:()=>neventEncode$1,noteEncode:()=>noteEncode$1,nprofileEncode:()=>nprofileEncode$1,npubEncode:()=>npubEncode$1,nsecEncode:()=>nsecEncode$1});var NostrTypeGuard$1={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},Bech32MaxSize$2=5e3,BECH32_REGEX$2=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array$1(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function decodeNostrURI$1(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),decode$k(e)}catch{return{type:"invalid",data:null}}}function decode$k(e){let{prefix:t,words:r}=bech32$1.decode(e,Bech32MaxSize$2),n=new Uint8Array(bech32$1.fromWords(r));switch(t){case"nprofile":{let s=parseTLV$1(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(s[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$1(s[0][0]),relays:s[1]?s[1].map(a=>utf8Decoder$1.decode(a)):[]}}}case"nevent":{let s=parseTLV$1(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for nevent");if(s[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(s[2]&&s[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(s[3]&&s[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$1(s[0][0]),relays:s[1]?s[1].map(a=>utf8Decoder$1.decode(a)):[],author:s[2]?.[0]?bytesToHex$1(s[2][0]):void 0,kind:s[3]?.[0]?parseInt(bytesToHex$1(s[3][0]),16):void 0}}}case"naddr":{let s=parseTLV$1(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!s[2]?.[0])throw new Error("missing TLV 2 for naddr");if(s[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!s[3]?.[0])throw new Error("missing TLV 3 for naddr");if(s[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder$1.decode(s[0][0]),pubkey:bytesToHex$1(s[2][0]),kind:parseInt(bytesToHex$1(s[3][0]),16),relays:s[1]?s[1].map(a=>utf8Decoder$1.decode(a)):[]}}}case"nsec":return{type:t,data:n};case"npub":case"note":return{type:t,data:bytesToHex$1(n)};default:throw new Error(`unknown prefix ${t}`)}}function parseTLV$1(e){let t={},r=e;for(;r.length>0;){let n=r[0],s=r[1],a=r.slice(2,2+s);if(r=r.slice(2+s),a.length<s)throw new Error(`not enough data to read on TLV ${n}`);t[n]=t[n]||[],t[n].push(a)}return t}function nsecEncode$1(e){return encodeBytes$2("nsec",e)}function npubEncode$1(e){return encodeBytes$2("npub",hexToBytes$3(e))}function noteEncode$1(e){return encodeBytes$2("note",hexToBytes$3(e))}function encodeBech32$2(e,t){let r=bech32$1.toWords(t);return bech32$1.encode(e,r,Bech32MaxSize$2)}function encodeBytes$2(e,t){return encodeBech32$2(e,t)}function nprofileEncode$1(e){let t=encodeTLV$1({0:[hexToBytes$3(e.pubkey)],1:(e.relays||[]).map(r=>utf8Encoder$1.encode(r))});return encodeBech32$2("nprofile",t)}function neventEncode$1(e){let t;e.kind!==void 0&&(t=integerToUint8Array$1(e.kind));let r=encodeTLV$1({0:[hexToBytes$3(e.id)],1:(e.relays||[]).map(n=>utf8Encoder$1.encode(n)),2:e.author?[hexToBytes$3(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return encodeBech32$2("nevent",r)}function naddrEncode$1(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let r=encodeTLV$1({0:[utf8Encoder$1.encode(e.identifier)],1:(e.relays||[]).map(n=>utf8Encoder$1.encode(n)),2:[hexToBytes$3(e.pubkey)],3:[new Uint8Array(t)]});return encodeBech32$2("naddr",r)}function encodeTLV$1(e){let t=[];return Object.entries(e).reverse().forEach(([r,n])=>{n.forEach(s=>{let a=new Uint8Array(s.length+2);a.set([parseInt(r)],0),a.set([s.length],1),a.set(s,2),t.push(a)})}),concatBytes(...t)}var nip04_exports={};__export(nip04_exports,{decrypt:()=>decrypt$2,encrypt:()=>encrypt$2});function encrypt$2(e,t,r){const n=e instanceof Uint8Array?bytesToHex$1(e):e,s=secp256k1$1.getSharedSecret(n,"02"+t),a=getNormalizedX(s);let l=Uint8Array.from(randomBytes(16)),u=utf8Encoder$1.encode(r),x=cbc(a,l).encrypt(u),f=base64.encode(new Uint8Array(x)),p=base64.encode(new Uint8Array(l.buffer));return`${f}?iv=${p}`}function decrypt$2(e,t,r){const n=e instanceof Uint8Array?bytesToHex$1(e):e;let[s,a]=r.split("?iv="),l=secp256k1$1.getSharedSecret(n,"02"+t),u=getNormalizedX(l),x=base64.decode(a),f=base64.decode(s),p=cbc(u,x).decrypt(f);return utf8Decoder$1.decode(p)}function getNormalizedX(e){return e.slice(1,33)}var nip05_exports={};__export(nip05_exports,{NIP05_REGEX:()=>NIP05_REGEX$1,isNip05:()=>isNip05,isValid:()=>isValid,queryProfile:()=>queryProfile,searchDomain:()=>searchDomain,useFetchImplementation:()=>useFetchImplementation});var NIP05_REGEX$1=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,isNip05=e=>NIP05_REGEX$1.test(e||""),_fetch;try{_fetch=fetch}catch{}function useFetchImplementation(e){_fetch=e}async function searchDomain(e,t=""){try{const r=`https://${e}/.well-known/nostr.json?name=${t}`,n=await _fetch(r,{redirect:"manual"});if(n.status!==200)throw Error("Wrong response code");return(await n.json()).names}catch{return{}}}async function queryProfile(e){const t=e.match(NIP05_REGEX$1);if(!t)return null;const[,r="_",n]=t;try{const s=`https://${n}/.well-known/nostr.json?name=${r}`,a=await _fetch(s,{redirect:"manual"});if(a.status!==200)throw Error("Wrong response code");const l=await a.json(),u=l.names[r];return u?{pubkey:u,relays:l.relays?.[u]}:null}catch{return null}}async function isValid(e,t){const r=await queryProfile(t);return r?r.pubkey===e:!1}var nip10_exports={};__export(nip10_exports,{parse:()=>parse$2});function parse$2(e){const t={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let r,n;for(let s=e.tags.length-1;s>=0;s--){const a=e.tags[s];if(a[0]==="e"&&a[1]){const[l,u,x,f,p]=a,g={id:u,relays:x?[x]:[],author:p};if(f==="root"){t.root=g;continue}if(f==="reply"){t.reply=g;continue}if(f==="mention"){t.mentions.push(g);continue}r?n=g:r=g,t.mentions.push(g);continue}if(a[0]==="q"&&a[1]){const[l,u,x]=a;t.quotes.push({id:u,relays:x?[x]:[]})}if(a[0]==="p"&&a[1]){t.profiles.push({pubkey:a[1],relays:a[2]?[a[2]]:[]});continue}}return t.root||(t.root=n||r||t.reply),t.reply||(t.reply=r||t.root),[t.reply,t.root].forEach(s=>{if(!s)return;let a=t.mentions.indexOf(s);if(a!==-1&&t.mentions.splice(a,1),s.author){let l=t.profiles.find(u=>u.pubkey===s.author);l&&l.relays&&(s.relays||(s.relays=[]),l.relays.forEach(u=>{s.relays?.indexOf(u)===-1&&s.relays.push(u)}),l.relays=s.relays)}}),t.mentions.forEach(s=>{if(s.author){let a=t.profiles.find(l=>l.pubkey===s.author);a&&a.relays&&(s.relays||(s.relays=[]),a.relays.forEach(l=>{s.relays.indexOf(l)===-1&&s.relays.push(l)}),a.relays=s.relays)}}),t}var nip11_exports={};__export(nip11_exports,{fetchRelayInformation:()=>fetchRelayInformation$1,useFetchImplementation:()=>useFetchImplementation2});var _fetch2;try{_fetch2=fetch}catch{}function useFetchImplementation2(e){_fetch2=e}async function fetchRelayInformation$1(e){return await(await fetch(e.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var nip13_exports={};__export(nip13_exports,{fastEventHash:()=>fastEventHash,getPow:()=>getPow,minePow:()=>minePow});function getPow(e){let t=0;for(let r=0;r<64;r+=8){const n=parseInt(e.substring(r,r+8),16);if(n===0)t+=32;else{t+=Math.clz32(n);break}}return t}function minePow(e,t){let r=0;const n=e,s=["nonce",r.toString(),t.toString()];for(n.tags.push(s);;){const a=Math.floor(new Date().getTime()/1e3);if(a!==n.created_at&&(r=0,n.created_at=a),s[1]=(++r).toString(),n.id=fastEventHash(n),getPow(n.id)>=t)break}return n}function fastEventHash(e){return bytesToHex$1(sha256$1(utf8Encoder$1.encode(JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content]))))}var nip17_exports={};__export(nip17_exports,{unwrapEvent:()=>unwrapEvent2,unwrapManyEvents:()=>unwrapManyEvents2,wrapEvent:()=>wrapEvent2,wrapManyEvents:()=>wrapManyEvents2});var nip59_exports={};__export(nip59_exports,{createRumor:()=>createRumor,createSeal:()=>createSeal,createWrap:()=>createWrap,unwrapEvent:()=>unwrapEvent,unwrapManyEvents:()=>unwrapManyEvents,wrapEvent:()=>wrapEvent$1,wrapManyEvents:()=>wrapManyEvents});var nip44_exports={};__export(nip44_exports,{decrypt:()=>decrypt2,encrypt:()=>encrypt2,getConversationKey:()=>getConversationKey,v2:()=>v2});var minPlaintextSize=1,maxPlaintextSize=65535;function getConversationKey(e,t){const r=secp256k1$1.getSharedSecret(e,"02"+t).subarray(1,33);return extract(sha256$1,r,"nip44-v2")}function getMessageKeys(e,t){const r=expand(sha256$1,e,t,76);return{chacha_key:r.subarray(0,32),chacha_nonce:r.subarray(32,44),hmac_key:r.subarray(44,76)}}function calcPaddedLen(e){if(!Number.isSafeInteger(e)||e<1)throw new Error("expected positive integer");if(e<=32)return 32;const t=1<<Math.floor(Math.log2(e-1))+1,r=t<=256?32:t/8;return r*(Math.floor((e-1)/r)+1)}function writeU16BE(e){if(!Number.isSafeInteger(e)||e<minPlaintextSize||e>maxPlaintextSize)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function pad(e){const t=utf8Encoder$1.encode(e),r=t.length,n=writeU16BE(r),s=new Uint8Array(calcPaddedLen(r)-r);return concatBytes(n,t,s)}function unpad(e){const t=new DataView(e.buffer).getUint16(0),r=e.subarray(2,2+t);if(t<minPlaintextSize||t>maxPlaintextSize||r.length!==t||e.length!==2+calcPaddedLen(t))throw new Error("invalid padding");return utf8Decoder$1.decode(r)}function hmacAad(e,t,r){if(r.length!==32)throw new Error("AAD associated data must be 32 bytes");const n=concatBytes(r,t);return hmac$1(sha256$1,e,n)}function decodePayload(e){if(typeof e!="string")throw new Error("payload must be a valid string");const t=e.length;if(t<132||t>87472)throw new Error("invalid payload length: "+t);if(e[0]==="#")throw new Error("unknown encryption version");let r;try{r=base64.decode(e)}catch(a){throw new Error("invalid base64: "+a.message)}const n=r.length;if(n<99||n>65603)throw new Error("invalid data length: "+n);const s=r[0];if(s!==2)throw new Error("unknown encryption version "+s);return{nonce:r.subarray(1,33),ciphertext:r.subarray(33,-32),mac:r.subarray(-32)}}function encrypt2(e,t,r=randomBytes(32)){const{chacha_key:n,chacha_nonce:s,hmac_key:a}=getMessageKeys(t,r),l=pad(e),u=chacha20(n,s,l),x=hmacAad(a,u,r);return base64.encode(concatBytes(new Uint8Array([2]),r,u,x))}function decrypt2(e,t){const{nonce:r,ciphertext:n,mac:s}=decodePayload(e),{chacha_key:a,chacha_nonce:l,hmac_key:u}=getMessageKeys(t,r),x=hmacAad(u,n,r);if(!equalBytes(x,s))throw new Error("invalid MAC");const f=chacha20(a,l,n);return unpad(f)}var v2={utils:{getConversationKey,calcPaddedLen},encrypt:encrypt2,decrypt:decrypt2},TWO_DAYS=2880*60,now=()=>Math.round(Date.now()/1e3),randomNow=()=>Math.round(now()-Math.random()*TWO_DAYS),nip44ConversationKey=(e,t)=>getConversationKey(e,t),nip44Encrypt=(e,t,r)=>encrypt2(JSON.stringify(e),nip44ConversationKey(t,r)),nip44Decrypt=(e,t)=>JSON.parse(decrypt2(e.content,nip44ConversationKey(t,e.pubkey)));function createRumor(e,t){const r={created_at:now(),content:"",tags:[],...e,pubkey:getPublicKey(t)};return r.id=getEventHash$1(r),r}function createSeal(e,t,r){return finalizeEvent({kind:Seal,content:nip44Encrypt(e,t,r),created_at:randomNow(),tags:[]},t)}function createWrap(e,t){const r=generateSecretKey();return finalizeEvent({kind:GiftWrap,content:nip44Encrypt(e,r,t),created_at:randomNow(),tags:[["p",t]]},r)}function wrapEvent$1(e,t,r){const n=createRumor(e,t),s=createSeal(n,t,r);return createWrap(s,r)}function wrapManyEvents(e,t,r){if(!r||r.length===0)throw new Error("At least one recipient is required.");const n=getPublicKey(t),s=[wrapEvent$1(e,t,n)];return r.forEach(a=>{s.push(wrapEvent$1(e,t,a))}),s}function unwrapEvent(e,t){const r=nip44Decrypt(e,t);return nip44Decrypt(r,t)}function unwrapManyEvents(e,t){let r=[];return e.forEach(n=>{r.push(unwrapEvent(n,t))}),r.sort((n,s)=>n.created_at-s.created_at),r}function createEvent(e,t,r,n){const s={created_at:Math.ceil(Date.now()/1e3),kind:PrivateDirectMessage,tags:[],content:t};return(Array.isArray(e)?e:[e]).forEach(({publicKey:l,relayUrl:u})=>{s.tags.push(u?["p",l,u]:["p",l])}),n&&s.tags.push(["e",n.eventId,n.relayUrl||"","reply"]),r&&s.tags.push(["subject",r]),s}function wrapEvent2(e,t,r,n,s){const a=createEvent(t,r,n,s);return wrapEvent$1(a,e,t.publicKey)}function wrapManyEvents2(e,t,r,n,s){if(!t||t.length===0)throw new Error("At least one recipient is required.");return[{publicKey:getPublicKey(e)},...t].map(l=>wrapEvent2(e,l,r,n,s))}var unwrapEvent2=unwrapEvent,unwrapManyEvents2=unwrapManyEvents,nip18_exports={};__export(nip18_exports,{finishRepostEvent:()=>finishRepostEvent,getRepostedEvent:()=>getRepostedEvent,getRepostedEventPointer:()=>getRepostedEventPointer});function finishRepostEvent(e,t,r,n){let s;const a=[...e.tags??[],["e",t.id,r],["p",t.pubkey]];return t.kind===ShortTextNote?s=Repost:(s=GenericRepost,a.push(["k",String(t.kind)])),finalizeEvent({kind:s,tags:a,content:e.content===""||t.tags?.find(l=>l[0]==="-")?"":JSON.stringify(t),created_at:e.created_at},n)}function getRepostedEventPointer(e){if(![Repost,GenericRepost].includes(e.kind))return;let t,r;for(let n=e.tags.length-1;n>=0&&(t===void 0||r===void 0);n--){const s=e.tags[n];s.length>=2&&(s[0]==="e"&&t===void 0?t=s:s[0]==="p"&&r===void 0&&(r=s))}if(t!==void 0)return{id:t[1],relays:[t[2],r?.[2]].filter(n=>typeof n=="string"),author:r?.[1]}}function getRepostedEvent(e,{skipVerification:t}={}){const r=getRepostedEventPointer(e);if(r===void 0||e.content==="")return;let n;try{n=JSON.parse(e.content)}catch{return}if(n.id===r.id&&!(!t&&!verifyEvent(n)))return n}var nip21_exports={};__export(nip21_exports,{NOSTR_URI_REGEX:()=>NOSTR_URI_REGEX,parse:()=>parse2,test:()=>test});var NOSTR_URI_REGEX=new RegExp(`nostr:(${BECH32_REGEX$2.source})`);function test(e){return typeof e=="string"&&new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(e)}function parse2(e){const t=e.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));if(!t)throw new Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:decode$k(t[1])}}var nip25_exports={};__export(nip25_exports,{finishReactionEvent:()=>finishReactionEvent,getReactedEventPointer:()=>getReactedEventPointer});function finishReactionEvent(e,t,r){const n=t.tags.filter(s=>s.length>=2&&(s[0]==="e"||s[0]==="p"));return finalizeEvent({...e,kind:Reaction,tags:[...e.tags??[],...n,["e",t.id],["p",t.pubkey]],content:e.content??"+"},r)}function getReactedEventPointer(e){if(e.kind!==Reaction)return;let t,r;for(let n=e.tags.length-1;n>=0&&(t===void 0||r===void 0);n--){const s=e.tags[n];s.length>=2&&(s[0]==="e"&&t===void 0?t=s:s[0]==="p"&&r===void 0&&(r=s))}if(!(t===void 0||r===void 0))return{id:t[1],relays:[t[2],r[2]].filter(n=>n!==void 0),author:r[1]}}var nip27_exports={};__export(nip27_exports,{parse:()=>parse3});var noCharacter=/\W/m,noURLCharacter=/\W |\W$|$|,| /m,MAX_HASHTAG_LENGTH=42;function*parse3(e){let t=[];if(typeof e!="string"){for(let a=0;a<e.tags.length;a++){const l=e.tags[a];l[0]==="emoji"&&l.length>=3&&t.push({type:"emoji",shortcode:l[1],url:l[2]})}e=e.content}const r=e.length;let n=0,s=0;e:for(;s<r;){const a=e.indexOf(":",s),l=e.indexOf("#",s);if(a===-1&&l===-1)break e;if(a===-1||l>=0&&l<a){if(l===0||e[l-1]===" "){const u=e.slice(l+1,l+MAX_HASHTAG_LENGTH).match(noCharacter),x=u?l+1+u.index:r;yield{type:"text",text:e.slice(n,l)},yield{type:"hashtag",value:e.slice(l+1,x)},s=x,n=s;continue e}s=l+1;continue e}if(e.slice(a-5,a)==="nostr"){const u=e.slice(a+60).match(noCharacter),x=u?a+60+u.index:r;try{let f,{data:p,type:g}=decode$k(e.slice(a+1,x));switch(g){case"npub":f={pubkey:p};break;case"nsec":case"note":s=x+1;continue;default:f=p}n!==a-5&&(yield{type:"text",text:e.slice(n,a-5)}),yield{type:"reference",pointer:f},s=x,n=s;continue e}catch{s=a+1;continue e}}else if(e.slice(a-5,a)==="https"||e.slice(a-4,a)==="http"){const u=e.slice(a+4).match(noURLCharacter),x=u?a+4+u.index:r,f=e[a-1]==="s"?5:4;try{let p=new URL(e.slice(a-f,x));if(p.hostname.indexOf(".")===-1)throw new Error("invalid url");if(n!==a-f&&(yield{type:"text",text:e.slice(n,a-f)}),/\.(png|jpe?g|gif|webp|heic|svg)$/i.test(p.pathname)){yield{type:"image",url:p.toString()},s=x,n=s;continue e}if(/\.(mp4|avi|webm|mkv|mov)$/i.test(p.pathname)){yield{type:"video",url:p.toString()},s=x,n=s;continue e}if(/\.(mp3|aac|ogg|opus|wav|flac)$/i.test(p.pathname)){yield{type:"audio",url:p.toString()},s=x,n=s;continue e}yield{type:"url",url:p.toString()},s=x,n=s;continue e}catch{s=x+1;continue e}}else if(e.slice(a-3,a)==="wss"||e.slice(a-2,a)==="ws"){const u=e.slice(a+4).match(noURLCharacter),x=u?a+4+u.index:r,f=e[a-1]==="s"?3:2;try{let p=new URL(e.slice(a-f,x));if(p.hostname.indexOf(".")===-1)throw new Error("invalid ws url");n!==a-f&&(yield{type:"text",text:e.slice(n,a-f)}),yield{type:"relay",url:p.toString()},s=x,n=s;continue e}catch{s=x+1;continue e}}else{for(let u=0;u<t.length;u++){const x=t[u];if(e[a+x.shortcode.length+1]===":"&&e.slice(a+1,a+x.shortcode.length+1)===x.shortcode){n!==a&&(yield{type:"text",text:e.slice(n,a)}),yield x,s=a+x.shortcode.length+2,n=s;continue e}}s=a+1;continue e}}n!==r&&(yield{type:"text",text:e.slice(n)})}var nip28_exports={};__export(nip28_exports,{channelCreateEvent:()=>channelCreateEvent,channelHideMessageEvent:()=>channelHideMessageEvent,channelMessageEvent:()=>channelMessageEvent,channelMetadataEvent:()=>channelMetadataEvent,channelMuteUserEvent:()=>channelMuteUserEvent});var channelCreateEvent=(e,t)=>{let r;if(typeof e.content=="object")r=JSON.stringify(e.content);else if(typeof e.content=="string")r=e.content;else return;return finalizeEvent({kind:ChannelCreation,tags:[...e.tags??[]],content:r,created_at:e.created_at},t)},channelMetadataEvent=(e,t)=>{let r;if(typeof e.content=="object")r=JSON.stringify(e.content);else if(typeof e.content=="string")r=e.content;else return;return finalizeEvent({kind:ChannelMetadata,tags:[["e",e.channel_create_event_id],...e.tags??[]],content:r,created_at:e.created_at},t)},channelMessageEvent=(e,t)=>{const r=[["e",e.channel_create_event_id,e.relay_url,"root"]];return e.reply_to_channel_message_event_id&&r.push(["e",e.reply_to_channel_message_event_id,e.relay_url,"reply"]),finalizeEvent({kind:ChannelMessage,tags:[...r,...e.tags??[]],content:e.content,created_at:e.created_at},t)},channelHideMessageEvent=(e,t)=>{let r;if(typeof e.content=="object")r=JSON.stringify(e.content);else if(typeof e.content=="string")r=e.content;else return;return finalizeEvent({kind:ChannelHideMessage,tags:[["e",e.channel_message_event_id],...e.tags??[]],content:r,created_at:e.created_at},t)},channelMuteUserEvent=(e,t)=>{let r;if(typeof e.content=="object")r=JSON.stringify(e.content);else if(typeof e.content=="string")r=e.content;else return;return finalizeEvent({kind:ChannelMuteUser,tags:[["p",e.pubkey_to_mute],...e.tags??[]],content:r,created_at:e.created_at},t)},nip30_exports={};__export(nip30_exports,{EMOJI_SHORTCODE_REGEX:()=>EMOJI_SHORTCODE_REGEX,matchAll:()=>matchAll,regex:()=>regex$2,replaceAll:()=>replaceAll});var EMOJI_SHORTCODE_REGEX=/:(\w+):/,regex$2=()=>new RegExp(`\\B${EMOJI_SHORTCODE_REGEX.source}\\B`,"g");function*matchAll(e){const t=e.matchAll(regex$2());for(const r of t)try{const[n,s]=r;yield{shortcode:n,name:s,start:r.index,end:r.index+n.length}}catch{}}function replaceAll(e,t){return e.replaceAll(regex$2(),(r,n)=>t({shortcode:r,name:n}))}var nip39_exports={};__export(nip39_exports,{useFetchImplementation:()=>useFetchImplementation3,validateGithub:()=>validateGithub});var _fetch3;try{_fetch3=fetch}catch{}function useFetchImplementation3(e){_fetch3=e}async function validateGithub(e,t,r){try{return await(await _fetch3(`https://gist.github.com/${t}/${r}/raw`)).text()===`Verifying that I control the following Nostr public key: ${e}`}catch{return!1}}var nip47_exports={};__export(nip47_exports,{makeNwcRequestEvent:()=>makeNwcRequestEvent,parseConnectionString:()=>parseConnectionString});function parseConnectionString(e){const{host:t,pathname:r,searchParams:n}=new URL(e),s=r||t,a=n.get("relay"),l=n.get("secret");if(!s||!a||!l)throw new Error("invalid connection string");return{pubkey:s,relay:a,secret:l}}async function makeNwcRequestEvent(e,t,r){const s=encrypt$2(t,e,JSON.stringify({method:"pay_invoice",params:{invoice:r}})),a={kind:NWCWalletRequest,created_at:Math.round(Date.now()/1e3),content:s,tags:[["p",e]]};return finalizeEvent(a,t)}var nip54_exports={};__export(nip54_exports,{normalizeIdentifier:()=>normalizeIdentifier});function normalizeIdentifier(e){return e=e.trim().toLowerCase(),e=e.normalize("NFKC"),Array.from(e).map(t=>new RegExp("\\p{Letter}","u").test(t)||new RegExp("\\p{Number}","u").test(t)?t:"-").join("")}var nip57_exports={};__export(nip57_exports,{getSatoshisAmountFromBolt11:()=>getSatoshisAmountFromBolt11,getZapEndpoint:()=>getZapEndpoint,makeZapReceipt:()=>makeZapReceipt,makeZapRequest:()=>makeZapRequest,useFetchImplementation:()=>useFetchImplementation4,validateZapRequest:()=>validateZapRequest});var _fetch4;try{_fetch4=fetch}catch{}function useFetchImplementation4(e){_fetch4=e}async function getZapEndpoint(e){try{let t="",{lud06:r,lud16:n}=JSON.parse(e.content);if(n){let[l,u]=n.split("@");t=new URL(`/.well-known/lnurlp/${l}`,`https://${u}`).toString()}else if(r){let{words:l}=bech32$1.decode(r,1e3),u=bech32$1.fromWords(l);t=utf8Decoder$1.decode(u)}else return null;let a=await(await _fetch4(t)).json();if(a.allowsNostr&&a.nostrPubkey)return a.callback}catch{}return null}function makeZapRequest(e){let t={kind:9734,created_at:Math.round(Date.now()/1e3),content:e.comment||"",tags:[["p","pubkey"in e?e.pubkey:e.event.pubkey],["amount",e.amount.toString()],["relays",...e.relays]]};if("event"in e){if(t.tags.push(["e",e.event.id]),isReplaceableKind(e.event.kind)){const r=["a",`${e.event.kind}:${e.event.pubkey}:`];t.tags.push(r)}else if(isAddressableKind(e.event.kind)){let r=e.event.tags.find(([s,a])=>s==="d"&&a);if(!r)throw new Error("d tag not found or is empty");const n=["a",`${e.event.kind}:${e.event.pubkey}:${r[1]}`];t.tags.push(n)}t.tags.push(["k",e.event.kind.toString()])}return t}function validateZapRequest(e){let t;try{t=JSON.parse(e)}catch{return"Invalid zap request JSON."}if(!validateEvent(t))return"Zap request is not a valid Nostr event.";if(!verifyEvent(t))return"Invalid signature on zap request.";let r=t.tags.find(([a,l])=>a==="p"&&l);if(!r)return"Zap request doesn't have a 'p' tag.";if(!r[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let n=t.tags.find(([a,l])=>a==="e"&&l);return n&&!n[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find(([a,l])=>a==="relays"&&l)?null:"Zap request doesn't have a 'relays' tag."}function makeZapReceipt({zapRequest:e,preimage:t,bolt11:r,paidAt:n}){let s=JSON.parse(e),a=s.tags.filter(([u])=>u==="e"||u==="p"||u==="a"),l={kind:9735,created_at:Math.round(n.getTime()/1e3),content:"",tags:[...a,["P",s.pubkey],["bolt11",r],["description",e]]};return t&&l.tags.push(["preimage",t]),l}function getSatoshisAmountFromBolt11(e){if(e.length<50)return 0;e=e.substring(0,50);const t=e.lastIndexOf("1");if(t===-1)return 0;const r=e.substring(0,t);if(!r.startsWith("lnbc"))return 0;const n=r.substring(4);if(n.length<1)return 0;const s=n[n.length-1],a=s.charCodeAt(0)-48,l=a>=0&&a<=9;let u=n.length-1;if(l&&u++,u<1)return 0;const x=parseInt(n.substring(0,u));switch(s){case"m":return x*1e5;case"u":return x*100;case"n":return x/10;case"p":return x/1e4;default:return x*1e8}}var nip77_exports={};__export(nip77_exports,{Negentropy:()=>Negentropy,NegentropyStorageVector:()=>NegentropyStorageVector,NegentropySync:()=>NegentropySync});var PROTOCOL_VERSION=97,ID_SIZE=32,FINGERPRINT_SIZE=16,Mode={Skip:0,Fingerprint:1,IdList:2},WrappedBuffer=class{_raw;length;constructor(e){typeof e=="number"?(this._raw=new Uint8Array(e),this.length=0):e instanceof Uint8Array?(this._raw=new Uint8Array(e),this.length=e.length):(this._raw=new Uint8Array(512),this.length=0)}unwrap(){return this._raw.subarray(0,this.length)}get capacity(){return this._raw.byteLength}extend(e){if(e instanceof WrappedBuffer&&(e=e.unwrap()),typeof e.length!="number")throw Error("bad length");const t=e.length+this.length;if(this.capacity<t){const r=this._raw,n=Math.max(this.capacity*2,t);this._raw=new Uint8Array(n),this._raw.set(r)}this._raw.set(e,this.length),this.length+=e.length}shift(){const e=this._raw[0];return this._raw=this._raw.subarray(1),this.length--,e}shiftN(e=1){const t=this._raw.subarray(0,e);return this._raw=this._raw.subarray(e),this.length-=e,t}};function decodeVarInt(e){let t=0;for(;;){if(e.length===0)throw Error("parse ends prematurely");let r=e.shift();if(t=t<<7|r&127,(r&128)===0)break}return t}function encodeVarInt(e){if(e===0)return new WrappedBuffer(new Uint8Array([0]));let t=[];for(;e!==0;)t.push(e&127),e>>>=7;t.reverse();for(let r=0;r<t.length-1;r++)t[r]|=128;return new WrappedBuffer(new Uint8Array(t))}function getByte(e){return getBytes(e,1)[0]}function getBytes(e,t){if(e.length<t)throw Error("parse ends prematurely");return e.shiftN(t)}var Accumulator=class{buf;constructor(){this.setToZero()}setToZero(){this.buf=new Uint8Array(ID_SIZE)}add(e){let t=0,r=0,n=new DataView(this.buf.buffer),s=new DataView(e.buffer);for(let a=0;a<8;a++){let l=a*4,u=n.getUint32(l,!0),x=s.getUint32(l,!0),f=u;f+=t,f+=x,f>4294967295&&(r=1),n.setUint32(l,f&4294967295,!0),t=r,r=0}}negate(){let e=new DataView(this.buf.buffer);for(let r=0;r<8;r++){let n=r*4;e.setUint32(n,~e.getUint32(n,!0))}let t=new Uint8Array(ID_SIZE);t[0]=1,this.add(t)}getFingerprint(e){let t=new WrappedBuffer;return t.extend(this.buf),t.extend(encodeVarInt(e)),sha256$1(t.unwrap()).subarray(0,FINGERPRINT_SIZE)}},NegentropyStorageVector=class{items;sealed;constructor(){this.items=[],this.sealed=!1}insert(e,t){if(this.sealed)throw Error("already sealed");const r=hexToBytes$2(t);if(r.byteLength!==ID_SIZE)throw Error("bad id size for added item");this.items.push({timestamp:e,id:r})}seal(){if(this.sealed)throw Error("already sealed");this.sealed=!0,this.items.sort(itemCompare);for(let e=1;e<this.items.length;e++)if(itemCompare(this.items[e-1],this.items[e])===0)throw Error("duplicate item inserted")}unseal(){this.sealed=!1}size(){return this._checkSealed(),this.items.length}getItem(e){if(this._checkSealed(),e>=this.items.length)throw Error("out of range");return this.items[e]}iterate(e,t,r){this._checkSealed(),this._checkBounds(e,t);for(let n=e;n<t&&r(this.items[n],n);++n);}findLowerBound(e,t,r){return this._checkSealed(),this._checkBounds(e,t),this._binarySearch(this.items,e,t,n=>itemCompare(n,r)<0)}fingerprint(e,t){let r=new Accumulator;return r.setToZero(),this.iterate(e,t,n=>(r.add(n.id),!0)),r.getFingerprint(t-e)}_checkSealed(){if(!this.sealed)throw Error("not sealed")}_checkBounds(e,t){if(e>t||t>this.items.length)throw Error("bad range")}_binarySearch(e,t,r,n){let s=r-t;for(;s>0;){let a=t,l=Math.floor(s/2);a+=l,n(e[a])?(t=++a,s-=l+1):s=l}return t}},Negentropy=class{storage;frameSizeLimit;lastTimestampIn;lastTimestampOut;constructor(e,t=6e4){if(t<4096)throw Error("frameSizeLimit too small");this.storage=e,this.frameSizeLimit=t,this.lastTimestampIn=0,this.lastTimestampOut=0}_bound(e,t){return{timestamp:e,id:t||new Uint8Array(0)}}initiate(){let e=new WrappedBuffer;return e.extend(new Uint8Array([PROTOCOL_VERSION])),this.splitRange(0,this.storage.size(),this._bound(Number.MAX_VALUE),e),bytesToHex(e.unwrap())}reconcile(e,t,r){const n=new WrappedBuffer(hexToBytes$2(e));this.lastTimestampIn=this.lastTimestampOut=0;let s=new WrappedBuffer;s.extend(new Uint8Array([PROTOCOL_VERSION]));let a=getByte(n);if(a<96||a>111)throw Error("invalid negentropy protocol version byte");if(a!==PROTOCOL_VERSION)throw Error("unsupported negentropy protocol version requested: "+(a-96));let l=this.storage.size(),u=this._bound(0),x=0,f=!1;for(;n.length!==0;){let p=new WrappedBuffer,g=()=>{f&&(f=!1,p.extend(this.encodeBound(u)),p.extend(encodeVarInt(Mode.Skip)))},y=this.decodeBound(n),w=decodeVarInt(n),R=x,I=this.storage.findLowerBound(x,l,y);if(w===Mode.Skip)f=!0;else if(w===Mode.Fingerprint){let k=getBytes(n,FINGERPRINT_SIZE),je=this.storage.fingerprint(R,I);compareUint8Array(k,je)!==0?(g(),this.splitRange(R,I,y,p)):f=!0}else if(w===Mode.IdList){let k=decodeVarInt(n),je={};for(let Ve=0;Ve<k;Ve++){let q=getBytes(n,ID_SIZE);je[bytesToHex(q)]=q}if(f=!0,this.storage.iterate(R,I,Ve=>{let q=Ve.id;const $e=bytesToHex(q);return je[$e]?delete je[bytesToHex(q)]:t?.($e),!0}),r)for(let Ve of Object.values(je))r(bytesToHex(Ve))}else throw Error("unexpected mode");if(this.exceededFrameSizeLimit(s.length+p.length)){let k=this.storage.fingerprint(I,l);s.extend(this.encodeBound(this._bound(Number.MAX_VALUE))),s.extend(encodeVarInt(Mode.Fingerprint)),s.extend(k);break}else s.extend(p);x=I,u=y}return s.length===1?null:bytesToHex(s.unwrap())}splitRange(e,t,r,n){let s=t-e,a=16;if(s<a*2)n.extend(this.encodeBound(r)),n.extend(encodeVarInt(Mode.IdList)),n.extend(encodeVarInt(s)),this.storage.iterate(e,t,l=>(n.extend(l.id),!0));else{let l=Math.floor(s/a),u=s%a,x=e;for(let f=0;f<a;f++){let p=l+(f<u?1:0),g=this.storage.fingerprint(x,x+p);x+=p;let y;if(x===t)y=r;else{let w,R;this.storage.iterate(x-1,x+1,(I,k)=>(k===x-1?w=I:R=I,!0)),y=this.getMinimalBound(w,R)}n.extend(this.encodeBound(y)),n.extend(encodeVarInt(Mode.Fingerprint)),n.extend(g)}}}exceededFrameSizeLimit(e){return e>this.frameSizeLimit-200}decodeTimestampIn(e){let t=decodeVarInt(e);return t=t===0?Number.MAX_VALUE:t-1,this.lastTimestampIn===Number.MAX_VALUE||t===Number.MAX_VALUE?(this.lastTimestampIn=Number.MAX_VALUE,Number.MAX_VALUE):(t+=this.lastTimestampIn,this.lastTimestampIn=t,t)}decodeBound(e){let t=this.decodeTimestampIn(e),r=decodeVarInt(e);if(r>ID_SIZE)throw Error("bound key too long");let n=getBytes(e,r);return{timestamp:t,id:n}}encodeTimestampOut(e){if(e===Number.MAX_VALUE)return this.lastTimestampOut=Number.MAX_VALUE,encodeVarInt(0);let t=e;return e-=this.lastTimestampOut,this.lastTimestampOut=t,encodeVarInt(e+1)}encodeBound(e){let t=new WrappedBuffer;return t.extend(this.encodeTimestampOut(e.timestamp)),t.extend(encodeVarInt(e.id.length)),t.extend(e.id),t}getMinimalBound(e,t){if(t.timestamp!==e.timestamp)return this._bound(t.timestamp);{let r=0,n=t.id,s=e.id;for(let a=0;a<ID_SIZE&&n[a]===s[a];a++)r++;return this._bound(t.timestamp,t.id.subarray(0,r+1))}}};function compareUint8Array(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function itemCompare(e,t){return e.timestamp===t.timestamp?compareUint8Array(e.id,t.id):e.timestamp-t.timestamp}var NegentropySync=class{relay;storage;neg;filter;subscription;onhave;onneed;constructor(e,t,r,n={}){this.relay=e,this.storage=t,this.neg=new Negentropy(t),this.onhave=n.onhave,this.onneed=n.onneed,this.filter=r,this.subscription=this.relay.prepareSubscription([{}],{label:n.label||"negentropy"}),this.subscription.oncustom=s=>{switch(s[0]){case"NEG-MSG":{s.length<3&&console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${s}`);try{const a=this.neg.reconcile(s[2],this.onhave,this.onneed);a?this.relay.send(`["NEG-MSG", "${this.subscription.id}", "${a}"]`):(this.close(),n.onclose?.())}catch(a){console.error("negentropy reconcile error:",a),n?.onclose?.(`reconcile error: ${a}`)}break}case"NEG-CLOSE":{const a=s[2];console.warn("negentropy error:",a),n.onclose?.(a);break}case"NEG-ERR":n.onclose?.()}}}async start(){const e=this.neg.initiate();this.relay.send(`["NEG-OPEN","${this.subscription.id}",${JSON.stringify(this.filter)},"${e}"]`)}close(){this.relay.send(`["NEG-CLOSE","${this.subscription.id}"]`),this.subscription.close()}},nip98_exports={};__export(nip98_exports,{getToken:()=>getToken,hashPayload:()=>hashPayload,unpackEventFromToken:()=>unpackEventFromToken,validateEvent:()=>validateEvent2,validateEventKind:()=>validateEventKind,validateEventMethodTag:()=>validateEventMethodTag,validateEventPayloadTag:()=>validateEventPayloadTag,validateEventTimestamp:()=>validateEventTimestamp,validateEventUrlTag:()=>validateEventUrlTag,validateToken:()=>validateToken});var _authorizationScheme="Nostr ";async function getToken(e,t,r,n=!1,s){const a={kind:HTTPAuth,tags:[["u",e],["method",t]],created_at:Math.round(new Date().getTime()/1e3),content:""};s&&a.tags.push(["payload",hashPayload(s)]);const l=await r(a);return(n?_authorizationScheme:"")+base64.encode(utf8Encoder$1.encode(JSON.stringify(l)))}async function validateToken(e,t,r){const n=await unpackEventFromToken(e).catch(a=>{throw a});return await validateEvent2(n,t,r).catch(a=>{throw a})}async function unpackEventFromToken(e){if(!e)throw new Error("Missing token");e=e.replace(_authorizationScheme,"");const t=utf8Decoder$1.decode(base64.decode(e));if(!t||t.length===0||!t.startsWith("{"))throw new Error("Invalid token");return JSON.parse(t)}function validateEventTimestamp(e){return e.created_at?Math.round(new Date().getTime()/1e3)-e.created_at<60:!1}function validateEventKind(e){return e.kind===HTTPAuth}function validateEventUrlTag(e,t){const r=e.tags.find(n=>n[0]==="u");return r?r.length>0&&r[1]===t:!1}function validateEventMethodTag(e,t){const r=e.tags.find(n=>n[0]==="method");return r?r.length>0&&r[1].toLowerCase()===t.toLowerCase():!1}function hashPayload(e){const t=sha256$1(utf8Encoder$1.encode(JSON.stringify(e)));return bytesToHex$1(t)}function validateEventPayloadTag(e,t){const r=e.tags.find(s=>s[0]==="payload");if(!r)return!1;const n=hashPayload(t);return r.length>0&&r[1]===n}async function validateEvent2(e,t,r,n){if(!verifyEvent(e))throw new Error("Invalid nostr event, signature invalid");if(!validateEventKind(e))throw new Error("Invalid nostr event, kind invalid");if(!validateEventTimestamp(e))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!validateEventUrlTag(e,t))throw new Error("Invalid nostr event, url tag invalid");if(!validateEventMethodTag(e,r))throw new Error("Invalid nostr event, method tag invalid");if(n&&typeof n=="object"&&Object.keys(n).length>0&&!validateEventPayloadTag(e,n))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}const index$3=Object.freeze(Object.defineProperty({__proto__:null,finalizeEvent,fj:fakejson_exports,generateSecretKey,getEventHash:getEventHash$1,getPublicKey,kinds:kinds_exports,matchFilter,matchFilters,nip04:nip04_exports,nip05:nip05_exports,nip10:nip10_exports,nip11:nip11_exports,nip13:nip13_exports,nip17:nip17_exports,nip18:nip18_exports,nip19:nip19_exports$1,nip21:nip21_exports,nip25:nip25_exports,nip27:nip27_exports,nip28:nip28_exports,nip30:nip30_exports,nip39:nip39_exports,nip42:nip42_exports,nip44:nip44_exports,nip47:nip47_exports,nip54:nip54_exports,nip57:nip57_exports,nip59:nip59_exports,nip77:nip77_exports,nip98:nip98_exports,serializeEvent,utils:utils_exports,validateEvent,verifiedSymbol,verifyEvent},Symbol.toStringTag,{value:"Module"}));class CryptoService{static isWebCryptoAvailable(){return!!(window.crypto&&window.crypto.subtle)}static simpleFallbackEncrypt(t,r){const n=this.hashPassword(r),s=[];for(let a=0;a<t.length;a++)s.push(t.charCodeAt(a)^n.charCodeAt(a%n.length));return btoa(JSON.stringify(s))}static simpleFallbackDecrypt(t,r){const n=this.hashPassword(r),s=JSON.parse(atob(t));let a="";for(let l=0;l<s.length;l++)a+=String.fromCharCode(s[l]^n.charCodeAt(l%n.length));return a}static hashPassword(t){let r=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);r=(r<<5)-r+s,r=r&r}return r.toString(36)+t}static async getPasswordKey(t){const r=new TextEncoder;return window.crypto.subtle.importKey("raw",r.encode(t),"PBKDF2",!1,["deriveKey"])}static async deriveKey(t,r){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}static async encrypt(t,r){if(!this.isWebCryptoAvailable())return console.warn("[Crypto] Using fallback encryption"),"FALLBACK:"+this.simpleFallbackEncrypt(t,r);const n=window.crypto.getRandomValues(new Uint8Array(16)),s=window.crypto.getRandomValues(new Uint8Array(12)),a=await this.getPasswordKey(r),l=await this.deriveKey(a,n),u=new TextEncoder,x=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},l,u.encode(t)),f=new Uint8Array(x),p=new Uint8Array(n.length+s.length+f.length);return p.set(n,0),p.set(s,n.length),p.set(f,n.length+s.length),btoa(String.fromCharCode(...p))}static async decrypt(t,r){if(t.startsWith("FALLBACK:"))return this.simpleFallbackDecrypt(t.substring(9),r);const n=atob(t),s=new Uint8Array(n.length);for(let y=0;y<n.length;y++)s[y]=n.charCodeAt(y);const a=s.slice(0,16),l=s.slice(16,28),u=s.slice(28),x=await this.getPasswordKey(r),f=await this.deriveKey(x,a),p=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:l},f,u);return new TextDecoder().decode(p)}static generateMnemonic(t=12){return generateMnemonic(wordlist,t===12?128:256)}static validateMnemonic(t){return validateMnemonic(t,wordlist)}static deriveKeypair(t,r){const n=mnemonicToSeedSync(t),s=`m/44'/1237'/0'/0/${r}`,a=HDKey.fromMasterSeed(n).derive(s);if(!a.privateKey)throw new Error("Failed to derive private key");const l=Array.from(a.privateKey).map(x=>x.toString(16).padStart(2,"0")).join(""),u=getPublicKey(a.privateKey);return{nsec:nip19_exports$1.nsecEncode(a.privateKey),npub:nip19_exports$1.npubEncode(u),path:s,privateKeyHex:l}}static nsecToHex(t){const r=nip19_exports$1.decode(t);if(r.type!=="nsec")throw new Error("Invalid nsec format");const n=r.data;return Array.from(n).map(s=>s.toString(16).padStart(2,"0")).join("")}static nsecToNpub(t){const r=nip19_exports$1.decode(t);if(r.type!=="nsec")throw new Error("Invalid nsec format");const n=r.data,s=getPublicKey(n);return nip19_exports$1.npubEncode(s)}static getPublicKeyHex(t){const r=nip19_exports$1.decode(t);if(r.type!=="nsec")throw new Error("Invalid nsec format");const n=r.data,s=getPublicKey(n);return typeof s=="string"?s:Array.from(s).map(a=>a.toString(16).padStart(2,"0")).join("")}}const crypto$2=Object.freeze(Object.defineProperty({__proto__:null,CryptoService},Symbol.toStringTag,{value:"Module"}));const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),toPascalCase=e=>{const t=toCamelCase(e);return t.charAt(0).toUpperCase()+t.slice(1)},mergeClasses=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),hasA11yProp=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Icon=reactExports.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:l,...u},x)=>reactExports.createElement("svg",{ref:x,...defaultAttributes,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:mergeClasses("lucide",s),...!a&&!hasA11yProp(u)&&{"aria-hidden":"true"},...u},[...l.map(([f,p])=>reactExports.createElement(f,p)),...Array.isArray(a)?a:[a]]));const createLucideIcon=(e,t)=>{const r=reactExports.forwardRef(({className:n,...s},a)=>reactExports.createElement(Icon,{ref:a,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(e))}`,`lucide-${e}`,n),...s}));return r.displayName=toPascalCase(e),r};const __iconNode$X=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Activity=createLucideIcon("activity",__iconNode$X);const __iconNode$W=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],ArrowDownLeft=createLucideIcon("arrow-down-left",__iconNode$W);const __iconNode$V=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ArrowLeft=createLucideIcon("arrow-left",__iconNode$V);const __iconNode$U=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],ArrowRightLeft=createLucideIcon("arrow-right-left",__iconNode$U);const __iconNode$T=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ArrowRight=createLucideIcon("arrow-right",__iconNode$T);const __iconNode$S=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ArrowUpDown=createLucideIcon("arrow-up-down",__iconNode$S);const __iconNode$R=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],ArrowUpRight=createLucideIcon("arrow-up-right",__iconNode$R);const __iconNode$Q=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ban=createLucideIcon("ban",__iconNode$Q);const __iconNode$P=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],Banknote=createLucideIcon("banknote",__iconNode$P);const __iconNode$O=[["path",{d:"M11.767 19.089c4.924.868 6.14-6.025 1.216-6.894m-1.216 6.894L5.86 18.047m5.908 1.042-.347 1.97m1.563-8.864c4.924.869 6.14-6.025 1.215-6.893m-1.215 6.893-3.94-.694m5.155-6.2L8.29 4.26m5.908 1.042.348-1.97M7.48 20.364l3.126-17.727",key:"yr8idg"}]],Bitcoin=createLucideIcon("bitcoin",__iconNode$O);const __iconNode$N=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Check=createLucideIcon("check",__iconNode$N);const __iconNode$M=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ChevronDown=createLucideIcon("chevron-down",__iconNode$M);const __iconNode$L=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ChevronRight=createLucideIcon("chevron-right",__iconNode$L);const __iconNode$K=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ChevronUp=createLucideIcon("chevron-up",__iconNode$K);const __iconNode$J=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],CircleAlert=createLucideIcon("circle-alert",__iconNode$J);const __iconNode$I=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CircleCheckBig=createLucideIcon("circle-check-big",__iconNode$I);const __iconNode$H=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],CircleX=createLucideIcon("circle-x",__iconNode$H);const __iconNode$G=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Code=createLucideIcon("code",__iconNode$G);const __iconNode$F=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Copy=createLucideIcon("copy",__iconNode$F);const __iconNode$E=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Download=createLucideIcon("download",__iconNode$E);const __iconNode$D=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ExternalLink=createLucideIcon("external-link",__iconNode$D);const __iconNode$C=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],EyeOff=createLucideIcon("eye-off",__iconNode$C);const __iconNode$B=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Eye=createLucideIcon("eye",__iconNode$B);const __iconNode$A=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],FileBraces=createLucideIcon("file-braces",__iconNode$A);const __iconNode$z=[["path",{d:"m18.226 5.226-2.52-2.52A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-.351",key:"1k2beg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]],FilePenLine=createLucideIcon("file-pen-line",__iconNode$z);const __iconNode$y=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],FileText=createLucideIcon("file-text",__iconNode$y);const __iconNode$x=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Globe=createLucideIcon("globe",__iconNode$x);const __iconNode$w=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Heart=createLucideIcon("heart",__iconNode$w);const __iconNode$v=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Info=createLucideIcon("info",__iconNode$v);const __iconNode$u=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],KeyRound=createLucideIcon("key-round",__iconNode$u);const __iconNode$t=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Key=createLucideIcon("key",__iconNode$t);const __iconNode$s=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Link=createLucideIcon("link",__iconNode$s);const __iconNode$r=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],LoaderCircle=createLucideIcon("loader-circle",__iconNode$r);const __iconNode$q=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Loader=createLucideIcon("loader",__iconNode$q);const __iconNode$p=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Lock=createLucideIcon("lock",__iconNode$p);const __iconNode$o=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],LogIn=createLucideIcon("log-in",__iconNode$o);const __iconNode$n=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],LogOut=createLucideIcon("log-out",__iconNode$n);const __iconNode$m=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],MessageSquare=createLucideIcon("message-square",__iconNode$m);const __iconNode$l=[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]],Notebook=createLucideIcon("notebook",__iconNode$l);const __iconNode$k=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Pen=createLucideIcon("pen",__iconNode$k);const __iconNode$j=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Plus=createLucideIcon("plus",__iconNode$j);const __iconNode$i=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],QrCode=createLucideIcon("qr-code",__iconNode$i);const __iconNode$h=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Radio=createLucideIcon("radio",__iconNode$h);const __iconNode$g=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],RefreshCw=createLucideIcon("refresh-cw",__iconNode$g);const __iconNode$f=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Save=createLucideIcon("save",__iconNode$f);const __iconNode$e=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Search=createLucideIcon("search",__iconNode$e);const __iconNode$d=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Send=createLucideIcon("send",__iconNode$d);const __iconNode$c=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],Server=createLucideIcon("server",__iconNode$c);const __iconNode$b=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Settings=createLucideIcon("settings",__iconNode$b);const __iconNode$a=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ShieldCheck=createLucideIcon("shield-check",__iconNode$a);const __iconNode$9=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Shield=createLucideIcon("shield",__iconNode$9);const __iconNode$8=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Trash2=createLucideIcon("trash-2",__iconNode$8);const __iconNode$7=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],TriangleAlert=createLucideIcon("triangle-alert",__iconNode$7);const __iconNode$6=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Upload=createLucideIcon("upload",__iconNode$6);const __iconNode$5=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],User=createLucideIcon("user",__iconNode$5);const __iconNode$4=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Wallet=createLucideIcon("wallet",__iconNode$4);const __iconNode$3=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],WifiOff=createLucideIcon("wifi-off",__iconNode$3);const __iconNode$2=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Wifi=createLucideIcon("wifi",__iconNode$2);const __iconNode$1=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X=createLucideIcon("x",__iconNode$1);const __iconNode=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Zap=createLucideIcon("zap",__iconNode),Toast=({message:e,type:t="success",isOpen:r=!0,onClose:n,duration:s=3e3})=>{if(reactExports.useEffect(()=>{if(!r)return;const u=setTimeout(n,s);return()=>clearTimeout(u)},[s,n,r]),!r)return null;const a={success:"bg-green-600 text-white",error:"bg-red-600 text-white",info:"bg-blue-600 text-white"},l={success:jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5"}),error:jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5"}),info:jsxRuntimeExports.jsx(Info,{className:"w-5 h-5"})};return jsxRuntimeExports.jsxs("div",{className:`fixed bottom-24 left-1/2 -translate-x-1/2 px-5 py-3 rounded-full shadow-lg flex items-center gap-3 z-[100] animate-in slide-in-from-bottom-5 fade-in duration-300 pointer-events-none ${a[t]}`,children:[l[t],jsxRuntimeExports.jsx("span",{className:"font-bold text-sm tracking-wide",children:e})]})},CreateWallet=({onBack:e,onComplete:t})=>{const[r,n]=reactExports.useState("type"),[s,a]=reactExports.useState(""),[l,u]=reactExports.useState(""),[x,f]=reactExports.useState(""),[p,g]=reactExports.useState(""),[y,w]=reactExports.useState(!1),[R,I]=reactExports.useState(null),[k,je]=reactExports.useState(!1),[Ve,q]=reactExports.useState(!1),[$e,We]=reactExports.useState(null),{addWallet:K,setCurrentWallet:W,setCurrentKeypair:Ye}=useWalletStore(),{unlock:Qe}=useAuthStore(),it=D=>{const _e=CryptoService.generateMnemonic(D);a(_e),n("mnemonic")},ze=()=>{navigator.clipboard.writeText(s),w(!0),setTimeout(()=>w(!1),2e3)},v=async D=>{if(D.preventDefault(),I(null),x!==p){I("Passwords do not match");return}if(x.length<8){I("Password must be at least 8 characters");return}je(!0);try{const _e=await CryptoService.encrypt(s,x),{nsec:P,npub:Re,path:Fe,privateKeyHex:Le}=CryptoService.deriveKeypair(s,0),Ce=await CryptoService.encrypt(P,x),L=crypto.randomUUID(),O=crypto.randomUUID(),st={id:O,walletId:L,name:"Main Account",derivationPath:Fe,encryptedNsec:Ce,npub:Re,createdAt:Date.now(),connections:[]},lt={id:L,name:l||"My Address Book",type:"mnemonic",encryptedSeed:_e,createdAt:Date.now(),keypairs:[st]};K(lt),W(L),Ye(O);const Xe=CryptoService.getPublicKeyHex(P);Qe(Le,Xe,x),useEcashStore.getState().loadSession(Xe),t()}catch(_e){console.error(_e),I("Failed to create wallet")}finally{je(!1)}};return jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:e,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),r==="type"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Create New Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Choose the security level for your new address book."})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>it(12),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"12 Words"}),jsxRuntimeExports.jsx(Shield,{className:"w-5 h-5 text-amber-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Standard security. Easier to write down and remember."})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>it(24),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"24 Words"}),jsxRuntimeExports.jsx(Shield,{className:"w-5 h-5 text-green-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Maximum security. Recommended for large amounts."})]})]})]}),r==="mnemonic"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Backup Your Seed"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm",children:"Write down these words in order. This is the ONLY way to recover your address book."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 relative group",children:[jsxRuntimeExports.jsx("div",{className:`grid grid-cols-3 gap-2 ${Ve?"":"blur-sm select-none"}`,children:s.split(" ").map((D,_e)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 p-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500 text-xs w-4",children:[_e+1,"."]}),jsxRuntimeExports.jsx("span",{className:"font-mono font-medium text-amber-50",children:D})]},_e))}),jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>q(!Ve),className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:Ve?"Hide seed phrase":"Show seed phrase",children:Ve?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4 text-slate-400"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("button",{onClick:ze,className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:"Copy to clipboard",children:y?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 flex items-start gap-3",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:"Do not share these words with anyone. Anyone with these words can steal your funds and identity."})]}),jsxRuntimeExports.jsx("button",{onClick:()=>n("encrypt"),className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors",children:"Continue "})]}),r==="encrypt"&&jsxRuntimeExports.jsxs("form",{onSubmit:v,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Secure Your Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Set a name and password for this device."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Address Book Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:l,onChange:D=>u(D.target.value),placeholder:"e.g. Main Address Book",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:x,onChange:D=>f(D.target.value),placeholder:"At least 8 characters",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0,minLength:8})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Confirm Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:p,onChange:D=>g(D.target.value),placeholder:"Repeat password",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]})]}),R&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:R}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:async()=>{if(!x||x.length<8){We({message:"Please enter a valid password (at least 8 characters)",type:"error"});return}if(x!==p){We({message:"Passwords do not match",type:"error"});return}try{const D=await CryptoService.encrypt(s,x),_e=JSON.stringify({wallet:l||"My Wallet",encrypted:D,timestamp:Date.now()},null,2),P=new Blob([_e],{type:"application/json"}),Re=URL.createObjectURL(P),Fe=document.createElement("a");Fe.href=Re,Fe.download=`${(l||"wallet").toLowerCase().replace(/\s+/g,"-")}-backup-encrypted.json`,document.body.appendChild(Fe),Fe.click(),document.body.removeChild(Fe),URL.revokeObjectURL(Re),We({message:"Encrypted backup downloaded successfully!",type:"success"})}catch(D){console.error("Failed to create backup:",D),We({message:"Failed to create encrypted backup",type:"error"})}},className:"w-full py-3 px-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors border border-slate-700 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),"Download Encrypted Backup"]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:k,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:k?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Address Book..."]}):"Create Address Book"})]})]}),$e&&jsxRuntimeExports.jsx(Toast,{message:$e.message,type:$e.type,isOpen:!!$e,onClose:()=>We(null)})]})},ImportWallet=({onBack:e,onComplete:t})=>{const[r,n]=reactExports.useState("method"),[s,a]=reactExports.useState(""),[l,u]=reactExports.useState(null),[x,f]=reactExports.useState(null),[p,g]=reactExports.useState(""),[y,w]=reactExports.useState(""),[R,I]=reactExports.useState(""),[k,je]=reactExports.useState(null),[Ve,q]=reactExports.useState(!1),{addWallet:$e,setCurrentWallet:We,setCurrentKeypair:K,updateKeypair:W,wallets:Ye}=useWalletStore(),{unlock:Qe}=useAuthStore(),it=()=>{const D=s.trim();if(D.includes(" "))if(CryptoService.validateMnemonic(D)){u("mnemonic"),n("encrypt"),je(null);return}else{je("Invalid mnemonic phrase");return}if(D.startsWith("nsec"))try{const{type:_e}=nip19_exports$1.decode(D);if(_e==="nsec"){u("nsec"),n("encrypt"),je(null);return}}catch{}je("Invalid input. Please enter a valid mnemonic phrase or nsec.")},ze=async D=>{const _e=D.target.files?.[0];if(_e)try{const P=await _e.text(),Re=JSON.parse(P);if(!Re.wallet||!Re.encrypted||!Re.timestamp){je("Invalid backup file format");return}f(Re),g(Re.wallet),u("encrypted"),n("encrypt"),je(null)}catch(P){console.error("Failed to read backup file:",P),je("Failed to read backup file. Make sure it's a valid encrypted backup.")}},v=async D=>{if(D.preventDefault(),je(null),l!=="encrypted"){if(y!==R){je("Passwords do not match");return}if(y.length<8){je("Password must be at least 8 characters");return}}q(!0);try{const _e=crypto.randomUUID(),P=crypto.randomUUID();let Re,Fe,Le;if(l==="encrypted"&&x){const Ce=await CryptoService.decrypt(x.encrypted,y);if(Ce.includes(" ")){const O=Ce,{nsec:st,npub:lt,path:Xe,privateKeyHex:dt}=CryptoService.deriveKeypair(O,0);if(Ye.some(dr=>dr.keypairs.some(ir=>ir.npub===lt))){je("Wallet already exists"),q(!1);return}const er=await CryptoService.encrypt(st,y);Fe=dt,Le=CryptoService.getPublicKeyHex(st);const ar={id:P,walletId:_e,name:"Main Account",derivationPath:Xe,encryptedNsec:er,npub:lt,createdAt:Date.now(),connections:[]};Re={id:_e,name:p||x.wallet,type:"mnemonic",encryptedSeed:x.encrypted,createdAt:x.timestamp,keypairs:[ar]}}else{const O=Ce,st=CryptoService.nsecToNpub(O);if(Ye.some(dt=>dt.keypairs.some(er=>er.npub===st))){je("Wallet already exists"),q(!1);return}const lt=await CryptoService.encrypt(O,y);Fe=CryptoService.nsecToHex(O),Le=CryptoService.getPublicKeyHex(O);const Xe={id:P,walletId:_e,name:"Main Account",encryptedNsec:lt,npub:st,createdAt:Date.now(),connections:[]};Re={id:_e,name:p||x.wallet,type:"imported",createdAt:x.timestamp,keypairs:[Xe]}}}else if(l==="mnemonic"){const Ce=s.trim(),L=await CryptoService.encrypt(Ce,y),{nsec:O,npub:st,path:lt,privateKeyHex:Xe}=CryptoService.deriveKeypair(Ce,0);if(Ye.some(ar=>ar.keypairs.some(dr=>dr.npub===st))){je("Wallet already exists"),q(!1);return}const dt=await CryptoService.encrypt(O,y);Fe=Xe,Le=CryptoService.getPublicKeyHex(O);const er={id:P,walletId:_e,name:"Main Account",derivationPath:lt,encryptedNsec:dt,npub:st,createdAt:Date.now(),connections:[]};Re={id:_e,name:p||"Imported Wallet",type:"mnemonic",encryptedSeed:L,createdAt:Date.now(),keypairs:[er]}}else{const Ce=s.trim(),L=CryptoService.nsecToNpub(Ce);if(Ye.some(lt=>lt.keypairs.some(Xe=>Xe.npub===L))){je("Wallet already exists"),q(!1);return}const O=await CryptoService.encrypt(Ce,y);Fe=CryptoService.nsecToHex(Ce),Le=CryptoService.getPublicKeyHex(Ce);const st={id:P,walletId:_e,name:"Main Account",encryptedNsec:O,npub:L,createdAt:Date.now(),connections:[]};Re={id:_e,name:p||"Imported Wallet",type:"imported",createdAt:Date.now(),keypairs:[st]}}$e(Re),We(_e),K(P),setTimeout(async()=>{try{const{ProfileService:Ce}=await __vitePreload(async()=>{const{ProfileService:O}=await Promise.resolve().then(()=>profile);return{ProfileService:O}},void 0,import.meta.url),L=await Ce.fetchProfile(Re.keypairs[0].npub);L&&W(_e,P,{profile:{...L,lastFetched:Date.now()}})}catch(Ce){console.error("Failed to fetch profile for imported wallet:",Ce)}},100),Qe(Fe,Le,y),useEcashStore.getState().loadSession(Le),t()}catch(_e){console.error(_e),je(l==="encrypted"?"Incorrect password. Failed to decrypt backup.":"Failed to import wallet")}finally{q(!1)}};return jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{r==="method"?e():n(r==="encrypt"?l==="encrypted"?"method":"input":"method")},className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),r==="method"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Import Wallet"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Choose how you want to import your wallet."})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>n("input"),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"Recovery Phrase / Private Key"}),jsxRuntimeExports.jsx(KeyRound,{className:"w-5 h-5 text-amber-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Import using your 12/24 word seed phrase or nsec."})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{document.getElementById("backup-file-input")?.click()},className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group relative",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"Encrypted Backup File"}),jsxRuntimeExports.jsx(FileBraces,{className:"w-5 h-5 text-blue-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Import from a previously exported JSON backup file."}),jsxRuntimeExports.jsx("input",{id:"backup-file-input",type:"file",accept:".json",onChange:ze,className:"hidden"})]})]}),k&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:k})]}),r==="input"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Enter Credentials"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Enter your recovery phrase or private key (nsec)."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("textarea",{value:s,onChange:D=>a(D.target.value),placeholder:"word1 word2 word3... OR nsec1...",className:"w-full h-32 bg-slate-900 border border-slate-800 rounded-xl p-4 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm resize-none"}),k&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 p-3 rounded-lg border border-red-500/20",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),k]}),jsxRuntimeExports.jsx("button",{onClick:it,disabled:!s.trim(),className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"})]})]}),r==="encrypt"&&jsxRuntimeExports.jsxs("form",{onSubmit:v,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:l==="encrypted"?"Decrypt Backup":"Secure Your Wallet"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:l==="encrypted"?"Enter the password used to encrypt this backup.":"Set a name and password for this device."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Wallet Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:p,onChange:D=>g(D.target.value),placeholder:"e.g. Main Wallet",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:l==="encrypted"?"Backup Password":"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:y,onChange:D=>w(D.target.value),placeholder:l==="encrypted"?"Enter backup password":"At least 8 characters",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0,minLength:l==="encrypted"?1:8})]}),l!=="encrypted"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Confirm Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:R,onChange:D=>I(D.target.value),placeholder:"Repeat password",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]})]}),k&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:k}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:Ve,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:Ve?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),l==="encrypted"?"Decrypting...":"Importing..."]}):l==="encrypted"?"Decrypt & Import":"Import Wallet"})]})]})},Login=()=>{const{unlock:e}=useAuthStore(),{wallets:t,currentWalletId:r,setCurrentWallet:n}=useWalletStore(),[s,a]=reactExports.useState("login"),[l,u]=reactExports.useState(""),[x,f]=reactExports.useState(null),[p,g]=reactExports.useState(!1),[y,w]=reactExports.useState(""),[R,I]=reactExports.useState(!1);reactExports.useEffect(()=>{t.length===0||(r&&t.find(je=>je.id===r)?w(r):t.length>0&&w(t[0].id))},[t,r]);const k=async je=>{je.preventDefault(),f(null),g(!0);try{const Ve=t.find(W=>W.id===y);if(!Ve)throw new Error("Wallet not found");const q=Ve.keypairs[0];if(!q)throw new Error("No keypairs in wallet");const $e=await CryptoService.decrypt(q.encryptedNsec,l),We=CryptoService.nsecToHex($e),K=CryptoService.getPublicKeyHex($e);n(Ve.id),e(We,K,l),useEcashStore.getState().loadSession(K)}catch(Ve){console.error(Ve),f("Invalid password")}finally{g(!1)}};return s==="create"?jsxRuntimeExports.jsx(CreateWallet,{onBack:()=>a("login"),onComplete:()=>{}}):s==="import"?jsxRuntimeExports.jsx(ImportWallet,{onBack:()=>a("login"),onComplete:()=>{}}):t.length===0?jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 p-4",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md bg-slate-900 rounded-2xl p-8 shadow-xl border border-slate-800 text-center",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"PWANS Logo",className:"w-24 h-24 rounded-full"})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 mb-8",children:"Your secure Nostr signer. Create a new address book or import an existing one to get started."}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>a("create"),className:"w-full py-4 px-6 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-3",children:[jsxRuntimeExports.jsx(Plus,{className:"w-5 h-5"}),"Create New Address Book"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>a("import"),className:"w-full py-4 px-6 bg-slate-800 hover:bg-slate-700 text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-3",children:[jsxRuntimeExports.jsx(Download,{className:"w-5 h-5"}),"Import Address Book"]})]})]})}):jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 p-4",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md bg-slate-900 rounded-2xl p-8 shadow-xl border border-slate-800",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsx("div",{className:"p-4 bg-amber-500/10 rounded-full",children:jsxRuntimeExports.jsx(Lock,{className:"w-8 h-8 text-amber-500"})})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-center mb-2",children:"Unlock Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-center mb-8",children:"Enter your password to access your keys"}),jsxRuntimeExports.jsxs("form",{onSubmit:k,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Select Address Book"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>I(!R),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all text-left flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{children:t.find(je=>je.id===y)?.name||"Select..."}),jsxRuntimeExports.jsx("svg",{className:`w-5 h-5 transition-transform ${R?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),R&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 w-full mt-2 bg-slate-900 border border-slate-800 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:t.map(je=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{w(je.id),I(!1)},className:`w-full px-4 py-3 text-left hover:bg-slate-800 transition-colors ${y===je.id?"bg-amber-500/10 text-amber-500":"text-white"}`,children:je.name},je.id))})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:l,onChange:je=>u(je.target.value),inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"",required:!0})]}),x&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-400/10 p-3 rounded-lg",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"w-4 h-4"}),x]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:p,className:"w-full bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:p?"Unlocking...":jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LogIn,{className:"w-4 h-4"}),"Unlock"]})}),jsxRuntimeExports.jsxs("div",{className:"pt-4 border-t border-slate-800 flex justify-center gap-4 text-sm",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>a("create"),className:"text-slate-400 hover:text-amber-500 transition-colors",children:"Create New"}),jsxRuntimeExports.jsx("span",{className:"text-slate-600",children:"|"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>a("import"),className:"text-slate-400 hover:text-amber-500 transition-colors",children:"Import"})]})]})]})})},useSettingsStore=create()(persist(e=>({eventCreatorMode:!1,toggleEventCreatorMode:()=>e(t=>({eventCreatorMode:!t.eventCreatorMode}))}),{name:"amber-settings",storage:createJSONStorage(()=>localStorage)}));var __defProp$1=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp$1=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp$1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp$1.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__objRest=(e,t)=>{var r={};for(var n in e)__hasOwnProp$1.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&__getOwnPropSymbols)for(var n of __getOwnPropSymbols(e))t.indexOf(n)<0&&__propIsEnum.call(e,n)&&(r[n]=e[n]);return r};var qrcodegen;(e=>{const t=class ln{constructor(x,f,p,g){if(this.version=x,this.errorCorrectionLevel=f,this.modules=[],this.isFunction=[],x<ln.MIN_VERSION||x>ln.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=x*4+17;let y=[];for(let R=0;R<this.size;R++)y.push(!1);for(let R=0;R<this.size;R++)this.modules.push(y.slice()),this.isFunction.push(y.slice());this.drawFunctionPatterns();const w=this.addEccAndInterleave(p);if(this.drawCodewords(w),g==-1){let R=1e9;for(let I=0;I<8;I++){this.applyMask(I),this.drawFormatBits(I);const k=this.getPenaltyScore();k<R&&(g=I,R=k),this.applyMask(I)}}s(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(x,f){const p=e.QrSegment.makeSegments(x);return ln.encodeSegments(p,f)}static encodeBinary(x,f){const p=e.QrSegment.makeBytes(x);return ln.encodeSegments([p],f)}static encodeSegments(x,f,p=1,g=40,y=-1,w=!0){if(!(ln.MIN_VERSION<=p&&p<=g&&g<=ln.MAX_VERSION)||y<-1||y>7)throw new RangeError("Invalid value");let R,I;for(R=p;;R++){const q=ln.getNumDataCodewords(R,f)*8,$e=l.getTotalBits(x,R);if($e<=q){I=$e;break}if(R>=g)throw new RangeError("Data too long")}for(const q of[ln.Ecc.MEDIUM,ln.Ecc.QUARTILE,ln.Ecc.HIGH])w&&I<=ln.getNumDataCodewords(R,q)*8&&(f=q);let k=[];for(const q of x){r(q.mode.modeBits,4,k),r(q.numChars,q.mode.numCharCountBits(R),k);for(const $e of q.getData())k.push($e)}s(k.length==I);const je=ln.getNumDataCodewords(R,f)*8;s(k.length<=je),r(0,Math.min(4,je-k.length),k),r(0,(8-k.length%8)%8,k),s(k.length%8==0);for(let q=236;k.length<je;q^=253)r(q,8,k);let Ve=[];for(;Ve.length*8<k.length;)Ve.push(0);return k.forEach((q,$e)=>Ve[$e>>>3]|=q<<7-($e&7)),new ln(R,f,Ve,y)}getModule(x,f){return 0<=x&&x<this.size&&0<=f&&f<this.size&&this.modules[f][x]}getModules(){return this.modules}drawFunctionPatterns(){for(let p=0;p<this.size;p++)this.setFunctionModule(6,p,p%2==0),this.setFunctionModule(p,6,p%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const x=this.getAlignmentPatternPositions(),f=x.length;for(let p=0;p<f;p++)for(let g=0;g<f;g++)p==0&&g==0||p==0&&g==f-1||p==f-1&&g==0||this.drawAlignmentPattern(x[p],x[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(x){const f=this.errorCorrectionLevel.formatBits<<3|x;let p=f;for(let y=0;y<10;y++)p=p<<1^(p>>>9)*1335;const g=(f<<10|p)^21522;s(g>>>15==0);for(let y=0;y<=5;y++)this.setFunctionModule(8,y,n(g,y));this.setFunctionModule(8,7,n(g,6)),this.setFunctionModule(8,8,n(g,7)),this.setFunctionModule(7,8,n(g,8));for(let y=9;y<15;y++)this.setFunctionModule(14-y,8,n(g,y));for(let y=0;y<8;y++)this.setFunctionModule(this.size-1-y,8,n(g,y));for(let y=8;y<15;y++)this.setFunctionModule(8,this.size-15+y,n(g,y));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let x=this.version;for(let p=0;p<12;p++)x=x<<1^(x>>>11)*7973;const f=this.version<<12|x;s(f>>>18==0);for(let p=0;p<18;p++){const g=n(f,p),y=this.size-11+p%3,w=Math.floor(p/3);this.setFunctionModule(y,w,g),this.setFunctionModule(w,y,g)}}drawFinderPattern(x,f){for(let p=-4;p<=4;p++)for(let g=-4;g<=4;g++){const y=Math.max(Math.abs(g),Math.abs(p)),w=x+g,R=f+p;0<=w&&w<this.size&&0<=R&&R<this.size&&this.setFunctionModule(w,R,y!=2&&y!=4)}}drawAlignmentPattern(x,f){for(let p=-2;p<=2;p++)for(let g=-2;g<=2;g++)this.setFunctionModule(x+g,f+p,Math.max(Math.abs(g),Math.abs(p))!=1)}setFunctionModule(x,f,p){this.modules[f][x]=p,this.isFunction[f][x]=!0}addEccAndInterleave(x){const f=this.version,p=this.errorCorrectionLevel;if(x.length!=ln.getNumDataCodewords(f,p))throw new RangeError("Invalid argument");const g=ln.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][f],y=ln.ECC_CODEWORDS_PER_BLOCK[p.ordinal][f],w=Math.floor(ln.getNumRawDataModules(f)/8),R=g-w%g,I=Math.floor(w/g);let k=[];const je=ln.reedSolomonComputeDivisor(y);for(let q=0,$e=0;q<g;q++){let We=x.slice($e,$e+I-y+(q<R?0:1));$e+=We.length;const K=ln.reedSolomonComputeRemainder(We,je);q<R&&We.push(0),k.push(We.concat(K))}let Ve=[];for(let q=0;q<k[0].length;q++)k.forEach(($e,We)=>{(q!=I-y||We>=R)&&Ve.push($e[q])});return s(Ve.length==w),Ve}drawCodewords(x){if(x.length!=Math.floor(ln.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let f=0;for(let p=this.size-1;p>=1;p-=2){p==6&&(p=5);for(let g=0;g<this.size;g++)for(let y=0;y<2;y++){const w=p-y,I=(p+1&2)==0?this.size-1-g:g;!this.isFunction[I][w]&&f<x.length*8&&(this.modules[I][w]=n(x[f>>>3],7-(f&7)),f++)}}s(f==x.length*8)}applyMask(x){if(x<0||x>7)throw new RangeError("Mask value out of range");for(let f=0;f<this.size;f++)for(let p=0;p<this.size;p++){let g;switch(x){case 0:g=(p+f)%2==0;break;case 1:g=f%2==0;break;case 2:g=p%3==0;break;case 3:g=(p+f)%3==0;break;case 4:g=(Math.floor(p/3)+Math.floor(f/2))%2==0;break;case 5:g=p*f%2+p*f%3==0;break;case 6:g=(p*f%2+p*f%3)%2==0;break;case 7:g=((p+f)%2+p*f%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[f][p]&&g&&(this.modules[f][p]=!this.modules[f][p])}}getPenaltyScore(){let x=0;for(let y=0;y<this.size;y++){let w=!1,R=0,I=[0,0,0,0,0,0,0];for(let k=0;k<this.size;k++)this.modules[y][k]==w?(R++,R==5?x+=ln.PENALTY_N1:R>5&&x++):(this.finderPenaltyAddHistory(R,I),w||(x+=this.finderPenaltyCountPatterns(I)*ln.PENALTY_N3),w=this.modules[y][k],R=1);x+=this.finderPenaltyTerminateAndCount(w,R,I)*ln.PENALTY_N3}for(let y=0;y<this.size;y++){let w=!1,R=0,I=[0,0,0,0,0,0,0];for(let k=0;k<this.size;k++)this.modules[k][y]==w?(R++,R==5?x+=ln.PENALTY_N1:R>5&&x++):(this.finderPenaltyAddHistory(R,I),w||(x+=this.finderPenaltyCountPatterns(I)*ln.PENALTY_N3),w=this.modules[k][y],R=1);x+=this.finderPenaltyTerminateAndCount(w,R,I)*ln.PENALTY_N3}for(let y=0;y<this.size-1;y++)for(let w=0;w<this.size-1;w++){const R=this.modules[y][w];R==this.modules[y][w+1]&&R==this.modules[y+1][w]&&R==this.modules[y+1][w+1]&&(x+=ln.PENALTY_N2)}let f=0;for(const y of this.modules)f=y.reduce((w,R)=>w+(R?1:0),f);const p=this.size*this.size,g=Math.ceil(Math.abs(f*20-p*10)/p)-1;return s(0<=g&&g<=9),x+=g*ln.PENALTY_N4,s(0<=x&&x<=2568888),x}getAlignmentPatternPositions(){if(this.version==1)return[];{const x=Math.floor(this.version/7)+2,f=this.version==32?26:Math.ceil((this.version*4+4)/(x*2-2))*2;let p=[6];for(let g=this.size-7;p.length<x;g-=f)p.splice(1,0,g);return p}}static getNumRawDataModules(x){if(x<ln.MIN_VERSION||x>ln.MAX_VERSION)throw new RangeError("Version number out of range");let f=(16*x+128)*x+64;if(x>=2){const p=Math.floor(x/7)+2;f-=(25*p-10)*p-55,x>=7&&(f-=36)}return s(208<=f&&f<=29648),f}static getNumDataCodewords(x,f){return Math.floor(ln.getNumRawDataModules(x)/8)-ln.ECC_CODEWORDS_PER_BLOCK[f.ordinal][x]*ln.NUM_ERROR_CORRECTION_BLOCKS[f.ordinal][x]}static reedSolomonComputeDivisor(x){if(x<1||x>255)throw new RangeError("Degree out of range");let f=[];for(let g=0;g<x-1;g++)f.push(0);f.push(1);let p=1;for(let g=0;g<x;g++){for(let y=0;y<f.length;y++)f[y]=ln.reedSolomonMultiply(f[y],p),y+1<f.length&&(f[y]^=f[y+1]);p=ln.reedSolomonMultiply(p,2)}return f}static reedSolomonComputeRemainder(x,f){let p=f.map(g=>0);for(const g of x){const y=g^p.shift();p.push(0),f.forEach((w,R)=>p[R]^=ln.reedSolomonMultiply(w,y))}return p}static reedSolomonMultiply(x,f){if(x>>>8||f>>>8)throw new RangeError("Byte out of range");let p=0;for(let g=7;g>=0;g--)p=p<<1^(p>>>7)*285,p^=(f>>>g&1)*x;return s(p>>>8==0),p}finderPenaltyCountPatterns(x){const f=x[1];s(f<=this.size*3);const p=f>0&&x[2]==f&&x[3]==f*3&&x[4]==f&&x[5]==f;return(p&&x[0]>=f*4&&x[6]>=f?1:0)+(p&&x[6]>=f*4&&x[0]>=f?1:0)}finderPenaltyTerminateAndCount(x,f,p){return x&&(this.finderPenaltyAddHistory(f,p),f=0),f+=this.size,this.finderPenaltyAddHistory(f,p),this.finderPenaltyCountPatterns(p)}finderPenaltyAddHistory(x,f){f[0]==0&&(x+=this.size),f.pop(),f.unshift(x)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;function r(u,x,f){if(x<0||x>31||u>>>x)throw new RangeError("Value out of range");for(let p=x-1;p>=0;p--)f.push(u>>>p&1)}function n(u,x){return(u>>>x&1)!=0}function s(u){if(!u)throw new Error("Assertion error")}const a=class In{constructor(x,f,p){if(this.mode=x,this.numChars=f,this.bitData=p,f<0)throw new RangeError("Invalid argument");this.bitData=p.slice()}static makeBytes(x){let f=[];for(const p of x)r(p,8,f);return new In(In.Mode.BYTE,x.length,f)}static makeNumeric(x){if(!In.isNumeric(x))throw new RangeError("String contains non-numeric characters");let f=[];for(let p=0;p<x.length;){const g=Math.min(x.length-p,3);r(parseInt(x.substring(p,p+g),10),g*3+1,f),p+=g}return new In(In.Mode.NUMERIC,x.length,f)}static makeAlphanumeric(x){if(!In.isAlphanumeric(x))throw new RangeError("String contains unencodable characters in alphanumeric mode");let f=[],p;for(p=0;p+2<=x.length;p+=2){let g=In.ALPHANUMERIC_CHARSET.indexOf(x.charAt(p))*45;g+=In.ALPHANUMERIC_CHARSET.indexOf(x.charAt(p+1)),r(g,11,f)}return p<x.length&&r(In.ALPHANUMERIC_CHARSET.indexOf(x.charAt(p)),6,f),new In(In.Mode.ALPHANUMERIC,x.length,f)}static makeSegments(x){return x==""?[]:In.isNumeric(x)?[In.makeNumeric(x)]:In.isAlphanumeric(x)?[In.makeAlphanumeric(x)]:[In.makeBytes(In.toUtf8ByteArray(x))]}static makeEci(x){let f=[];if(x<0)throw new RangeError("ECI assignment value out of range");if(x<128)r(x,8,f);else if(x<16384)r(2,2,f),r(x,14,f);else if(x<1e6)r(6,3,f),r(x,21,f);else throw new RangeError("ECI assignment value out of range");return new In(In.Mode.ECI,0,f)}static isNumeric(x){return In.NUMERIC_REGEX.test(x)}static isAlphanumeric(x){return In.ALPHANUMERIC_REGEX.test(x)}getData(){return this.bitData.slice()}static getTotalBits(x,f){let p=0;for(const g of x){const y=g.mode.numCharCountBits(f);if(g.numChars>=1<<y)return 1/0;p+=4+y+g.bitData.length}return p}static toUtf8ByteArray(x){x=encodeURI(x);let f=[];for(let p=0;p<x.length;p++)x.charAt(p)!="%"?f.push(x.charCodeAt(p)):(f.push(parseInt(x.substring(p+1,p+3),16)),p+=2);return f}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=a;e.QrSegment=a})(qrcodegen||(qrcodegen={}));(e=>{(t=>{const r=class{constructor(s,a){this.ordinal=s,this.formatBits=a}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),t.Ecc=r})(e.QrCode||(e.QrCode={}))})(qrcodegen||(qrcodegen={}));(e=>{(t=>{const r=class{constructor(s,a){this.modeBits=s,this.numBitsCharCount=a}numCharCountBits(s){return this.numBitsCharCount[Math.floor((s+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),t.Mode=r})(e.QrSegment||(e.QrSegment={}))})(qrcodegen||(qrcodegen={}));var qrcodegen_default=qrcodegen;var ERROR_LEVEL_MAP={L:qrcodegen_default.QrCode.Ecc.LOW,M:qrcodegen_default.QrCode.Ecc.MEDIUM,Q:qrcodegen_default.QrCode.Ecc.QUARTILE,H:qrcodegen_default.QrCode.Ecc.HIGH},DEFAULT_SIZE=128,DEFAULT_LEVEL="L",DEFAULT_BGCOLOR="#FFFFFF",DEFAULT_FGCOLOR="#000000",DEFAULT_INCLUDEMARGIN=!1,DEFAULT_MINVERSION=1,SPEC_MARGIN_SIZE=4,DEFAULT_MARGIN_SIZE=0,DEFAULT_IMG_SCALE=.1;function generatePath(e,t=0){const r=[];return e.forEach(function(n,s){let a=null;n.forEach(function(l,u){if(!l&&a!==null){r.push(`M${a+t} ${s+t}h${u-a}v1H${a+t}z`),a=null;return}if(u===n.length-1){if(!l)return;a===null?r.push(`M${u+t},${s+t} h1v1H${u+t}z`):r.push(`M${a+t},${s+t} h${u+1-a}v1H${a+t}z`);return}l&&a===null&&(a=u)})}),r.join("")}function excavateModules(e,t){return e.slice().map((r,n)=>n<t.y||n>=t.y+t.h?r:r.map((s,a)=>a<t.x||a>=t.x+t.w?s:!1))}function getImageSettings(e,t,r,n){if(n==null)return null;const s=e.length+r*2,a=Math.floor(t*DEFAULT_IMG_SCALE),l=s/t,u=(n.width||a)*l,x=(n.height||a)*l,f=n.x==null?e.length/2-u/2:n.x*l,p=n.y==null?e.length/2-x/2:n.y*l,g=n.opacity==null?1:n.opacity;let y=null;if(n.excavate){let R=Math.floor(f),I=Math.floor(p),k=Math.ceil(u+f-R),je=Math.ceil(x+p-I);y={x:R,y:I,w:k,h:je}}const w=n.crossOrigin;return{x:f,y:p,h:x,w:u,excavation:y,opacity:g,crossOrigin:w}}function getMarginSize(e,t){return t!=null?Math.max(Math.floor(t),0):e?SPEC_MARGIN_SIZE:DEFAULT_MARGIN_SIZE}function useQRCode({value:e,level:t,minVersion:r,includeMargin:n,marginSize:s,imageSettings:a,size:l,boostLevel:u}){let x=React.useMemo(()=>{const R=(Array.isArray(e)?e:[e]).reduce((I,k)=>(I.push(...qrcodegen_default.QrSegment.makeSegments(k)),I),[]);return qrcodegen_default.QrCode.encodeSegments(R,ERROR_LEVEL_MAP[t],r,void 0,void 0,u)},[e,t,r,u]);const{cells:f,margin:p,numCells:g,calculatedImageSettings:y}=React.useMemo(()=>{let w=x.getModules();const R=getMarginSize(n,s),I=w.length+R*2,k=getImageSettings(w,l,R,a);return{cells:w,margin:R,numCells:I,calculatedImageSettings:k}},[x,l,a,n,s]);return{qrcode:x,margin:p,cells:f,numCells:g,calculatedImageSettings:y}}var SUPPORTS_PATH2D=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),QRCodeCanvas=React.forwardRef(function(t,r){const n=t,{value:s,size:a=DEFAULT_SIZE,level:l=DEFAULT_LEVEL,bgColor:u=DEFAULT_BGCOLOR,fgColor:x=DEFAULT_FGCOLOR,includeMargin:f=DEFAULT_INCLUDEMARGIN,minVersion:p=DEFAULT_MINVERSION,boostLevel:g,marginSize:y,imageSettings:w}=n,I=__objRest(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:k}=I,je=__objRest(I,["style"]),Ve=w?.src,q=React.useRef(null),$e=React.useRef(null),We=React.useCallback(_e=>{q.current=_e,typeof r=="function"?r(_e):r&&(r.current=_e)},[r]),[K,W]=React.useState(!1),{margin:Ye,cells:Qe,numCells:it,calculatedImageSettings:ze}=useQRCode({value:s,level:l,minVersion:p,boostLevel:g,includeMargin:f,marginSize:y,imageSettings:w,size:a});React.useEffect(()=>{if(q.current!=null){const _e=q.current,P=_e.getContext("2d");if(!P)return;let Re=Qe;const Fe=$e.current,Le=ze!=null&&Fe!==null&&Fe.complete&&Fe.naturalHeight!==0&&Fe.naturalWidth!==0;Le&&ze.excavation!=null&&(Re=excavateModules(Qe,ze.excavation));const Ce=window.devicePixelRatio||1;_e.height=_e.width=a*Ce;const L=a/it*Ce;P.scale(L,L),P.fillStyle=u,P.fillRect(0,0,it,it),P.fillStyle=x,SUPPORTS_PATH2D?P.fill(new Path2D(generatePath(Re,Ye))):Qe.forEach(function(O,st){O.forEach(function(lt,Xe){lt&&P.fillRect(Xe+Ye,st+Ye,1,1)})}),ze&&(P.globalAlpha=ze.opacity),Le&&P.drawImage(Fe,ze.x+Ye,ze.y+Ye,ze.w,ze.h)}}),React.useEffect(()=>{W(!1)},[Ve]);const v=__spreadValues({height:a,width:a},k);let D=null;return Ve!=null&&(D=React.createElement("img",{src:Ve,key:Ve,style:{display:"none"},onLoad:()=>{W(!0)},ref:$e,crossOrigin:ze?.crossOrigin})),React.createElement(React.Fragment,null,React.createElement("canvas",__spreadValues({style:v,height:a,width:a,ref:We,role:"img"},je)),D)});QRCodeCanvas.displayName="QRCodeCanvas";var QRCodeSVG=React.forwardRef(function(t,r){const n=t,{value:s,size:a=DEFAULT_SIZE,level:l=DEFAULT_LEVEL,bgColor:u=DEFAULT_BGCOLOR,fgColor:x=DEFAULT_FGCOLOR,includeMargin:f=DEFAULT_INCLUDEMARGIN,minVersion:p=DEFAULT_MINVERSION,boostLevel:g,title:y,marginSize:w,imageSettings:R}=n,I=__objRest(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:k,cells:je,numCells:Ve,calculatedImageSettings:q}=useQRCode({value:s,level:l,minVersion:p,boostLevel:g,includeMargin:f,marginSize:w,imageSettings:R,size:a});let $e=je,We=null;R!=null&&q!=null&&(q.excavation!=null&&($e=excavateModules(je,q.excavation)),We=React.createElement("image",{href:R.src,height:q.h,width:q.w,x:q.x+k,y:q.y+k,preserveAspectRatio:"none",opacity:q.opacity,crossOrigin:q.crossOrigin}));const K=generatePath($e,k);return React.createElement("svg",__spreadValues({height:a,width:a,viewBox:`0 0 ${Ve} ${Ve}`,ref:r,role:"img"},I),!!y&&React.createElement("title",null,y),React.createElement("path",{fill:u,d:`M0,0 h${Ve}v${Ve}H0z`,shapeRendering:"crispEdges"}),React.createElement("path",{fill:x,d:K,shapeRendering:"crispEdges"}),We)});QRCodeSVG.displayName="QRCodeSVG";var dist$4={},ur={},errors$1={},hasRequiredErrors$1;function requireErrors$1(){if(hasRequiredErrors$1)return errors$1;hasRequiredErrors$1=1,Object.defineProperty(errors$1,"__esModule",{value:!0}),errors$1.InvalidChecksumError=errors$1.InvalidSequenceComponentError=errors$1.InvalidTypeError=errors$1.InvalidPathLengthError=errors$1.InvalidSchemeError=void 0;class e extends Error{constructor(){super("Invalid Scheme"),this.name="InvalidSchemeError"}}errors$1.InvalidSchemeError=e;class t extends Error{constructor(){super("Invalid Path"),this.name="InvalidPathLengthError"}}errors$1.InvalidPathLengthError=t;class r extends Error{constructor(){super("Invalid Type"),this.name="InvalidTypeError"}}errors$1.InvalidTypeError=r;class n extends Error{constructor(){super("Invalid Sequence Component"),this.name="InvalidSequenceComponentError"}}errors$1.InvalidSequenceComponentError=n;class s extends Error{constructor(){super("Invalid Checksum"),this.name="InvalidChecksumError"}}return errors$1.InvalidChecksumError=s,errors$1}var utils$7={},sha_js={exports:{}},inherits_browser={exports:{}},hasRequiredInherits_browser;function requireInherits_browser(){return hasRequiredInherits_browser||(hasRequiredInherits_browser=1,typeof Object.create=="function"?inherits_browser.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}}),inherits_browser.exports}var safeBuffer={exports:{}},dist$3={},hasRequiredDist$4;function requireDist$4(){return hasRequiredDist$4||(hasRequiredDist$4=1,(function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},r={};r.byteLength=p,r.toByteArray=y,r.fromByteArray=I;for(var n=[],s=[],a=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,x=l.length;u<x;++u)n[u]=l[u],s[l.charCodeAt(u)]=u;s[45]=62,s[95]=63;function f(Ve){var q=Ve.length;if(q%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var $e=Ve.indexOf("=");$e===-1&&($e=q);var We=$e===q?0:4-$e%4;return[$e,We]}function p(Ve){var q=f(Ve),$e=q[0],We=q[1];return($e+We)*3/4-We}function g(Ve,q,$e){return(q+$e)*3/4-$e}function y(Ve){var q,$e=f(Ve),We=$e[0],K=$e[1],W=new a(g(Ve,We,K)),Ye=0,Qe=K>0?We-4:We,it;for(it=0;it<Qe;it+=4)q=s[Ve.charCodeAt(it)]<<18|s[Ve.charCodeAt(it+1)]<<12|s[Ve.charCodeAt(it+2)]<<6|s[Ve.charCodeAt(it+3)],W[Ye++]=q>>16&255,W[Ye++]=q>>8&255,W[Ye++]=q&255;return K===2&&(q=s[Ve.charCodeAt(it)]<<2|s[Ve.charCodeAt(it+1)]>>4,W[Ye++]=q&255),K===1&&(q=s[Ve.charCodeAt(it)]<<10|s[Ve.charCodeAt(it+1)]<<4|s[Ve.charCodeAt(it+2)]>>2,W[Ye++]=q>>8&255,W[Ye++]=q&255),W}function w(Ve){return n[Ve>>18&63]+n[Ve>>12&63]+n[Ve>>6&63]+n[Ve&63]}function R(Ve,q,$e){for(var We,K=[],W=q;W<$e;W+=3)We=(Ve[W]<<16&16711680)+(Ve[W+1]<<8&65280)+(Ve[W+2]&255),K.push(w(We));return K.join("")}function I(Ve){for(var q,$e=Ve.length,We=$e%3,K=[],W=16383,Ye=0,Qe=$e-We;Ye<Qe;Ye+=W)K.push(R(Ve,Ye,Ye+W>Qe?Qe:Ye+W));return We===1?(q=Ve[$e-1],K.push(n[q>>2]+n[q<<4&63]+"==")):We===2&&(q=(Ve[$e-2]<<8)+Ve[$e-1],K.push(n[q>>10]+n[q>>4&63]+n[q<<2&63]+"=")),K.join("")}var k={};k.read=function(Ve,q,$e,We,K){var W,Ye,Qe=K*8-We-1,it=(1<<Qe)-1,ze=it>>1,v=-7,D=$e?K-1:0,_e=$e?-1:1,P=Ve[q+D];for(D+=_e,W=P&(1<<-v)-1,P>>=-v,v+=Qe;v>0;W=W*256+Ve[q+D],D+=_e,v-=8);for(Ye=W&(1<<-v)-1,W>>=-v,v+=We;v>0;Ye=Ye*256+Ve[q+D],D+=_e,v-=8);if(W===0)W=1-ze;else{if(W===it)return Ye?NaN:(P?-1:1)*(1/0);Ye=Ye+Math.pow(2,We),W=W-ze}return(P?-1:1)*Ye*Math.pow(2,W-We)},k.write=function(Ve,q,$e,We,K,W){var Ye,Qe,it,ze=W*8-K-1,v=(1<<ze)-1,D=v>>1,_e=K===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=We?0:W-1,Re=We?1:-1,Fe=q<0||q===0&&1/q<0?1:0;for(q=Math.abs(q),isNaN(q)||q===1/0?(Qe=isNaN(q)?1:0,Ye=v):(Ye=Math.floor(Math.log(q)/Math.LN2),q*(it=Math.pow(2,-Ye))<1&&(Ye--,it*=2),Ye+D>=1?q+=_e/it:q+=_e*Math.pow(2,1-D),q*it>=2&&(Ye++,it/=2),Ye+D>=v?(Qe=0,Ye=v):Ye+D>=1?(Qe=(q*it-1)*Math.pow(2,K),Ye=Ye+D):(Qe=q*Math.pow(2,D-1)*Math.pow(2,K),Ye=0));K>=8;Ve[$e+P]=Qe&255,P+=Re,Qe/=256,K-=8);for(Ye=Ye<<K|Qe,ze+=K;ze>0;Ve[$e+P]=Ye&255,P+=Re,Ye/=256,ze-=8);Ve[$e+P-Re]|=Fe*128};(function(Ve){const q=r,$e=k,We=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Ve.Buffer=v,Ve.SlowBuffer=lt,Ve.INSPECT_MAX_BYTES=50;const K=2147483647;Ve.kMaxLength=K;const{Uint8Array:W,ArrayBuffer:Ye,SharedArrayBuffer:Qe}=globalThis;v.TYPED_ARRAY_SUPPORT=it(),!v.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function it(){try{const fr=new W(1),ht={foo:function(){return 42}};return Object.setPrototypeOf(ht,W.prototype),Object.setPrototypeOf(fr,ht),fr.foo()===42}catch{return!1}}Object.defineProperty(v.prototype,"parent",{enumerable:!0,get:function(){if(v.isBuffer(this))return this.buffer}}),Object.defineProperty(v.prototype,"offset",{enumerable:!0,get:function(){if(v.isBuffer(this))return this.byteOffset}});function ze(fr){if(fr>K)throw new RangeError('The value "'+fr+'" is invalid for option "size"');const ht=new W(fr);return Object.setPrototypeOf(ht,v.prototype),ht}function v(fr,ht,Ft){if(typeof fr=="number"){if(typeof ht=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Re(fr)}return D(fr,ht,Ft)}v.poolSize=8192;function D(fr,ht,Ft){if(typeof fr=="string")return Fe(fr,ht);if(Ye.isView(fr))return Ce(fr);if(fr==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof fr);if(nn(fr,Ye)||fr&&nn(fr.buffer,Ye)||typeof Qe<"u"&&(nn(fr,Qe)||fr&&nn(fr.buffer,Qe)))return L(fr,ht,Ft);if(typeof fr=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const vr=fr.valueOf&&fr.valueOf();if(vr!=null&&vr!==fr)return v.from(vr,ht,Ft);const jr=O(fr);if(jr)return jr;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof fr[Symbol.toPrimitive]=="function")return v.from(fr[Symbol.toPrimitive]("string"),ht,Ft);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof fr)}v.from=function(fr,ht,Ft){return D(fr,ht,Ft)},Object.setPrototypeOf(v.prototype,W.prototype),Object.setPrototypeOf(v,W);function _e(fr){if(typeof fr!="number")throw new TypeError('"size" argument must be of type number');if(fr<0)throw new RangeError('The value "'+fr+'" is invalid for option "size"')}function P(fr,ht,Ft){return _e(fr),fr<=0?ze(fr):ht!==void 0?typeof Ft=="string"?ze(fr).fill(ht,Ft):ze(fr).fill(ht):ze(fr)}v.alloc=function(fr,ht,Ft){return P(fr,ht,Ft)};function Re(fr){return _e(fr),ze(fr<0?0:st(fr)|0)}v.allocUnsafe=function(fr){return Re(fr)},v.allocUnsafeSlow=function(fr){return Re(fr)};function Fe(fr,ht){if((typeof ht!="string"||ht==="")&&(ht="utf8"),!v.isEncoding(ht))throw new TypeError("Unknown encoding: "+ht);const Ft=Xe(fr,ht)|0;let vr=ze(Ft);const jr=vr.write(fr,ht);return jr!==Ft&&(vr=vr.slice(0,jr)),vr}function Le(fr){const ht=fr.length<0?0:st(fr.length)|0,Ft=ze(ht);for(let vr=0;vr<ht;vr+=1)Ft[vr]=fr[vr]&255;return Ft}function Ce(fr){if(nn(fr,W)){const ht=new W(fr);return L(ht.buffer,ht.byteOffset,ht.byteLength)}return Le(fr)}function L(fr,ht,Ft){if(ht<0||fr.byteLength<ht)throw new RangeError('"offset" is outside of buffer bounds');if(fr.byteLength<ht+(Ft||0))throw new RangeError('"length" is outside of buffer bounds');let vr;return ht===void 0&&Ft===void 0?vr=new W(fr):Ft===void 0?vr=new W(fr,ht):vr=new W(fr,ht,Ft),Object.setPrototypeOf(vr,v.prototype),vr}function O(fr){if(v.isBuffer(fr)){const ht=st(fr.length)|0,Ft=ze(ht);return Ft.length===0||fr.copy(Ft,0,0,ht),Ft}if(fr.length!==void 0)return typeof fr.length!="number"||Yn(fr.length)?ze(0):Le(fr);if(fr.type==="Buffer"&&Array.isArray(fr.data))return Le(fr.data)}function st(fr){if(fr>=K)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K.toString(16)+" bytes");return fr|0}function lt(fr){return+fr!=fr&&(fr=0),v.alloc(+fr)}v.isBuffer=function(ht){return ht!=null&&ht._isBuffer===!0&&ht!==v.prototype},v.compare=function(ht,Ft){if(nn(ht,W)&&(ht=v.from(ht,ht.offset,ht.byteLength)),nn(Ft,W)&&(Ft=v.from(Ft,Ft.offset,Ft.byteLength)),!v.isBuffer(ht)||!v.isBuffer(Ft))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ht===Ft)return 0;let vr=ht.length,jr=Ft.length;for(let Pr=0,Or=Math.min(vr,jr);Pr<Or;++Pr)if(ht[Pr]!==Ft[Pr]){vr=ht[Pr],jr=Ft[Pr];break}return vr<jr?-1:jr<vr?1:0},v.isEncoding=function(ht){switch(String(ht).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(ht,Ft){if(!Array.isArray(ht))throw new TypeError('"list" argument must be an Array of Buffers');if(ht.length===0)return v.alloc(0);let vr;if(Ft===void 0)for(Ft=0,vr=0;vr<ht.length;++vr)Ft+=ht[vr].length;const jr=v.allocUnsafe(Ft);let Pr=0;for(vr=0;vr<ht.length;++vr){let Or=ht[vr];if(nn(Or,W))Pr+Or.length>jr.length?(v.isBuffer(Or)||(Or=v.from(Or)),Or.copy(jr,Pr)):W.prototype.set.call(jr,Or,Pr);else if(v.isBuffer(Or))Or.copy(jr,Pr);else throw new TypeError('"list" argument must be an Array of Buffers');Pr+=Or.length}return jr};function Xe(fr,ht){if(v.isBuffer(fr))return fr.length;if(Ye.isView(fr)||nn(fr,Ye))return fr.byteLength;if(typeof fr!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof fr);const Ft=fr.length,vr=arguments.length>2&&arguments[2]===!0;if(!vr&&Ft===0)return 0;let jr=!1;for(;;)switch(ht){case"ascii":case"latin1":case"binary":return Ft;case"utf8":case"utf-8":return Gr(fr).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ft*2;case"hex":return Ft>>>1;case"base64":return Zr(fr).length;default:if(jr)return vr?-1:Gr(fr).length;ht=(""+ht).toLowerCase(),jr=!0}}v.byteLength=Xe;function dt(fr,ht,Ft){let vr=!1;if((ht===void 0||ht<0)&&(ht=0),ht>this.length||((Ft===void 0||Ft>this.length)&&(Ft=this.length),Ft<=0)||(Ft>>>=0,ht>>>=0,Ft<=ht))return"";for(fr||(fr="utf8");;)switch(fr){case"hex":return Cr(this,ht,Ft);case"utf8":case"utf-8":return gr(this,ht,Ft);case"ascii":return Er(this,ht,Ft);case"latin1":case"binary":return xr(this,ht,Ft);case"base64":return pr(this,ht,Ft);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return wr(this,ht,Ft);default:if(vr)throw new TypeError("Unknown encoding: "+fr);fr=(fr+"").toLowerCase(),vr=!0}}v.prototype._isBuffer=!0;function er(fr,ht,Ft){const vr=fr[ht];fr[ht]=fr[Ft],fr[Ft]=vr}v.prototype.swap16=function(){const ht=this.length;if(ht%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Ft=0;Ft<ht;Ft+=2)er(this,Ft,Ft+1);return this},v.prototype.swap32=function(){const ht=this.length;if(ht%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Ft=0;Ft<ht;Ft+=4)er(this,Ft,Ft+3),er(this,Ft+1,Ft+2);return this},v.prototype.swap64=function(){const ht=this.length;if(ht%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Ft=0;Ft<ht;Ft+=8)er(this,Ft,Ft+7),er(this,Ft+1,Ft+6),er(this,Ft+2,Ft+5),er(this,Ft+3,Ft+4);return this},v.prototype.toString=function(){const ht=this.length;return ht===0?"":arguments.length===0?gr(this,0,ht):dt.apply(this,arguments)},v.prototype.toLocaleString=v.prototype.toString,v.prototype.equals=function(ht){if(!v.isBuffer(ht))throw new TypeError("Argument must be a Buffer");return this===ht?!0:v.compare(this,ht)===0},v.prototype.inspect=function(){let ht="";const Ft=Ve.INSPECT_MAX_BYTES;return ht=this.toString("hex",0,Ft).replace(/(.{2})/g,"$1 ").trim(),this.length>Ft&&(ht+=" ... "),"<Buffer "+ht+">"},We&&(v.prototype[We]=v.prototype.inspect),v.prototype.compare=function(ht,Ft,vr,jr,Pr){if(nn(ht,W)&&(ht=v.from(ht,ht.offset,ht.byteLength)),!v.isBuffer(ht))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ht);if(Ft===void 0&&(Ft=0),vr===void 0&&(vr=ht?ht.length:0),jr===void 0&&(jr=0),Pr===void 0&&(Pr=this.length),Ft<0||vr>ht.length||jr<0||Pr>this.length)throw new RangeError("out of range index");if(jr>=Pr&&Ft>=vr)return 0;if(jr>=Pr)return-1;if(Ft>=vr)return 1;if(Ft>>>=0,vr>>>=0,jr>>>=0,Pr>>>=0,this===ht)return 0;let Or=Pr-jr,Xr=vr-Ft;const An=Math.min(Or,Xr),tn=this.slice(jr,Pr),Jr=ht.slice(Ft,vr);for(let rn=0;rn<An;++rn)if(tn[rn]!==Jr[rn]){Or=tn[rn],Xr=Jr[rn];break}return Or<Xr?-1:Xr<Or?1:0};function ar(fr,ht,Ft,vr,jr){if(fr.length===0)return-1;if(typeof Ft=="string"?(vr=Ft,Ft=0):Ft>2147483647?Ft=2147483647:Ft<-2147483648&&(Ft=-2147483648),Ft=+Ft,Yn(Ft)&&(Ft=jr?0:fr.length-1),Ft<0&&(Ft=fr.length+Ft),Ft>=fr.length){if(jr)return-1;Ft=fr.length-1}else if(Ft<0)if(jr)Ft=0;else return-1;if(typeof ht=="string"&&(ht=v.from(ht,vr)),v.isBuffer(ht))return ht.length===0?-1:dr(fr,ht,Ft,vr,jr);if(typeof ht=="number")return ht=ht&255,typeof W.prototype.indexOf=="function"?jr?W.prototype.indexOf.call(fr,ht,Ft):W.prototype.lastIndexOf.call(fr,ht,Ft):dr(fr,[ht],Ft,vr,jr);throw new TypeError("val must be string, number or Buffer")}function dr(fr,ht,Ft,vr,jr){let Pr=1,Or=fr.length,Xr=ht.length;if(vr!==void 0&&(vr=String(vr).toLowerCase(),vr==="ucs2"||vr==="ucs-2"||vr==="utf16le"||vr==="utf-16le")){if(fr.length<2||ht.length<2)return-1;Pr=2,Or/=2,Xr/=2,Ft/=2}function An(Jr,rn){return Pr===1?Jr[rn]:Jr.readUInt16BE(rn*Pr)}let tn;if(jr){let Jr=-1;for(tn=Ft;tn<Or;tn++)if(An(fr,tn)===An(ht,Jr===-1?0:tn-Jr)){if(Jr===-1&&(Jr=tn),tn-Jr+1===Xr)return Jr*Pr}else Jr!==-1&&(tn-=tn-Jr),Jr=-1}else for(Ft+Xr>Or&&(Ft=Or-Xr),tn=Ft;tn>=0;tn--){let Jr=!0;for(let rn=0;rn<Xr;rn++)if(An(fr,tn+rn)!==An(ht,rn)){Jr=!1;break}if(Jr)return tn}return-1}v.prototype.includes=function(ht,Ft,vr){return this.indexOf(ht,Ft,vr)!==-1},v.prototype.indexOf=function(ht,Ft,vr){return ar(this,ht,Ft,vr,!0)},v.prototype.lastIndexOf=function(ht,Ft,vr){return ar(this,ht,Ft,vr,!1)};function ir(fr,ht,Ft,vr){Ft=Number(Ft)||0;const jr=fr.length-Ft;vr?(vr=Number(vr),vr>jr&&(vr=jr)):vr=jr;const Pr=ht.length;vr>Pr/2&&(vr=Pr/2);let Or;for(Or=0;Or<vr;++Or){const Xr=parseInt(ht.substr(Or*2,2),16);if(Yn(Xr))return Or;fr[Ft+Or]=Xr}return Or}function pt(fr,ht,Ft,vr){return xn(Gr(ht,fr.length-Ft),fr,Ft,vr)}function tr(fr,ht,Ft,vr){return xn(Vr(ht),fr,Ft,vr)}function sr(fr,ht,Ft,vr){return xn(Zr(ht),fr,Ft,vr)}function nr(fr,ht,Ft,vr){return xn(zr(ht,fr.length-Ft),fr,Ft,vr)}v.prototype.write=function(ht,Ft,vr,jr){if(Ft===void 0)jr="utf8",vr=this.length,Ft=0;else if(vr===void 0&&typeof Ft=="string")jr=Ft,vr=this.length,Ft=0;else if(isFinite(Ft))Ft=Ft>>>0,isFinite(vr)?(vr=vr>>>0,jr===void 0&&(jr="utf8")):(jr=vr,vr=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Pr=this.length-Ft;if((vr===void 0||vr>Pr)&&(vr=Pr),ht.length>0&&(vr<0||Ft<0)||Ft>this.length)throw new RangeError("Attempt to write outside buffer bounds");jr||(jr="utf8");let Or=!1;for(;;)switch(jr){case"hex":return ir(this,ht,Ft,vr);case"utf8":case"utf-8":return pt(this,ht,Ft,vr);case"ascii":case"latin1":case"binary":return tr(this,ht,Ft,vr);case"base64":return sr(this,ht,Ft,vr);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return nr(this,ht,Ft,vr);default:if(Or)throw new TypeError("Unknown encoding: "+jr);jr=(""+jr).toLowerCase(),Or=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function pr(fr,ht,Ft){return ht===0&&Ft===fr.length?q.fromByteArray(fr):q.fromByteArray(fr.slice(ht,Ft))}function gr(fr,ht,Ft){Ft=Math.min(fr.length,Ft);const vr=[];let jr=ht;for(;jr<Ft;){const Pr=fr[jr];let Or=null,Xr=Pr>239?4:Pr>223?3:Pr>191?2:1;if(jr+Xr<=Ft){let An,tn,Jr,rn;switch(Xr){case 1:Pr<128&&(Or=Pr);break;case 2:An=fr[jr+1],(An&192)===128&&(rn=(Pr&31)<<6|An&63,rn>127&&(Or=rn));break;case 3:An=fr[jr+1],tn=fr[jr+2],(An&192)===128&&(tn&192)===128&&(rn=(Pr&15)<<12|(An&63)<<6|tn&63,rn>2047&&(rn<55296||rn>57343)&&(Or=rn));break;case 4:An=fr[jr+1],tn=fr[jr+2],Jr=fr[jr+3],(An&192)===128&&(tn&192)===128&&(Jr&192)===128&&(rn=(Pr&15)<<18|(An&63)<<12|(tn&63)<<6|Jr&63,rn>65535&&rn<1114112&&(Or=rn))}}Or===null?(Or=65533,Xr=1):Or>65535&&(Or-=65536,vr.push(Or>>>10&1023|55296),Or=56320|Or&1023),vr.push(Or),jr+=Xr}return yr(vr)}const mr=4096;function yr(fr){const ht=fr.length;if(ht<=mr)return String.fromCharCode.apply(String,fr);let Ft="",vr=0;for(;vr<ht;)Ft+=String.fromCharCode.apply(String,fr.slice(vr,vr+=mr));return Ft}function Er(fr,ht,Ft){let vr="";Ft=Math.min(fr.length,Ft);for(let jr=ht;jr<Ft;++jr)vr+=String.fromCharCode(fr[jr]&127);return vr}function xr(fr,ht,Ft){let vr="";Ft=Math.min(fr.length,Ft);for(let jr=ht;jr<Ft;++jr)vr+=String.fromCharCode(fr[jr]);return vr}function Cr(fr,ht,Ft){const vr=fr.length;(!ht||ht<0)&&(ht=0),(!Ft||Ft<0||Ft>vr)&&(Ft=vr);let jr="";for(let Pr=ht;Pr<Ft;++Pr)jr+=vn[fr[Pr]];return jr}function wr(fr,ht,Ft){const vr=fr.slice(ht,Ft);let jr="";for(let Pr=0;Pr<vr.length-1;Pr+=2)jr+=String.fromCharCode(vr[Pr]+vr[Pr+1]*256);return jr}v.prototype.slice=function(ht,Ft){const vr=this.length;ht=~~ht,Ft=Ft===void 0?vr:~~Ft,ht<0?(ht+=vr,ht<0&&(ht=0)):ht>vr&&(ht=vr),Ft<0?(Ft+=vr,Ft<0&&(Ft=0)):Ft>vr&&(Ft=vr),Ft<ht&&(Ft=ht);const jr=this.subarray(ht,Ft);return Object.setPrototypeOf(jr,v.prototype),jr};function kr(fr,ht,Ft){if(fr%1!==0||fr<0)throw new RangeError("offset is not uint");if(fr+ht>Ft)throw new RangeError("Trying to access beyond buffer length")}v.prototype.readUintLE=v.prototype.readUIntLE=function(ht,Ft,vr){ht=ht>>>0,Ft=Ft>>>0,vr||kr(ht,Ft,this.length);let jr=this[ht],Pr=1,Or=0;for(;++Or<Ft&&(Pr*=256);)jr+=this[ht+Or]*Pr;return jr},v.prototype.readUintBE=v.prototype.readUIntBE=function(ht,Ft,vr){ht=ht>>>0,Ft=Ft>>>0,vr||kr(ht,Ft,this.length);let jr=this[ht+--Ft],Pr=1;for(;Ft>0&&(Pr*=256);)jr+=this[ht+--Ft]*Pr;return jr},v.prototype.readUint8=v.prototype.readUInt8=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,1,this.length),this[ht]},v.prototype.readUint16LE=v.prototype.readUInt16LE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,2,this.length),this[ht]|this[ht+1]<<8},v.prototype.readUint16BE=v.prototype.readUInt16BE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,2,this.length),this[ht]<<8|this[ht+1]},v.prototype.readUint32LE=v.prototype.readUInt32LE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,4,this.length),(this[ht]|this[ht+1]<<8|this[ht+2]<<16)+this[ht+3]*16777216},v.prototype.readUint32BE=v.prototype.readUInt32BE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,4,this.length),this[ht]*16777216+(this[ht+1]<<16|this[ht+2]<<8|this[ht+3])},v.prototype.readBigUInt64LE=gn(function(ht){ht=ht>>>0,Ar(ht,"offset");const Ft=this[ht],vr=this[ht+7];(Ft===void 0||vr===void 0)&&_r(ht,this.length-8);const jr=Ft+this[++ht]*2**8+this[++ht]*2**16+this[++ht]*2**24,Pr=this[++ht]+this[++ht]*2**8+this[++ht]*2**16+vr*2**24;return BigInt(jr)+(BigInt(Pr)<<BigInt(32))}),v.prototype.readBigUInt64BE=gn(function(ht){ht=ht>>>0,Ar(ht,"offset");const Ft=this[ht],vr=this[ht+7];(Ft===void 0||vr===void 0)&&_r(ht,this.length-8);const jr=Ft*2**24+this[++ht]*2**16+this[++ht]*2**8+this[++ht],Pr=this[++ht]*2**24+this[++ht]*2**16+this[++ht]*2**8+vr;return(BigInt(jr)<<BigInt(32))+BigInt(Pr)}),v.prototype.readIntLE=function(ht,Ft,vr){ht=ht>>>0,Ft=Ft>>>0,vr||kr(ht,Ft,this.length);let jr=this[ht],Pr=1,Or=0;for(;++Or<Ft&&(Pr*=256);)jr+=this[ht+Or]*Pr;return Pr*=128,jr>=Pr&&(jr-=Math.pow(2,8*Ft)),jr},v.prototype.readIntBE=function(ht,Ft,vr){ht=ht>>>0,Ft=Ft>>>0,vr||kr(ht,Ft,this.length);let jr=Ft,Pr=1,Or=this[ht+--jr];for(;jr>0&&(Pr*=256);)Or+=this[ht+--jr]*Pr;return Pr*=128,Or>=Pr&&(Or-=Math.pow(2,8*Ft)),Or},v.prototype.readInt8=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,1,this.length),this[ht]&128?(255-this[ht]+1)*-1:this[ht]},v.prototype.readInt16LE=function(ht,Ft){ht=ht>>>0,Ft||kr(ht,2,this.length);const vr=this[ht]|this[ht+1]<<8;return vr&32768?vr|4294901760:vr},v.prototype.readInt16BE=function(ht,Ft){ht=ht>>>0,Ft||kr(ht,2,this.length);const vr=this[ht+1]|this[ht]<<8;return vr&32768?vr|4294901760:vr},v.prototype.readInt32LE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,4,this.length),this[ht]|this[ht+1]<<8|this[ht+2]<<16|this[ht+3]<<24},v.prototype.readInt32BE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,4,this.length),this[ht]<<24|this[ht+1]<<16|this[ht+2]<<8|this[ht+3]},v.prototype.readBigInt64LE=gn(function(ht){ht=ht>>>0,Ar(ht,"offset");const Ft=this[ht],vr=this[ht+7];(Ft===void 0||vr===void 0)&&_r(ht,this.length-8);const jr=this[ht+4]+this[ht+5]*2**8+this[ht+6]*2**16+(vr<<24);return(BigInt(jr)<<BigInt(32))+BigInt(Ft+this[++ht]*2**8+this[++ht]*2**16+this[++ht]*2**24)}),v.prototype.readBigInt64BE=gn(function(ht){ht=ht>>>0,Ar(ht,"offset");const Ft=this[ht],vr=this[ht+7];(Ft===void 0||vr===void 0)&&_r(ht,this.length-8);const jr=(Ft<<24)+this[++ht]*2**16+this[++ht]*2**8+this[++ht];return(BigInt(jr)<<BigInt(32))+BigInt(this[++ht]*2**24+this[++ht]*2**16+this[++ht]*2**8+vr)}),v.prototype.readFloatLE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,4,this.length),$e.read(this,ht,!0,23,4)},v.prototype.readFloatBE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,4,this.length),$e.read(this,ht,!1,23,4)},v.prototype.readDoubleLE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,8,this.length),$e.read(this,ht,!0,52,8)},v.prototype.readDoubleBE=function(ht,Ft){return ht=ht>>>0,Ft||kr(ht,8,this.length),$e.read(this,ht,!1,52,8)};function Dr(fr,ht,Ft,vr,jr,Pr){if(!v.isBuffer(fr))throw new TypeError('"buffer" argument must be a Buffer instance');if(ht>jr||ht<Pr)throw new RangeError('"value" argument is out of bounds');if(Ft+vr>fr.length)throw new RangeError("Index out of range")}v.prototype.writeUintLE=v.prototype.writeUIntLE=function(ht,Ft,vr,jr){if(ht=+ht,Ft=Ft>>>0,vr=vr>>>0,!jr){const Xr=Math.pow(2,8*vr)-1;Dr(this,ht,Ft,vr,Xr,0)}let Pr=1,Or=0;for(this[Ft]=ht&255;++Or<vr&&(Pr*=256);)this[Ft+Or]=ht/Pr&255;return Ft+vr},v.prototype.writeUintBE=v.prototype.writeUIntBE=function(ht,Ft,vr,jr){if(ht=+ht,Ft=Ft>>>0,vr=vr>>>0,!jr){const Xr=Math.pow(2,8*vr)-1;Dr(this,ht,Ft,vr,Xr,0)}let Pr=vr-1,Or=1;for(this[Ft+Pr]=ht&255;--Pr>=0&&(Or*=256);)this[Ft+Pr]=ht/Or&255;return Ft+vr},v.prototype.writeUint8=v.prototype.writeUInt8=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,1,255,0),this[Ft]=ht&255,Ft+1},v.prototype.writeUint16LE=v.prototype.writeUInt16LE=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,2,65535,0),this[Ft]=ht&255,this[Ft+1]=ht>>>8,Ft+2},v.prototype.writeUint16BE=v.prototype.writeUInt16BE=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,2,65535,0),this[Ft]=ht>>>8,this[Ft+1]=ht&255,Ft+2},v.prototype.writeUint32LE=v.prototype.writeUInt32LE=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,4,4294967295,0),this[Ft+3]=ht>>>24,this[Ft+2]=ht>>>16,this[Ft+1]=ht>>>8,this[Ft]=ht&255,Ft+4},v.prototype.writeUint32BE=v.prototype.writeUInt32BE=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,4,4294967295,0),this[Ft]=ht>>>24,this[Ft+1]=ht>>>16,this[Ft+2]=ht>>>8,this[Ft+3]=ht&255,Ft+4};function rr(fr,ht,Ft,vr,jr){or(ht,vr,jr,fr,Ft,7);let Pr=Number(ht&BigInt(4294967295));fr[Ft++]=Pr,Pr=Pr>>8,fr[Ft++]=Pr,Pr=Pr>>8,fr[Ft++]=Pr,Pr=Pr>>8,fr[Ft++]=Pr;let Or=Number(ht>>BigInt(32)&BigInt(4294967295));return fr[Ft++]=Or,Or=Or>>8,fr[Ft++]=Or,Or=Or>>8,fr[Ft++]=Or,Or=Or>>8,fr[Ft++]=Or,Ft}function cr(fr,ht,Ft,vr,jr){or(ht,vr,jr,fr,Ft,7);let Pr=Number(ht&BigInt(4294967295));fr[Ft+7]=Pr,Pr=Pr>>8,fr[Ft+6]=Pr,Pr=Pr>>8,fr[Ft+5]=Pr,Pr=Pr>>8,fr[Ft+4]=Pr;let Or=Number(ht>>BigInt(32)&BigInt(4294967295));return fr[Ft+3]=Or,Or=Or>>8,fr[Ft+2]=Or,Or=Or>>8,fr[Ft+1]=Or,Or=Or>>8,fr[Ft]=Or,Ft+8}v.prototype.writeBigUInt64LE=gn(function(ht,Ft=0){return rr(this,ht,Ft,BigInt(0),BigInt("0xffffffffffffffff"))}),v.prototype.writeBigUInt64BE=gn(function(ht,Ft=0){return cr(this,ht,Ft,BigInt(0),BigInt("0xffffffffffffffff"))}),v.prototype.writeIntLE=function(ht,Ft,vr,jr){if(ht=+ht,Ft=Ft>>>0,!jr){const An=Math.pow(2,8*vr-1);Dr(this,ht,Ft,vr,An-1,-An)}let Pr=0,Or=1,Xr=0;for(this[Ft]=ht&255;++Pr<vr&&(Or*=256);)ht<0&&Xr===0&&this[Ft+Pr-1]!==0&&(Xr=1),this[Ft+Pr]=(ht/Or>>0)-Xr&255;return Ft+vr},v.prototype.writeIntBE=function(ht,Ft,vr,jr){if(ht=+ht,Ft=Ft>>>0,!jr){const An=Math.pow(2,8*vr-1);Dr(this,ht,Ft,vr,An-1,-An)}let Pr=vr-1,Or=1,Xr=0;for(this[Ft+Pr]=ht&255;--Pr>=0&&(Or*=256);)ht<0&&Xr===0&&this[Ft+Pr+1]!==0&&(Xr=1),this[Ft+Pr]=(ht/Or>>0)-Xr&255;return Ft+vr},v.prototype.writeInt8=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,1,127,-128),ht<0&&(ht=255+ht+1),this[Ft]=ht&255,Ft+1},v.prototype.writeInt16LE=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,2,32767,-32768),this[Ft]=ht&255,this[Ft+1]=ht>>>8,Ft+2},v.prototype.writeInt16BE=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,2,32767,-32768),this[Ft]=ht>>>8,this[Ft+1]=ht&255,Ft+2},v.prototype.writeInt32LE=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,4,2147483647,-2147483648),this[Ft]=ht&255,this[Ft+1]=ht>>>8,this[Ft+2]=ht>>>16,this[Ft+3]=ht>>>24,Ft+4},v.prototype.writeInt32BE=function(ht,Ft,vr){return ht=+ht,Ft=Ft>>>0,vr||Dr(this,ht,Ft,4,2147483647,-2147483648),ht<0&&(ht=4294967295+ht+1),this[Ft]=ht>>>24,this[Ft+1]=ht>>>16,this[Ft+2]=ht>>>8,this[Ft+3]=ht&255,Ft+4},v.prototype.writeBigInt64LE=gn(function(ht,Ft=0){return rr(this,ht,Ft,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),v.prototype.writeBigInt64BE=gn(function(ht,Ft=0){return cr(this,ht,Ft,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Br(fr,ht,Ft,vr,jr,Pr){if(Ft+vr>fr.length)throw new RangeError("Index out of range");if(Ft<0)throw new RangeError("Index out of range")}function br(fr,ht,Ft,vr,jr){return ht=+ht,Ft=Ft>>>0,jr||Br(fr,ht,Ft,4),$e.write(fr,ht,Ft,vr,23,4),Ft+4}v.prototype.writeFloatLE=function(ht,Ft,vr){return br(this,ht,Ft,!0,vr)},v.prototype.writeFloatBE=function(ht,Ft,vr){return br(this,ht,Ft,!1,vr)};function lr(fr,ht,Ft,vr,jr){return ht=+ht,Ft=Ft>>>0,jr||Br(fr,ht,Ft,8),$e.write(fr,ht,Ft,vr,52,8),Ft+8}v.prototype.writeDoubleLE=function(ht,Ft,vr){return lr(this,ht,Ft,!0,vr)},v.prototype.writeDoubleBE=function(ht,Ft,vr){return lr(this,ht,Ft,!1,vr)},v.prototype.copy=function(ht,Ft,vr,jr){if(!v.isBuffer(ht))throw new TypeError("argument should be a Buffer");if(vr||(vr=0),!jr&&jr!==0&&(jr=this.length),Ft>=ht.length&&(Ft=ht.length),Ft||(Ft=0),jr>0&&jr<vr&&(jr=vr),jr===vr||ht.length===0||this.length===0)return 0;if(Ft<0)throw new RangeError("targetStart out of bounds");if(vr<0||vr>=this.length)throw new RangeError("Index out of range");if(jr<0)throw new RangeError("sourceEnd out of bounds");jr>this.length&&(jr=this.length),ht.length-Ft<jr-vr&&(jr=ht.length-Ft+vr);const Pr=jr-vr;return this===ht&&typeof W.prototype.copyWithin=="function"?this.copyWithin(Ft,vr,jr):W.prototype.set.call(ht,this.subarray(vr,jr),Ft),Pr},v.prototype.fill=function(ht,Ft,vr,jr){if(typeof ht=="string"){if(typeof Ft=="string"?(jr=Ft,Ft=0,vr=this.length):typeof vr=="string"&&(jr=vr,vr=this.length),jr!==void 0&&typeof jr!="string")throw new TypeError("encoding must be a string");if(typeof jr=="string"&&!v.isEncoding(jr))throw new TypeError("Unknown encoding: "+jr);if(ht.length===1){const Or=ht.charCodeAt(0);(jr==="utf8"&&Or<128||jr==="latin1")&&(ht=Or)}}else typeof ht=="number"?ht=ht&255:typeof ht=="boolean"&&(ht=Number(ht));if(Ft<0||this.length<Ft||this.length<vr)throw new RangeError("Out of range index");if(vr<=Ft)return this;Ft=Ft>>>0,vr=vr===void 0?this.length:vr>>>0,ht||(ht=0);let Pr;if(typeof ht=="number")for(Pr=Ft;Pr<vr;++Pr)this[Pr]=ht;else{const Or=v.isBuffer(ht)?ht:v.from(ht,jr),Xr=Or.length;if(Xr===0)throw new TypeError('The value "'+ht+'" is invalid for argument "value"');for(Pr=0;Pr<vr-Ft;++Pr)this[Pr+Ft]=Or[Pr%Xr]}return this};const Sr={};function yt(fr,ht,Ft){Sr[fr]=class extends Ft{constructor(){super(),Object.defineProperty(this,"message",{value:ht.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${fr}]`,this.stack,delete this.name}get code(){return fr}set code(jr){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:jr,writable:!0})}toString(){return`${this.name} [${fr}]: ${this.message}`}}}yt("ERR_BUFFER_OUT_OF_BOUNDS",function(fr){return fr?`${fr} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),yt("ERR_INVALID_ARG_TYPE",function(fr,ht){return`The "${fr}" argument must be of type number. Received type ${typeof ht}`},TypeError),yt("ERR_OUT_OF_RANGE",function(fr,ht,Ft){let vr=`The value of "${fr}" is out of range.`,jr=Ft;return Number.isInteger(Ft)&&Math.abs(Ft)>2**32?jr=Je(String(Ft)):typeof Ft=="bigint"&&(jr=String(Ft),(Ft>BigInt(2)**BigInt(32)||Ft<-(BigInt(2)**BigInt(32)))&&(jr=Je(jr)),jr+="n"),vr+=` It must be ${ht}. Received ${jr}`,vr},RangeError);function Je(fr){let ht="",Ft=fr.length;const vr=fr[0]==="-"?1:0;for(;Ft>=vr+4;Ft-=3)ht=`_${fr.slice(Ft-3,Ft)}${ht}`;return`${fr.slice(0,Ft)}${ht}`}function ft(fr,ht,Ft){Ar(ht,"offset"),(fr[ht]===void 0||fr[ht+Ft]===void 0)&&_r(ht,fr.length-(Ft+1))}function or(fr,ht,Ft,vr,jr,Pr){if(fr>Ft||fr<ht){const Or=typeof ht=="bigint"?"n":"";let Xr;throw ht===0||ht===BigInt(0)?Xr=`>= 0${Or} and < 2${Or} ** ${(Pr+1)*8}${Or}`:Xr=`>= -(2${Or} ** ${(Pr+1)*8-1}${Or}) and < 2 ** ${(Pr+1)*8-1}${Or}`,new Sr.ERR_OUT_OF_RANGE("value",Xr,fr)}ft(vr,jr,Pr)}function Ar(fr,ht){if(typeof fr!="number")throw new Sr.ERR_INVALID_ARG_TYPE(ht,"number",fr)}function _r(fr,ht,Ft){throw Math.floor(fr)!==fr?(Ar(fr,Ft),new Sr.ERR_OUT_OF_RANGE("offset","an integer",fr)):ht<0?new Sr.ERR_BUFFER_OUT_OF_BOUNDS:new Sr.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${ht}`,fr)}const Nr=/[^+/0-9A-Za-z-_]/g;function Hr(fr){if(fr=fr.split("=")[0],fr=fr.trim().replace(Nr,""),fr.length<2)return"";for(;fr.length%4!==0;)fr=fr+"=";return fr}function Gr(fr,ht){ht=ht||1/0;let Ft;const vr=fr.length;let jr=null;const Pr=[];for(let Or=0;Or<vr;++Or){if(Ft=fr.charCodeAt(Or),Ft>55295&&Ft<57344){if(!jr){if(Ft>56319){(ht-=3)>-1&&Pr.push(239,191,189);continue}else if(Or+1===vr){(ht-=3)>-1&&Pr.push(239,191,189);continue}jr=Ft;continue}if(Ft<56320){(ht-=3)>-1&&Pr.push(239,191,189),jr=Ft;continue}Ft=(jr-55296<<10|Ft-56320)+65536}else jr&&(ht-=3)>-1&&Pr.push(239,191,189);if(jr=null,Ft<128){if((ht-=1)<0)break;Pr.push(Ft)}else if(Ft<2048){if((ht-=2)<0)break;Pr.push(Ft>>6|192,Ft&63|128)}else if(Ft<65536){if((ht-=3)<0)break;Pr.push(Ft>>12|224,Ft>>6&63|128,Ft&63|128)}else if(Ft<1114112){if((ht-=4)<0)break;Pr.push(Ft>>18|240,Ft>>12&63|128,Ft>>6&63|128,Ft&63|128)}else throw new Error("Invalid code point")}return Pr}function Vr(fr){const ht=[];for(let Ft=0;Ft<fr.length;++Ft)ht.push(fr.charCodeAt(Ft)&255);return ht}function zr(fr,ht){let Ft,vr,jr;const Pr=[];for(let Or=0;Or<fr.length&&!((ht-=2)<0);++Or)Ft=fr.charCodeAt(Or),vr=Ft>>8,jr=Ft%256,Pr.push(jr),Pr.push(vr);return Pr}function Zr(fr){return q.toByteArray(Hr(fr))}function xn(fr,ht,Ft,vr){let jr;for(jr=0;jr<vr&&!(jr+Ft>=ht.length||jr>=fr.length);++jr)ht[jr+Ft]=fr[jr];return jr}function nn(fr,ht){return fr instanceof ht||fr!=null&&fr.constructor!=null&&fr.constructor.name!=null&&fr.constructor.name===ht.name}function Yn(fr){return fr!==fr}const vn=(function(){const fr="0123456789abcdef",ht=new Array(256);for(let Ft=0;Ft<16;++Ft){const vr=Ft*16;for(let jr=0;jr<16;++jr)ht[vr+jr]=fr[Ft]+fr[jr]}return ht})();function gn(fr){return typeof BigInt>"u"?Ai:fr}function Ai(){throw new Error("BigInt not supported")}})(t);const je=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=je,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode})(dist$3)),dist$3}var hasRequiredSafeBuffer;function requireSafeBuffer(){return hasRequiredSafeBuffer||(hasRequiredSafeBuffer=1,(function(e,t){var r=requireDist$4(),n=r.Buffer;function s(l,u){for(var x in l)u[x]=l[x]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(s(r,t),t.Buffer=a);function a(l,u,x){return n(l,u,x)}a.prototype=Object.create(n.prototype),s(n,a),a.from=function(l,u,x){if(typeof l=="number")throw new TypeError("Argument must not be a number");return n(l,u,x)},a.alloc=function(l,u,x){if(typeof l!="number")throw new TypeError("Argument must be a number");var f=n(l);return u!==void 0?typeof x=="string"?f.fill(u,x):f.fill(u):f.fill(0),f},a.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return n(l)},a.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(l)}})(safeBuffer,safeBuffer.exports)),safeBuffer.exports}var isarray,hasRequiredIsarray;function requireIsarray(){if(hasRequiredIsarray)return isarray;hasRequiredIsarray=1;var e={}.toString;return isarray=Array.isArray||function(t){return e.call(t)=="[object Array]"},isarray}var type,hasRequiredType;function requireType(){return hasRequiredType||(hasRequiredType=1,type=TypeError),type}var esObjectAtoms,hasRequiredEsObjectAtoms;function requireEsObjectAtoms(){return hasRequiredEsObjectAtoms||(hasRequiredEsObjectAtoms=1,esObjectAtoms=Object),esObjectAtoms}var esErrors,hasRequiredEsErrors;function requireEsErrors(){return hasRequiredEsErrors||(hasRequiredEsErrors=1,esErrors=Error),esErrors}var _eval,hasRequired_eval;function require_eval(){return hasRequired_eval||(hasRequired_eval=1,_eval=EvalError),_eval}var range$4,hasRequiredRange;function requireRange(){return hasRequiredRange||(hasRequiredRange=1,range$4=RangeError),range$4}var ref,hasRequiredRef;function requireRef(){return hasRequiredRef||(hasRequiredRef=1,ref=ReferenceError),ref}var syntax,hasRequiredSyntax;function requireSyntax(){return hasRequiredSyntax||(hasRequiredSyntax=1,syntax=SyntaxError),syntax}var uri,hasRequiredUri;function requireUri(){return hasRequiredUri||(hasRequiredUri=1,uri=URIError),uri}var abs,hasRequiredAbs;function requireAbs(){return hasRequiredAbs||(hasRequiredAbs=1,abs=Math.abs),abs}var floor,hasRequiredFloor;function requireFloor(){return hasRequiredFloor||(hasRequiredFloor=1,floor=Math.floor),floor}var max,hasRequiredMax;function requireMax(){return hasRequiredMax||(hasRequiredMax=1,max=Math.max),max}var min,hasRequiredMin;function requireMin(){return hasRequiredMin||(hasRequiredMin=1,min=Math.min),min}var pow,hasRequiredPow;function requirePow(){return hasRequiredPow||(hasRequiredPow=1,pow=Math.pow),pow}var round,hasRequiredRound;function requireRound(){return hasRequiredRound||(hasRequiredRound=1,round=Math.round),round}var _isNaN,hasRequired_isNaN;function require_isNaN(){return hasRequired_isNaN||(hasRequired_isNaN=1,_isNaN=Number.isNaN||function(t){return t!==t}),_isNaN}var sign,hasRequiredSign;function requireSign(){if(hasRequiredSign)return sign;hasRequiredSign=1;var e=require_isNaN();return sign=function(r){return e(r)||r===0?r:r<0?-1:1},sign}var gOPD,hasRequiredGOPD;function requireGOPD(){return hasRequiredGOPD||(hasRequiredGOPD=1,gOPD=Object.getOwnPropertyDescriptor),gOPD}var gopd,hasRequiredGopd;function requireGopd(){if(hasRequiredGopd)return gopd;hasRequiredGopd=1;var e=requireGOPD();if(e)try{e([],"length")}catch{e=null}return gopd=e,gopd}var esDefineProperty,hasRequiredEsDefineProperty;function requireEsDefineProperty(){if(hasRequiredEsDefineProperty)return esDefineProperty;hasRequiredEsDefineProperty=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return esDefineProperty=e,esDefineProperty}var shams$1,hasRequiredShams$1;function requireShams$1(){return hasRequiredShams$1||(hasRequiredShams$1=1,shams$1=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;t[r]=s;for(var a in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var l=Object.getOwnPropertySymbols(t);if(l.length!==1||l[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(t,r);if(u.value!==s||u.enumerable!==!0)return!1}return!0}),shams$1}var hasSymbols,hasRequiredHasSymbols;function requireHasSymbols(){if(hasRequiredHasSymbols)return hasSymbols;hasRequiredHasSymbols=1;var e=typeof Symbol<"u"&&Symbol,t=requireShams$1();return hasSymbols=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},hasSymbols}var Reflect_getPrototypeOf,hasRequiredReflect_getPrototypeOf;function requireReflect_getPrototypeOf(){return hasRequiredReflect_getPrototypeOf||(hasRequiredReflect_getPrototypeOf=1,Reflect_getPrototypeOf=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Reflect_getPrototypeOf}var Object_getPrototypeOf,hasRequiredObject_getPrototypeOf;function requireObject_getPrototypeOf(){if(hasRequiredObject_getPrototypeOf)return Object_getPrototypeOf;hasRequiredObject_getPrototypeOf=1;var e=requireEsObjectAtoms();return Object_getPrototypeOf=e.getPrototypeOf||null,Object_getPrototypeOf}var implementation$4,hasRequiredImplementation$4;function requireImplementation$4(){if(hasRequiredImplementation$4)return implementation$4;hasRequiredImplementation$4=1;var e="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,r=Math.max,n="[object Function]",s=function(x,f){for(var p=[],g=0;g<x.length;g+=1)p[g]=x[g];for(var y=0;y<f.length;y+=1)p[y+x.length]=f[y];return p},a=function(x,f){for(var p=[],g=f,y=0;g<x.length;g+=1,y+=1)p[y]=x[g];return p},l=function(u,x){for(var f="",p=0;p<u.length;p+=1)f+=u[p],p+1<u.length&&(f+=x);return f};return implementation$4=function(x){var f=this;if(typeof f!="function"||t.apply(f)!==n)throw new TypeError(e+f);for(var p=a(arguments,1),g,y=function(){if(this instanceof g){var je=f.apply(this,s(p,arguments));return Object(je)===je?je:this}return f.apply(x,s(p,arguments))},w=r(0,f.length-p.length),R=[],I=0;I<w;I++)R[I]="$"+I;if(g=Function("binder","return function ("+l(R,",")+"){ return binder.apply(this,arguments); }")(y),f.prototype){var k=function(){};k.prototype=f.prototype,g.prototype=new k,k.prototype=null}return g},implementation$4}var functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var e=requireImplementation$4();return functionBind=Function.prototype.bind||e,functionBind}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){return hasRequiredFunctionCall||(hasRequiredFunctionCall=1,functionCall=Function.prototype.call),functionCall}var functionApply,hasRequiredFunctionApply;function requireFunctionApply(){return hasRequiredFunctionApply||(hasRequiredFunctionApply=1,functionApply=Function.prototype.apply),functionApply}var reflectApply,hasRequiredReflectApply;function requireReflectApply(){return hasRequiredReflectApply||(hasRequiredReflectApply=1,reflectApply=typeof Reflect<"u"&&Reflect&&Reflect.apply),reflectApply}var actualApply,hasRequiredActualApply;function requireActualApply(){if(hasRequiredActualApply)return actualApply;hasRequiredActualApply=1;var e=requireFunctionBind(),t=requireFunctionApply(),r=requireFunctionCall(),n=requireReflectApply();return actualApply=n||e.call(r,t),actualApply}var callBindApplyHelpers,hasRequiredCallBindApplyHelpers;function requireCallBindApplyHelpers(){if(hasRequiredCallBindApplyHelpers)return callBindApplyHelpers;hasRequiredCallBindApplyHelpers=1;var e=requireFunctionBind(),t=requireType(),r=requireFunctionCall(),n=requireActualApply();return callBindApplyHelpers=function(a){if(a.length<1||typeof a[0]!="function")throw new t("a function is required");return n(e,r,a)},callBindApplyHelpers}var get$1,hasRequiredGet;function requireGet(){if(hasRequiredGet)return get$1;hasRequiredGet=1;var e=requireCallBindApplyHelpers(),t=requireGopd(),r;try{r=[].__proto__===Array.prototype}catch(l){if(!l||typeof l!="object"||!("code"in l)||l.code!=="ERR_PROTO_ACCESS")throw l}var n=!!r&&t&&t(Object.prototype,"__proto__"),s=Object,a=s.getPrototypeOf;return get$1=n&&typeof n.get=="function"?e([n.get]):typeof a=="function"?function(u){return a(u==null?u:s(u))}:!1,get$1}var getProto,hasRequiredGetProto;function requireGetProto(){if(hasRequiredGetProto)return getProto;hasRequiredGetProto=1;var e=requireReflect_getPrototypeOf(),t=requireObject_getPrototypeOf(),r=requireGet();return getProto=e?function(s){return e(s)}:t?function(s){if(!s||typeof s!="object"&&typeof s!="function")throw new TypeError("getProto: not an object");return t(s)}:r?function(s){return r(s)}:null,getProto}var hasown,hasRequiredHasown;function requireHasown(){if(hasRequiredHasown)return hasown;hasRequiredHasown=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=requireFunctionBind();return hasown=r.call(e,t),hasown}var getIntrinsic,hasRequiredGetIntrinsic;function requireGetIntrinsic(){if(hasRequiredGetIntrinsic)return getIntrinsic;hasRequiredGetIntrinsic=1;var e,t=requireEsObjectAtoms(),r=requireEsErrors(),n=require_eval(),s=requireRange(),a=requireRef(),l=requireSyntax(),u=requireType(),x=requireUri(),f=requireAbs(),p=requireFloor(),g=requireMax(),y=requireMin(),w=requirePow(),R=requireRound(),I=requireSign(),k=Function,je=function(ir){try{return k('"use strict"; return ('+ir+").constructor;")()}catch{}},Ve=requireGopd(),q=requireEsDefineProperty(),$e=function(){throw new u},We=Ve?(function(){try{return arguments.callee,$e}catch{try{return Ve(arguments,"callee").get}catch{return $e}}})():$e,K=requireHasSymbols()(),W=requireGetProto(),Ye=requireObject_getPrototypeOf(),Qe=requireReflect_getPrototypeOf(),it=requireFunctionApply(),ze=requireFunctionCall(),v={},D=typeof Uint8Array>"u"||!W?e:W(Uint8Array),_e={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":K&&W?W([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":v,"%AsyncGenerator%":v,"%AsyncGeneratorFunction%":v,"%AsyncIteratorPrototype%":v,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":k,"%GeneratorFunction%":v,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":K&&W?W(W([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!K||!W?e:W(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":Ve,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":s,"%ReferenceError%":a,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!K||!W?e:W(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":K&&W?W(""[Symbol.iterator]()):e,"%Symbol%":K?Symbol:e,"%SyntaxError%":l,"%ThrowTypeError%":We,"%TypedArray%":D,"%TypeError%":u,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":x,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":ze,"%Function.prototype.apply%":it,"%Object.defineProperty%":q,"%Object.getPrototypeOf%":Ye,"%Math.abs%":f,"%Math.floor%":p,"%Math.max%":g,"%Math.min%":y,"%Math.pow%":w,"%Math.round%":R,"%Math.sign%":I,"%Reflect.getPrototypeOf%":Qe};if(W)try{null.error}catch(ir){var P=W(W(ir));_e["%Error.prototype%"]=P}var Re=function ir(pt){var tr;if(pt==="%AsyncFunction%")tr=je("async function () {}");else if(pt==="%GeneratorFunction%")tr=je("function* () {}");else if(pt==="%AsyncGeneratorFunction%")tr=je("async function* () {}");else if(pt==="%AsyncGenerator%"){var sr=ir("%AsyncGeneratorFunction%");sr&&(tr=sr.prototype)}else if(pt==="%AsyncIteratorPrototype%"){var nr=ir("%AsyncGenerator%");nr&&W&&(tr=W(nr.prototype))}return _e[pt]=tr,tr},Fe={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Le=requireFunctionBind(),Ce=requireHasown(),L=Le.call(ze,Array.prototype.concat),O=Le.call(it,Array.prototype.splice),st=Le.call(ze,String.prototype.replace),lt=Le.call(ze,String.prototype.slice),Xe=Le.call(ze,RegExp.prototype.exec),dt=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,er=/\\(\\)?/g,ar=function(pt){var tr=lt(pt,0,1),sr=lt(pt,-1);if(tr==="%"&&sr!=="%")throw new l("invalid intrinsic syntax, expected closing `%`");if(sr==="%"&&tr!=="%")throw new l("invalid intrinsic syntax, expected opening `%`");var nr=[];return st(pt,dt,function(pr,gr,mr,yr){nr[nr.length]=mr?st(yr,er,"$1"):gr||pr}),nr},dr=function(pt,tr){var sr=pt,nr;if(Ce(Fe,sr)&&(nr=Fe[sr],sr="%"+nr[0]+"%"),Ce(_e,sr)){var pr=_e[sr];if(pr===v&&(pr=Re(sr)),typeof pr>"u"&&!tr)throw new u("intrinsic "+pt+" exists, but is not available. Please file an issue!");return{alias:nr,name:sr,value:pr}}throw new l("intrinsic "+pt+" does not exist!")};return getIntrinsic=function(pt,tr){if(typeof pt!="string"||pt.length===0)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof tr!="boolean")throw new u('"allowMissing" argument must be a boolean');if(Xe(/^%?[^%]*%?$/,pt)===null)throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var sr=ar(pt),nr=sr.length>0?sr[0]:"",pr=dr("%"+nr+"%",tr),gr=pr.name,mr=pr.value,yr=!1,Er=pr.alias;Er&&(nr=Er[0],O(sr,L([0,1],Er)));for(var xr=1,Cr=!0;xr<sr.length;xr+=1){var wr=sr[xr],kr=lt(wr,0,1),Dr=lt(wr,-1);if((kr==='"'||kr==="'"||kr==="`"||Dr==='"'||Dr==="'"||Dr==="`")&&kr!==Dr)throw new l("property names with quotes must have matching quotes");if((wr==="constructor"||!Cr)&&(yr=!0),nr+="."+wr,gr="%"+nr+"%",Ce(_e,gr))mr=_e[gr];else if(mr!=null){if(!(wr in mr)){if(!tr)throw new u("base intrinsic for "+pt+" exists, but the property is not available.");return}if(Ve&&xr+1>=sr.length){var rr=Ve(mr,wr);Cr=!!rr,Cr&&"get"in rr&&!("originalValue"in rr.get)?mr=rr.get:mr=mr[wr]}else Cr=Ce(mr,wr),mr=mr[wr];Cr&&!yr&&(_e[gr]=mr)}}return mr},getIntrinsic}var callBound$1,hasRequiredCallBound$1;function requireCallBound$1(){if(hasRequiredCallBound$1)return callBound$1;hasRequiredCallBound$1=1;var e=requireGetIntrinsic(),t=requireCallBindApplyHelpers(),r=t([e("%String.prototype.indexOf%")]);return callBound$1=function(s,a){var l=e(s,!!a);return typeof l=="function"&&r(s,".prototype.")>-1?t([l]):l},callBound$1}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var e=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,n;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw n}}),n={},t(function(){throw 42},null,r)}catch(Ve){Ve!==n&&(t=null)}else t=null;var s=/^\s*class\b/,a=function(q){try{var $e=e.call(q);return s.test($e)}catch{return!1}},l=function(q){try{return a(q)?!1:(e.call(q),!0)}catch{return!1}},u=Object.prototype.toString,x="[object Object]",f="[object Function]",p="[object GeneratorFunction]",g="[object HTMLAllCollection]",y="[object HTML document.all class]",w="[object HTMLCollection]",R=typeof Symbol=="function"&&!!Symbol.toStringTag,I=!(0 in[,]),k=function(){return!1};if(typeof document=="object"){var je=document.all;u.call(je)===u.call(document.all)&&(k=function(q){if((I||!q)&&(typeof q>"u"||typeof q=="object"))try{var $e=u.call(q);return($e===g||$e===y||$e===w||$e===x)&&q("")==null}catch{}return!1})}return isCallable=t?function(q){if(k(q))return!0;if(!q||typeof q!="function"&&typeof q!="object")return!1;try{t(q,null,r)}catch($e){if($e!==n)return!1}return!a(q)&&l(q)}:function(q){if(k(q))return!0;if(!q||typeof q!="function"&&typeof q!="object")return!1;if(R)return l(q);if(a(q))return!1;var $e=u.call(q);return $e!==f&&$e!==p&&!/^\[object HTML/.test($e)?!1:l(q)},isCallable}var forEach,hasRequiredForEach;function requireForEach(){if(hasRequiredForEach)return forEach;hasRequiredForEach=1;var e=requireIsCallable(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,n=function(x,f,p){for(var g=0,y=x.length;g<y;g++)r.call(x,g)&&(p==null?f(x[g],g,x):f.call(p,x[g],g,x))},s=function(x,f,p){for(var g=0,y=x.length;g<y;g++)p==null?f(x.charAt(g),g,x):f.call(p,x.charAt(g),g,x)},a=function(x,f,p){for(var g in x)r.call(x,g)&&(p==null?f(x[g],g,x):f.call(p,x[g],g,x))};function l(u){return t.call(u)==="[object Array]"}return forEach=function(x,f,p){if(!e(f))throw new TypeError("iterator must be a function");var g;arguments.length>=3&&(g=p),l(x)?n(x,f,g):typeof x=="string"?s(x,f,g):a(x,f,g)},forEach}var possibleTypedArrayNames,hasRequiredPossibleTypedArrayNames;function requirePossibleTypedArrayNames(){return hasRequiredPossibleTypedArrayNames||(hasRequiredPossibleTypedArrayNames=1,possibleTypedArrayNames=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),possibleTypedArrayNames}var availableTypedArrays,hasRequiredAvailableTypedArrays;function requireAvailableTypedArrays(){if(hasRequiredAvailableTypedArrays)return availableTypedArrays;hasRequiredAvailableTypedArrays=1;var e=requirePossibleTypedArrayNames(),t=typeof globalThis>"u"?commonjsGlobal:globalThis;return availableTypedArrays=function(){for(var n=[],s=0;s<e.length;s++)typeof t[e[s]]=="function"&&(n[n.length]=e[s]);return n},availableTypedArrays}var callBind={exports:{}},defineDataProperty,hasRequiredDefineDataProperty;function requireDefineDataProperty(){if(hasRequiredDefineDataProperty)return defineDataProperty;hasRequiredDefineDataProperty=1;var e=requireEsDefineProperty(),t=requireSyntax(),r=requireType(),n=requireGopd();return defineDataProperty=function(a,l,u){if(!a||typeof a!="object"&&typeof a!="function")throw new r("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var x=arguments.length>3?arguments[3]:null,f=arguments.length>4?arguments[4]:null,p=arguments.length>5?arguments[5]:null,g=arguments.length>6?arguments[6]:!1,y=!!n&&n(a,l);if(e)e(a,l,{configurable:p===null&&y?y.configurable:!p,enumerable:x===null&&y?y.enumerable:!x,value:u,writable:f===null&&y?y.writable:!f});else if(g||!x&&!f&&!p)a[l]=u;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},defineDataProperty}var hasPropertyDescriptors_1,hasRequiredHasPropertyDescriptors;function requireHasPropertyDescriptors(){if(hasRequiredHasPropertyDescriptors)return hasPropertyDescriptors_1;hasRequiredHasPropertyDescriptors=1;var e=requireEsDefineProperty(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},hasPropertyDescriptors_1=t,hasPropertyDescriptors_1}var setFunctionLength,hasRequiredSetFunctionLength;function requireSetFunctionLength(){if(hasRequiredSetFunctionLength)return setFunctionLength;hasRequiredSetFunctionLength=1;var e=requireGetIntrinsic(),t=requireDefineDataProperty(),r=requireHasPropertyDescriptors()(),n=requireGopd(),s=requireType(),a=e("%Math.floor%");return setFunctionLength=function(u,x){if(typeof u!="function")throw new s("`fn` is not a function");if(typeof x!="number"||x<0||x>4294967295||a(x)!==x)throw new s("`length` must be a positive 32-bit integer");var f=arguments.length>2&&!!arguments[2],p=!0,g=!0;if("length"in u&&n){var y=n(u,"length");y&&!y.configurable&&(p=!1),y&&!y.writable&&(g=!1)}return(p||g||!f)&&(r?t(u,"length",x,!0,!0):t(u,"length",x)),u},setFunctionLength}var applyBind,hasRequiredApplyBind;function requireApplyBind(){if(hasRequiredApplyBind)return applyBind;hasRequiredApplyBind=1;var e=requireFunctionBind(),t=requireFunctionApply(),r=requireActualApply();return applyBind=function(){return r(e,t,arguments)},applyBind}var hasRequiredCallBind;function requireCallBind(){return hasRequiredCallBind||(hasRequiredCallBind=1,(function(e){var t=requireSetFunctionLength(),r=requireEsDefineProperty(),n=requireCallBindApplyHelpers(),s=requireApplyBind();e.exports=function(l){var u=n(arguments),x=l.length-(arguments.length-1);return t(u,1+(x>0?x:0),!0)},r?r(e.exports,"apply",{value:s}):e.exports.apply=s})(callBind)),callBind.exports}var shams,hasRequiredShams;function requireShams(){if(hasRequiredShams)return shams;hasRequiredShams=1;var e=requireShams$1();return shams=function(){return e()&&!!Symbol.toStringTag},shams}var whichTypedArray,hasRequiredWhichTypedArray;function requireWhichTypedArray(){if(hasRequiredWhichTypedArray)return whichTypedArray;hasRequiredWhichTypedArray=1;var e=requireForEach(),t=requireAvailableTypedArrays(),r=requireCallBind(),n=requireCallBound$1(),s=requireGopd(),a=requireGetProto(),l=n("Object.prototype.toString"),u=requireShams()(),x=typeof globalThis>"u"?commonjsGlobal:globalThis,f=t(),p=n("String.prototype.slice"),g=n("Array.prototype.indexOf",!0)||function(k,je){for(var Ve=0;Ve<k.length;Ve+=1)if(k[Ve]===je)return Ve;return-1},y={__proto__:null};u&&s&&a?e(f,function(I){var k=new x[I];if(Symbol.toStringTag in k&&a){var je=a(k),Ve=s(je,Symbol.toStringTag);if(!Ve&&je){var q=a(je);Ve=s(q,Symbol.toStringTag)}y["$"+I]=r(Ve.get)}}):e(f,function(I){var k=new x[I],je=k.slice||k.set;je&&(y["$"+I]=r(je))});var w=function(k){var je=!1;return e(y,function(Ve,q){if(!je)try{"$"+Ve(k)===q&&(je=p(q,1))}catch{}}),je},R=function(k){var je=!1;return e(y,function(Ve,q){if(!je)try{Ve(k),je=p(q,1)}catch{}}),je};return whichTypedArray=function(k){if(!k||typeof k!="object")return!1;if(!u){var je=p(l(k),8,-1);return g(f,je)>-1?je:je!=="Object"?!1:R(k)}return s?w(k):null},whichTypedArray}var isTypedArray,hasRequiredIsTypedArray;function requireIsTypedArray(){if(hasRequiredIsTypedArray)return isTypedArray;hasRequiredIsTypedArray=1;var e=requireWhichTypedArray();return isTypedArray=function(r){return!!e(r)},isTypedArray}var typedArrayBuffer,hasRequiredTypedArrayBuffer;function requireTypedArrayBuffer(){if(hasRequiredTypedArrayBuffer)return typedArrayBuffer;hasRequiredTypedArrayBuffer=1;var e=requireType(),t=requireCallBound$1(),r=t("TypedArray.prototype.buffer",!0),n=requireIsTypedArray();return typedArrayBuffer=r||function(a){if(!n(a))throw new e("Not a Typed Array");return a.buffer},typedArrayBuffer}var toBuffer,hasRequiredToBuffer;function requireToBuffer(){if(hasRequiredToBuffer)return toBuffer;hasRequiredToBuffer=1;var e=requireSafeBuffer().Buffer,t=requireIsarray(),r=requireTypedArrayBuffer(),n=ArrayBuffer.isView||function(x){try{return r(x),!0}catch{return!1}},s=typeof Uint8Array<"u",a=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l=a&&(e.prototype instanceof Uint8Array||e.TYPED_ARRAY_SUPPORT);return toBuffer=function(x,f){if(e.isBuffer(x))return x.constructor&&!("isBuffer"in x)?e.from(x):x;if(typeof x=="string")return e.from(x,f);if(a&&n(x)){if(x.byteLength===0)return e.alloc(0);if(l){var p=e.from(x.buffer,x.byteOffset,x.byteLength);if(p.byteLength===x.byteLength)return p}var g=x instanceof Uint8Array?x:new Uint8Array(x.buffer,x.byteOffset,x.byteLength),y=e.from(g);if(y.length===x.byteLength)return y}if(s&&x instanceof Uint8Array)return e.from(x);var w=t(x);if(w)for(var R=0;R<x.length;R+=1){var I=x[R];if(typeof I!="number"||I<0||I>255||~~I!==I)throw new RangeError("Array items must be numbers in the range 0-255.")}if(w||e.isBuffer(x)&&x.constructor&&typeof x.constructor.isBuffer=="function"&&x.constructor.isBuffer(x))return e.from(x);throw new TypeError('The "data" argument must be a string, an Array, a Buffer, a Uint8Array, or a DataView.')},toBuffer}var hash,hasRequiredHash;function requireHash(){if(hasRequiredHash)return hash;hasRequiredHash=1;var e=requireSafeBuffer().Buffer,t=requireToBuffer();function r(n,s){this._block=e.alloc(n),this._finalSize=s,this._blockSize=n,this._len=0}return r.prototype.update=function(n,s){n=t(n,s||"utf8");for(var a=this._block,l=this._blockSize,u=n.length,x=this._len,f=0;f<u;){for(var p=x%l,g=Math.min(u-f,l-p),y=0;y<g;y++)a[p+y]=n[f+y];x+=g,f+=g,x%l===0&&this._update(a)}return this._len+=u,this},r.prototype.digest=function(n){var s=this._len%this._blockSize;this._block[s]=128,this._block.fill(0,s+1),s>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var l=(a&4294967295)>>>0,u=(a-l)/4294967296;this._block.writeUInt32BE(u,this._blockSize-8),this._block.writeUInt32BE(l,this._blockSize-4)}this._update(this._block);var x=this._hash();return n?x.toString(n):x},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},hash=r,hash}var sha,hasRequiredSha;function requireSha(){if(hasRequiredSha)return sha;hasRequiredSha=1;var e=requireInherits_browser(),t=requireHash(),r=requireSafeBuffer().Buffer,n=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function a(){this.init(),this._w=s,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function l(f){return f<<5|f>>>27}function u(f){return f<<30|f>>>2}function x(f,p,g,y){return f===0?p&g|~p&y:f===2?p&g|p&y|g&y:p^g^y}return a.prototype._update=function(f){for(var p=this._w,g=this._a|0,y=this._b|0,w=this._c|0,R=this._d|0,I=this._e|0,k=0;k<16;++k)p[k]=f.readInt32BE(k*4);for(;k<80;++k)p[k]=p[k-3]^p[k-8]^p[k-14]^p[k-16];for(var je=0;je<80;++je){var Ve=~~(je/20),q=l(g)+x(Ve,y,w,R)+I+p[je]+n[Ve]|0;I=R,R=w,w=u(y),y=g,g=q}this._a=g+this._a|0,this._b=y+this._b|0,this._c=w+this._c|0,this._d=R+this._d|0,this._e=I+this._e|0},a.prototype._hash=function(){var f=r.allocUnsafe(20);return f.writeInt32BE(this._a|0,0),f.writeInt32BE(this._b|0,4),f.writeInt32BE(this._c|0,8),f.writeInt32BE(this._d|0,12),f.writeInt32BE(this._e|0,16),f},sha=a,sha}var sha1,hasRequiredSha1;function requireSha1(){if(hasRequiredSha1)return sha1;hasRequiredSha1=1;var e=requireInherits_browser(),t=requireHash(),r=requireSafeBuffer().Buffer,n=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function a(){this.init(),this._w=s,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function l(p){return p<<1|p>>>31}function u(p){return p<<5|p>>>27}function x(p){return p<<30|p>>>2}function f(p,g,y,w){return p===0?g&y|~g&w:p===2?g&y|g&w|y&w:g^y^w}return a.prototype._update=function(p){for(var g=this._w,y=this._a|0,w=this._b|0,R=this._c|0,I=this._d|0,k=this._e|0,je=0;je<16;++je)g[je]=p.readInt32BE(je*4);for(;je<80;++je)g[je]=l(g[je-3]^g[je-8]^g[je-14]^g[je-16]);for(var Ve=0;Ve<80;++Ve){var q=~~(Ve/20),$e=u(y)+f(q,w,R,I)+k+g[Ve]+n[q]|0;k=I,I=R,R=x(w),w=y,y=$e}this._a=y+this._a|0,this._b=w+this._b|0,this._c=R+this._c|0,this._d=I+this._d|0,this._e=k+this._e|0},a.prototype._hash=function(){var p=r.allocUnsafe(20);return p.writeInt32BE(this._a|0,0),p.writeInt32BE(this._b|0,4),p.writeInt32BE(this._c|0,8),p.writeInt32BE(this._d|0,12),p.writeInt32BE(this._e|0,16),p},sha1=a,sha1}var sha256,hasRequiredSha256;function requireSha256(){if(hasRequiredSha256)return sha256;hasRequiredSha256=1;var e=requireInherits_browser(),t=requireHash(),r=requireSafeBuffer().Buffer,n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function a(){this.init(),this._w=s,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function l(y,w,R){return R^y&(w^R)}function u(y,w,R){return y&w|R&(y|w)}function x(y){return(y>>>2|y<<30)^(y>>>13|y<<19)^(y>>>22|y<<10)}function f(y){return(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7)}function p(y){return(y>>>7|y<<25)^(y>>>18|y<<14)^y>>>3}function g(y){return(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10}return a.prototype._update=function(y){for(var w=this._w,R=this._a|0,I=this._b|0,k=this._c|0,je=this._d|0,Ve=this._e|0,q=this._f|0,$e=this._g|0,We=this._h|0,K=0;K<16;++K)w[K]=y.readInt32BE(K*4);for(;K<64;++K)w[K]=g(w[K-2])+w[K-7]+p(w[K-15])+w[K-16]|0;for(var W=0;W<64;++W){var Ye=We+f(Ve)+l(Ve,q,$e)+n[W]+w[W]|0,Qe=x(R)+u(R,I,k)|0;We=$e,$e=q,q=Ve,Ve=je+Ye|0,je=k,k=I,I=R,R=Ye+Qe|0}this._a=R+this._a|0,this._b=I+this._b|0,this._c=k+this._c|0,this._d=je+this._d|0,this._e=Ve+this._e|0,this._f=q+this._f|0,this._g=$e+this._g|0,this._h=We+this._h|0},a.prototype._hash=function(){var y=r.allocUnsafe(32);return y.writeInt32BE(this._a,0),y.writeInt32BE(this._b,4),y.writeInt32BE(this._c,8),y.writeInt32BE(this._d,12),y.writeInt32BE(this._e,16),y.writeInt32BE(this._f,20),y.writeInt32BE(this._g,24),y.writeInt32BE(this._h,28),y},sha256=a,sha256}var sha224,hasRequiredSha224;function requireSha224(){if(hasRequiredSha224)return sha224;hasRequiredSha224=1;var e=requireInherits_browser(),t=requireSha256(),r=requireHash(),n=requireSafeBuffer().Buffer,s=new Array(64);function a(){this.init(),this._w=s,r.call(this,64,56)}return e(a,t),a.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},a.prototype._hash=function(){var l=n.allocUnsafe(28);return l.writeInt32BE(this._a,0),l.writeInt32BE(this._b,4),l.writeInt32BE(this._c,8),l.writeInt32BE(this._d,12),l.writeInt32BE(this._e,16),l.writeInt32BE(this._f,20),l.writeInt32BE(this._g,24),l},sha224=a,sha224}var sha512,hasRequiredSha512;function requireSha512(){if(hasRequiredSha512)return sha512;hasRequiredSha512=1;var e=requireInherits_browser(),t=requireHash(),r=requireSafeBuffer().Buffer,n=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function a(){this.init(),this._w=s,t.call(this,128,112)}e(a,t),a.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function l(I,k,je){return je^I&(k^je)}function u(I,k,je){return I&k|je&(I|k)}function x(I,k){return(I>>>28|k<<4)^(k>>>2|I<<30)^(k>>>7|I<<25)}function f(I,k){return(I>>>14|k<<18)^(I>>>18|k<<14)^(k>>>9|I<<23)}function p(I,k){return(I>>>1|k<<31)^(I>>>8|k<<24)^I>>>7}function g(I,k){return(I>>>1|k<<31)^(I>>>8|k<<24)^(I>>>7|k<<25)}function y(I,k){return(I>>>19|k<<13)^(k>>>29|I<<3)^I>>>6}function w(I,k){return(I>>>19|k<<13)^(k>>>29|I<<3)^(I>>>6|k<<26)}function R(I,k){return I>>>0<k>>>0?1:0}return a.prototype._update=function(I){for(var k=this._w,je=this._ah|0,Ve=this._bh|0,q=this._ch|0,$e=this._dh|0,We=this._eh|0,K=this._fh|0,W=this._gh|0,Ye=this._hh|0,Qe=this._al|0,it=this._bl|0,ze=this._cl|0,v=this._dl|0,D=this._el|0,_e=this._fl|0,P=this._gl|0,Re=this._hl|0,Fe=0;Fe<32;Fe+=2)k[Fe]=I.readInt32BE(Fe*4),k[Fe+1]=I.readInt32BE(Fe*4+4);for(;Fe<160;Fe+=2){var Le=k[Fe-30],Ce=k[Fe-30+1],L=p(Le,Ce),O=g(Ce,Le);Le=k[Fe-4],Ce=k[Fe-4+1];var st=y(Le,Ce),lt=w(Ce,Le),Xe=k[Fe-14],dt=k[Fe-14+1],er=k[Fe-32],ar=k[Fe-32+1],dr=O+dt|0,ir=L+Xe+R(dr,O)|0;dr=dr+lt|0,ir=ir+st+R(dr,lt)|0,dr=dr+ar|0,ir=ir+er+R(dr,ar)|0,k[Fe]=ir,k[Fe+1]=dr}for(var pt=0;pt<160;pt+=2){ir=k[pt],dr=k[pt+1];var tr=u(je,Ve,q),sr=u(Qe,it,ze),nr=x(je,Qe),pr=x(Qe,je),gr=f(We,D),mr=f(D,We),yr=n[pt],Er=n[pt+1],xr=l(We,K,W),Cr=l(D,_e,P),wr=Re+mr|0,kr=Ye+gr+R(wr,Re)|0;wr=wr+Cr|0,kr=kr+xr+R(wr,Cr)|0,wr=wr+Er|0,kr=kr+yr+R(wr,Er)|0,wr=wr+dr|0,kr=kr+ir+R(wr,dr)|0;var Dr=pr+sr|0,rr=nr+tr+R(Dr,pr)|0;Ye=W,Re=P,W=K,P=_e,K=We,_e=D,D=v+wr|0,We=$e+kr+R(D,v)|0,$e=q,v=ze,q=Ve,ze=it,Ve=je,it=Qe,Qe=wr+Dr|0,je=kr+rr+R(Qe,wr)|0}this._al=this._al+Qe|0,this._bl=this._bl+it|0,this._cl=this._cl+ze|0,this._dl=this._dl+v|0,this._el=this._el+D|0,this._fl=this._fl+_e|0,this._gl=this._gl+P|0,this._hl=this._hl+Re|0,this._ah=this._ah+je+R(this._al,Qe)|0,this._bh=this._bh+Ve+R(this._bl,it)|0,this._ch=this._ch+q+R(this._cl,ze)|0,this._dh=this._dh+$e+R(this._dl,v)|0,this._eh=this._eh+We+R(this._el,D)|0,this._fh=this._fh+K+R(this._fl,_e)|0,this._gh=this._gh+W+R(this._gl,P)|0,this._hh=this._hh+Ye+R(this._hl,Re)|0},a.prototype._hash=function(){var I=r.allocUnsafe(64);function k(je,Ve,q){I.writeInt32BE(je,q),I.writeInt32BE(Ve,q+4)}return k(this._ah,this._al,0),k(this._bh,this._bl,8),k(this._ch,this._cl,16),k(this._dh,this._dl,24),k(this._eh,this._el,32),k(this._fh,this._fl,40),k(this._gh,this._gl,48),k(this._hh,this._hl,56),I},sha512=a,sha512}var sha384,hasRequiredSha384;function requireSha384(){if(hasRequiredSha384)return sha384;hasRequiredSha384=1;var e=requireInherits_browser(),t=requireSha512(),r=requireHash(),n=requireSafeBuffer().Buffer,s=new Array(160);function a(){this.init(),this._w=s,r.call(this,128,112)}return e(a,t),a.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},a.prototype._hash=function(){var l=n.allocUnsafe(48);function u(x,f,p){l.writeInt32BE(x,p),l.writeInt32BE(f,p+4)}return u(this._ah,this._al,0),u(this._bh,this._bl,8),u(this._ch,this._cl,16),u(this._dh,this._dl,24),u(this._eh,this._el,32),u(this._fh,this._fl,40),l},sha384=a,sha384}var hasRequiredSha_js;function requireSha_js(){return hasRequiredSha_js||(hasRequiredSha_js=1,(function(e){e.exports=function(r){var n=r.toLowerCase(),s=e.exports[n];if(!s)throw new Error(n+" is not supported (we accept pull requests)");return new s},e.exports.sha=requireSha(),e.exports.sha1=requireSha1(),e.exports.sha224=requireSha224(),e.exports.sha256=requireSha256(),e.exports.sha384=requireSha384(),e.exports.sha512=requireSha512()})(sha_js)),sha_js.exports}const createBuffer=Buffer$1.from&&Buffer$1.alloc&&Buffer$1.allocUnsafe&&Buffer$1.allocUnsafeSlow?Buffer$1.from:e=>new Buffer$1(e);function defineCrc(e,t){const r=(n,s)=>t(n,s)>>>0;return r.signed=t,r.unsigned=r,r.model=e,r}const crc1=defineCrc("crc1",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=~~t,n=0;for(let s=0;s<e.length;s++){const a=e[s];n+=a}return r+=n%256,r%256});let TABLE$8=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243];typeof Int32Array<"u"&&(TABLE$8=new Int32Array(TABLE$8));const crc8=defineCrc("crc-8",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=~~t;for(let n=0;n<e.length;n++){const s=e[n];r=TABLE$8[(r^s)&255]&255}return r});let TABLE$7=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];typeof Int32Array<"u"&&(TABLE$7=new Int32Array(TABLE$7));const crc81wire=defineCrc("dallas-1-wire",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=~~t;for(let n=0;n<e.length;n++){const s=e[n];r=TABLE$7[(r^s)&255]&255}return r});let TABLE$6=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];typeof Int32Array<"u"&&(TABLE$6=new Int32Array(TABLE$6));const crc16=defineCrc("crc-16",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=~~t;for(let n=0;n<e.length;n++){const s=e[n];r=(TABLE$6[(r^s)&255]^r>>8)&65535}return r});let TABLE$5=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];typeof Int32Array<"u"&&(TABLE$5=new Int32Array(TABLE$5));const crc16ccitt=defineCrc("ccitt",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:65535;for(let n=0;n<e.length;n++){const s=e[n];r=(TABLE$5[(r>>8^s)&255]^r<<8)&65535}return r});let TABLE$4=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];typeof Int32Array<"u"&&(TABLE$4=new Int32Array(TABLE$4));const crc16modbus=defineCrc("crc-16-modbus",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:65535;for(let n=0;n<e.length;n++){const s=e[n];r=(TABLE$4[(r^s)&255]^r>>8)&65535}return r}),crc16xmodem=defineCrc("xmodem",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:0;for(let n=0;n<e.length;n++){const s=e[n];let a=r>>>8&255;a^=s&255,a^=a>>>4,r=r<<8&65535,r^=a,a=a<<5&65535,r^=a,a=a<<7&65535,r^=a}return r});let TABLE$3=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];typeof Int32Array<"u"&&(TABLE$3=new Int32Array(TABLE$3));const crc16kermit=defineCrc("kermit",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:0;for(let n=0;n<e.length;n++){const s=e[n];r=(TABLE$3[(r^s)&255]^r>>8)&65535}return r});let TABLE$2=[0,8801531,9098509,825846,9692897,1419802,1651692,10452759,10584377,2608578,2839604,11344079,3303384,11807523,12104405,4128302,12930697,4391538,5217156,13227903,5679208,13690003,14450021,5910942,6606768,14844747,15604413,6837830,16197969,7431594,8256604,16494759,840169,9084178,8783076,18463,10434312,1670131,1434117,9678590,11358416,2825259,2590173,10602790,4109873,12122826,11821884,3289031,13213536,5231515,4409965,12912278,5929345,14431610,13675660,5693559,6823513,15618722,14863188,6588335,16513208,8238147,7417269,16212302,1680338,10481449,9664223,1391140,9061683,788936,36926,8838341,12067563,4091408,3340262,11844381,2868234,11372785,10555655,2579964,14478683,5939616,5650518,13661357,5180346,13190977,12967607,4428364,8219746,16457881,16234863,7468436,15633027,6866552,6578062,14816117,1405499,9649856,10463030,1698765,8819930,55329,803287,9047340,11858690,3325945,4072975,12086004,2561507,10574104,11387118,2853909,13647026,5664841,5958079,14460228,4446803,12949160,13176670,5194661,7454091,16249200,16476294,8201341,14834538,6559633,6852199,15647388,3360676,11864927,12161705,4185682,10527045,2551230,2782280,11286707,9619101,1346150,1577872,10379115,73852,8875143,9172337,899466,16124205,7357910,8182816,16421083,6680524,14918455,15678145,6911546,5736468,13747439,14507289,5968354,12873461,4334094,5159928,13170435,4167245,12180150,11879232,3346363,11301036,2767959,2532769,10545498,10360692,1596303,1360505,9604738,913813,9157998,8856728,92259,16439492,8164415,7343561,16138546,6897189,15692510,14936872,6662099,5986813,14488838,13733104,5750795,13156124,5174247,4352529,12855018,2810998,11315341,10498427,2522496,12124823,4148844,3397530,11901793,9135439,862644,110658,8912057,1606574,10407765,9590435,1317464,15706879,6940164,6651890,14889737,8145950,16384229,16161043,7394792,5123014,13133629,12910283,4370992,14535975,5997020,5707818,13718737,2504095,10516836,11329682,2796649,11916158,3383173,4130419,12143240,8893606,129117,876971,9121104,1331783,9576124,10389322,1625009,14908182,6633453,6925851,15721184,7380471,16175372,16402682,8127489,4389423,12891860,13119266,5137369,13704398,5722165,6015427,14517560];typeof Int32Array<"u"&&(TABLE$2=new Int32Array(TABLE$2));const crc24=defineCrc("crc-24",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:11994318;for(let n=0;n<e.length;n++){const s=e[n];r=(TABLE$2[(r>>16^s)&255]^r<<8)&16777215}return r});let TABLE$1=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(TABLE$1=new Int32Array(TABLE$1));const crc32=defineCrc("crc-32",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=t===0?0:~~t^-1;for(let n=0;n<e.length;n++){const s=e[n];r=TABLE$1[(r^s)&255]^r>>>8}return r^-1});let TABLE=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(TABLE=new Int32Array(TABLE));const crcjam=defineCrc("jam",function(e,t=-1){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=t===0?0:~~t;for(let n=0;n<e.length;n++){const s=e[n];r=TABLE[(r^s)&255]^r>>>8}return r}),index$2={crc1,crc8,crc81wire,crc16,crc16ccitt,crc16modbus,crc16xmodem,crc16kermit,crc24,crc32,crcjam},crc=Object.freeze(Object.defineProperty({__proto__:null,crc1,crc16,crc16ccitt,crc16kermit,crc16modbus,crc16xmodem,crc24,crc32,crc8,crc81wire,crcjam,default:index$2},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(crc);var hasRequiredUtils$7;function requireUtils$7(){if(hasRequiredUtils$7)return utils$7;hasRequiredUtils$7=1;var e=utils$7&&utils$7.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(utils$7,"__esModule",{value:!0}),utils$7.bufferXOR=utils$7.setDifference=utils$7.arrayContains=utils$7.arraysEqual=utils$7.hasPrefix=utils$7.isURType=utils$7.intToBytes=utils$7.toUint32=utils$7.getCRCHex=utils$7.getCRC=utils$7.split=utils$7.partition=utils$7.sha256Hash=void 0;const t=e(requireSha_js()),r=require$$1,n=k=>t.default("sha256").update(k).digest();utils$7.sha256Hash=n;const s=(k,je)=>k.match(new RegExp(".{1,"+je+"}","g"))||[k];utils$7.partition=s;const a=(k,je)=>[k.slice(0,-je),k.slice(-je)];utils$7.split=a;const l=k=>r.crc32(k);utils$7.getCRC=l;const u=k=>r.crc32(k).toString(16).padStart(8,"0");utils$7.getCRCHex=u;const x=k=>k>>>0;utils$7.toUint32=x;const f=k=>{const je=new ArrayBuffer(4);return new DataView(je).setUint32(0,k,!1),Buffer.from(je)};utils$7.intToBytes=f;const p=k=>k.split("").every((je,Ve)=>{let q=k.charCodeAt(Ve);return 97<=q&&q<=122||48<=q&&q<=57||q===45});utils$7.isURType=p;const g=(k,je)=>k.indexOf(je)===0;utils$7.hasPrefix=g;const y=(k,je)=>k.length!==je.length?!1:k.every(Ve=>je.includes(Ve));utils$7.arraysEqual=y;const w=(k,je)=>je.every(Ve=>k.includes(Ve));utils$7.arrayContains=w;const R=(k,je)=>k.filter(Ve=>je.indexOf(Ve)<0);utils$7.setDifference=R;const I=(k,je)=>{const Ve=Math.max(k.length,je.length),q=Buffer.allocUnsafe(Ve);for(let $e=0;$e<Ve;++$e)q[$e]=k[$e]^je[$e];return q};return utils$7.bufferXOR=I,utils$7}var cbor={},main$1={exports:{}},main=main$1.exports,hasRequiredMain;function requireMain(){return hasRequiredMain||(hasRequiredMain=1,(function(e){(function(t,r){e.exports?e.exports=r():t.CBOR=r()})(main,function(){var t=(function(){function r(K){this.$hex=K}r.prototype={length:function(){return this.$hex.length/2},toString:function(K){if(!K||K==="hex"||K===16)return this.$hex;if(K==="utf-8"){for(var W="",Ye=0;Ye<this.$hex.length;Ye+=2)W+="%"+this.$hex.substring(Ye,Ye+2);return decodeURIComponent(W)}if(K==="latin"){for(var W=[],Ye=0;Ye<this.$hex.length;Ye+=2)W.push(parseInt(this.$hex.substring(Ye,Ye+2),16));return String.fromCharCode.apply(String,W)}throw new Error("Unrecognised format: "+K)}},r.fromLatinString=function(K){for(var W="",Ye=0;Ye<K.length;Ye++){var Qe=K.charCodeAt(Ye).toString(16);Qe.length===1&&(Qe="0"+Qe),W+=Qe}return new r(W)},r.fromUtf8String=function(K){for(var W=encodeURIComponent(K),Ye="",Qe=0;Qe<W.length;Qe++)if(W.charAt(Qe)==="%")Ye+=W.substring(Qe+1,Qe+3),Qe+=2;else{var it=W.charCodeAt(Qe).toString(16);it.length<2&&(it="0"+it),Ye+=it}return new r(Ye)};var n=[],s={},a=function(K){return function(){throw new Error(K+" not implemented")}};function l(){}l.prototype={peekByte:a("peekByte"),readByte:a("readByte"),readChunk:a("readChunk"),readFloat16:function(){var K=this.readUint16(),W=(K&32767)>>10,Ye=K&1023,Qe=K&32768;if(W===31)return Ye===0?Qe?-1/0:1/0:NaN;var it=W?Math.pow(2,W-25)*(1024+Ye):Math.pow(2,-24)*Ye;return Qe?-it:it},readFloat32:function(){var K=this.readUint32(),W=(K&2147483647)>>23,Ye=K&8388607,Qe=K&2147483648;if(W===255)return Ye===0?Qe?-1/0:1/0:NaN;var it=W?Math.pow(2,W-23-127)*(8388608+Ye):Math.pow(2,-149)*Ye;return Qe?-it:it},readFloat64:function(){var K=this.readUint32(),W=this.readUint32(),Ye=K>>20&2047,Qe=(K&1048575)*4294967296+W,it=K&2147483648;if(Ye===2047)return Qe===0?it?-1/0:1/0:NaN;var ze=Ye?Math.pow(2,Ye-52-1023)*(4503599627370496+Qe):Math.pow(2,-1074)*Qe;return it?-ze:ze},readUint16:function(){return this.readByte()*256+this.readByte()},readUint32:function(){return this.readUint16()*65536+this.readUint16()},readUint64:function(){return this.readUint32()*4294967296+this.readUint32()}};function u(){}u.prototype={writeByte:a("writeByte"),result:a("result"),writeFloat16:a("writeFloat16"),writeFloat32:a("writeFloat32"),writeFloat64:a("writeFloat64"),writeUint16:function(K){this.writeByte(K>>8&255),this.writeByte(K&255)},writeUint32:function(K){this.writeUint16(K>>16&65535),this.writeUint16(K&65535)},writeUint64:function(K){if(K>=9007199254740992||K<=-9007199254740992)throw new Error("Cannot encode Uint64 of: "+K+" magnitude to big (floating point errors)");this.writeUint32(Math.floor(K/4294967296)),this.writeUint32(K%4294967296)},writeString:a("writeString"),canWriteBinary:function(K){return!1},writeBinary:a("writeChunk")};function x(K){var W=K.readByte(),Ye=W>>5,Qe=W&31;return{type:Ye,value:Qe}}function f(K,W){var Ye=K.value;if(Ye<24)return Ye;if(Ye==24)return W.readByte();if(Ye==25)return W.readUint16();if(Ye==26)return W.readUint32();if(Ye==27)return W.readUint64();if(Ye==31)return null;a("Additional info: "+Ye)()}function p(K,W,Ye){Ye.writeByte(K<<5|W)}function g(K,W,Ye){var Qe=K<<5;W<24?Ye.writeByte(Qe|W):W<256?(Ye.writeByte(Qe|24),Ye.writeByte(W)):W<65536?(Ye.writeByte(Qe|25),Ye.writeUint16(W)):W<4294967296?(Ye.writeByte(Qe|26),Ye.writeUint32(W)):(Ye.writeByte(Qe|27),Ye.writeUint64(W))}var y=new Error;function w(K){var W=x(K);switch(W.type){case 0:return f(W,K);case 1:return-1-f(W,K);case 2:return K.readChunk(f(W,K));case 3:var Ye=K.readChunk(f(W,K));return Ye.toString("utf-8");case 4:case 5:var Qe=f(W,K),P=[];if(Qe!==null){W.type===5&&(Qe*=2);for(var it=0;it<Qe;it++)P[it]=w(K)}else for(var ze;(ze=w(K))!==y;)P.push(ze);if(W.type===5){for(var v={},it=0;it<P.length;it+=2)v[P[it]]=P[it+1];return v}else return P;case 6:var D=f(W,K),_e=s[D],P=w(K);return _e?_e(P):P;case 7:if(W.value===25)return K.readFloat16();if(W.value===26)return K.readFloat32();if(W.value===27)return K.readFloat64();switch(f(W,K)){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case null:return y;default:throw new Error("Unknown fixed value: "+W.value)}default:throw new Error("Unsupported header: "+JSON.stringify(W))}throw new Error("not implemented yet")}function R(K,W){for(var Ye=0;Ye<n.length;Ye++){var Qe=n[Ye].fn(K);if(Qe!==void 0)return g(6,n[Ye].tag,W),R(Qe,W)}if(K&&typeof K.toCBOR=="function"&&(K=K.toCBOR()),K===!1)g(7,20,W);else if(K===!0)g(7,21,W);else if(K===null)g(7,22,W);else if(K===void 0)g(7,23,W);else if(typeof K=="number")Math.floor(K)===K&&K<9007199254740992&&K>-9007199254740992?K<0?g(1,-1-K,W):g(0,K,W):(p(7,27,W),W.writeFloat64(K));else if(typeof K=="string")W.writeString(K,function(ze){g(3,ze,W)});else if(W.canWriteBinary(K))W.writeBinary(K,function(ze){g(2,ze,W)});else if(typeof K=="object")if(je.config.useToJSON&&typeof K.toJSON=="function"&&(K=K.toJSON()),Array.isArray(K)){g(4,K.length,W);for(var Ye=0;Ye<K.length;Ye++)R(K[Ye],W)}else{var it=Object.keys(K);g(5,it.length,W);for(var Ye=0;Ye<it.length;Ye++)R(it[Ye],W),R(K[it[Ye]],W)}else throw new Error("CBOR encoding not supported: "+K)}var I=[],k=[],je={config:{useToJSON:!0},addWriter:function(K,W){typeof K=="string"?k.push(function(Ye){if(K===Ye)return W(Ye)}):k.push(K)},addReader:function(K,W){typeof K=="string"?I.push(function(Ye,Qe){if(K===Qe)return W(Ye,Qe)}):I.push(K)},encode:function(K,W){for(var Ye=0;Ye<k.length;Ye++){var Qe=k[Ye],it=Qe(W);if(it)return R(K,it),it.result()}throw new Error("Unsupported output format: "+W)},decode:function(K,W){for(var Ye=0;Ye<I.length;Ye++){var Qe=I[Ye],it=Qe(K,W);if(it)return w(it)}throw new Error("Unsupported input format: "+W)},addSemanticEncode:function(K,W){if(typeof K!="number"||K%1!==0||K<0)throw new Error("Tag must be a positive integer");return n.push({tag:K,fn:W}),this},addSemanticDecode:function(K,W){if(typeof K!="number"||K%1!==0||K<0)throw new Error("Tag must be a positive integer");return s[K]=W,this},Reader:l,Writer:u};function Ve(K){this.buffer=K,this.pos=0}Ve.prototype=Object.create(l.prototype),Ve.prototype.peekByte=function(){return this.buffer[this.pos]},Ve.prototype.readByte=function(){return this.buffer[this.pos++]},Ve.prototype.readUint16=function(){var K=this.buffer.readUInt16BE(this.pos);return this.pos+=2,K},Ve.prototype.readUint32=function(){var K=this.buffer.readUInt32BE(this.pos);return this.pos+=4,K},Ve.prototype.readFloat32=function(){var K=this.buffer.readFloatBE(this.pos);return this.pos+=4,K},Ve.prototype.readFloat64=function(){var K=this.buffer.readDoubleBE(this.pos);return this.pos+=8,K},Ve.prototype.readChunk=function(K){var W=Buffer.alloc(K);return this.buffer.copy(W,0,this.pos,this.pos+=K),W};function q(K){this.byteLength=0,this.defaultBufferLength=16384,this.latestBuffer=Buffer.alloc(this.defaultBufferLength),this.latestBufferOffset=0,this.completeBuffers=[],this.stringFormat=K}q.prototype=Object.create(u.prototype),q.prototype.writeByte=function(K){this.latestBuffer[this.latestBufferOffset++]=K,this.latestBufferOffset>=this.latestBuffer.length&&(this.completeBuffers.push(this.latestBuffer),this.latestBuffer=Buffer.alloc(this.defaultBufferLength),this.latestBufferOffset=0),this.byteLength++},q.prototype.writeFloat32=function(K){var W=Buffer.alloc(4);W.writeFloatBE(K,0),this.writeBuffer(W)},q.prototype.writeFloat64=function(K){var W=Buffer.alloc(8);W.writeDoubleBE(K,0),this.writeBuffer(W)},q.prototype.writeString=function(K,W){var Ye=Buffer.from(K,"utf-8");W(Ye.length),this.writeBuffer(Ye)},q.prototype.canWriteBinary=function(K){return K instanceof Buffer},q.prototype.writeBinary=function(K,W){W(K.length),this.writeBuffer(K)},q.prototype.writeBuffer=function(K){if(!(K instanceof Buffer))throw new TypeError("BufferWriter only accepts Buffers");this.latestBufferOffset?this.latestBuffer.length-this.latestBufferOffset>=K.length?(K.copy(this.latestBuffer,this.latestBufferOffset),this.latestBufferOffset+=K.length,this.latestBufferOffset>=this.latestBuffer.length&&(this.completeBuffers.push(this.latestBuffer),this.latestBuffer=Buffer.alloc(this.defaultBufferLength),this.latestBufferOffset=0)):(this.completeBuffers.push(this.latestBuffer.slice(0,this.latestBufferOffset)),this.completeBuffers.push(K),this.latestBuffer=Buffer.alloc(this.defaultBufferLength),this.latestBufferOffset=0):this.completeBuffers.push(K),this.byteLength+=K.length},q.prototype.result=function(){for(var K=Buffer.alloc(this.byteLength),W=0,Ye=0;Ye<this.completeBuffers.length;Ye++){var Qe=this.completeBuffers[Ye];Qe.copy(K,W,0,Qe.length),W+=Qe.length}return this.latestBufferOffset&&this.latestBuffer.copy(K,W,0,this.latestBufferOffset),this.stringFormat?K.toString(this.stringFormat):K},typeof Buffer=="function"&&(je.addReader(function(K,W){if(K instanceof Buffer)return new Ve(K);if(W==="hex"||W==="base64"){var Ye=Buffer.from(K,W);return new Ve(Ye)}}),je.addWriter(function(K){if(!K||K==="buffer")return new q;if(K==="hex"||K==="base64")return new q(K)}));function $e(K){this.hex=K,this.pos=0}$e.prototype=Object.create(l.prototype),$e.prototype.peekByte=function(){var K=this.hex.substring(this.pos,2);return parseInt(K,16)},$e.prototype.readByte=function(){var K=this.hex.substring(this.pos,this.pos+2);return this.pos+=2,parseInt(K,16)},$e.prototype.readChunk=function(K){var W=this.hex.substring(this.pos,this.pos+K*2);return this.pos+=K*2,typeof Buffer=="function"?Buffer.from(W,"hex"):new r(W)};function We(K){this.$hex="",this.finalFormat=K||"hex"}return We.prototype=Object.create(u.prototype),We.prototype.writeByte=function(K){if(K<0||K>255)throw new Error("Byte value out of range: "+K);var W=K.toString(16);W.length==1&&(W="0"+W),this.$hex+=W},We.prototype.canWriteBinary=function(K){return K instanceof r||typeof Buffer=="function"&&K instanceof Buffer},We.prototype.writeBinary=function(K,W){if(K instanceof r)W(K.length()),this.$hex+=K.$hex;else if(typeof Buffer=="function"&&K instanceof Buffer)W(K.length),this.$hex+=K.toString("hex");else throw new TypeError("HexWriter only accepts BinaryHex or Buffers")},We.prototype.result=function(){return this.finalFormat==="buffer"&&typeof Buffer=="function"?Buffer.from(this.$hex,"hex"):new r(this.$hex).toString(this.finalFormat)},We.prototype.writeString=function(K,W){var Ye=r.fromUtf8String(K);W(Ye.length()),this.$hex+=Ye.$hex},je.addReader(function(K,W){if(K instanceof r||K.$hex)return new $e(K.$hex);if(W==="hex")return new $e(K)}),je.addWriter(function(K){if(K==="hex")return new We}),je})();return t.addSemanticEncode(0,function(r){if(r instanceof Date)return r.toISOString()}).addSemanticDecode(0,function(r){return new Date(r)}).addSemanticDecode(1,function(r){return new Date(r)}),t})})(main$1)),main$1.exports}var hasRequiredCbor;function requireCbor(){if(hasRequiredCbor)return cbor;hasRequiredCbor=1,Object.defineProperty(cbor,"__esModule",{value:!0}),cbor.cborDecode=cbor.cborEncode=void 0;const e=requireMain(),t=n=>e.encode(n);cbor.cborEncode=t;const r=n=>e.decode(Buffer.isBuffer(n)?n:Buffer.from(n,"hex"));return cbor.cborDecode=r,cbor}var hasRequiredUr;function requireUr(){if(hasRequiredUr)return ur;hasRequiredUr=1,Object.defineProperty(ur,"__esModule",{value:!0});const e=requireErrors$1(),t=requireUtils$7(),r=requireCbor();class n{constructor(a,l="bytes"){if(this._cborPayload=a,this._type=l,!t.isURType(this._type))throw new e.InvalidTypeError}static fromBuffer(a){return new n(r.cborEncode(a))}static from(a,l){return n.fromBuffer(Buffer.from(a,l))}decodeCBOR(){return r.cborDecode(this._cborPayload)}get type(){return this._type}get cbor(){return this._cborPayload}equals(a){return this.type===a.type&&this.cbor.equals(a.cbor)}}return ur.default=n,ur}var urEncoder={},fountainEncoder={},assert$2={exports:{}},errors={},util={},types$1={},isArguments$1,hasRequiredIsArguments$1;function requireIsArguments$1(){if(hasRequiredIsArguments$1)return isArguments$1;hasRequiredIsArguments$1=1;var e=requireShams()(),t=requireCallBound$1(),r=t("Object.prototype.toString"),n=function(u){return e&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:r(u)==="[object Arguments]"},s=function(u){return n(u)?!0:u!==null&&typeof u=="object"&&"length"in u&&typeof u.length=="number"&&u.length>=0&&r(u)!=="[object Array]"&&"callee"in u&&r(u.callee)==="[object Function]"},a=(function(){return n(arguments)})();return n.isLegacyArguments=s,isArguments$1=a?n:s,isArguments$1}var isRegex,hasRequiredIsRegex;function requireIsRegex(){if(hasRequiredIsRegex)return isRegex;hasRequiredIsRegex=1;var e=requireCallBound$1(),t=requireShams()(),r=requireHasown(),n=requireGopd(),s;if(t){var a=e("RegExp.prototype.exec"),l={},u=function(){throw l},x={toString:u,valueOf:u};typeof Symbol.toPrimitive=="symbol"&&(x[Symbol.toPrimitive]=u),s=function(y){if(!y||typeof y!="object")return!1;var w=n(y,"lastIndex"),R=w&&r(w,"value");if(!R)return!1;try{a(y,x)}catch(I){return I===l}}}else{var f=e("Object.prototype.toString"),p="[object RegExp]";s=function(y){return!y||typeof y!="object"&&typeof y!="function"?!1:f(y)===p}}return isRegex=s,isRegex}var safeRegexTest,hasRequiredSafeRegexTest;function requireSafeRegexTest(){if(hasRequiredSafeRegexTest)return safeRegexTest;hasRequiredSafeRegexTest=1;var e=requireCallBound$1(),t=requireIsRegex(),r=e("RegExp.prototype.exec"),n=requireType();return safeRegexTest=function(a){if(!t(a))throw new n("`regex` must be a RegExp");return function(u){return r(a,u)!==null}},safeRegexTest}var generatorFunction,hasRequiredGeneratorFunction;function requireGeneratorFunction(){if(hasRequiredGeneratorFunction)return generatorFunction;hasRequiredGeneratorFunction=1;const e=(function*(){}).constructor;return generatorFunction=()=>e,generatorFunction}var isGeneratorFunction,hasRequiredIsGeneratorFunction;function requireIsGeneratorFunction(){if(hasRequiredIsGeneratorFunction)return isGeneratorFunction;hasRequiredIsGeneratorFunction=1;var e=requireCallBound$1(),t=requireSafeRegexTest(),r=t(/^\s*(?:function)?\*/),n=requireShams()(),s=requireGetProto(),a=e("Object.prototype.toString"),l=e("Function.prototype.toString"),u=requireGeneratorFunction();return isGeneratorFunction=function(f){if(typeof f!="function")return!1;if(r(l(f)))return!0;if(!n){var p=a(f);return p==="[object GeneratorFunction]"}if(!s)return!1;var g=u();return g&&s(f)===g.prototype},isGeneratorFunction}var hasRequiredTypes$1;function requireTypes$1(){return hasRequiredTypes$1||(hasRequiredTypes$1=1,(function(e){var t=requireIsArguments$1(),r=requireIsGeneratorFunction(),n=requireWhichTypedArray(),s=requireIsTypedArray();function a(xr){return xr.call.bind(xr)}var l=typeof BigInt<"u",u=typeof Symbol<"u",x=a(Object.prototype.toString),f=a(Number.prototype.valueOf),p=a(String.prototype.valueOf),g=a(Boolean.prototype.valueOf);if(l)var y=a(BigInt.prototype.valueOf);if(u)var w=a(Symbol.prototype.valueOf);function R(xr,Cr){if(typeof xr!="object")return!1;try{return Cr(xr),!0}catch{return!1}}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=s;function I(xr){return typeof Promise<"u"&&xr instanceof Promise||xr!==null&&typeof xr=="object"&&typeof xr.then=="function"&&typeof xr.catch=="function"}e.isPromise=I;function k(xr){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(xr):s(xr)||lt(xr)}e.isArrayBufferView=k;function je(xr){return n(xr)==="Uint8Array"}e.isUint8Array=je;function Ve(xr){return n(xr)==="Uint8ClampedArray"}e.isUint8ClampedArray=Ve;function q(xr){return n(xr)==="Uint16Array"}e.isUint16Array=q;function $e(xr){return n(xr)==="Uint32Array"}e.isUint32Array=$e;function We(xr){return n(xr)==="Int8Array"}e.isInt8Array=We;function K(xr){return n(xr)==="Int16Array"}e.isInt16Array=K;function W(xr){return n(xr)==="Int32Array"}e.isInt32Array=W;function Ye(xr){return n(xr)==="Float32Array"}e.isFloat32Array=Ye;function Qe(xr){return n(xr)==="Float64Array"}e.isFloat64Array=Qe;function it(xr){return n(xr)==="BigInt64Array"}e.isBigInt64Array=it;function ze(xr){return n(xr)==="BigUint64Array"}e.isBigUint64Array=ze;function v(xr){return x(xr)==="[object Map]"}v.working=typeof Map<"u"&&v(new Map);function D(xr){return typeof Map>"u"?!1:v.working?v(xr):xr instanceof Map}e.isMap=D;function _e(xr){return x(xr)==="[object Set]"}_e.working=typeof Set<"u"&&_e(new Set);function P(xr){return typeof Set>"u"?!1:_e.working?_e(xr):xr instanceof Set}e.isSet=P;function Re(xr){return x(xr)==="[object WeakMap]"}Re.working=typeof WeakMap<"u"&&Re(new WeakMap);function Fe(xr){return typeof WeakMap>"u"?!1:Re.working?Re(xr):xr instanceof WeakMap}e.isWeakMap=Fe;function Le(xr){return x(xr)==="[object WeakSet]"}Le.working=typeof WeakSet<"u"&&Le(new WeakSet);function Ce(xr){return Le(xr)}e.isWeakSet=Ce;function L(xr){return x(xr)==="[object ArrayBuffer]"}L.working=typeof ArrayBuffer<"u"&&L(new ArrayBuffer);function O(xr){return typeof ArrayBuffer>"u"?!1:L.working?L(xr):xr instanceof ArrayBuffer}e.isArrayBuffer=O;function st(xr){return x(xr)==="[object DataView]"}st.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&st(new DataView(new ArrayBuffer(1),0,1));function lt(xr){return typeof DataView>"u"?!1:st.working?st(xr):xr instanceof DataView}e.isDataView=lt;var Xe=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function dt(xr){return x(xr)==="[object SharedArrayBuffer]"}function er(xr){return typeof Xe>"u"?!1:(typeof dt.working>"u"&&(dt.working=dt(new Xe)),dt.working?dt(xr):xr instanceof Xe)}e.isSharedArrayBuffer=er;function ar(xr){return x(xr)==="[object AsyncFunction]"}e.isAsyncFunction=ar;function dr(xr){return x(xr)==="[object Map Iterator]"}e.isMapIterator=dr;function ir(xr){return x(xr)==="[object Set Iterator]"}e.isSetIterator=ir;function pt(xr){return x(xr)==="[object Generator]"}e.isGeneratorObject=pt;function tr(xr){return x(xr)==="[object WebAssembly.Module]"}e.isWebAssemblyCompiledModule=tr;function sr(xr){return R(xr,f)}e.isNumberObject=sr;function nr(xr){return R(xr,p)}e.isStringObject=nr;function pr(xr){return R(xr,g)}e.isBooleanObject=pr;function gr(xr){return l&&R(xr,y)}e.isBigIntObject=gr;function mr(xr){return u&&R(xr,w)}e.isSymbolObject=mr;function yr(xr){return sr(xr)||nr(xr)||pr(xr)||gr(xr)||mr(xr)}e.isBoxedPrimitive=yr;function Er(xr){return typeof Uint8Array<"u"&&(O(xr)||er(xr))}e.isAnyArrayBuffer=Er,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(xr){Object.defineProperty(e,xr,{enumerable:!1,value:function(){throw new Error(xr+" is not supported in userland")}})})})(types$1)),types$1}var isBufferBrowser,hasRequiredIsBufferBrowser;function requireIsBufferBrowser(){return hasRequiredIsBufferBrowser||(hasRequiredIsBufferBrowser=1,isBufferBrowser=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),isBufferBrowser}var hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,(function(e){var t={},r=Object.getOwnPropertyDescriptors||function(Xe){for(var dt=Object.keys(Xe),er={},ar=0;ar<dt.length;ar++)er[dt[ar]]=Object.getOwnPropertyDescriptor(Xe,dt[ar]);return er},n=/%[sdj%]/g;e.format=function(lt){if(!K(lt)){for(var Xe=[],dt=0;dt<arguments.length;dt++)Xe.push(u(arguments[dt]));return Xe.join(" ")}for(var dt=1,er=arguments,ar=er.length,dr=String(lt).replace(n,function(pt){if(pt==="%%")return"%";if(dt>=ar)return pt;switch(pt){case"%s":return String(er[dt++]);case"%d":return Number(er[dt++]);case"%j":try{return JSON.stringify(er[dt++])}catch{return"[Circular]"}default:return pt}}),ir=er[dt];dt<ar;ir=er[++dt])q(ir)||!it(ir)?dr+=" "+ir:dr+=" "+u(ir);return dr},e.deprecate=function(lt,Xe){if(typeof process$1<"u"&&process$1.noDeprecation===!0)return lt;if(typeof process$1>"u")return function(){return e.deprecate(lt,Xe).apply(this,arguments)};var dt=!1;function er(){if(!dt){if(process$1.throwDeprecation)throw new Error(Xe);process$1.traceDeprecation?console.trace(Xe):console.error(Xe),dt=!0}return lt.apply(this,arguments)}return er};var s={},a=/^$/;if(t.NODE_DEBUG){var l=t.NODE_DEBUG;l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+l+"$","i")}e.debuglog=function(lt){if(lt=lt.toUpperCase(),!s[lt])if(a.test(lt)){var Xe=process$1.pid;s[lt]=function(){var dt=e.format.apply(e,arguments);console.error("%s %d: %s",lt,Xe,dt)}}else s[lt]=function(){};return s[lt]};function u(lt,Xe){var dt={seen:[],stylize:f};return arguments.length>=3&&(dt.depth=arguments[2]),arguments.length>=4&&(dt.colors=arguments[3]),Ve(Xe)?dt.showHidden=Xe:Xe&&e._extend(dt,Xe),Ye(dt.showHidden)&&(dt.showHidden=!1),Ye(dt.depth)&&(dt.depth=2),Ye(dt.colors)&&(dt.colors=!1),Ye(dt.customInspect)&&(dt.customInspect=!0),dt.colors&&(dt.stylize=x),g(dt,lt,dt.depth)}e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function x(lt,Xe){var dt=u.styles[Xe];return dt?"\x1B["+u.colors[dt][0]+"m"+lt+"\x1B["+u.colors[dt][1]+"m":lt}function f(lt,Xe){return lt}function p(lt){var Xe={};return lt.forEach(function(dt,er){Xe[dt]=!0}),Xe}function g(lt,Xe,dt){if(lt.customInspect&&Xe&&D(Xe.inspect)&&Xe.inspect!==e.inspect&&!(Xe.constructor&&Xe.constructor.prototype===Xe)){var er=Xe.inspect(dt,lt);return K(er)||(er=g(lt,er,dt)),er}var ar=y(lt,Xe);if(ar)return ar;var dr=Object.keys(Xe),ir=p(dr);if(lt.showHidden&&(dr=Object.getOwnPropertyNames(Xe)),v(Xe)&&(dr.indexOf("message")>=0||dr.indexOf("description")>=0))return w(Xe);if(dr.length===0){if(D(Xe)){var pt=Xe.name?": "+Xe.name:"";return lt.stylize("[Function"+pt+"]","special")}if(Qe(Xe))return lt.stylize(RegExp.prototype.toString.call(Xe),"regexp");if(ze(Xe))return lt.stylize(Date.prototype.toString.call(Xe),"date");if(v(Xe))return w(Xe)}var tr="",sr=!1,nr=["{","}"];if(je(Xe)&&(sr=!0,nr=["[","]"]),D(Xe)){var pr=Xe.name?": "+Xe.name:"";tr=" [Function"+pr+"]"}if(Qe(Xe)&&(tr=" "+RegExp.prototype.toString.call(Xe)),ze(Xe)&&(tr=" "+Date.prototype.toUTCString.call(Xe)),v(Xe)&&(tr=" "+w(Xe)),dr.length===0&&(!sr||Xe.length==0))return nr[0]+tr+nr[1];if(dt<0)return Qe(Xe)?lt.stylize(RegExp.prototype.toString.call(Xe),"regexp"):lt.stylize("[Object]","special");lt.seen.push(Xe);var gr;return sr?gr=R(lt,Xe,dt,ir,dr):gr=dr.map(function(mr){return I(lt,Xe,dt,ir,mr,sr)}),lt.seen.pop(),k(gr,tr,nr)}function y(lt,Xe){if(Ye(Xe))return lt.stylize("undefined","undefined");if(K(Xe)){var dt="'"+JSON.stringify(Xe).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return lt.stylize(dt,"string")}if(We(Xe))return lt.stylize(""+Xe,"number");if(Ve(Xe))return lt.stylize(""+Xe,"boolean");if(q(Xe))return lt.stylize("null","null")}function w(lt){return"["+Error.prototype.toString.call(lt)+"]"}function R(lt,Xe,dt,er,ar){for(var dr=[],ir=0,pt=Xe.length;ir<pt;++ir)Ce(Xe,String(ir))?dr.push(I(lt,Xe,dt,er,String(ir),!0)):dr.push("");return ar.forEach(function(tr){tr.match(/^\d+$/)||dr.push(I(lt,Xe,dt,er,tr,!0))}),dr}function I(lt,Xe,dt,er,ar,dr){var ir,pt,tr;if(tr=Object.getOwnPropertyDescriptor(Xe,ar)||{value:Xe[ar]},tr.get?tr.set?pt=lt.stylize("[Getter/Setter]","special"):pt=lt.stylize("[Getter]","special"):tr.set&&(pt=lt.stylize("[Setter]","special")),Ce(er,ar)||(ir="["+ar+"]"),pt||(lt.seen.indexOf(tr.value)<0?(q(dt)?pt=g(lt,tr.value,null):pt=g(lt,tr.value,dt-1),pt.indexOf(`
`)>-1&&(dr?pt=pt.split(`
`).map(function(sr){return"  "+sr}).join(`
`).slice(2):pt=`
`+pt.split(`
`).map(function(sr){return"   "+sr}).join(`
`))):pt=lt.stylize("[Circular]","special")),Ye(ir)){if(dr&&ar.match(/^\d+$/))return pt;ir=JSON.stringify(""+ar),ir.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ir=ir.slice(1,-1),ir=lt.stylize(ir,"name")):(ir=ir.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ir=lt.stylize(ir,"string"))}return ir+": "+pt}function k(lt,Xe,dt){var er=lt.reduce(function(ar,dr){return dr.indexOf(`
`)>=0,ar+dr.replace(/\u001b\[\d\d?m/g,"").length+1},0);return er>60?dt[0]+(Xe===""?"":Xe+`
 `)+" "+lt.join(`,
  `)+" "+dt[1]:dt[0]+Xe+" "+lt.join(", ")+" "+dt[1]}e.types=requireTypes$1();function je(lt){return Array.isArray(lt)}e.isArray=je;function Ve(lt){return typeof lt=="boolean"}e.isBoolean=Ve;function q(lt){return lt===null}e.isNull=q;function $e(lt){return lt==null}e.isNullOrUndefined=$e;function We(lt){return typeof lt=="number"}e.isNumber=We;function K(lt){return typeof lt=="string"}e.isString=K;function W(lt){return typeof lt=="symbol"}e.isSymbol=W;function Ye(lt){return lt===void 0}e.isUndefined=Ye;function Qe(lt){return it(lt)&&P(lt)==="[object RegExp]"}e.isRegExp=Qe,e.types.isRegExp=Qe;function it(lt){return typeof lt=="object"&&lt!==null}e.isObject=it;function ze(lt){return it(lt)&&P(lt)==="[object Date]"}e.isDate=ze,e.types.isDate=ze;function v(lt){return it(lt)&&(P(lt)==="[object Error]"||lt instanceof Error)}e.isError=v,e.types.isNativeError=v;function D(lt){return typeof lt=="function"}e.isFunction=D;function _e(lt){return lt===null||typeof lt=="boolean"||typeof lt=="number"||typeof lt=="string"||typeof lt=="symbol"||typeof lt>"u"}e.isPrimitive=_e,e.isBuffer=requireIsBufferBrowser();function P(lt){return Object.prototype.toString.call(lt)}function Re(lt){return lt<10?"0"+lt.toString(10):lt.toString(10)}var Fe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Le(){var lt=new Date,Xe=[Re(lt.getHours()),Re(lt.getMinutes()),Re(lt.getSeconds())].join(":");return[lt.getDate(),Fe[lt.getMonth()],Xe].join(" ")}e.log=function(){console.log("%s - %s",Le(),e.format.apply(e,arguments))},e.inherits=requireInherits_browser(),e._extend=function(lt,Xe){if(!Xe||!it(Xe))return lt;for(var dt=Object.keys(Xe),er=dt.length;er--;)lt[dt[er]]=Xe[dt[er]];return lt};function Ce(lt,Xe){return Object.prototype.hasOwnProperty.call(lt,Xe)}var L=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;e.promisify=function(Xe){if(typeof Xe!="function")throw new TypeError('The "original" argument must be of type Function');if(L&&Xe[L]){var dt=Xe[L];if(typeof dt!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(dt,L,{value:dt,enumerable:!1,writable:!1,configurable:!0}),dt}function dt(){for(var er,ar,dr=new Promise(function(tr,sr){er=tr,ar=sr}),ir=[],pt=0;pt<arguments.length;pt++)ir.push(arguments[pt]);ir.push(function(tr,sr){tr?ar(tr):er(sr)});try{Xe.apply(this,ir)}catch(tr){ar(tr)}return dr}return Object.setPrototypeOf(dt,Object.getPrototypeOf(Xe)),L&&Object.defineProperty(dt,L,{value:dt,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(dt,r(Xe))},e.promisify.custom=L;function O(lt,Xe){if(!lt){var dt=new Error("Promise was rejected with a falsy value");dt.reason=lt,lt=dt}return Xe(lt)}function st(lt){if(typeof lt!="function")throw new TypeError('The "original" argument must be of type Function');function Xe(){for(var dt=[],er=0;er<arguments.length;er++)dt.push(arguments[er]);var ar=dt.pop();if(typeof ar!="function")throw new TypeError("The last argument must be of type Function");var dr=this,ir=function(){return ar.apply(dr,arguments)};lt.apply(this,dt).then(function(pt){process$1.nextTick(ir.bind(null,null,pt))},function(pt){process$1.nextTick(O.bind(null,pt,ir))})}return Object.setPrototypeOf(Xe,Object.getPrototypeOf(lt)),Object.defineProperties(Xe,r(lt)),Xe}e.callbackify=st})(util)),util}var hasRequiredErrors;function requireErrors(){if(hasRequiredErrors)return errors;hasRequiredErrors=1;function e(Ve){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},e(Ve)}function t(Ve,q,$e){return Object.defineProperty(Ve,"prototype",{writable:!1}),Ve}function r(Ve,q){if(!(Ve instanceof q))throw new TypeError("Cannot call a class as a function")}function n(Ve,q){if(typeof q!="function"&&q!==null)throw new TypeError("Super expression must either be null or a function");Ve.prototype=Object.create(q&&q.prototype,{constructor:{value:Ve,writable:!0,configurable:!0}}),Object.defineProperty(Ve,"prototype",{writable:!1}),q&&s(Ve,q)}function s(Ve,q){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(We,K){return We.__proto__=K,We},s(Ve,q)}function a(Ve){var q=x();return function(){var We=f(Ve),K;if(q){var W=f(this).constructor;K=Reflect.construct(We,arguments,W)}else K=We.apply(this,arguments);return l(this,K)}}function l(Ve,q){if(q&&(e(q)==="object"||typeof q=="function"))return q;if(q!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u(Ve)}function u(Ve){if(Ve===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ve}function x(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f(Ve){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function($e){return $e.__proto__||Object.getPrototypeOf($e)},f(Ve)}var p={},g,y;function w(Ve,q,$e){$e||($e=Error);function We(W,Ye,Qe){return typeof q=="string"?q:q(W,Ye,Qe)}var K=(function(W){n(Qe,W);var Ye=a(Qe);function Qe(it,ze,v){var D;return r(this,Qe),D=Ye.call(this,We(it,ze,v)),D.code=Ve,D}return t(Qe)})($e);p[Ve]=K}function R(Ve,q){if(Array.isArray(Ve)){var $e=Ve.length;return Ve=Ve.map(function(We){return String(We)}),$e>2?"one of ".concat(q," ").concat(Ve.slice(0,$e-1).join(", "),", or ")+Ve[$e-1]:$e===2?"one of ".concat(q," ").concat(Ve[0]," or ").concat(Ve[1]):"of ".concat(q," ").concat(Ve[0])}else return"of ".concat(q," ").concat(String(Ve))}function I(Ve,q,$e){return Ve.substr(0,q.length)===q}function k(Ve,q,$e){return($e===void 0||$e>Ve.length)&&($e=Ve.length),Ve.substring($e-q.length,$e)===q}function je(Ve,q,$e){return typeof $e!="number"&&($e=0),$e+q.length>Ve.length?!1:Ve.indexOf(q,$e)!==-1}return w("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),w("ERR_INVALID_ARG_TYPE",function(Ve,q,$e){g===void 0&&(g=requireAssert()),g(typeof Ve=="string","'name' must be a string");var We;typeof q=="string"&&I(q,"not ")?(We="must not be",q=q.replace(/^not /,"")):We="must be";var K;if(k(Ve," argument"))K="The ".concat(Ve," ").concat(We," ").concat(R(q,"type"));else{var W=je(Ve,".")?"property":"argument";K='The "'.concat(Ve,'" ').concat(W," ").concat(We," ").concat(R(q,"type"))}return K+=". Received type ".concat(e($e)),K},TypeError),w("ERR_INVALID_ARG_VALUE",function(Ve,q){var $e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";y===void 0&&(y=requireUtil());var We=y.inspect(q);return We.length>128&&(We="".concat(We.slice(0,128),"...")),"The argument '".concat(Ve,"' ").concat($e,". Received ").concat(We)},TypeError),w("ERR_INVALID_RETURN_VALUE",function(Ve,q,$e){var We;return $e&&$e.constructor&&$e.constructor.name?We="instance of ".concat($e.constructor.name):We="type ".concat(e($e)),"Expected ".concat(Ve,' to be returned from the "').concat(q,'"')+" function but got ".concat(We,".")},TypeError),w("ERR_MISSING_ARGS",function(){for(var Ve=arguments.length,q=new Array(Ve),$e=0;$e<Ve;$e++)q[$e]=arguments[$e];g===void 0&&(g=requireAssert()),g(q.length>0,"At least one arg needs to be specified");var We="The ",K=q.length;switch(q=q.map(function(W){return'"'.concat(W,'"')}),K){case 1:We+="".concat(q[0]," argument");break;case 2:We+="".concat(q[0]," and ").concat(q[1]," arguments");break;default:We+=q.slice(0,K-1).join(", "),We+=", and ".concat(q[K-1]," arguments");break}return"".concat(We," must be specified")},TypeError),errors.codes=p,errors}var assertion_error,hasRequiredAssertion_error;function requireAssertion_error(){if(hasRequiredAssertion_error)return assertion_error;hasRequiredAssertion_error=1;function e(Ce,L){var O=Object.keys(Ce);if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(Ce);L&&(st=st.filter(function(lt){return Object.getOwnPropertyDescriptor(Ce,lt).enumerable})),O.push.apply(O,st)}return O}function t(Ce){for(var L=1;L<arguments.length;L++){var O=arguments[L]!=null?arguments[L]:{};L%2?e(Object(O),!0).forEach(function(st){r(Ce,st,O[st])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ce,Object.getOwnPropertyDescriptors(O)):e(Object(O)).forEach(function(st){Object.defineProperty(Ce,st,Object.getOwnPropertyDescriptor(O,st))})}return Ce}function r(Ce,L,O){return L=l(L),L in Ce?Object.defineProperty(Ce,L,{value:O,enumerable:!0,configurable:!0,writable:!0}):Ce[L]=O,Ce}function n(Ce,L){if(!(Ce instanceof L))throw new TypeError("Cannot call a class as a function")}function s(Ce,L){for(var O=0;O<L.length;O++){var st=L[O];st.enumerable=st.enumerable||!1,st.configurable=!0,"value"in st&&(st.writable=!0),Object.defineProperty(Ce,l(st.key),st)}}function a(Ce,L,O){return L&&s(Ce.prototype,L),Object.defineProperty(Ce,"prototype",{writable:!1}),Ce}function l(Ce){var L=u(Ce,"string");return Ve(L)==="symbol"?L:String(L)}function u(Ce,L){if(Ve(Ce)!=="object"||Ce===null)return Ce;var O=Ce[Symbol.toPrimitive];if(O!==void 0){var st=O.call(Ce,L);if(Ve(st)!=="object")return st;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Ce)}function x(Ce,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function");Ce.prototype=Object.create(L&&L.prototype,{constructor:{value:Ce,writable:!0,configurable:!0}}),Object.defineProperty(Ce,"prototype",{writable:!1}),L&&k(Ce,L)}function f(Ce){var L=R();return function(){var st=je(Ce),lt;if(L){var Xe=je(this).constructor;lt=Reflect.construct(st,arguments,Xe)}else lt=st.apply(this,arguments);return p(this,lt)}}function p(Ce,L){if(L&&(Ve(L)==="object"||typeof L=="function"))return L;if(L!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g(Ce)}function g(Ce){if(Ce===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ce}function y(Ce){var L=typeof Map=="function"?new Map:void 0;return y=function(st){if(st===null||!I(st))return st;if(typeof st!="function")throw new TypeError("Super expression must either be null or a function");if(typeof L<"u"){if(L.has(st))return L.get(st);L.set(st,lt)}function lt(){return w(st,arguments,je(this).constructor)}return lt.prototype=Object.create(st.prototype,{constructor:{value:lt,enumerable:!1,writable:!0,configurable:!0}}),k(lt,st)},y(Ce)}function w(Ce,L,O){return R()?w=Reflect.construct.bind():w=function(lt,Xe,dt){var er=[null];er.push.apply(er,Xe);var ar=Function.bind.apply(lt,er),dr=new ar;return dt&&k(dr,dt.prototype),dr},w.apply(null,arguments)}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function I(Ce){return Function.toString.call(Ce).indexOf("[native code]")!==-1}function k(Ce,L){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(st,lt){return st.__proto__=lt,st},k(Ce,L)}function je(Ce){return je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(O){return O.__proto__||Object.getPrototypeOf(O)},je(Ce)}function Ve(Ce){"@babel/helpers - typeof";return Ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Ve(Ce)}var q=requireUtil(),$e=q.inspect,We=requireErrors(),K=We.codes.ERR_INVALID_ARG_TYPE;function W(Ce,L,O){return(O===void 0||O>Ce.length)&&(O=Ce.length),Ce.substring(O-L.length,O)===L}function Ye(Ce,L){if(L=Math.floor(L),Ce.length==0||L==0)return"";var O=Ce.length*L;for(L=Math.floor(Math.log(L)/Math.log(2));L;)Ce+=Ce,L--;return Ce+=Ce.substring(0,O-Ce.length),Ce}var Qe="",it="",ze="",v="",D={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},_e=10;function P(Ce){var L=Object.keys(Ce),O=Object.create(Object.getPrototypeOf(Ce));return L.forEach(function(st){O[st]=Ce[st]}),Object.defineProperty(O,"message",{value:Ce.message}),O}function Re(Ce){return $e(Ce,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function Fe(Ce,L,O){var st="",lt="",Xe=0,dt="",er=!1,ar=Re(Ce),dr=ar.split(`
`),ir=Re(L).split(`
`),pt=0,tr="";if(O==="strictEqual"&&Ve(Ce)==="object"&&Ve(L)==="object"&&Ce!==null&&L!==null&&(O="strictEqualObject"),dr.length===1&&ir.length===1&&dr[0]!==ir[0]){var sr=dr[0].length+ir[0].length;if(sr<=_e){if((Ve(Ce)!=="object"||Ce===null)&&(Ve(L)!=="object"||L===null)&&(Ce!==0||L!==0))return"".concat(D[O],`

`)+"".concat(dr[0]," !== ").concat(ir[0],`
`)}else if(O!=="strictEqualObject"){var nr=process$1.stderr&&process$1.stderr.isTTY?process$1.stderr.columns:80;if(sr<nr){for(;dr[0][pt]===ir[0][pt];)pt++;pt>2&&(tr=`
  `.concat(Ye(" ",pt),"^"),pt=0)}}}for(var pr=dr[dr.length-1],gr=ir[ir.length-1];pr===gr&&(pt++<2?dt=`
  `.concat(pr).concat(dt):st=pr,dr.pop(),ir.pop(),!(dr.length===0||ir.length===0));)pr=dr[dr.length-1],gr=ir[ir.length-1];var mr=Math.max(dr.length,ir.length);if(mr===0){var yr=ar.split(`
`);if(yr.length>30)for(yr[26]="".concat(Qe,"...").concat(v);yr.length>27;)yr.pop();return"".concat(D.notIdentical,`

`).concat(yr.join(`
`),`
`)}pt>3&&(dt=`
`.concat(Qe,"...").concat(v).concat(dt),er=!0),st!==""&&(dt=`
  `.concat(st).concat(dt),st="");var Er=0,xr=D[O]+`
`.concat(it,"+ actual").concat(v," ").concat(ze,"- expected").concat(v),Cr=" ".concat(Qe,"...").concat(v," Lines skipped");for(pt=0;pt<mr;pt++){var wr=pt-Xe;if(dr.length<pt+1)wr>1&&pt>2&&(wr>4?(lt+=`
`.concat(Qe,"...").concat(v),er=!0):wr>3&&(lt+=`
  `.concat(ir[pt-2]),Er++),lt+=`
  `.concat(ir[pt-1]),Er++),Xe=pt,st+=`
`.concat(ze,"-").concat(v," ").concat(ir[pt]),Er++;else if(ir.length<pt+1)wr>1&&pt>2&&(wr>4?(lt+=`
`.concat(Qe,"...").concat(v),er=!0):wr>3&&(lt+=`
  `.concat(dr[pt-2]),Er++),lt+=`
  `.concat(dr[pt-1]),Er++),Xe=pt,lt+=`
`.concat(it,"+").concat(v," ").concat(dr[pt]),Er++;else{var kr=ir[pt],Dr=dr[pt],rr=Dr!==kr&&(!W(Dr,",")||Dr.slice(0,-1)!==kr);rr&&W(kr,",")&&kr.slice(0,-1)===Dr&&(rr=!1,Dr+=","),rr?(wr>1&&pt>2&&(wr>4?(lt+=`
`.concat(Qe,"...").concat(v),er=!0):wr>3&&(lt+=`
  `.concat(dr[pt-2]),Er++),lt+=`
  `.concat(dr[pt-1]),Er++),Xe=pt,lt+=`
`.concat(it,"+").concat(v," ").concat(Dr),st+=`
`.concat(ze,"-").concat(v," ").concat(kr),Er+=2):(lt+=st,st="",(wr===1||pt===0)&&(lt+=`
  `.concat(Dr),Er++))}if(Er>20&&pt<mr-2)return"".concat(xr).concat(Cr,`
`).concat(lt,`
`).concat(Qe,"...").concat(v).concat(st,`
`)+"".concat(Qe,"...").concat(v)}return"".concat(xr).concat(er?Cr:"",`
`).concat(lt).concat(st).concat(dt).concat(tr)}var Le=(function(Ce,L){x(st,Ce);var O=f(st);function st(lt){var Xe;if(n(this,st),Ve(lt)!=="object"||lt===null)throw new K("options","Object",lt);var dt=lt.message,er=lt.operator,ar=lt.stackStartFn,dr=lt.actual,ir=lt.expected,pt=Error.stackTraceLimit;if(Error.stackTraceLimit=0,dt!=null)Xe=O.call(this,String(dt));else if(process$1.stderr&&process$1.stderr.isTTY&&(process$1.stderr&&process$1.stderr.getColorDepth&&process$1.stderr.getColorDepth()!==1?(Qe="\x1B[34m",it="\x1B[32m",v="\x1B[39m",ze="\x1B[31m"):(Qe="",it="",v="",ze="")),Ve(dr)==="object"&&dr!==null&&Ve(ir)==="object"&&ir!==null&&"stack"in dr&&dr instanceof Error&&"stack"in ir&&ir instanceof Error&&(dr=P(dr),ir=P(ir)),er==="deepStrictEqual"||er==="strictEqual")Xe=O.call(this,Fe(dr,ir,er));else if(er==="notDeepStrictEqual"||er==="notStrictEqual"){var tr=D[er],sr=Re(dr).split(`
`);if(er==="notStrictEqual"&&Ve(dr)==="object"&&dr!==null&&(tr=D.notStrictEqualObject),sr.length>30)for(sr[26]="".concat(Qe,"...").concat(v);sr.length>27;)sr.pop();sr.length===1?Xe=O.call(this,"".concat(tr," ").concat(sr[0])):Xe=O.call(this,"".concat(tr,`

`).concat(sr.join(`
`),`
`))}else{var nr=Re(dr),pr="",gr=D[er];er==="notDeepEqual"||er==="notEqual"?(nr="".concat(D[er],`

`).concat(nr),nr.length>1024&&(nr="".concat(nr.slice(0,1021),"..."))):(pr="".concat(Re(ir)),nr.length>512&&(nr="".concat(nr.slice(0,509),"...")),pr.length>512&&(pr="".concat(pr.slice(0,509),"...")),er==="deepEqual"||er==="equal"?nr="".concat(gr,`

`).concat(nr,`

should equal

`):pr=" ".concat(er," ").concat(pr)),Xe=O.call(this,"".concat(nr).concat(pr))}return Error.stackTraceLimit=pt,Xe.generatedMessage=!dt,Object.defineProperty(g(Xe),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),Xe.code="ERR_ASSERTION",Xe.actual=dr,Xe.expected=ir,Xe.operator=er,Error.captureStackTrace&&Error.captureStackTrace(g(Xe),ar),Xe.stack,Xe.name="AssertionError",p(Xe)}return a(st,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:L,value:function(Xe,dt){return $e(this,t(t({},dt),{},{customInspect:!1,depth:0}))}}]),st})(y(Error),$e.custom);return assertion_error=Le,assertion_error}var isArguments,hasRequiredIsArguments;function requireIsArguments(){if(hasRequiredIsArguments)return isArguments;hasRequiredIsArguments=1;var e=Object.prototype.toString;return isArguments=function(r){var n=e.call(r),s=n==="[object Arguments]";return s||(s=n!=="[object Array]"&&r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&e.call(r.callee)==="[object Function]"),s},isArguments}var implementation$3,hasRequiredImplementation$3;function requireImplementation$3(){if(hasRequiredImplementation$3)return implementation$3;hasRequiredImplementation$3=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=requireIsArguments(),s=Object.prototype.propertyIsEnumerable,a=!s.call({toString:null},"toString"),l=s.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],x=function(y){var w=y.constructor;return w&&w.prototype===y},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=(function(){if(typeof window>"u")return!1;for(var y in window)try{if(!f["$"+y]&&t.call(window,y)&&window[y]!==null&&typeof window[y]=="object")try{x(window[y])}catch{return!0}}catch{return!0}return!1})(),g=function(y){if(typeof window>"u"||!p)return x(y);try{return x(y)}catch{return!1}};e=function(w){var R=w!==null&&typeof w=="object",I=r.call(w)==="[object Function]",k=n(w),je=R&&r.call(w)==="[object String]",Ve=[];if(!R&&!I&&!k)throw new TypeError("Object.keys called on a non-object");var q=l&&I;if(je&&w.length>0&&!t.call(w,0))for(var $e=0;$e<w.length;++$e)Ve.push(String($e));if(k&&w.length>0)for(var We=0;We<w.length;++We)Ve.push(String(We));else for(var K in w)!(q&&K==="prototype")&&t.call(w,K)&&Ve.push(String(K));if(a)for(var W=g(w),Ye=0;Ye<u.length;++Ye)!(W&&u[Ye]==="constructor")&&t.call(w,u[Ye])&&Ve.push(u[Ye]);return Ve}}return implementation$3=e,implementation$3}var objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var e=Array.prototype.slice,t=requireIsArguments(),r=Object.keys,n=r?function(l){return r(l)}:requireImplementation$3(),s=Object.keys;return n.shim=function(){if(Object.keys){var l=(function(){var u=Object.keys(arguments);return u&&u.length===arguments.length})(1,2);l||(Object.keys=function(x){return t(x)?s(e.call(x)):s(x)})}else Object.keys=n;return Object.keys||n},objectKeys=n,objectKeys}var implementation$2,hasRequiredImplementation$2;function requireImplementation$2(){if(hasRequiredImplementation$2)return implementation$2;hasRequiredImplementation$2=1;var e=requireObjectKeys(),t=requireShams$1()(),r=requireCallBound$1(),n=requireEsObjectAtoms(),s=r("Array.prototype.push"),a=r("Object.prototype.propertyIsEnumerable"),l=t?n.getOwnPropertySymbols:null;return implementation$2=function(x,f){if(x==null)throw new TypeError("target must be an object");var p=n(x);if(arguments.length===1)return p;for(var g=1;g<arguments.length;++g){var y=n(arguments[g]),w=e(y),R=t&&(n.getOwnPropertySymbols||l);if(R)for(var I=R(y),k=0;k<I.length;++k){var je=I[k];a(y,je)&&s(w,je)}for(var Ve=0;Ve<w.length;++Ve){var q=w[Ve];if(a(y,q)){var $e=y[q];p[q]=$e}}}return p},implementation$2}var polyfill$2,hasRequiredPolyfill$2;function requirePolyfill$2(){if(hasRequiredPolyfill$2)return polyfill$2;hasRequiredPolyfill$2=1;var e=requireImplementation$2(),t=function(){if(!Object.assign)return!1;for(var n="abcdefghijklmnopqrst",s=n.split(""),a={},l=0;l<s.length;++l)a[s[l]]=s[l];var u=Object.assign({},a),x="";for(var f in u)x+=f;return n!==x},r=function(){if(!Object.assign||!Object.preventExtensions)return!1;var n=Object.preventExtensions({1:2});try{Object.assign(n,"xy")}catch{return n[1]==="y"}return!1};return polyfill$2=function(){return!Object.assign||t()||r()?e:Object.assign},polyfill$2}var implementation$1,hasRequiredImplementation$1;function requireImplementation$1(){if(hasRequiredImplementation$1)return implementation$1;hasRequiredImplementation$1=1;var e=function(t){return t!==t};return implementation$1=function(r,n){return r===0&&n===0?1/r===1/n:!!(r===n||e(r)&&e(n))},implementation$1}var polyfill$1,hasRequiredPolyfill$1;function requirePolyfill$1(){if(hasRequiredPolyfill$1)return polyfill$1;hasRequiredPolyfill$1=1;var e=requireImplementation$1();return polyfill$1=function(){return typeof Object.is=="function"?Object.is:e},polyfill$1}var callBound,hasRequiredCallBound;function requireCallBound(){if(hasRequiredCallBound)return callBound;hasRequiredCallBound=1;var e=requireGetIntrinsic(),t=requireCallBind(),r=t(e("String.prototype.indexOf"));return callBound=function(s,a){var l=e(s,!!a);return typeof l=="function"&&r(s,".prototype.")>-1?t(l):l},callBound}var defineProperties_1,hasRequiredDefineProperties;function requireDefineProperties(){if(hasRequiredDefineProperties)return defineProperties_1;hasRequiredDefineProperties=1;var e=requireObjectKeys(),t=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",r=Object.prototype.toString,n=Array.prototype.concat,s=requireDefineDataProperty(),a=function(f){return typeof f=="function"&&r.call(f)==="[object Function]"},l=requireHasPropertyDescriptors()(),u=function(f,p,g,y){if(p in f){if(y===!0){if(f[p]===g)return}else if(!a(y)||!y())return}l?s(f,p,g,!0):s(f,p,g)},x=function(f,p){var g=arguments.length>2?arguments[2]:{},y=e(p);t&&(y=n.call(y,Object.getOwnPropertySymbols(p)));for(var w=0;w<y.length;w+=1)u(f,y[w],p[y[w]],g[y[w]])};return x.supportsDescriptors=!!l,defineProperties_1=x,defineProperties_1}var shim$1,hasRequiredShim$1;function requireShim$1(){if(hasRequiredShim$1)return shim$1;hasRequiredShim$1=1;var e=requirePolyfill$1(),t=requireDefineProperties();return shim$1=function(){var n=e();return t(Object,{is:n},{is:function(){return Object.is!==n}}),n},shim$1}var objectIs,hasRequiredObjectIs;function requireObjectIs(){if(hasRequiredObjectIs)return objectIs;hasRequiredObjectIs=1;var e=requireDefineProperties(),t=requireCallBind(),r=requireImplementation$1(),n=requirePolyfill$1(),s=requireShim$1(),a=t(n(),Object);return e(a,{getPolyfill:n,implementation:r,shim:s}),objectIs=a,objectIs}var implementation,hasRequiredImplementation;function requireImplementation(){return hasRequiredImplementation||(hasRequiredImplementation=1,implementation=function(t){return t!==t}),implementation}var polyfill,hasRequiredPolyfill;function requirePolyfill(){if(hasRequiredPolyfill)return polyfill;hasRequiredPolyfill=1;var e=requireImplementation();return polyfill=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:e},polyfill}var shim,hasRequiredShim;function requireShim(){if(hasRequiredShim)return shim;hasRequiredShim=1;var e=requireDefineProperties(),t=requirePolyfill();return shim=function(){var n=t();return e(Number,{isNaN:n},{isNaN:function(){return Number.isNaN!==n}}),n},shim}var isNan,hasRequiredIsNan;function requireIsNan(){if(hasRequiredIsNan)return isNan;hasRequiredIsNan=1;var e=requireCallBind(),t=requireDefineProperties(),r=requireImplementation(),n=requirePolyfill(),s=requireShim(),a=e(n(),Number);return t(a,{getPolyfill:n,implementation:r,shim:s}),isNan=a,isNan}var comparisons,hasRequiredComparisons;function requireComparisons(){if(hasRequiredComparisons)return comparisons;hasRequiredComparisons=1;function e(rr,cr){return a(rr)||s(rr,cr)||r(rr,cr)||t()}function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(rr,cr){if(rr){if(typeof rr=="string")return n(rr,cr);var Br=Object.prototype.toString.call(rr).slice(8,-1);if(Br==="Object"&&rr.constructor&&(Br=rr.constructor.name),Br==="Map"||Br==="Set")return Array.from(rr);if(Br==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Br))return n(rr,cr)}}function n(rr,cr){(cr==null||cr>rr.length)&&(cr=rr.length);for(var Br=0,br=new Array(cr);Br<cr;Br++)br[Br]=rr[Br];return br}function s(rr,cr){var Br=rr==null?null:typeof Symbol<"u"&&rr[Symbol.iterator]||rr["@@iterator"];if(Br!=null){var br,lr,Sr,yt,Je=[],ft=!0,or=!1;try{if(Sr=(Br=Br.call(rr)).next,cr!==0)for(;!(ft=(br=Sr.call(Br)).done)&&(Je.push(br.value),Je.length!==cr);ft=!0);}catch(Ar){or=!0,lr=Ar}finally{try{if(!ft&&Br.return!=null&&(yt=Br.return(),Object(yt)!==yt))return}finally{if(or)throw lr}}return Je}}function a(rr){if(Array.isArray(rr))return rr}function l(rr){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(cr){return typeof cr}:function(cr){return cr&&typeof Symbol=="function"&&cr.constructor===Symbol&&cr!==Symbol.prototype?"symbol":typeof cr},l(rr)}var u=/a/g.flags!==void 0,x=function(cr){var Br=[];return cr.forEach(function(br){return Br.push(br)}),Br},f=function(cr){var Br=[];return cr.forEach(function(br,lr){return Br.push([lr,br])}),Br},p=Object.is?Object.is:requireObjectIs(),g=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},y=Number.isNaN?Number.isNaN:requireIsNan();function w(rr){return rr.call.bind(rr)}var R=w(Object.prototype.hasOwnProperty),I=w(Object.prototype.propertyIsEnumerable),k=w(Object.prototype.toString),je=requireUtil().types,Ve=je.isAnyArrayBuffer,q=je.isArrayBufferView,$e=je.isDate,We=je.isMap,K=je.isRegExp,W=je.isSet,Ye=je.isNativeError,Qe=je.isBoxedPrimitive,it=je.isNumberObject,ze=je.isStringObject,v=je.isBooleanObject,D=je.isBigIntObject,_e=je.isSymbolObject,P=je.isFloat32Array,Re=je.isFloat64Array;function Fe(rr){if(rr.length===0||rr.length>10)return!0;for(var cr=0;cr<rr.length;cr++){var Br=rr.charCodeAt(cr);if(Br<48||Br>57)return!0}return rr.length===10&&rr>=Math.pow(2,32)}function Le(rr){return Object.keys(rr).filter(Fe).concat(g(rr).filter(Object.prototype.propertyIsEnumerable.bind(rr)))}function Ce(rr,cr){if(rr===cr)return 0;for(var Br=rr.length,br=cr.length,lr=0,Sr=Math.min(Br,br);lr<Sr;++lr)if(rr[lr]!==cr[lr]){Br=rr[lr],br=cr[lr];break}return Br<br?-1:br<Br?1:0}var L=!0,O=!1,st=0,lt=1,Xe=2,dt=3;function er(rr,cr){return u?rr.source===cr.source&&rr.flags===cr.flags:RegExp.prototype.toString.call(rr)===RegExp.prototype.toString.call(cr)}function ar(rr,cr){if(rr.byteLength!==cr.byteLength)return!1;for(var Br=0;Br<rr.byteLength;Br++)if(rr[Br]!==cr[Br])return!1;return!0}function dr(rr,cr){return rr.byteLength!==cr.byteLength?!1:Ce(new Uint8Array(rr.buffer,rr.byteOffset,rr.byteLength),new Uint8Array(cr.buffer,cr.byteOffset,cr.byteLength))===0}function ir(rr,cr){return rr.byteLength===cr.byteLength&&Ce(new Uint8Array(rr),new Uint8Array(cr))===0}function pt(rr,cr){return it(rr)?it(cr)&&p(Number.prototype.valueOf.call(rr),Number.prototype.valueOf.call(cr)):ze(rr)?ze(cr)&&String.prototype.valueOf.call(rr)===String.prototype.valueOf.call(cr):v(rr)?v(cr)&&Boolean.prototype.valueOf.call(rr)===Boolean.prototype.valueOf.call(cr):D(rr)?D(cr)&&BigInt.prototype.valueOf.call(rr)===BigInt.prototype.valueOf.call(cr):_e(cr)&&Symbol.prototype.valueOf.call(rr)===Symbol.prototype.valueOf.call(cr)}function tr(rr,cr,Br,br){if(rr===cr)return rr!==0?!0:Br?p(rr,cr):!0;if(Br){if(l(rr)!=="object")return typeof rr=="number"&&y(rr)&&y(cr);if(l(cr)!=="object"||rr===null||cr===null||Object.getPrototypeOf(rr)!==Object.getPrototypeOf(cr))return!1}else{if(rr===null||l(rr)!=="object")return cr===null||l(cr)!=="object"?rr==cr:!1;if(cr===null||l(cr)!=="object")return!1}var lr=k(rr),Sr=k(cr);if(lr!==Sr)return!1;if(Array.isArray(rr)){if(rr.length!==cr.length)return!1;var yt=Le(rr),Je=Le(cr);return yt.length!==Je.length?!1:nr(rr,cr,Br,br,lt,yt)}if(lr==="[object Object]"&&(!We(rr)&&We(cr)||!W(rr)&&W(cr)))return!1;if($e(rr)){if(!$e(cr)||Date.prototype.getTime.call(rr)!==Date.prototype.getTime.call(cr))return!1}else if(K(rr)){if(!K(cr)||!er(rr,cr))return!1}else if(Ye(rr)||rr instanceof Error){if(rr.message!==cr.message||rr.name!==cr.name)return!1}else if(q(rr)){if(!Br&&(P(rr)||Re(rr))){if(!ar(rr,cr))return!1}else if(!dr(rr,cr))return!1;var ft=Le(rr),or=Le(cr);return ft.length!==or.length?!1:nr(rr,cr,Br,br,st,ft)}else{if(W(rr))return!W(cr)||rr.size!==cr.size?!1:nr(rr,cr,Br,br,Xe);if(We(rr))return!We(cr)||rr.size!==cr.size?!1:nr(rr,cr,Br,br,dt);if(Ve(rr)){if(!ir(rr,cr))return!1}else if(Qe(rr)&&!pt(rr,cr))return!1}return nr(rr,cr,Br,br,st)}function sr(rr,cr){return cr.filter(function(Br){return I(rr,Br)})}function nr(rr,cr,Br,br,lr,Sr){if(arguments.length===5){Sr=Object.keys(rr);var yt=Object.keys(cr);if(Sr.length!==yt.length)return!1}for(var Je=0;Je<Sr.length;Je++)if(!R(cr,Sr[Je]))return!1;if(Br&&arguments.length===5){var ft=g(rr);if(ft.length!==0){var or=0;for(Je=0;Je<ft.length;Je++){var Ar=ft[Je];if(I(rr,Ar)){if(!I(cr,Ar))return!1;Sr.push(Ar),or++}else if(I(cr,Ar))return!1}var _r=g(cr);if(ft.length!==_r.length&&sr(cr,_r).length!==or)return!1}else{var Nr=g(cr);if(Nr.length!==0&&sr(cr,Nr).length!==0)return!1}}if(Sr.length===0&&(lr===st||lr===lt&&rr.length===0||rr.size===0))return!0;if(br===void 0)br={val1:new Map,val2:new Map,position:0};else{var Hr=br.val1.get(rr);if(Hr!==void 0){var Gr=br.val2.get(cr);if(Gr!==void 0)return Hr===Gr}br.position++}br.val1.set(rr,br.position),br.val2.set(cr,br.position);var Vr=wr(rr,cr,Br,Sr,br,lr);return br.val1.delete(rr),br.val2.delete(cr),Vr}function pr(rr,cr,Br,br){for(var lr=x(rr),Sr=0;Sr<lr.length;Sr++){var yt=lr[Sr];if(tr(cr,yt,Br,br))return rr.delete(yt),!0}return!1}function gr(rr){switch(l(rr)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":rr=+rr;case"number":if(y(rr))return!1}return!0}function mr(rr,cr,Br){var br=gr(Br);return br??(cr.has(br)&&!rr.has(br))}function yr(rr,cr,Br,br,lr){var Sr=gr(Br);if(Sr!=null)return Sr;var yt=cr.get(Sr);return yt===void 0&&!cr.has(Sr)||!tr(br,yt,!1,lr)?!1:!rr.has(Sr)&&tr(br,yt,!1,lr)}function Er(rr,cr,Br,br){for(var lr=null,Sr=x(rr),yt=0;yt<Sr.length;yt++){var Je=Sr[yt];if(l(Je)==="object"&&Je!==null)lr===null&&(lr=new Set),lr.add(Je);else if(!cr.has(Je)){if(Br||!mr(rr,cr,Je))return!1;lr===null&&(lr=new Set),lr.add(Je)}}if(lr!==null){for(var ft=x(cr),or=0;or<ft.length;or++){var Ar=ft[or];if(l(Ar)==="object"&&Ar!==null){if(!pr(lr,Ar,Br,br))return!1}else if(!Br&&!rr.has(Ar)&&!pr(lr,Ar,Br,br))return!1}return lr.size===0}return!0}function xr(rr,cr,Br,br,lr,Sr){for(var yt=x(rr),Je=0;Je<yt.length;Je++){var ft=yt[Je];if(tr(Br,ft,lr,Sr)&&tr(br,cr.get(ft),lr,Sr))return rr.delete(ft),!0}return!1}function Cr(rr,cr,Br,br){for(var lr=null,Sr=f(rr),yt=0;yt<Sr.length;yt++){var Je=e(Sr[yt],2),ft=Je[0],or=Je[1];if(l(ft)==="object"&&ft!==null)lr===null&&(lr=new Set),lr.add(ft);else{var Ar=cr.get(ft);if(Ar===void 0&&!cr.has(ft)||!tr(or,Ar,Br,br)){if(Br||!yr(rr,cr,ft,or,br))return!1;lr===null&&(lr=new Set),lr.add(ft)}}}if(lr!==null){for(var _r=f(cr),Nr=0;Nr<_r.length;Nr++){var Hr=e(_r[Nr],2),Gr=Hr[0],Vr=Hr[1];if(l(Gr)==="object"&&Gr!==null){if(!xr(lr,rr,Gr,Vr,Br,br))return!1}else if(!Br&&(!rr.has(Gr)||!tr(rr.get(Gr),Vr,!1,br))&&!xr(lr,rr,Gr,Vr,!1,br))return!1}return lr.size===0}return!0}function wr(rr,cr,Br,br,lr,Sr){var yt=0;if(Sr===Xe){if(!Er(rr,cr,Br,lr))return!1}else if(Sr===dt){if(!Cr(rr,cr,Br,lr))return!1}else if(Sr===lt)for(;yt<rr.length;yt++)if(R(rr,yt)){if(!R(cr,yt)||!tr(rr[yt],cr[yt],Br,lr))return!1}else{if(R(cr,yt))return!1;for(var Je=Object.keys(rr);yt<Je.length;yt++){var ft=Je[yt];if(!R(cr,ft)||!tr(rr[ft],cr[ft],Br,lr))return!1}return Je.length===Object.keys(cr).length}for(yt=0;yt<br.length;yt++){var or=br[yt];if(!tr(rr[or],cr[or],Br,lr))return!1}return!0}function kr(rr,cr){return tr(rr,cr,O)}function Dr(rr,cr){return tr(rr,cr,L)}return comparisons={isDeepEqual:kr,isDeepStrictEqual:Dr},comparisons}var hasRequiredAssert;function requireAssert(){if(hasRequiredAssert)return assert$2.exports;hasRequiredAssert=1;function e(Xe){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(dt){return typeof dt}:function(dt){return dt&&typeof Symbol=="function"&&dt.constructor===Symbol&&dt!==Symbol.prototype?"symbol":typeof dt},e(Xe)}function t(Xe,dt,er){return Object.defineProperty(Xe,"prototype",{writable:!1}),Xe}function r(Xe,dt){if(!(Xe instanceof dt))throw new TypeError("Cannot call a class as a function")}var n=requireErrors(),s=n.codes,a=s.ERR_AMBIGUOUS_ARGUMENT,l=s.ERR_INVALID_ARG_TYPE,u=s.ERR_INVALID_ARG_VALUE,x=s.ERR_INVALID_RETURN_VALUE,f=s.ERR_MISSING_ARGS,p=requireAssertion_error(),g=requireUtil(),y=g.inspect,w=requireUtil().types,R=w.isPromise,I=w.isRegExp,k=requirePolyfill$2()(),je=requirePolyfill$1()(),Ve=requireCallBound()("RegExp.prototype.test"),q,$e;function We(){var Xe=requireComparisons();q=Xe.isDeepEqual,$e=Xe.isDeepStrictEqual}var K=!1,W=assert$2.exports=v,Ye={};function Qe(Xe){throw Xe.message instanceof Error?Xe.message:new p(Xe)}function it(Xe,dt,er,ar,dr){var ir=arguments.length,pt;if(ir===0)pt="Failed";else if(ir===1)er=Xe,Xe=void 0;else{if(K===!1){K=!0;var tr=process$1.emitWarning?process$1.emitWarning:console.warn.bind(console);tr("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}ir===2&&(ar="!=")}if(er instanceof Error)throw er;var sr={actual:Xe,expected:dt,operator:ar===void 0?"fail":ar,stackStartFn:dr||it};er!==void 0&&(sr.message=er);var nr=new p(sr);throw pt&&(nr.message=pt,nr.generatedMessage=!0),nr}W.fail=it,W.AssertionError=p;function ze(Xe,dt,er,ar){if(!er){var dr=!1;if(dt===0)dr=!0,ar="No value argument passed to `assert.ok()`";else if(ar instanceof Error)throw ar;var ir=new p({actual:er,expected:!0,message:ar,operator:"==",stackStartFn:Xe});throw ir.generatedMessage=dr,ir}}function v(){for(var Xe=arguments.length,dt=new Array(Xe),er=0;er<Xe;er++)dt[er]=arguments[er];ze.apply(void 0,[v,dt.length].concat(dt))}W.ok=v,W.equal=function Xe(dt,er,ar){if(arguments.length<2)throw new f("actual","expected");dt!=er&&Qe({actual:dt,expected:er,message:ar,operator:"==",stackStartFn:Xe})},W.notEqual=function Xe(dt,er,ar){if(arguments.length<2)throw new f("actual","expected");dt==er&&Qe({actual:dt,expected:er,message:ar,operator:"!=",stackStartFn:Xe})},W.deepEqual=function Xe(dt,er,ar){if(arguments.length<2)throw new f("actual","expected");q===void 0&&We(),q(dt,er)||Qe({actual:dt,expected:er,message:ar,operator:"deepEqual",stackStartFn:Xe})},W.notDeepEqual=function Xe(dt,er,ar){if(arguments.length<2)throw new f("actual","expected");q===void 0&&We(),q(dt,er)&&Qe({actual:dt,expected:er,message:ar,operator:"notDeepEqual",stackStartFn:Xe})},W.deepStrictEqual=function Xe(dt,er,ar){if(arguments.length<2)throw new f("actual","expected");q===void 0&&We(),$e(dt,er)||Qe({actual:dt,expected:er,message:ar,operator:"deepStrictEqual",stackStartFn:Xe})},W.notDeepStrictEqual=D;function D(Xe,dt,er){if(arguments.length<2)throw new f("actual","expected");q===void 0&&We(),$e(Xe,dt)&&Qe({actual:Xe,expected:dt,message:er,operator:"notDeepStrictEqual",stackStartFn:D})}W.strictEqual=function Xe(dt,er,ar){if(arguments.length<2)throw new f("actual","expected");je(dt,er)||Qe({actual:dt,expected:er,message:ar,operator:"strictEqual",stackStartFn:Xe})},W.notStrictEqual=function Xe(dt,er,ar){if(arguments.length<2)throw new f("actual","expected");je(dt,er)&&Qe({actual:dt,expected:er,message:ar,operator:"notStrictEqual",stackStartFn:Xe})};var _e=t(function Xe(dt,er,ar){var dr=this;r(this,Xe),er.forEach(function(ir){ir in dt&&(ar!==void 0&&typeof ar[ir]=="string"&&I(dt[ir])&&Ve(dt[ir],ar[ir])?dr[ir]=ar[ir]:dr[ir]=dt[ir])})});function P(Xe,dt,er,ar,dr,ir){if(!(er in Xe)||!$e(Xe[er],dt[er])){if(!ar){var pt=new _e(Xe,dr),tr=new _e(dt,dr,Xe),sr=new p({actual:pt,expected:tr,operator:"deepStrictEqual",stackStartFn:ir});throw sr.actual=Xe,sr.expected=dt,sr.operator=ir.name,sr}Qe({actual:Xe,expected:dt,message:ar,operator:ir.name,stackStartFn:ir})}}function Re(Xe,dt,er,ar){if(typeof dt!="function"){if(I(dt))return Ve(dt,Xe);if(arguments.length===2)throw new l("expected",["Function","RegExp"],dt);if(e(Xe)!=="object"||Xe===null){var dr=new p({actual:Xe,expected:dt,message:er,operator:"deepStrictEqual",stackStartFn:ar});throw dr.operator=ar.name,dr}var ir=Object.keys(dt);if(dt instanceof Error)ir.push("name","message");else if(ir.length===0)throw new u("error",dt,"may not be an empty object");return q===void 0&&We(),ir.forEach(function(pt){typeof Xe[pt]=="string"&&I(dt[pt])&&Ve(dt[pt],Xe[pt])||P(Xe,dt,pt,er,ir,ar)}),!0}return dt.prototype!==void 0&&Xe instanceof dt?!0:Error.isPrototypeOf(dt)?!1:dt.call({},Xe)===!0}function Fe(Xe){if(typeof Xe!="function")throw new l("fn","Function",Xe);try{Xe()}catch(dt){return dt}return Ye}function Le(Xe){return R(Xe)||Xe!==null&&e(Xe)==="object"&&typeof Xe.then=="function"&&typeof Xe.catch=="function"}function Ce(Xe){return Promise.resolve().then(function(){var dt;if(typeof Xe=="function"){if(dt=Xe(),!Le(dt))throw new x("instance of Promise","promiseFn",dt)}else if(Le(Xe))dt=Xe;else throw new l("promiseFn",["Function","Promise"],Xe);return Promise.resolve().then(function(){return dt}).then(function(){return Ye}).catch(function(er){return er})})}function L(Xe,dt,er,ar){if(typeof er=="string"){if(arguments.length===4)throw new l("error",["Object","Error","Function","RegExp"],er);if(e(dt)==="object"&&dt!==null){if(dt.message===er)throw new a("error/message",'The error message "'.concat(dt.message,'" is identical to the message.'))}else if(dt===er)throw new a("error/message",'The error "'.concat(dt,'" is identical to the message.'));ar=er,er=void 0}else if(er!=null&&e(er)!=="object"&&typeof er!="function")throw new l("error",["Object","Error","Function","RegExp"],er);if(dt===Ye){var dr="";er&&er.name&&(dr+=" (".concat(er.name,")")),dr+=ar?": ".concat(ar):".";var ir=Xe.name==="rejects"?"rejection":"exception";Qe({actual:void 0,expected:er,operator:Xe.name,message:"Missing expected ".concat(ir).concat(dr),stackStartFn:Xe})}if(er&&!Re(dt,er,ar,Xe))throw dt}function O(Xe,dt,er,ar){if(dt!==Ye){if(typeof er=="string"&&(ar=er,er=void 0),!er||Re(dt,er)){var dr=ar?": ".concat(ar):".",ir=Xe.name==="doesNotReject"?"rejection":"exception";Qe({actual:dt,expected:er,operator:Xe.name,message:"Got unwanted ".concat(ir).concat(dr,`
`)+'Actual message: "'.concat(dt&&dt.message,'"'),stackStartFn:Xe})}throw dt}}W.throws=function Xe(dt){for(var er=arguments.length,ar=new Array(er>1?er-1:0),dr=1;dr<er;dr++)ar[dr-1]=arguments[dr];L.apply(void 0,[Xe,Fe(dt)].concat(ar))},W.rejects=function Xe(dt){for(var er=arguments.length,ar=new Array(er>1?er-1:0),dr=1;dr<er;dr++)ar[dr-1]=arguments[dr];return Ce(dt).then(function(ir){return L.apply(void 0,[Xe,ir].concat(ar))})},W.doesNotThrow=function Xe(dt){for(var er=arguments.length,ar=new Array(er>1?er-1:0),dr=1;dr<er;dr++)ar[dr-1]=arguments[dr];O.apply(void 0,[Xe,Fe(dt)].concat(ar))},W.doesNotReject=function Xe(dt){for(var er=arguments.length,ar=new Array(er>1?er-1:0),dr=1;dr<er;dr++)ar[dr-1]=arguments[dr];return Ce(dt).then(function(ir){return O.apply(void 0,[Xe,ir].concat(ar))})},W.ifError=function Xe(dt){if(dt!=null){var er="ifError got unwanted exception: ";e(dt)==="object"&&typeof dt.message=="string"?dt.message.length===0&&dt.constructor?er+=dt.constructor.name:er+=dt.message:er+=y(dt);var ar=new p({actual:dt,expected:null,operator:"ifError",message:er,stackStartFn:Xe}),dr=dt.stack;if(typeof dr=="string"){var ir=dr.split(`
`);ir.shift();for(var pt=ar.stack.split(`
`),tr=0;tr<ir.length;tr++){var sr=pt.indexOf(ir[tr]);if(sr!==-1){pt=pt.slice(0,sr);break}}ar.stack="".concat(pt.join(`
`),`
`).concat(ir.join(`
`))}throw ar}};function st(Xe,dt,er,ar,dr){if(!I(dt))throw new l("regexp","RegExp",dt);var ir=dr==="match";if(typeof Xe!="string"||Ve(dt,Xe)!==ir){if(er instanceof Error)throw er;var pt=!er;er=er||(typeof Xe!="string"?'The "string" argument must be of type string. Received type '+"".concat(e(Xe)," (").concat(y(Xe),")"):(ir?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(y(dt),`. Input:

`).concat(y(Xe),`
`));var tr=new p({actual:Xe,expected:dt,message:er,operator:dr,stackStartFn:ar});throw tr.generatedMessage=pt,tr}}W.match=function Xe(dt,er,ar){st(dt,er,ar,Xe,"match")},W.doesNotMatch=function Xe(dt,er,ar){st(dt,er,ar,Xe,"doesNotMatch")};function lt(){for(var Xe=arguments.length,dt=new Array(Xe),er=0;er<Xe;er++)dt[er]=arguments[er];ze.apply(void 0,[lt,dt.length].concat(dt))}return W.strict=k(lt,W,{equal:W.strictEqual,deepEqual:W.deepStrictEqual,notEqual:W.notStrictEqual,notDeepEqual:W.notDeepStrictEqual}),W.strict.strict=W.strict,assert$2.exports}var fountainUtils={},xoshiro={},bignumber$1={exports:{}},bignumber=bignumber$1.exports,hasRequiredBignumber;function requireBignumber(){return hasRequiredBignumber||(hasRequiredBignumber=1,(function(e){(function(t){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,a=Math.floor,l="[BigNumber Error] ",u=l+"Number primitive has more than 15 significant digits: ",x=1e14,f=14,p=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,w=1e9;function R(K){var W,Ye,Qe,it=Xe.prototype={constructor:Xe,toString:null,valueOf:null},ze=new Xe(1),v=20,D=4,_e=-7,P=21,Re=-1e7,Fe=1e7,Le=!1,Ce=1,L=0,O={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},st="0123456789abcdefghijklmnopqrstuvwxyz",lt=!0;function Xe(pt,tr){var sr,nr,pr,gr,mr,yr,Er,xr,Cr=this;if(!(Cr instanceof Xe))return new Xe(pt,tr);if(tr==null){if(pt&&pt._isBigNumber===!0){Cr.s=pt.s,!pt.c||pt.e>Fe?Cr.c=Cr.e=null:pt.e<Re?Cr.c=[Cr.e=0]:(Cr.e=pt.e,Cr.c=pt.c.slice());return}if((yr=typeof pt=="number")&&pt*0==0){if(Cr.s=1/pt<0?(pt=-pt,-1):1,pt===~~pt){for(gr=0,mr=pt;mr>=10;mr/=10,gr++);gr>Fe?Cr.c=Cr.e=null:(Cr.e=gr,Cr.c=[pt]);return}xr=String(pt)}else{if(!n.test(xr=String(pt)))return Qe(Cr,xr,yr);Cr.s=xr.charCodeAt(0)==45?(xr=xr.slice(1),-1):1}(gr=xr.indexOf("."))>-1&&(xr=xr.replace(".","")),(mr=xr.search(/e/i))>0?(gr<0&&(gr=mr),gr+=+xr.slice(mr+1),xr=xr.substring(0,mr)):gr<0&&(gr=xr.length)}else{if(Ve(tr,2,st.length,"Base"),tr==10&&lt)return Cr=new Xe(pt),dr(Cr,v+Cr.e+1,D);if(xr=String(pt),yr=typeof pt=="number"){if(pt*0!=0)return Qe(Cr,xr,yr,tr);if(Cr.s=1/pt<0?(xr=xr.slice(1),-1):1,Xe.DEBUG&&xr.replace(/^0\.0*|\./,"").length>15)throw Error(u+pt)}else Cr.s=xr.charCodeAt(0)===45?(xr=xr.slice(1),-1):1;for(sr=st.slice(0,tr),gr=mr=0,Er=xr.length;mr<Er;mr++)if(sr.indexOf(nr=xr.charAt(mr))<0){if(nr=="."){if(mr>gr){gr=Er;continue}}else if(!pr&&(xr==xr.toUpperCase()&&(xr=xr.toLowerCase())||xr==xr.toLowerCase()&&(xr=xr.toUpperCase()))){pr=!0,mr=-1,gr=0;continue}return Qe(Cr,String(pt),yr,tr)}yr=!1,xr=Ye(xr,tr,10,Cr.s),(gr=xr.indexOf("."))>-1?xr=xr.replace(".",""):gr=xr.length}for(mr=0;xr.charCodeAt(mr)===48;mr++);for(Er=xr.length;xr.charCodeAt(--Er)===48;);if(xr=xr.slice(mr,++Er)){if(Er-=mr,yr&&Xe.DEBUG&&Er>15&&(pt>p||pt!==a(pt)))throw Error(u+Cr.s*pt);if((gr=gr-mr-1)>Fe)Cr.c=Cr.e=null;else if(gr<Re)Cr.c=[Cr.e=0];else{if(Cr.e=gr,Cr.c=[],mr=(gr+1)%f,gr<0&&(mr+=f),mr<Er){for(mr&&Cr.c.push(+xr.slice(0,mr)),Er-=f;mr<Er;)Cr.c.push(+xr.slice(mr,mr+=f));mr=f-(xr=xr.slice(mr)).length}else mr-=Er;for(;mr--;xr+="0");Cr.c.push(+xr)}}else Cr.c=[Cr.e=0]}Xe.clone=R,Xe.ROUND_UP=0,Xe.ROUND_DOWN=1,Xe.ROUND_CEIL=2,Xe.ROUND_FLOOR=3,Xe.ROUND_HALF_UP=4,Xe.ROUND_HALF_DOWN=5,Xe.ROUND_HALF_EVEN=6,Xe.ROUND_HALF_CEIL=7,Xe.ROUND_HALF_FLOOR=8,Xe.EUCLID=9,Xe.config=Xe.set=function(pt){var tr,sr;if(pt!=null)if(typeof pt=="object"){if(pt.hasOwnProperty(tr="DECIMAL_PLACES")&&(sr=pt[tr],Ve(sr,0,w,tr),v=sr),pt.hasOwnProperty(tr="ROUNDING_MODE")&&(sr=pt[tr],Ve(sr,0,8,tr),D=sr),pt.hasOwnProperty(tr="EXPONENTIAL_AT")&&(sr=pt[tr],sr&&sr.pop?(Ve(sr[0],-w,0,tr),Ve(sr[1],0,w,tr),_e=sr[0],P=sr[1]):(Ve(sr,-w,w,tr),_e=-(P=sr<0?-sr:sr))),pt.hasOwnProperty(tr="RANGE"))if(sr=pt[tr],sr&&sr.pop)Ve(sr[0],-w,-1,tr),Ve(sr[1],1,w,tr),Re=sr[0],Fe=sr[1];else if(Ve(sr,-w,w,tr),sr)Re=-(Fe=sr<0?-sr:sr);else throw Error(l+tr+" cannot be zero: "+sr);if(pt.hasOwnProperty(tr="CRYPTO"))if(sr=pt[tr],sr===!!sr)if(sr)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Le=sr;else throw Le=!sr,Error(l+"crypto unavailable");else Le=sr;else throw Error(l+tr+" not true or false: "+sr);if(pt.hasOwnProperty(tr="MODULO_MODE")&&(sr=pt[tr],Ve(sr,0,9,tr),Ce=sr),pt.hasOwnProperty(tr="POW_PRECISION")&&(sr=pt[tr],Ve(sr,0,w,tr),L=sr),pt.hasOwnProperty(tr="FORMAT"))if(sr=pt[tr],typeof sr=="object")O=sr;else throw Error(l+tr+" not an object: "+sr);if(pt.hasOwnProperty(tr="ALPHABET"))if(sr=pt[tr],typeof sr=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(sr))lt=sr.slice(0,10)=="0123456789",st=sr;else throw Error(l+tr+" invalid: "+sr)}else throw Error(l+"Object expected: "+pt);return{DECIMAL_PLACES:v,ROUNDING_MODE:D,EXPONENTIAL_AT:[_e,P],RANGE:[Re,Fe],CRYPTO:Le,MODULO_MODE:Ce,POW_PRECISION:L,FORMAT:O,ALPHABET:st}},Xe.isBigNumber=function(pt){if(!pt||pt._isBigNumber!==!0)return!1;if(!Xe.DEBUG)return!0;var tr,sr,nr=pt.c,pr=pt.e,gr=pt.s;e:if({}.toString.call(nr)=="[object Array]"){if((gr===1||gr===-1)&&pr>=-w&&pr<=w&&pr===a(pr)){if(nr[0]===0){if(pr===0&&nr.length===1)return!0;break e}if(tr=(pr+1)%f,tr<1&&(tr+=f),String(nr[0]).length==tr){for(tr=0;tr<nr.length;tr++)if(sr=nr[tr],sr<0||sr>=x||sr!==a(sr))break e;if(sr!==0)return!0}}}else if(nr===null&&pr===null&&(gr===null||gr===1||gr===-1))return!0;throw Error(l+"Invalid BigNumber: "+pt)},Xe.maximum=Xe.max=function(){return er(arguments,-1)},Xe.minimum=Xe.min=function(){return er(arguments,1)},Xe.random=(function(){var pt=9007199254740992,tr=Math.random()*pt&2097151?function(){return a(Math.random()*pt)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(sr){var nr,pr,gr,mr,yr,Er=0,xr=[],Cr=new Xe(ze);if(sr==null?sr=v:Ve(sr,0,w),mr=s(sr/f),Le)if(crypto.getRandomValues){for(nr=crypto.getRandomValues(new Uint32Array(mr*=2));Er<mr;)yr=nr[Er]*131072+(nr[Er+1]>>>11),yr>=9e15?(pr=crypto.getRandomValues(new Uint32Array(2)),nr[Er]=pr[0],nr[Er+1]=pr[1]):(xr.push(yr%1e14),Er+=2);Er=mr/2}else if(crypto.randomBytes){for(nr=crypto.randomBytes(mr*=7);Er<mr;)yr=(nr[Er]&31)*281474976710656+nr[Er+1]*1099511627776+nr[Er+2]*4294967296+nr[Er+3]*16777216+(nr[Er+4]<<16)+(nr[Er+5]<<8)+nr[Er+6],yr>=9e15?crypto.randomBytes(7).copy(nr,Er):(xr.push(yr%1e14),Er+=7);Er=mr/7}else throw Le=!1,Error(l+"crypto unavailable");if(!Le)for(;Er<mr;)yr=tr(),yr<9e15&&(xr[Er++]=yr%1e14);for(mr=xr[--Er],sr%=f,mr&&sr&&(yr=g[f-sr],xr[Er]=a(mr/yr)*yr);xr[Er]===0;xr.pop(),Er--);if(Er<0)xr=[gr=0];else{for(gr=-1;xr[0]===0;xr.splice(0,1),gr-=f);for(Er=1,yr=xr[0];yr>=10;yr/=10,Er++);Er<f&&(gr-=f-Er)}return Cr.e=gr,Cr.c=xr,Cr}})(),Xe.sum=function(){for(var pt=1,tr=arguments,sr=new Xe(tr[0]);pt<tr.length;)sr=sr.plus(tr[pt++]);return sr},Ye=(function(){var pt="0123456789";function tr(sr,nr,pr,gr){for(var mr,yr=[0],Er,xr=0,Cr=sr.length;xr<Cr;){for(Er=yr.length;Er--;yr[Er]*=nr);for(yr[0]+=gr.indexOf(sr.charAt(xr++)),mr=0;mr<yr.length;mr++)yr[mr]>pr-1&&(yr[mr+1]==null&&(yr[mr+1]=0),yr[mr+1]+=yr[mr]/pr|0,yr[mr]%=pr)}return yr.reverse()}return function(sr,nr,pr,gr,mr){var yr,Er,xr,Cr,wr,kr,Dr,rr,cr=sr.indexOf("."),Br=v,br=D;for(cr>=0&&(Cr=L,L=0,sr=sr.replace(".",""),rr=new Xe(nr),kr=rr.pow(sr.length-cr),L=Cr,rr.c=tr(We(k(kr.c),kr.e,"0"),10,pr,pt),rr.e=rr.c.length),Dr=tr(sr,nr,pr,mr?(yr=st,pt):(yr=pt,st)),xr=Cr=Dr.length;Dr[--Cr]==0;Dr.pop());if(!Dr[0])return yr.charAt(0);if(cr<0?--xr:(kr.c=Dr,kr.e=xr,kr.s=gr,kr=W(kr,rr,Br,br,pr),Dr=kr.c,wr=kr.r,xr=kr.e),Er=xr+Br+1,cr=Dr[Er],Cr=pr/2,wr=wr||Er<0||Dr[Er+1]!=null,wr=br<4?(cr!=null||wr)&&(br==0||br==(kr.s<0?3:2)):cr>Cr||cr==Cr&&(br==4||wr||br==6&&Dr[Er-1]&1||br==(kr.s<0?8:7)),Er<1||!Dr[0])sr=wr?We(yr.charAt(1),-Br,yr.charAt(0)):yr.charAt(0);else{if(Dr.length=Er,wr)for(--pr;++Dr[--Er]>pr;)Dr[Er]=0,Er||(++xr,Dr=[1].concat(Dr));for(Cr=Dr.length;!Dr[--Cr];);for(cr=0,sr="";cr<=Cr;sr+=yr.charAt(Dr[cr++]));sr=We(sr,xr,yr.charAt(0))}return sr}})(),W=(function(){function pt(nr,pr,gr){var mr,yr,Er,xr,Cr=0,wr=nr.length,kr=pr%y,Dr=pr/y|0;for(nr=nr.slice();wr--;)Er=nr[wr]%y,xr=nr[wr]/y|0,mr=Dr*Er+xr*kr,yr=kr*Er+mr%y*y+Cr,Cr=(yr/gr|0)+(mr/y|0)+Dr*xr,nr[wr]=yr%gr;return Cr&&(nr=[Cr].concat(nr)),nr}function tr(nr,pr,gr,mr){var yr,Er;if(gr!=mr)Er=gr>mr?1:-1;else for(yr=Er=0;yr<gr;yr++)if(nr[yr]!=pr[yr]){Er=nr[yr]>pr[yr]?1:-1;break}return Er}function sr(nr,pr,gr,mr){for(var yr=0;gr--;)nr[gr]-=yr,yr=nr[gr]<pr[gr]?1:0,nr[gr]=yr*mr+nr[gr]-pr[gr];for(;!nr[0]&&nr.length>1;nr.splice(0,1));}return function(nr,pr,gr,mr,yr){var Er,xr,Cr,wr,kr,Dr,rr,cr,Br,br,lr,Sr,yt,Je,ft,or,Ar,_r=nr.s==pr.s?1:-1,Nr=nr.c,Hr=pr.c;if(!Nr||!Nr[0]||!Hr||!Hr[0])return new Xe(!nr.s||!pr.s||(Nr?Hr&&Nr[0]==Hr[0]:!Hr)?NaN:Nr&&Nr[0]==0||!Hr?_r*0:_r/0);for(cr=new Xe(_r),Br=cr.c=[],xr=nr.e-pr.e,_r=gr+xr+1,yr||(yr=x,xr=I(nr.e/f)-I(pr.e/f),_r=_r/f|0),Cr=0;Hr[Cr]==(Nr[Cr]||0);Cr++);if(Hr[Cr]>(Nr[Cr]||0)&&xr--,_r<0)Br.push(1),wr=!0;else{for(Je=Nr.length,or=Hr.length,Cr=0,_r+=2,kr=a(yr/(Hr[0]+1)),kr>1&&(Hr=pt(Hr,kr,yr),Nr=pt(Nr,kr,yr),or=Hr.length,Je=Nr.length),yt=or,br=Nr.slice(0,or),lr=br.length;lr<or;br[lr++]=0);Ar=Hr.slice(),Ar=[0].concat(Ar),ft=Hr[0],Hr[1]>=yr/2&&ft++;do{if(kr=0,Er=tr(Hr,br,or,lr),Er<0){if(Sr=br[0],or!=lr&&(Sr=Sr*yr+(br[1]||0)),kr=a(Sr/ft),kr>1)for(kr>=yr&&(kr=yr-1),Dr=pt(Hr,kr,yr),rr=Dr.length,lr=br.length;tr(Dr,br,rr,lr)==1;)kr--,sr(Dr,or<rr?Ar:Hr,rr,yr),rr=Dr.length,Er=1;else kr==0&&(Er=kr=1),Dr=Hr.slice(),rr=Dr.length;if(rr<lr&&(Dr=[0].concat(Dr)),sr(br,Dr,lr,yr),lr=br.length,Er==-1)for(;tr(Hr,br,or,lr)<1;)kr++,sr(br,or<lr?Ar:Hr,lr,yr),lr=br.length}else Er===0&&(kr++,br=[0]);Br[Cr++]=kr,br[0]?br[lr++]=Nr[yt]||0:(br=[Nr[yt]],lr=1)}while((yt++<Je||br[0]!=null)&&_r--);wr=br[0]!=null,Br[0]||Br.splice(0,1)}if(yr==x){for(Cr=1,_r=Br[0];_r>=10;_r/=10,Cr++);dr(cr,gr+(cr.e=Cr+xr*f-1)+1,mr,wr)}else cr.e=xr,cr.r=+wr;return cr}})();function dt(pt,tr,sr,nr){var pr,gr,mr,yr,Er;if(sr==null?sr=D:Ve(sr,0,8),!pt.c)return pt.toString();if(pr=pt.c[0],mr=pt.e,tr==null)Er=k(pt.c),Er=nr==1||nr==2&&(mr<=_e||mr>=P)?$e(Er,mr):We(Er,mr,"0");else if(pt=dr(new Xe(pt),tr,sr),gr=pt.e,Er=k(pt.c),yr=Er.length,nr==1||nr==2&&(tr<=gr||gr<=_e)){for(;yr<tr;Er+="0",yr++);Er=$e(Er,gr)}else if(tr-=mr+(nr===2&&gr>mr),Er=We(Er,gr,"0"),gr+1>yr){if(--tr>0)for(Er+=".";tr--;Er+="0");}else if(tr+=gr-yr,tr>0)for(gr+1==yr&&(Er+=".");tr--;Er+="0");return pt.s<0&&pr?"-"+Er:Er}function er(pt,tr){for(var sr,nr,pr=1,gr=new Xe(pt[0]);pr<pt.length;pr++)nr=new Xe(pt[pr]),(!nr.s||(sr=je(gr,nr))===tr||sr===0&&gr.s===tr)&&(gr=nr);return gr}function ar(pt,tr,sr){for(var nr=1,pr=tr.length;!tr[--pr];tr.pop());for(pr=tr[0];pr>=10;pr/=10,nr++);return(sr=nr+sr*f-1)>Fe?pt.c=pt.e=null:sr<Re?pt.c=[pt.e=0]:(pt.e=sr,pt.c=tr),pt}Qe=(function(){var pt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,tr=/^([^.]+)\.$/,sr=/^\.([^.]+)$/,nr=/^-?(Infinity|NaN)$/,pr=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(gr,mr,yr,Er){var xr,Cr=yr?mr:mr.replace(pr,"");if(nr.test(Cr))gr.s=isNaN(Cr)?null:Cr<0?-1:1;else{if(!yr&&(Cr=Cr.replace(pt,function(wr,kr,Dr){return xr=(Dr=Dr.toLowerCase())=="x"?16:Dr=="b"?2:8,!Er||Er==xr?kr:wr}),Er&&(xr=Er,Cr=Cr.replace(tr,"$1").replace(sr,"0.$1")),mr!=Cr))return new Xe(Cr,xr);if(Xe.DEBUG)throw Error(l+"Not a"+(Er?" base "+Er:"")+" number: "+mr);gr.s=null}gr.c=gr.e=null}})();function dr(pt,tr,sr,nr){var pr,gr,mr,yr,Er,xr,Cr,wr=pt.c,kr=g;if(wr){e:{for(pr=1,yr=wr[0];yr>=10;yr/=10,pr++);if(gr=tr-pr,gr<0)gr+=f,mr=tr,Er=wr[xr=0],Cr=a(Er/kr[pr-mr-1]%10);else if(xr=s((gr+1)/f),xr>=wr.length)if(nr){for(;wr.length<=xr;wr.push(0));Er=Cr=0,pr=1,gr%=f,mr=gr-f+1}else break e;else{for(Er=yr=wr[xr],pr=1;yr>=10;yr/=10,pr++);gr%=f,mr=gr-f+pr,Cr=mr<0?0:a(Er/kr[pr-mr-1]%10)}if(nr=nr||tr<0||wr[xr+1]!=null||(mr<0?Er:Er%kr[pr-mr-1]),nr=sr<4?(Cr||nr)&&(sr==0||sr==(pt.s<0?3:2)):Cr>5||Cr==5&&(sr==4||nr||sr==6&&(gr>0?mr>0?Er/kr[pr-mr]:0:wr[xr-1])%10&1||sr==(pt.s<0?8:7)),tr<1||!wr[0])return wr.length=0,nr?(tr-=pt.e+1,wr[0]=kr[(f-tr%f)%f],pt.e=-tr||0):wr[0]=pt.e=0,pt;if(gr==0?(wr.length=xr,yr=1,xr--):(wr.length=xr+1,yr=kr[f-gr],wr[xr]=mr>0?a(Er/kr[pr-mr]%kr[mr])*yr:0),nr)for(;;)if(xr==0){for(gr=1,mr=wr[0];mr>=10;mr/=10,gr++);for(mr=wr[0]+=yr,yr=1;mr>=10;mr/=10,yr++);gr!=yr&&(pt.e++,wr[0]==x&&(wr[0]=1));break}else{if(wr[xr]+=yr,wr[xr]!=x)break;wr[xr--]=0,yr=1}for(gr=wr.length;wr[--gr]===0;wr.pop());}pt.e>Fe?pt.c=pt.e=null:pt.e<Re&&(pt.c=[pt.e=0])}return pt}function ir(pt){var tr,sr=pt.e;return sr===null?pt.toString():(tr=k(pt.c),tr=sr<=_e||sr>=P?$e(tr,sr):We(tr,sr,"0"),pt.s<0?"-"+tr:tr)}return it.absoluteValue=it.abs=function(){var pt=new Xe(this);return pt.s<0&&(pt.s=1),pt},it.comparedTo=function(pt,tr){return je(this,new Xe(pt,tr))},it.decimalPlaces=it.dp=function(pt,tr){var sr,nr,pr,gr=this;if(pt!=null)return Ve(pt,0,w),tr==null?tr=D:Ve(tr,0,8),dr(new Xe(gr),pt+gr.e+1,tr);if(!(sr=gr.c))return null;if(nr=((pr=sr.length-1)-I(this.e/f))*f,pr=sr[pr])for(;pr%10==0;pr/=10,nr--);return nr<0&&(nr=0),nr},it.dividedBy=it.div=function(pt,tr){return W(this,new Xe(pt,tr),v,D)},it.dividedToIntegerBy=it.idiv=function(pt,tr){return W(this,new Xe(pt,tr),0,1)},it.exponentiatedBy=it.pow=function(pt,tr){var sr,nr,pr,gr,mr,yr,Er,xr,Cr,wr=this;if(pt=new Xe(pt),pt.c&&!pt.isInteger())throw Error(l+"Exponent not an integer: "+ir(pt));if(tr!=null&&(tr=new Xe(tr)),yr=pt.e>14,!wr.c||!wr.c[0]||wr.c[0]==1&&!wr.e&&wr.c.length==1||!pt.c||!pt.c[0])return Cr=new Xe(Math.pow(+ir(wr),yr?pt.s*(2-q(pt)):+ir(pt))),tr?Cr.mod(tr):Cr;if(Er=pt.s<0,tr){if(tr.c?!tr.c[0]:!tr.s)return new Xe(NaN);nr=!Er&&wr.isInteger()&&tr.isInteger(),nr&&(wr=wr.mod(tr))}else{if(pt.e>9&&(wr.e>0||wr.e<-1||(wr.e==0?wr.c[0]>1||yr&&wr.c[1]>=24e7:wr.c[0]<8e13||yr&&wr.c[0]<=9999975e7)))return gr=wr.s<0&&q(pt)?-0:0,wr.e>-1&&(gr=1/gr),new Xe(Er?1/gr:gr);L&&(gr=s(L/f+2))}for(yr?(sr=new Xe(.5),Er&&(pt.s=1),xr=q(pt)):(pr=Math.abs(+ir(pt)),xr=pr%2),Cr=new Xe(ze);;){if(xr){if(Cr=Cr.times(wr),!Cr.c)break;gr?Cr.c.length>gr&&(Cr.c.length=gr):nr&&(Cr=Cr.mod(tr))}if(pr){if(pr=a(pr/2),pr===0)break;xr=pr%2}else if(pt=pt.times(sr),dr(pt,pt.e+1,1),pt.e>14)xr=q(pt);else{if(pr=+ir(pt),pr===0)break;xr=pr%2}wr=wr.times(wr),gr?wr.c&&wr.c.length>gr&&(wr.c.length=gr):nr&&(wr=wr.mod(tr))}return nr?Cr:(Er&&(Cr=ze.div(Cr)),tr?Cr.mod(tr):gr?dr(Cr,L,D,mr):Cr)},it.integerValue=function(pt){var tr=new Xe(this);return pt==null?pt=D:Ve(pt,0,8),dr(tr,tr.e+1,pt)},it.isEqualTo=it.eq=function(pt,tr){return je(this,new Xe(pt,tr))===0},it.isFinite=function(){return!!this.c},it.isGreaterThan=it.gt=function(pt,tr){return je(this,new Xe(pt,tr))>0},it.isGreaterThanOrEqualTo=it.gte=function(pt,tr){return(tr=je(this,new Xe(pt,tr)))===1||tr===0},it.isInteger=function(){return!!this.c&&I(this.e/f)>this.c.length-2},it.isLessThan=it.lt=function(pt,tr){return je(this,new Xe(pt,tr))<0},it.isLessThanOrEqualTo=it.lte=function(pt,tr){return(tr=je(this,new Xe(pt,tr)))===-1||tr===0},it.isNaN=function(){return!this.s},it.isNegative=function(){return this.s<0},it.isPositive=function(){return this.s>0},it.isZero=function(){return!!this.c&&this.c[0]==0},it.minus=function(pt,tr){var sr,nr,pr,gr,mr=this,yr=mr.s;if(pt=new Xe(pt,tr),tr=pt.s,!yr||!tr)return new Xe(NaN);if(yr!=tr)return pt.s=-tr,mr.plus(pt);var Er=mr.e/f,xr=pt.e/f,Cr=mr.c,wr=pt.c;if(!Er||!xr){if(!Cr||!wr)return Cr?(pt.s=-tr,pt):new Xe(wr?mr:NaN);if(!Cr[0]||!wr[0])return wr[0]?(pt.s=-tr,pt):new Xe(Cr[0]?mr:D==3?-0:0)}if(Er=I(Er),xr=I(xr),Cr=Cr.slice(),yr=Er-xr){for((gr=yr<0)?(yr=-yr,pr=Cr):(xr=Er,pr=wr),pr.reverse(),tr=yr;tr--;pr.push(0));pr.reverse()}else for(nr=(gr=(yr=Cr.length)<(tr=wr.length))?yr:tr,yr=tr=0;tr<nr;tr++)if(Cr[tr]!=wr[tr]){gr=Cr[tr]<wr[tr];break}if(gr&&(pr=Cr,Cr=wr,wr=pr,pt.s=-pt.s),tr=(nr=wr.length)-(sr=Cr.length),tr>0)for(;tr--;Cr[sr++]=0);for(tr=x-1;nr>yr;){if(Cr[--nr]<wr[nr]){for(sr=nr;sr&&!Cr[--sr];Cr[sr]=tr);--Cr[sr],Cr[nr]+=x}Cr[nr]-=wr[nr]}for(;Cr[0]==0;Cr.splice(0,1),--xr);return Cr[0]?ar(pt,Cr,xr):(pt.s=D==3?-1:1,pt.c=[pt.e=0],pt)},it.modulo=it.mod=function(pt,tr){var sr,nr,pr=this;return pt=new Xe(pt,tr),!pr.c||!pt.s||pt.c&&!pt.c[0]?new Xe(NaN):!pt.c||pr.c&&!pr.c[0]?new Xe(pr):(Ce==9?(nr=pt.s,pt.s=1,sr=W(pr,pt,0,3),pt.s=nr,sr.s*=nr):sr=W(pr,pt,0,Ce),pt=pr.minus(sr.times(pt)),!pt.c[0]&&Ce==1&&(pt.s=pr.s),pt)},it.multipliedBy=it.times=function(pt,tr){var sr,nr,pr,gr,mr,yr,Er,xr,Cr,wr,kr,Dr,rr,cr,Br,br=this,lr=br.c,Sr=(pt=new Xe(pt,tr)).c;if(!lr||!Sr||!lr[0]||!Sr[0])return!br.s||!pt.s||lr&&!lr[0]&&!Sr||Sr&&!Sr[0]&&!lr?pt.c=pt.e=pt.s=null:(pt.s*=br.s,!lr||!Sr?pt.c=pt.e=null:(pt.c=[0],pt.e=0)),pt;for(nr=I(br.e/f)+I(pt.e/f),pt.s*=br.s,Er=lr.length,wr=Sr.length,Er<wr&&(rr=lr,lr=Sr,Sr=rr,pr=Er,Er=wr,wr=pr),pr=Er+wr,rr=[];pr--;rr.push(0));for(cr=x,Br=y,pr=wr;--pr>=0;){for(sr=0,kr=Sr[pr]%Br,Dr=Sr[pr]/Br|0,mr=Er,gr=pr+mr;gr>pr;)xr=lr[--mr]%Br,Cr=lr[mr]/Br|0,yr=Dr*xr+Cr*kr,xr=kr*xr+yr%Br*Br+rr[gr]+sr,sr=(xr/cr|0)+(yr/Br|0)+Dr*Cr,rr[gr--]=xr%cr;rr[gr]=sr}return sr?++nr:rr.splice(0,1),ar(pt,rr,nr)},it.negated=function(){var pt=new Xe(this);return pt.s=-pt.s||null,pt},it.plus=function(pt,tr){var sr,nr=this,pr=nr.s;if(pt=new Xe(pt,tr),tr=pt.s,!pr||!tr)return new Xe(NaN);if(pr!=tr)return pt.s=-tr,nr.minus(pt);var gr=nr.e/f,mr=pt.e/f,yr=nr.c,Er=pt.c;if(!gr||!mr){if(!yr||!Er)return new Xe(pr/0);if(!yr[0]||!Er[0])return Er[0]?pt:new Xe(yr[0]?nr:pr*0)}if(gr=I(gr),mr=I(mr),yr=yr.slice(),pr=gr-mr){for(pr>0?(mr=gr,sr=Er):(pr=-pr,sr=yr),sr.reverse();pr--;sr.push(0));sr.reverse()}for(pr=yr.length,tr=Er.length,pr-tr<0&&(sr=Er,Er=yr,yr=sr,tr=pr),pr=0;tr;)pr=(yr[--tr]=yr[tr]+Er[tr]+pr)/x|0,yr[tr]=x===yr[tr]?0:yr[tr]%x;return pr&&(yr=[pr].concat(yr),++mr),ar(pt,yr,mr)},it.precision=it.sd=function(pt,tr){var sr,nr,pr,gr=this;if(pt!=null&&pt!==!!pt)return Ve(pt,1,w),tr==null?tr=D:Ve(tr,0,8),dr(new Xe(gr),pt,tr);if(!(sr=gr.c))return null;if(pr=sr.length-1,nr=pr*f+1,pr=sr[pr]){for(;pr%10==0;pr/=10,nr--);for(pr=sr[0];pr>=10;pr/=10,nr++);}return pt&&gr.e+1>nr&&(nr=gr.e+1),nr},it.shiftedBy=function(pt){return Ve(pt,-p,p),this.times("1e"+pt)},it.squareRoot=it.sqrt=function(){var pt,tr,sr,nr,pr,gr=this,mr=gr.c,yr=gr.s,Er=gr.e,xr=v+4,Cr=new Xe("0.5");if(yr!==1||!mr||!mr[0])return new Xe(!yr||yr<0&&(!mr||mr[0])?NaN:mr?gr:1/0);if(yr=Math.sqrt(+ir(gr)),yr==0||yr==1/0?(tr=k(mr),(tr.length+Er)%2==0&&(tr+="0"),yr=Math.sqrt(+tr),Er=I((Er+1)/2)-(Er<0||Er%2),yr==1/0?tr="5e"+Er:(tr=yr.toExponential(),tr=tr.slice(0,tr.indexOf("e")+1)+Er),sr=new Xe(tr)):sr=new Xe(yr+""),sr.c[0]){for(Er=sr.e,yr=Er+xr,yr<3&&(yr=0);;)if(pr=sr,sr=Cr.times(pr.plus(W(gr,pr,xr,1))),k(pr.c).slice(0,yr)===(tr=k(sr.c)).slice(0,yr))if(sr.e<Er&&--yr,tr=tr.slice(yr-3,yr+1),tr=="9999"||!nr&&tr=="4999"){if(!nr&&(dr(pr,pr.e+v+2,0),pr.times(pr).eq(gr))){sr=pr;break}xr+=4,yr+=4,nr=1}else{(!+tr||!+tr.slice(1)&&tr.charAt(0)=="5")&&(dr(sr,sr.e+v+2,1),pt=!sr.times(sr).eq(gr));break}}return dr(sr,sr.e+v+1,D,pt)},it.toExponential=function(pt,tr){return pt!=null&&(Ve(pt,0,w),pt++),dt(this,pt,tr,1)},it.toFixed=function(pt,tr){return pt!=null&&(Ve(pt,0,w),pt=pt+this.e+1),dt(this,pt,tr)},it.toFormat=function(pt,tr,sr){var nr,pr=this;if(sr==null)pt!=null&&tr&&typeof tr=="object"?(sr=tr,tr=null):pt&&typeof pt=="object"?(sr=pt,pt=tr=null):sr=O;else if(typeof sr!="object")throw Error(l+"Argument not an object: "+sr);if(nr=pr.toFixed(pt,tr),pr.c){var gr,mr=nr.split("."),yr=+sr.groupSize,Er=+sr.secondaryGroupSize,xr=sr.groupSeparator||"",Cr=mr[0],wr=mr[1],kr=pr.s<0,Dr=kr?Cr.slice(1):Cr,rr=Dr.length;if(Er&&(gr=yr,yr=Er,Er=gr,rr-=gr),yr>0&&rr>0){for(gr=rr%yr||yr,Cr=Dr.substr(0,gr);gr<rr;gr+=yr)Cr+=xr+Dr.substr(gr,yr);Er>0&&(Cr+=xr+Dr.slice(gr)),kr&&(Cr="-"+Cr)}nr=wr?Cr+(sr.decimalSeparator||"")+((Er=+sr.fractionGroupSize)?wr.replace(new RegExp("\\d{"+Er+"}\\B","g"),"$&"+(sr.fractionGroupSeparator||"")):wr):Cr}return(sr.prefix||"")+nr+(sr.suffix||"")},it.toFraction=function(pt){var tr,sr,nr,pr,gr,mr,yr,Er,xr,Cr,wr,kr,Dr=this,rr=Dr.c;if(pt!=null&&(yr=new Xe(pt),!yr.isInteger()&&(yr.c||yr.s!==1)||yr.lt(ze)))throw Error(l+"Argument "+(yr.isInteger()?"out of range: ":"not an integer: ")+ir(yr));if(!rr)return new Xe(Dr);for(tr=new Xe(ze),xr=sr=new Xe(ze),nr=Er=new Xe(ze),kr=k(rr),gr=tr.e=kr.length-Dr.e-1,tr.c[0]=g[(mr=gr%f)<0?f+mr:mr],pt=!pt||yr.comparedTo(tr)>0?gr>0?tr:xr:yr,mr=Fe,Fe=1/0,yr=new Xe(kr),Er.c[0]=0;Cr=W(yr,tr,0,1),pr=sr.plus(Cr.times(nr)),pr.comparedTo(pt)!=1;)sr=nr,nr=pr,xr=Er.plus(Cr.times(pr=xr)),Er=pr,tr=yr.minus(Cr.times(pr=tr)),yr=pr;return pr=W(pt.minus(sr),nr,0,1),Er=Er.plus(pr.times(xr)),sr=sr.plus(pr.times(nr)),Er.s=xr.s=Dr.s,gr=gr*2,wr=W(xr,nr,gr,D).minus(Dr).abs().comparedTo(W(Er,sr,gr,D).minus(Dr).abs())<1?[xr,nr]:[Er,sr],Fe=mr,wr},it.toNumber=function(){return+ir(this)},it.toPrecision=function(pt,tr){return pt!=null&&Ve(pt,1,w),dt(this,pt,tr,2)},it.toString=function(pt){var tr,sr=this,nr=sr.s,pr=sr.e;return pr===null?nr?(tr="Infinity",nr<0&&(tr="-"+tr)):tr="NaN":(pt==null?tr=pr<=_e||pr>=P?$e(k(sr.c),pr):We(k(sr.c),pr,"0"):pt===10&&lt?(sr=dr(new Xe(sr),v+pr+1,D),tr=We(k(sr.c),sr.e,"0")):(Ve(pt,2,st.length,"Base"),tr=Ye(We(k(sr.c),pr,"0"),10,pt,nr,!0)),nr<0&&sr.c[0]&&(tr="-"+tr)),tr},it.valueOf=it.toJSON=function(){return ir(this)},it._isBigNumber=!0,K!=null&&Xe.set(K),Xe}function I(K){var W=K|0;return K>0||K===W?W:W-1}function k(K){for(var W,Ye,Qe=1,it=K.length,ze=K[0]+"";Qe<it;){for(W=K[Qe++]+"",Ye=f-W.length;Ye--;W="0"+W);ze+=W}for(it=ze.length;ze.charCodeAt(--it)===48;);return ze.slice(0,it+1||1)}function je(K,W){var Ye,Qe,it=K.c,ze=W.c,v=K.s,D=W.s,_e=K.e,P=W.e;if(!v||!D)return null;if(Ye=it&&!it[0],Qe=ze&&!ze[0],Ye||Qe)return Ye?Qe?0:-D:v;if(v!=D)return v;if(Ye=v<0,Qe=_e==P,!it||!ze)return Qe?0:!it^Ye?1:-1;if(!Qe)return _e>P^Ye?1:-1;for(D=(_e=it.length)<(P=ze.length)?_e:P,v=0;v<D;v++)if(it[v]!=ze[v])return it[v]>ze[v]^Ye?1:-1;return _e==P?0:_e>P^Ye?1:-1}function Ve(K,W,Ye,Qe){if(K<W||K>Ye||K!==a(K))throw Error(l+(Qe||"Argument")+(typeof K=="number"?K<W||K>Ye?" out of range: ":" not an integer: ":" not a primitive number: ")+String(K))}function q(K){var W=K.c.length-1;return I(K.e/f)==W&&K.c[W]%2!=0}function $e(K,W){return(K.length>1?K.charAt(0)+"."+K.slice(1):K)+(W<0?"e":"e+")+W}function We(K,W,Ye){var Qe,it;if(W<0){for(it=Ye+".";++W;it+=Ye);K=it+K}else if(Qe=K.length,++W>Qe){for(it=Ye,W-=Qe;--W;it+=Ye);K+=it}else W<Qe&&(K=K.slice(0,W)+"."+K.slice(W));return K}r=R(),r.default=r.BigNumber=r,e.exports?e.exports=r:(t||(t=typeof self<"u"&&self?self:window),t.BigNumber=r)})(bignumber)})(bignumber$1)),bignumber$1.exports}var jsbiUmd$1={exports:{}},jsbiUmd=jsbiUmd$1.exports,hasRequiredJsbiUmd;function requireJsbiUmd(){return hasRequiredJsbiUmd||(hasRequiredJsbiUmd=1,(function(e,t){(function(r,n){e.exports=n()})(jsbiUmd,function(){var r=Math.imul,n=Math.clz32,s=Math.abs,a=Math.max,l=Math.floor;class u extends Array{constructor(f,p){if(super(f),this.sign=p,f>u.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(f){var p=Number.isFinite;if(typeof f=="number"){if(f===0)return u.__zero();if(u.__isOneDigitInt(f))return 0>f?u.__oneDigit(-f,!0):u.__oneDigit(f,!1);if(!p(f)||l(f)!==f)throw new RangeError("The number "+f+" cannot be converted to BigInt because it is not an integer");return u.__fromDouble(f)}if(typeof f=="string"){const g=u.__fromString(f);if(g===null)throw new SyntaxError("Cannot convert "+f+" to a BigInt");return g}if(typeof f=="boolean")return f===!0?u.__oneDigit(1,!1):u.__zero();if(typeof f=="object"){if(f.constructor===u)return f;const g=u.__toPrimitive(f);return u.BigInt(g)}throw new TypeError("Cannot convert "+f+" to a BigInt")}toDebugString(){const f=["BigInt["];for(const p of this)f.push((p&&(p>>>0).toString(16))+", ");return f.push("]"),f.join("")}toString(f=10){if(2>f||36<f)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(f&f-1)==0?u.__toStringBasePowerOfTwo(this,f):u.__toStringGeneric(this,f,!1)}static toNumber(f){const p=f.length;if(p===0)return 0;if(p===1){const Ye=f.__unsignedDigit(0);return f.sign?-Ye:Ye}const g=f.__digit(p-1),y=u.__clz30(g),w=30*p-y;if(1024<w)return f.sign?-1/0:1/0;let R=w-1,I=g,k=p-1;const je=y+3;let Ve=je===32?0:I<<je;Ve>>>=12;const q=je-12;let $e=12<=je?0:I<<20+je,We=20+je;for(0<q&&0<k&&(k--,I=f.__digit(k),Ve|=I>>>30-q,$e=I<<q+2,We=q+2);0<We&&0<k;)k--,I=f.__digit(k),$e|=30<=We?I<<We-30:I>>>30-We,We-=30;const K=u.__decideRounding(f,We,k,I);if((K===1||K===0&&(1&$e)==1)&&($e=$e+1>>>0,$e===0&&(Ve++,Ve>>>20!=0&&(Ve=0,R++,1023<R))))return f.sign?-1/0:1/0;const W=f.sign?-2147483648:0;return R=R+1023<<20,u.__kBitConversionInts[1]=W|R|Ve,u.__kBitConversionInts[0]=$e,u.__kBitConversionDouble[0]}static unaryMinus(f){if(f.length===0)return f;const p=f.__copy();return p.sign=!f.sign,p}static bitwiseNot(f){return f.sign?u.__absoluteSubOne(f).__trim():u.__absoluteAddOne(f,!0)}static exponentiate(f,p){if(p.sign)throw new RangeError("Exponent must be positive");if(p.length===0)return u.__oneDigit(1,!1);if(f.length===0)return f;if(f.length===1&&f.__digit(0)===1)return f.sign&&(1&p.__digit(0))==0?u.unaryMinus(f):f;if(1<p.length)throw new RangeError("BigInt too big");let g=p.__unsignedDigit(0);if(g===1)return f;if(g>=u.__kMaxLengthBits)throw new RangeError("BigInt too big");if(f.length===1&&f.__digit(0)===2){const R=1+(0|g/30),I=f.sign&&(1&g)!=0,k=new u(R,I);k.__initializeDigits();const je=1<<g%30;return k.__setDigit(R-1,je),k}let y=null,w=f;for((1&g)!=0&&(y=f),g>>=1;g!==0;g>>=1)w=u.multiply(w,w),(1&g)!=0&&(y===null?y=w:y=u.multiply(y,w));return y}static multiply(f,p){if(f.length===0)return f;if(p.length===0)return p;let g=f.length+p.length;30<=f.__clzmsd()+p.__clzmsd()&&g--;const y=new u(g,f.sign!==p.sign);y.__initializeDigits();for(let w=0;w<f.length;w++)u.__multiplyAccumulate(p,f.__digit(w),y,w);return y.__trim()}static divide(f,p){if(p.length===0)throw new RangeError("Division by zero");if(0>u.__absoluteCompare(f,p))return u.__zero();const g=f.sign!==p.sign,y=p.__unsignedDigit(0);let w;if(p.length===1&&32767>=y){if(y===1)return g===f.sign?f:u.unaryMinus(f);w=u.__absoluteDivSmall(f,y,null)}else w=u.__absoluteDivLarge(f,p,!0,!1);return w.sign=g,w.__trim()}static remainder(f,p){if(p.length===0)throw new RangeError("Division by zero");if(0>u.__absoluteCompare(f,p))return f;const g=p.__unsignedDigit(0);if(p.length===1&&32767>=g){if(g===1)return u.__zero();const w=u.__absoluteModSmall(f,g);return w===0?u.__zero():u.__oneDigit(w,f.sign)}const y=u.__absoluteDivLarge(f,p,!1,!0);return y.sign=f.sign,y.__trim()}static add(f,p){const g=f.sign;return g===p.sign?u.__absoluteAdd(f,p,g):0<=u.__absoluteCompare(f,p)?u.__absoluteSub(f,p,g):u.__absoluteSub(p,f,!g)}static subtract(f,p){const g=f.sign;return g===p.sign?0<=u.__absoluteCompare(f,p)?u.__absoluteSub(f,p,g):u.__absoluteSub(p,f,!g):u.__absoluteAdd(f,p,g)}static leftShift(f,p){return p.length===0||f.length===0?f:p.sign?u.__rightShiftByAbsolute(f,p):u.__leftShiftByAbsolute(f,p)}static signedRightShift(f,p){return p.length===0||f.length===0?f:p.sign?u.__leftShiftByAbsolute(f,p):u.__rightShiftByAbsolute(f,p)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(f,p){return 0>u.__compareToBigInt(f,p)}static lessThanOrEqual(f,p){return 0>=u.__compareToBigInt(f,p)}static greaterThan(f,p){return 0<u.__compareToBigInt(f,p)}static greaterThanOrEqual(f,p){return 0<=u.__compareToBigInt(f,p)}static equal(f,p){if(f.sign!==p.sign||f.length!==p.length)return!1;for(let g=0;g<f.length;g++)if(f.__digit(g)!==p.__digit(g))return!1;return!0}static notEqual(f,p){return!u.equal(f,p)}static bitwiseAnd(f,p){if(!f.sign&&!p.sign)return u.__absoluteAnd(f,p).__trim();if(f.sign&&p.sign){const g=a(f.length,p.length)+1;let y=u.__absoluteSubOne(f,g);const w=u.__absoluteSubOne(p);return y=u.__absoluteOr(y,w,y),u.__absoluteAddOne(y,!0,y).__trim()}return f.sign&&([f,p]=[p,f]),u.__absoluteAndNot(f,u.__absoluteSubOne(p)).__trim()}static bitwiseXor(f,p){if(!f.sign&&!p.sign)return u.__absoluteXor(f,p).__trim();if(f.sign&&p.sign){const w=a(f.length,p.length),R=u.__absoluteSubOne(f,w),I=u.__absoluteSubOne(p);return u.__absoluteXor(R,I,R).__trim()}const g=a(f.length,p.length)+1;f.sign&&([f,p]=[p,f]);let y=u.__absoluteSubOne(p,g);return y=u.__absoluteXor(y,f,y),u.__absoluteAddOne(y,!0,y).__trim()}static bitwiseOr(f,p){const g=a(f.length,p.length);if(!f.sign&&!p.sign)return u.__absoluteOr(f,p).__trim();if(f.sign&&p.sign){let w=u.__absoluteSubOne(f,g);const R=u.__absoluteSubOne(p);return w=u.__absoluteAnd(w,R,w),u.__absoluteAddOne(w,!0,w).__trim()}f.sign&&([f,p]=[p,f]);let y=u.__absoluteSubOne(p,g);return y=u.__absoluteAndNot(y,f,y),u.__absoluteAddOne(y,!0,y).__trim()}static asIntN(f,p){if(p.length===0)return p;if(f=l(f),0>f)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(f===0)return u.__zero();if(f>=u.__kMaxLengthBits)return p;const g=0|(f+29)/30;if(p.length<g)return p;const y=p.__unsignedDigit(g-1),w=1<<(f-1)%30;if(p.length===g&&y<w)return p;if((y&w)!==w)return u.__truncateToNBits(f,p);if(!p.sign)return u.__truncateAndSubFromPowerOfTwo(f,p,!0);if((y&w-1)==0){for(let R=g-2;0<=R;R--)if(p.__digit(R)!==0)return u.__truncateAndSubFromPowerOfTwo(f,p,!1);return p.length===g&&y===w?p:u.__truncateToNBits(f,p)}return u.__truncateAndSubFromPowerOfTwo(f,p,!1)}static asUintN(f,p){if(p.length===0)return p;if(f=l(f),0>f)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(f===0)return u.__zero();if(p.sign){if(f>u.__kMaxLengthBits)throw new RangeError("BigInt too big");return u.__truncateAndSubFromPowerOfTwo(f,p,!1)}if(f>=u.__kMaxLengthBits)return p;const g=0|(f+29)/30;if(p.length<g)return p;const y=f%30;return p.length==g&&(y===0||!(p.__digit(g-1)>>>y))?p:u.__truncateToNBits(f,p)}static ADD(f,p){if(f=u.__toPrimitive(f),p=u.__toPrimitive(p),typeof f=="string")return typeof p!="string"&&(p=p.toString()),f+p;if(typeof p=="string")return f.toString()+p;if(f=u.__toNumeric(f),p=u.__toNumeric(p),u.__isBigInt(f)&&u.__isBigInt(p))return u.add(f,p);if(typeof f=="number"&&typeof p=="number")return f+p;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(f,p){return u.__compare(f,p,0)}static LE(f,p){return u.__compare(f,p,1)}static GT(f,p){return u.__compare(f,p,2)}static GE(f,p){return u.__compare(f,p,3)}static EQ(f,p){for(;;){if(u.__isBigInt(f))return u.__isBigInt(p)?u.equal(f,p):u.EQ(p,f);if(typeof f=="number"){if(u.__isBigInt(p))return u.__equalToNumber(p,f);if(typeof p!="object")return f==p;p=u.__toPrimitive(p)}else if(typeof f=="string"){if(u.__isBigInt(p))return f=u.__fromString(f),f!==null&&u.equal(f,p);if(typeof p!="object")return f==p;p=u.__toPrimitive(p)}else if(typeof f=="boolean"){if(u.__isBigInt(p))return u.__equalToNumber(p,+f);if(typeof p!="object")return f==p;p=u.__toPrimitive(p)}else if(typeof f=="symbol"){if(u.__isBigInt(p))return!1;if(typeof p!="object")return f==p;p=u.__toPrimitive(p)}else if(typeof f=="object"){if(typeof p=="object"&&p.constructor!==u)return f==p;f=u.__toPrimitive(f)}else return f==p}}static NE(f,p){return!u.EQ(f,p)}static __zero(){return new u(0,!1)}static __oneDigit(f,p){const g=new u(1,p);return g.__setDigit(0,f),g}__copy(){const f=new u(this.length,this.sign);for(let p=0;p<this.length;p++)f[p]=this[p];return f}__trim(){let f=this.length,p=this[f-1];for(;p===0;)f--,p=this[f-1],this.pop();return f===0&&(this.sign=!1),this}__initializeDigits(){for(let f=0;f<this.length;f++)this[f]=0}static __decideRounding(f,p,g,y){if(0<p)return-1;let w;if(0>p)w=-p-1;else{if(g===0)return-1;g--,y=f.__digit(g),w=29}let R=1<<w;if((y&R)==0)return-1;if(R-=1,(y&R)!=0)return 1;for(;0<g;)if(g--,f.__digit(g)!==0)return 1;return 0}static __fromDouble(f){u.__kBitConversionDouble[0]=f;const p=2047&u.__kBitConversionInts[1]>>>20,g=p-1023,y=(0|g/30)+1,w=new u(y,0>f);let R=1048575&u.__kBitConversionInts[1]|1048576,I=u.__kBitConversionInts[0];const k=20,je=g%30;let Ve,q=0;if(20>je){const $e=k-je;q=$e+32,Ve=R>>>$e,R=R<<32-$e|I>>>$e,I<<=32-$e}else if(je===20)q=32,Ve=R,R=I,I=0;else{const $e=je-k;q=32-$e,Ve=R<<$e|I>>>32-$e,R=I<<$e,I=0}w.__setDigit(y-1,Ve);for(let $e=y-2;0<=$e;$e--)0<q?(q-=30,Ve=R>>>2,R=R<<30|I>>>2,I<<=30):Ve=0,w.__setDigit($e,Ve);return w.__trim()}static __isWhitespace(f){return 13>=f&&9<=f||(159>=f?f==32:131071>=f?f==160||f==5760:196607>=f?(f&=131071,10>=f||f==40||f==41||f==47||f==95||f==4096):f==65279)}static __fromString(f,p=0){let g=0;const y=f.length;let w=0;if(w===y)return u.__zero();let R=f.charCodeAt(w);for(;u.__isWhitespace(R);){if(++w===y)return u.__zero();R=f.charCodeAt(w)}if(R===43){if(++w===y)return null;R=f.charCodeAt(w),g=1}else if(R===45){if(++w===y)return null;R=f.charCodeAt(w),g=-1}if(p===0){if(p=10,R===48){if(++w===y)return u.__zero();if(R=f.charCodeAt(w),R===88||R===120){if(p=16,++w===y)return null;R=f.charCodeAt(w)}else if(R===79||R===111){if(p=8,++w===y)return null;R=f.charCodeAt(w)}else if(R===66||R===98){if(p=2,++w===y)return null;R=f.charCodeAt(w)}}}else if(p===16&&R===48){if(++w===y)return u.__zero();if(R=f.charCodeAt(w),R===88||R===120){if(++w===y)return null;R=f.charCodeAt(w)}}if(g!=0&&p!==10)return null;for(;R===48;){if(++w===y)return u.__zero();R=f.charCodeAt(w)}const I=y-w;let k=u.__kMaxBitsPerChar[p],je=u.__kBitsPerCharTableMultiplier-1;if(I>1073741824/k)return null;const Ve=k*I+je>>>u.__kBitsPerCharTableShift,q=new u(0|(Ve+29)/30,!1),$e=10>p?p:10,We=10<p?p-10:0;if((p&p-1)==0){k>>=u.__kBitsPerCharTableShift;const K=[],W=[];let Ye=!1;do{let Qe=0,it=0;for(;;){let ze;if(R-48>>>0<$e)ze=R-48;else if((32|R)-97>>>0<We)ze=(32|R)-87;else{Ye=!0;break}if(it+=k,Qe=Qe<<k|ze,++w===y){Ye=!0;break}if(R=f.charCodeAt(w),30<it+k)break}K.push(Qe),W.push(it)}while(!Ye);u.__fillFromParts(q,K,W)}else{q.__initializeDigits();let K=!1,W=0;do{let Ye=0,Qe=1;for(;;){let ze;if(R-48>>>0<$e)ze=R-48;else if((32|R)-97>>>0<We)ze=(32|R)-87;else{K=!0;break}const v=Qe*p;if(1073741823<v)break;if(Qe=v,Ye=Ye*p+ze,W++,++w===y){K=!0;break}R=f.charCodeAt(w)}je=30*u.__kBitsPerCharTableMultiplier-1;const it=0|(k*W+je>>>u.__kBitsPerCharTableShift)/30;q.__inplaceMultiplyAdd(Qe,Ye,it)}while(!K)}if(w!==y){if(!u.__isWhitespace(R))return null;for(w++;w<y;w++)if(R=f.charCodeAt(w),!u.__isWhitespace(R))return null}return q.sign=g==-1,q.__trim()}static __fillFromParts(f,p,g){let y=0,w=0,R=0;for(let I=p.length-1;0<=I;I--){const k=p[I],je=g[I];w|=k<<R,R+=je,R===30?(f.__setDigit(y++,w),R=0,w=0):30<R&&(f.__setDigit(y++,1073741823&w),R-=30,w=k>>>je-R)}if(w!==0){if(y>=f.length)throw new Error("implementation bug");f.__setDigit(y++,w)}for(;y<f.length;y++)f.__setDigit(y,0)}static __toStringBasePowerOfTwo(f,p){const g=f.length;let y=p-1;y=(85&y>>>1)+(85&y),y=(51&y>>>2)+(51&y),y=(15&y>>>4)+(15&y);const w=y,R=p-1,I=f.__digit(g-1),k=u.__clz30(I);let je=0|(30*g-k+w-1)/w;if(f.sign&&je++,268435456<je)throw new Error("string too long");const Ve=Array(je);let q=je-1,$e=0,We=0;for(let W=0;W<g-1;W++){const Ye=f.__digit(W),Qe=($e|Ye<<We)&R;Ve[q--]=u.__kConversionChars[Qe];const it=w-We;for($e=Ye>>>it,We=30-it;We>=w;)Ve[q--]=u.__kConversionChars[$e&R],$e>>>=w,We-=w}const K=($e|I<<We)&R;for(Ve[q--]=u.__kConversionChars[K],$e=I>>>w-We;$e!==0;)Ve[q--]=u.__kConversionChars[$e&R],$e>>>=w;if(f.sign&&(Ve[q--]="-"),q!=-1)throw new Error("implementation bug");return Ve.join("")}static __toStringGeneric(f,p,g){const y=f.length;if(y===0)return"";if(y===1){let W=f.__unsignedDigit(0).toString(p);return g===!1&&f.sign&&(W="-"+W),W}const w=30*y-u.__clz30(f.__digit(y-1)),R=u.__kMaxBitsPerChar[p],I=R-1;let k=w*u.__kBitsPerCharTableMultiplier;k+=I-1,k=0|k/I;const je=k+1>>1,Ve=u.exponentiate(u.__oneDigit(p,!1),u.__oneDigit(je,!1));let q,$e;const We=Ve.__unsignedDigit(0);if(Ve.length===1&&32767>=We){q=new u(f.length,!1),q.__initializeDigits();let W=0;for(let Ye=2*f.length-1;0<=Ye;Ye--){const Qe=W<<15|f.__halfDigit(Ye);q.__setHalfDigit(Ye,0|Qe/We),W=0|Qe%We}$e=W.toString(p)}else{const W=u.__absoluteDivLarge(f,Ve,!0,!0);q=W.quotient;const Ye=W.remainder.__trim();$e=u.__toStringGeneric(Ye,p,!0)}q.__trim();let K=u.__toStringGeneric(q,p,!0);for(;$e.length<je;)$e="0"+$e;return g===!1&&f.sign&&(K="-"+K),K+$e}static __unequalSign(f){return f?-1:1}static __absoluteGreater(f){return f?-1:1}static __absoluteLess(f){return f?1:-1}static __compareToBigInt(f,p){const g=f.sign;if(g!==p.sign)return u.__unequalSign(g);const y=u.__absoluteCompare(f,p);return 0<y?u.__absoluteGreater(g):0>y?u.__absoluteLess(g):0}static __compareToNumber(f,p){if(u.__isOneDigitInt(p)){const g=f.sign,y=0>p;if(g!==y)return u.__unequalSign(g);if(f.length===0){if(y)throw new Error("implementation bug");return p===0?0:-1}if(1<f.length)return u.__absoluteGreater(g);const w=s(p),R=f.__unsignedDigit(0);return R>w?u.__absoluteGreater(g):R<w?u.__absoluteLess(g):0}return u.__compareToDouble(f,p)}static __compareToDouble(f,p){if(p!==p)return p;if(p===1/0)return-1;if(p===-1/0)return 1;const g=f.sign;if(g!==0>p)return u.__unequalSign(g);if(p===0)throw new Error("implementation bug: should be handled elsewhere");if(f.length===0)return-1;u.__kBitConversionDouble[0]=p;const y=2047&u.__kBitConversionInts[1]>>>20;if(y==2047)throw new Error("implementation bug: handled elsewhere");const w=y-1023;if(0>w)return u.__absoluteGreater(g);const R=f.length;let I=f.__digit(R-1);const k=u.__clz30(I),je=30*R-k,Ve=w+1;if(je<Ve)return u.__absoluteLess(g);if(je>Ve)return u.__absoluteGreater(g);let q=1048576|1048575&u.__kBitConversionInts[1],$e=u.__kBitConversionInts[0];const We=20,K=29-k;if(K!==(0|(je-1)%30))throw new Error("implementation bug");let W,Ye=0;if(20>K){const Qe=We-K;Ye=Qe+32,W=q>>>Qe,q=q<<32-Qe|$e>>>Qe,$e<<=32-Qe}else if(K===20)Ye=32,W=q,q=$e,$e=0;else{const Qe=K-We;Ye=32-Qe,W=q<<Qe|$e>>>32-Qe,q=$e<<Qe,$e=0}if(I>>>=0,W>>>=0,I>W)return u.__absoluteGreater(g);if(I<W)return u.__absoluteLess(g);for(let Qe=R-2;0<=Qe;Qe--){0<Ye?(Ye-=30,W=q>>>2,q=q<<30|$e>>>2,$e<<=30):W=0;const it=f.__unsignedDigit(Qe);if(it>W)return u.__absoluteGreater(g);if(it<W)return u.__absoluteLess(g)}if(q!==0||$e!==0){if(Ye===0)throw new Error("implementation bug");return u.__absoluteLess(g)}return 0}static __equalToNumber(f,p){return u.__isOneDigitInt(p)?p===0?f.length===0:f.length===1&&f.sign===0>p&&f.__unsignedDigit(0)===s(p):u.__compareToDouble(f,p)===0}static __comparisonResultToBool(f,p){return p===0?0>f:p===1?0>=f:p===2?0<f:p===3?0<=f:void 0}static __compare(f,p,g){if(f=u.__toPrimitive(f),p=u.__toPrimitive(p),typeof f=="string"&&typeof p=="string")switch(g){case 0:return f<p;case 1:return f<=p;case 2:return f>p;case 3:return f>=p}if(u.__isBigInt(f)&&typeof p=="string")return p=u.__fromString(p),p!==null&&u.__comparisonResultToBool(u.__compareToBigInt(f,p),g);if(typeof f=="string"&&u.__isBigInt(p))return f=u.__fromString(f),f!==null&&u.__comparisonResultToBool(u.__compareToBigInt(f,p),g);if(f=u.__toNumeric(f),p=u.__toNumeric(p),u.__isBigInt(f)){if(u.__isBigInt(p))return u.__comparisonResultToBool(u.__compareToBigInt(f,p),g);if(typeof p!="number")throw new Error("implementation bug");return u.__comparisonResultToBool(u.__compareToNumber(f,p),g)}if(typeof f!="number")throw new Error("implementation bug");if(u.__isBigInt(p))return u.__comparisonResultToBool(u.__compareToNumber(p,f),2^g);if(typeof p!="number")throw new Error("implementation bug");return g===0?f<p:g===1?f<=p:g===2?f>p:g===3?f>=p:void 0}__clzmsd(){return u.__clz30(this.__digit(this.length-1))}static __absoluteAdd(f,p,g){if(f.length<p.length)return u.__absoluteAdd(p,f,g);if(f.length===0)return f;if(p.length===0)return f.sign===g?f:u.unaryMinus(f);let y=f.length;(f.__clzmsd()===0||p.length===f.length&&p.__clzmsd()===0)&&y++;const w=new u(y,g);let R=0,I=0;for(;I<p.length;I++){const k=f.__digit(I)+p.__digit(I)+R;R=k>>>30,w.__setDigit(I,1073741823&k)}for(;I<f.length;I++){const k=f.__digit(I)+R;R=k>>>30,w.__setDigit(I,1073741823&k)}return I<w.length&&w.__setDigit(I,R),w.__trim()}static __absoluteSub(f,p,g){if(f.length===0)return f;if(p.length===0)return f.sign===g?f:u.unaryMinus(f);const y=new u(f.length,g);let w=0,R=0;for(;R<p.length;R++){const I=f.__digit(R)-p.__digit(R)-w;w=1&I>>>30,y.__setDigit(R,1073741823&I)}for(;R<f.length;R++){const I=f.__digit(R)-w;w=1&I>>>30,y.__setDigit(R,1073741823&I)}return y.__trim()}static __absoluteAddOne(f,p,g=null){const y=f.length;g===null?g=new u(y,p):g.sign=p;let w=1;for(let R=0;R<y;R++){const I=f.__digit(R)+w;w=I>>>30,g.__setDigit(R,1073741823&I)}return w!=0&&g.__setDigitGrow(y,1),g}static __absoluteSubOne(f,p){const g=f.length;p=p||g;const y=new u(p,!1);let w=1;for(let R=0;R<g;R++){const I=f.__digit(R)-w;w=1&I>>>30,y.__setDigit(R,1073741823&I)}if(w!=0)throw new Error("implementation bug");for(let R=g;R<p;R++)y.__setDigit(R,0);return y}static __absoluteAnd(f,p,g=null){let y=f.length,w=p.length,R=w;if(y<w){R=y;const je=f,Ve=y;f=p,y=w,p=je,w=Ve}let I=R;g===null?g=new u(I,!1):I=g.length;let k=0;for(;k<R;k++)g.__setDigit(k,f.__digit(k)&p.__digit(k));for(;k<I;k++)g.__setDigit(k,0);return g}static __absoluteAndNot(f,p,g=null){const y=f.length,w=p.length;let R=w;y<w&&(R=y);let I=y;g===null?g=new u(I,!1):I=g.length;let k=0;for(;k<R;k++)g.__setDigit(k,f.__digit(k)&~p.__digit(k));for(;k<y;k++)g.__setDigit(k,f.__digit(k));for(;k<I;k++)g.__setDigit(k,0);return g}static __absoluteOr(f,p,g=null){let y=f.length,w=p.length,R=w;if(y<w){R=y;const je=f,Ve=y;f=p,y=w,p=je,w=Ve}let I=y;g===null?g=new u(I,!1):I=g.length;let k=0;for(;k<R;k++)g.__setDigit(k,f.__digit(k)|p.__digit(k));for(;k<y;k++)g.__setDigit(k,f.__digit(k));for(;k<I;k++)g.__setDigit(k,0);return g}static __absoluteXor(f,p,g=null){let y=f.length,w=p.length,R=w;if(y<w){R=y;const je=f,Ve=y;f=p,y=w,p=je,w=Ve}let I=y;g===null?g=new u(I,!1):I=g.length;let k=0;for(;k<R;k++)g.__setDigit(k,f.__digit(k)^p.__digit(k));for(;k<y;k++)g.__setDigit(k,f.__digit(k));for(;k<I;k++)g.__setDigit(k,0);return g}static __absoluteCompare(f,p){const g=f.length-p.length;if(g!=0)return g;let y=f.length-1;for(;0<=y&&f.__digit(y)===p.__digit(y);)y--;return 0>y?0:f.__unsignedDigit(y)>p.__unsignedDigit(y)?1:-1}static __multiplyAccumulate(f,p,g,y){if(p===0)return;const w=32767&p,R=p>>>15;let I=0,k=0;for(let je,Ve=0;Ve<f.length;Ve++,y++){je=g.__digit(y);const q=f.__digit(Ve),$e=32767&q,We=q>>>15,K=u.__imul($e,w),W=u.__imul($e,R),Ye=u.__imul(We,w),Qe=u.__imul(We,R);je+=k+K+I,I=je>>>30,je&=1073741823,je+=((32767&W)<<15)+((32767&Ye)<<15),I+=je>>>30,k=Qe+(W>>>15)+(Ye>>>15),g.__setDigit(y,1073741823&je)}for(;I!=0||k!==0;y++){let je=g.__digit(y);je+=I+k,k=0,I=je>>>30,g.__setDigit(y,1073741823&je)}}static __internalMultiplyAdd(f,p,g,y,w){let R=g,I=0;for(let k=0;k<y;k++){const je=f.__digit(k),Ve=u.__imul(32767&je,p),q=u.__imul(je>>>15,p),$e=Ve+((32767&q)<<15)+I+R;R=$e>>>30,I=q>>>15,w.__setDigit(k,1073741823&$e)}if(w.length>y)for(w.__setDigit(y++,R+I);y<w.length;)w.__setDigit(y++,0);else if(R+I!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(f,p,g){g>this.length&&(g=this.length);const y=32767&f,w=f>>>15;let R=0,I=p;for(let k=0;k<g;k++){const je=this.__digit(k),Ve=32767&je,q=je>>>15,$e=u.__imul(Ve,y),We=u.__imul(Ve,w),K=u.__imul(q,y),W=u.__imul(q,w);let Ye=I+$e+R;R=Ye>>>30,Ye&=1073741823,Ye+=((32767&We)<<15)+((32767&K)<<15),R+=Ye>>>30,I=W+(We>>>15)+(K>>>15),this.__setDigit(k,1073741823&Ye)}if(R!=0||I!==0)throw new Error("implementation bug")}static __absoluteDivSmall(f,p,g=null){g===null&&(g=new u(f.length,!1));let y=0;for(let w,R=2*f.length-1;0<=R;R-=2){w=(y<<15|f.__halfDigit(R))>>>0;const I=0|w/p;y=0|w%p,w=(y<<15|f.__halfDigit(R-1))>>>0;const k=0|w/p;y=0|w%p,g.__setDigit(R>>>1,I<<15|k)}return g}static __absoluteModSmall(f,p){let g=0;for(let y=2*f.length-1;0<=y;y--)g=0|((g<<15|f.__halfDigit(y))>>>0)%p;return g}static __absoluteDivLarge(f,p,g,y){const w=p.__halfDigitLength(),R=p.length,I=f.__halfDigitLength()-w;let k=null;g&&(k=new u(I+2>>>1,!1),k.__initializeDigits());const je=new u(w+2>>>1,!1);je.__initializeDigits();const Ve=u.__clz15(p.__halfDigit(w-1));0<Ve&&(p=u.__specialLeftShift(p,Ve,0));const q=u.__specialLeftShift(f,Ve,1),$e=p.__halfDigit(w-1);let We=0;for(let K,W=I;0<=W;W--){K=32767;const Ye=q.__halfDigit(W+w);if(Ye!==$e){const it=(Ye<<15|q.__halfDigit(W+w-1))>>>0;K=0|it/$e;let ze=0|it%$e;const v=p.__halfDigit(w-2),D=q.__halfDigit(W+w-2);for(;u.__imul(K,v)>>>0>(ze<<16|D)>>>0&&(K--,ze+=$e,!(32767<ze)););}u.__internalMultiplyAdd(p,K,0,R,je);let Qe=q.__inplaceSub(je,W,w+1);Qe!==0&&(Qe=q.__inplaceAdd(p,W,w),q.__setHalfDigit(W+w,32767&q.__halfDigit(W+w)+Qe),K--),g&&(1&W?We=K<<15:k.__setDigit(W>>>1,We|K))}if(y)return q.__inplaceRightShift(Ve),g?{quotient:k,remainder:q}:q;if(g)return k;throw new Error("unreachable")}static __clz15(f){return u.__clz30(f)-15}__inplaceAdd(f,p,g){let y=0;for(let w=0;w<g;w++){const R=this.__halfDigit(p+w)+f.__halfDigit(w)+y;y=R>>>15,this.__setHalfDigit(p+w,32767&R)}return y}__inplaceSub(f,p,g){let y=0;if(1&p){p>>=1;let w=this.__digit(p),R=32767&w,I=0;for(;I<g-1>>>1;I++){const Ve=f.__digit(I),q=(w>>>15)-(32767&Ve)-y;y=1&q>>>15,this.__setDigit(p+I,(32767&q)<<15|32767&R),w=this.__digit(p+I+1),R=(32767&w)-(Ve>>>15)-y,y=1&R>>>15}const k=f.__digit(I),je=(w>>>15)-(32767&k)-y;if(y=1&je>>>15,this.__setDigit(p+I,(32767&je)<<15|32767&R),p+I+1>=this.length)throw new RangeError("out of bounds");(1&g)==0&&(w=this.__digit(p+I+1),R=(32767&w)-(k>>>15)-y,y=1&R>>>15,this.__setDigit(p+f.length,1073709056&w|32767&R))}else{p>>=1;let w=0;for(;w<f.length-1;w++){const Ve=this.__digit(p+w),q=f.__digit(w),$e=(32767&Ve)-(32767&q)-y;y=1&$e>>>15;const We=(Ve>>>15)-(q>>>15)-y;y=1&We>>>15,this.__setDigit(p+w,(32767&We)<<15|32767&$e)}const R=this.__digit(p+w),I=f.__digit(w),k=(32767&R)-(32767&I)-y;y=1&k>>>15;let je=0;(1&g)==0&&(je=(R>>>15)-(I>>>15)-y,y=1&je>>>15),this.__setDigit(p+w,(32767&je)<<15|32767&k)}return y}__inplaceRightShift(f){if(f===0)return;let p=this.__digit(0)>>>f;const g=this.length-1;for(let y=0;y<g;y++){const w=this.__digit(y+1);this.__setDigit(y,1073741823&w<<30-f|p),p=w>>>f}this.__setDigit(g,p)}static __specialLeftShift(f,p,g){const y=f.length,w=new u(y+g,!1);if(p===0){for(let I=0;I<y;I++)w.__setDigit(I,f.__digit(I));return 0<g&&w.__setDigit(y,0),w}let R=0;for(let I=0;I<y;I++){const k=f.__digit(I);w.__setDigit(I,1073741823&k<<p|R),R=k>>>30-p}return 0<g&&w.__setDigit(y,R),w}static __leftShiftByAbsolute(f,p){const g=u.__toShiftAmount(p);if(0>g)throw new RangeError("BigInt too big");const y=0|g/30,w=g%30,R=f.length,I=w!==0&&f.__digit(R-1)>>>30-w!=0,k=R+y+(I?1:0),je=new u(k,f.sign);if(w===0){let Ve=0;for(;Ve<y;Ve++)je.__setDigit(Ve,0);for(;Ve<k;Ve++)je.__setDigit(Ve,f.__digit(Ve-y))}else{let Ve=0;for(let q=0;q<y;q++)je.__setDigit(q,0);for(let q=0;q<R;q++){const $e=f.__digit(q);je.__setDigit(q+y,1073741823&$e<<w|Ve),Ve=$e>>>30-w}if(I)je.__setDigit(R+y,Ve);else if(Ve!==0)throw new Error("implementation bug")}return je.__trim()}static __rightShiftByAbsolute(f,p){const g=f.length,y=f.sign,w=u.__toShiftAmount(p);if(0>w)return u.__rightShiftByMaximum(y);const R=0|w/30,I=w%30;let k=g-R;if(0>=k)return u.__rightShiftByMaximum(y);let je=!1;if(y){if((f.__digit(R)&(1<<I)-1)!=0)je=!0;else for(let q=0;q<R;q++)if(f.__digit(q)!==0){je=!0;break}}je&&I===0&&~f.__digit(g-1)==0&&k++;let Ve=new u(k,y);if(I===0){Ve.__setDigit(k-1,0);for(let q=R;q<g;q++)Ve.__setDigit(q-R,f.__digit(q))}else{let q=f.__digit(R)>>>I;const $e=g-R-1;for(let We=0;We<$e;We++){const K=f.__digit(We+R+1);Ve.__setDigit(We,1073741823&K<<30-I|q),q=K>>>I}Ve.__setDigit($e,q)}return je&&(Ve=u.__absoluteAddOne(Ve,!0,Ve)),Ve.__trim()}static __rightShiftByMaximum(f){return f?u.__oneDigit(1,!0):u.__zero()}static __toShiftAmount(f){if(1<f.length)return-1;const p=f.__unsignedDigit(0);return p>u.__kMaxLengthBits?-1:p}static __toPrimitive(f,p="default"){if(typeof f!="object"||f.constructor===u)return f;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const w=f[Symbol.toPrimitive];if(w){const R=w(p);if(typeof R!="object")return R;throw new TypeError("Cannot convert object to primitive value")}}const g=f.valueOf;if(g){const w=g.call(f);if(typeof w!="object")return w}const y=f.toString;if(y){const w=y.call(f);if(typeof w!="object")return w}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(f){return u.__isBigInt(f)?f:+f}static __isBigInt(f){return typeof f=="object"&&f!==null&&f.constructor===u}static __truncateToNBits(f,p){const g=0|(f+29)/30,y=new u(g,p.sign),w=g-1;for(let I=0;I<w;I++)y.__setDigit(I,p.__digit(I));let R=p.__digit(w);if(f%30!=0){const I=32-f%30;R=R<<I>>>I}return y.__setDigit(w,R),y.__trim()}static __truncateAndSubFromPowerOfTwo(f,p,g){var y=Math.min;const w=0|(f+29)/30,R=new u(w,g);let I=0;const k=w-1;let je=0;for(const We=y(k,p.length);I<We;I++){const K=0-p.__digit(I)-je;je=1&K>>>30,R.__setDigit(I,1073741823&K)}for(;I<k;I++)R.__setDigit(I,0|1073741823&-je);let Ve=k<p.length?p.__digit(k):0;const q=f%30;let $e;if(q==0)$e=0-Ve-je,$e&=1073741823;else{const We=32-q;Ve=Ve<<We>>>We;const K=1<<32-We;$e=K-Ve-je,$e&=K-1}return R.__setDigit(k,$e),R.__trim()}__digit(f){return this[f]}__unsignedDigit(f){return this[f]>>>0}__setDigit(f,p){this[f]=0|p}__setDigitGrow(f,p){this[f]=0|p}__halfDigitLength(){const f=this.length;return 32767>=this.__unsignedDigit(f-1)?2*f-1:2*f}__halfDigit(f){return 32767&this[f>>>1]>>>15*(1&f)}__setHalfDigit(f,p){const g=f>>>1,y=this.__digit(g),w=1&f?32767&y|p<<15:1073709056&y|32767&p;this.__setDigit(g,w)}static __digitPow(f,p){let g=1;for(;0<p;)1&p&&(g*=f),p>>>=1,f*=f;return g}static __isOneDigitInt(f){return(1073741823&f)===f}}return u.__kMaxLength=33554432,u.__kMaxLengthBits=u.__kMaxLength<<5,u.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],u.__kBitsPerCharTableShift=5,u.__kBitsPerCharTableMultiplier=1<<u.__kBitsPerCharTableShift,u.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],u.__kBitConversionBuffer=new ArrayBuffer(8),u.__kBitConversionDouble=new Float64Array(u.__kBitConversionBuffer),u.__kBitConversionInts=new Int32Array(u.__kBitConversionBuffer),u.__clz30=n?function(x){return n(x)-2}:function(x){var f=Math.LN2,p=Math.log;return x===0?30:0|29-(0|p(x>>>0)/f)},u.__imul=r||function(x,f){return 0|x*f},u})})(jsbiUmd$1)),jsbiUmd$1.exports}var hasRequiredXoshiro;function requireXoshiro(){if(hasRequiredXoshiro)return xoshiro;hasRequiredXoshiro=1;var e=xoshiro&&xoshiro.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(xoshiro,"__esModule",{value:!0});const t=requireUtils$7(),r=e(requireBignumber()),n=e(requireJsbiUmd()),s=18446744073709552e3,a=(u,x)=>n.default.bitwiseXor(n.default.asUintN(64,n.default.leftShift(u,n.default.BigInt(x))),n.default.BigInt(n.default.asUintN(64,n.default.signedRightShift(u,n.default.subtract(n.default.BigInt(64),n.default.BigInt(x))))));class l{constructor(x){this.next=()=>new r.default(this.roll().toString()),this.nextDouble=()=>new r.default(this.roll().toString()).div(s+1),this.nextInt=(p,g)=>Math.floor(this.nextDouble().toNumber()*(g-p+1)+p),this.nextByte=()=>this.nextInt(0,255),this.nextData=p=>[...new Array(p)].map(()=>this.nextByte());const f=t.sha256Hash(x);this.s=[n.default.BigInt(0),n.default.BigInt(0),n.default.BigInt(0),n.default.BigInt(0)],this.setS(f)}setS(x){for(let f=0;f<4;f++){let p=f*8,g=n.default.BigInt(0);for(let y=0;y<8;y++)g=n.default.asUintN(64,n.default.leftShift(g,n.default.BigInt(8))),g=n.default.asUintN(64,n.default.bitwiseOr(g,n.default.BigInt(x[p+y])));this.s[f]=n.default.asUintN(64,g)}}roll(){const x=n.default.asUintN(64,n.default.multiply(a(n.default.asUintN(64,n.default.multiply(this.s[1],n.default.BigInt(5))),7),n.default.BigInt(9))),f=n.default.asUintN(64,n.default.leftShift(this.s[1],n.default.BigInt(17)));return this.s[2]=n.default.asUintN(64,n.default.bitwiseXor(this.s[2],n.default.BigInt(this.s[0]))),this.s[3]=n.default.asUintN(64,n.default.bitwiseXor(this.s[3],n.default.BigInt(this.s[1]))),this.s[1]=n.default.asUintN(64,n.default.bitwiseXor(this.s[1],n.default.BigInt(this.s[2]))),this.s[0]=n.default.asUintN(64,n.default.bitwiseXor(this.s[0],n.default.BigInt(this.s[3]))),this.s[2]=n.default.asUintN(64,n.default.bitwiseXor(this.s[2],n.default.BigInt(f))),this.s[3]=n.default.asUintN(64,a(this.s[3],45)),x}}return xoshiro.default=l,xoshiro}var precomputeAlias=function(e,t){var r=e.reduce(function(p,g){if(g<0)throw new Error("Probability must be a positive: p["+e.indexOf(g)+"]="+g);return p+g},0);if(r===0)throw new Error("Probability sum must be greater than zero.");for(var n=e.map(function(p){return p*t/r}),s={prob:new Array(t),alias:new Array(t)},a=[],l=[],u=t-1;u>=0;u--)n[u]<1?a.push(u):l.push(u);for(;a.length>0&&l.length>0;){var x=a.pop(),f=l.pop();s.prob[x]=n[x],s.alias[x]=f,n[f]=n[f]+n[x]-1,n[f]<1?a.push(f):l.push(f)}for(;l.length>0;)s.prob[l.pop()]=1;for(;a.length>0;)s.prob[a.pop()]=1;return s},draw=function(e,t,r){var n=Math.floor(r()*e.prob.length);return t[r()<e.prob[n]?n:e.alias[n]]},next=function(e,t,r,n){if(n===void 0&&(n=1),n===1)return draw(e,t,r);for(var s=[],a=0;a<n;a++)s.push(draw(e,t,r));return s},sample=function(e,t,r){if(r===void 0&&(r=Math.random),!Array.isArray(e))throw new Error("Probabilities must be an array.");if(e.length===0)throw new Error("Probabilities array must not be empty.");var n=e.length,s=t??Array.from({length:n},function(l,u){return u}),a=precomputeAlias(e,n);return{next:function(l){return l===void 0&&(l=1),next(a,s,r,l)}}};const esm=Object.freeze(Object.defineProperty({__proto__:null,default:sample},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(esm);var hasRequiredFountainUtils;function requireFountainUtils(){return hasRequiredFountainUtils||(hasRequiredFountainUtils=1,(function(e){var t=fountainUtils&&fountainUtils.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(e,"__esModule",{value:!0}),e.chooseFragments=e.shuffle=e.chooseDegree=void 0;const r=requireUtils$7(),n=t(requireXoshiro()),s=t(require$$2),a=(x,f)=>{const p=[...new Array(x)].map((y,w)=>1/(w+1));return s.default(p,void 0,f.nextDouble).next()+1};e.chooseDegree=a;const l=(x,f)=>{let p=[...x],g=[];for(;p.length>0;){let y=f.nextInt(0,p.length-1),w=p[y];p.splice(y,1),g.push(w)}return g};e.shuffle=l;const u=(x,f,p)=>{if(x<=f)return[x-1];{const g=Buffer.concat([r.intToBytes(x),r.intToBytes(p)]),y=new n.default(g),w=e.chooseDegree(f,y),R=[...new Array(f)].map((k,je)=>je);return e.shuffle(R,y).slice(0,w)}};e.chooseFragments=u})(fountainUtils)),fountainUtils}var hasRequiredFountainEncoder;function requireFountainEncoder(){if(hasRequiredFountainEncoder)return fountainEncoder;hasRequiredFountainEncoder=1;var e=fountainEncoder&&fountainEncoder.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(fountainEncoder,"__esModule",{value:!0}),fountainEncoder.FountainEncoderPart=void 0;const t=e(requireAssert()),r=requireUtils$7(),n=requireFountainUtils(),s=requireCbor();class a{constructor(x,f,p,g,y){this._seqNum=x,this._seqLength=f,this._messageLength=p,this._checksum=g,this._fragment=y}get messageLength(){return this._messageLength}get fragment(){return this._fragment}get seqNum(){return this._seqNum}get seqLength(){return this._seqLength}get checksum(){return this._checksum}cbor(){const x=s.cborEncode([this._seqNum,this._seqLength,this._messageLength,this._checksum,this._fragment]);return Buffer.from(x)}description(){return`seqNum:${this._seqNum}, seqLen:${this._seqLength}, messageLen:${this._messageLength}, checksum:${this._checksum}, data:${this._fragment.toString("hex")}`}static fromCBOR(x){const[f,p,g,y,w]=s.cborDecode(x);return t.default(typeof f=="number"),t.default(typeof p=="number"),t.default(typeof g=="number"),t.default(typeof y=="number"),t.default(Buffer.isBuffer(w)&&w.length>0),new a(f,p,g,y,Buffer.from(w))}}fountainEncoder.FountainEncoderPart=a;class l{constructor(x,f=100,p=0,g=10){const y=l.findNominalFragmentLength(x.length,g,f);this._messageLength=x.length,this._fragments=l.partitionMessage(x,y),this.fragmentLength=y,this.seqNum=r.toUint32(p),this.checksum=r.getCRC(x)}get fragmentsLength(){return this._fragments.length}get fragments(){return this._fragments}get messageLength(){return this._messageLength}isComplete(){return this.seqNum>=this._fragments.length}isSinglePart(){return this._fragments.length===1}seqLength(){return this._fragments.length}mix(x){return x.reduce((f,p)=>r.bufferXOR(this._fragments[p],f),Buffer.alloc(this.fragmentLength,0))}nextPart(){this.seqNum=r.toUint32(this.seqNum+1);const x=n.chooseFragments(this.seqNum,this._fragments.length,this.checksum),f=this.mix(x);return new a(this.seqNum,this._fragments.length,this._messageLength,this.checksum,f)}static findNominalFragmentLength(x,f,p){t.default(x>0),t.default(f>0),t.default(p>=f);const g=Math.ceil(x/f);let y=0;for(let w=1;w<=g&&(y=Math.ceil(x/w),!(y<=p));w++);return y}static partitionMessage(x,f){let p=Buffer.from(x),g,y=[];for(;p.length>0;)[g,p]=r.split(p,-f),g=Buffer.alloc(f,0).fill(g,0,g.length),y.push(g);return y}}return fountainEncoder.default=l,fountainEncoder}var bytewords={},hasRequiredBytewords;function requireBytewords(){if(hasRequiredBytewords)return bytewords;hasRequiredBytewords=1;var e=bytewords&&bytewords.__importDefault||function(Ve){return Ve&&Ve.__esModule?Ve:{default:Ve}};Object.defineProperty(bytewords,"__esModule",{value:!0});const t=e(requireAssert()),r=requireUtils$7(),n="ableacidalsoapexaquaarchatomauntawayaxisbackbaldbarnbeltbetabiasbluebodybragbrewbulbbuzzcalmcashcatschefcityclawcodecolacookcostcruxcurlcuspcyandarkdatadaysdelidicedietdoordowndrawdropdrumdulldutyeacheasyechoedgeepicevenexamexiteyesfactfairfernfigsfilmfishfizzflapflewfluxfoxyfreefrogfuelfundgalagamegeargemsgiftgirlglowgoodgraygrimgurugushgyrohalfhanghardhawkheathelphighhillholyhopehornhutsicedideaidleinchinkyintoirisironitemjadejazzjoinjoltjowljudojugsjumpjunkjurykeepkenokeptkeyskickkilnkingkitekiwiknoblamblavalazyleaflegsliarlimplionlistlogoloudloveluaulucklungmainmanymathmazememomenumeowmildmintmissmonknailnavyneednewsnextnoonnotenumbobeyoboeomitonyxopenovalowlspaidpartpeckplaypluspoempoolposepuffpumapurrquadquizraceramprealredorichroadrockroofrubyruinrunsrustsafesagascarsetssilkskewslotsoapsolosongstubsurfswantacotasktaxitenttiedtimetinytoiltombtoystriptunatwinuglyundouniturgeuservastveryvetovialvibeviewvisavoidvowswallwandwarmwaspwavewaxywebswhatwhenwhizwolfworkyankyawnyellyogayurtzapszerozestzinczonezoom";let s=[];const a=256,l=4,u=2;var x;(function(Ve){Ve.STANDARD="standard",Ve.URI="uri",Ve.MINIMAL="minimal"})(x||(x={}));const f=Ve=>n.slice(Ve*l,Ve*l+l),p=Ve=>{const q=f(Ve);return`${q[0]}${q[l-1]}`},g=Ve=>{const q=r.getCRCHex(Buffer.from(Ve,"hex"));return`${Ve}${q}`},y=(Ve,q)=>{const $e=g(Ve);return Buffer.from($e,"hex").reduce((W,Ye)=>[...W,f(Ye)],[]).join(q)},w=Ve=>{const q=g(Ve);return Buffer.from(q,"hex").reduce((K,W)=>K+p(W),"")},R=(Ve,q)=>{t.default(Ve.length===q,"Invalid Bytewords: word.length does not match wordLength provided");const $e=26;if(s.length===0){const Qe=$e*$e;s=[...new Array(Qe)].map(()=>-1);for(let it=0;it<a;it++){const ze=f(it);let v=ze[0].charCodeAt(0)-97,_e=(ze[3].charCodeAt(0)-97)*$e+v;s[_e]=it}}let We=Ve[0].toLowerCase().charCodeAt(0)-97,K=Ve[q==4?3:1].toLowerCase().charCodeAt(0)-97;t.default(0<=We&&We<$e&&0<=K&&K<$e,"Invalid Bytewords: invalid word");let W=K*$e+We,Ye=s[W];if(t.default(Ye!==-1,"Invalid Bytewords: value not in lookup table"),q==l){const Qe=f(Ye);let it=Ve[1].toLowerCase(),ze=Ve[2].toLowerCase();t.default(it===Qe[1]&&ze===Qe[2],"Invalid Bytewords: invalid middle letters of word")}return Buffer.from([Ye]).toString("hex")},I=(Ve,q,$e)=>{const K=($e==l?Ve.split(q):r.partition(Ve,2)).map(it=>R(it,$e)).join("");t.default(K.length>=5,"Invalid Bytewords: invalid decoded string length");const[W,Ye]=r.split(Buffer.from(K,"hex"),4),Qe=r.getCRCHex(W);return t.default(Qe===Ye.toString("hex"),"Invalid Checksum"),W.toString("hex")},k=(Ve,q=x.MINIMAL)=>{switch(q){case x.STANDARD:return I(Ve," ",l);case x.URI:return I(Ve,"-",l);case x.MINIMAL:return I(Ve,"",u);default:throw new Error(`Invalid style ${q}`)}},je=(Ve,q=x.MINIMAL)=>{switch(q){case x.STANDARD:return y(Ve," ");case x.URI:return y(Ve,"-");case x.MINIMAL:return w(Ve);default:throw new Error(`Invalid style ${q}`)}};return bytewords.default={decode:k,encode:je,STYLES:x},bytewords}var hasRequiredUrEncoder;function requireUrEncoder(){if(hasRequiredUrEncoder)return urEncoder;hasRequiredUrEncoder=1;var e=urEncoder&&urEncoder.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(urEncoder,"__esModule",{value:!0});const t=e(requireFountainEncoder()),r=e(requireBytewords());class n{constructor(a,l,u,x){this.ur=a,this.fountainEncoder=new t.default(a.cbor,l,u,x)}get fragmentsLength(){return this.fountainEncoder.fragmentsLength}get fragments(){return this.fountainEncoder.fragments}get messageLength(){return this.fountainEncoder.messageLength}get cbor(){return this.ur.cbor}encodeWhole(){return[...new Array(this.fragmentsLength)].map(()=>this.nextPart())}nextPart(){const a=this.fountainEncoder.nextPart();return this.fountainEncoder.isSinglePart()?n.encodeSinglePart(this.ur):n.encodePart(this.ur.type,a)}static encodeUri(a,l){const u=l.join("/");return[a,u].join(":")}static encodeUR(a){return n.encodeUri("ur",a)}static encodePart(a,l){const u=`${l.seqNum}-${l.seqLength}`,x=r.default.encode(l.cbor().toString("hex"),r.default.STYLES.MINIMAL);return n.encodeUR([a,u,x])}static encodeSinglePart(a){const l=r.default.encode(a.cbor.toString("hex"),r.default.STYLES.MINIMAL);return n.encodeUR([a.type,l])}}return urEncoder.default=n,urEncoder}var urDecoder={},fountainDecoder={},hasRequiredFountainDecoder;function requireFountainDecoder(){if(hasRequiredFountainDecoder)return fountainDecoder;hasRequiredFountainDecoder=1,Object.defineProperty(fountainDecoder,"__esModule",{value:!0}),fountainDecoder.FountainDecoderPart=void 0;const e=requireUtils$7(),t=requireFountainUtils(),r=requireErrors$1();class n{constructor(l,u){this._indexes=l,this._fragment=u}get indexes(){return this._indexes}get fragment(){return this._fragment}static fromEncoderPart(l){const u=t.chooseFragments(l.seqNum,l.seqLength,l.checksum),x=l.fragment;return new n(u,x)}isSimple(){return this.indexes.length===1}}fountainDecoder.FountainDecoderPart=n;class s{constructor(){this.result=void 0,this.expectedMessageLength=0,this.expectedChecksum=0,this.expectedFragmentLength=0,this.processedPartsCount=0,this.expectedPartIndexes=[],this.lastPartIndexes=[],this.queuedParts=[],this.receivedPartIndexes=[],this.mixedParts=[],this.simpleParts=[]}validatePart(l){if(this.expectedPartIndexes.length===0)[...new Array(l.seqLength)].forEach((u,x)=>this.expectedPartIndexes.push(x)),this.expectedMessageLength=l.messageLength,this.expectedChecksum=l.checksum,this.expectedFragmentLength=l.fragment.length;else if(this.expectedPartIndexes.length!==l.seqLength||this.expectedMessageLength!==l.messageLength||this.expectedChecksum!==l.checksum||this.expectedFragmentLength!==l.fragment.length)return!1;return!0}reducePartByPart(l,u){if(e.arrayContains(l.indexes,u.indexes)){const x=e.setDifference(l.indexes,u.indexes),f=e.bufferXOR(l.fragment,u.fragment);return new n(x,f)}else return l}reduceMixedBy(l){const u=[];this.mixedParts.map(({value:x})=>this.reducePartByPart(x,l)).forEach(x=>{x.isSimple()?this.queuedParts.push(x):u.push({key:x.indexes,value:x})}),this.mixedParts=u}processSimplePart(l){const u=l.indexes[0];if(!this.receivedPartIndexes.includes(u))if(this.simpleParts.push({key:l.indexes,value:l}),this.receivedPartIndexes.push(u),e.arraysEqual(this.receivedPartIndexes,this.expectedPartIndexes)){const x=this.simpleParts.map(({value:g})=>g).sort((g,y)=>g.indexes[0]-y.indexes[0]),f=s.joinFragments(x.map(g=>g.fragment),this.expectedMessageLength);e.getCRC(f)===this.expectedChecksum?this.result=f:this.error=new r.InvalidChecksumError}else this.reduceMixedBy(l)}processMixedPart(l){if(this.mixedParts.some(({key:x})=>e.arraysEqual(x,l.indexes)))return;let u=this.simpleParts.reduce((x,{value:f})=>this.reducePartByPart(x,f),l);u=this.mixedParts.reduce((x,{value:f})=>this.reducePartByPart(x,f),u),u.isSimple()?this.queuedParts.push(u):(this.reduceMixedBy(u),this.mixedParts.push({key:u.indexes,value:u}))}processQueuedItem(){if(this.queuedParts.length===0)return;const l=this.queuedParts.shift();l.isSimple()?this.processSimplePart(l):this.processMixedPart(l)}receivePart(l){if(this.isComplete()||!this.validatePart(l))return!1;const u=n.fromEncoderPart(l);for(this.lastPartIndexes=u.indexes,this.queuedParts.push(u);!this.isComplete()&&this.queuedParts.length>0;)this.processQueuedItem();return this.processedPartsCount+=1,!0}isComplete(){return this.result!==void 0&&this.result.length>0}isSuccess(){return!!(this.error===void 0&&this.isComplete())}resultMessage(){return this.isSuccess()?this.result:Buffer.from([])}isFailure(){return this.error!==void 0}resultError(){return this.error?this.error.message:""}expectedPartCount(){return this.expectedPartIndexes.length}getExpectedPartIndexes(){return[...this.expectedPartIndexes]}getReceivedPartIndexes(){return[...this.receivedPartIndexes]}getLastPartIndexes(){return[...this.lastPartIndexes]}estimatedPercentComplete(){if(this.isComplete())return 1;const l=this.expectedPartCount();return l===0?0:Math.min(.99,this.processedPartsCount/(l*1.75))}getProgress(){if(this.isComplete())return 1;const l=this.expectedPartCount();return l===0?0:this.receivedPartIndexes.length/l}}return fountainDecoder.default=s,s.joinFragments=(a,l)=>Buffer.concat(a).slice(0,l),fountainDecoder}var hasRequiredUrDecoder;function requireUrDecoder(){if(hasRequiredUrDecoder)return urDecoder;hasRequiredUrDecoder=1;var e=urDecoder&&urDecoder.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(urDecoder,"__esModule",{value:!0});const t=e(requireFountainDecoder()),r=e(requireBytewords()),n=e(requireAssert()),s=requireUtils$7(),a=requireErrors$1(),l=e(requireUr()),u=requireFountainEncoder();class x{constructor(p=new t.default,g="bytes"){this.fountainDecoder=p,this.type=g,n.default(s.isURType(g),"Invalid UR type"),this.expected_type=""}static decodeBody(p,g){const y=r.default.decode(g,r.default.STYLES.MINIMAL);return new l.default(Buffer.from(y,"hex"),p)}validatePart(p){return this.expected_type?this.expected_type===p:s.isURType(p)?(this.expected_type=p,!0):!1}static decode(p){const[g,y]=this.parse(p);if(y.length===0)throw new a.InvalidPathLengthError;const w=y[0];return x.decodeBody(g,w)}static parse(p){const g=p.toLowerCase();if(g.slice(0,3)!=="ur:")throw new a.InvalidSchemeError;const w=g.slice(3).split("/"),R=w[0];if(w.length<2)throw new a.InvalidPathLengthError;if(!s.isURType(R))throw new a.InvalidTypeError;return[R,w.slice(1)]}static parseSequenceComponent(p){const g=p.split("-");if(g.length!==2)throw new a.InvalidSequenceComponentError;const y=s.toUint32(Number(g[0])),w=Number(g[1]);if(y<1||w<1)throw new a.InvalidSequenceComponentError;return[y,w]}receivePart(p){if(this.result!==void 0)return!1;const[g,y]=x.parse(p);if(!this.validatePart(g))return!1;if(y.length===1)return this.result=x.decodeBody(g,y[0]),!0;if(y.length!==2)throw new a.InvalidPathLengthError;const[w,R]=y,[I,k]=x.parseSequenceComponent(w),je=r.default.decode(R,r.default.STYLES.MINIMAL),Ve=u.FountainEncoderPart.fromCBOR(je);return I!==Ve.seqNum||k!==Ve.seqLength||!this.fountainDecoder.receivePart(Ve)?!1:(this.fountainDecoder.isSuccess()?this.result=new l.default(this.fountainDecoder.resultMessage(),g):this.fountainDecoder.isFailure()&&(this.error=new a.InvalidSchemeError),!0)}resultUR(){return this.result?this.result:new l.default(Buffer.from([]))}isComplete(){return this.result&&this.result.cbor.length>0}isSuccess(){return!this.error&&this.isComplete()}isError(){return this.error!==void 0}resultError(){return this.error?this.error.message:""}expectedPartCount(){return this.fountainDecoder.expectedPartCount()}expectedPartIndexes(){return this.fountainDecoder.getExpectedPartIndexes()}receivedPartIndexes(){return this.fountainDecoder.getReceivedPartIndexes()}lastPartIndexes(){return this.fountainDecoder.getLastPartIndexes()}estimatedPercentComplete(){return this.fountainDecoder.estimatedPercentComplete()}getProgress(){return this.fountainDecoder.getProgress()}}return urDecoder.default=x,urDecoder}var hasRequiredDist$3;function requireDist$3(){if(hasRequiredDist$3)return dist$4;hasRequiredDist$3=1;var e=dist$4&&dist$4.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(dist$4,"__esModule",{value:!0}),dist$4.URDecoder=dist$4.UREncoder=dist$4.UR=void 0;const t=e(requireUr());dist$4.UR=t.default;const r=e(requireUrEncoder());dist$4.UREncoder=r.default;const n=e(requireUrDecoder());return dist$4.URDecoder=n.default,dist$4}var distExports$3=requireDist$3();const AnimatedQRCode=({data:e,type:t="bytes"})=>{const[r,n]=reactExports.useState(""),s=reactExports.useRef(null),a=l=>{const u=l.length;let x;if(u<24)x=Buffer$1.from([64|u]);else if(u<256)x=Buffer$1.from([88,u]);else if(u<65536){const f=Buffer$1.alloc(3);f[0]=89,f.writeUInt16BE(u,1),x=f}else{const f=Buffer$1.alloc(5);f[0]=90,f.writeUInt32BE(u,1),x=f}return Buffer$1.concat([x,l])};return reactExports.useEffect(()=>{const l=Buffer$1.from(e),u=a(l),x=new distExports$3.UREncoder(new distExports$3.UR(u,t),200);s.current=x;const f=setInterval(()=>{s.current&&n(s.current.nextPart())},100);return()=>clearInterval(f)},[e,t]),r?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx("div",{className:"bg-white p-4 rounded-xl",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:r,size:256,level:"L"})}),jsxRuntimeExports.jsx("div",{className:"mt-4 text-center space-y-1",children:(()=>{const l=r.split("/");return l.length>2&&l[1].includes("-")?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"animate-pulse w-2 h-2 rounded-full bg-amber-500"}),jsxRuntimeExports.jsx("p",{className:"text-amber-500 text-xs font-bold uppercase tracking-wider",children:"ANIMATED (FOUNTAIN) QR"})]}):null})()})]}):null},useRequestStore=create(e=>({requests:[],addRequest:t=>e(r=>r.requests.some(n=>n.id===t.id)?r:{requests:[...r.requests,t]}),removeRequest:t=>e(r=>({requests:r.requests.filter(n=>n.id!==t)})),clearRequests:()=>e({requests:[]})}));var lib$1={},types={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0})),types}var ee={},taskCollection$1={},taskCollection={},utils$6={},hasRequiredUtils$6;function requireUtils$6(){if(hasRequiredUtils$6)return utils$6;hasRequiredUtils$6=1,Object.defineProperty(utils$6,"__esModule",{value:!0}),utils$6._fast_remove_single=void 0;function e(t,r){r!==-1&&(r===0?t.shift():r===t.length-1?t.length=t.length-1:t.splice(r,1))}return utils$6._fast_remove_single=e,utils$6}var bakeCollection={},hasRequiredBakeCollection;function requireBakeCollection(){return hasRequiredBakeCollection||(hasRequiredBakeCollection=1,(function(exports$1){Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.bakeCollectionVariadic=exports$1.bakeCollectionAwait=exports$1.bakeCollection=exports$1.BAKED_EMPTY_FUNC=void 0,exports$1.BAKED_EMPTY_FUNC=(function(){});var FORLOOP_FALLBACK=1500;function generateArgsDefCode(e){var t="";if(e===0)return t;for(var r=0;r<e-1;++r)t+="arg"+String(r)+", ";return t+="arg"+String(e-1),t}function generateBodyPartsCode(e,t){for(var r="",n="",s=0;s<t;++s)r+="var f".concat(s," = collection[").concat(s,`];
`),n+="f".concat(s,"(").concat(e,`)
`);return{funcDefCode:r,funcCallCode:n}}function generateBodyPartsVariadicCode(e){for(var t="",r="",n=0;n<e;++n)t+="var f".concat(n," = collection[").concat(n,`];
`),r+="f".concat(n,`.apply(undefined, arguments)
`);return{funcDefCode:t,funcCallCode:r}}function bakeCollection(collection,fixedArgsNum){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                `).concat(funcCallCode,`
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);collection.length%10===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 10) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                        collection[i+4](`).concat(argsDefCode,`);
                        collection[i+5](`).concat(argsDefCode,`);
                        collection[i+6](`).concat(argsDefCode,`);
                        collection[i+7](`).concat(argsDefCode,`);
                        collection[i+8](`).concat(argsDefCode,`);
                        collection[i+9](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%4===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 4) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%3===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 3) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                    }
                });
            })`):funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; ++i) {
                        collection[i](`).concat(argsDefCode,`);
                    }
                });
            })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollection=bakeCollection;function bakeCollectionAwait(collection,fixedArgsNum){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                return Promise.all([ `).concat(funcCallCode,` ]);
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=`(function(collection) {
            return (function(`.concat(argsDefCode,`) {
                var promises = Array(collection.length);
                for (var i = 0; i < collection.length; ++i) {
                    promises[i] = collection[i](`).concat(argsDefCode,`);
                }
                return Promise.all(promises);
            });
        })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollectionAwait=bakeCollectionAwait;function bakeCollectionVariadic(collection){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function() {
                `).concat(funcCallCode,`
            });
        })`)}else funcFactoryCode=`(function(collection) {
            return (function() {
                for (var i = 0; i < collection.length; ++i) {
                    collection[i].apply(undefined, arguments);
                }
            });
        })`;{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollectionVariadic=bakeCollectionVariadic})(bakeCollection)),bakeCollection}var hasRequiredTaskCollection$1;function requireTaskCollection$1(){if(hasRequiredTaskCollection$1)return taskCollection;hasRequiredTaskCollection$1=1;var e=taskCollection&&taskCollection.__spreadArray||function(q,$e,We){if(We||arguments.length===2)for(var K=0,W=$e.length,Ye;K<W;K++)(Ye||!(K in $e))&&(Ye||(Ye=Array.prototype.slice.call($e,0,K)),Ye[K]=$e[K]);return q.concat(Ye||Array.prototype.slice.call($e))};Object.defineProperty(taskCollection,"__esModule",{value:!0}),taskCollection.TaskCollection=void 0;var t=requireUtils$6(),r=requireBakeCollection();function n(q,$e){var We=this.length;if(We>1)if($e){var K;(K=this._tasks).push.apply(K,arguments),this.length+=arguments.length}else this._tasks.push(q),this.length++;else if($e){if(We===1){var W=Array(1+arguments.length);W.push(W),W.push.apply(W,arguments),this._tasks=W}else{var W=Array(arguments.length);W.push.apply(W,arguments),this._tasks=W}this.length+=arguments.length}else We===1?this._tasks=[this._tasks,q]:this._tasks=q,this.length++}function s(q,$e){var We=this.length;if(We>1)if($e){var K;(K=this._tasks).push.apply(K,arguments),this.length+=arguments.length}else this._tasks.push(q),this.length++;else if($e){if(We===1){var W=Array(1+arguments.length);W.push(W),W.push.apply(W,arguments),this._tasks=W}else{var W=Array(arguments.length);W.push.apply(W,arguments),this._tasks=W}this.length+=arguments.length}else We===1?this._tasks=[this._tasks,q]:this._tasks=q,this.length++;this.firstEmitBuildStrategy?this.call=g:this.rebuild()}function a(q){this.length!==0&&(this.length===1?this._tasks===q&&(this.length=0):((0,t._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(q)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function l(q){if(this.length!==0){if(this.length===1)if(this._tasks===q&&(this.length=0),this.firstEmitBuildStrategy){this.call=r.BAKED_EMPTY_FUNC;return}else{this.rebuild();return}else(0,t._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(q)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length;this.firstEmitBuildStrategy?this.call=g:this.rebuild()}}function u(q){for(var $e,We=[],K=1;K<arguments.length;K++)We[K-1]=arguments[K];this.length===0?(this._tasks=We,this.length=1):this.length===1?(We.unshift(this._tasks),this._tasks=We,this.length=this._tasks.length):(($e=this._tasks).splice.apply($e,e([q,0],We,!1)),this.length=this._tasks.length)}function x(q){for(var $e,We=[],K=1;K<arguments.length;K++)We[K-1]=arguments[K];this.length===0?(this._tasks=We,this.length=1):this.length===1?(We.unshift(this._tasks),this._tasks=We,this.length=this._tasks.length):(($e=this._tasks).splice.apply($e,e([q,0],We,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=g:this.rebuild()}function f(){this.length===0?this.call=r.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,r.bakeCollection)(this._tasks,this.argsNum)}function p(){this.length===0?this.call=r.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,r.bakeCollectionAwait)(this._tasks,this.argsNum)}function g(){this.rebuild(),this.call.apply(void 0,arguments)}var y=(function(){function q($e,We,K,W){We===void 0&&(We=!0),K===void 0&&(K=null),W===void 0&&(W=!1),this.awaitTasks=W,this.call=r.BAKED_EMPTY_FUNC,this.argsNum=$e,this.firstEmitBuildStrategy=!0,W?this.rebuild=p.bind(this):this.rebuild=f.bind(this),this.setAutoRebuild(We),K?typeof K=="function"?(this._tasks=K,this.length=1):(this._tasks=K,this.length=K.length):(this._tasks=null,this.length=0),We&&this.rebuild()}return q})();taskCollection.TaskCollection=y;function w(){this._tasks=null,this.length=0,this.call=r.BAKED_EMPTY_FUNC}function R(){this._tasks=null,this.length=0,this.call=r.BAKED_EMPTY_FUNC}function I(q){this.argsNum<q&&(this.argsNum=q,this.firstEmitBuildStrategy?this.call=g:this.rebuild())}function k(q){q?(this.push=s.bind(this),this.insert=x.bind(this),this.removeLast=l.bind(this)):(this.push=n.bind(this),this.insert=u.bind(this),this.removeLast=a.bind(this))}function je(){return this.length===0?[]:this.length===1?[this._tasks]:this._tasks}function Ve(q){q.length===0?(this.length=0,this.call=r.BAKED_EMPTY_FUNC):q.length===1?(this.length=1,this.call=q[0],this._tasks=q[0]):(this.length=q.length,this._tasks=q,this.firstEmitBuildStrategy?this.call=g:this.rebuild())}return y.prototype.fastClear=w,y.prototype.clear=R,y.prototype.growArgsNum=I,y.prototype.setAutoRebuild=k,y.prototype.tasksAsArray=je,y.prototype.setTasks=Ve,taskCollection}var hasRequiredTaskCollection;function requireTaskCollection(){return hasRequiredTaskCollection||(hasRequiredTaskCollection=1,(function(e){var t=taskCollection$1&&taskCollection$1.__createBinding||(Object.create?(function(n,s,a,l){l===void 0&&(l=a);var u=Object.getOwnPropertyDescriptor(s,a);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,l,u)}):(function(n,s,a,l){l===void 0&&(l=a),n[l]=s[a]})),r=taskCollection$1&&taskCollection$1.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(e,"__esModule",{value:!0}),r(requireTaskCollection$1(),e)})(taskCollection$1)),taskCollection$1}var utils$5={},hasRequiredUtils$5;function requireUtils$5(){if(hasRequiredUtils$5)return utils$5;hasRequiredUtils$5=1,Object.defineProperty(utils$5,"__esModule",{value:!0}),utils$5.nullObj=void 0;function e(){var t={};return t.__proto__=null,t}return utils$5.nullObj=e,utils$5}var hasRequiredEe;function requireEe(){if(hasRequiredEe)return ee;hasRequiredEe=1;var e=ee&&ee.__spreadArray||function(We,K,W){if(W||arguments.length===2)for(var Ye=0,Qe=K.length,it;Ye<Qe;Ye++)(it||!(Ye in K))&&(it||(it=Array.prototype.slice.call(K,0,Ye)),it[Ye]=K[Ye]);return We.concat(it||Array.prototype.slice.call(K))};Object.defineProperty(ee,"__esModule",{value:!0}),ee.EventEmitter=void 0;var t=requireTaskCollection(),r=requireUtils$6(),n=requireUtils$5();function s(We,K,W,Ye,Qe,it){var ze=this.events[We];if(ze){if(ze.length===0)return!1;if(ze.argsNum<6)ze.call(K,W,Ye,Qe,it);else{for(var v=new Array(ze.argsNum),D=0,_e=v.length;D<_e;++D)v[D]=arguments[D+1];ze.call.apply(void 0,v)}return!0}return!1}function a(We,K,W,Ye,Qe,it){var ze=this.events[We],v;if(ze!==void 0){if(ze.length===0)return!1;if(ze.argsNum<6)ze.call(K,W,Ye,Qe,it);else{v=new Array(ze.argsNum);for(var D=0,_e=v.length;D<_e;++D)v[D]=arguments[D+1];ze.call.apply(void 0,v)}}var P=this.onceEvents[We];if(P){if(typeof P=="function")if(this.onceEvents[We]=void 0,arguments.length<6)P(K,W,Ye,Qe,it);else{if(v===void 0){v=new Array(arguments.length-1);for(var D=0,_e=v.length;D<_e;++D)v[D]=arguments[D+1]}P.apply(void 0,v)}else{var Re=P;if(this.onceEvents[We]=void 0,arguments.length<6)for(var D=0;D<Re.length;++D)Re[D](K,W,Ye,Qe,it);else{if(v===void 0){v=new Array(arguments.length-1);for(var D=0,_e=v.length;D<_e;++D)v[D]=arguments[D+1]}for(var D=0;D<Re.length;++D)Re[D].apply(void 0,v)}}return!0}return ze!==void 0}var l=(function(){function We(){this.events=(0,n.nullObj)(),this.onceEvents=(0,n.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(We.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),We})();ee.EventEmitter=l;function u(We,K){switch(this.emit===s&&(this.emit=a),typeof this.onceEvents[We]){case"undefined":this.onceEvents[We]=K,typeof We=="symbol"&&this._symbolKeys.add(We);break;case"function":this.onceEvents[We]=[this.onceEvents[We],K];break;case"object":this.onceEvents[We].push(K)}return this}function x(We,K,W){if(W===void 0&&(W=K.length),typeof K!="function")throw new TypeError("The listener must be a function");var Ye=this.events[We];return Ye?(Ye.push(K),Ye.growArgsNum(W),this.maxListeners!==1/0&&this.maxListeners<=Ye.length&&console.warn('Maximum event listeners for "'.concat(String(We),'" event!'))):(this.events[We]=new t.TaskCollection(W,!0,K,!1),typeof We=="symbol"&&this._symbolKeys.add(We)),this}function f(We,K){var W=this.events[We];W&&W.removeLast(K);var Ye=this.onceEvents[We];return Ye&&(typeof Ye=="function"?this.onceEvents[We]=void 0:typeof Ye=="object"&&(Ye.length===1&&Ye[0]===K?this.onceEvents[We]=void 0:(0,r._fast_remove_single)(Ye,Ye.lastIndexOf(K)))),this}function p(We,K,W,Ye){W===void 0&&(W=this),Ye===void 0&&(Ye=K.length),this.boundFuncs||(this.boundFuncs=new Map);var Qe=K.bind(W);return this.boundFuncs.set(K,Qe),this.addListener(We,Qe,Ye)}function g(We,K){var W,Ye,Qe=(W=this.boundFuncs)===null||W===void 0?void 0:W.get(K);return(Ye=this.boundFuncs)===null||Ye===void 0||Ye.delete(K),this.removeListener(We,Qe)}function y(We){return this.events[We]&&!!this.events[We].length}function w(We,K,W){if(W===void 0&&(W=K.length),typeof K!="function")throw new TypeError("The listener must be a function");var Ye=this.events[We];return!Ye||!(Ye instanceof t.TaskCollection)?(Ye=this.events[We]=new t.TaskCollection(W,!0,K,!1),typeof We=="symbol"&&this._symbolKeys.add(We)):(Ye.insert(0,K),Ye.growArgsNum(W),this.maxListeners!==1/0&&this.maxListeners<=Ye.length&&console.warn('Maximum event listeners for "'.concat(String(We),'" event!'))),this}function R(We,K){this.emit===s&&(this.emit=a);var W=this.onceEvents[We];return W?typeof W!="object"?(this.onceEvents[We]=[K,W],typeof We=="symbol"&&this._symbolKeys.add(We)):(W.unshift(K),this.maxListeners!==1/0&&this.maxListeners<=W.length&&console.warn('Maximum event listeners for "'.concat(String(We),'" once event!'))):(this.onceEvents[We]=[K],typeof We=="symbol"&&this._symbolKeys.add(We)),this}function I(We){return We===void 0?(this.events=(0,n.nullObj)(),this.onceEvents=(0,n.nullObj)(),this._symbolKeys=new Set):(this.events[We]=void 0,this.onceEvents[We]=void 0,typeof We=="symbol"&&this._symbolKeys.delete(We)),this}function k(We){return this.maxListeners=We,this}function je(){return this.maxListeners}function Ve(We){return this.emit===s?this.events[We]?this.events[We].tasksAsArray().slice():[]:this.events[We]&&this.onceEvents[We]?e(e([],this.events[We].tasksAsArray(),!0),typeof this.onceEvents[We]=="function"?[this.onceEvents[We]]:this.onceEvents[We],!0):this.events[We]?this.events[We].tasksAsArray():this.onceEvents[We]?typeof this.onceEvents[We]=="function"?[this.onceEvents[We]]:this.onceEvents[We]:[]}function q(){var We=this;if(this.emit===s){var K=Object.keys(this.events);return e(e([],K,!0),Array.from(this._symbolKeys),!0).filter(function(Ye){return Ye in We.events&&We.events[Ye]&&We.events[Ye].length})}else{var K=Object.keys(this.events).filter(function(Qe){return We.events[Qe]&&We.events[Qe].length}),W=Object.keys(this.onceEvents).filter(function(Qe){return We.onceEvents[Qe]&&We.onceEvents[Qe].length});return e(e(e([],K,!0),W,!0),Array.from(this._symbolKeys).filter(function(Qe){return Qe in We.events&&We.events[Qe]&&We.events[Qe].length||Qe in We.onceEvents&&We.onceEvents[Qe]&&We.onceEvents[Qe].length}),!0)}}function $e(We){return this.emit===s?this.events[We]&&this.events[We].length||0:(this.events[We]&&this.events[We].length||0)+(this.onceEvents[We]&&this.onceEvents[We].length||0)}return l.prototype.emit=s,l.prototype.on=x,l.prototype.once=u,l.prototype.addListener=x,l.prototype.removeListener=f,l.prototype.addListenerBound=p,l.prototype.removeListenerBound=g,l.prototype.hasListeners=y,l.prototype.prependListener=w,l.prototype.prependOnceListener=R,l.prototype.off=f,l.prototype.removeAllListeners=I,l.prototype.setMaxListeners=k,l.prototype.getMaxListeners=je,l.prototype.listeners=Ve,l.prototype.eventNames=q,l.prototype.listenerCount=$e,ee}var hasRequiredLib$1;function requireLib$1(){return hasRequiredLib$1||(hasRequiredLib$1=1,(function(e){var t=lib$1&&lib$1.__createBinding||(Object.create?(function(n,s,a,l){l===void 0&&(l=a);var u=Object.getOwnPropertyDescriptor(s,a);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,l,u)}):(function(n,s,a,l){l===void 0&&(l=a),n[l]=s[a]})),r=lib$1&&lib$1.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(e,"__esModule",{value:!0}),r(requireTypes(),e),r(requireEe(),e)})(lib$1)),lib$1}var libExports=requireLib$1(),browser$1={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var e=1e3,t=e*60,r=t*60,n=r*24,s=n*7,a=n*365.25;ms=function(p,g){g=g||{};var y=typeof p;if(y==="string"&&p.length>0)return l(p);if(y==="number"&&isFinite(p))return g.long?x(p):u(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))};function l(p){if(p=String(p),!(p.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(g){var y=parseFloat(g[1]),w=(g[2]||"ms").toLowerCase();switch(w){case"years":case"year":case"yrs":case"yr":case"y":return y*a;case"weeks":case"week":case"w":return y*s;case"days":case"day":case"d":return y*n;case"hours":case"hour":case"hrs":case"hr":case"h":return y*r;case"minutes":case"minute":case"mins":case"min":case"m":return y*t;case"seconds":case"second":case"secs":case"sec":case"s":return y*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return y;default:return}}}}function u(p){var g=Math.abs(p);return g>=n?Math.round(p/n)+"d":g>=r?Math.round(p/r)+"h":g>=t?Math.round(p/t)+"m":g>=e?Math.round(p/e)+"s":p+"ms"}function x(p){var g=Math.abs(p);return g>=n?f(p,g,n,"day"):g>=r?f(p,g,r,"hour"):g>=t?f(p,g,t,"minute"):g>=e?f(p,g,e,"second"):p+" ms"}function f(p,g,y,w){var R=g>=y*1.5;return Math.round(p/y)+" "+w+(R?"s":"")}return ms}var common,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;function e(t){n.debug=n,n.default=n,n.coerce=f,n.disable=u,n.enable=a,n.enabled=x,n.humanize=requireMs(),n.destroy=p,Object.keys(t).forEach(g=>{n[g]=t[g]}),n.names=[],n.skips=[],n.formatters={};function r(g){let y=0;for(let w=0;w<g.length;w++)y=(y<<5)-y+g.charCodeAt(w),y|=0;return n.colors[Math.abs(y)%n.colors.length]}n.selectColor=r;function n(g){let y,w=null,R,I;function k(...je){if(!k.enabled)return;const Ve=k,q=Number(new Date),$e=q-(y||q);Ve.diff=$e,Ve.prev=y,Ve.curr=q,y=q,je[0]=n.coerce(je[0]),typeof je[0]!="string"&&je.unshift("%O");let We=0;je[0]=je[0].replace(/%([a-zA-Z%])/g,(W,Ye)=>{if(W==="%%")return"%";We++;const Qe=n.formatters[Ye];if(typeof Qe=="function"){const it=je[We];W=Qe.call(Ve,it),je.splice(We,1),We--}return W}),n.formatArgs.call(Ve,je),(Ve.log||n.log).apply(Ve,je)}return k.namespace=g,k.useColors=n.useColors(),k.color=n.selectColor(g),k.extend=s,k.destroy=n.destroy,Object.defineProperty(k,"enabled",{enumerable:!0,configurable:!1,get:()=>w!==null?w:(R!==n.namespaces&&(R=n.namespaces,I=n.enabled(g)),I),set:je=>{w=je}}),typeof n.init=="function"&&n.init(k),k}function s(g,y){const w=n(this.namespace+(typeof y>"u"?":":y)+g);return w.log=this.log,w}function a(g){n.save(g),n.namespaces=g,n.names=[],n.skips=[];const y=(typeof g=="string"?g:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const w of y)w[0]==="-"?n.skips.push(w.slice(1)):n.names.push(w)}function l(g,y){let w=0,R=0,I=-1,k=0;for(;w<g.length;)if(R<y.length&&(y[R]===g[w]||y[R]==="*"))y[R]==="*"?(I=R,k=w,R++):(w++,R++);else if(I!==-1)R=I+1,k++,w=k;else return!1;for(;R<y.length&&y[R]==="*";)R++;return R===y.length}function u(){const g=[...n.names,...n.skips.map(y=>"-"+y)].join(",");return n.enable(""),g}function x(g){for(const y of n.skips)if(l(g,y))return!1;for(const y of n.names)if(l(g,y))return!0;return!1}function f(g){return g instanceof Error?g.stack||g.message:g}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return common=e,common}var hasRequiredBrowser$1;function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,(function(e,t){var r={};t.formatArgs=s,t.save=a,t.load=l,t.useColors=n,t.storage=u(),t.destroy=(()=>{let f=!1;return()=>{f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let f;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(f=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(f[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function s(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const p="color: "+this.color;f.splice(1,0,p,"color: inherit");let g=0,y=0;f[0].replace(/%[a-zA-Z%]/g,w=>{w!=="%%"&&(g++,w==="%c"&&(y=g))}),f.splice(y,0,p)}t.log=console.debug||console.log||(()=>{});function a(f){try{f?t.storage.setItem("debug",f):t.storage.removeItem("debug")}catch{}}function l(){let f;try{f=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch{}return!f&&typeof process$1<"u"&&"env"in process$1&&(f=r.DEBUG),f}function u(){try{return localStorage}catch{}}e.exports=requireCommon()(t);const{formatters:x}=e.exports;x.j=function(f){try{return JSON.stringify(f)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}}})(browser$1,browser$1.exports)),browser$1.exports}var browserExports$1=requireBrowser$1();const createDebug5=getDefaultExportFromCjs$1(browserExports$1);var dist$2={},LRUCache={},LRUCacheNode={},hasRequiredLRUCacheNode;function requireLRUCacheNode(){if(hasRequiredLRUCacheNode)return LRUCacheNode;hasRequiredLRUCacheNode=1,Object.defineProperty(LRUCacheNode,"__esModule",{value:!0}),LRUCacheNode.LRUCacheNode=void 0;let e=class{constructor(r,n,s){const{entryExpirationTimeInMS:a=null,next:l=null,prev:u=null,onEntryEvicted:x,onEntryMarkedAsMostRecentlyUsed:f,clone:p,cloneFn:g}=s??{};if(typeof a=="number"&&(a<=0||Number.isNaN(a)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.clone=p??!1,this.cloneFn=g??this.defaultClone,this.key=r,this.internalValue=this.clone?this.cloneFn(n):n,this.created=Date.now(),this.entryExpirationTimeInMS=a,this.next=l,this.prev=u,this.onEntryEvicted=x,this.onEntryMarkedAsMostRecentlyUsed=f}get value(){return this.clone?this.cloneFn(this.internalValue):this.internalValue}get isExpired(){return typeof this.entryExpirationTimeInMS=="number"&&Date.now()-this.created>this.entryExpirationTimeInMS}invokeOnEvicted(){if(this.onEntryEvicted){const{key:r,value:n,isExpired:s}=this;this.onEntryEvicted({key:r,value:n,isExpired:s})}}invokeOnEntryMarkedAsMostRecentlyUsed(){if(this.onEntryMarkedAsMostRecentlyUsed){const{key:r,value:n}=this;this.onEntryMarkedAsMostRecentlyUsed({key:r,value:n})}}defaultClone(r){return typeof r=="boolean"||typeof r=="string"||typeof r=="number"?r:JSON.parse(JSON.stringify(r))}};return LRUCacheNode.LRUCacheNode=e,LRUCacheNode}var hasRequiredLRUCache;function requireLRUCache(){if(hasRequiredLRUCache)return LRUCache;hasRequiredLRUCache=1,Object.defineProperty(LRUCache,"__esModule",{value:!0}),LRUCache.LRUCache=void 0;const e=requireLRUCacheNode();let t=class{constructor(n){this.lookupTable=new Map,this.head=null,this.tail=null;const{maxSize:s=25,entryExpirationTimeInMS:a=null,onEntryEvicted:l,onEntryMarkedAsMostRecentlyUsed:u,cloneFn:x,clone:f}=n??{};if(Number.isNaN(s)||s<=0)throw new Error("maxSize must be greater than 0.");if(typeof a=="number"&&(a<=0||Number.isNaN(a)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.maxSizeInternal=s,this.entryExpirationTimeInMS=a,this.onEntryEvicted=l,this.onEntryMarkedAsMostRecentlyUsed=u,this.clone=f,this.cloneFn=x}get size(){return this.cleanCache(),this.lookupTable.size}get remainingSize(){return this.maxSizeInternal-this.size}get newest(){return this.head?this.head.isExpired?(this.removeNodeFromListAndLookupTable(this.head),this.newest):this.mapNodeToEntry(this.head):null}get oldest(){return this.tail?this.tail.isExpired?(this.removeNodeFromListAndLookupTable(this.tail),this.oldest):this.mapNodeToEntry(this.tail):null}get maxSize(){return this.maxSizeInternal}set maxSize(n){if(Number.isNaN(n)||n<=0)throw new Error("maxSize must be greater than 0.");this.maxSizeInternal=n,this.enforceSizeLimit()}set(n,s,a){const l=this.lookupTable.get(n);l&&this.removeNodeFromListAndLookupTable(l);const u=new e.LRUCacheNode(n,s,{entryExpirationTimeInMS:this.entryExpirationTimeInMS,onEntryEvicted:this.onEntryEvicted,onEntryMarkedAsMostRecentlyUsed:this.onEntryMarkedAsMostRecentlyUsed,clone:this.clone,cloneFn:this.cloneFn,...a});return this.setNodeAsHead(u),this.lookupTable.set(n,u),this.enforceSizeLimit(),this}get(n){const s=this.lookupTable.get(n);return s?s.isExpired?(this.removeNodeFromListAndLookupTable(s),null):(this.setNodeAsHead(s),s.value):null}peek(n){const s=this.lookupTable.get(n);return s?s.isExpired?(this.removeNodeFromListAndLookupTable(s),null):s.value:null}delete(n){const s=this.lookupTable.get(n);return s?this.removeNodeFromListAndLookupTable(s):!1}has(n){const s=this.lookupTable.get(n);return s?s.isExpired?(this.removeNodeFromListAndLookupTable(s),!1):!0:!1}clear(){this.head=null,this.tail=null,this.lookupTable.clear()}find(n){let s=this.head;for(;s;){if(s.isExpired){const l=s.next;this.removeNodeFromListAndLookupTable(s),s=l;continue}const a=this.mapNodeToEntry(s);if(n(a))return this.setNodeAsHead(s),a;s=s.next}return null}forEach(n){let s=this.head,a=0;for(;s;){if(s.isExpired){const l=s.next;this.removeNodeFromListAndLookupTable(s),s=l;continue}n(s.value,s.key,a),s=s.next,a++}}*values(){let n=this.head;for(;n;){if(n.isExpired){const s=n.next;this.removeNodeFromListAndLookupTable(n),n=s;continue}yield n.value,n=n.next}}*keys(){let n=this.head;for(;n;){if(n.isExpired){const s=n.next;this.removeNodeFromListAndLookupTable(n),n=s;continue}yield n.key,n=n.next}}*entries(){let n=this.head;for(;n;){if(n.isExpired){const s=n.next;this.removeNodeFromListAndLookupTable(n),n=s;continue}yield this.mapNodeToEntry(n),n=n.next}}*[Symbol.iterator](){let n=this.head;for(;n;){if(n.isExpired){const s=n.next;this.removeNodeFromListAndLookupTable(n),n=s;continue}yield this.mapNodeToEntry(n),n=n.next}}enforceSizeLimit(){let n=this.tail;for(;n!==null&&this.size>this.maxSizeInternal;){const s=n.prev;this.removeNodeFromListAndLookupTable(n),n=s}}mapNodeToEntry({key:n,value:s}){return{key:n,value:s}}setNodeAsHead(n){this.removeNodeFromList(n),this.head?(n.next=this.head,this.head.prev=n,this.head=n):(this.head=n,this.tail=n),n.invokeOnEntryMarkedAsMostRecentlyUsed()}removeNodeFromList(n){n.prev!==null&&(n.prev.next=n.next),n.next!==null&&(n.next.prev=n.prev),this.head===n&&(this.head=n.next),this.tail===n&&(this.tail=n.prev),n.next=null,n.prev=null}removeNodeFromListAndLookupTable(n){return n.invokeOnEvicted(),this.removeNodeFromList(n),this.lookupTable.delete(n.key)}cleanCache(){if(!this.entryExpirationTimeInMS)return;const n=[];for(const s of this.lookupTable.values())s.isExpired&&n.push(s);n.forEach(s=>this.removeNodeFromListAndLookupTable(s))}};return LRUCache.LRUCache=t,LRUCache}var hasRequiredDist$2;function requireDist$2(){return hasRequiredDist$2||(hasRequiredDist$2=1,(function(e){var t=dist$2&&dist$2.__createBinding||(Object.create?(function(n,s,a,l){l===void 0&&(l=a);var u=Object.getOwnPropertyDescriptor(s,a);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,l,u)}):(function(n,s,a,l){l===void 0&&(l=a),n[l]=s[a]})),r=dist$2&&dist$2.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(e,"__esModule",{value:!0}),r(requireLRUCache(),e)})(dist$2)),dist$2}var distExports$2=requireDist$2();function pbkdf2Init(e,t,r,n){assert$3.hash(e);const s=checkOpts$1({dkLen:32,asyncTick:10},n),{c:a,dkLen:l,asyncTick:u}=s;if(assert$3.number(a),assert$3.number(l),assert$3.number(u),a<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const x=toBytes$1(t),f=toBytes$1(r),p=new Uint8Array(l),g=hmac$1.create(e,x),y=g._cloneInto().update(f);return{c:a,dkLen:l,asyncTick:u,DK:p,PRF:g,PRFSalt:y}}function pbkdf2Output(e,t,r,n,s){return e.destroy(),t.destroy(),n&&n.destroy(),s.fill(0),r}function pbkdf2(e,t,r,n){const{c:s,dkLen:a,DK:l,PRF:u,PRFSalt:x}=pbkdf2Init(e,t,r,n);let f;const p=new Uint8Array(4),g=createView$1(p),y=new Uint8Array(u.outputLen);for(let w=1,R=0;R<a;w++,R+=u.outputLen){const I=l.subarray(R,R+u.outputLen);g.setInt32(0,w,!1),(f=x._cloneInto(f)).update(p).digestInto(y),I.set(y.subarray(0,I.length));for(let k=1;k<s;k++){u._cloneInto(f).update(y).digestInto(y);for(let je=0;je<I.length;je++)I[je]^=y[je]}}return pbkdf2Output(u,x,l,f,y)}const rotl=(e,t)=>e<<t|e>>>32-t;function XorAndSalsa(e,t,r,n,s,a){let l=e[t++]^r[n++],u=e[t++]^r[n++],x=e[t++]^r[n++],f=e[t++]^r[n++],p=e[t++]^r[n++],g=e[t++]^r[n++],y=e[t++]^r[n++],w=e[t++]^r[n++],R=e[t++]^r[n++],I=e[t++]^r[n++],k=e[t++]^r[n++],je=e[t++]^r[n++],Ve=e[t++]^r[n++],q=e[t++]^r[n++],$e=e[t++]^r[n++],We=e[t++]^r[n++],K=l,W=u,Ye=x,Qe=f,it=p,ze=g,v=y,D=w,_e=R,P=I,Re=k,Fe=je,Le=Ve,Ce=q,L=$e,O=We;for(let st=0;st<8;st+=2)it^=rotl(K+Le|0,7),_e^=rotl(it+K|0,9),Le^=rotl(_e+it|0,13),K^=rotl(Le+_e|0,18),P^=rotl(ze+W|0,7),Ce^=rotl(P+ze|0,9),W^=rotl(Ce+P|0,13),ze^=rotl(W+Ce|0,18),L^=rotl(Re+v|0,7),Ye^=rotl(L+Re|0,9),v^=rotl(Ye+L|0,13),Re^=rotl(v+Ye|0,18),Qe^=rotl(O+Fe|0,7),D^=rotl(Qe+O|0,9),Fe^=rotl(D+Qe|0,13),O^=rotl(Fe+D|0,18),W^=rotl(K+Qe|0,7),Ye^=rotl(W+K|0,9),Qe^=rotl(Ye+W|0,13),K^=rotl(Qe+Ye|0,18),v^=rotl(ze+it|0,7),D^=rotl(v+ze|0,9),it^=rotl(D+v|0,13),ze^=rotl(it+D|0,18),Fe^=rotl(Re+P|0,7),_e^=rotl(Fe+Re|0,9),P^=rotl(_e+Fe|0,13),Re^=rotl(P+_e|0,18),Le^=rotl(O+L|0,7),Ce^=rotl(Le+O|0,9),L^=rotl(Ce+Le|0,13),O^=rotl(L+Ce|0,18);s[a++]=l+K|0,s[a++]=u+W|0,s[a++]=x+Ye|0,s[a++]=f+Qe|0,s[a++]=p+it|0,s[a++]=g+ze|0,s[a++]=y+v|0,s[a++]=w+D|0,s[a++]=R+_e|0,s[a++]=I+P|0,s[a++]=k+Re|0,s[a++]=je+Fe|0,s[a++]=Ve+Le|0,s[a++]=q+Ce|0,s[a++]=$e+L|0,s[a++]=We+O|0}function BlockMix(e,t,r,n,s){let a=n+0,l=n+16*s;for(let u=0;u<16;u++)r[l+u]=e[t+(2*s-1)*16+u];for(let u=0;u<s;u++,a+=16,t+=16)XorAndSalsa(r,l,e,t,r,a),u>0&&(l+=16),XorAndSalsa(r,a,e,t+=16,r,l)}function scryptInit(e,t,r){const n=checkOpts$1({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:s,r:a,p:l,dkLen:u,asyncTick:x,maxmem:f,onProgress:p}=n;if(assert$3.number(s),assert$3.number(a),assert$3.number(l),assert$3.number(u),assert$3.number(x),assert$3.number(f),p!==void 0&&typeof p!="function")throw new Error("progressCb should be function");const g=128*a,y=g/4;if(s<=1||(s&s-1)!==0||s>=2**(g/8)||s>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(l<0||l>(2**32-1)*32/g)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(u<0||u>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const w=g*(s+l);if(w>f)throw new Error(`Scrypt: parameters too large, ${w} (128 * r * (N + p)) > ${f} (maxmem)`);const R=pbkdf2(sha256$1,e,t,{c:1,dkLen:g*l}),I=u32$1(R),k=u32$1(new Uint8Array(g*s)),je=u32$1(new Uint8Array(g));let Ve=()=>{};if(p){const q=2*s*l,$e=Math.max(Math.floor(q/1e4),1);let We=0;Ve=()=>{We++,p&&(!(We%$e)||We===q)&&p(We/q)}}return{N:s,r:a,p:l,dkLen:u,blockSize32:y,V:k,B32:I,B:R,tmp:je,blockMixCb:Ve,asyncTick:x}}function scryptOutput(e,t,r,n,s){const a=pbkdf2(sha256$1,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),s.fill(0),a}function scrypt(e,t,r){const{N:n,r:s,p:a,dkLen:l,blockSize32:u,V:x,B32:f,B:p,tmp:g,blockMixCb:y}=scryptInit(e,t,r);for(let w=0;w<a;w++){const R=u*w;for(let I=0;I<u;I++)x[I]=f[R+I];for(let I=0,k=0;I<n-1;I++)BlockMix(x,k,x,k+=u,s),y();BlockMix(x,(n-1)*u,f,R,s),y();for(let I=0;I<n;I++){const k=f[R+u-16]%n;for(let je=0;je<u;je++)g[je]=f[R+je]^x[k*u+je];BlockMix(g,0,f,R,s),y()}}return scryptOutput(e,l,p,x,g)}var Bech32MaxSize$1=5e3;function encodeBech32$1(e,t){let r=bech32$1.toWords(t);return bech32$1.encode(e,r,Bech32MaxSize$1)}function encodeBytes$1(e,t){return encodeBech32$1(e,t)}function encrypt$1(e,t,r=16,n=2){let s=randomBytes(16),a=2**r,l=scrypt(t.normalize("NFKC"),s,{N:a,r:8,p:1,dkLen:32}),u=randomBytes(24),x=Uint8Array.from([n]),p=xchacha20poly1305(l,u,x).encrypt(e),g=concatBytes(Uint8Array.from([2]),Uint8Array.from([r]),s,u,x,p);return encodeBytes$1("ncryptsec",g)}function decrypt$1(e,t){let{prefix:r,words:n}=bech32$1.decode(e,Bech32MaxSize$1);if(r!=="ncryptsec")throw new Error(`invalid prefix ${r}, expected 'ncryptsec'`);let s=new Uint8Array(bech32$1.fromWords(n)),a=s[0];if(a!==2)throw new Error(`invalid version ${a}, expected 0x02`);let u=2**s[1],x=s.slice(2,18),f=s.slice(18,42),p=s[42],g=Uint8Array.from([p]),y=s.slice(43),w=scrypt(t.normalize("NFKC"),x,{N:u,r:8,p:1,dkLen:32});return xchacha20poly1305(w,f,g).decrypt(y)}const nip49_star=Object.freeze(Object.defineProperty({__proto__:null,decrypt:decrypt$1,encrypt:encrypt$1},Symbol.toStringTag,{value:"Module"}));var utf8Decoder=new TextDecoder("utf-8"),utf8Encoder=new TextEncoder,NostrTypeGuard={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},Bech32MaxSize=5e3,BECH32_REGEX$1=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function decodeNostrURI(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),decode$j(e)}catch{return{type:"invalid",data:null}}}function decode$j(e){let{prefix:t,words:r}=bech32$1.decode(e,Bech32MaxSize),n=new Uint8Array(bech32$1.fromWords(r));switch(t){case"nprofile":{let s=parseTLV(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(s[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$1(s[0][0]),relays:s[1]?s[1].map(a=>utf8Decoder.decode(a)):[]}}}case"nevent":{let s=parseTLV(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for nevent");if(s[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(s[2]&&s[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(s[3]&&s[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$1(s[0][0]),relays:s[1]?s[1].map(a=>utf8Decoder.decode(a)):[],author:s[2]?.[0]?bytesToHex$1(s[2][0]):void 0,kind:s[3]?.[0]?parseInt(bytesToHex$1(s[3][0]),16):void 0}}}case"naddr":{let s=parseTLV(n);if(!s[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!s[2]?.[0])throw new Error("missing TLV 2 for naddr");if(s[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!s[3]?.[0])throw new Error("missing TLV 3 for naddr");if(s[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder.decode(s[0][0]),pubkey:bytesToHex$1(s[2][0]),kind:parseInt(bytesToHex$1(s[3][0]),16),relays:s[1]?s[1].map(a=>utf8Decoder.decode(a)):[]}}}case"nsec":return{type:t,data:n};case"npub":case"note":return{type:t,data:bytesToHex$1(n)};default:throw new Error(`unknown prefix ${t}`)}}function parseTLV(e){let t={},r=e;for(;r.length>0;){let n=r[0],s=r[1],a=r.slice(2,2+s);if(r=r.slice(2+s),a.length<s)throw new Error(`not enough data to read on TLV ${n}`);t[n]=t[n]||[],t[n].push(a)}return t}function nsecEncode(e){return encodeBytes("nsec",e)}function npubEncode(e){return encodeBytes("npub",hexToBytes$3(e))}function noteEncode(e){return encodeBytes("note",hexToBytes$3(e))}function encodeBech32(e,t){let r=bech32$1.toWords(t);return bech32$1.encode(e,r,Bech32MaxSize)}function encodeBytes(e,t){return encodeBech32(e,t)}function nprofileEncode(e){let t=encodeTLV({0:[hexToBytes$3(e.pubkey)],1:(e.relays||[]).map(r=>utf8Encoder.encode(r))});return encodeBech32("nprofile",t)}function neventEncode(e){let t;e.kind!==void 0&&(t=integerToUint8Array(e.kind));let r=encodeTLV({0:[hexToBytes$3(e.id)],1:(e.relays||[]).map(n=>utf8Encoder.encode(n)),2:e.author?[hexToBytes$3(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return encodeBech32("nevent",r)}function naddrEncode(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let r=encodeTLV({0:[utf8Encoder.encode(e.identifier)],1:(e.relays||[]).map(n=>utf8Encoder.encode(n)),2:[hexToBytes$3(e.pubkey)],3:[new Uint8Array(t)]});return encodeBech32("naddr",r)}function encodeTLV(e){let t=[];return Object.entries(e).reverse().forEach(([r,n])=>{n.forEach(s=>{let a=new Uint8Array(s.length+2);a.set([parseInt(r)],0),a.set([s.length],1),a.set(s,2),t.push(a)})}),concatBytes(...t)}const nip19_star=Object.freeze(Object.defineProperty({__proto__:null,BECH32_REGEX:BECH32_REGEX$1,Bech32MaxSize,NostrTypeGuard,decode:decode$j,decodeNostrURI,encodeBytes,naddrEncode,neventEncode,noteEncode,nprofileEncode,npubEncode,nsecEncode},Symbol.toStringTag,{value:"Module"}));var lib={},hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0;function t(ze){if(!Number.isSafeInteger(ze))throw new Error(`Wrong integer: ${ze}`)}e.assertNumber=t;function r(...ze){const v=(P,Re)=>Fe=>P(Re(Fe)),D=Array.from(ze).reverse().reduce((P,Re)=>P?v(P,Re.encode):Re.encode,void 0),_e=ze.reduce((P,Re)=>P?v(P,Re.decode):Re.decode,void 0);return{encode:D,decode:_e}}function n(ze){return{encode:v=>{if(!Array.isArray(v)||v.length&&typeof v[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return v.map(D=>{if(t(D),D<0||D>=ze.length)throw new Error(`Digit index outside alphabet: ${D} (alphabet: ${ze.length})`);return ze[D]})},decode:v=>{if(!Array.isArray(v)||v.length&&typeof v[0]!="string")throw new Error("alphabet.decode input should be array of strings");return v.map(D=>{if(typeof D!="string")throw new Error(`alphabet.decode: not string element=${D}`);const _e=ze.indexOf(D);if(_e===-1)throw new Error(`Unknown letter: "${D}". Allowed: ${ze}`);return _e})}}}function s(ze=""){if(typeof ze!="string")throw new Error("join separator should be string");return{encode:v=>{if(!Array.isArray(v)||v.length&&typeof v[0]!="string")throw new Error("join.encode input should be array of strings");for(let D of v)if(typeof D!="string")throw new Error(`join.encode: non-string input=${D}`);return v.join(ze)},decode:v=>{if(typeof v!="string")throw new Error("join.decode input should be string");return v.split(ze)}}}function a(ze,v="="){if(t(ze),typeof v!="string")throw new Error("padding chr should be string");return{encode(D){if(!Array.isArray(D)||D.length&&typeof D[0]!="string")throw new Error("padding.encode input should be array of strings");for(let _e of D)if(typeof _e!="string")throw new Error(`padding.encode: non-string input=${_e}`);for(;D.length*ze%8;)D.push(v);return D},decode(D){if(!Array.isArray(D)||D.length&&typeof D[0]!="string")throw new Error("padding.encode input should be array of strings");for(let P of D)if(typeof P!="string")throw new Error(`padding.decode: non-string input=${P}`);let _e=D.length;if(_e*ze%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;_e>0&&D[_e-1]===v;_e--)if(!((_e-1)*ze%8))throw new Error("Invalid padding: string has too much padding");return D.slice(0,_e)}}}function l(ze){if(typeof ze!="function")throw new Error("normalize fn should be function");return{encode:v=>v,decode:v=>ze(v)}}function u(ze,v,D){if(v<2)throw new Error(`convertRadix: wrong from=${v}, base cannot be less than 2`);if(D<2)throw new Error(`convertRadix: wrong to=${D}, base cannot be less than 2`);if(!Array.isArray(ze))throw new Error("convertRadix: data should be array");if(!ze.length)return[];let _e=0;const P=[],Re=Array.from(ze);for(Re.forEach(Fe=>{if(t(Fe),Fe<0||Fe>=v)throw new Error(`Wrong integer: ${Fe}`)});;){let Fe=0,Le=!0;for(let Ce=_e;Ce<Re.length;Ce++){const L=Re[Ce],O=v*Fe+L;if(!Number.isSafeInteger(O)||v*Fe/v!==Fe||O-L!==v*Fe)throw new Error("convertRadix: carry overflow");if(Fe=O%D,Re[Ce]=Math.floor(O/D),!Number.isSafeInteger(Re[Ce])||Re[Ce]*D+Fe!==O)throw new Error("convertRadix: carry overflow");if(Le)Re[Ce]?Le=!1:_e=Ce;else continue}if(P.push(Fe),Le)break}for(let Fe=0;Fe<ze.length-1&&ze[Fe]===0;Fe++)P.push(0);return P.reverse()}const x=(ze,v)=>v?x(v,ze%v):ze,f=(ze,v)=>ze+(v-x(ze,v));function p(ze,v,D,_e){if(!Array.isArray(ze))throw new Error("convertRadix2: data should be array");if(v<=0||v>32)throw new Error(`convertRadix2: wrong from=${v}`);if(D<=0||D>32)throw new Error(`convertRadix2: wrong to=${D}`);if(f(v,D)>32)throw new Error(`convertRadix2: carry overflow from=${v} to=${D} carryBits=${f(v,D)}`);let P=0,Re=0;const Fe=2**D-1,Le=[];for(const Ce of ze){if(t(Ce),Ce>=2**v)throw new Error(`convertRadix2: invalid data word=${Ce} from=${v}`);if(P=P<<v|Ce,Re+v>32)throw new Error(`convertRadix2: carry overflow pos=${Re} from=${v}`);for(Re+=v;Re>=D;Re-=D)Le.push((P>>Re-D&Fe)>>>0);P&=2**Re-1}if(P=P<<D-Re&Fe,!_e&&Re>=v)throw new Error("Excess padding");if(!_e&&P)throw new Error(`Non-zero padding: ${P}`);return _e&&Re>0&&Le.push(P>>>0),Le}function g(ze){return t(ze),{encode:v=>{if(!(v instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return u(Array.from(v),2**8,ze)},decode:v=>{if(!Array.isArray(v)||v.length&&typeof v[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(u(v,ze,2**8))}}}function y(ze,v=!1){if(t(ze),ze<=0||ze>32)throw new Error("radix2: bits should be in (0..32]");if(f(8,ze)>32||f(ze,8)>32)throw new Error("radix2: carry overflow");return{encode:D=>{if(!(D instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return p(Array.from(D),8,ze,!v)},decode:D=>{if(!Array.isArray(D)||D.length&&typeof D[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(p(D,ze,8,v))}}}function w(ze){if(typeof ze!="function")throw new Error("unsafeWrapper fn should be function");return function(...v){try{return ze.apply(null,v)}catch{}}}function R(ze,v){if(t(ze),typeof v!="function")throw new Error("checksum fn should be function");return{encode(D){if(!(D instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const _e=v(D).slice(0,ze),P=new Uint8Array(D.length+ze);return P.set(D),P.set(_e,D.length),P},decode(D){if(!(D instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const _e=D.slice(0,-ze),P=v(_e).slice(0,ze),Re=D.slice(-ze);for(let Fe=0;Fe<ze;Fe++)if(P[Fe]!==Re[Fe])throw new Error("Invalid checksum");return _e}}}e.utils={alphabet:n,chain:r,checksum:R,radix:g,radix2:y,join:s,padding:a},e.base16=r(y(4),n("0123456789ABCDEF"),s("")),e.base32=r(y(5),n("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),a(5),s("")),e.base32hex=r(y(5),n("0123456789ABCDEFGHIJKLMNOPQRSTUV"),a(5),s("")),e.base32crockford=r(y(5),n("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),s(""),l(ze=>ze.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),e.base64=r(y(6),n("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),a(6),s("")),e.base64url=r(y(6),n("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),a(6),s(""));const I=ze=>r(g(58),n(ze),s(""));e.base58=I("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=I("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=I("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const k=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(ze){let v="";for(let D=0;D<ze.length;D+=8){const _e=ze.subarray(D,D+8);v+=e.base58.encode(_e).padStart(k[_e.length],"1")}return v},decode(ze){let v=[];for(let D=0;D<ze.length;D+=11){const _e=ze.slice(D,D+11),P=k.indexOf(_e.length),Re=e.base58.decode(_e);for(let Fe=0;Fe<Re.length-P;Fe++)if(Re[Fe]!==0)throw new Error("base58xmr: wrong padding");v=v.concat(Array.from(Re.slice(Re.length-P)))}return Uint8Array.from(v)}};const je=ze=>r(R(4,v=>ze(ze(v))),e.base58);e.base58check=je;const Ve=r(n("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),s("")),q=[996825010,642813549,513874426,1027748829,705979059];function $e(ze){const v=ze>>25;let D=(ze&33554431)<<5;for(let _e=0;_e<q.length;_e++)(v>>_e&1)===1&&(D^=q[_e]);return D}function We(ze,v,D=1){const _e=ze.length;let P=1;for(let Re=0;Re<_e;Re++){const Fe=ze.charCodeAt(Re);if(Fe<33||Fe>126)throw new Error(`Invalid prefix (${ze})`);P=$e(P)^Fe>>5}P=$e(P);for(let Re=0;Re<_e;Re++)P=$e(P)^ze.charCodeAt(Re)&31;for(let Re of v)P=$e(P)^Re;for(let Re=0;Re<6;Re++)P=$e(P);return P^=D,Ve.encode(p([P%2**30],30,5,!1))}function K(ze){const v=ze==="bech32"?1:734539939,D=y(5),_e=D.decode,P=D.encode,Re=w(_e);function Fe(O,st,lt=90){if(typeof O!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof O}`);if(!Array.isArray(st)||st.length&&typeof st[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof st}`);const Xe=O.length+7+st.length;if(lt!==!1&&Xe>lt)throw new TypeError(`Length ${Xe} exceeds limit ${lt}`);return O=O.toLowerCase(),`${O}1${Ve.encode(st)}${We(O,st,v)}`}function Le(O,st=90){if(typeof O!="string")throw new Error(`bech32.decode input should be string, not ${typeof O}`);if(O.length<8||st!==!1&&O.length>st)throw new TypeError(`Wrong string length: ${O.length} (${O}). Expected (8..${st})`);const lt=O.toLowerCase();if(O!==lt&&O!==O.toUpperCase())throw new Error("String must be lowercase or uppercase");O=lt;const Xe=O.lastIndexOf("1");if(Xe===0||Xe===-1)throw new Error('Letter "1" must be present between prefix and data only');const dt=O.slice(0,Xe),er=O.slice(Xe+1);if(er.length<6)throw new Error("Data must be at least 6 characters long");const ar=Ve.decode(er).slice(0,-6),dr=We(dt,ar,v);if(!er.endsWith(dr))throw new Error(`Invalid checksum in ${O}: expected "${dr}"`);return{prefix:dt,words:ar}}const Ce=w(Le);function L(O){const{prefix:st,words:lt}=Le(O,!1);return{prefix:st,words:lt,bytes:_e(lt)}}return{encode:Fe,decode:Le,decodeToBytes:L,decodeUnsafe:Ce,fromWords:_e,fromWordsUnsafe:Re,toWords:P}}e.bech32=K("bech32"),e.bech32m=K("bech32m"),e.utf8={encode:ze=>new TextDecoder().decode(ze),decode:ze=>new TextEncoder().encode(ze)},e.hex=r(y(4),n("0123456789abcdef"),s(""),l(ze=>{if(typeof ze!="string"||ze.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof ze} with length ${ze.length}`);return ze.toLowerCase()}));const W={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},Ye=`Invalid encoding type. Available types: ${Object.keys(W).join(", ")}`,Qe=(ze,v)=>{if(typeof ze!="string"||!W.hasOwnProperty(ze))throw new TypeError(Ye);if(!(v instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return W[ze].encode(v)};e.bytesToString=Qe,e.str=e.bytesToString;const it=(ze,v)=>{if(!W.hasOwnProperty(ze))throw new TypeError(Ye);if(typeof v!="string")throw new TypeError("stringToBytes() expects string");return W[ze].decode(v)};e.stringToBytes=it,e.bytes=e.stringToBytes})(lib)),lib}var bolt11,hasRequiredBolt11;function requireBolt11(){if(hasRequiredBolt11)return bolt11;hasRequiredBolt11=1;const{bech32:e,hex:t,utf8:r}=requireLib(),n={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},s={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},a={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},l={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},u={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},x=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],f={m:BigInt(1e3),u:BigInt(1e6),n:BigInt(1e9),p:BigInt(1e12)},p=BigInt("2100000000000000000"),g=BigInt(1e11),y={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},w={};for(let We=0,K=Object.keys(y);We<K.length;We++){const W=K[We],Ye=y[K[We]].toString();w[Ye]=W}const R={1:We=>t.encode(e.fromWordsUnsafe(We)),16:We=>t.encode(e.fromWordsUnsafe(We)),13:We=>r.encode(e.fromWordsUnsafe(We)),19:We=>t.encode(e.fromWordsUnsafe(We)),23:We=>t.encode(e.fromWordsUnsafe(We)),27:We=>t.encode(e.fromWordsUnsafe(We)),6:k,24:k,3:je,5:Ve};function I(We){return K=>({tagCode:parseInt(We),words:e.encode("unknown",K,Number.MAX_SAFE_INTEGER)})}function k(We){return We.reverse().reduce((K,W,Ye)=>K+W*Math.pow(32,Ye),0)}function je(We){const K=[];let W,Ye,Qe,it,ze,v=e.fromWordsUnsafe(We);for(;v.length>0;)W=t.encode(v.slice(0,33)),Ye=t.encode(v.slice(33,41)),Qe=parseInt(t.encode(v.slice(41,45)),16),it=parseInt(t.encode(v.slice(45,49)),16),ze=parseInt(t.encode(v.slice(49,51)),16),v=v.slice(51),K.push({pubkey:W,short_channel_id:Ye,fee_base_msat:Qe,fee_proportional_millionths:it,cltv_expiry_delta:ze});return K}function Ve(We){const K=We.slice().reverse().map(Qe=>[!!(Qe&1),!!(Qe&2),!!(Qe&4),!!(Qe&8),!!(Qe&16)]).reduce((Qe,it)=>Qe.concat(it),[]);for(;K.length<x.length*2;)K.push(!1);const W={};x.forEach((Qe,it)=>{let ze;K[it*2]?ze="required":K[it*2+1]?ze="supported":ze="unsupported",W[Qe]=ze});const Ye=K.slice(x.length*2);return W.extra_bits={start_bit:x.length*2,bits:Ye,has_required:Ye.reduce((Qe,it,ze)=>ze%2!==0?Qe||!1:Qe||it,!1)},W}function q(We,K){let W,Ye;if(We.slice(-1).match(/^[munp]$/))W=We.slice(-1),Ye=We.slice(0,-1);else{if(We.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");Ye=We}if(!Ye.match(/^\d+$/))throw new Error("Not a valid human readable amount");const Qe=BigInt(Ye),it=W?Qe*g/f[W]:Qe*g;if(W==="p"&&Qe%BigInt(10)!==BigInt(0)||it>p)throw new Error("Amount is outside of valid range");return K?it.toString():it}function $e(We,K){if(typeof We!="string")throw new Error("Lightning Payment Request must be string");if(We.slice(0,2).toLowerCase()!=="ln")throw new Error("Not a proper lightning payment request");const W=[],Ye=e.decode(We,Number.MAX_SAFE_INTEGER);We=We.toLowerCase();const Qe=Ye.prefix;let it=Ye.words,ze=We.slice(Qe.length+1),v=it.slice(-104);it=it.slice(0,-104);let D=Qe.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(D&&!D[2]&&(D=Qe.match(/^ln(\S+)$/)),!D)throw new Error("Not a proper lightning payment request");W.push({name:"lightning_network",letters:"ln"});const _e=D[1];let P;if(K){if(K.bech32===void 0||K.pubKeyHash===void 0||K.scriptHash===void 0||!Array.isArray(K.validWitnessVersions))throw new Error("Invalid network");P=K}else switch(_e){case n.bech32:P=n;break;case s.bech32:P=s;break;case a.bech32:P=a;break;case l.bech32:P=l;break;case u.bech32:P=u;break}if(!P||P.bech32!==_e)throw new Error("Unknown coin bech32 prefix");W.push({name:"coin_network",letters:_e,value:P});const Re=D[2];let Fe;if(Re){const dt=D[3];Fe=q(Re+dt,!0),W.push({name:"amount",letters:D[2]+D[3],value:Fe})}else Fe=null;W.push({name:"separator",letters:"1"});const Le=k(it.slice(0,7));it=it.slice(7),W.push({name:"timestamp",letters:ze.slice(0,7),value:Le}),ze=ze.slice(7);let Ce,L,O,st;for(;it.length>0;){const dt=it[0].toString();Ce=w[dt]||"unknown_tag",L=R[dt]||I(dt),it=it.slice(1),O=k(it.slice(0,2)),it=it.slice(2),st=it.slice(0,O),it=it.slice(O),W.push({name:Ce,tag:ze[0],letters:ze.slice(0,3+O),value:L(st)}),ze=ze.slice(3+O)}W.push({name:"signature",letters:ze.slice(0,104),value:t.encode(e.fromWordsUnsafe(v))}),ze=ze.slice(104),W.push({name:"checksum",letters:ze});let lt={paymentRequest:We,sections:W,get expiry(){let dt=W.find(er=>er.name==="expiry");if(dt)return Xe("timestamp")+dt.value},get route_hints(){return W.filter(dt=>dt.name==="route_hint").map(dt=>dt.value)}};for(let dt in y)dt!=="route_hint"&&Object.defineProperty(lt,dt,{get(){return Xe(dt)}});return lt;function Xe(dt){let er=W.find(ar=>ar.name===dt);return er?er.value:void 0}}return bolt11={decode:$e,hrpToMillisat:q},bolt11}requireBolt11();var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__copyProps=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of __getOwnPropNames(t))!__hasOwnProp.call(e,s)&&s!==r&&__defProp(e,s,{get:()=>t[s],enumerable:!(n=__getOwnPropDesc(t,s))||n.enumerable});return e},__reExport=(e,t,r)=>(__copyProps(e,t,"default"),r);function getRelaysForSync(e,t,r="write"){if(!e.outboxTracker)return;const n=e.outboxTracker.data.get(t);if(n)return r==="write"?n.writeRelays:n.readRelays}async function getWriteRelaysFor(e,t,r="write"){if(e.outboxTracker)return e.outboxTracker.data.has(t)||await e.outboxTracker.trackUsers([t]),getRelaysForSync(e,t,r)}function getTopRelaysForAuthors(e,t){const r=new Map;return t.forEach(s=>{const a=getRelaysForSync(e,s);a&&a.forEach(l=>{const u=r.get(l)||0;r.set(l,u+1)})}),Array.from(r.entries()).sort((s,a)=>a[1]-s[1]).map(s=>s[0])}function getAllRelaysForAllPubkeys(e,t,r="read"){const n=new Map,s=new Set;return t.forEach(a=>{const l=getRelaysForSync(e,a,r);l&&l.size>0?(l.forEach(u=>{(n.get(u)||new Set).add(a)}),n.set(a,l)):s.add(a)}),{pubkeysToRelays:n,authorsMissingRelays:s}}function chooseRelayCombinationForPubkeys(e,t,r,{count:n,preferredRelays:s}={}){n??=2,s??=new Set;const a=e.pool,l=a.connectedRelays();l.forEach(y=>{s?.add(y.url)});const u=new Map,{pubkeysToRelays:x,authorsMissingRelays:f}=getAllRelaysForAllPubkeys(e,t,r),p=getTopRelaysForAuthors(e,t),g=(y,w)=>{const R=u.get(w)||[];R.push(y),u.set(w,R)};for(const[y,w]of x.entries()){let R=n;const I=new Set;for(const k of l)w.has(k.url)&&(g(y,k.url),I.add(k.url),R--);for(const k of w)I.has(k)||u.has(k)&&(g(y,k),I.add(k),R--);if(!(R<=0))for(const k of p){if(R<=0)break;I.has(k)||w.has(k)&&(g(y,k),I.add(k),R--)}}for(const y of f)a.permanentAndConnectedRelays().forEach(w=>{const R=u.get(w.url)||[];R.push(y),u.set(w.url,R)});return u}function getRelaysForFilterWithAuthors(e,t,r=2){return chooseRelayCombinationForPubkeys(e,t,"write",{count:r})}function tryNormalizeRelayUrl(e){try{return normalizeRelayUrl(e)}catch{return}}function normalizeRelayUrl(e){let t=normalizeUrl(e,{stripAuthentication:!1,stripWWW:!1,stripHash:!0});return t.endsWith("/")||(t+="/"),t}function normalize(e){const t=new Set;for(const r of e)try{t.add(normalizeRelayUrl(r))}catch{}return Array.from(t)}var DATA_URL_DEFAULT_MIME_TYPE="text/plain",DATA_URL_DEFAULT_CHARSET="us-ascii",testParameter=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),supportedProtocols=new Set(["https:","http:","file:"]),hasCustomProtocol=e=>{try{const{protocol:t}=new URL(e);return t.endsWith(":")&&!t.includes(".")&&!supportedProtocols.has(t)}catch{return!1}},normalizeDataURL=(e,{stripHash:t})=>{const r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);const n=r.groups?.type??"",s=r.groups?.data??"";let a=r.groups?.hash??"";const l=n.split(";");a=t?"":a;let u=!1;l[l.length-1]==="base64"&&(l.pop(),u=!0);const x=l.shift()?.toLowerCase()??"",p=[...l.map(g=>{let[y,w=""]=g.split("=").map(R=>R.trim());return y==="charset"&&(w=w.toLowerCase(),w===DATA_URL_DEFAULT_CHARSET)?"":`${y}${w?`=${w}`:""}`}).filter(Boolean)];return u&&p.push("base64"),(p.length>0||x&&x!==DATA_URL_DEFAULT_MIME_TYPE)&&p.unshift(x),`data:${p.join(";")},${u?s.trim():s}${a?`#${a}`:""}`};function normalizeUrl(e,t={}){if(t={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...t},typeof t.defaultProtocol=="string"&&!t.defaultProtocol.endsWith(":")&&(t.defaultProtocol=`${t.defaultProtocol}:`),e=e.trim(),/^data:/i.test(e))return normalizeDataURL(e,t);if(hasCustomProtocol(e))return e;const r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));const s=new URL(e);if(s.hostname=s.hostname.toLowerCase(),t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&s.protocol==="https:"&&(s.protocol="http:"),t.forceHttps&&s.protocol==="http:"&&(s.protocol="https:"),t.stripAuthentication&&(s.username="",s.password=""),t.stripHash?s.hash="":t.stripTextFragment&&(s.hash=s.hash.replace(/#?:~:text.*?$/i,"")),s.pathname){const l=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let u=0,x="";for(;;){const p=l.exec(s.pathname);if(!p)break;const g=p[0],y=p.index,w=s.pathname.slice(u,y);x+=w.replace(/\/{2,}/g,"/"),x+=g,u=y+g.length}const f=s.pathname.slice(u,s.pathname.length);x+=f.replace(/\/{2,}/g,"/"),s.pathname=x}if(s.pathname)try{s.pathname=decodeURI(s.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let l=s.pathname.split("/");const u=l[l.length-1];testParameter(u,t.removeDirectoryIndex)&&(l=l.slice(0,-1),s.pathname=`${l.slice(1).join("/")}/`)}if(s.hostname&&(s.hostname=s.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(s.hostname)&&(s.hostname=s.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(const l of[...s.searchParams.keys()])testParameter(l,t.removeQueryParameters)&&s.searchParams.delete(l);if(!Array.isArray(t.keepQueryParameters)&&t.removeQueryParameters===!0&&(s.search=""),Array.isArray(t.keepQueryParameters)&&t.keepQueryParameters.length>0)for(const l of[...s.searchParams.keys()])testParameter(l,t.keepQueryParameters)||s.searchParams.delete(l);if(t.sortQueryParameters){s.searchParams.sort();try{s.search=decodeURIComponent(s.search)}catch{}}t.removeTrailingSlash&&(s.pathname=s.pathname.replace(/\/$/,"")),t.removeExplicitPort&&s.port&&(s.port="");const a=e;return e=s.toString(),!t.removeSingleSlash&&s.pathname==="/"&&!a.endsWith("/")&&s.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||s.pathname==="/")&&s.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var NDKRelayKeepalive=class{constructor(e=3e4,t){this.onSilenceDetected=t,this.timeout=e}lastActivity=Date.now();timer;timeout;isRunning=!1;recordActivity(){this.lastActivity=Date.now(),this.isRunning&&this.resetTimer()}start(){this.isRunning||(this.isRunning=!0,this.lastActivity=Date.now(),this.resetTimer())}stop(){this.isRunning=!1,this.timer&&(clearTimeout(this.timer),this.timer=void 0)}resetTimer(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{const e=Date.now()-this.lastActivity;if(e>=this.timeout)this.onSilenceDetected();else{const t=this.timeout-e;this.timer=setTimeout(()=>{this.onSilenceDetected()},t)}},this.timeout)}};async function probeRelayConnection(e){const t=`probe-${Math.random().toString(36).substring(7)}`;return new Promise(r=>{let n=!1;const s=setTimeout(()=>{n||(n=!0,e.send(["CLOSE",t]),r(!1))},5e3),a=()=>{n||(n=!0,clearTimeout(s),e.send(["CLOSE",t]),r(!0))};e.once("message",a),e.send(["REQ",t,{kinds:[99999],limit:0}])})}var MAX_RECONNECT_ATTEMPTS=5,FLAPPING_THRESHOLD_MS=1e3,NDKRelayConnectivity=class{ndkRelay;ws;_status;timeoutMs;connectedAt;_connectionStats={attempts:0,success:0,durations:[]};debug;netDebug;connectTimeout;reconnectTimeout;ndk;openSubs=new Map;openCountRequests=new Map;openEventPublishes=new Map;pendingAuthPublishes=new Map;serial=0;baseEoseTimeout=4400;keepalive;wsStateMonitor;sleepDetector;lastSleepCheck=Date.now();lastMessageSent=Date.now();wasIdle=!1;constructor(e,t){this.ndkRelay=e,this._status=1;const r=Math.floor(Math.random()*1e3);this.debug=this.ndkRelay.debug.extend(`connectivity${r}`),this.ndk=t,this.setupMonitoring()}setupMonitoring(){this.keepalive=new NDKRelayKeepalive(12e4,async()=>{this.debug("Relay silence detected, probing connection"),await probeRelayConnection({send:t=>this.send(JSON.stringify(t)),once:(t,r)=>{const n=s=>{try{const a=JSON.parse(s.data);(a[0]==="EOSE"||a[0]==="EVENT"||a[0]==="NOTICE")&&(r(),this.ws?.removeEventListener("message",n))}catch{}};this.ws?.addEventListener("message",n)}})||(this.debug("Probe failed, connection is stale"),this.handleStaleConnection())}),this.wsStateMonitor=setInterval(()=>{this._status===5&&(!this.ws||this.ws.readyState!==WebSocket.OPEN)&&(this.debug("WebSocket died silently, reconnecting"),this.handleStaleConnection())},5e3),this.sleepDetector=setInterval(()=>{const e=Date.now(),t=e-this.lastSleepCheck;t>15e3&&(this.debug(`Detected possible sleep/wake (${t}ms gap)`),this.handlePossibleWake()),this.lastSleepCheck=e},1e4)}handleStaleConnection(){this._status=1,this.wasIdle=!0,this.onDisconnect()}handlePossibleWake(){this.debug("System wake detected, checking all connections"),this.wasIdle=!0,this._status>=5&&(!this.ws||this.ws.readyState!==WebSocket.OPEN?this.handleStaleConnection():probeRelayConnection({send:e=>this.send(JSON.stringify(e)),once:(e,t)=>{const r=n=>{try{const s=JSON.parse(n.data);(s[0]==="EOSE"||s[0]==="EVENT"||s[0]==="NOTICE")&&(t(),this.ws?.removeEventListener("message",r))}catch{}};this.ws?.addEventListener("message",r)}}).then(e=>{e||this.handleStaleConnection()}))}resetReconnectionState(){this.wasIdle=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}async connect(e,t=!0){if(this.ws&&this.ws.readyState!==WebSocket.OPEN&&this.ws.readyState!==WebSocket.CONNECTING){this.debug("Cleaning up stale WebSocket connection");try{this.ws.close()}catch{}this.ws=void 0,this._status=1}if(this._status!==2&&this._status!==1||this.reconnectTimeout){this.debug("Relay requested to be connected but was in state %s or it had a reconnect timeout",this._status);return}this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),e??=this.timeoutMs,!this.timeoutMs&&e&&(this.timeoutMs=e),this.timeoutMs&&(this.connectTimeout=setTimeout(()=>this.onConnectionError(t),this.timeoutMs));try{this.updateConnectionStats.attempt(),this._status===1?this._status=4:this._status=2,this.ws=new WebSocket(this.ndkRelay.url),this.ws.onopen=this.onConnect.bind(this),this.ws.onclose=this.onDisconnect.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onerror=this.onError.bind(this)}catch(r){throw this.debug(`Failed to connect to ${this.ndkRelay.url}`,r),this._status=1,t?this.handleReconnection():this.ndkRelay.emit("delayed-connect",2880*60*1e3),r}}disconnect(){this._status=0,this.keepalive?.stop(),this.wsStateMonitor&&(clearInterval(this.wsStateMonitor),this.wsStateMonitor=void 0),this.sleepDetector&&(clearInterval(this.sleepDetector),this.sleepDetector=void 0);try{this.ws?.close()}catch(e){this.debug("Failed to disconnect",e),this._status=1}}onConnectionError(e){this.debug(`Error connecting to ${this.ndkRelay.url}`,this.timeoutMs),e&&!this.reconnectTimeout&&this.handleReconnection()}onConnect(){this.netDebug?.("connected",this.ndkRelay),this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.updateConnectionStats.connected(),this._status=5,this.keepalive?.start(),this.wasIdle=!1,this.ndkRelay.emit("connect"),this.ndkRelay.emit("ready")}onDisconnect(){this.netDebug?.("disconnected",this.ndkRelay),this.updateConnectionStats.disconnected(),this.keepalive?.stop(),this.clearPendingPublishes(new Error(`Relay ${this.ndkRelay.url} disconnected`)),this._status===5&&this.handleReconnection(),this._status=1,this.ndkRelay.emit("disconnect")}onMessage(e){this.netDebug?.(e.data,this.ndkRelay,"recv"),this.keepalive?.recordActivity();try{const t=JSON.parse(e.data),[r,n,...s]=t,a=this.ndkRelay.getProtocolHandler(r);if(a){a(this.ndkRelay,t);return}switch(r){case"EVENT":{const l=this.openSubs.get(n),u=t[2];if(!l){this.debug(`Received event for unknown subscription ${n}`);return}l.onevent(u);return}case"COUNT":{const l=t[2],u=this.openCountRequests.get(n);u&&(u.resolve(l.count),this.openCountRequests.delete(n));return}case"EOSE":{const l=this.openSubs.get(n);if(!l)return;l.oneose(n);return}case"OK":{const l=t[2],u=t[3],x=this.openEventPublishes.get(n),f=x?.pop();if(!x||!f){this.debug("Received OK for unknown event publish",n);return}l?(f.resolve(u),this.pendingAuthPublishes.delete(n)):u&&(u.toLowerCase().includes("auth-required")||u.toLowerCase().includes("not authorized")||u.toLowerCase().includes("blocked: not authorized"))?this.pendingAuthPublishes.get(n)?(this.debug("Publish failed due to auth-required, will retry after auth",n),x.push(f),this.openEventPublishes.set(n,x)):f.reject(new Error(u)):(f.reject(new Error(u)),this.pendingAuthPublishes.delete(n)),x.length===0?this.openEventPublishes.delete(n):!l&&!(u?.toLowerCase().includes("auth-required")||u?.toLowerCase().includes("not authorized")||u?.toLowerCase().includes("blocked: not authorized"))&&this.openEventPublishes.set(n,x);return}case"CLOSED":{const l=this.openSubs.get(n);if(!l)return;l.onclosed(t[2]);return}case"NOTICE":this.onNotice(t[1]);return;case"AUTH":{this.onAuthRequested(t[1]);return}}}catch(t){this.debug(`Error parsing message from ${this.ndkRelay.url}: ${t.message}`,t?.stack);return}}async onAuthRequested(e){const t=this.ndkRelay.authPolicy??this.ndk?.relayAuthDefaultPolicy;if(this.debug("Relay requested authentication",{havePolicy:!!t}),this._status===7){this.debug("Already authenticating, ignoring");return}if(this._status=6,t){if(this._status>=5){this._status=7;let r;try{r=await t(this.ndkRelay,e)}catch(n){this.debug("Authentication policy threw an error",n),r=!1}if(this.debug("Authentication policy returned",!!r),r instanceof NDKEvent||r===!0){r instanceof NDKEvent&&await this.auth(r);const n=async()=>{if(this._status>=5&&this._status<8){const s=new NDKEvent(this.ndk);s.kind=22242,s.tags=[["relay",this.ndkRelay.url],["challenge",e]],await s.sign(),this.auth(s).then(()=>{this._status=8,this.ndkRelay.emit("authed"),this.debug("Authentication successful"),this.retryPendingAuthPublishes()}).catch(a=>{this._status=6,this.ndkRelay.emit("auth:failed",a),this.debug("Authentication failed",a),this.rejectPendingAuthPublishes(a)})}else this.debug("Authentication failed, it changed status, status is %d",this._status)};r===!0&&(this.ndk?.signer?n().catch(s=>{console.error("Error authenticating",s)}):(this.debug("No signer available for authentication localhost"),this.ndk?.once("signer:ready",n))),this._status=5,this.ndkRelay.emit("authed")}}}else this.ndkRelay.emit("auth",e)}onError(e){this.debug(`WebSocket error on ${this.ndkRelay.url}:`,e)}get status(){return this._status}isAvailable(){return this._status===5}isFlapping(){const e=this._connectionStats.durations;if(e.length%3!==0)return!1;const r=e.reduce((l,u)=>l+u,0)/e.length,n=e.map(l=>(l-r)**2).reduce((l,u)=>l+u,0)/e.length;return Math.sqrt(n)<FLAPPING_THRESHOLD_MS}async onNotice(e){this.ndkRelay.emit("notice",e)}handleReconnection(e=0){if(this.reconnectTimeout)return;if(this.isFlapping()){this.ndkRelay.emit("flapping",this._connectionStats),this._status=3;return}let t;if(this.wasIdle){const r=[0,1e3,2e3,5e3,1e4,3e4];t=r[Math.min(e,r.length-1)],this.debug(`Using aggressive reconnect after idle, attempt ${e}, delay ${t}ms`)}else this.connectedAt?t=Math.max(0,6e4-(Date.now()-this.connectedAt)):(t=Math.min(1e3*2**e,3e4),this.debug(`Using standard backoff, attempt ${e}, delay ${t}ms`));this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=void 0,this._status=2,this.connect().catch(r=>{e<MAX_RECONNECT_ATTEMPTS?this.handleReconnection(e+1):(this.debug("Max reconnect attempts reached"),this.wasIdle=!1)})},t),this.ndkRelay.emit("delayed-connect",t),this.debug("Reconnecting in",t),this._connectionStats.nextReconnectAt=Date.now()+t}async send(e){Date.now()-this.lastMessageSent>12e4&&(this.wasIdle=!0),this._status>=5&&this.ws?.readyState===WebSocket.OPEN?(this.ws?.send(e),this.netDebug?.(e,this.ndkRelay,"send"),this.lastMessageSent=Date.now()):(this.debug(`Not connected to ${this.ndkRelay.url} (%d), not sending message ${e}`,this._status),this._status>=5&&this.ws?.readyState!==WebSocket.OPEN&&(this.debug(`Stale connection detected, WebSocket state: ${this.ws?.readyState}`),this.handleStaleConnection()))}async auth(e){const t=new Promise((r,n)=>{const s=this.openEventPublishes.get(e.id)??[];s.push({resolve:r,reject:n}),this.openEventPublishes.set(e.id,s)});return this.send(`["AUTH",${JSON.stringify(e.rawEvent())}]`),t}clearPendingPublishes(e){this.rejectPendingAuthPublishes(e);for(const[t,r]of this.openEventPublishes.entries()){for(;r.length>0;){const n=r.shift();n&&n.reject(e)}this.openEventPublishes.delete(t)}}retryPendingAuthPublishes(){if(this.pendingAuthPublishes.size!==0){this.debug(`Retrying ${this.pendingAuthPublishes.size} pending publishes after auth`);for(const[e,t]of this.pendingAuthPublishes.entries())this.debug(`Retrying publish for event ${e}`),this.send(`["EVENT",${JSON.stringify(t)}]`);this.pendingAuthPublishes.clear()}}rejectPendingAuthPublishes(e){if(this.pendingAuthPublishes.size!==0){this.debug(`Rejecting ${this.pendingAuthPublishes.size} pending publishes due to auth failure`);for(const[t]of this.pendingAuthPublishes.entries()){const r=this.openEventPublishes.get(t);if(r&&r.length>0){const n=r.pop();n&&n.reject(new Error(`Authentication failed: ${e.message}`)),r.length===0&&this.openEventPublishes.delete(t)}}this.pendingAuthPublishes.clear()}}async publish(e){const t=new Promise((r,n)=>{const s=this.openEventPublishes.get(e.id)??[];s.length>0&&console.warn(`Duplicate event publishing detected, you are publishing event ${e.id} twice`),s.push({resolve:r,reject:n}),this.openEventPublishes.set(e.id,s)});return this.pendingAuthPublishes.set(e.id,e),this.send(`["EVENT",${JSON.stringify(e)}]`),t}async count(e,t){this.serial++;const r=t?.id||`count:${this.serial}`,n=new Promise((s,a)=>{this.openCountRequests.set(r,{resolve:s,reject:a})});return this.send(`["COUNT","${r}",${JSON.stringify(e).substring(1)}`),n}close(e,t){this.send(`["CLOSE","${e}"]`);const r=this.openSubs.get(e);this.openSubs.delete(e),r&&r.onclose(t)}req(e){`${this.send(`["REQ","${e.subId}",${JSON.stringify(e.executeFilters).substring(1)}`)}`,this.openSubs.set(e.subId,e)}updateConnectionStats={connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++,this._connectionStats.connectedAt=Date.now()}};get connectionStats(){return this._connectionStats}get url(){return this.ndkRelay.url}get connected(){return this._status>=5&&this.ws?.readyState===WebSocket.OPEN}};async function fetchRelayInformation(e){const t=e.replace(/^wss:\/\//,"https://").replace(/^ws:\/\//,"http://"),r=await fetch(t,{headers:{Accept:"application/nostr+json"}});if(!r.ok)throw new Error(`Failed to fetch relay information: ${r.status} ${r.statusText}`);return await r.json()}var NDKRelayPublisher=class{ndkRelay;debug;constructor(e){this.ndkRelay=e,this.debug=e.debug.extend("publisher")}async publish(e,t=2500){let r;const n=()=>new Promise((p,g)=>{try{this.publishEvent(e).then(y=>{this.ndkRelay.emit("published",e),e.emit("relay:published",this.ndkRelay),p(!0)}).catch(g)}catch(y){g(y)}}),s=new Promise((p,g)=>{r=setTimeout(()=>{r=void 0,g(new Error(`Timeout: ${t}ms`))},t)}),a=()=>{n().then(p=>l(p)).catch(p=>u(p))};let l,u;const x=p=>{throw this.ndkRelay.debug("Publish failed",p,e.id),this.ndkRelay.emit("publish:failed",e,p),e.emit("relay:publish:failed",this.ndkRelay,p),p},f=()=>{r&&clearTimeout(r),this.ndkRelay.removeListener("connect",a)};return this.ndkRelay.status>=5?Promise.race([n(),s]).catch(x).finally(f):(this.ndkRelay.status<=1?(console.warn("Relay is disconnected, trying to connect to publish an event",this.ndkRelay.url),this.ndkRelay.connect()):console.warn("Relay not connected, waiting for connection to publish an event",this.ndkRelay.url),Promise.race([new Promise((p,g)=>{l=p,u=g,this.ndkRelay.on("connect",a)}),s]).catch(x).finally(f))}async publishEvent(e){return this.ndkRelay.connectivity.publish(e.rawEvent())}};function filterFingerprint(e,t){const r=[];for(const s of e){const a=Object.entries(s||{}).map(([l,u])=>["since","until"].includes(l)?`${l}:${u}`:l).sort().join("-");r.push(a)}let n=t?"+":"";return n+=r.join("|"),n}function mergeFilters(e){const t=[],r={};return e.filter(n=>!!n.limit).forEach(n=>t.push(n)),e=e.filter(n=>!n.limit),e.length===0?t:(e.forEach(n=>{Object.entries(n).forEach(([s,a])=>{Array.isArray(a)?r[s]===void 0?r[s]=[...a]:r[s]=Array.from(new Set([...r[s],...a])):r[s]=a})}),[...t,r])}var MAX_ITEMS=3;function formatArray(e,t){const n=(t?e.slice(0,MAX_ITEMS).map(t):e.slice(0,MAX_ITEMS)).join(",");return e.length>MAX_ITEMS?`${n}+${e.length-MAX_ITEMS}`:n}function formatFilters(e){return e.map(t=>{const r=[];t.ids?.length&&r.push(`ids:[${formatArray(t.ids,n=>String(n).slice(0,8))}]`),t.kinds?.length&&r.push(`kinds:[${formatArray(t.kinds)}]`),t.authors?.length&&r.push(`authors:[${formatArray(t.authors,n=>String(n).slice(0,8))}]`),t.since&&r.push(`since:${t.since}`),t.until&&r.push(`until:${t.until}`),t.limit&&r.push(`limit:${t.limit}`),t.search&&r.push(`search:"${String(t.search).slice(0,20)}"`);for(const[n,s]of Object.entries(t))n.startsWith("#")&&Array.isArray(s)&&s.length>0&&r.push(`${n}:[${formatArray(s,a=>String(a).slice(0,8))}]`);return`{${r.join(" ")}}`}).join(", ")}var NDKRelaySubscription=class{fingerprint;items=new Map;topSubManager;debug;status=0;onClose;relay;eosed=!1;executionTimer;fireTime;delayType;executeFilters;id=Math.random().toString(36).substring(7);constructor(e,t,r){this.relay=e,this.topSubManager=r,this.debug=e.debug.extend(`sub[${this.id}]`),this.fingerprint=t||Math.random().toString(36).substring(7)}_subId;get subId(){return this._subId?this._subId:(this._subId=this.fingerprint.slice(0,15),this._subId)}subIdParts=new Set;addSubIdPart(e){this.subIdParts.add(e)}addItem(e,t){if(this.debug("Adding item",{filters:formatFilters(t),internalId:e.internalId,status:this.status,fingerprint:this.fingerprint,id:this.subId,itemsSize:this.items.size}),!this.items.has(e.internalId))switch(e.on("close",this.removeItem.bind(this,e)),this.items.set(e.internalId,{subscription:e,filters:t}),this.status!==3&&e.subId&&(!this._subId||this._subId.length<25)&&(this.status===0||this.status===1)&&this.addSubIdPart(e.subId),this.status){case 0:this.evaluateExecutionPlan(e);break;case 3:break;case 1:this.evaluateExecutionPlan(e);break;case 4:throw this.debug("Subscription is closed, cannot add new items",{filters:formatFilters(t),subId:e.subId,internalId:e.internalId}),new Error("Cannot add new items to a closed subscription")}}removeItem(e){if(this.items.delete(e.internalId),this.items.size===0){if(!this.eosed)return;this.close(),this.cleanup()}}close(){if(this.status===4)return;const e=this.status;if(this.status=4,e===3)try{this.relay.close(this.subId)}catch(t){this.debug("Error closing subscription",t,this)}else this.debug("Subscription wanted to close but it wasn't running, this is probably ok",{subId:this.subId,prevStatus:e,sub:this});this.cleanup()}cleanup(){this.executionTimer&&clearTimeout(this.executionTimer),this.relay.off("ready",this.executeOnRelayReady),this.relay.off("authed",this.reExecuteAfterAuth),this.onClose&&this.onClose(this)}evaluateExecutionPlan(e){if(!e.isGroupable()){this.status=1,this.execute();return}if(e.filters.find(n=>!!n.limit)&&(this.executeFilters=this.compileFilters(),this.executeFilters.length>=10)){this.status=1,this.execute();return}const t=e.groupableDelay,r=e.groupableDelayType;if(!t)throw new Error("Cannot group a subscription without a delay");if(this.status===0)this.schedule(t,r);else{const n=this.delayType,s=this.fireTime-Date.now();if(n==="at-least"&&r==="at-least")s<t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,r));else if(n==="at-least"&&r==="at-most")s>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,r));else if(n==="at-most"&&r==="at-most")s>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,r));else if(n==="at-most"&&r==="at-least")s>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,r));else throw new Error(`Unknown delay type combination ${n} ${r}`)}}schedule(e,t){this.status=1;const r=Date.now();this.fireTime=r+e,this.delayType=t;const n=setTimeout(this.execute.bind(this),e);t==="at-least"&&(this.executionTimer=n)}executeOnRelayReady=()=>{if(this.status===2){if(this.items.size===0){this.debug("No items to execute; this relay was probably too slow to respond and the caller gave up",{status:this.status,fingerprint:this.fingerprint,id:this.id,subId:this.subId}),this.cleanup();return}this.debug("Executing on relay ready",{status:this.status,fingerprint:this.fingerprint,itemsSize:this.items.size,filters:formatFilters(this.compileFilters())}),this.status=1,this.execute()}};finalizeSubId(){if(this.subIdParts.size>0){let t=Array.from(this.subIdParts).map(r=>r.substring(0,10)).join("-");t.length>20&&(t=t.substring(0,20)),this._subId=t}else this._subId=this.fingerprint.slice(0,15);this._subId+=`-${Math.random().toString(36).substring(2,7)}`}reExecuteAfterAuth=(()=>{const e=this.subId;this.debug("Re-executing after auth",this.items.size),this.eosed?this.relay.close(this.subId):this.debug("We are abandoning an opened subscription, once it EOSE's, the handler will close it",{oldSubId:e}),this._subId=void 0,this.status=1,this.execute(),this.debug("Re-executed after auth %s  %s",e,this.subId)}).bind(this);execute(){if(this.status===1){if(!this.relay.connected){this.status=2,this.debug("Waiting for relay to be ready",{status:this.status,id:this.subId,fingerprint:this.fingerprint,itemsSize:this.items.size}),this.relay.once("ready",this.executeOnRelayReady);return}this.relay.status<8&&this.relay.once("authed",this.reExecuteAfterAuth),this.status=3,this.finalizeSubId(),this.executeFilters=this.compileFilters(),this.relay.req(this)}}onstart(){}onevent(e){this.topSubManager.dispatchEvent(e,this.relay)}oneose(e){if(this.eosed=!0,e!==this.subId){this.debug("Received EOSE for an abandoned subscription",e,this.subId),this.relay.close(e);return}this.items.size===0&&this.close();for(const{subscription:t}of this.items.values())t.eoseReceived(this.relay),t.closeOnEose&&(this.debug("Removing item because of EOSE",{filters:formatFilters(t.filters),internalId:t.internalId,status:this.status,fingerprint:this.fingerprint,itemsSize:this.items.size}),this.removeItem(t))}onclose(e){this.status=4}onclosed(e){if(e)for(const{subscription:t}of this.items.values())t.closedReceived(this.relay,e)}compileFilters(){const e=[],t=Array.from(this.items.values()).map(n=>n.filters);if(!t[0])return this.debug(" No filters to merge",{itemsSize:this.items.size}),[];const r=t[0].length;for(let n=0;n<r;n++){const s=t.map(l=>l[n]),a=mergeFilters(s);e.push(...a)}return e}},NDKRelaySubscriptionManager=class{relay;subscriptions;generalSubManager;constructor(e,t){this.relay=e,this.subscriptions=new Map,this.generalSubManager=t}addSubscription(e,t){let r;if(!e.isGroupable())r=this.createSubscription(e,t);else{const n=filterFingerprint(t,e.closeOnEose);n&&(r=(this.subscriptions.get(n)||[]).find(a=>a.status<3)),r??=this.createSubscription(e,t,n)}r.addItem(e,t)}createSubscription(e,t,r){const n=new NDKRelaySubscription(this.relay,r||null,this.generalSubManager);n.onClose=this.onRelaySubscriptionClose.bind(this);const s=this.subscriptions.get(n.fingerprint)??[];return this.subscriptions.set(n.fingerprint,[...s,n]),n}onRelaySubscriptionClose(e){let t=this.subscriptions.get(e.fingerprint)??[];t?t.length===1?this.subscriptions.delete(e.fingerprint):(t=t.filter(r=>r.id!==e.id),this.subscriptions.set(e.fingerprint,t)):console.warn("Unexpectedly did not find a subscription with fingerprint",e.fingerprint)}},NDKRelayStatus=(e=>(e[e.DISCONNECTING=0]="DISCONNECTING",e[e.DISCONNECTED=1]="DISCONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.FLAPPING=3]="FLAPPING",e[e.CONNECTING=4]="CONNECTING",e[e.CONNECTED=5]="CONNECTED",e[e.AUTH_REQUESTED=6]="AUTH_REQUESTED",e[e.AUTHENTICATING=7]="AUTHENTICATING",e[e.AUTHENTICATED=8]="AUTHENTICATED",e))(NDKRelayStatus||{}),NDKRelay=class Dd extends libExports.EventEmitter{url;scores;connectivity;subs;publisher;authPolicy;protocolHandlers=new Map;_relayInfo;lowestValidationRatio;targetValidationRatio;validationRatioFn;validatedEventCount=0;nonValidatedEventCount=0;trusted=!1;complaining=!1;debug;static defaultValidationRatioUpdateFn=(t,r,n)=>{if(t.lowestValidationRatio===void 0||t.targetValidationRatio===void 0)return 1;let s=t.validationRatio;if(t.validationRatio>t.targetValidationRatio){const a=r/100;s=Math.max(t.lowestValidationRatio,t.validationRatio-a)}return s<t.validationRatio?s:t.validationRatio};constructor(t,r,n){super(),this.url=normalizeRelayUrl(t),this.scores=new Map,this.debug=createDebug5(`ndk:relay:${t}`),this.connectivity=new NDKRelayConnectivity(this,n),this.connectivity.netDebug=n?.netDebug,this.req=this.connectivity.req.bind(this.connectivity),this.close=this.connectivity.close.bind(this.connectivity),this.subs=new NDKRelaySubscriptionManager(this,n.subManager),this.publisher=new NDKRelayPublisher(this),this.authPolicy=r,this.targetValidationRatio=n?.initialValidationRatio,this.lowestValidationRatio=n?.lowestValidationRatio,this.validationRatioFn=(n?.validationRatioFn??Dd.defaultValidationRatioUpdateFn).bind(this),this.updateValidationRatio(),n||console.trace("relay created without ndk")}updateValidationRatio(){if(this.validationRatioFn&&this.validatedEventCount>0){const t=this.validationRatioFn(this,this.validatedEventCount,this.nonValidatedEventCount);this.targetValidationRatio=t}setTimeout(()=>{this.updateValidationRatio()},3e4)}get status(){return this.connectivity.status}get connectionStats(){return this.connectivity.connectionStats}async connect(t,r=!0){return this.connectivity.connect(t,r)}disconnect(){this.status!==1&&this.connectivity.disconnect()}subscribe(t,r){this.subs.addSubscription(t,r)}async publish(t,r=2500){return this.publisher.publish(t,r)}referenceTags(){return[["r",this.url]]}addValidatedEvent(){this.validatedEventCount++}addNonValidatedEvent(){this.nonValidatedEventCount++}get validationRatio(){return this.nonValidatedEventCount===0?1:this.validatedEventCount/(this.validatedEventCount+this.nonValidatedEventCount)}shouldValidateEvent(){return this.trusted?!1:this.targetValidationRatio===void 0||this.targetValidationRatio>=1?!0:Math.random()<this.targetValidationRatio}get connected(){return this.connectivity.connected}req;close;registerProtocolHandler(t,r){this.protocolHandlers.set(t,r)}unregisterProtocolHandler(t){this.protocolHandlers.delete(t)}getProtocolHandler(t){return this.protocolHandlers.get(t)}async fetchInfo(t=!1){const n=this.connectivity.ndk;if(!t&&n?.cacheAdapter?.getRelayStatus){const s=await n.cacheAdapter.getRelayStatus(this.url);if(s?.nip11&&Date.now()-s.nip11.fetchedAt<864e5)return this._relayInfo=s.nip11.data,s.nip11.data}return!t&&this._relayInfo?this._relayInfo:(this._relayInfo=await fetchRelayInformation(this.url),n?.cacheAdapter?.updateRelayStatus&&await n.cacheAdapter.updateRelayStatus(this.url,{nip11:{data:this._relayInfo,fetchedAt:Date.now()}}),this._relayInfo)}get info(){return this._relayInfo}},NDKPublishError=class extends Error{errors;publishedToRelays;intendedRelaySet;constructor(e,t,r,n){super(e),this.errors=t,this.publishedToRelays=r,this.intendedRelaySet=n}get relayErrors(){const e=[];for(const[t,r]of this.errors)e.push(`${t.url}: ${r}`);return e.join(`
`)}},NDKRelaySet=class Nd{relays;debug;ndk;pool;constructor(t,r,n){this.relays=t,this.ndk=r,this.pool=n??r.pool,this.debug=r.debug.extend("relayset")}addRelay(t){this.relays.add(t)}get relayUrls(){return Array.from(this.relays).map(t=>t.url)}static fromRelayUrls(t,r,n=!0,s){if(s=s??r.pool,!s)throw new Error("No pool provided");const a=new Set;for(const l of t){const u=s.relays.get(normalizeRelayUrl(l));if(u)u.status<5&&n&&u.connect(),a.add(u);else{const x=new NDKRelay(normalizeRelayUrl(l),r?.relayAuthDefaultPolicy,r);s.useTemporaryRelay(x,void 0,`requested from fromRelayUrls ${t}`),a.add(x)}}return new Nd(new Set(a),r,s)}async publish(t,r,n=1){const s=new Set,a=new Map,l=t.isEphemeral();t.publishStatus="pending";const u=x=>{s.add(x)};t.on("relay:published",u);try{const x=Array.from(this.relays).map(f=>new Promise(p=>{const g=r?setTimeout(()=>{s.has(f)||(a.set(f,new Error(`Publish timeout after ${r}ms`)),p(!1))},r):null;f.publish(t,r).then(y=>{g&&clearTimeout(g),y?(s.add(f),p(!0)):p(!1)}).catch(y=>{g&&clearTimeout(g),l||a.set(f,y),p(!1)})}));if(await Promise.all(x),s.size<n){if(!l){const f=new NDKPublishError("Not enough relays received the event ("+s.size+" published, "+n+" required)",a,s,this);throw t.publishStatus="error",t.publishError=f,this.ndk?.emit("event:publish-failed",t,f,this.relayUrls),f}}else t.publishStatus="success",t.emit("published",{relaySet:this,publishedToRelays:s});return s}finally{t.off("relay:published",u)}}get size(){return this.relays.size}},d=createDebug5("ndk:outbox:calculate");async function calculateRelaySetFromEvent(e,t,r){const n=new Set,s=await getWriteRelaysFor(e,t.pubkey);s&&s.forEach(u=>{const x=e.pool?.getRelay(u);x&&n.add(x)});let a=t.tags.filter(u=>["a","e"].includes(u[0])).map(u=>u[2]).filter(u=>u?.startsWith("wss://")).filter(u=>{try{return new URL(u),!0}catch{return!1}}).map(u=>normalizeRelayUrl(u));a=Array.from(new Set(a)).slice(0,5),a.forEach(u=>{const x=e.pool?.getRelay(u,!0,!0);x&&(d("Adding relay hint %s",u),n.add(x))});const l=t.getMatchingTags("p").map(u=>u[1]);return l.length<5?Array.from(chooseRelayCombinationForPubkeys(e,l,"read",{preferredRelays:new Set(s)}).keys()).forEach(x=>{const f=e.pool?.getRelay(x,!1,!0);f&&(d("Adding p-tagged relay %s",x),n.add(f))}):d("Too many p-tags to consider %d",l.length),e.pool?.permanentAndConnectedRelays().forEach(u=>n.add(u)),r&&n.size<r&&e.explicitRelayUrls?.filter(x=>!Array.from(n).some(f=>f.url===x)).slice(0,r-n.size)?.forEach(x=>{const f=e.pool?.getRelay(x,!1,!0);f&&(d("Adding explicit relay %s",x),n.add(f))}),new NDKRelaySet(n,e)}function calculateRelaySetsFromFilter(e,t,r,n){const s=new Map,a=new Set;if(t.forEach(l=>{l.authors&&l.authors.forEach(u=>a.add(u))}),a.size>0){const l=getRelaysForFilterWithAuthors(e,Array.from(a),n);for(const u of l.keys())s.set(u,[]);for(const u of t)if(u.authors)for(const[x,f]of l.entries()){const p=u.authors.filter(g=>f.includes(g));s.set(x,[...s.get(x),{...u,authors:p}])}else for(const x of l.keys())s.set(x,[...s.get(x),u])}else e.explicitRelayUrls&&e.explicitRelayUrls.forEach(l=>{s.set(l,t)});return s.size===0&&r.permanentAndConnectedRelays().slice(0,5).forEach(l=>{s.set(l.url,t)}),s}function calculateRelaySetsFromFilters(e,t,r,n){return calculateRelaySetsFromFilter(e,t,r,n)}function isValidHex64(e){if(typeof e!="string"||e.length!==64)return!1;for(let t=0;t<64;t++){const r=e.charCodeAt(t);if(!(r>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70))return!1}return!0}function isValidPubkey(e){return isValidHex64(e)}function isValidNip05(e){if(typeof e!="string")return!1;for(let t=0;t<e.length;t++)if(e.charCodeAt(t)===46)return!0;return!1}function mergeTags(e,t){const r=new Map,n=l=>l.join(","),s=(l,u)=>l.every((x,f)=>x===u[f]),a=l=>{for(const[u,x]of r)if(s(x,l)||s(l,x)){l.length>=x.length&&r.set(u,l);return}r.set(n(l),l)};return e.concat(t).forEach(a),Array.from(r.values())}var hashtagRegex=new RegExp(`(?<=\\s|^)(#[^\\s!@#$%^&*()=+./,[{\\]};:'"?><]+)`,"g");function generateHashtags(e){const t=e.match(hashtagRegex),r=new Set,n=new Set;if(t)for(const s of t)r.has(s.slice(1))||(n.add(s.slice(1)),r.add(s.slice(1)));return Array.from(n)}async function generateContentTags(e,t=[],r,n){if(r?.skipContentTagging)return{content:e,tags:t};const s=/(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g,a=[],l=u=>{t.find(x=>["q",u[0]].includes(x[0])&&x[1]===u[1])||t.push(u)};if(e=e.replace(s,u=>{try{const x=u.split(/(@|nostr:)/)[2],{type:f,data:p}=nip19_exports$1.decode(x);let g;if(r?.filters){const y=!r.filters.includeTypes||r.filters.includeTypes.includes(f),w=r.filters.excludeTypes?.includes(f);if(!y||w)return u}switch(f){case"npub":r?.pTags!==!1&&(g=["p",p]);break;case"nprofile":r?.pTags!==!1&&(g=["p",p.pubkey]);break;case"note":a.push(new Promise(async y=>{const w=await maybeGetEventRelayUrl(x);l(["q",p,w]),y()}));break;case"nevent":a.push(new Promise(async y=>{const{id:w,author:R}=p;let{relays:I}=p;(!I||I.length===0)&&(I=[await maybeGetEventRelayUrl(x)]),l(["q",w,I[0]]),R&&r?.pTags!==!1&&r?.pTagOnQTags!==!1&&l(["p",R]),y()}));break;case"naddr":a.push(new Promise(async y=>{const w=[p.kind,p.pubkey,p.identifier].join(":");let R=p.relays??[];R.length===0&&(R=[await maybeGetEventRelayUrl(x)]),l(["q",w,R[0]]),r?.pTags!==!1&&r?.pTagOnQTags!==!1&&r?.pTagOnATags!==!1&&l(["p",p.pubkey]),y()}));break;default:return u}return g&&l(g),`nostr:${x}`}catch{return u}}),await Promise.all(a),!r?.filters?.excludeTypes?.includes("hashtag")){const u=generateHashtags(e).map(x=>["t",x]);t=mergeTags(t,u)}if(r?.pTags!==!1&&r?.copyPTagsFromTarget&&n){const u=n.getMatchingTags("p");for(const x of u)!x[1]||!isValidPubkey(x[1])||t.find(f=>f[0]==="p"&&f[1]===x[1])||t.push(x)}return{content:e,tags:t}}async function maybeGetEventRelayUrl(e){return""}async function encrypt(e,t,r="nip44"){let n;if(!this.ndk)throw new Error("No NDK instance found!");let s=t;if(s||(this.ndk.assertSigner(),s=this.ndk.signer),!s)throw new Error("no NDK signer");const a=e||(()=>{const l=this.getMatchingTags("p");if(l.length!==1)throw new Error("No recipient could be determined and no explicit recipient was provided");return this.ndk.getUser({pubkey:l[0][1]})})();if(r==="nip44"&&await isEncryptionEnabled(s,"nip44")&&(n=await s.encrypt(a,this.content,"nip44")),(!n||r==="nip04")&&await isEncryptionEnabled(s,"nip04")&&(n=await s.encrypt(a,this.content,"nip04")),!n)throw new Error("Failed to encrypt event.");this.content=n}async function decrypt(e,t,r){if(this.ndk?.cacheAdapter?.getDecryptedEvent){const u=await this.ndk.cacheAdapter.getDecryptedEvent(this.id);if(u){this.content=u.content;return}}let n;if(!this.ndk)throw new Error("No NDK instance found!");let s=t;if(s||(this.ndk.assertSigner(),s=this.ndk.signer),!s)throw new Error("no NDK signer");const a=e||this.author;if(!a)throw new Error("No sender provided and no author available");const l=r||(this.content.match(/\\?iv=/)?"nip04":"nip44");if((l==="nip04"||this.kind===4)&&await isEncryptionEnabled(s,"nip04")&&this.content.search("\\?iv=")&&(n=await s.decrypt(a,this.content,"nip04")),!n&&l==="nip44"&&await isEncryptionEnabled(s,"nip44")&&(n=await s.decrypt(a,this.content,"nip44")),!n)throw new Error("Failed to decrypt event.");this.content=n,this.ndk?.cacheAdapter?.addDecryptedEvent&&this.ndk.cacheAdapter.addDecryptedEvent(this.id,this)}async function isEncryptionEnabled(e,t){return e.encryptionEnabled?t?!!await e.encryptionEnabled(t):!0:!1}function eventHasETagMarkers(e){for(const t of e.tags)if(t[0]==="e"&&(t[3]??"").length>0)return!0;return!1}function getRootTag(e,t){t??=e.tagType();const r=e.tags.find(isTagRootTag);if(!r){if(eventHasETagMarkers(e))return;const n=e.getMatchingTags(t);if(n.length<3)return n[0]}return r}var nip22RootTags=new Set(["A","E","I"]),nip22ReplyTags=new Set(["a","e","i"]);function getReplyTag(e,t){if(e.kind===1111){let s;for(const a of e.tags)if(nip22RootTags.has(a[0]))s=a;else if(nip22ReplyTags.has(a[0])){s=a;break}return s}t??=e.tagType();let r=!1,n;for(const s of e.tags)if(s[0]===t){if((s[3]??"").length>0&&(r=!0),r&&s[3]==="reply")return s;r&&s[3]==="root"&&(n=s),r||(n=s)}return n}function isTagRootTag(e){return e[0]==="E"||e[3]==="root"}async function fetchTaggedEvent(e,t){if(!this.ndk)throw new Error("NDK instance not found");const r=this.getMatchingTags(e,t);if(r.length===0)return;const[n,s,a]=r[0],l=a!==""?this.ndk.pool.getRelay(a):void 0;return await this.ndk.fetchEvent(s,{},l)}async function fetchRootEvent(e){if(!this.ndk)throw new Error("NDK instance not found");const t=getRootTag(this);if(t)return this.ndk.fetchEventFromTag(t,this,e)}async function fetchReplyEvent(e){if(!this.ndk)throw new Error("NDK instance not found");const t=getReplyTag(this);if(t)return this.ndk.fetchEventFromTag(t,this,e)}function isReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return[0,3].includes(this.kind)||this.kind>=1e4&&this.kind<2e4||this.kind>=3e4&&this.kind<4e4}function isEphemeral(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=2e4&&this.kind<3e4}function isParamReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}var DEFAULT_RELAY_COUNT=2;function encode$k(e=DEFAULT_RELAY_COUNT){let t=[];return this.onRelays.length>0?t=this.onRelays.map(r=>r.url):this.relay&&(t=[this.relay.url]),t.length>e&&(t=t.slice(0,e)),this.isParamReplaceable()?nip19_exports$1.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag(),relays:t}):t.length>0?nip19_exports$1.neventEncode({id:this.tagId(),relays:t,author:this.pubkey}):nip19_exports$1.noteEncode(this.tagId())}async function repost(e=!0,t){if(!t&&e){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),t=this.ndk.signer}const r=new NDKEvent(this.ndk,{kind:getKind(this)});return this.isProtected||(r.content=JSON.stringify(this.rawEvent())),r.tag(this),this.kind!==1&&r.tags.push(["k",`${this.kind}`]),t&&await r.sign(t),e&&await r.publish(),r}function getKind(e){return e.kind===1?6:16}function getEventDetails(e){return"inspect"in e&&typeof e.inspect=="string"?e.inspect:JSON.stringify(e)}function validateForSerialization(e){if(typeof e.kind!="number")throw new Error(`Can't serialize event with invalid properties: kind (must be number, got ${typeof e.kind}). Event: ${getEventDetails(e)}`);if(typeof e.content!="string")throw new Error(`Can't serialize event with invalid properties: content (must be string, got ${typeof e.content}). Event: ${getEventDetails(e)}`);if(typeof e.created_at!="number")throw new Error(`Can't serialize event with invalid properties: created_at (must be number, got ${typeof e.created_at}). Event: ${getEventDetails(e)}`);if(typeof e.pubkey!="string")throw new Error(`Can't serialize event with invalid properties: pubkey (must be string, got ${typeof e.pubkey}). Event: ${getEventDetails(e)}`);if(!Array.isArray(e.tags))throw new Error(`Can't serialize event with invalid properties: tags (must be array, got ${typeof e.tags}). Event: ${getEventDetails(e)}`);for(let t=0;t<e.tags.length;t++){const r=e.tags[t];if(!Array.isArray(r))throw new Error(`Can't serialize event with invalid properties: tags[${t}] (must be array, got ${typeof r}). Event: ${getEventDetails(e)}`);for(let n=0;n<r.length;n++)if(typeof r[n]!="string")throw new Error(`Can't serialize event with invalid properties: tags[${t}][${n}] (must be string, got ${typeof r[n]}). Event: ${getEventDetails(e)}`)}}function serialize(e=!1,t=!1){validateForSerialization(this);const r=[0,this.pubkey,this.created_at,this.kind,this.tags,this.content];return e&&r.push(this.sig),t&&r.push(this.id),JSON.stringify(r)}function deserialize(e){const t=JSON.parse(e),r={pubkey:t[1],created_at:t[2],kind:t[3],tags:t[4],content:t[5]};if(t.length>=7){const n=t[6],s=t[7];n&&n.length===128?(r.sig=n,s&&s.length===64&&(r.id=s)):n&&n.length===64&&(r.id=n,s&&s.length===128&&(r.sig=s))}return r}var worker,processingQueue={};function signatureVerificationInit(e){worker=e,worker.onmessage=t=>{if(!Array.isArray(t.data)||t.data.length!==2){console.error("[NDK]  Signature verification worker received incompatible message format.",`

 Expected format: [eventId, boolean]`,`
 Received:`,t.data,`

 This likely means:`,`
  1. You have a STALE worker.js file that needs updating`,`
  2. Version mismatch between @nostr-dev-kit/ndk and deployed worker`,`
  3. Wrong worker is being used for signature verification`,`

 Solution: Update your worker files:`,`
  cp node_modules/@nostr-dev-kit/ndk/dist/workers/sig-verification.js public/`,`
  cp node_modules/@nostr-dev-kit/cache-sqlite-wasm/dist/worker.js public/`,`

 Or use Vite/bundler imports instead of static files:`,`
  import SigWorker from "@nostr-dev-kit/ndk/workers/sig-verification?worker"`);return}const[r,n]=t.data,s=processingQueue[r];if(!s){console.error("No record found for event",r);return}delete processingQueue[r];for(const a of s.resolves)a(n)}}async function verifySignatureAsync(e,t,r){const n=e.ndk,s=Date.now();let a;return n.signatureVerificationFunction?a=await n.signatureVerificationFunction(e):a=await new Promise(l=>{const u=e.serialize();let x=!1;processingQueue[e.id]||(processingQueue[e.id]={event:e,resolves:[],relay:r},x=!0),processingQueue[e.id].resolves.push(l),x&&worker?.postMessage({serialized:u,id:e.id,sig:e.sig,pubkey:e.pubkey})}),n.signatureVerificationTimeMs+=Date.now()-s,a}var PUBKEY_REGEX=/^[a-f0-9]{64}$/;function validate(){if(typeof this.kind!="number"||typeof this.content!="string"||typeof this.created_at!="number"||typeof this.pubkey!="string"||!this.pubkey.match(PUBKEY_REGEX)||!Array.isArray(this.tags))return!1;for(let e=0;e<this.tags.length;e++){const t=this.tags[e];if(!Array.isArray(t))return!1;for(let r=0;r<t.length;r++)if(typeof t[r]=="object")return!1}return!0}var verifiedSignatures=new distExports$2.LRUCache({maxSize:1e3,entryExpirationTimeInMS:6e4});function verifySignature(e){if(typeof this.signatureVerified=="boolean")return this.signatureVerified;const t=verifiedSignatures.get(this.id);if(t!==null)return this.signatureVerified=!!t,this.signatureVerified;try{if(this.ndk?.asyncSigVerification){const r=this.relay;verifySignatureAsync(this,e,r).then(n=>{e&&(this.signatureVerified=n,n&&verifiedSignatures.set(this.id,this.sig)),n?r&&r.addValidatedEvent():(r?this.ndk?.reportInvalidSignature(this,r):this.ndk?.reportInvalidSignature(this),verifiedSignatures.set(this.id,!1))}).catch(n=>{console.error("signature verification error",this.id,n)})}else{const r=sha256$5(new TextEncoder().encode(this.serialize())),n=schnorr$1.verify(this.sig,r,this.pubkey);return n?verifiedSignatures.set(this.id,this.sig):verifiedSignatures.set(this.id,!1),this.signatureVerified=n,n}}catch{return this.signatureVerified=!1,!1}}function getEventHash(){return getEventHashFromSerializedEvent(this.serialize())}function getEventHashFromSerializedEvent(e){const t=sha256$5(new TextEncoder().encode(e));return bytesToHex$5(t)}var skipClientTagOnKinds=new Set([0,4,1059,13,3,9734,5]),NDKEvent=class Hi extends libExports.EventEmitter{ndk;created_at;content="";tags=[];kind;id="";sig;pubkey="";signatureVerified;_author=void 0;relay;get onRelays(){let t=[];return this.ndk?t=this.ndk.subManager.seenEvents.get(this.id)||[]:this.relay&&t.push(this.relay),t}publishStatus="success";publishError;constructor(t,r){super(),this.ndk=t,this.created_at=r?.created_at,this.content=r?.content||"",this.tags=r?.tags||[],this.id=r?.id||"",this.sig=r?.sig,this.pubkey=r?.pubkey||"",this.kind=r?.kind,r instanceof Hi&&(this.relay&&(this.relay=r.relay,this.ndk?.subManager.seenEvent(r.id,this.relay)),this.publishStatus=r.publishStatus,this.publishError=r.publishError)}static deserialize(t,r){return new Hi(t,deserialize(r))}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author(t){this.pubkey=t.pubkey,this._author=t,this._author.ndk??=this.ndk}get author(){if(this._author)return this._author;if(!this.ndk)throw new Error("No NDK instance found");const t=this.ndk.getUser({pubkey:this.pubkey});return this._author=t,t}tagExternal(t,r,n){const s=["i"],a=["k"];switch(r){case"url":{const l=new URL(t);l.hash="",s.push(l.toString()),a.push(`${l.protocol}//${l.host}`);break}case"hashtag":s.push(`#${t.toLowerCase()}`),a.push("#");break;case"geohash":s.push(`geo:${t.toLowerCase()}`),a.push("geo");break;case"isbn":s.push(`isbn:${t.replace(/-/g,"")}`),a.push("isbn");break;case"podcast:guid":s.push(`podcast:guid:${t}`),a.push("podcast:guid");break;case"podcast:item:guid":s.push(`podcast:item:guid:${t}`),a.push("podcast:item:guid");break;case"podcast:publisher:guid":s.push(`podcast:publisher:guid:${t}`),a.push("podcast:publisher:guid");break;case"isan":s.push(`isan:${t.split("-").slice(0,4).join("-")}`),a.push("isan");break;case"doi":s.push(`doi:${t.toLowerCase()}`),a.push("doi");break;default:throw new Error(`Unsupported NIP-73 entity type: ${r}`)}n&&s.push(n),this.tags.push(s),this.tags.push(a)}tag(t,r,n,s,a){let l=[];if(t.fetchProfile!==void 0){if(s??="p",s==="p"&&a?.pTags===!1)return;const x=[s,t.pubkey];r&&x.push("",r),l.push(x)}else if(t instanceof Hi){const x=t;if(n??=x?.pubkey===this.pubkey,l=x.referenceTags(r,n,s,a),a?.pTags!==!1)for(const f of x.getMatchingTags("p"))!f[1]||!isValidPubkey(f[1])||f[1]!==this.pubkey&&(this.tags.find(p=>p[0]==="p"&&p[1]===f[1])||this.tags.push(["p",f[1]]))}else if(Array.isArray(t))l=[t];else throw new Error("Invalid argument",t);this.tags=mergeTags(this.tags,l)}async toNostrEvent(t,r){if(!t&&this.pubkey===""){const a=await this.ndk?.signer?.user();this.pubkey=a?.pubkey||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const{content:n,tags:s}=await this.generateTags(r);this.content=n||"",this.tags=s;try{this.id=this.getEventHash()}catch{}return this.rawEvent()}serialize=serialize.bind(this);getEventHash=getEventHash.bind(this);validate=validate.bind(this);verifySignature=verifySignature.bind(this);isReplaceable=isReplaceable.bind(this);isEphemeral=isEphemeral.bind(this);isDvm=()=>this.kind&&this.kind>=5e3&&this.kind<=7e3;isParamReplaceable=isParamReplaceable.bind(this);encode=encode$k.bind(this);encrypt=encrypt.bind(this);decrypt=decrypt.bind(this);getMatchingTags(t,r){const n=this.tags.filter(s=>s[0]===t);return r===void 0?n:n.filter(s=>s[3]===r)}hasTag(t,r){return this.tags.some(n=>n[0]===t&&(!r||n[3]===r))}tagValue(t,r){const n=this.getMatchingTags(t,r);if(n.length!==0)return n[0][1]}get alt(){return this.tagValue("alt")}set alt(t){this.removeTag("alt"),t&&this.tags.push(["alt",t])}get dTag(){return this.tagValue("d")}set dTag(t){this.removeTag("d"),t&&this.tags.push(["d",t])}removeTag(t,r){const n=Array.isArray(t)?t:[t];this.tags=this.tags.filter(s=>{const a=n.includes(s[0]),l=r?s[3]===r:!0;return!(a&&l)})}replaceTag(t){this.removeTag(t[0]),this.tags.push(t)}async sign(t,r){this.ndk?.aiGuardrails?.event?.signing(this),t?this.author=await t.user():(this.ndk?.assertSigner(),t=this.ndk?.signer);const n=await this.toNostrEvent(void 0,r);return this.sig=await t.sign(n),this.sig}async publishReplaceable(t,r,n){return this.id="",this.created_at=Math.floor(Date.now()/1e3),this.sig="",this.publish(t,r,n)}async publish(t,r,n,s){if(n||(n=1),this.sig||await this.sign(void 0,s),!this.ndk)throw new Error("NDKEvent must be associated with an NDK instance to publish");if(this.ndk.aiGuardrails?.event?.publishing(this),(!t||t.size===0)&&(t=this.ndk.devWriteRelaySet||await calculateRelaySetFromEvent(this.ndk,this,n)),this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds){const u=this.getMatchingTags("e").map(x=>x[1]);this.ndk.cacheAdapter.deleteEventIds(u)}const a=this.rawEvent();if(this.ndk.cacheAdapter?.addUnpublishedEvent&&shouldTrackUnpublishedEvent(this))try{this.ndk.cacheAdapter.addUnpublishedEvent(this,t.relayUrls)}catch(u){console.error("Error adding unpublished event to cache",u)}this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds&&this.ndk.cacheAdapter.deleteEventIds(this.getMatchingTags("e").map(u=>u[1])),this.ndk.subManager.dispatchEvent(a,void 0,!0);const l=await t.publish(this,r,n);return l.forEach(u=>this.ndk?.subManager.seenEvent(this.id,u)),l}async generateTags(t){let r=[];const n=await generateContentTags(this.content,this.tags,t,this),s=n.content;if(r=n.tags,this.kind&&this.isParamReplaceable()&&!this.getMatchingTags("d")[0]){const l=this.tagValue("title");let x=[...Array(l?6:16)].map(()=>Math.random().toString(36)[2]).join("");l&&l.length>0&&(x=`${l.replace(/[^a-z0-9]+/gi,"-").replace(/^-|-$/g,"")}-${x}`),r.push(["d",x])}if(this.shouldAddClientTag){const a=["client",this.ndk?.clientName??""];this.ndk?.clientNip89&&a.push(this.ndk?.clientNip89),r.push(a)}else this.shouldStripClientTag&&(r=r.filter(a=>a[0]!=="client"));return{content:s||"",tags:r}}get shouldAddClientTag(){return!(!this.ndk?.clientName&&!this.ndk?.clientNip89||skipClientTagOnKinds.has(this.kind)||this.isEphemeral()||this.isReplaceable()&&!this.isParamReplaceable()||this.isDvm()||this.hasTag("client"))}get shouldStripClientTag(){return skipClientTagOnKinds.has(this.kind)}muted(){return this.ndk?.muteFilter&&this.ndk.muteFilter(this)?"muted":null}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const t=this.getMatchingTags("d")[0];return t?t[1]:""}throw new Error("Event is not a parameterized replaceable event")}deduplicationKey(){return this.kind===0||this.kind===3||this.kind&&this.kind>=1e4&&this.kind<2e4?`${this.kind}:${this.pubkey}`:this.tagId()}tagId(){return this.isParamReplaceable()?this.tagAddress():this.id}tagAddress(){if(this.isParamReplaceable()){const t=this.dTag??"";return`${this.kind}:${this.pubkey}:${t}`}if(this.isReplaceable())return`${this.kind}:${this.pubkey}:`;throw new Error("Event is not a replaceable event")}tagType(){return this.isParamReplaceable()?"a":"e"}tagReference(t){let r;return this.isParamReplaceable()?r=["a",this.tagAddress()]:r=["e",this.tagId()],this.relay?r.push(this.relay.url):r.push(""),r.push(t??""),this.isParamReplaceable()||r.push(this.pubkey),r}referenceTags(t,r,n,s){let a=[];return this.isParamReplaceable()?a=[[n??"a",this.tagAddress()],[n??"e",this.id]]:a=[[n??"e",this.id]],a=a.map(l=>(l[0]==="e"||t?l.push(this.relay?.url??""):this.relay?.url&&l.push(this.relay?.url),l)),a.forEach(l=>{l[0]==="e"?(l.push(t??""),l.push(this.pubkey)):t&&l.push(t)}),a=[...a,...this.getMatchingTags("h")],!r&&s?.pTags!==!1&&a.push(...this.author.referenceTags()),a}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}nip22Filter(){return this.isParamReplaceable()?{"#A":[this.tagId()]}:{"#E":[this.tagId()]}}async delete(t,r=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const n=new Hi(this.ndk,{kind:5,content:t||""});return n.tag(this,void 0,!0),n.tags.push(["k",this.kind?.toString()]),r&&(this.emit("deleted"),await n.publish()),n}set isProtected(t){this.removeTag("-"),t&&this.tags.push(["-"])}get isProtected(){return this.hasTag("-")}fetchTaggedEvent=fetchTaggedEvent.bind(this);fetchRootEvent=fetchRootEvent.bind(this);fetchReplyEvent=fetchReplyEvent.bind(this);repost=repost.bind(this);async react(t,r=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const n=new Hi(this.ndk,{kind:7,content:t});return n.tag(this),this.kind!==1&&n.tags.push(["k",`${this.kind}`]),r&&await n.publish(),n}get isValid(){return this.validate()}get inspect(){return JSON.stringify(this.rawEvent(),null,4)}dump(){console.debug(JSON.stringify(this.rawEvent(),null,4)),console.debug("Event on relays:",this.onRelays.map(t=>t.url).join(", "))}reply(t,r){const n=new Hi(this.ndk);if(this.ndk?.aiGuardrails?.event?.creatingReply(n),this.kind===1&&!t)n.kind=1,this.hasTag("e")?n.tags=[...n.tags,...this.getMatchingTags("e"),...this.getMatchingTags("p"),...this.getMatchingTags("a"),...this.referenceTags("reply",!1,void 0,r)]:n.tag(this,"root",!1,void 0,r);else{n.kind=1111;const s=["A","E","I","P"],a=this.tags.filter(l=>s.includes(l[0]));if(a.length>0){const l=this.tagValue("K");n.tags.push(...a),l&&n.tags.push(["K",l]);let u;if(this.isParamReplaceable()){u=["a",this.tagAddress()];const x=this.relay?.url??"";x&&u.push(x)}else{u=["e",this.tagId()];const x=this.relay?.url??"";u.push(x),u.push(this.pubkey)}n.tags.push(u)}else{let l,u;const x=this.relay?.url??"";this.isParamReplaceable()?(l=["a",this.tagAddress(),x],u=["A",this.tagAddress(),x]):(l=["e",this.tagId(),x,this.pubkey],u=["E",this.tagId(),x,this.pubkey]),n.tags.push(l),n.tags.push(u),n.tags.push(["K",this.kind?.toString()]),r?.pTags!==!1&&r?.pTagOnATags!==!1&&n.tags.push(["P",this.pubkey])}n.tags.push(["k",this.kind?.toString()]),r?.pTags!==!1&&(n.tags.push(...this.getMatchingTags("p")),n.tags.push(["p",this.pubkey]))}return n}},untrackedUnpublishedEvents=new Set([24133,13194,23194,23195]);function shouldTrackUnpublishedEvent(e){return!untrackedUnpublishedEvents.has(e.kind)}var NDKPool=class extends libExports.EventEmitter{_relays=new Map;status="idle";autoConnectRelays=new Set;debug;temporaryRelayTimers=new Map;flappingRelays=new Set;backoffTimes=new Map;ndk;disconnectionTimes=new Map;systemEventDetector;constructor(e,t,{debug:r,name:n}={}){super(),this.debug=r??t.debug.extend("pool"),n&&(this._name=n),this.ndk=t,this.relayUrls=e,this.ndk.pools&&this.ndk.pools.push(this)}get relays(){return this._relays}set relayUrls(e){this._relays.clear();for(const t of e){const r=new NDKRelay(t,void 0,this.ndk);r.connectivity.netDebug=this.ndk.netDebug,this.addRelay(r)}}_name="unnamed";get name(){return this._name}set name(e){this._name=e,this.debug=this.debug.extend(e)}useTemporaryRelay(e,t=3e4,r){const n=this.relays.has(e.url);n||(this.addRelay(e),this.debug("Adding temporary relay %s for filters %o",e.url,r));const s=this.temporaryRelayTimers.get(e.url);if(s&&clearTimeout(s),!n||s){const a=setTimeout(()=>{this.ndk.explicitRelayUrls?.includes(e.url)||this.removeRelay(e.url)},t);this.temporaryRelayTimers.set(e.url,a)}}addRelay(e,t=!0){const r=this.relays.has(e.url),n=e.url.includes("/npub1");let s=!0;const a=e.url;if(r)return;if(this.ndk.relayConnectionFilter&&!this.ndk.relayConnectionFilter(a)){this.debug(`Refusing to add relay ${a}: blocked by relayConnectionFilter`);return}if(n){this.debug(`Refusing to add relay ${a}: is a filter relay`);return}if(this.ndk.cacheAdapter?.getRelayStatus){const w=this.ndk.cacheAdapter.getRelayStatus(a),R=w instanceof Promise?void 0:w;if(R?.dontConnectBefore){if(R.dontConnectBefore>Date.now()){const I=R.dontConnectBefore-Date.now();this.debug(`Refusing to add relay ${a}: delayed connect for ${I}ms`),setTimeout(()=>{this.addRelay(e,t)},I);return}s=!1}}const l=w=>this.emit("notice",e,w),u=()=>this.handleRelayConnect(a),x=()=>this.handleRelayReady(e),f=()=>{this.recordDisconnection(e),this.emit("relay:disconnect",e)},p=()=>this.handleFlapping(e),g=w=>this.emit("relay:auth",e,w),y=()=>this.emit("relay:authed",e);e.off("notice",l),e.off("connect",u),e.off("ready",x),e.off("disconnect",f),e.off("flapping",p),e.off("auth",g),e.off("authed",y),e.on("notice",l),e.on("connect",u),e.on("ready",x),e.on("disconnect",f),e.on("flapping",p),e.on("auth",g),e.on("authed",y),e.on("delayed-connect",w=>{this.ndk.cacheAdapter?.updateRelayStatus&&this.ndk.cacheAdapter.updateRelayStatus(e.url,{dontConnectBefore:Date.now()+w})}),this._relays.set(a,e),t&&this.autoConnectRelays.add(a),t&&this.status==="active"&&(this.emit("relay:connecting",e),e.connect(void 0,s).catch(w=>{this.debug(`Failed to connect to relay ${a}`,w)}))}removeRelay(e){const t=this.relays.get(e);if(t)return t.disconnect(),this.relays.delete(e),this.autoConnectRelays.delete(e),this.emit("relay:disconnect",t),!0;const r=this.temporaryRelayTimers.get(e);return r&&(clearTimeout(r),this.temporaryRelayTimers.delete(e)),!1}isRelayConnected(e){const t=normalizeRelayUrl(e),r=this.relays.get(t);return r?r.status===5:!1}getRelay(e,t=!0,r=!1,n){let s=this.relays.get(normalizeRelayUrl(e));return s||(s=new NDKRelay(e,void 0,this.ndk),s.connectivity.netDebug=this.ndk.netDebug,r?this.useTemporaryRelay(s,3e4,n):this.addRelay(s,t)),s}handleRelayConnect(e){const t=this.relays.get(e);if(!t){console.error("NDK BUG: relay not found in pool",{relayUrl:e});return}this.emit("relay:connect",t),this.stats().connected===this.relays.size&&this.emit("connect")}handleRelayReady(e){this.emit("relay:ready",e)}async connect(e){this.status="active",this.debug(`Connecting to ${this.relays.size} relays${e?`, timeout ${e}ms`:""}...`);const t=Array.from(this.autoConnectRelays.keys()).map(a=>this.relays.get(a)).filter(a=>!!a);for(const a of t)a.status!==5&&a.status!==4&&(this.emit("relay:connecting",a),a.connect().catch(l=>{this.debug(`Failed to connect to relay ${a.url}: ${l??"No reason specified"}`)}));const r=()=>t.every(a=>a.status===5),n=new Promise(a=>{if(r()){a();return}const l=[];for(const u of t){const x=()=>{if(r()){for(let f=0;f<t.length;f++)t[f].off("connect",l[f]);a()}};l.push(x),u.on("connect",x)}}),s=typeof e=="number"?new Promise(a=>setTimeout(a,e)):new Promise(()=>{});await Promise.race([n,s])}checkOnFlappingRelays(){const e=this.flappingRelays.size,t=this.relays.size;if(e/t>=.8)for(const r of this.flappingRelays)this.backoffTimes.set(r,0)}recordDisconnection(e){const t=Date.now();this.disconnectionTimes.set(e.url,t);for(const[r,n]of this.disconnectionTimes.entries())t-n>1e4&&this.disconnectionTimes.delete(r);this.checkForSystemWideDisconnection()}checkForSystemWideDisconnection(){const e=Date.now(),t=[];for(const r of this.disconnectionTimes.values())e-r<5e3&&t.push(r);t.length>this.relays.size/2&&this.relays.size>1&&(this.debug(`System-wide disconnection detected: ${t.length}/${this.relays.size} relays disconnected`),this.handleSystemWideReconnection())}handleSystemWideReconnection(){if(this.systemEventDetector){this.debug("System-wide reconnection already in progress, skipping");return}this.debug("Initiating system-wide reconnection with reset backoff"),this.systemEventDetector=setTimeout(()=>{this.systemEventDetector=void 0},1e4);for(const e of this.relays.values())e.connectivity&&(e.connectivity.resetReconnectionState(),e.status!==5&&e.status!==4&&e.connect().catch(t=>{this.debug(`Failed to reconnect relay ${e.url} after system event: ${t}`)}));this.disconnectionTimes.clear()}handleFlapping(e){this.debug(`Relay ${e.url} is flapping`);let t=this.backoffTimes.get(e.url)||5e3;t=t*2,this.backoffTimes.set(e.url,t),this.debug(`Backoff time for ${e.url} is ${t}ms`),setTimeout(()=>{this.debug(`Attempting to reconnect to ${e.url}`),this.emit("relay:connecting",e),e.connect(),this.checkOnFlappingRelays()},t),e.disconnect(),this.emit("flapping",e)}size(){return this.relays.size}stats(){const e={total:0,connected:0,disconnected:0,connecting:0};for(const t of this.relays.values())e.total++,t.status===5?e.connected++:t.status===1?e.disconnected++:t.status===4&&e.connecting++;return e}connectedRelays(){return Array.from(this.relays.values()).filter(e=>e.status>=5)}permanentAndConnectedRelays(){return Array.from(this.relays.values()).filter(e=>e.status>=5&&!this.temporaryRelayTimers.has(e.url))}urls(){return Array.from(this.relays.keys())}},NDKDVMJobFeedback=class jd extends NDKEvent{static kinds=[7e3];constructor(t,r){super(t,r),this.kind??=7e3}static async from(t){const r=new jd(t.ndk,t.rawEvent());return r.encrypted&&await r.dvmDecrypt(),r}get status(){return this.tagValue("status")}set status(t){this.removeTag("status"),t!==void 0&&this.tags.push(["status",t])}get encrypted(){return!!this.getMatchingTags("encrypted")[0]}async dvmDecrypt(){await this.decrypt();const t=JSON.parse(this.content);this.tags.push(...t)}},NDKCashuMintList=class Fd extends NDKEvent{static kind=10019;static kinds=[10019];_p2pk;constructor(t,r){super(t,r),this.kind??=10019}static from(t){return new Fd(t.ndk,t)}set relays(t){this.tags=this.tags.filter(r=>r[0]!=="relay");for(const r of t)this.tags.push(["relay",r])}get relays(){const t=[];for(const r of this.tags)r[0]==="relay"&&t.push(r[1]);return t}set mints(t){this.tags=this.tags.filter(r=>r[0]!=="mint");for(const r of t)this.tags.push(["mint",r])}get mints(){const t=[];for(const r of this.tags)r[0]==="mint"&&t.push(r[1]);return Array.from(new Set(t))}get p2pk(){return this._p2pk?this._p2pk:(this._p2pk=this.tagValue("pubkey")??this.pubkey,this._p2pk)}set p2pk(t){this._p2pk=t,this.removeTag("pubkey"),t&&this.tags.push(["pubkey",t])}get relaySet(){return NDKRelaySet.fromRelayUrls(this.relays,this.ndk)}},NDKArticle=class Td extends NDKEvent{static kind=30023;static kinds=[30023];constructor(t,r){super(t,r),this.kind??=30023}static from(t){return new Td(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}get summary(){return this.tagValue("summary")}set summary(t){this.removeTag("summary"),t&&this.tags.push(["summary",t])}get published_at(){const t=this.tagValue("published_at");if(t){let r=Number.parseInt(t);return r>1e12&&(r=Math.floor(r/1e3)),r}}set published_at(t){this.removeTag("published_at"),t!==void 0&&this.tags.push(["published_at",t.toString()])}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}get url(){return this.tagValue("url")}set url(t){t?this.tags.push(["url",t]):this.removeTag("url")}},NDKBlossomList=class $d extends NDKEvent{static kinds=[10063];constructor(t,r){super(t,r),this.kind??=10063}static from(t){return new $d(t.ndk,t.rawEvent())}get servers(){return this.tags.filter(t=>t[0]==="server").map(t=>t[1])}set servers(t){this.tags=this.tags.filter(r=>r[0]!=="server");for(const r of t)this.tags.push(["server",r])}get default(){const t=this.servers;return t.length>0?t[0]:void 0}set default(t){if(!t)return;const n=this.servers.filter(s=>s!==t);this.servers=[t,...n]}addServer(t){if(!t)return;const r=this.servers;r.includes(t)||(this.servers=[...r,t])}removeServer(t){if(!t)return;const r=this.servers;this.servers=r.filter(n=>n!==t)}},NDKFedimintMint=class Id extends NDKEvent{static kind=38173;static kinds=[38173];constructor(t,r){super(t,r),this.kind??=38173}static async from(t){return new Id(t.ndk,t)}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get inviteCodes(){return this.getMatchingTags("u").map(t=>t[1])}set inviteCodes(t){this.removeTag("u");for(const r of t)this.tags.push(["u",r])}get modules(){return this.getMatchingTags("modules").map(t=>t[1])}set modules(t){this.removeTag("modules");for(const r of t)this.tags.push(["modules",r])}get network(){return this.tagValue("n")}set network(t){this.removeTag("n"),t&&this.tags.push(["n",t])}get metadata(){if(this.content)try{return JSON.parse(this.content)}catch{return}}set metadata(t){t?this.content=JSON.stringify(t):this.content=""}},NDKCashuMintAnnouncement=class Md extends NDKEvent{static kind=38172;static kinds=[38172];constructor(t,r){super(t,r),this.kind??=38172}static async from(t){return new Md(t.ndk,t)}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get url(){return this.tagValue("u")}set url(t){this.removeTag("u"),t&&this.tags.push(["u",t])}get nuts(){return this.getMatchingTags("nuts").map(t=>t[1])}set nuts(t){this.removeTag("nuts");for(const r of t)this.tags.push(["nuts",r])}get network(){return this.tagValue("n")}set network(t){this.removeTag("n"),t&&this.tags.push(["n",t])}get metadata(){if(this.content)try{return JSON.parse(this.content)}catch{return}}set metadata(t){t?this.content=JSON.stringify(t):this.content=""}},NDKMintRecommendation=class Pd extends NDKEvent{static kind=38e3;static kinds=[38e3];constructor(t,r){super(t,r),this.kind??=38e3}static async from(t){return new Pd(t.ndk,t)}get recommendedKind(){const t=this.tagValue("k");return t?Number(t):void 0}set recommendedKind(t){this.removeTag("k"),t&&this.tags.push(["k",t.toString()])}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get urls(){return this.getMatchingTags("u").map(t=>t[1])}set urls(t){this.removeTag("u");for(const r of t)this.tags.push(["u",r])}get mintEventPointers(){return this.getMatchingTags("a").map(t=>({kind:Number(t[1].split(":")[0]),identifier:t[1].split(":")[2],relay:t[2]}))}addMintEventPointer(t,r,n,s){const a=["a",`${t}:${r}:${n}`];s&&a.push(s),this.tags.push(a)}get review(){return this.content}set review(t){this.content=t}},NDKClassified=class Ud extends NDKEvent{static kinds=[30402];constructor(t,r){super(t,r),this.kind??=30402}static from(t){return new Ud(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get summary(){return this.tagValue("summary")}set summary(t){this.removeTag("summary"),t&&this.tags.push(["summary",t])}get published_at(){const t=this.tagValue("published_at");if(t)return Number.parseInt(t)}set published_at(t){this.removeTag("published_at"),t!==void 0&&this.tags.push(["published_at",t.toString()])}get location(){return this.tagValue("location")}set location(t){this.removeTag("location"),t&&this.tags.push(["location",t])}get price(){const t=this.tags.find(r=>r[0]==="price");if(t)return{amount:Number.parseFloat(t[1]),currency:t[2],frequency:t[3]}}set price(t){if(typeof t=="string"&&(t={amount:Number.parseFloat(t)}),t?.amount){const r=["price",t.amount.toString()];t.currency&&r.push(t.currency),t.frequency&&r.push(t.frequency),this.tags.push(r)}else this.removeTag("price")}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}},NDKDraft=class Od extends NDKEvent{_event;static kind=31234;static kinds=[31234,1234];counterparty;constructor(t,r){super(t,r),this.kind??=31234}static from(t){return new Od(t.ndk,t)}set identifier(t){this.removeTag("d"),this.tags.push(["d",t])}get identifier(){return this.dTag}set event(t){t instanceof NDKEvent?this._event=t:this._event=new NDKEvent(void 0,t),this.prepareEvent()}set checkpoint(t){t?(this.tags.push(t.tagReference()),this.kind=1234):(this.removeTag("a"),this.kind=31234)}get isCheckpoint(){return this.kind===1234}get isProposal(){const t=this.tagValue("p");return!!t&&t!==this.pubkey}async getEvent(t){if(this._event)return this._event;if(t??=this.ndk?.signer,!t)throw new Error("No signer available");if(this.content&&this.content.length>0)try{const r=t.pubkey,s=[this.tagValue("p"),this.pubkey].filter(Boolean).find(u=>u!==r);let a;a=new NDKUser({pubkey:s??r}),await this.decrypt(a,t);const l=JSON.parse(this.content);return this._event=await wrapEvent(new NDKEvent(this.ndk,l)),this._event}catch(r){console.error(r);return}else return null}prepareEvent(){if(!this._event)throw new Error("No event has been provided");this.removeTag("k"),this._event.kind&&this.tags.push(["k",this._event.kind.toString()]),this.content=JSON.stringify(this._event.rawEvent())}async save({signer:t,publish:r,relaySet:n}){if(t??=this.ndk?.signer,!t)throw new Error("No signer available");const s=this.counterparty||await t.user();if(await this.encrypt(s,t),this.counterparty){const a=this.counterparty.pubkey;this.removeTag("p"),this.tags.push(["p",a])}if(r!==!1)return this.publishReplaceable(n)}};function mapImetaTag(e){const t={};if(e.length===2){const n=e[1].split(" ");for(let s=0;s<n.length;s+=2){const a=n[s],l=n[s+1];a==="fallback"?(t.fallback||(t.fallback=[]),t.fallback.push(l)):t[a]=l}return t}const r=e.slice(1);for(const n of r){const s=n.split(" "),a=s[0],l=s.slice(1).join(" ");a==="fallback"?(t.fallback||(t.fallback=[]),t.fallback.push(l)):t[a]=l}return t}function imetaTagToTag(e){const t=["imeta"];for(const[r,n]of Object.entries(e))if(Array.isArray(n))for(const s of n)t.push(`${r} ${s}`);else n&&t.push(`${r} ${n}`);return t}var NDKFollowPack=class Ld extends NDKEvent{static kind=39089;static kinds=[39089,39092];constructor(t,r){super(t,r),this.kind??=39089}static from(t){return new Ld(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get image(){const t=this.tags.find(r=>r[0]==="imeta");if(t){const r=mapImetaTag(t);if(r.url)return r.url}return this.tagValue("image")}set image(t){this.tags=this.tags.filter(r=>r[0]!=="imeta"&&r[0]!=="image"),typeof t=="string"?t!==void 0&&this.tags.push(["image",t]):t&&typeof t=="object"&&(this.tags.push(imetaTagToTag(t)),t.url&&this.tags.push(["image",t.url]))}get pubkeys(){return Array.from(new Set(this.tags.filter(t=>t[0]==="p"&&t[1]&&isValidPubkey(t[1])).map(t=>t[1])))}set pubkeys(t){this.tags=this.tags.filter(r=>r[0]!=="p");for(const r of t)this.tags.push(["p",r])}get description(){return this.tagValue("description")}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}},NDKHighlight=class Hd extends NDKEvent{_article;static kind=9802;static kinds=[9802];constructor(t,r){super(t,r),this.kind??=9802}static from(t){return new Hd(t.ndk,t)}get url(){return this.tagValue("r")}set context(t){t===void 0?this.tags=this.tags.filter(([r,n])=>r!=="context"):(this.tags=this.tags.filter(([r,n])=>r!=="context"),this.tags.push(["context",t]))}get context(){return this.tags.find(([t,r])=>t==="context")?.[1]??void 0}get article(){return this._article}set article(t){this._article=t,typeof t=="string"?this.tags.push(["r",t]):this.tag(t)}getArticleTag(){return this.getMatchingTags("a")[0]||this.getMatchingTags("e")[0]||this.getMatchingTags("r")[0]}async getArticle(){if(this._article!==void 0)return this._article;let t;const r=this.getArticleTag();if(r){switch(r[0]){case"a":{const[n,s,a]=r[1].split(":");t=nip19_exports$1.naddrEncode({kind:Number.parseInt(n),pubkey:s,identifier:a});break}case"e":t=nip19_exports$1.noteEncode(r[1]);break;case"r":this._article=r[1];break}if(t){let n=await this.ndk?.fetchEvent(t);n&&(n.kind===30023&&(n=NDKArticle.from(n)),this._article=n)}return this._article}}},NDKImage=class qd extends NDKEvent{static kind=20;static kinds=[20];_imetas;constructor(t,r){super(t,r),this.kind??=20}static from(t){return new qd(t.ndk,t.rawEvent())}get isValid(){return this.imetas.length>0}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(t=>t[0]==="imeta").map(mapImetaTag).filter(t=>!!t.url),this._imetas)}set imetas(t){this._imetas=t,this.tags=this.tags.filter(r=>r[0]!=="imeta"),this.tags.push(...t.map(imetaTagToTag))}},NDKList=class Kd extends NDKEvent{_encryptedTags;static kinds=[30001,10004,10050,10030,10015,10001,10002,10007,10006,10003];encryptedTagsLength;constructor(t,r){super(t,r),this.kind??=30001}static from(t){return new Kd(t.ndk,t)}get title(){const t=this.tagValue("title")||this.tagValue("name");return t||(this.kind===3?"Contacts":this.kind===1e4?"Mute":this.kind===10001?"Pinned Notes":this.kind===10002?"Relay Metadata":this.kind===10003?"Bookmarks":this.kind===10004?"Communities":this.kind===10005?"Public Chats":this.kind===10006?"Blocked Relays":this.kind===10007?"Search Relays":this.kind===10050?"Direct Message Receive Relays":this.kind===10015?"Interests":this.kind===10030?"Emojis":this.tagValue("d"))}set title(t){this.removeTag(["title","name"]),t&&this.tags.push(["title",t])}get name(){return this.title}set name(t){this.title=t}get description(){return this.tagValue("description")}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}isEncryptedTagsCacheValid(){return!!(this._encryptedTags&&this.encryptedTagsLength===this.content.length)}async encryptedTags(t=!0){if(t&&this.isEncryptedTagsCacheValid())return this._encryptedTags;if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const r=await this.ndk.signer.user();try{if(this.content.length>0)try{const n=await this.ndk.signer.decrypt(r,this.content),s=JSON.parse(n);return s?.[0]?(this.encryptedTagsLength=this.content.length,this._encryptedTags=s):(this.encryptedTagsLength=this.content.length,this._encryptedTags=[])}catch{}}catch{}return[]}validateTag(t){return!0}getItems(t){return this.tags.filter(r=>r[0]===t)}get items(){return this.tags.filter(t=>!["d","L","l","title","name","description","published_at","summary","image","thumb","alt","expiration","subject","client"].includes(t[0]))}async addItem(t,r=void 0,n=!1,s="bottom"){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");let a;if(t instanceof NDKEvent)a=[t.tagReference(r)];else if(t instanceof NDKUser)a=t.referenceTags();else if(t instanceof NDKRelay)a=t.referenceTags();else if(Array.isArray(t))a=[t];else throw new Error("Invalid object type");if(r&&a[0].push(r),n){const l=await this.ndk.signer.user(),u=await this.encryptedTags();s==="top"?u.unshift(...a):u.push(...a),this._encryptedTags=u,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(u),await this.encrypt(l)}else s==="top"?this.tags.unshift(...a):this.tags.push(...a);this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItemByValue(t,r=!0){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const n=this.tags.findIndex(u=>u[1]===t);n>=0&&this.tags.splice(n,1);const s=await this.ndk.signer.user(),a=await this.encryptedTags(),l=a.findIndex(u=>u[1]===t);if(l>=0&&(a.splice(l,1),this._encryptedTags=a,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(a),await this.encrypt(s)),r)return this.publishReplaceable();this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItem(t,r){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");if(r){const n=await this.ndk.signer.user(),s=await this.encryptedTags();s.splice(t,1),this._encryptedTags=s,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(s),await this.encrypt(n)}else this.tags.splice(t,1);return this.created_at=Math.floor(Date.now()/1e3),this.emit("change"),this}has(t){return this.items.some(r=>r[1]===t)}filterForItems(){const t=new Set,r=new Map,n=[];for(const s of this.items)if(s[0]==="e"&&s[1])t.add(s[1]);else if(s[0]==="a"&&s[1]){const[a,l,u]=s[1].split(":");if(!a||!l)continue;const x=`${a}:${l}`,f=r.get(x)||[];f.push(u||""),r.set(x,f)}if(t.size>0&&n.push({ids:Array.from(t)}),r.size>0)for(const[s,a]of r.entries()){const[l,u]=s.split(":");n.push({kinds:[Number.parseInt(l)],authors:[u],"#d":a})}return n}},NDKAppHandlerEvent=class zd extends NDKEvent{profile;static kinds=[31990];constructor(t,r){super(t,r),this.kind??=31990}static from(t){const r=new zd(t.ndk,t.rawEvent());return r.isValid?r:null}get isValid(){const t=new Map,r=s=>[s[0],s[2]].join(":").toLowerCase(),n=["web","android","ios"];for(const s of this.tags)if(n.includes(s[0])){const a=r(s);if(t.has(a)&&t.get(a)!==s[1].toLowerCase())return!1;t.set(a,s[1].toLowerCase())}return!0}async fetchProfile(){if(this.profile===void 0&&this.content.length>0)try{const t=JSON.parse(this.content);if(t?.name)return t;this.profile=null}catch{this.profile=null}return new Promise((t,r)=>{const n=this.author;n.fetchProfile().then(()=>{t(n.profile)}).catch(r)})}},NDKNutzap=class H0 extends NDKEvent{debug;_proofs=[];static kind=9321;static kinds=[H0.kind];constructor(t,r){super(t,r),this.kind??=9321,this.debug=t?.debug.extend("nutzap")??createDebug5("ndk:nutzap"),this.alt||(this.alt="This is a nutzap");try{const n=this.getMatchingTags("proof");n.length?this._proofs=n.map(s=>JSON.parse(s[1])):this._proofs=JSON.parse(this.content)}catch{return}}static from(t){const r=new H0(t.ndk,t);if(!(!r._proofs||!r._proofs.length))return r}set comment(t){this.content=t??""}get comment(){const t=this.tagValue("comment");return t||this.content}set proofs(t){this._proofs=t,this.tags=this.tags.filter(r=>r[0]!=="proof");for(const r of t)this.tags.push(["proof",JSON.stringify(r)])}get proofs(){return this._proofs}get rawP2pk(){const t=this.proofs[0];try{const r=JSON.parse(t.secret);let n;if(typeof r=="string"?(n=JSON.parse(r),this.debug("stringified payload",t.secret)):typeof r=="object"&&(n=r),Array.isArray(n)&&n[0]==="P2PK"&&n.length>1&&typeof n[1]=="object"&&n[1]!==null||typeof n=="object"&&n!==null&&typeof n[1]?.data=="string")return n[1].data}catch(r){this.debug("error parsing p2pk pubkey",r,this.proofs[0])}}get p2pk(){const t=this.rawP2pk;if(t)return t.startsWith("02")?t.slice(2):t}get mint(){return this.tagValue("u")}set mint(t){this.replaceTag(["u",t])}get unit(){let t=this.tagValue("unit")??"sat";return t?.startsWith("msat")&&(t="sat"),t}set unit(t){if(this.removeTag("unit"),t?.startsWith("msat"))throw new Error("msat is not allowed, use sat denomination instead");t&&this.tag(["unit",t])}get amount(){return this.proofs.reduce((r,n)=>r+n.amount,0)}sender=this.author;set target(t){this.tags=this.tags.filter(r=>r[0]!=="p"),t instanceof NDKEvent&&this.tags.push(t.tagReference())}set recipientPubkey(t){this.removeTag("p"),this.tag(["p",t])}get recipientPubkey(){return this.tagValue("p")}get recipient(){const t=this.recipientPubkey;return this.ndk?this.ndk.getUser({pubkey:t}):new NDKUser({pubkey:t})}async toNostrEvent(){this.unit==="msat"&&(this.unit="sat"),this.removeTag("amount"),this.tags.push(["amount",this.amount.toString()]);const t=await super.toNostrEvent();return t.content=this.comment,t}get isValid(){let t=0,r=0,n=0;for(const s of this.tags)s[0]==="e"&&t++,s[0]==="p"&&r++,s[0]==="u"&&n++;return r===1&&n===1&&t<=1&&this.proofs.length>0}},NDKProject=class Vd extends NDKEvent{static kind=31933;static kinds=[31933];_signer;constructor(t,r){super(t,r),this.kind=31933}static from(t){return new Vd(t.ndk,t.rawEvent())}set repo(t){this.removeTag("repo"),t&&this.tags.push(["repo",t])}set hashtags(t){this.removeTag("hashtags"),t.filter(r=>r.length>0).length&&this.tags.push(["hashtags",...t])}get hashtags(){const t=this.tags.find(r=>r[0]==="hashtags");return t?t.slice(1):[]}get repo(){return this.tagValue("repo")}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get picture(){return this.tagValue("picture")}set picture(t){this.removeTag("picture"),t&&this.tags.push(["picture",t])}set description(t){this.content=t}get description(){return this.content}get slug(){return this.dTag??"empty-dtag"}async getSigner(){if(this._signer)return this._signer;const t=this.tagValue("key");if(!t)this._signer=NDKPrivateKeySigner.generate(),await this.encryptAndSaveNsec();else{const r=await this.ndk?.signer?.decrypt(this.ndk.activeUser,t);if(!r)throw new Error("Failed to decrypt project key or missing signer context.");this._signer=new NDKPrivateKeySigner(r)}return this._signer}async getNsec(){return(await this.getSigner()).privateKey}async setNsec(t){this._signer=new NDKPrivateKeySigner(t),await this.encryptAndSaveNsec()}async encryptAndSaveNsec(){if(!this._signer)throw new Error("Signer is not set.");const t=this._signer.privateKey,r=await this.ndk?.signer?.encrypt(this.ndk.activeUser,t);r&&(this.removeTag("key"),this.tags.push(["key",r]))}},NDKProjectTemplate=class Gd extends NDKEvent{static kind=30717;static kinds=[30717];constructor(t,r){super(t,r),this.kind=30717}static from(t){return new Gd(t.ndk,t.rawEvent())}get templateId(){return this.dTag??""}set templateId(t){this.dTag=t}get name(){return this.tagValue("title")??""}set name(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get description(){return this.tagValue("description")??""}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}get repoUrl(){return this.tagValue("uri")??""}set repoUrl(t){this.removeTag("uri"),t&&this.tags.push(["uri",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}get command(){return this.tagValue("command")}set command(t){this.removeTag("command"),t&&this.tags.push(["command",t])}get agentConfig(){const t=this.tagValue("agent");if(t)try{return JSON.parse(t)}catch{return}}set agentConfig(t){this.removeTag("agent"),t&&this.tags.push(["agent",JSON.stringify(t)])}get templateTags(){return this.getMatchingTags("t").map(t=>t[1]).filter(Boolean)}set templateTags(t){this.tags=this.tags.filter(r=>r[0]!=="t"),t.forEach(r=>{r&&this.tags.push(["t",r])})}},READ_MARKER="read",WRITE_MARKER="write",NDKRelayList=class Wd extends NDKEvent{static kinds=[10002];constructor(t,r){super(t,r),this.kind??=10002}static from(t){return new Wd(t.ndk,t.rawEvent())}get readRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]||t[2]&&t[2]===READ_MARKER).map(t=>tryNormalizeRelayUrl(t[1])).filter(t=>!!t)}set readRelayUrls(t){for(const r of t)this.tags.push(["r",r,READ_MARKER])}get writeRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]||t[2]&&t[2]===WRITE_MARKER).map(t=>tryNormalizeRelayUrl(t[1])).filter(t=>!!t)}set writeRelayUrls(t){for(const r of t)this.tags.push(["r",r,WRITE_MARKER])}get bothRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]).map(t=>t[1])}set bothRelayUrls(t){for(const r of t)this.tags.push(["r",r])}get relays(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").map(t=>t[1])}get relaySet(){if(!this.ndk)throw new Error("NDKRelayList has no NDK instance");return new NDKRelaySet(new Set(this.relays.map(t=>this.ndk?.pool.getRelay(t)).filter(t=>!!t)),this.ndk)}};function relayListFromKind3(e,t){try{const r=JSON.parse(t.content),n=new NDKRelayList(e),s=new Set,a=new Set;for(let[l,u]of Object.entries(r)){try{l=normalizeRelayUrl(l)}catch{continue}if(!u)s.add(l),a.add(l);else{const x=u;x.write&&a.add(l),x.read&&s.add(l)}}return n.readRelayUrls=Array.from(s),n.writeRelayUrls=Array.from(a),n}catch{}}var NDKRepost=class Xd extends NDKEvent{_repostedEvents;static kinds=[6,16];static from(t){return new Xd(t.ndk,t.rawEvent())}async repostedEvents(t,r){const n=[];if(!this.ndk)throw new Error("NDK instance not set");if(this._repostedEvents!==void 0)return this._repostedEvents;for(const s of this.repostedEventIds()){const a=filterForId(s),l=await this.ndk.fetchEvent(a,r);l&&n.push(t?t.from(l):l)}return n}repostedEventIds(){return this.tags.filter(t=>t[0]==="e"||t[0]==="a").map(t=>t[1])}};function filterForId(e){if(e.match(/:/)){const[t,r,n]=e.split(":");return{kinds:[Number.parseInt(t)],authors:[r],"#d":[n]}}return{ids:[e]}}var NDKSimpleGroupMemberList=class Yd extends NDKEvent{relaySet;memberSet=new Set;static kind=39002;static kinds=[39002];constructor(t,r){super(t,r),this.kind??=39002,this.memberSet=new Set(this.members)}static from(t){return new Yd(t.ndk,t)}get members(){return this.getMatchingTags("p").map(t=>t[1])}hasMember(t){return this.memberSet.has(t)}async publish(t,r,n){return t??=this.relaySet,super.publishReplaceable(t,r,n)}},NDKSimpleGroupMetadata=class Zd extends NDKEvent{static kind=39e3;static kinds=[39e3];constructor(t,r){super(t,r),this.kind??=39e3}static from(t){return new Zd(t.ndk,t)}get name(){return this.tagValue("name")}get picture(){return this.tagValue("picture")}get about(){return this.tagValue("about")}get scope(){if(this.getMatchingTags("public").length>0)return"public";if(this.getMatchingTags("public").length>0)return"private"}set scope(t){this.removeTag("public"),this.removeTag("private"),t==="public"?this.tags.push(["public",""]):t==="private"&&this.tags.push(["private",""])}get access(){if(this.getMatchingTags("open").length>0)return"open";if(this.getMatchingTags("closed").length>0)return"closed"}set access(t){this.removeTag("open"),this.removeTag("closed"),t==="open"?this.tags.push(["open",""]):t==="closed"&&this.tags.push(["closed",""])}};function strToPosition(e){const[t,r]=e.split(",").map(Number);return{x:t,y:r}}function strToDimension(e){const[t,r]=e.split("x").map(Number);return{width:t,height:r}}var NDKStorySticker=class Qd{static Text="text";static Pubkey="pubkey";static Event="event";static Prompt="prompt";static Countdown="countdown";type;value;position;dimension;properties;constructor(t){if(Array.isArray(t)){const r=t;if(r[0]!=="sticker"||r.length<5)throw new Error("Invalid sticker tag");this.type=r[1],this.value=r[2],this.position=strToPosition(r[3]),this.dimension=strToDimension(r[4]);const n={};for(let s=5;s<r.length;s++){const[a,...l]=r[s].split(" ");n[a]=l.join(" ")}Object.keys(n).length>0&&(this.properties=n)}else this.type=t,this.value=void 0,this.position={x:0,y:0},this.dimension={width:0,height:0}}static fromTag(t){try{return new Qd(t)}catch{return null}}get style(){return this.properties?.style}set style(t){t?this.properties={...this.properties,style:t}:delete this.properties?.style}get rotation(){return this.properties?.rot?Number.parseFloat(this.properties.rot):void 0}set rotation(t){t!==void 0?this.properties={...this.properties,rot:t.toString()}:delete this.properties?.rot}get isValid(){return this.hasValidDimensions()&&this.hasValidPosition()}hasValidDimensions=()=>typeof this.dimension.width=="number"&&typeof this.dimension.height=="number"&&!Number.isNaN(this.dimension.width)&&!Number.isNaN(this.dimension.height);hasValidPosition=()=>typeof this.position.x=="number"&&typeof this.position.y=="number"&&!Number.isNaN(this.position.x)&&!Number.isNaN(this.position.y);toTag(){if(!this.isValid){const n=[this.hasValidDimensions()?void 0:"dimensions is invalid",this.hasValidPosition()?void 0:"position is invalid"].filter(Boolean);throw new Error(`Invalid sticker: ${n.join(", ")}`)}let t;switch(this.type){case"event":t=this.value.tagId();break;case"pubkey":t=this.value.pubkey;break;default:t=this.value}const r=["sticker",this.type,t,coordinates(this.position),dimension(this.dimension)];if(this.properties)for(const[n,s]of Object.entries(this.properties))r.push(`${n} ${s}`);return r}},NDKStory=class Jd extends NDKEvent{static kind=23;static kinds=[23];_imeta;_dimensions;constructor(t,r){if(super(t,r),this.kind??=23,r)for(const n of r.tags)switch(n[0]){case"imeta":this._imeta=mapImetaTag(n);break;case"dim":this.dimensions=strToDimension(n[1]);break}}static from(t){return new Jd(t.ndk,t)}get isValid(){return!!this.imeta}get imeta(){return this._imeta}set imeta(t){this._imeta=t,this.tags=this.tags.filter(r=>r[0]!=="imeta"),t&&this.tags.push(imetaTagToTag(t))}get dimensions(){const t=this.tagValue("dim");if(t)return strToDimension(t)}set dimensions(t){this.removeTag("dim"),t&&this.tags.push(["dim",`${t.width}x${t.height}`])}get duration(){const t=this.tagValue("dur");if(t)return Number.parseInt(t)}set duration(t){this.removeTag("dur"),t!==void 0&&this.tags.push(["dur",t.toString()])}get stickers(){const t=[];for(const r of this.tags){if(r[0]!=="sticker"||r.length<5)continue;const n=NDKStorySticker.fromTag(r);n&&t.push(n)}return t}addSticker(t){let r;if(t instanceof NDKStorySticker)r=t;else{const n=["sticker",t.type,typeof t.value=="string"?t.value:"",coordinates(t.position),dimension(t.dimension)];if(t.properties)for(const[s,a]of Object.entries(t.properties))n.push(`${s} ${a}`);r=new NDKStorySticker(n),r.value=t.value}r.type==="pubkey"?this.tag(r.value):r.type==="event"&&this.tag(r.value),this.tags.push(r.toTag())}removeSticker(t){const r=this.stickers;if(t<0||t>=r.length)return;let n=0;for(let s=0;s<this.tags.length;s++)if(this.tags[s][0]==="sticker"){if(n===t){this.tags.splice(s,1);break}n++}}},coordinates=e=>`${e.x},${e.y}`,dimension=e=>`${e.width}x${e.height}`,NDKSubscriptionReceipt=class eh extends NDKEvent{debug;static kinds=[7003];constructor(t,r){super(t,r),this.kind??=7003,this.debug=t?.debug.extend("subscription-start")??createDebug5("ndk:subscription-start")}static from(t){return new eh(t.ndk,t.rawEvent())}get recipient(){const t=this.getMatchingTags("p")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set recipient(t){this.removeTag("p"),t&&this.tags.push(["p",t.pubkey])}get subscriber(){const t=this.getMatchingTags("P")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set subscriber(t){this.removeTag("P"),t&&this.tags.push(["P",t.pubkey])}set subscriptionStart(t){this.debug(`before setting subscription start: ${this.rawEvent}`),this.removeTag("e"),this.tag(t,"subscription",!0),this.debug(`after setting subscription start: ${this.rawEvent}`)}get tierName(){return this.getMatchingTags("tier")?.[0]?.[1]}get isValid(){const t=this.validPeriod;if(!t||t.start>t.end)return!1;const r=this.getMatchingTags("p"),n=this.getMatchingTags("P");return!(r.length!==1||n.length!==1)}get validPeriod(){const t=this.getMatchingTags("valid")?.[0];if(t)try{return{start:new Date(Number.parseInt(t[1])*1e3),end:new Date(Number.parseInt(t[2])*1e3)}}catch{return}}set validPeriod(t){this.removeTag("valid"),t&&this.tags.push(["valid",Math.floor(t.start.getTime()/1e3).toString(),Math.floor(t.end.getTime()/1e3).toString()])}get startPeriod(){return this.validPeriod?.start}get endPeriod(){return this.validPeriod?.end}isActive(t){t??=new Date;const r=this.validPeriod;return!(!r||t<r.start||t>r.end)}},possibleIntervalFrequencies=["daily","weekly","monthly","quarterly","yearly"];function newAmount(e,t,r){return["amount",e.toString(),t,r]}function parseTagToSubscriptionAmount(e){const t=Number.parseInt(e[1]);if(Number.isNaN(t)||t===void 0||t===null||t<=0)return;const r=e[2];if(r===void 0||r==="")return;const n=e[3];if(n!==void 0&&possibleIntervalFrequencies.includes(n))return{amount:t,currency:r,term:n}}var NDKSubscriptionTier=class th extends NDKArticle{static kind=37001;static kinds=[37001];constructor(t,r){const n=r?.kind??37001;super(t,r),this.kind=n}static from(t){return new th(t.ndk,t)}get perks(){return this.getMatchingTags("perk").map(t=>t[1]).filter(t=>t!==void 0)}addPerk(t){this.tags.push(["perk",t])}get amounts(){return this.getMatchingTags("amount").map(t=>parseTagToSubscriptionAmount(t)).filter(t=>t!==void 0)}addAmount(t,r,n){this.tags.push(newAmount(t,r,n))}set relayUrl(t){this.tags.push(["r",t])}get relayUrls(){return this.getMatchingTags("r").map(t=>t[1]).filter(t=>t!==void 0)}get verifierPubkey(){return this.tagValue("p")}set verifierPubkey(t){this.removeTag("p"),t&&this.tags.push(["p",t])}get isValid(){return this.title!==void 0&&this.amounts.length>0}},NDKSubscriptionStart=class rh extends NDKEvent{debug;static kinds=[7001];constructor(t,r){super(t,r),this.kind??=7001,this.debug=t?.debug.extend("subscription-start")??createDebug5("ndk:subscription-start")}static from(t){return new rh(t.ndk,t.rawEvent())}get recipient(){const t=this.getMatchingTags("p")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set recipient(t){this.removeTag("p"),t&&this.tags.push(["p",t.pubkey])}get amount(){const t=this.getMatchingTags("amount")?.[0];if(t)return parseTagToSubscriptionAmount(t)}set amount(t){this.removeTag("amount"),t&&this.tags.push(newAmount(t.amount,t.currency,t.term))}get tierId(){const t=this.getMatchingTags("e")?.[0],r=this.getMatchingTags("a")?.[0];if(!(!t||!r))return t[1]??r[1]}set tier(t){this.removeTag("e"),this.removeTag("a"),this.removeTag("event"),t&&(this.tag(t),this.removeTag("p"),this.tags.push(["p",t.pubkey]),this.tags.push(["event",JSON.stringify(t.rawEvent())]))}async fetchTier(){const t=this.tagValue("event");if(t)try{const s=JSON.parse(t);return new NDKSubscriptionTier(this.ndk,s)}catch{this.debug("Failed to parse event tag")}const r=this.tierId;if(!r)return;const n=await this.ndk?.fetchEvent(r);if(n)return NDKSubscriptionTier.from(n)}get isValid(){return this.getMatchingTags("amount").length!==1?(this.debug("Invalid # of amount tag"),!1):this.amount?this.getMatchingTags("p").length!==1?(this.debug("Invalid # of p tag"),!1):this.recipient?!0:(this.debug("Invalid p tag"),!1):(this.debug("Invalid amount tag"),!1)}},NDKTask=class nh extends NDKEvent{static kind=1934;static kinds=[1934];constructor(t,r){super(t,r),this.kind=1934}static from(t){return new nh(t.ndk,t.rawEvent())}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get title(){return this.tagValue("title")}set project(t){this.removeTag("a"),this.tags.push(t.tagReference())}get projectSlug(){const t=this.getMatchingTags("a")[0];return t?t[1].split(/:/)?.[2]:void 0}},NDKThread=class sh extends NDKEvent{static kind=11;static kinds=[11];constructor(t,r){super(t,r),this.kind??=11}static from(t){return new sh(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}},NDKVideo=class ih extends NDKEvent{static kind=21;static kinds=[34235,34236,22,21];_imetas;static from(t){return new ih(t.ndk,t.rawEvent())}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get thumbnail(){let t;return this.imetas&&this.imetas.length>0&&(t=this.imetas[0].image?.[0]),t??this.tagValue("thumb")}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(t=>t[0]==="imeta").map(mapImetaTag),this._imetas)}set imetas(t){this._imetas=t,this.tags=this.tags.filter(r=>r[0]!=="imeta"),this.tags.push(...t.map(imetaTagToTag))}get url(){return this.imetas&&this.imetas.length>0?this.imetas[0].url:this.tagValue("url")}get published_at(){const t=this.tagValue("published_at");if(t)return Number.parseInt(t)}async generateTags(){if(super.generateTags(),!this.kind&&this.imetas?.[0]?.dim){const[t,r]=this.imetas[0].dim.split("x"),n=t&&r&&Number.parseInt(t)<Number.parseInt(r);this.duration&&this.duration<120&&n?this.kind=22:this.kind=21}return super.generateTags()}get duration(){const t=this.tagValue("duration");if(t)return Number.parseInt(t)}set duration(t){this.removeTag("duration"),t!==void 0&&this.tags.push(["duration",Math.floor(t).toString()])}},NDKWiki=class oh extends NDKArticle{static kind=30818;static kinds=[30818];static from(t){return new oh(t.ndk,t.rawEvent())}get isDefered(){return this.hasTag("a","defer")}get deferedId(){return this.tagValue("a","defer")}set defer(t){this.removeTag("a","defer"),this.tag(t,"defer")}},NDKWikiMergeRequest=class ah extends NDKEvent{static kinds=[818];static from(t){return new ah(t.ndk,t.rawEvent())}get targetId(){return this.tagValue("a")}set target(t){this.tags=this.tags.filter(r=>{if(r[0]==="a"||r[0]==="e"&&r[3]!=="source")return!0}),this.tag(t)}get sourceId(){return this.tagValue("e","source")}set source(t){this.removeTag("e","source"),this.tag(t,"source",!1,"e")}},registeredEventClasses=new Set;function wrapEvent(e){const t=new Map,n=[...[NDKImage,NDKVideo,NDKCashuMintList,NDKArticle,NDKHighlight,NDKDraft,NDKWiki,NDKWikiMergeRequest,NDKNutzap,NDKProject,NDKTask,NDKProjectTemplate,NDKSimpleGroupMemberList,NDKSimpleGroupMetadata,NDKSubscriptionTier,NDKSubscriptionStart,NDKSubscriptionReceipt,NDKList,NDKRelayList,NDKStory,NDKBlossomList,NDKFollowPack,NDKThread,NDKRepost,NDKClassified,NDKAppHandlerEvent,NDKDVMJobFeedback,NDKCashuMintAnnouncement,NDKFedimintMint,NDKMintRecommendation],...registeredEventClasses];for(const a of n)for(const l of a.kinds)t.set(l,a);const s=t.get(e.kind);return s?s.from(e):e}function checkMissingKind(e,t){(e.kind===void 0||e.kind===null)&&t("event-missing-kind",`Cannot sign event without 'kind'.

 Event data:
    content: ${e.content?`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`:"(empty)"}
    tags: ${e.tags.length} tag${e.tags.length!==1?"s":""}
    kind: ${e.kind} 

Set event.kind before signing.`,"Example: event.kind = 1; // for text note",!1)}function checkContentIsObject(e,t){if(typeof e.content=="object"){const r=JSON.stringify(e.content,null,2).substring(0,200);t("event-content-is-object",`Event content is an object. Content must be a string.

 Your content (${typeof e.content}):
${r}${JSON.stringify(e.content).length>200?"...":""}

 event.content = { ... }  // WRONG
 event.content = JSON.stringify({ ... })  // CORRECT`,"Use JSON.stringify() for structured data: event.content = JSON.stringify(data)",!1)}}function checkCreatedAtMilliseconds(e,t){if(e.created_at&&e.created_at>1e10){const r=Math.floor(e.created_at/1e3),n=new Date(e.created_at).toISOString();t("event-created-at-milliseconds",`Event created_at is in milliseconds, not seconds.

 Your value:
    created_at: ${e.created_at} 
    Interpreted as: ${n}
    Should be: ${r} 

Nostr timestamps MUST be in seconds since Unix epoch.`,"Use Math.floor(Date.now() / 1000) instead of Date.now()",!1)}}function checkInvalidPTags(e,t){e.getMatchingTags("p").forEach((n,s)=>{if(n[1]&&!/^[0-9a-f]{64}$/i.test(n[1])){const a=JSON.stringify(n);t("tag-invalid-p-tag",`p-tag[${s}] has invalid pubkey.

 Your tag:
   ${a}

 Invalid value: "${n[1]}"
    Length: ${n[1].length} (expected 64)
    Format: ${n[1].startsWith("npub")?"bech32 (npub)":"unknown"}

p-tags MUST contain 64-character hex pubkeys.`,n[1].startsWith("npub")?`Use ndkUser.pubkey instead of npub:
    event.tags.push(['p', ndkUser.pubkey])
    event.tags.push(['p', 'npub1...'])`:"p-tags must contain valid hex pubkeys (64 characters, 0-9a-f)",!1)}})}function checkInvalidETags(e,t){e.getMatchingTags("e").forEach((n,s)=>{if(n[1]&&!/^[0-9a-f]{64}$/i.test(n[1])){const a=JSON.stringify(n),l=n[1].startsWith("note")||n[1].startsWith("nevent");t("tag-invalid-e-tag",`e-tag[${s}] has invalid event ID.

 Your tag:
   ${a}

 Invalid value: "${n[1]}"
    Length: ${n[1].length} (expected 64)
    Format: ${l?"bech32 (note/nevent)":"unknown"}

e-tags MUST contain 64-character hex event IDs.`,l?`Use event.id instead of bech32:
    event.tags.push(['e', referencedEvent.id])
    event.tags.push(['e', 'note1...'])`:"e-tags must contain valid hex event IDs (64 characters, 0-9a-f)",!1)}})}function checkManualReplyMarkers(e,t,r){if(e.kind!==1||r.has(e))return;const n=e.tags.filter(s=>s[0]==="e"&&(s[3]==="reply"||s[3]==="root"));if(n.length>0){const s=n.map((a,l)=>`   ${l+1}. ${JSON.stringify(a)}`).join(`
`);t("event-manual-reply-markers",`Event has ${n.length} e-tag(s) with manual reply/root markers.

 Your tags with markers:
${s}

  Manual reply markers detected! This will cause incorrect threading.`,`Reply events MUST be created using .reply():

    CORRECT:
   const replyEvent = originalEvent.reply();
   replyEvent.content = 'good point!';
   await replyEvent.publish();

    WRONG:
   event.tags.push(['e', eventId, '', 'reply']);

NDK handles all reply threading automatically - never add reply/root markers manually.`)}}function checkHashtagsWithPrefix(e,t){e.getMatchingTags("t").forEach((n,s)=>{if(n[1]&&n[1].startsWith("#")){const a=JSON.stringify(n);t("tag-hashtag-with-prefix",`t-tag[${s}] contains hashtag with # prefix.

 Your tag:
   ${a}

 Invalid value: "${n[1]}"

Hashtag tags should NOT include the # symbol.`,`Remove the # prefix from hashtag tags:
    event.tags.push(['t', 'nostr'])
    event.tags.push(['t', '#nostr'])`,!1)}})}function checkReplaceableWithOldTimestamp(e,t){if(e.kind===void 0||e.kind===null||!e.created_at||!e.isReplaceable())return;const r=Math.floor(Date.now()/1e3),n=r-e.created_at;if(n>10){const a=Math.floor(n/60),l=a>0?`${a} minute${a!==1?"s":""}`:`${n} seconds`;t("event-replaceable-old-timestamp",`Publishing a replaceable event with an old created_at timestamp.

 Event details:
    kind: ${e.kind} (replaceable)
    created_at: ${e.created_at}
    age: ${l} old
    current time: ${r}

  This is wrong and will be rejected by relays.`,`For replaceable events, use publishReplaceable():

    CORRECT:
   await event.publishReplaceable();
   // Automatically updates created_at to now

    WRONG:
   await event.publish();
   // Uses old created_at`)}}function signing(e,t,r,n){checkMissingKind(e,t),checkContentIsObject(e,t),checkCreatedAtMilliseconds(e,t),checkInvalidPTags(e,t),checkInvalidETags(e,t),checkHashtagsWithPrefix(e,t),checkManualReplyMarkers(e,r,n)}function publishing(e,t){checkReplaceableWithOldTimestamp(e,t)}function isNip33Pattern(e){const t=Array.isArray(e)?e:[e];if(t.length!==1)return!1;const r=t[0];return r.kinds&&Array.isArray(r.kinds)&&r.kinds.length===1&&r.authors&&Array.isArray(r.authors)&&r.authors.length===1&&r["#d"]&&Array.isArray(r["#d"])&&r["#d"].length===1}function isReplaceableEventFilter(e){const t=Array.isArray(e)?e:[e];return t.length===0?!1:t.every(r=>!r.kinds||!Array.isArray(r.kinds)||r.kinds.length===0||!r.authors||!Array.isArray(r.authors)||r.authors.length===0?!1:r.kinds.every(s=>s===0||s===3||s>=1e4&&s<=19999))}function formatFilter(e){return JSON.stringify(e,null,2).split(`
`).map((r,n)=>n===0?r:`   ${r}`).join(`
`)}function fetchingEvents(e,t,r,n,s){if(s(),t?.cacheUsage==="ONLY_CACHE")return;const a=Array.isArray(e)?e:[e],l=a.map(formatFilter).join(`

   ---

   `);if(isNip33Pattern(e))a[0],r("fetch-events-usage",`For fetching a NIP-33 addressable event, use fetchEvent() with the naddr directly.

 Your filter:
   `+l+`

   BAD:  const decoded = nip19.decode(naddr);
           const events = await ndk.fetchEvents({
             kinds: [decoded.data.kind],
             authors: [decoded.data.pubkey],
             "#d": [decoded.data.identifier]
           });
           const event = Array.from(events)[0];

   GOOD: const event = await ndk.fetchEvent(naddr);
   GOOD: const event = await ndk.fetchEvent('naddr1...');

fetchEvent() handles naddr decoding automatically and returns the event directly.`);else{if(isReplaceableEventFilter(e))return;{if(!n())return;let u="";const x=a.some(g=>g.limit!==void 0),f=new Set(a.flatMap(g=>g.kinds||[])).size,p=new Set(a.flatMap(g=>g.authors||[])).size;if(x){const g=Math.max(...a.map(y=>y.limit||0));u+=`
    Limit: ${g} event${g!==1?"s":""}`}f>0&&(u+=`
    Kinds: ${f} type${f!==1?"s":""}`),p>0&&(u+=`
    Authors: ${p} author${p!==1?"s":""}`),r("fetch-events-usage",`fetchEvents() is a BLOCKING operation that waits for EOSE.
In most cases, you should use subscribe() instead.

 Your filter`+(a.length>1?"s":"")+`:
   `+l+(u?`

 Filter analysis:`+u:"")+`

   BAD:  const events = await ndk.fetchEvents(filter);
   GOOD: ndk.subscribe(filter, { onEvent: (e) => ... });

Only use fetchEvents() when you MUST block until data arrives.`,"For one-time queries, use fetchEvent() instead of fetchEvents() when expecting a single result.")}}}var GuardrailCheckId={NDK_NO_CACHE:"ndk-no-cache",FILTER_BECH32_IN_ARRAY:"filter-bech32-in-array",FILTER_INVALID_HEX:"filter-invalid-hex",FILTER_ONLY_LIMIT:"filter-only-limit",FILTER_EMPTY:"filter-empty",FILTER_SINCE_AFTER_UNTIL:"filter-since-after-until",FILTER_INVALID_A_TAG:"filter-invalid-a-tag",FILTER_HASHTAG_WITH_PREFIX:"filter-hashtag-with-prefix"};function checkCachePresence(e,t){t(GuardrailCheckId.NDK_NO_CACHE)&&setTimeout(()=>{if(!e.cacheAdapter){const s=`
 AI_GUARDRAILS WARNING: NDK initialized without a cache adapter. Apps perform significantly better with caching.

 ${typeof window<"u"?"Consider using @nostr-dev-kit/ndk-cache-dexie or @nostr-dev-kit/ndk-cache-sqlite-wasm":"Consider using @nostr-dev-kit/ndk-cache-redis or @nostr-dev-kit/ndk-cache-sqlite"}

 To disable this check:
   ndk.aiGuardrails.skip('${GuardrailCheckId.NDK_NO_CACHE}')
   or set: ndk.aiGuardrails = { skip: new Set(['${GuardrailCheckId.NDK_NO_CACHE}']) }`;console.warn(s)}},2500)}var AIGuardrails=class{enabled=!1;skipSet=new Set;extensions=new Map;_nextCallDisabled=null;_replyEvents=new WeakSet;_fetchEventsCount=0;_subscribeCount=0;constructor(e=!1){this.setMode(e)}register(e,t){this.extensions.has(e)&&console.warn(`AIGuardrails: Extension '${e}' already registered, overwriting`);const r={};for(const[n,s]of Object.entries(t))typeof s=="function"&&(r[n]=(...a)=>{this.enabled&&s(...a,this.shouldCheck.bind(this),this.error.bind(this),this.warn.bind(this))});this.extensions.set(e,r),this[e]=r}setMode(e){typeof e=="boolean"?(this.enabled=e,this.skipSet.clear()):e&&typeof e=="object"&&(this.enabled=!0,this.skipSet=e.skip||new Set)}isEnabled(){return this.enabled}shouldCheck(e){return!(!this.enabled||this.skipSet.has(e)||this._nextCallDisabled==="all"||this._nextCallDisabled&&this._nextCallDisabled.has(e))}skip(e){this.skipSet.add(e)}enable(e){this.skipSet.delete(e)}getSkipped(){return Array.from(this.skipSet)}captureAndClearNextCallDisabled(){const e=this._nextCallDisabled;return this._nextCallDisabled=null,e}incrementFetchEventsCount(){this._fetchEventsCount++}incrementSubscribeCount(){this._subscribeCount++}shouldWarnAboutFetchEventsRatio(){const e=this._fetchEventsCount+this._subscribeCount;return e<=6?!1:this._fetchEventsCount/e>.5}error(e,t,r,n=!0){if(!this.shouldCheck(e))return;const s=this.formatMessage(e,"ERROR",t,r,n);throw console.error(s),new Error(s)}warn(e,t,r){if(!this.shouldCheck(e))return;const n=this.formatMessage(e,"WARNING",t,r,!0);throw console.error(n),new Error(n)}formatMessage(e,t,r,n,s=!0){let a=`
 AI_GUARDRAILS ${t}: ${r}`;return n&&(a+=`

 ${n}`),s&&(a+=`

 To disable this check:
   ndk.guardrailOff('${e}').yourMethod()  // For one call`,a+=`
   ndk.aiGuardrails.skip('${e}')  // Permanently`,a+=`
   or set: ndk.aiGuardrails = { skip: new Set(['${e}']) }`),a}ndkInstantiated(e){this.enabled&&checkCachePresence(e,this.shouldCheck.bind(this))}ndk={fetchingEvents:(e,t)=>{this.enabled&&fetchingEvents(e,t,this.warn.bind(this),this.shouldWarnAboutFetchEventsRatio.bind(this),this.incrementFetchEventsCount.bind(this))}};event={signing:e=>{this.enabled&&signing(e,this.error.bind(this),this.warn.bind(this),this._replyEvents)},publishing:e=>{this.enabled&&publishing(e,this.warn.bind(this))},received:(e,t)=>{this.enabled},creatingReply:e=>{this.enabled&&this._replyEvents.add(e)}};subscription={created:(e,t)=>{this.enabled&&this.incrementSubscribeCount()}};relay={connected:e=>{this.enabled}}};function processFilters(e,t="validate",r,n){if(t==="ignore")return e;const s=[],a=e.map((l,u)=>(n?.aiGuardrails.isEnabled()&&runAIGuardrailsForFilter(l,u,n),processFilter(l,t,u,s,r)));if(t==="validate"&&s.length>0)throw new Error(`Invalid filter(s) detected:
${s.join(`
`)}`);return a}function processFilter(e,t,r,n,s){const a=t==="validate",l=a?e:{...e};if(e.ids){const u=[];e.ids.forEach((x,f)=>{x===void 0?a?n.push(`Filter[${r}].ids[${f}] is undefined`):s?.(`Fixed: Removed undefined value at ids[${f}]`):typeof x!="string"?a?n.push(`Filter[${r}].ids[${f}] is not a string (got ${typeof x})`):s?.(`Fixed: Removed non-string value at ids[${f}] (was ${typeof x})`):isValidHex64(x)?u.push(x):a?n.push(`Filter[${r}].ids[${f}] is not a valid 64-char hex string: "${x}"`):s?.(`Fixed: Removed invalid hex string at ids[${f}]`)}),a||(l.ids=u.length>0?u:void 0)}if(e.authors){const u=[];e.authors.forEach((x,f)=>{x===void 0?a?n.push(`Filter[${r}].authors[${f}] is undefined`):s?.(`Fixed: Removed undefined value at authors[${f}]`):typeof x!="string"?a?n.push(`Filter[${r}].authors[${f}] is not a string (got ${typeof x})`):s?.(`Fixed: Removed non-string value at authors[${f}] (was ${typeof x})`):isValidHex64(x)?u.push(x):a?n.push(`Filter[${r}].authors[${f}] is not a valid 64-char hex pubkey: "${x}"`):s?.(`Fixed: Removed invalid hex pubkey at authors[${f}]`)}),a||(l.authors=u.length>0?u:void 0)}if(e.kinds){const u=[];e.kinds.forEach((x,f)=>{x===void 0?a?n.push(`Filter[${r}].kinds[${f}] is undefined`):s?.(`Fixed: Removed undefined value at kinds[${f}]`):typeof x!="number"?a?n.push(`Filter[${r}].kinds[${f}] is not a number (got ${typeof x})`):s?.(`Fixed: Removed non-number value at kinds[${f}] (was ${typeof x})`):Number.isInteger(x)?x<0||x>65535?a?n.push(`Filter[${r}].kinds[${f}] is out of valid range (0-65535): ${x}`):s?.(`Fixed: Removed out-of-range kind at kinds[${f}]: ${x}`):u.push(x):a?n.push(`Filter[${r}].kinds[${f}] is not an integer: ${x}`):s?.(`Fixed: Removed non-integer value at kinds[${f}]: ${x}`)}),a||(l.kinds=u.length>0?u:void 0)}for(const u in e)if(u.startsWith("#")&&u.length===2){const x=e[u];if(Array.isArray(x)){const f=[];x.forEach((p,g)=>{p===void 0?a?n.push(`Filter[${r}].${u}[${g}] is undefined`):s?.(`Fixed: Removed undefined value at ${u}[${g}]`):typeof p!="string"?a?n.push(`Filter[${r}].${u}[${g}] is not a string (got ${typeof p})`):s?.(`Fixed: Removed non-string value at ${u}[${g}] (was ${typeof p})`):(u==="#e"||u==="#p")&&!isValidHex64(p)?a?n.push(`Filter[${r}].${u}[${g}] is not a valid 64-char hex string: "${p}"`):s?.(`Fixed: Removed invalid hex string at ${u}[${g}]`):f.push(p)}),a||(l[u]=f.length>0?f:void 0)}}return a||Object.keys(l).forEach(u=>{l[u]===void 0&&delete l[u]}),l}function runAIGuardrailsForFilter(e,t,r){const n=r.aiGuardrails,s=JSON.stringify(e,null,2);if(Object.keys(e).length===1&&e.limit!==void 0&&n.error(GuardrailCheckId.FILTER_ONLY_LIMIT,`Filter[${t}] contains only 'limit' without any filtering criteria.

 Your filter:
${s}

  This will fetch random events from relays without any criteria.`,`Add filtering criteria:
    { kinds: [1], limit: 10 }
    { authors: [pubkey], limit: 10 }
    { limit: 10 }`),Object.keys(e).length===0&&n.error(GuardrailCheckId.FILTER_EMPTY,`Filter[${t}] is empty.

 Your filter:
${s}

  This will request ALL events from relays, which is never what you want.`,"Add filtering criteria like 'kinds', 'authors', or tags.",!1),e.since!==void 0&&e.until!==void 0&&e.since>e.until){const l=new Date(e.since*1e3).toISOString(),u=new Date(e.until*1e3).toISOString();n.error(GuardrailCheckId.FILTER_SINCE_AFTER_UNTIL,`Filter[${t}] has 'since' AFTER 'until'.

 Your filter:
${s}

 since: ${e.since} (${l})
 until: ${e.until} (${u})

No events can match this time range!`,"'since' must be BEFORE 'until'. Both are Unix timestamps in seconds.",!1)}const a=/^n(addr|event|ote|pub|profile)1/;e.ids&&e.ids.forEach((l,u)=>{typeof l=="string"&&(a.test(l)?n.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].ids[${u}] contains bech32: "${l}". IDs must be hex, not bech32.`,'Use filterFromId() to decode bech32 first: import { filterFromId } from "@nostr-dev-kit/ndk"',!1):isValidHex64(l)||n.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].ids[${u}] is not a valid 64-char hex string: "${l}"`,`Event IDs must be 64-character hexadecimal strings. Invalid IDs often come from corrupted data in user-generated lists. Always validate hex strings before using them in filters:

   const validIds = ids.filter(id => /^[0-9a-f]{64}$/i.test(id));`,!1))}),e.authors&&e.authors.forEach((l,u)=>{typeof l=="string"&&(a.test(l)?n.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].authors[${u}] contains bech32: "${l}". Authors must be hex pubkeys, not npub.`,"Use ndkUser.pubkey instead. Example: { authors: [ndkUser.pubkey] }",!1):isValidHex64(l)||n.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].authors[${u}] is not a valid 64-char hex pubkey: "${l}"`,`Kind:3 follow lists can contain invalid entries like labels ("Follow List"), partial strings ("highlig"), or other corrupted data. You MUST validate all pubkeys before using them in filters.

   Example:
   const validPubkeys = pubkeys.filter(p => /^[0-9a-f]{64}$/i.test(p));
   ndk.subscribe({ authors: validPubkeys, kinds: [1] });`,!1))});for(const l in e)if(l.startsWith("#")&&l.length===2){const u=e[l];Array.isArray(u)&&u.forEach((x,f)=>{typeof x=="string"&&(l==="#e"||l==="#p")&&(a.test(x)?n.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].${l}[${f}] contains bech32: "${x}". Tag values must be decoded.`,"Use filterFromId() or nip19.decode() to get the hex value first.",!1):isValidHex64(x)||n.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].${l}[${f}] is not a valid 64-char hex string: "${x}"`,`${l==="#e"?"Event IDs":"Public keys"} in tag filters must be 64-character hexadecimal strings. Kind:3 follow lists and other user-generated content can contain invalid data. Always filter before using:

   const validValues = values.filter(v => /^[0-9a-f]{64}$/i.test(v));`,!1))})}e["#a"]&&e["#a"]?.forEach((u,x)=>{if(typeof u=="string")if(!/^\d+:[0-9a-f]{64}:.*$/.test(u))n.error(GuardrailCheckId.FILTER_INVALID_A_TAG,`Filter[${t}].#a[${x}] has invalid format: "${u}". Must be "kind:pubkey:d-tag".`,'Example: "30023:fa984bd7dbb282f07e16e7ae87b26a2a7b9b90b7246a44771f0cf5ae58018f52:my-article"',!1);else{const f=Number.parseInt(u.split(":")[0],10);(f<3e4||f>39999)&&n.error(GuardrailCheckId.FILTER_INVALID_A_TAG,`Filter[${t}].#a[${x}] uses non-addressable kind ${f}: "${u}". #a filters are only for addressable events (kinds 30000-39999).`,`Addressable events include:
    30000-30039: Parameterized Replaceable Events (profiles, settings, etc.)
    30040-39999: Other addressable events

For regular events (kind ${f}), use:
    #e filter for specific event IDs
    kinds + authors filters for event queries`,!1)}}),e["#t"]&&e["#t"]?.forEach((u,x)=>{typeof u=="string"&&u.startsWith("#")&&n.error(GuardrailCheckId.FILTER_HASHTAG_WITH_PREFIX,`Filter[${t}].#t[${x}] contains hashtag with # prefix: "${u}". Hashtag values should NOT include the # symbol.`,`Remove the # prefix from hashtag filters:
    { "#t": ["nostr"] }
    { "#t": ["#nostr"] }`,!1)})}function queryFullyFilled(e){return!!(filterIncludesIds(e.filter)&&resultHasAllRequestedIds(e))}function filterIncludesIds(e){return!!e.ids}function resultHasAllRequestedIds(e){const t=e.filter.ids;return!!t&&t.length===e.eventFirstSeen.size}function filterFromId(e){let t;if(e.match(NIP33_A_REGEX)){const[r,n,s]=e.split(":"),a={authors:[n],kinds:[Number.parseInt(r)]};return s&&(a["#d"]=[s]),a}if(e.match(BECH32_REGEX))try{switch(t=nip19_exports$1.decode(e),t.type){case"nevent":{const r={ids:[t.data.id]};return t.data.author&&(r.authors=[t.data.author]),t.data.kind&&(r.kinds=[t.data.kind]),r}case"note":return{ids:[t.data]};case"naddr":{const r={authors:[t.data.pubkey],kinds:[t.data.kind]};return t.data.identifier&&(r["#d"]=[t.data.identifier]),r}}}catch(r){console.error("Error decoding",e,r)}return{ids:[e]}}function isNip33AValue(e){return e.match(NIP33_A_REGEX)!==null}var NIP33_A_REGEX=/^(\d+):([0-9A-Fa-f]+)(?::(.*))?$/,BECH32_REGEX=/^n(event|ote|profile|pub|addr)1[\d\w]+$/;function relaysFromBech32(e,t){try{const r=nip19_exports$1.decode(e);if(["naddr","nevent"].includes(r?.type)){const n=r.data;if(n?.relays)return n.relays.map(s=>new NDKRelay(s,t.relayAuthDefaultPolicy,t))}}catch{}return[]}var defaultOpts={closeOnEose:!1,cacheUsage:"CACHE_FIRST",dontSaveToCache:!1,groupable:!0,groupableDelay:100,groupableDelayType:"at-most",cacheUnconstrainFilter:["limit","since","until"],includeMuted:!1},NDKSubscription=class extends libExports.EventEmitter{subId;filters;opts;pool;skipVerification=!1;skipValidation=!1;exclusiveRelay=!1;relayFilters;relaySet;ndk;debug;eventFirstSeen=new Map;eosesSeen=new Set;lastEventReceivedAt;mostRecentCacheEventTimestamp;internalId;closeOnEose;poolMonitor;skipOptimisticPublishEvent=!1;cacheUnconstrainFilter;constructor(e,t,r,n){super(),this.ndk=e,this.opts={...defaultOpts,...r||{}},this.pool=this.opts.pool||e.pool;const s=Array.isArray(t)?t:[t],a=e.filterValidationMode==="validate"?"validate":e.filterValidationMode==="fix"?"fix":"ignore";if(this.filters=processFilters(s,a,e.debug,e),this.filters.length===0)throw new Error("Subscription must have at least one filter");this.subId=n||this.opts.subId,this.internalId=Math.random().toString(36).substring(7),this.debug=e.debug.extend(`subscription[${this.opts.subId??this.internalId}]`),this.opts.relaySet?this.relaySet=this.opts.relaySet:this.opts.relayUrls&&(this.relaySet=NDKRelaySet.fromRelayUrls(this.opts.relayUrls,this.ndk)),this.skipVerification=this.opts.skipVerification||!1,this.skipValidation=this.opts.skipValidation||!1,this.closeOnEose=this.opts.closeOnEose||!1,this.skipOptimisticPublishEvent=this.opts.skipOptimisticPublishEvent||!1,this.cacheUnconstrainFilter=this.opts.cacheUnconstrainFilter,this.exclusiveRelay=this.opts.exclusiveRelay||!1,this.opts.onEvent&&this.on("event",this.opts.onEvent),this.opts.onEose&&this.on("eose",this.opts.onEose),this.opts.onClose&&this.on("close",this.opts.onClose)}relaysMissingEose(){return this.relayFilters?Array.from(this.relayFilters?.keys()).filter(t=>!this.eosesSeen.has(this.pool.getRelay(t,!1,!1))):[]}get filter(){return this.filters[0]}get groupableDelay(){if(this.isGroupable())return this.opts?.groupableDelay}get groupableDelayType(){return this.opts?.groupableDelayType||"at-most"}isGroupable(){return this.opts?.groupable||!1}shouldQueryCache(){return this.opts.addSinceFromCache?!0:this.opts?.cacheUsage==="ONLY_RELAY"?!1:(this.filters.some(t=>t.kinds?.some(r=>kindIsEphemeral(r))),!0)}shouldQueryRelays(){return this.opts?.cacheUsage!=="ONLY_CACHE"}shouldWaitForCache(){return this.opts.addSinceFromCache?!0:!!this.opts.closeOnEose&&!!this.ndk.cacheAdapter?.locking&&this.opts.cacheUsage!=="PARALLEL"}start(e=!0){let t;const r=s=>{for(const a of s)a.created_at&&(!this.mostRecentCacheEventTimestamp||a.created_at>this.mostRecentCacheEventTimestamp)&&(this.mostRecentCacheEventTimestamp=a.created_at),this.eventReceived(a,void 0,!0,!1);e||(t=s)},n=()=>{this.shouldQueryRelays()?(this.startWithRelays(),this.startPoolMonitor()):this.emit("eose",this)};return this.shouldQueryCache()?(t=this.startWithCache(),t instanceof Promise?this.shouldWaitForCache()?(t.then(s=>{if(r(s),queryFullyFilled(this)){this.emit("eose",this);return}n()}),null):(t.then(s=>{r(s),this.shouldQueryRelays()||this.emit("eose",this)}),this.shouldQueryRelays()&&n(),null):(r(t),queryFullyFilled(this)?this.emit("eose",this):n(),t)):(n(),null)}startPoolMonitor(){this.debug.extend("pool-monitor"),this.poolMonitor=e=>{if(this.relayFilters?.has(e.url))return;calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool,this.opts.relayGoalPerAuthor).get(e.url)&&(this.relayFilters?.set(e.url,this.filters),e.subscribe(this,this.filters))},this.pool.on("relay:connect",this.poolMonitor)}onStopped;stop(){this.emit("close",this),this.poolMonitor&&this.pool.off("relay:connect",this.poolMonitor),this.onStopped?.()}hasAuthorsFilter(){return this.filters.some(e=>e.authors?.length)}startWithCache(){return this.ndk.cacheAdapter?.query?this.ndk.cacheAdapter.query(this):[]}startWithRelays(){let e=this.filters;if(this.opts.addSinceFromCache&&this.mostRecentCacheEventTimestamp){const t=this.mostRecentCacheEventTimestamp+1;e=e.map(r=>({...r,since:Math.max(r.since||0,t)}))}if(!this.relaySet||this.relaySet.relays.size===0)this.relayFilters=calculateRelaySetsFromFilters(this.ndk,e,this.pool,this.opts.relayGoalPerAuthor);else{this.relayFilters=new Map;for(const t of this.relaySet.relays)this.relayFilters.set(t.url,e)}for(const[t,r]of this.relayFilters)this.pool.getRelay(t,!0,!0,r).subscribe(this,r)}refreshRelayConnections(){if(this.relaySet&&this.relaySet.relays.size>0)return;const e=calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool,this.opts.relayGoalPerAuthor);for(const[t,r]of e)this.relayFilters?.has(t)||(this.relayFilters?.set(t,r),this.pool.getRelay(t,!0,!0,r).subscribe(this,r))}eventReceived(e,t,r=!1,n=!1){const s=e.id,a=this.eventFirstSeen.has(s);let l;if(e instanceof NDKEvent&&(l=e),a){const u=Date.now()-(this.eventFirstSeen.get(s)||0);if(this.emit("event:dup",e,t,u,this,r,n),this.opts?.onEventDup&&this.opts.onEventDup(e,t,u,this,r,n),!r&&!n&&t&&this.ndk.cacheAdapter?.setEventDup&&!this.opts.dontSaveToCache&&(l??=e instanceof NDKEvent?e:new NDKEvent(this.ndk,e),this.ndk.cacheAdapter.setEventDup(l,t)),t){const x=verifiedSignatures.get(s);if(x&&typeof x=="string")if(e.sig===x)t.addValidatedEvent();else{const f=e instanceof NDKEvent?e:new NDKEvent(this.ndk,e);this.ndk.reportInvalidSignature(f,t)}}}else{if(l??=new NDKEvent(this.ndk,e),l.ndk=this.ndk,l.relay=t,!r&&!n){if(!this.skipValidation&&!l.isValid){this.debug("Event failed validation %s from relay %s",s,t?.url);return}if(t)if(t.shouldValidateEvent()&&!this.skipVerification)if(l.relay=t,this.ndk.asyncSigVerification)l.verifySignature(!0);else{if(!l.verifySignature(!0)){this.debug("Event failed signature validation",e),this.ndk.reportInvalidSignature(l,t);return}t.addValidatedEvent()}else t.addNonValidatedEvent();this.ndk.cacheAdapter&&!this.opts.dontSaveToCache&&this.ndk.cacheAdapter.setEvent(l,this.filters,t)}if(!this.opts.includeMuted&&this.ndk.muteFilter&&this.ndk.muteFilter(l)){this.debug("Event muted, skipping");return}(!n||this.skipOptimisticPublishEvent!==!0)&&(this.emitEvent(this.opts?.wrap??!1,l,t,r,n),this.eventFirstSeen.set(s,Date.now()))}this.lastEventReceivedAt=Date.now()}emitEvent(e,t,r,n,s){const a=e?wrapEvent(t):t;a instanceof Promise?a.then(l=>this.emitEvent(!1,l,r,n,s)):a&&this.emit("event",a,r,this,n,s)}closedReceived(e,t){this.emit("closed",e,t)}eoseTimeout;eosed=!1;eoseReceived(e){this.debug("EOSE received from %s",e.url),this.eosesSeen.add(e);let t=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0;const r=this.eosesSeen.size===this.relayFilters?.size,n=queryFullyFilled(this),s=a=>{this.debug("Performing EOSE: %s %d",a,this.eosed),!this.eosed&&(this.eoseTimeout&&clearTimeout(this.eoseTimeout),this.emit("eose",this),this.eosed=!0,this.opts?.closeOnEose&&this.stop())};if(n||r)s("query filled or seen all");else if(this.relayFilters){let a=1e3;const l=new Set(this.pool.connectedRelays().map(f=>f.url)),u=Array.from(this.relayFilters.keys()).filter(f=>l.has(f));if(u.length===0){this.debug("No connected relays, waiting for all relays to connect",Array.from(this.relayFilters.keys()).join(", "));return}const x=this.eosesSeen.size/u.length;if(this.debug("Percentage of relays that have sent EOSE",{subId:this.subId,percentageOfRelaysThatHaveSentEose:x,seen:this.eosesSeen.size,total:u.length}),this.eosesSeen.size>=2&&x>=.5){if(a=a*(1-x),a===0){s("time to wait was 0");return}this.eoseTimeout&&clearTimeout(this.eoseTimeout);const f=()=>{t=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0,t!==void 0&&t<20?this.eoseTimeout=setTimeout(f,a):s(`send eose timeout: ${a}`)};this.eoseTimeout=setTimeout(f,a)}}}},kindIsEphemeral=e=>e>=2e4&&e<3e4;async function follows(e,t,r=3){if(!this.ndk)throw new Error("NDK not set");const n=await this.ndk.fetchEvent({kinds:[r],authors:[this.pubkey]},e||{groupable:!1});if(n){const s=new Set;return n.tags.forEach(a=>{a[0]==="p"&&a[1]&&isValidPubkey(a[1])&&s.add(a[1])}),t&&this.ndk?.outboxTracker?.trackUsers(Array.from(s)),[...s].reduce((a,l)=>{const u=new NDKUser({pubkey:l});return u.ndk=this.ndk,a.add(u),a},new Set)}return new Set}var NIP05_REGEX=/^(?:([\w.+-]+)@)?([\w.-]+)$/;async function getNip05For(e,t,r=fetch,n={}){return await e.queuesNip05.add({id:t,func:async()=>{if(e.cacheAdapter?.loadNip05){const x=await e.cacheAdapter.loadNip05(t);if(x!=="missing"){if(x){const f=new NDKUser({pubkey:x.pubkey,relayUrls:x.relays,nip46Urls:x.nip46});return f.ndk=e,f}if(n.cache!=="no-cache")return null}}const s=t.match(NIP05_REGEX);if(!s)return null;const[a,l="_",u]=s;try{const x=await r(`https://${u}/.well-known/nostr.json?name=${l}`,n),{names:f,relays:p,nip46:g}=parseNIP05Result(await x.json()),y=f[l.toLowerCase()];let w=null;return y&&(w={pubkey:y,relays:p?.[y],nip46:g?.[y]}),e?.cacheAdapter?.saveNip05&&e.cacheAdapter.saveNip05(t,w),w}catch(x){return e?.cacheAdapter?.saveNip05&&e?.cacheAdapter.saveNip05(t,null),console.error("Failed to fetch NIP05 for",t,x),null}}})}function parseNIP05Result(e){const t={names:{}};for(const[r,n]of Object.entries(e.names))typeof r=="string"&&typeof n=="string"&&(t.names[r.toLowerCase()]=n);if(e.relays){t.relays={};for(const[r,n]of Object.entries(e.relays))typeof r=="string"&&Array.isArray(n)&&(t.relays[r]=n.filter(s=>typeof s=="string"))}if(e.nip46){t.nip46={};for(const[r,n]of Object.entries(e.nip46))typeof r=="string"&&Array.isArray(n)&&(t.nip46[r]=n.filter(s=>typeof s=="string"))}return t}function profileFromEvent(e){const t={};let r;try{r=JSON.parse(e.content)}catch(n){throw new Error(`Failed to parse profile event: ${n}`)}t.profileEvent=JSON.stringify(e.rawEvent());for(const n of Object.keys(r))switch(n){case"name":t.name=r.name;break;case"display_name":t.displayName=r.display_name;break;case"image":case"picture":t.picture=r.picture||r.image,t.image=t.picture;break;case"banner":t.banner=r.banner;break;case"bio":t.bio=r.bio;break;case"nip05":t.nip05=r.nip05;break;case"lud06":t.lud06=r.lud06;break;case"lud16":t.lud16=r.lud16;break;case"about":t.about=r.about;break;case"website":t.website=r.website;break;default:t[n]=r[n];break}return t.created_at=e.created_at,t}function serializeProfile(e){const t={};for(const[r,n]of Object.entries(e))switch(r){case"username":case"name":t.name=n;break;case"displayName":t.display_name=n;break;case"image":case"picture":t.picture=n;break;case"bio":case"about":t.about=n;break;default:t[r]=n;break}return JSON.stringify(t)}var NDKUser=class ch{ndk;profile;profileEvent;_npub;_pubkey;relayUrls=[];nip46Urls=[];constructor(t){if(t.npub&&(this._npub=t.npub),t.hexpubkey&&(this._pubkey=t.hexpubkey),t.pubkey&&(this._pubkey=t.pubkey),t.relayUrls&&(this.relayUrls=t.relayUrls),t.nip46Urls&&(this.nip46Urls=t.nip46Urls),t.nprofile)try{const r=nip19_exports$1.decode(t.nprofile);r.type==="nprofile"&&(this._pubkey=r.data.pubkey,r.data.relays&&r.data.relays.length>0&&this.relayUrls.push(...r.data.relays))}catch(r){console.error("Failed to decode nprofile",r)}}get npub(){if(!this._npub){if(!this._pubkey)throw new Error("pubkey not set");this._npub=nip19_exports$1.npubEncode(this.pubkey)}return this._npub}get nprofile(){const t=this.profileEvent?.onRelays?.map(r=>r.url);return nip19_exports$1.nprofileEncode({pubkey:this.pubkey,relays:t})}set npub(t){this._npub=t}get pubkey(){if(!this._pubkey){if(!this._npub)throw new Error("npub not set");this._pubkey=nip19_exports$1.decode(this.npub).data}return this._pubkey}set pubkey(t){this._pubkey=t}filter(){return{"#p":[this.pubkey]}}async getZapInfo(t){if(!this.ndk)throw new Error("No NDK instance found");const r=async l=>{if(!t)return l;let u;const x=new Promise((f,p)=>{u=setTimeout(()=>p(new Error("Timeout")),t)});try{const f=await Promise.race([l,x]);return u&&clearTimeout(u),f}catch(f){if(f instanceof Error&&f.message==="Timeout")try{return await l}catch{return}return}},[n,s]=await Promise.all([r(this.fetchProfile()),r(this.ndk.fetchEvent({kinds:[10019],authors:[this.pubkey]}))]),a=new Map;if(s){const l=NDKCashuMintList.from(s);l.mints.length>0&&a.set("nip61",{mints:l.mints,relays:l.relays,p2pk:l.p2pk})}if(n){const{lud06:l,lud16:u}=n;a.set("nip57",{lud06:l,lud16:u})}return a}static async fromNip05(t,r,n=!1){if(!r)throw new Error("No NDK instance found");const s={};n&&(s.cache="no-cache");const a=await getNip05For(r,t,r?.httpFetch,s);if(a){const l=new ch({pubkey:a.pubkey,relayUrls:a.relays,nip46Urls:a.nip46});return l.ndk=r,l}}async fetchProfile(t,r=!1){if(!this.ndk)throw new Error("NDK not set");let n=null;if(this.ndk.cacheAdapter&&(this.ndk.cacheAdapter.fetchProfile||this.ndk.cacheAdapter.fetchProfileSync)&&t?.cacheUsage!=="ONLY_RELAY"){let s=null;if(this.ndk.cacheAdapter.fetchProfileSync?s=this.ndk.cacheAdapter.fetchProfileSync(this.pubkey):this.ndk.cacheAdapter.fetchProfile&&(s=await this.ndk.cacheAdapter.fetchProfile(this.pubkey)),s)return this.profile=s,s}return t??={},t.cacheUsage??="ONLY_RELAY",t.closeOnEose??=!0,t.groupable??=!0,t.groupableDelay??=250,n||(n=await this.ndk.fetchEvent({kinds:[0],authors:[this.pubkey]},t)),n?(this.profile=profileFromEvent(n),r&&this.profile&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.saveProfile&&this.ndk.cacheAdapter.saveProfile(this.pubkey,this.profile),this.profile):null}follows=follows.bind(this);async followSet(t,r,n=3){const s=await this.follows(t,r,n);return new Set(Array.from(s).map(a=>a.pubkey))}tagReference(){return["p",this.pubkey]}referenceTags(t){const r=[["p",this.pubkey]];return t&&r[0].push("",t),r}async publish(){if(!this.ndk)throw new Error("No NDK instance found");if(!this.profile)throw new Error("No profile available");this.ndk.assertSigner(),await new NDKEvent(this.ndk,{kind:0,content:serializeProfile(this.profile)}).publish()}async follow(t,r,n=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),r||(r=await this.follows(void 0,void 0,n));const s=typeof t=="string"?t:t.pubkey;if(Array.from(r).some(u=>typeof u=="string"?u===s:u.pubkey===s))return!1;r.add(t);const l=new NDKEvent(this.ndk,{kind:n});for(const u of r)typeof u=="string"?l.tags.push(["p",u]):l.tag(u);return await l.publish(),!0}async unfollow(t,r,n=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),r||(r=await this.follows(void 0,void 0,n));const s=typeof t=="string"?t:t.pubkey,a=new Set;let l=!1;for(const x of r)(typeof x=="string"?x:x.pubkey)!==s?a.add(x):l=!0;if(!l)return!1;const u=new NDKEvent(this.ndk,{kind:n});for(const x of a)typeof x=="string"?u.tags.push(["p",x]):u.tag(x);return await u.publish()}async validateNip05(t){if(!this.ndk)throw new Error("No NDK instance found");const r=await getNip05For(this.ndk,t);return r===null?null:r.pubkey===this.pubkey}},signerRegistry=new Map;function registerSigner(e,t){signerRegistry.set(e,t)}var NDKPrivateKeySigner=class Fc{_user;_privateKey;_pubkey;constructor(t,r){if(typeof t=="string")if(t.startsWith("nsec1")){const{type:n,data:s}=nip19_exports$1.decode(t);if(n==="nsec")this._privateKey=s;else throw new Error("Invalid private key provided.")}else if(t.length===64)this._privateKey=hexToBytes$7(t);else throw new Error("Invalid private key provided.");else this._privateKey=t;this._pubkey=getPublicKey(this._privateKey),r&&(this._user=r.getUser({pubkey:this._pubkey})),this._user??=new NDKUser({pubkey:this._pubkey})}get privateKey(){if(!this._privateKey)throw new Error("Not ready");return bytesToHex$5(this._privateKey)}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}get nsec(){if(!this._privateKey)throw new Error("Not ready");return nip19_exports$1.nsecEncode(this._privateKey)}get npub(){if(!this._pubkey)throw new Error("Not ready");return nip19_exports$1.npubEncode(this._pubkey)}encryptToNcryptsec(t,r=16,n=2){if(!this._privateKey)throw new Error("Private key not available");return encrypt$1(this._privateKey,t,r,n)}static generate(){const t=generateSecretKey();return new Fc(t)}static fromNcryptsec(t,r,n){const s=decrypt$1(t,r);return new Fc(s,n)}async blockUntilReady(){return this._user}async user(){return this._user}get userSync(){return this._user}async sign(t){if(!this._privateKey)throw Error("Attempted to sign without a private key");return finalizeEvent(t,this._privateKey).sig}async encryptionEnabled(t){const r=[];return(!t||t==="nip04")&&r.push("nip04"),(!t||t==="nip44")&&r.push("nip44"),r}async encrypt(t,r,n){if(!this._privateKey||!this.privateKey)throw Error("Attempted to encrypt without a private key");const s=t.pubkey;if(n==="nip44"){const a=nip44_exports.v2.utils.getConversationKey(this._privateKey,s);return await nip44_exports.v2.encrypt(r,a)}return await nip04_exports.encrypt(this._privateKey,s,r)}async decrypt(t,r,n){if(!this._privateKey||!this.privateKey)throw Error("Attempted to decrypt without a private key");const s=t.pubkey;if(n==="nip44"){const a=nip44_exports.v2.utils.getConversationKey(this._privateKey,s);return await nip44_exports.v2.decrypt(r,a)}return await nip04_exports.decrypt(this._privateKey,s,r)}toPayload(){if(!this._privateKey)throw new Error("Private key not available");const t={type:"private-key",payload:this.privateKey};return JSON.stringify(t)}static async fromPayload(t,r){const n=JSON.parse(t);if(n.type!=="private-key")throw new Error(`Invalid payload type: expected 'private-key', got ${n.type}`);if(!n.payload||typeof n.payload!="string")throw new Error("Invalid payload content for private-key signer");return new Fc(n.payload,r)}};registerSigner("private-key",NDKPrivateKeySigner);function dedup(e,t){return e.created_at>t.created_at?e:t}async function getRelayListForUser(e,t){return(await getRelayListForUsers([e],t)).get(e)}async function getRelayListForUsers(e,t,r=!1,n=1e3,s){const a=t.outboxPool||t.pool,l=new Set;for(const y of a.relays.values())l.add(y);if(s)for(const y of s.values())for(const w of y){const R=a.getRelay(w,!0,!0);R&&l.add(R)}const u=new Map,x=new Map,f=new NDKRelaySet(l,t);if(t.cacheAdapter?.locking&&!r){const y=await t.fetchEvents({kinds:[3,10002],authors:Array.from(new Set(e))},{cacheUsage:"ONLY_CACHE",subId:"ndk-relay-list-fetch"});for(const w of y)w.kind===10002&&u.set(w.pubkey,NDKRelayList.from(w));for(const w of y)if(w.kind===3){if(u.has(w.pubkey))continue;const R=relayListFromKind3(t,w);R&&x.set(w.pubkey,R)}e=e.filter(w=>!u.has(w)&&!x.has(w))}if(e.length===0)return u;const p=new Map,g=new Map;return new Promise(y=>{let w=!1;(async()=>{const I={closeOnEose:!0,pool:a,groupable:!0,subId:"ndk-relay-list-fetch",addSinceFromCache:!0,relaySet:f};f&&(I.relaySet=f),t.subscribe({kinds:[3,10002],authors:e},I,{onEvent:q=>{if(q.kind===10002){const $e=p.get(q.pubkey);if($e&&$e.created_at>q.created_at)return;p.set(q.pubkey,q)}else if(q.kind===3){const $e=g.get(q.pubkey);if($e&&$e.created_at>q.created_at)return;g.set(q.pubkey,q)}},onEose:()=>{if(!w){w=!0,t.debug(`[getRelayListForUsers] EOSE - relayListEvents: ${p.size}, contactListEvents: ${g.size}`);for(const q of p.values())u.set(q.pubkey,NDKRelayList.from(q));for(const q of e){if(u.has(q))continue;const $e=g.get(q);if(!$e)continue;const We=relayListFromKind3(t,$e);We&&u.set(q,We)}t.debug(`[getRelayListForUsers] Returning ${u.size} relay lists for ${e.length} pubkeys`),y(u)}}});const k=Array.from(l).some(q=>q.status<=2),je=Array.from(l).some(q=>q.status===4);let Ve=n;(k||je)&&(Ve=n+3e3),t.debug(`[getRelayListForUsers] Setting fallback timeout to ${Ve}ms (disconnected: ${k}, connecting: ${je})`,{pubkeys:e}),setTimeout(()=>{w||(w=!0,t.debug(`[getRelayListForUsers] Timeout reached, returning ${u.size} relay lists`),y(u))},Ve)})()})}var OutboxItem=class{type;relayUrlScores;readRelays;writeRelays;constructor(e){this.type=e,this.relayUrlScores=new Map,this.readRelays=new Set,this.writeRelays=new Set}},OutboxTracker=class extends libExports.EventEmitter{data;ndk;debug;constructor(e){super(),this.ndk=e,this.debug=e.debug.extend("outbox-tracker"),this.data=new distExports$2.LRUCache({maxSize:1e5,entryExpirationTimeInMS:120*1e3})}async trackUsers(e,t=!1){const r=[];for(let n=0;n<e.length;n+=400){const s=e.slice(n,n+400),a=s.map(u=>getKeyFromItem(u)).filter(u=>!this.data.has(u));if(a.length===0)continue;for(const u of a)this.data.set(u,new OutboxItem("user"));const l=new Map;for(const u of s)u instanceof NDKUser&&u.relayUrls.length>0&&l.set(u.pubkey,u.relayUrls);r.push(new Promise(u=>{getRelayListForUsers(a,this.ndk,t,1e3,l).then(x=>{this.debug(`Received relay lists for ${x.size} pubkeys out of ${a.length} requested`);for(const[f,p]of x){let g=this.data.get(f);if(g??=new OutboxItem("user"),p){if(g.readRelays=new Set(normalize(p.readRelayUrls)),g.writeRelays=new Set(normalize(p.writeRelayUrls)),this.ndk.relayConnectionFilter){for(const y of g.readRelays)this.ndk.relayConnectionFilter(y)||g.readRelays.delete(y);for(const y of g.writeRelays)this.ndk.relayConnectionFilter(y)||g.writeRelays.delete(y)}this.data.set(f,g),this.emit("user:relay-list-updated",f,g),this.debug(`Adding ${g.readRelays.size} read relays and ${g.writeRelays.size} write relays for ${f}`,p?.rawEvent())}}}).finally(u)}))}return Promise.all(r)}track(e,t,r=!0){const n=getKeyFromItem(e);t??=getTypeFromItem(e);let s=this.data.get(n);return s||(s=new OutboxItem(t),e instanceof NDKUser&&this.trackUsers([e])),s}};function getKeyFromItem(e){return e instanceof NDKUser?e.pubkey:e}function getTypeFromItem(e){return e instanceof NDKUser?"user":"kind"}function correctRelaySet(e,t){const r=t.connectedRelays();if(!Array.from(e.relays).some(s=>r.map(a=>a.url).includes(s.url)))for(const s of r)e.addRelay(s);if(r.length===0)for(const s of t.relays.values())e.addRelay(s);return e}var NDKSubscriptionManager=class{subscriptions;seenEvents=new distExports$2.LRUCache({maxSize:1e4,entryExpirationTimeInMS:300*1e3});constructor(){this.subscriptions=new Map}add(e){this.subscriptions.set(e.internalId,e),e.onStopped,e.onStopped=()=>{this.subscriptions.delete(e.internalId)},e.on("close",()=>{this.subscriptions.delete(e.internalId)})}seenEvent(e,t){const r=this.seenEvents.get(e)||[];r.some(n=>n.url===t.url)||r.push(t),this.seenEvents.set(e,r)}dispatchEvent(e,t,r=!1){t&&this.seenEvent(e.id,t);const n=this.subscriptions.values(),s=[];for(const a of n)matchFilters(a.filters,e)&&s.push(a);for(const a of s){if(a.exclusiveRelay&&a.relaySet){let l=!1;if(r?l=!a.skipOptimisticPublishEvent:t?l=a.relaySet.relays.has(t):l=(this.seenEvents.get(e.id)||[]).some(x=>a.relaySet.relays.has(x)),!l){a.debug.extend("exclusive-relay")("Rejected event %s from %s (relay not in exclusive set)",e.id,t?.url||(r?"optimistic":"cache"));continue}}a.eventReceived(e,t,!1,r)}}},debug6=createDebug5("ndk:active-user");async function getUserRelayList(e){if(!this.autoConnectUserRelays)return;const t=await getRelayListForUser(e.pubkey,this);if(t){for(const r of t.relays){let n=this.pool.relays.get(r);n||(n=new NDKRelay(r,this.relayAuthDefaultPolicy,this),this.pool.addRelay(n))}return debug6("Connected to %d user relays",t.relays.length),t}}async function setActiveUser(e){if(!this.autoConnectUserRelays)return;const t=this.outboxPool||this.pool;t.connectedRelays.length>0?await getUserRelayList.call(this,e):t.once("connect",async()=>{await getUserRelayList.call(this,e)})}function getEntity(e){try{const t=nip19_exports$1.decode(e);return t.type==="npub"?npub(this,t.data):t.type==="nprofile"?nprofile(this,t.data):t}catch{return null}}function npub(e,t){return e.getUser({pubkey:t})}function nprofile(e,t){const r=e.getUser({pubkey:t.pubkey});return t.relays&&(r.relayUrls=t.relays),r}function isValidHint(e){if(!e||e==="")return!1;try{return new URL(e),!0}catch{return!1}}async function fetchEventFromTag(e,t,r,n={type:"timeout"}){const s=this.debug.extend("fetch-event-from-tag"),[a,l,u]=e;r={},s("fetching event from tag",e,r,n);const x=getRelaysForSync(this,t.pubkey);if(x&&x.size>0){s("fetching event from author relays %o",Array.from(x));const I=NDKRelaySet.fromRelayUrls(Array.from(x),this),k=await this.fetchEvent(l,r,I);if(k)return k}else s("no author relays found for %s",t.pubkey,t);const f=calculateRelaySetsFromFilters(this,[{ids:[l]}],this.pool);s("fetching event without relay hint",f);const p=await this.fetchEvent(l,r);if(p)return p;if(u&&u!==""){const I=await this.fetchEvent(l,r,this.pool.getRelay(u,!0,!0,[{ids:[l]}]));if(I)return I}let g;const y=isValidHint(u)?this.pool.getRelay(u,!1,!0,[{ids:[l]}]):void 0,w=new Promise(I=>{this.fetchEvent(l,r,y).then(I)});if(!isValidHint(u)||n.type==="none")return w;const R=new Promise(async I=>{const k=n.relaySet,je=n.timeout??1500,Ve=new Promise(q=>setTimeout(q,je));if(n.type==="timeout"&&await Ve,g)I(g);else{s("fallback fetch triggered");const q=await this.fetchEvent(l,r,k);I(q)}});switch(n.type){case"timeout":return Promise.race([w,R]);case"eose":return g=await w,g||R}}var Queue=class{queue=[];maxConcurrency;processing=new Set;promises=new Map;constructor(e,t){this.maxConcurrency=t}add(e){if(this.promises.has(e.id))return this.promises.get(e.id);const t=new Promise((r,n)=>{this.queue.push({...e,func:()=>e.func().then(s=>(r(s),s),s=>{throw n(s),s})}),this.process()});return this.promises.set(e.id,t),t.finally(()=>{this.promises.delete(e.id),this.processing.delete(e.id),this.process()}),t}process(){if(this.processing.size>=this.maxConcurrency||this.queue.length===0)return;const e=this.queue.shift();!e||this.processing.has(e.id)||(this.processing.add(e.id),e.func())}clear(){this.queue=[]}clearProcessing(){this.processing.clear()}clearAll(){this.clear(),this.clearProcessing()}length(){return this.queue.length}},DEFAULT_OUTBOX_RELAYS=["wss://purplepag.es/","wss://nos.lol/"],NDK=class extends libExports.EventEmitter{_explicitRelayUrls;pool;outboxPool;_signer;_activeUser;cacheAdapter;debug;devWriteRelaySet;outboxTracker;muteFilter;relayConnectionFilter;clientName;clientNip89;queuesZapConfig;queuesNip05;asyncSigVerification=!1;initialValidationRatio=1;lowestValidationRatio=.1;validationRatioFn;filterValidationMode="validate";subManager;aiGuardrails;_signatureVerificationFunction;_signatureVerificationWorker;signatureVerificationTimeMs=0;publishingFailureHandled=!1;pools=[];relayAuthDefaultPolicy;httpFetch;netDebug;autoConnectUserRelays=!0;_wallet;walletConfig;constructor(e={}){super(),this.debug=e.debug||createDebug5("ndk"),this.netDebug=e.netDebug,this._explicitRelayUrls=e.explicitRelayUrls||[],this.subManager=new NDKSubscriptionManager,this.pool=new NDKPool(e.explicitRelayUrls||[],this),this.pool.name="Main",this.pool.on("relay:auth",async(t,r)=>{this.relayAuthDefaultPolicy&&await this.relayAuthDefaultPolicy(t,r)}),this.autoConnectUserRelays=e.autoConnectUserRelays??!0,this.clientName=e.clientName,this.clientNip89=e.clientNip89,this.relayAuthDefaultPolicy=e.relayAuthDefaultPolicy,e.enableOutboxModel!==!1&&(this.outboxPool=new NDKPool(e.outboxRelayUrls||DEFAULT_OUTBOX_RELAYS,this,{debug:this.debug.extend("outbox-pool"),name:"Outbox Pool"}),this.outboxTracker=new OutboxTracker(this),this.outboxTracker.on("user:relay-list-updated",(t,r)=>{this.debug(`Outbox relay list updated for ${t}`);for(const n of this.subManager.subscriptions.values())n.filters.some(a=>a.authors?.includes(t))&&typeof n.refreshRelayConnections=="function"&&(this.debug(`Refreshing relay connections for subscription ${n.internalId}`),n.refreshRelayConnections())})),this.signer=e.signer,this.cacheAdapter=e.cacheAdapter,this.muteFilter=e.muteFilter,this.relayConnectionFilter=e.relayConnectionFilter,e.devWriteRelayUrls&&(this.devWriteRelaySet=NDKRelaySet.fromRelayUrls(e.devWriteRelayUrls,this)),this.queuesZapConfig=new Queue("zaps",3),this.queuesNip05=new Queue("nip05",10),e.signatureVerificationWorker&&(this.signatureVerificationWorker=e.signatureVerificationWorker),e.signatureVerificationFunction&&(this.signatureVerificationFunction=e.signatureVerificationFunction),this.initialValidationRatio=e.initialValidationRatio||1,this.lowestValidationRatio=e.lowestValidationRatio||.1,this.validationRatioFn=e.validationRatioFn||this.defaultValidationRatioFn,this.filterValidationMode=e.filterValidationMode||"validate",this.aiGuardrails=new AIGuardrails(e.aiGuardrails||!1),this.aiGuardrails.ndkInstantiated(this);try{this.httpFetch=fetch}catch{}}set explicitRelayUrls(e){this._explicitRelayUrls=e.map(normalizeRelayUrl),this.pool.relayUrls=e}get explicitRelayUrls(){return this._explicitRelayUrls||[]}set signatureVerificationWorker(e){this._signatureVerificationWorker=e,e?(signatureVerificationInit(e),this.asyncSigVerification=!0):this.asyncSigVerification=!1}set signatureVerificationFunction(e){this._signatureVerificationFunction=e,this.asyncSigVerification=!!e}get signatureVerificationFunction(){return this._signatureVerificationFunction}addExplicitRelay(e,t,r=!0){let n;return typeof e=="string"?n=new NDKRelay(e,t,this):n=e,this.pool.addRelay(n,r),this.explicitRelayUrls?.push(n.url),n}toJSON(){return{relayCount:this.pool.relays.size}.toString()}get activeUser(){return this._activeUser}set activeUser(e){const t=this._activeUser?.pubkey!==e?.pubkey;this._activeUser=e,t&&this.emit("activeUser:change",e),e&&t&&setActiveUser.call(this,e)}get signer(){return this._signer}set signer(e){this._signer=e,e&&this.emit("signer:ready",e),e?.user().then(t=>{t.ndk=this,this.activeUser=t})}async connect(e){this._signer&&this.autoConnectUserRelays&&(this.debug("Attempting to connect to user relays specified by signer %o",await this._signer.relays?.(this)),this._signer.relays&&(await this._signer.relays(this)).forEach(n=>this.pool.addRelay(n)));const t=[this.pool.connect(e)];return this.outboxPool&&t.push(this.outboxPool.connect(e)),this.cacheAdapter?.initializeAsync&&t.push(this.cacheAdapter.initializeAsync(this)),Promise.allSettled(t).then(()=>{})}reportInvalidSignature(e,t){this.debug(`Invalid signature detected for event ${e.id}${t?` from relay ${t.url}`:""}`),this.emit("event:invalid-sig",e,t)}defaultValidationRatioFn(e,t,r){if(t<10)return this.initialValidationRatio;const n=Math.min(t/100,1),s=this.initialValidationRatio*(1-n)+this.lowestValidationRatio*n;return Math.max(s,this.lowestValidationRatio)}getUser(e){if(typeof e=="string")if(e.startsWith("npub1")){const{type:r,data:n}=nip19_exports$1.decode(e);if(r!=="npub")throw new Error(`Invalid npub: ${e}`);return this.getUser({pubkey:n})}else if(e.startsWith("nprofile1")){const{type:r,data:n}=nip19_exports$1.decode(e);if(r!=="nprofile")throw new Error(`Invalid nprofile: ${e}`);return this.getUser({pubkey:n.pubkey,relayUrls:n.relays})}else return this.getUser({pubkey:e});const t=new NDKUser(e);return t.ndk=this,t}async getUserFromNip05(e,t=!1){return NDKUser.fromNip05(e,this,t)}async fetchUser(e,t=!1){if(isValidNip05(e))return NDKUser.fromNip05(e,this,t);if(e.startsWith("npub1")){const{type:r,data:n}=nip19_exports$1.decode(e);if(r!=="npub")throw new Error(`Invalid npub: ${e}`);const s=new NDKUser({pubkey:n});return s.ndk=this,s}else if(e.startsWith("nprofile1")){const{type:r,data:n}=nip19_exports$1.decode(e);if(r!=="nprofile")throw new Error(`Invalid nprofile: ${e}`);const s=new NDKUser({pubkey:n.pubkey,relayUrls:n.relays});return s.ndk=this,s}else{const r=new NDKUser({pubkey:e});return r.ndk=this,r}}subscribe(e,t,r=!0,n=!0){let s=t?.relaySet,a=n;r instanceof NDKRelaySet?(console.warn("relaySet is deprecated, use opts.relaySet instead. This will be removed in version v2.14.0"),s=r,a=n):(typeof r=="boolean"||typeof r=="object")&&(a=r);let l;const u={relaySet:s,...t};a&&typeof a=="object"&&(a.onEvent&&(u.onEvent=a.onEvent),a.onEose&&(u.onEose=a.onEose),a.onClose&&(u.onClose=a.onClose),a.onEvents&&(l=a.onEvents));const x=new NDKSubscription(this,e,u);this.subManager.add(x),this.aiGuardrails?.subscription?.created(Array.isArray(e)?e:[e],u);const f=x.pool;if(x.relaySet)for(const p of x.relaySet.relays)f.useTemporaryRelay(p,void 0,x.filters);if(this.outboxPool&&x.hasAuthorsFilter()){const p=x.filters.filter(g=>g.authors&&g.authors?.length>0).flatMap(g=>g.authors);this.outboxTracker?.trackUsers(p)}return a&&setTimeout(async()=>{this.cacheAdapter?.initializeAsync&&!this.cacheAdapter.ready&&await this.cacheAdapter.initializeAsync(this);const p=x.start(!l);p&&p.length>0&&l&&l(p)},0),x}fetchEventFromTag=fetchEventFromTag.bind(this);fetchEventSync(e){if(!this.cacheAdapter)throw new Error("Cache adapter not set");let t;typeof e=="string"?t=[filterFromId(e)]:t=e;const r=new NDKSubscription(this,t),n=this.cacheAdapter.query(r);if(n instanceof Promise)throw new Error("Cache adapter is async");return n.map(s=>(s.ndk=this,s))}async fetchEvent(e,t,r){let n,s;if(r instanceof NDKRelay?s=new NDKRelaySet(new Set([r]),this):r instanceof NDKRelaySet&&(s=r),!r&&typeof e=="string"&&!isNip33AValue(e)){const a=relaysFromBech32(e,this);a.length>0&&(s=new NDKRelaySet(new Set(a),this),s=correctRelaySet(s,this.pool))}if(typeof e=="string"?n=[filterFromId(e)]:Array.isArray(e)?n=e:n=[e],typeof e!="string"&&this.aiGuardrails?.ndk?.fetchingEvents(n),n.length===0)throw new Error(`Invalid filter: ${JSON.stringify(e)}`);return new Promise((a,l)=>{let u=null;const x={...t||{},closeOnEose:!0};s&&(x.relaySet=s);const f=setTimeout(()=>{p.stop(),this.aiGuardrails._nextCallDisabled=null,a(u)},1e4),p=this.subscribe(n,x,{onEvent:g=>{g.ndk=this,g.isReplaceable()?(!u||u.created_at<g.created_at)&&(u=g):(clearTimeout(f),this.aiGuardrails._nextCallDisabled=null,a(g))},onEose:()=>{clearTimeout(f),this.aiGuardrails._nextCallDisabled=null,a(u)}})})}async fetchEvents(e,t,r){return this.aiGuardrails?.ndk?.fetchingEvents(e,t),new Promise(n=>{const s=new Map,a={...t||{},closeOnEose:!0};r&&(a.relaySet=r);const l=u=>{let x;u instanceof NDKEvent?x=u:x=new NDKEvent(void 0,u);const f=x.deduplicationKey(),p=s.get(f);p&&(x=dedup(p,x)),x.ndk=this,s.set(f,x)};this.subscribe(e,{...a,onEvent:l,onEose:()=>{this.aiGuardrails._nextCallDisabled=null,n(new Set(s.values()))}})})}assertSigner(){if(!this.signer)throw this.emit("signer:required"),new Error("Signer required")}getEntity=getEntity.bind(this);guardrailOff(e){return e?typeof e=="string"?this.aiGuardrails._nextCallDisabled=new Set([e]):this.aiGuardrails._nextCallDisabled=new Set(e):this.aiGuardrails._nextCallDisabled="all",this}set wallet(e){if(!e){this._wallet=void 0,this.walletConfig=void 0;return}this._wallet=e,this.walletConfig??={},this.walletConfig.lnPay=e?.lnPay?.bind(e),this.walletConfig.cashuPay=e?.cashuPay?.bind(e)}get wallet(){return this._wallet}},nip19_exports={};__reExport(nip19_exports,nip19_star);var nip49_exports={};__reExport(nip49_exports,nip49_star);function disconnect(e,t){return t??=createDebug5("ndk:relay:auth-policies:disconnect"),async r=>{t?.(`Relay ${r.url} requested authentication, disconnecting`),e.removeRelay(r.url)}}async function signAndAuth(e,t,r,n,s,a){try{await e.sign(r),s(e)}catch(l){n?.(`Failed to publish auth event to relay ${t.url}`,l),a(e)}}function signIn({ndk:e,signer:t,debug:r}={}){return r??=createDebug5("ndk:auth-policies:signIn"),async(n,s)=>{r?.(`Relay ${n.url} requested authentication, signing in`);const a=new NDKEvent(e);return a.kind=22242,a.tags=[["relay",n.url],["challenge",s]],t??=e?.signer,new Promise(async(l,u)=>{t?await signAndAuth(a,n,t,r,l,u):e?.once("signer:ready",async x=>{await signAndAuth(a,n,x,r,l,u)})})}}var NDKRelayAuthPolicies={disconnect,signIn};async function ndkSignerFromPayload(e,t){let r;try{r=JSON.parse(e)}catch(s){console.error("Failed to parse signer payload string",e,s);return}if(!r||typeof r.type!="string"){console.error("Failed to parse signer payload string",e,new Error("Missing type field"));return}const n=signerRegistry.get(r.type);if(!n)throw new Error(`Unknown signer type: ${r.type}`);try{return await n.fromPayload(e,t)}catch(s){const a=s instanceof Error?s.message:String(s);throw new Error(`Failed to deserialize signer type ${r.type}: ${a}`)}}var NDKNip07Signer=class lh{_userPromise;encryptionQueue=[];encryptionProcessing=!1;debug;waitTimeout;_pubkey;ndk;_user;constructor(t=1e3,r){this.debug=createDebug5("ndk:nip07"),this.waitTimeout=t,this.ndk=r}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}async blockUntilReady(){await this.waitForExtension();const t=await window.nostr?.getPublicKey();if(!t)throw new Error("User rejected access");this._pubkey=t;let r;return this.ndk?r=this.ndk.getUser({pubkey:t}):r=new NDKUser({pubkey:t}),this._user=r,r}async user(){return this._userPromise||(this._userPromise=this.blockUntilReady()),this._userPromise}get userSync(){if(!this._user)throw new Error("User not ready");return this._user}async sign(t){await this.waitForExtension();const r=await window.nostr?.signEvent(t);if(!r)throw new Error("Failed to sign event");return r.sig}async relays(t){await this.waitForExtension();const r=await window.nostr?.getRelays?.()||{},n=[];for(const s of Object.keys(r))r[s].read&&r[s].write&&n.push(s);return n.map(s=>new NDKRelay(s,t?.relayAuthDefaultPolicy,t))}async encryptionEnabled(t){const r=[];return(!t||t==="nip04")&&window.nostr?.nip04&&r.push("nip04"),(!t||t==="nip44")&&window.nostr?.nip44&&r.push("nip44"),r}async encrypt(t,r,n="nip04"){if(!await this.encryptionEnabled(n))throw new Error(`${n}encryption is not available from your browser extension`);await this.waitForExtension();const s=t.pubkey;return this.queueEncryption(n,"encrypt",s,r)}async decrypt(t,r,n="nip04"){if(!await this.encryptionEnabled(n))throw new Error(`${n}encryption is not available from your browser extension`);await this.waitForExtension();const s=t.pubkey;return this.queueEncryption(n,"decrypt",s,r)}async queueEncryption(t,r,n,s){return new Promise((a,l)=>{this.encryptionQueue.push({scheme:t,method:r,counterpartyHexpubkey:n,value:s,resolve:a,reject:l}),this.encryptionProcessing||this.processEncryptionQueue()})}async processEncryptionQueue(t,r=0){if(!t&&this.encryptionQueue.length===0){this.encryptionProcessing=!1;return}this.encryptionProcessing=!0;const n=t||this.encryptionQueue.shift();if(!n){this.encryptionProcessing=!1;return}const{scheme:s,method:a,counterpartyHexpubkey:l,value:u,resolve:x,reject:f}=n;this.debug("Processing encryption queue item",{method:a,counterpartyHexpubkey:l,value:u});try{const p=await window.nostr?.[s]?.[a](l,u);if(!p)throw new Error("Failed to encrypt/decrypt");x(p)}catch(p){const g=p instanceof Error?p.message:String(p);if(g.includes("call already executing")&&r<5){this.debug("Retrying encryption queue item",{method:a,counterpartyHexpubkey:l,value:u,retries:r}),setTimeout(()=>{this.processEncryptionQueue(n,r+1)},50*r);return}f(p instanceof Error?p:new Error(g))}this.processEncryptionQueue()}waitForExtension(){return new Promise((t,r)=>{if(window.nostr){t();return}let n;const s=setInterval(()=>{window.nostr&&(clearTimeout(n),clearInterval(s),t())},100);n=setTimeout(()=>{clearInterval(s),r(new Error("NIP-07 extension not available"))},this.waitTimeout)})}toPayload(){return JSON.stringify({type:"nip07",payload:""})}static async fromPayload(t,r){const n=JSON.parse(t);if(n.type!=="nip07")throw new Error(`Invalid payload type: expected 'nip07', got ${n.type}`);return new lh(void 0,r)}};registerSigner("nip07",NDKNip07Signer);var NDKNostrRpc=class extends libExports.EventEmitter{ndk;signer;relaySet;debug;encryptionType="nip04";pool;constructor(e,t,r,n){if(super(),this.ndk=e,this.signer=t,n){this.pool=new NDKPool(n,e,{debug:r.extend("rpc-pool"),name:"Nostr RPC"}),this.relaySet=new NDKRelaySet(new Set,e,this.pool);for(const s of n){const a=this.pool.getRelay(s,!1,!1);a.authPolicy=NDKRelayAuthPolicies.signIn({ndk:e,signer:t,debug:r}),this.relaySet.addRelay(a),a.connect()}}this.debug=r.extend("rpc")}subscribe(e){return new Promise(t=>{const r=this.ndk.subscribe(e,{closeOnEose:!1,groupable:!1,cacheUsage:"ONLY_RELAY",pool:this.pool,relaySet:this.relaySet,onEvent:async n=>{try{const s=await this.parseEvent(n);s.method?this.emit("request",s):(this.emit(`response-${s.id}`,s),this.emit("response",s))}catch(s){this.debug("error parsing event",s,n.rawEvent())}},onEose:()=>{this.debug("eosed"),t(r)}})})}async parseEvent(e){this.encryptionType==="nip44"&&e.content.includes("?iv=")?this.encryptionType="nip04":this.encryptionType==="nip04"&&!e.content.includes("?iv=")&&(this.encryptionType="nip44");const t=this.ndk.getUser({pubkey:e.pubkey});t.ndk=this.ndk;let r;try{r=await this.signer.decrypt(t,e.content,this.encryptionType)}catch{const p=this.encryptionType==="nip04"?"nip44":"nip04";r=await this.signer.decrypt(t,e.content,p),this.encryptionType=p}const n=JSON.parse(r),{id:s,method:a,params:l,result:u,error:x}=n;return a?{id:s,pubkey:e.pubkey,method:a,params:l,event:e}:{id:s,result:u,error:x,event:e}}async sendResponse(e,t,r,n=24133,s){const a={id:e,result:r};s&&(a.error=s);const l=await this.signer.user(),u=this.ndk.getUser({pubkey:t}),x=new NDKEvent(this.ndk,{kind:n,content:JSON.stringify(a),tags:[["p",t]],pubkey:l.pubkey});x.content=await this.signer.encrypt(u,x.content,this.encryptionType),await x.sign(this.signer),await x.publish(this.relaySet)}async sendRequest(e,t,r=[],n=24133,s){const a=Math.random().toString(36).substring(7),l=await this.signer.user(),u=this.ndk.getUser({pubkey:e}),x={id:a,method:t,params:r},f=new Promise(()=>{const g=y=>{y.result==="auth_url"?(this.once(`response-${a}`,g),this.emit("authUrl",y.error)):s&&s(y)};this.once(`response-${a}`,g)}),p=new NDKEvent(this.ndk,{kind:n,content:JSON.stringify(x),tags:[["p",e]],pubkey:l.pubkey});return p.content=await this.signer.encrypt(u,p.content,this.encryptionType),await p.sign(this.signer),await p.publish(this.relaySet),f}};function nostrConnectGenerateSecret(){return Math.random().toString(36).substring(2,15)}function generateNostrConnectUri(e,t,r,n){const s={name:n?.name?encodeURIComponent(n.name):"",url:n?.url?encodeURIComponent(n.url):"",image:n?.image?encodeURIComponent(n.image):"",perms:n?.perms?encodeURIComponent(n.perms):""};let a=`nostrconnect://${e}?image=${s.image}&url=${s.url}&name=${s.name}&perms=${s.perms}&secret=${encodeURIComponent(t)}`;return r&&(a+=`&relay=${encodeURIComponent(r)}`),a}var NDKNip46Signer=class Tc extends libExports.EventEmitter{ndk;_user;bunkerPubkey;userPubkey;get pubkey(){if(!this.userPubkey)throw new Error("Not ready");return this.userPubkey}secret;localSigner;nip05;rpc;debug;relayUrls;subscription;nostrConnectUri;nostrConnectSecret;constructor(t,r,n,s,a){super(),this.ndk=t,this.debug=t.debug.extend("nip46:signer"),this.relayUrls=s,n?typeof n=="string"?this.localSigner=new NDKPrivateKeySigner(n):this.localSigner=n:this.localSigner=NDKPrivateKeySigner.generate(),r===!1||(r?r.startsWith("bunker://")?this.bunkerFlowInit(r):this.nip05Init(r):this.nostrconnectFlowInit(a)),this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls)}static bunker(t,r,n){return new Tc(t,r,n)}static nostrconnect(t,r,n,s){return new Tc(t,void 0,n,[r],s)}nostrconnectFlowInit(t){this.nostrConnectSecret=nostrConnectGenerateSecret();const r=this.localSigner.pubkey;this.nostrConnectUri=generateNostrConnectUri(r,this.nostrConnectSecret,this.relayUrls?.[0],t)}bunkerFlowInit(t){const r=new URL(t),n=r.hostname||r.pathname.replace(/^\/\//,""),s=r.searchParams.get("pubkey"),a=r.searchParams.getAll("relay"),l=r.searchParams.get("secret");this.bunkerPubkey=n,this.userPubkey=s,this.relayUrls=a,this.secret=l}nip05Init(t){this.nip05=t}async startListening(){if(this.subscription)return;const t=await this.localSigner.user();if(!t)throw new Error("Local signer not ready");this.subscription=await this.rpc.subscribe({kinds:[24133],"#p":[t.pubkey]})}async user(){return this._user?this._user:this.blockUntilReady()}get userSync(){if(!this._user)throw new Error("Remote user not ready synchronously");return this._user}async blockUntilReadyNostrConnect(){return new Promise((t,r)=>{const n=s=>{s.result===this.nostrConnectSecret&&(this._user=s.event.author,this.userPubkey=s.event.pubkey,this.bunkerPubkey=s.event.pubkey,this.rpc.off("response",n),t(this._user))};this.startListening(),this.rpc.on("response",n)})}async blockUntilReady(){if(!this.bunkerPubkey&&!this.nostrConnectSecret&&!this.nip05)throw new Error("Bunker pubkey not set");if(this.nostrConnectSecret)return this.blockUntilReadyNostrConnect();if(this.nip05&&!this.userPubkey){const t=await NDKUser.fromNip05(this.nip05,this.ndk);t&&(this._user=t,this.userPubkey=t.pubkey,this.relayUrls=t.nip46Urls,this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls))}if(!this.bunkerPubkey&&this.userPubkey)this.bunkerPubkey=this.userPubkey;else if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");return await this.startListening(),this.rpc.on("authUrl",(...t)=>{this.emit("authUrl",...t)}),new Promise((t,r)=>{const n=[this.userPubkey??""];if(this.secret&&n.push(this.secret),!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"connect",n,24133,s=>{s.result==="ack"?this.getPublicKey().then(a=>{this.userPubkey=a,this._user=this.ndk.getUser({pubkey:a}),t(this._user)}):r(s.error)})})}stop(){this.subscription?.stop(),this.subscription=void 0}async getPublicKey(){return this.userPubkey?this.userPubkey:new Promise((t,r)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"get_public_key",[],24133,n=>{t(n.result)})})}async encryptionEnabled(t){return t?[t]:Promise.resolve(["nip04","nip44"])}async encrypt(t,r,n="nip04"){return this.encryption(t,r,n,"encrypt")}async decrypt(t,r,n="nip04"){return this.encryption(t,r,n,"decrypt")}async encryption(t,r,n,s){return new Promise((l,u)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,`${n}_${s}`,[t.pubkey,r],24133,x=>{x.error?u(x.error):l(x.result)})})}async sign(t){return new Promise((n,s)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"sign_event",[JSON.stringify(t)],24133,a=>{if(a.error)s(a.error);else{const l=JSON.parse(a.result);n(l.sig)}})})}async createAccount(t,r,n){await this.startListening();const s=[];return t&&s.push(t),r&&s.push(r),n&&s.push(n),new Promise((a,l)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"create_account",s,24133,u=>{if(u.error)l(u.error);else{const x=u.result;a(x)}})})}toPayload(){if(!this.bunkerPubkey||!this.userPubkey)throw new Error("NIP-46 signer is not fully initialized for serialization");const t={type:"nip46",payload:{bunkerPubkey:this.bunkerPubkey,userPubkey:this.userPubkey,relayUrls:this.relayUrls,secret:this.secret,localSignerPayload:this.localSigner.toPayload(),nip05:this.nip05||null}};return JSON.stringify(t)}static async fromPayload(t,r){if(!r)throw new Error("NDK instance is required to deserialize NIP-46 signer");const n=JSON.parse(t);if(n.type!=="nip46")throw new Error(`Invalid payload type: expected 'nip46', got ${n.type}`);const s=n.payload;if(!s||typeof s!="object"||!s.localSignerPayload)throw new Error("Invalid payload content for nip46 signer");const a=await ndkSignerFromPayload(s.localSignerPayload,r);if(!a)throw new Error("Failed to deserialize local signer for NIP-46");if(!(a instanceof NDKPrivateKeySigner))throw new Error("Local signer must be an instance of NDKPrivateKeySigner");let l;return l=new Tc(r,!1,a,s.relayUrls),l.userPubkey=s.userPubkey,l.bunkerPubkey=s.bunkerPubkey,l.relayUrls=s.relayUrls,l.secret=s.secret,s.userPubkey&&(l._user=new NDKUser({pubkey:s.userPubkey}),l._user&&(l._user.ndk=r)),l}};registerSigner("nip46",NDKNip46Signer);createDebug5("ndk:zapper:ln");createDebug5("ndk:zapper");const index$1=Object.freeze(Object.defineProperty({__proto__:null,BECH32_REGEX,NDKAppHandlerEvent,NDKArticle,NDKBlossomList,NDKCashuMintAnnouncement,NDKCashuMintList,NDKClassified,NDKDVMJobFeedback,NDKDraft,NDKEvent,NDKFedimintMint,NDKFollowPack,NDKHighlight,NDKImage,NDKList,NDKMintRecommendation,NDKNip07Signer,NDKNip46Signer,NDKNostrRpc,NDKNutzap,NDKPool,NDKPrivateKeySigner,NDKProject,NDKProjectTemplate,NDKPublishError,NDKRelay,NDKRelayAuthPolicies,NDKRelayList,NDKRelaySet,NDKRelayStatus,NDKRepost,NDKSimpleGroupMemberList,NDKSimpleGroupMetadata,NDKStory,NDKStorySticker,NDKSubscription,NDKSubscriptionReceipt,NDKSubscriptionStart,NDKSubscriptionTier,NDKTask,NDKThread,NDKUser,NDKVideo,NDKWiki,NDKWikiMergeRequest,NIP33_A_REGEX,calculateRelaySetFromEvent,default:NDK,defaultOpts,deserialize,eventHasETagMarkers,fetchRelayInformation,filterFingerprint,filterFromId,generateContentTags,generateHashtags,getRelayListForUser,getRelayListForUsers,getReplyTag,getRootTag,imetaTagToTag,isNip33AValue,isValidHex64,isValidNip05,isValidPubkey,mapImetaTag,mergeFilters,mergeTags,ndkSignerFromPayload,newAmount,nip19:nip19_exports,nip49:nip49_exports,normalize,normalizeRelayUrl,normalizeUrl,parseTagToSubscriptionAmount,possibleIntervalFrequencies,processFilters,profileFromEvent,queryFullyFilled,registerSigner,relayListFromKind3,relaysFromBech32,serialize,serializeProfile,strToDimension,strToPosition,tryNormalizeRelayUrl,wrapEvent},Symbol.toStringTag,{value:"Module"})),DEFAULT_RELAYS=[{url:"wss://relay.primal.net",status:"disconnected",failedAttempts:0},{url:"wss://relay.damus.io",status:"disconnected",failedAttempts:0},{url:"wss://nos.lol",status:"disconnected",failedAttempts:0}],useRelayStore=create()(persist((e,t)=>({relays:DEFAULT_RELAYS,addRelay:r=>{const n=r.trim();if(!n.startsWith("wss://")&&!n.startsWith("ws://")){console.error("[RelayStore] Invalid relay URL:",r);return}if(t().relays.find(a=>a.url===n)){console.warn("[RelayStore] Relay already exists:",n);return}e(a=>({relays:[...a.relays,{url:n,status:"disconnected",failedAttempts:0}]}))},removeRelay:r=>{e(n=>({relays:n.relays.filter(s=>s.url!==r)}))},updateRelayStatus:(r,n)=>{e(s=>({relays:s.relays.map(a=>a.url===r?{...a,status:n,lastConnected:n==="connected"?Date.now():a.lastConnected}:a)}))},incrementFailedAttempts:r=>{e(n=>({relays:n.relays.map(s=>s.url===r?{...s,failedAttempts:s.failedAttempts+1}:s)}))},resetFailedAttempts:r=>{e(n=>({relays:n.relays.map(s=>s.url===r?{...s,failedAttempts:0}:s)}))},getRelay:r=>t().relays.find(n=>n.url===r),isOnline:()=>t().relays.some(r=>r.status==="connected")}),{name:"amber-relays",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-awXA2Uq6.js");return{storage:r}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:r}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-awXA2Uq6.js");return{storage:n}},[],import.meta.url);return r.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-awXA2Uq6.js");return{storage:r}},[],import.meta.url);return t.removeItem(e)}}))})),BroadcastModal=({eventJson:e,onClose:t,onBroadcast:r,onSuccess:n})=>{const[s,a]=reactExports.useState(!1),[l,u]=reactExports.useState(!1),[x,f]=reactExports.useState(null),[p,g]=reactExports.useState(null),[y,w]=reactExports.useState(!1),[R,I]=reactExports.useState(!1),k=()=>{try{const Ve=nip19_exports$1.npubEncode(e.pubkey);navigator.clipboard.writeText(Ve),I(!0),setTimeout(()=>I(!1),2e3)}catch(Ve){console.error(Ve)}};React.useEffect(()=>{(async()=>{if(e.pubkey){w(!0);try{const q=useRelayStore.getState().relays.map($e=>$e.url);if(q.length>0){const $e=new NDK({explicitRelayUrls:q});await $e.connect();const We=$e.getUser({hexpubkey:e.pubkey});await We.fetchProfile(),We.profile&&g(We.profile)}}catch(q){console.error("Failed to fetch profile",q)}finally{w(!1)}}})()},[e.pubkey]);const je=async()=>{a(!0),f(null);try{await r(),u(!0),n?.(),setTimeout(t,2e3)}catch(Ve){f(Ve.message),a(!1)}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl my-8 animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-slate-800 rounded-full",children:jsxRuntimeExports.jsx(Radio,{className:"w-6 h-6 text-green-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Broadcast Event"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Publish to relays"})]})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-lg text-slate-500 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800 mb-6 space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-800 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-800 overflow-hidden shrink-0 border border-slate-700 flex items-center justify-center",children:y?jsxRuntimeExports.jsx(Loader,{className:"w-5 h-5 text-slate-500 animate-spin"}):p?.image?jsxRuntimeExports.jsx("img",{src:p.image,alt:p.name,className:"w-full h-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500",children:jsxRuntimeExports.jsx(User,{className:"w-6 h-6"})})}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[y?jsxRuntimeExports.jsx("div",{className:"h-4 w-24 bg-slate-800 rounded animate-pulse mb-1"}):p?.displayName?jsxRuntimeExports.jsx("p",{className:"text-white font-bold text-sm truncate",children:p.displayName}):null,jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[y?jsxRuntimeExports.jsx("div",{className:"h-3 w-32 bg-slate-800 rounded animate-pulse"}):jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-400 truncate font-mono",children:[p?.name?`@${p.name}`:"",jsxRuntimeExports.jsx("span",{className:p?.name?"ml-2 opacity-70":"",children:(()=>{try{const Ve=nip19_exports$1.npubEncode(e.pubkey);return`${Ve.slice(0,5)}...${Ve.slice(-5)}`}catch{return e.pubkey.slice(0,10)+"..."}})()})]}),!y&&jsxRuntimeExports.jsx("button",{onClick:k,className:"text-slate-500 hover:text-white transition-colors",title:"Copy Npub",children:R?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]}),!y&&p?.nip05&&jsxRuntimeExports.jsx("p",{className:"text-[10px] text-amber-500 truncate",children:p.nip05})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Kind"}),jsxRuntimeExports.jsx("span",{className:"text-amber-500 font-mono text-sm",children:e.kind})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider block mb-2",children:"Content"}),jsxRuntimeExports.jsx("div",{className:"bg-slate-900 rounded p-2 text-xs text-slate-300 font-mono whitespace-pre-wrap break-words max-h-32 overflow-y-auto border border-slate-800",children:e.content||"<No Content>"})]}),jsxRuntimeExports.jsxs("div",{className:"pt-2 border-t border-slate-800 flex items-center gap-2 text-green-400 text-xs font-mono",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3 h-3"}),"Valid Signature"]})]}),x&&jsxRuntimeExports.jsxs("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg flex items-center gap-2 text-red-400 text-sm",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4"}),x]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:t,disabled:s||l,className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 disabled:opacity-50 text-white font-bold rounded-xl transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:je,disabled:s||l,className:`flex-1 py-3 font-bold rounded-xl transition-colors flex items-center justify-center gap-2 ${l?"bg-green-500 text-slate-950":"bg-green-600 hover:bg-green-700 text-white"}`,children:s?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Broadcasting..."]}):l?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),"Sent!"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Send,{className:"w-4 h-4"}),"Broadcast"]})})]})]})})},DEFAULT_EVENT={kind:1,created_at:Math.floor(Date.now()/1e3),tags:[],content:"This is a test event for offline signing. You can edit this text to make it larger and test animated QRs.",pubkey:""},EventCreator=({onClose:e,onBroadcastSuccess:t})=>{const[r,n]=reactExports.useState(JSON.stringify(DEFAULT_EVENT,null,2)),[s,a]=reactExports.useState(null),[l,u]=reactExports.useState(!1),[x,f]=reactExports.useState(null),[p,g]=reactExports.useState(null),y=reactExports.useRef(null);reactExports.useEffect(()=>{const K={...DEFAULT_EVENT,created_at:Math.floor(Date.now()/1e3)};n(JSON.stringify(K,null,2))},[]),reactExports.useEffect(()=>{try{const K=JSON.parse(r);typeof K.content=="string"?a(K.content):a(null)}catch{}},[r]);const w=K=>{n(K.target.value),l&&u(!1),f(null)},R=K=>{const W=K.target.value;a(W);try{const Ye=JSON.parse(r);Ye.content=W,n(JSON.stringify(Ye,null,2)),l&&u(!1),f(null)}catch{}},I=(K,W,Ye,Qe,it)=>{try{JSON.parse(K);const{currentKeypairId:ze,wallets:v,currentWalletId:D}=useWalletStore.getState(),P=v.find(Ce=>Ce.id===D)?.keypairs.find(Ce=>Ce.id===ze);let Re="";try{if(P?.npub){const{data:Ce}=nip19_exports$1.decode(P.npub);Re=Ce}}catch(Ce){console.error("Failed to decode npub",Ce)}if(!Re){f("No active keypair found");return}const Fe=Math.random().toString(36).substring(7),Le=useRequestStore.getState();Le.requests.forEach(Ce=>{Ce.internal&&Le.removeRequest(Ce.id)}),useRequestStore.getState().addRequest({id:Fe,requestEventId:"internal-"+Fe,requestorPubkey:Re,method:"sign_event",params:[K],timestamp:Date.now()/1e3,source:"client",internal:!0,title:Ye,description:it,confirmLabel:Qe,onSuccess:Ce=>{W(Ce),f(null)},onError:Ce=>{f("Signing failed: "+Ce.message)}})}catch{f("Invalid JSON")}},k=()=>{try{const K=JSON.parse(r);K.created_at=Math.floor(Date.now()/1e3);const W=JSON.stringify(K,null,2);I(W,Ye=>{n(JSON.stringify(JSON.parse(Ye),null,2));const Qe=new Blob([Ye],{type:"application/json"}),it=URL.createObjectURL(Qe),ze=document.createElement("a");ze.href=it,ze.download=`nostr-event-${Date.now()}.json`,document.body.appendChild(ze),ze.click(),document.body.removeChild(ze),URL.revokeObjectURL(it)},"Export Event","Sign & Export","You are opting to sign this event and export it as a JSON file.")}catch{f("Invalid JSON")}},je=()=>{if(l){u(!1);return}try{const K=JSON.parse(r);K.created_at=Math.floor(Date.now()/1e3);const W=JSON.stringify(K,null,2);I(W,Ye=>{n(JSON.stringify(JSON.parse(Ye),null,2)),u(!0)},"Generate QR","Sign & Generate QR","You are opting to sign this event to display it as a QR code.")}catch{f("Invalid JSON")}},Ve=()=>{try{const K=JSON.parse(r),{wallets:W,currentWalletId:Ye,currentKeypairId:Qe}=useWalletStore.getState(),ze=W.find(_e=>_e.id===Ye)?.keypairs.find(_e=>_e.id===Qe);let v="";if(ze?.npub)try{const{data:_e}=nip19_exports$1.decode(ze.npub);v=_e}catch(_e){console.error(_e)}if(!v){f("No active keypair found to sign with");return}K.pubkey=v,K.created_at=Math.floor(Date.now()/1e3),delete K.id,delete K.sig;const D=JSON.stringify(K,null,2);n(D),I(D,_e=>{const P=JSON.parse(_e);n(JSON.stringify(P,null,2)),g(P)},"Broadcast","Sign & Broadcast","You are opting to sign this event with YOUR key and broadcast it to the network.")}catch{f("Invalid JSON")}},q=()=>{y.current?.click()},$e=K=>{const W=K.target.files?.[0];if(!W)return;const Ye=new FileReader;Ye.onload=Qe=>{try{const it=Qe.target?.result,ze=JSON.parse(it);if(ze.sig){g(ze),n(JSON.stringify(ze,null,2)),f(null),y.current&&(y.current.value="");return}n(JSON.stringify(ze,null,2)),f(null),l&&u(!1)}catch{f("Failed to parse JSON file")}y.current&&(y.current.value="")},Ye.readAsText(W)},We=async()=>{if(!p)return;const K=useRelayStore.getState().relays.map(Ye=>Ye.url);if(K.length===0)throw new Error("No relays connected");const W=new NDK({explicitRelayUrls:K});try{await Promise.race([W.connect(),new Promise((Ye,Qe)=>setTimeout(()=>Qe(new Error("Broadcast connection timed out")),5e3))])}catch(Ye){console.warn("Broadcast connection timed out/failed, checking for partial connections...",Ye);let Qe=0;if(W.pool.relays.forEach(it=>{(it.status===1||it.status===5)&&Qe++}),Qe===0)throw console.error("No relays connected for broadcast"),Ye}try{await new NDKEvent(W,p).publish(),t&&t()}catch(Ye){throw console.error("Broadcast failed:",Ye),Ye}};return jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 border border-slate-800 shadow-xl mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-bold text-amber-500 flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:""})," Event Creator"]}),e&&jsxRuntimeExports.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-300",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("textarea",{value:r,onChange:w,className:"w-full h-48 bg-slate-950 text-slate-300 font-mono text-xs p-4 rounded-xl border border-slate-800 focus:border-amber-500/50 outline-none resize-none",spellCheck:!1,placeholder:"Paste Nostr event JSON here..."}),jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2 flex gap-2",children:jsxRuntimeExports.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r)},className:"p-1.5 bg-slate-800 hover:bg-slate-700 rounded-lg text-slate-400 hover:text-white transition-colors",title:"Copy JSON",children:jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 select-none",children:"COPY"})})}),x&&jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 right-4 text-red-500 text-xs font-bold bg-slate-900/90 px-2 py-1 rounded",children:x})]}),s!==null&&jsxRuntimeExports.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2 px-1",children:[jsxRuntimeExports.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Content Editor"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-600",children:"Syncs with JSON"})]}),jsxRuntimeExports.jsx("textarea",{value:s,onChange:R,className:"w-full h-32 bg-slate-950 text-slate-200 font-sans text-sm p-4 rounded-xl border border-slate-800 focus:border-amber-500/50 outline-none resize-y",placeholder:"Edit event content here..."})]}),jsxRuntimeExports.jsx("input",{type:"file",ref:y,className:"hidden",accept:".json",onChange:$e}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:q,className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Upload,{className:"w-4 h-4 text-emerald-500"}),"Import JSON"]}),jsxRuntimeExports.jsxs("button",{onClick:k,className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4 text-blue-500"}),"Sign & Export"]})]}),jsxRuntimeExports.jsxs("button",{onClick:Ve,className:"w-full py-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 border-2 border-slate-700 hover:border-green-500/50",children:[jsxRuntimeExports.jsx(Radio,{className:"w-5 h-5 text-green-500"}),"Sign & Broadcast"]}),jsxRuntimeExports.jsxs("button",{onClick:je,className:"w-full py-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 border-2 border-slate-700 hover:border-amber-500/50",children:[jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5 text-amber-500"}),l?"Hide QR Code":"Sign & Generate QR"]})]}),l&&jsxRuntimeExports.jsxs("div",{className:"bg-white p-4 rounded-xl flex flex-col items-center gap-2 animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsx("div",{className:"w-full max-w-[300px]",children:jsxRuntimeExports.jsx(AnimatedQRCode,{data:r,type:"bytes"})}),jsxRuntimeExports.jsx("p",{className:"text-slate-900 text-xs font-bold mt-4",children:"Scan with Offline Device"})]})]}),p&&jsxRuntimeExports.jsx(BroadcastModal,{eventJson:p,onClose:()=>g(null),onBroadcast:We,onSuccess:t})]})},useConnectionsStore=create()(persist((e,t)=>({connections:[],autoApprovalRules:[],addConnection:r=>e(n=>({connections:[...n.connections,r]})),updateConnectionStatus:(r,n)=>e(s=>({connections:s.connections.map(a=>a.id===r?{...a,status:n}:a)})),updateConnection:(r,n)=>e(s=>({connections:s.connections.map(a=>a.id===r?{...a,...n}:a)})),removeConnection:r=>e(n=>({connections:n.connections.filter(s=>s.id!==r),autoApprovalRules:n.autoApprovalRules.filter(s=>s.connectionId!==r)})),getConnection:r=>t().connections.find(n=>n.id===r),addRule:r=>e(n=>{console.log("[ConnectionsStore] addRule called with:",r);const a=[...n.autoApprovalRules.filter(l=>l.connectionId!==r.connectionId||!l.kinds.some(u=>r.kinds.includes(u))),r];return console.log("[ConnectionsStore] New rules after add:",a),{autoApprovalRules:a}}),removeRule:r=>e(n=>({autoApprovalRules:n.autoApprovalRules.filter(s=>s.id!==r)})),getRulesForConnection:r=>t().autoApprovalRules.filter(n=>n.connectionId===r)}),{name:"amber-connections",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-awXA2Uq6.js");return{storage:r}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:r}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-awXA2Uq6.js");return{storage:n}},[],import.meta.url);return r.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-awXA2Uq6.js");return{storage:r}},[],import.meta.url);return t.removeItem(e)}}))})),useActivityLogStore=create()(persist(e=>({entries:[],maxEntries:100,addEntry:t=>e(r=>{const s=[{...t,id:crypto.randomUUID(),timestamp:Date.now()},...r.entries];return s.length>r.maxEntries&&s.splice(r.maxEntries),{entries:s}}),clearLog:()=>e({entries:[]})}),{name:"amber-activity-log"})),hexToBytes$1=e=>{const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++)t[r]=parseInt(e.substr(r*2,2),16);return t};class SignerService{ndk;signer;privateKey;sub;lastEventTime=0;constructor(t){this.privateKey=t,this.signer=new NDKPrivateKeySigner(t),this.initializeNDK()}initializeNDK(){const t=useRelayStore.getState().relays.map(n=>n.url),r=["wss://relay.nsec.app","wss://relay.primal.net","wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band"];this.ndk=new NDK({explicitRelayUrls:t.length>0?t:r}),this.ndk.signer=this.signer}async connect(t=!1){if(this.sub&&(console.log("[SignerService] Stopping existing subscription before reconnecting..."),this.sub.stop(),this.sub=null),t){console.log("[SignerService] FORCE connecting: DESTROYING and RECREATING NDK instance...");try{this.ndk.pool.relays.forEach(n=>{try{n.disconnect()}catch(s){console.error("Error disconnecting relay:",s)}})}catch(n){console.error("[SignerService] Error during pool cleanup:",n)}await new Promise(n=>setTimeout(n,500)),this.initializeNDK(),console.log("[SignerService] NDK instance recreated.")}console.log("[SignerService] Attempting to connect to relays...");const r=useRelayStore.getState().relays.map(n=>n.url);r.forEach(n=>{useRelayStore.getState().updateRelayStatus(n,"connecting")});try{await new Promise(s=>setTimeout(s,500));try{await Promise.race([this.ndk.connect(),new Promise((s,a)=>setTimeout(()=>a(new Error("Connection timeout")),1e4))]),console.log("[SignerService] NDK connected successfully!")}catch(s){console.warn("[SignerService] NDK connect failed/timed out:",s);let a=0;if(this.ndk.pool.relays.forEach(l=>{l.status===NDKRelayStatus.CONNECTED&&a++}),a===0)throw console.error("[SignerService] No connected relays. Aborting."),s;console.log(`[SignerService] Proceeding with partial connection (${a} relays connected).`)}r.forEach(s=>{const a=Array.from(this.ndk.pool.relays.values()).find(l=>l.url.includes(s)||s.includes(l.url));a&&a.status===NDKRelayStatus.CONNECTED&&(useRelayStore.getState().updateRelayStatus(s,"connected"),useRelayStore.getState().resetFailedAttempts(s))}),this.ndk.pool.relays.forEach(s=>{s.status===NDKRelayStatus.CONNECTED&&(useRelayStore.getState().updateRelayStatus(s.url,"connected"),useRelayStore.getState().resetFailedAttempts(s.url))});const n=await this.signer.user();console.log("[SignerService] Listening for NIP-46 requests to:",n.pubkey),this.sub=this.ndk.subscribe({kinds:[24133],"#p":[n.pubkey],since:Math.floor(Date.now()/1e3)-60},{closeOnEose:!1}),this.sub.on("event",async s=>{this.lastEventTime=Date.now(),console.log("[SignerService] Received NIP-46 event (Health Updated):",s.id);try{let a;try{console.log("[SignerService] Trying NIP-44 decryption...");const w=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),s.pubkey);a=nip44_exports.v2.decrypt(s.content,w),console.log("[SignerService] NIP-44 decryption successful!")}catch(w){console.log("[SignerService] NIP-46 failed, trying NIP-04...",w),a=await nip04_exports.decrypt(this.privateKey,s.pubkey,s.content),console.log("[SignerService] NIP-04 decryption successful!")}console.log("[SignerService] Decrypted content:",a);const l=JSON.parse(a),{id:u,method:x,params:f}=l;console.log("[SignerService] Parsed request:",{id:u,method:x,params:f});const p={id:u,requestEventId:s.id,requestorPubkey:s.pubkey,method:x,params:f,timestamp:s.created_at||Date.now()/1e3};let g=!1,y;if(x==="sign_event")try{const w=f[0];y=JSON.parse(w).kind}catch(w){console.error("[SignerService] Failed to parse sign_event params",w)}else x==="nip04_decrypt"?y=-4:x==="nip04_encrypt"&&(y=-5);if(y!==void 0){const w=useConnectionsStore.getState(),R=w.connections.find(I=>I.signerPubkey===s.pubkey);if(R){const k=w.getRulesForConnection(R.id).filter(je=>je.kinds.includes(y));if(k.length>0){const je=k.some(q=>q.policy==="reject"),Ve=je?k.find(q=>q.policy==="reject"):k[0];je?(console.log(`[SignerService]  Auto-blocking kind ${y} for ${R.name||"app"} (Policy: ${Ve?.policy})`),g=!0,await this.rejectRequest(u,s.id,s.pubkey,"Request blocked by user policy")):(console.log(`[SignerService]  Auto-approving kind ${y} for ${R.name||"app"}`),g=!0,await this.approveRequest(u,s.id,s.pubkey,x,f));return}}}if(x==="get_public_key")try{const R=useConnectionsStore.getState().connections.find(I=>I.signerPubkey===s.pubkey);if(R){console.log(`[SignerService] Auto-approving get_public_key for ${R.name||"app"}`),g=!0,await this.approveRequest(u,s.id,s.pubkey,x,f);return}}catch(w){console.error("[SignerService] Error checking get_public_key auto-approval:",w)}g||(console.log("[SignerService] Adding request to store and showing notification"),useRequestStore.getState().addRequest(p))}catch(a){console.error("Failed to parse NIP-46 request",a)}})}catch(n){throw console.error("[SignerService] Connection failed:",n),r.forEach(s=>{useRelayStore.getState().updateRelayStatus(s,"error"),useRelayStore.getState().incrementFailedAttempts(s)}),n}}async signEventInternal(t){const r=new NDKEvent(this.ndk,JSON.parse(t));return await r.sign(this.signer),JSON.stringify(r.rawEvent())}async approveRequest(t,r,n,s,a){try{let l=null;switch(s){case"connect":l="ack";break;case"get_public_key":l=(await this.signer.user()).pubkey;break;case"sign_event":const y=a[0],w=new NDKEvent(this.ndk,JSON.parse(y));await w.sign(this.signer),l=JSON.stringify(w.rawEvent());break;case"nip04_decrypt":const R=a[0],I=a[1];l=await nip04_exports.decrypt(this.privateKey,R,I);break;case"nip04_encrypt":const k=a[0],je=a[1];l=await nip04_exports.encrypt(this.privateKey,k,je);break;default:throw new Error(`Unknown method: ${s}`)}const u=JSON.stringify({id:t,result:l,error:null}),x=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),n),f=nip44_exports.v2.encrypt(u,x),p=new NDKEvent(this.ndk);p.kind=24133,p.tags=[["p",n],["e",r]],p.content=f,await p.sign(this.signer),console.log("[SignerService]  About to publish response for:",s),console.log("[SignerService]  Response triggered from:",new Error().stack?.split(`
`)[2]?.trim()),await p.publish(),console.log("[SignerService] Sent encrypted response for:",s),useActivityLogStore.getState().addEntry({action:"approved",method:s,appName:"Bunker Client",appPubkey:n,event:s==="sign_event"&&a[0]?typeof a[0]=="string"?JSON.parse(a[0]):a[0]:void 0}),useRequestStore.getState().removeRequest(t)}catch(l){console.error("Error approving request:",l),this.rejectRequest(t,r,n,l.message)}}async rejectRequest(t,r,n,s="User rejected"){const a=JSON.stringify({id:t,result:null,error:s}),l=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),n),u=nip44_exports.v2.encrypt(a,l),x=new NDKEvent(this.ndk);x.kind=24133,x.tags=[["p",n],["e",r]],x.content=u,await x.sign(this.signer),console.log(`[SignerService]  ABOUT TO SEND REJECTION for ${t}:`,{error:s,to:n.slice(0,8),stackTrace:new Error().stack?.split(`
`).slice(1,4).join(`
`)}),await x.publish(),console.log("[SignerService] Sent encrypted rejection"),useRequestStore.getState().removeRequest(t)}async getBunkerURI(){return`bunker://${(await this.signer.user()).pubkey}?relay=wss://relay.damus.io`}disconnect(){this.sub&&this.sub.stop()}async addRelay(t){console.log("[SignerService] Adding new relay:",t);const r=this.ndk.addExplicitRelay(t);useRelayStore.getState().updateRelayStatus(t,"connecting");try{await r.connect(),console.log("[SignerService] New relay connected:",t),useRelayStore.getState().updateRelayStatus(t,"connected"),useRelayStore.getState().resetFailedAttempts(t)}catch(n){console.error("[SignerService] Failed to connect to new relay:",n),useRelayStore.getState().updateRelayStatus(t,"error"),useRelayStore.getState().incrementFailedAttempts(t)}}hasActiveSubscription(){return this.sub!==null&&this.sub!==void 0}isSubscriptionHealthy(){if(Date.now()-this.lastEventTime<6e4)return!0;let t=0;const r=[];return this.ndk.pool.relays.forEach(n=>{r.push(`${n.url}: ${n.status}`),(n.status===NDKRelayStatus.CONNECTED||n.status===1)&&t++}),t===0&&console.log("[SignerService] Health Check Details:",r,"Enum CONNECTED:",NDKRelayStatus.CONNECTED),t>0}async reconnectSubscription(t=!1){console.log(`[SignerService] Attempting to reconnect subscription... (Force: ${t})`);try{return await this.connect(t),!0}catch(r){return console.error("[SignerService] Failed to reconnect subscription:",r),!1}}}const parseRequestForUI=(e,t)=>{const{method:r,params:n}=e,s=t||"The app",a=l=>e.description||l;if(r==="get_public_key")return{title:e.title||"Connection Request",description:a(`${s} wants to connect to your signer. It will be able to read your public key.`),primaryAction:"Connect",riskLevel:"low",icon:"connect"};if(r==="nip04_encrypt")return{title:"Send Private Message",description:`${s} wants to encrypt a private message.`,contentPreview:typeof n[1]=="string"?n[1]:"Unknown content",primaryAction:"Encrypt",riskLevel:"medium",icon:"encrypt"};if(r==="nip04_decrypt")return{title:"Read Private Message",description:`${s} wants to decrypt a private message sent to you.`,primaryAction:"Decrypt",riskLevel:"medium",icon:"decrypt"};if(r==="sign_event")try{const l=JSON.parse(n[0]),u=l.kind,x=l.content||"";if(u===1)return{title:e.title||"Post a Note",description:a(`${s} wants to publish a public note to your profile.`),contentPreview:x,primaryAction:"Post",riskLevel:"low",icon:"post"};if(u===7){let f="";return x==="+"?f="":x==="-"?f="":x&&(f=x),{title:"React to Post",description:`${s} wants to react with ${f} to a post.`,primaryAction:"React",riskLevel:"low",icon:"reaction"}}if(u===0)return{title:"Update Profile",description:`${s} wants to update your public profile (name, picture, etc).`,contentPreview:"Profile Data Update",primaryAction:"Update",riskLevel:"medium",icon:"profile"};if(u===3){const f=l.tags.filter(p=>p[0]==="p").length;return{title:"Update Follow List",description:`${s} wants to update your following list (${f} people).`,primaryAction:"Update",riskLevel:"medium",icon:"profile"}}return u===6?{title:"Repost",description:`${s} wants to share a post to your profile.`,primaryAction:"Repost",riskLevel:"low",icon:"post"}:u===9734?{title:"Send Zap",description:`${s} wants to request a Zap (Tip) payment.`,primaryAction:"Zap",riskLevel:"medium",icon:"zap"}:{title:e.title||`Publish Event (Kind ${u})`,description:a(`${s} wants to publish a standard Nostr event.`),contentPreview:x?x.length>100?x.slice(0,100)+"...":x:"No content",primaryAction:"Sign",riskLevel:"medium",icon:"unknown"}}catch(l){return console.error("Failed to parse event for UI",l),{title:"Sign Malformed Event",description:"The app wants to sign a specific event, but the data seems invalid.",primaryAction:"Sign",riskLevel:"high",icon:"unknown"}}return{title:"Unknown Request",description:`Request method: ${r}`,primaryAction:"Approve",riskLevel:"high",icon:"unknown"}},RequestModal=({request:e,onApprove:t,onReject:r})=>{const[n,s]=reactExports.useState(!1),[a,l]=reactExports.useState(!1),[u,x]=reactExports.useState(!1);React.useEffect(()=>{s(!1),l(!1),x(!1)},[e.id]);const g=useConnectionsStore(k=>k.connections).find(k=>k.signerPubkey===e.requestorPubkey)?.name,y=parseRequestForUI(e,g),w=()=>{switch(y.icon){case"post":return jsxRuntimeExports.jsx(MessageSquare,{className:"w-6 h-6 text-amber-500"});case"reaction":return jsxRuntimeExports.jsx(MessageSquare,{className:"w-6 h-6 text-red-500"});case"zap":return jsxRuntimeExports.jsx(Zap,{className:"w-6 h-6 text-yellow-500"});case"profile":return jsxRuntimeExports.jsx(User,{className:"w-6 h-6 text-blue-500"});case"connect":return jsxRuntimeExports.jsx(Link,{className:"w-6 h-6 text-green-500"});case"encrypt":return jsxRuntimeExports.jsx(Lock,{className:"w-6 h-6 text-indigo-500"});case"decrypt":return jsxRuntimeExports.jsx(Lock,{className:"w-6 h-6 text-indigo-500"});default:return jsxRuntimeExports.jsx(FileText,{className:"w-6 h-6 text-slate-400"})}},R=k=>{s(!0),t(k)},I=(k=!1)=>{l(!0),r(k)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl my-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-slate-800 rounded-full",children:w()}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:e.title||y.title}),!e.internal&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-slate-400",children:["from ",e.requestorPubkey.slice(0,8),"..."]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>x(!u),className:"p-2 hover:bg-slate-800 rounded-lg text-slate-500 hover:text-white transition-colors",title:u?"Show Simple View":"Show Advanced Details",children:u?jsxRuntimeExports.jsx(Code,{className:"w-5 h-5 text-amber-500"}):jsxRuntimeExports.jsx(Code,{className:"w-5 h-5"})})]}),!u&&jsxRuntimeExports.jsx("div",{className:"space-y-6",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800",children:[jsxRuntimeExports.jsx("p",{className:"text-slate-300 text-sm leading-relaxed mb-3",children:y.description}),y.contentPreview&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-lg p-3 border border-slate-800",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase mb-1",children:"Preview"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-white font-mono whitespace-pre-wrap break-words max-h-32 overflow-y-auto",children:y.contentPreview})]})]})}),u&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 mb-6 border border-slate-800 animate-in fade-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Method"}),jsxRuntimeExports.jsx("p",{className:"text-amber-400 font-mono text-sm",children:e.method})]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Request ID"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 font-mono text-xs",children:e.id})]}),e.method==="sign_event"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Raw Event JSON"}),jsxRuntimeExports.jsx("pre",{className:"text-xs text-slate-300 overflow-auto max-h-48 mt-1 p-2 bg-slate-900 rounded border border-slate-800 font-mono",children:JSON.stringify(JSON.parse(e.params[0]),null,2)})]})]}),(e.method==="sign_event"||e.method==="nip04_decrypt"||e.method==="nip04_encrypt")&&!e.internal?jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-6",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>I(!0),disabled:n||a,className:"w-full bg-rose-800 hover:bg-rose-600 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[a?jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsx(Ban,{className:"w-4 h-4"}),a?"Blocking...":"Auto-Block"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>I(!1),disabled:n||a,className:"w-full bg-slate-700 hover:bg-slate-600 disabled:bg-slate-800 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[a?jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsx(Ban,{className:"w-4 h-4"}),a?"Rejecting...":"Block"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>R(!0),disabled:n||a,className:"w-full bg-amber-700 hover:bg-amber-600 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[n?jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),n?"Approving...":"Auto-Approve"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>R(!1),disabled:n||a,className:"w-full bg-amber-500 hover:bg-amber-400 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[n?jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),e.confirmLabel||(n?"Approving...":"Approve")]})]}):jsxRuntimeExports.jsxs("div",{className:"flex gap-3 mt-6",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>I(!1),disabled:n||a,className:"flex-1 bg-slate-700 hover:bg-slate-600 disabled:bg-slate-800 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[a?jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsx(Ban,{className:"w-4 h-4"}),a?e.internal?"Cancelling...":"Rejecting...":e.cancelLabel||(e.internal?"Cancel":"Block")]}),jsxRuntimeExports.jsxs("button",{onClick:()=>R(!1),disabled:n||a,className:"flex-1 bg-amber-500 hover:bg-amber-400 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[n?jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),e.confirmLabel||(n?"Approving...":"Approve")]})]})]})})},OfflineSigner=({event:e,onClose:t})=>{const{decryptedKey:r}=useAuthStore(),[n,s]=reactExports.useState(null),[a,l]=reactExports.useState(null),u={id:"offline",pubkey:e.pubkey,method:"sign_event",params:[JSON.stringify(e)],encryptedNsec:"",requestorPubkey:e.pubkey},x=parseRequestForUI(u,"Offline Request"),f=async()=>{if(!r){l("Wallet is locked. Please unlock it first.");return}try{const p=new NDKPrivateKeySigner(r),g=new NDKEvent(void 0,e);await g.sign(p);const y=JSON.stringify(g.rawEvent());s(y)}catch(p){console.error("Signing failed:",p),l("Failed to sign event: "+p.message)}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl max-w-lg w-full border border-slate-800 shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-800 flex justify-between items-center bg-slate-900/50 backdrop-blur-md",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(ShieldCheck,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h2",{className:"font-bold text-white",children:"Offline Signer"})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-full transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:n?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center animate-in fade-in zoom-in duration-300",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-bold text-green-400 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Check,{className:"w-5 h-5"}),"Signed Successfully"]}),jsxRuntimeExports.jsx("div",{className:"w-full mb-6",children:jsxRuntimeExports.jsx(AnimatedQRCode,{data:n})}),jsxRuntimeExports.jsx("p",{className:"text-center text-slate-500 text-sm mb-6",children:"Scan this animated QR code with your watch-only app to broadcast the event."}),jsxRuntimeExports.jsx("button",{onClick:t,className:"w-full py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors",children:"Done"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"mb-6 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-xl font-bold text-white mb-2",children:x.title}),jsxRuntimeExports.jsx("div",{className:"text-slate-400 text-sm",children:x.description})]}),jsxRuntimeExports.jsx("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800 mb-6 font-mono text-xs text-slate-300 overflow-x-auto",children:jsxRuntimeExports.jsx("pre",{children:JSON.stringify(e,null,2)})}),a&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-3 bg-red-500/10 border border-red-500/20 rounded-lg flex items-center gap-2 text-red-400 text-sm",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4"}),a]}),jsxRuntimeExports.jsxs("button",{onClick:f,className:"w-full py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-all shadow-lg shadow-amber-500/20 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Check,{className:"w-5 h-5"}),"Sign & Display QR"]})]})})]})})},hexToBytes=e=>{const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++)t[r]=parseInt(e.substr(r*2,2),16);return t};class ClientService{ndk;signer;privateKey;sub;connectionId;signerPubkey;secret;startedVia;constructor(t,r,n){if(t.startsWith("nsec"))try{console.log("[ClientService] Detected nsec, converting to hex...");const{data:s}=nip19_exports$1.decode(t);this.privateKey=Buffer.from(s).toString("hex"),console.log("[ClientService] Converted nsec to hex successfully")}catch(s){console.error("[ClientService] Failed to decode nsec key:",s),this.privateKey=t}else this.privateKey=t;this.connectionId=r,this.signerPubkey=n.signerPubkey,this.secret=n.secret,this.startedVia=n.startedVia,this.signer=new NDKPrivateKeySigner(this.privateKey),this.ndk=new NDK({explicitRelayUrls:n.relays}),this.ndk.signer=this.signer}static parseNostrConnectURI(t){try{const r=new URL(t),n=r.hostname||r.pathname.replace("//",""),s=r.searchParams.getAll("relay").map(decodeURIComponent),a=r.searchParams.get("secret")||void 0,l=r.searchParams.get("name")||void 0,u=r.searchParams.get("url")?decodeURIComponent(r.searchParams.get("url")):void 0;if(!n||s.length===0)throw new Error("Invalid nostrconnect URI: missing pubkey or relays");return{signerPubkey:n,relays:s,secret:a,name:l,appUrl:u}}catch(r){throw new Error(`Failed to parse nostrconnect URI: ${r}`)}}async connect(){console.log("[ClientService] Connecting as signer for app..."),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connecting");try{try{await Promise.race([this.ndk.connect(),new Promise((n,s)=>setTimeout(()=>s(new Error("Connection timeout")),1e4))])}catch(n){console.warn("[ClientService] Main connect failed, checking for partial connection...",n);let s=0;if(this.ndk.pool.relays.forEach(a=>{(a.status===1||a.status===5)&&s++}),s===0)throw n;console.log(`[ClientService] Proceeding with partial connection (${s} relays).`)}const t=await this.signer.user();console.log("[ClientService] Connected! Our pubkey:",t.pubkey),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connected");const r={kinds:[24133],"#p":[t.pubkey],since:Math.floor(Date.now()/1e3)};if(console.log("[ClientService] Subscription filter:",JSON.stringify(r)),this.sub=this.ndk.subscribe(r,{closeOnEose:!1}),console.log("[ClientService] Listening for requests from:",this.signerPubkey),console.log("[ClientService] Our pubkey (receiving events tagged with):",t.pubkey),this.secret&&this.startedVia==="nostrconnect"){console.log("[ClientService] Sending proactive connect RESPONSE with secret:",this.secret),console.log("[ClientService] User agent:",navigator.userAgent),console.log("[ClientService] Is mobile:",/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));try{const n=JSON.stringify({id:"connect_"+Math.random().toString(36).substring(7),result:this.secret,error:null}),s=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),this.signerPubkey),a=nip44_exports.v2.encrypt(n,s),l=new NDKEvent(this.ndk);l.kind=24133,l.tags=[["p",this.signerPubkey]],l.content=a,await l.sign(this.signer);const u=await l.publish();console.log("[ClientService]  Proactive connect RESPONSE sent to:",Array.from(u).map(x=>x.url))}catch(n){console.error("[ClientService] Failed to send proactive connect RESPONSE:",n)}}this.sub.on("event",async n=>{console.log("[ClientService]  EVENT RECEIVED!"),console.log("[ClientService] Event from:",n.pubkey),console.log("[ClientService] Event kind:",n.kind),console.log("[ClientService] Event tags:",n.tags),console.log("[ClientService] Event content (encrypted):",n.content.substring(0,50)+"..."),console.log("[ClientService] Event created_at:",n.created_at,"Current time:",Math.floor(Date.now()/1e3));const s=n.created_at||0,a=Math.floor(Date.now()/1e3);if(a-s>60){console.log(`[ClientService]  Ignoring stale event from ${a-s}s ago`);return}const l=n.pubkey===this.signerPubkey;l||console.warn(`[ClientService] Event from unknown pubkey: ${n.pubkey} (expected ${this.signerPubkey}). Attempting to decrypt and verify...`);try{let u,x="nip44";try{const w=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n.pubkey);u=nip44_exports.v2.decrypt(n.content,w),console.log("[ClientService]  Decrypted with NIP-44")}catch{u=await nip04_exports.decrypt(this.privateKey,n.pubkey,n.content),x="nip04",console.log("[ClientService]  Decrypted with NIP-04")}const f=JSON.parse(u),{id:p,method:g,params:y}=f;if(!l)if(console.log(`[ClientService]  Request from different pubkey: method=${g}, params=${JSON.stringify(y?.slice(0,1))}`),g==="connect"&&y[0]===this.secret){console.log("[ClientService]  Key rotation detected! Updating signer pubkey to:",n.pubkey),this.signerPubkey=n.pubkey;const{updateConnection:w}=useConnectionsStore.getState();w(this.connectionId,{signerPubkey:n.pubkey})}else console.warn(`[ClientService]  Accepting request from alternate pubkey (method: ${g})`);if(console.log(`[ClientService]  Processing request: method=${g}, id=${p}, from=${l?"expected key":"alternate key"}`),g==="connect"||g==="get_public_key"||g==="ping"){console.log(`[ClientService] Auto-approving ${g} request`),await this.approveRequest(p,n.id,n.pubkey,g,y||[],x);return}if(g==="sign_event")try{const w=y[0],I=JSON.parse(w).kind;console.log("[ClientService] Checking auto-approval for kind:",I),console.log("[ClientService] Connection ID:",this.connectionId);const k=useConnectionsStore.getState(),je=k.connections.find(Ve=>Ve.id===this.connectionId);if(console.log("[ClientService] Found connection:",je?{id:je.id,name:je.name}:"NOT FOUND"),je){const Ve=k.getRulesForConnection(je.id);console.log("[ClientService] Rules for this connection:",Ve);const q=Ve.filter($e=>$e.kinds.includes(I));if(console.log("[ClientService] Matching rules:",q),q.length>0)if(q.some(We=>We.policy==="reject")){console.log(`[ClientService]  Auto-blocking kind ${I} for ${je.name||"app"}`),await this.rejectRequest(p,n.id,n.pubkey,"Request blocked by user policy");return}else{console.log(`[ClientService]  Auto-approving kind ${I} for ${je.name||"app"}`),await this.approveRequest(p,n.id,n.pubkey,g,y,x);return}else console.log("[ClientService]  No matching rule found, showing modal")}else console.log("[ClientService]  Connection not found in store")}catch(w){console.error("[ClientService] Error checking auto-approval:",w)}if(g==="nip04_decrypt"||g==="nip04_encrypt")try{const w=g==="nip04_decrypt"?-4:-5;console.log(`[ClientService] Checking auto-approval for ${g} (kind: ${w})`),console.log("[ClientService] Connection ID:",this.connectionId);const R=useConnectionsStore.getState(),I=R.connections.find(k=>k.id===this.connectionId);if(console.log("[ClientService] Found connection:",I?{id:I.id,name:I.name}:"NOT FOUND"),I){const k=R.getRulesForConnection(I.id);console.log("[ClientService] Rules for this connection:",k);const je=k.filter(Ve=>Ve.kinds.includes(w));if(console.log("[ClientService] Matching rules:",je),je.length>0)if(je.some(q=>q.policy==="reject")){console.log(`[ClientService]  Auto-blocking ${g} for ${I.name||"app"}`),await this.rejectRequest(p,n.id,n.pubkey,"Request blocked by user policy");return}else{console.log(`[ClientService]  Auto-approving ${g} for ${I.name||"app"}`),await this.approveRequest(p,n.id,n.pubkey,g,y,x);return}else console.log(`[ClientService]  No matching rule found for ${g}, showing modal`)}else console.log("[ClientService]  Connection not found in store")}catch(w){console.error("[ClientService] Error checking auto-approval:",w)}useRequestStore.getState().addRequest({id:p,requestEventId:n.id,requestorPubkey:n.pubkey,method:g,params:y,timestamp:n.created_at||Date.now()/1e3,source:"client",connectionId:this.connectionId,encryptionMethod:x}),console.log("[ClientService] Added request to queue:",g)}catch(u){console.error("[ClientService] Failed to process:",u)}}),console.log("[ClientService]  Subscription created and event handler attached"),console.log("[ClientService] Connected and listening for requests"),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connected")}catch(t){throw console.error("[ClientService] Connection failed:",t),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"error"),t}}async approveRequest(t,r,n,s,a,l="nip04"){if(console.log(`[ClientService]  approveRequest called for ${s} (id: ${t}) using ${l}`),!useConnectionsStore.getState().connections.find(x=>x.id===this.connectionId)){console.error(`[ClientService]  Connection ${this.connectionId} no longer exists! Aborting response to prevent orphaned reply.`);return}try{if(s==="connect"){const R=this.secret||a[0];console.log(`[ClientService]  Sending connect RESPONSE. Stored secret: ${this.secret?"YES":"NO"}, Param secret: ${a[0]?"YES":"NO"}, Using: ${R||"ack"}`);const I=JSON.stringify({id:t,result:R||"ack",error:null});console.log("[ClientService] Connect Response content:",I);let k;if(l==="nip04")k=await nip04_exports.encrypt(this.privateKey,n,I);else{const q=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n);k=nip44_exports.v2.encrypt(I,q)}const je=new NDKEvent(this.ndk);je.kind=24133,je.tags=[["p",n]],je.content=k,console.log("[ClientService] Sending connect response event to:",n),await je.sign(this.signer),console.log("[ClientService]  PUBLISHING PROACTIVE CONNECT:",{to:this.signerPubkey.slice(0,8),secret:this.secret});const Ve=await je.publish();console.log("[ClientService]  Sent connect response to relays:",Array.from(Ve).map(q=>q.url)),useRequestStore.getState().removeRequest(t);return}let x;if(s==="get_public_key")x=(await this.signer.user()).pubkey;else if(s==="sign_event"){console.log("[ClientService] Signing event:",a[0]);const R=typeof a[0]=="string"?JSON.parse(a[0]):a[0],I=new NDKEvent(this.ndk,R);await I.sign(this.signer),x=JSON.stringify(I.rawEvent()),console.log("[ClientService] Event signed successfully")}else if(s==="nip04_decrypt"){const R=a[0],I=a[1];x=await nip04_exports.decrypt(this.privateKey,R,I)}else if(s==="nip04_encrypt"){const R=a[0],I=a[1];x=await nip04_exports.encrypt(this.privateKey,R,I)}else throw new Error(`Unknown method: ${s}`);const f=JSON.stringify({id:t,result:x,error:null});console.log("[ClientService] Response content:",f);let p;if(l==="nip04")p=await nip04_exports.encrypt(this.privateKey,n,f);else{const R=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n);p=nip44_exports.v2.encrypt(f,R)}const g=new NDKEvent(this.ndk);g.kind=24133,g.tags=r?[["p",n],["e",r]]:[["p",n]],g.content=p,console.log("[ClientService] Sending response event:",{kind:g.kind,tags:g.tags,to:n}),console.log("[ClientService]  Response triggered from:",new Error().stack?.split(`
`)[2]?.trim()),await g.sign(this.signer),console.log("[ClientService]  PUBLISHING APPROVAL RESPONSE:",{requestId:t,method:s,to:n.slice(0,8),hasError:f.includes('"error":null')?"NO":"YES",contentPreview:f.slice(0,100)});const y=await g.publish();console.log("[ClientService] Published response to relays:",Array.from(y).map(R=>R.url)),console.log("[ClientService]  Sent approval for:",s);const w=useConnectionsStore.getState().connections.find(R=>R.id===this.connectionId);useActivityLogStore.getState().addEntry({action:"approved",method:s,appName:w?.name,appPubkey:n,event:s==="sign_event"&&a[0]?typeof a[0]=="string"?JSON.parse(a[0]):a[0]:void 0}),useRequestStore.getState().removeRequest(t)}catch(x){console.error("[ClientService] Error approving:",x);try{const f=JSON.stringify({id:t,result:null,error:x.message||"Unknown error"});let p;if(l==="nip04")p=await nip04_exports.encrypt(this.privateKey,n,f);else{const y=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n);p=nip44_exports.v2.encrypt(f,y)}const g=new NDKEvent(this.ndk);g.kind=24133,g.tags=[["p",n]],g.content=p,await g.sign(this.signer),await g.publish(),console.log("[ClientService] Error response published")}catch(f){console.error("[ClientService] Failed to send error response:",f)}}}async rejectRequest(t,r,n,s="User rejected"){console.log(`[ClientService]  rejectRequest called for (id: ${t})`);const a=JSON.stringify({id:t,result:null,error:s}),l=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n),u=nip44_exports.v2.encrypt(a,l),x=new NDKEvent(this.ndk);x.kind=24133,x.tags=r?[["p",n],["e",r]]:[["p",n]],x.content=u,await x.sign(this.signer),console.log(`[ClientService]  ABOUT TO SEND REJECTION for ${t}:`,{error:s,to:n.slice(0,8),stackTrace:new Error().stack?.split(`
`).slice(1,4).join(`
`)}),await x.publish(),console.log("[ClientService] Sent rejection");const f=useConnectionsStore.getState().connections.find(p=>p.id===this.connectionId);useActivityLogStore.getState().addEntry({action:"rejected",method:"unknown",appName:f?.name,appPubkey:n,error:s}),useRequestStore.getState().removeRequest(t)}disconnect(){this.sub&&this.sub.stop();try{this.ndk.pool&&this.ndk.pool.close()}catch(t){console.warn("[ClientService] Failed to close NDK pool:",t)}useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"disconnected"),console.log("[ClientService] Disconnected")}}var jsQR$2={exports:{}},jsQR$1=jsQR$2.exports,hasRequiredJsQR;function requireJsQR(){return hasRequiredJsQR||(hasRequiredJsQR=1,(function(e,t){(function(n,s){e.exports=s()})(typeof self<"u"?self:jsQR$1,function(){return(function(r){var n={};function s(a){if(n[a])return n[a].exports;var l=n[a]={i:a,l:!1,exports:{}};return r[a].call(l.exports,l,l.exports,s),l.l=!0,l.exports}return s.m=r,s.c=n,s.d=function(a,l,u){s.o(a,l)||Object.defineProperty(a,l,{configurable:!1,enumerable:!0,get:u})},s.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(l,"a",l),l},s.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},s.p="",s(s.s=3)})([(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function l(u,x){this.width=x,this.height=u.length/x,this.data=u}return l.createEmpty=function(u,x){return new l(new Uint8ClampedArray(u*x),u)},l.prototype.get=function(u,x){return u<0||u>=this.width||x<0||x>=this.height?!1:!!this.data[x*this.width+u]},l.prototype.set=function(u,x,f){this.data[x*this.width+u]=f?1:0},l.prototype.setRegion=function(u,x,f,p,g){for(var y=x;y<x+p;y++)for(var w=u;w<u+f;w++)this.set(w,y,!!g)},l})();n.BitMatrix=a}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(2);function l(x,f){return x^f}n.addOrSubtractGF=l;var u=(function(){function x(f,p,g){this.primitive=f,this.size=p,this.generatorBase=g,this.expTable=new Array(this.size),this.logTable=new Array(this.size);for(var y=1,w=0;w<this.size;w++)this.expTable[w]=y,y=y*2,y>=this.size&&(y=(y^this.primitive)&this.size-1);for(var w=0;w<this.size-1;w++)this.logTable[this.expTable[w]]=w;this.zero=new a.default(this,Uint8ClampedArray.from([0])),this.one=new a.default(this,Uint8ClampedArray.from([1]))}return x.prototype.multiply=function(f,p){return f===0||p===0?0:this.expTable[(this.logTable[f]+this.logTable[p])%(this.size-1)]},x.prototype.inverse=function(f){if(f===0)throw new Error("Can't invert 0");return this.expTable[this.size-this.logTable[f]-1]},x.prototype.buildMonomial=function(f,p){if(f<0)throw new Error("Invalid monomial degree less than 0");if(p===0)return this.zero;var g=new Uint8ClampedArray(f+1);return g[0]=p,new a.default(this,g)},x.prototype.log=function(f){if(f===0)throw new Error("Can't take log(0)");return this.logTable[f]},x.prototype.exp=function(f){return this.expTable[f]},x})();n.default=u}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(1),l=(function(){function u(x,f){if(f.length===0)throw new Error("No coefficients.");this.field=x;var p=f.length;if(p>1&&f[0]===0){for(var g=1;g<p&&f[g]===0;)g++;if(g===p)this.coefficients=x.zero.coefficients;else{this.coefficients=new Uint8ClampedArray(p-g);for(var y=0;y<this.coefficients.length;y++)this.coefficients[y]=f[g+y]}}else this.coefficients=f}return u.prototype.degree=function(){return this.coefficients.length-1},u.prototype.isZero=function(){return this.coefficients[0]===0},u.prototype.getCoefficient=function(x){return this.coefficients[this.coefficients.length-1-x]},u.prototype.addOrSubtract=function(x){var f;if(this.isZero())return x;if(x.isZero())return this;var p=this.coefficients,g=x.coefficients;p.length>g.length&&(f=[g,p],p=f[0],g=f[1]);for(var y=new Uint8ClampedArray(g.length),w=g.length-p.length,R=0;R<w;R++)y[R]=g[R];for(var R=w;R<g.length;R++)y[R]=a.addOrSubtractGF(p[R-w],g[R]);return new u(this.field,y)},u.prototype.multiply=function(x){if(x===0)return this.field.zero;if(x===1)return this;for(var f=this.coefficients.length,p=new Uint8ClampedArray(f),g=0;g<f;g++)p[g]=this.field.multiply(this.coefficients[g],x);return new u(this.field,p)},u.prototype.multiplyPoly=function(x){if(this.isZero()||x.isZero())return this.field.zero;for(var f=this.coefficients,p=f.length,g=x.coefficients,y=g.length,w=new Uint8ClampedArray(p+y-1),R=0;R<p;R++)for(var I=f[R],k=0;k<y;k++)w[R+k]=a.addOrSubtractGF(w[R+k],this.field.multiply(I,g[k]));return new u(this.field,w)},u.prototype.multiplyByMonomial=function(x,f){if(x<0)throw new Error("Invalid degree less than 0");if(f===0)return this.field.zero;for(var p=this.coefficients.length,g=new Uint8ClampedArray(p+x),y=0;y<p;y++)g[y]=this.field.multiply(this.coefficients[y],f);return new u(this.field,g)},u.prototype.evaluateAt=function(x){var f=0;if(x===0)return this.getCoefficient(0);var p=this.coefficients.length;if(x===1)return this.coefficients.forEach(function(y){f=a.addOrSubtractGF(f,y)}),f;f=this.coefficients[0];for(var g=1;g<p;g++)f=a.addOrSubtractGF(this.field.multiply(x,f),this.coefficients[g]);return f},u})();n.default=l}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(4),l=s(5),u=s(11),x=s(12);function f(y){var w=x.locate(y);if(!w)return null;for(var R=0,I=w;R<I.length;R++){var k=I[R],je=u.extract(y,k),Ve=l.decode(je.matrix);if(Ve)return{binaryData:Ve.bytes,data:Ve.text,chunks:Ve.chunks,version:Ve.version,location:{topRightCorner:je.mappingFunction(k.dimension,0),topLeftCorner:je.mappingFunction(0,0),bottomRightCorner:je.mappingFunction(k.dimension,k.dimension),bottomLeftCorner:je.mappingFunction(0,k.dimension),topRightFinderPattern:k.topRight,topLeftFinderPattern:k.topLeft,bottomLeftFinderPattern:k.bottomLeft,bottomRightAlignmentPattern:k.alignmentPattern}}}return null}var p={inversionAttempts:"attemptBoth"};function g(y,w,R,I){I===void 0&&(I={});var k=p;Object.keys(k||{}).forEach(function(W){k[W]=I[W]||k[W]});var je=k.inversionAttempts==="attemptBoth"||k.inversionAttempts==="invertFirst",Ve=k.inversionAttempts==="onlyInvert"||k.inversionAttempts==="invertFirst",q=a.binarize(y,w,R,je),$e=q.binarized,We=q.inverted,K=f(Ve?We:$e);return!K&&(k.inversionAttempts==="attemptBoth"||k.inversionAttempts==="invertFirst")&&(K=f(Ve?$e:We)),K}g.default=g,n.default=g}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(0),l=8,u=24;function x(g,y,w){return g<y?y:g>w?w:g}var f=(function(){function g(y,w){this.width=y,this.data=new Uint8ClampedArray(y*w)}return g.prototype.get=function(y,w){return this.data[w*this.width+y]},g.prototype.set=function(y,w,R){this.data[w*this.width+y]=R},g})();function p(g,y,w,R){if(g.length!==y*w*4)throw new Error("Malformed data passed to binarizer.");for(var I=new f(y,w),k=0;k<y;k++)for(var je=0;je<w;je++){var Ve=g[(je*y+k)*4+0],q=g[(je*y+k)*4+1],$e=g[(je*y+k)*4+2];I.set(k,je,.2126*Ve+.7152*q+.0722*$e)}for(var We=Math.ceil(y/l),K=Math.ceil(w/l),W=new f(We,K),Ye=0;Ye<K;Ye++)for(var Qe=0;Qe<We;Qe++){for(var it=0,ze=1/0,v=0,je=0;je<l;je++)for(var k=0;k<l;k++){var D=I.get(Qe*l+k,Ye*l+je);it+=D,ze=Math.min(ze,D),v=Math.max(v,D)}var _e=it/Math.pow(l,2);if(v-ze<=u&&(_e=ze/2,Ye>0&&Qe>0)){var P=(W.get(Qe,Ye-1)+2*W.get(Qe-1,Ye)+W.get(Qe-1,Ye-1))/4;ze<P&&(_e=P)}W.set(Qe,Ye,_e)}var Re=a.BitMatrix.createEmpty(y,w),Fe=null;R&&(Fe=a.BitMatrix.createEmpty(y,w));for(var Ye=0;Ye<K;Ye++)for(var Qe=0;Qe<We;Qe++){for(var Le=x(Qe,2,We-3),Ce=x(Ye,2,K-3),it=0,L=-2;L<=2;L++)for(var O=-2;O<=2;O++)it+=W.get(Le+L,Ce+O);for(var st=it/25,L=0;L<l;L++)for(var O=0;O<l;O++){var k=Qe*l+L,je=Ye*l+O,lt=I.get(k,je);Re.set(k,je,lt<=st),R&&Fe.set(k,je,!(lt<=st))}}return R?{binarized:Re,inverted:Fe}:{binarized:Re}}n.binarize=p}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(0),l=s(6),u=s(9),x=s(10);function f($e,We){for(var K=$e^We,W=0;K;)W++,K&=K-1;return W}function p($e,We){return We<<1|$e}var g=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,dataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,formatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,dataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],y=[function($e){return($e.y+$e.x)%2===0},function($e){return $e.y%2===0},function($e){return $e.x%3===0},function($e){return($e.y+$e.x)%3===0},function($e){return(Math.floor($e.y/2)+Math.floor($e.x/3))%2===0},function($e){return $e.x*$e.y%2+$e.x*$e.y%3===0},function($e){return($e.y*$e.x%2+$e.y*$e.x%3)%2===0},function($e){return(($e.y+$e.x)%2+$e.y*$e.x%3)%2===0}];function w($e){var We=17+4*$e.versionNumber,K=a.BitMatrix.createEmpty(We,We);K.setRegion(0,0,9,9,!0),K.setRegion(We-8,0,8,9,!0),K.setRegion(0,We-8,9,8,!0);for(var W=0,Ye=$e.alignmentPatternCenters;W<Ye.length;W++)for(var Qe=Ye[W],it=0,ze=$e.alignmentPatternCenters;it<ze.length;it++){var v=ze[it];Qe===6&&v===6||Qe===6&&v===We-7||Qe===We-7&&v===6||K.setRegion(Qe-2,v-2,5,5,!0)}return K.setRegion(6,9,1,We-17,!0),K.setRegion(9,6,We-17,1,!0),$e.versionNumber>6&&(K.setRegion(We-11,0,3,6,!0),K.setRegion(0,We-11,6,3,!0)),K}function R($e,We,K){for(var W=y[K.dataMask],Ye=$e.height,Qe=w(We),it=[],ze=0,v=0,D=!0,_e=Ye-1;_e>0;_e-=2){_e===6&&_e--;for(var P=0;P<Ye;P++)for(var Re=D?Ye-1-P:P,Fe=0;Fe<2;Fe++){var Le=_e-Fe;if(!Qe.get(Le,Re)){v++;var Ce=$e.get(Le,Re);W({y:Re,x:Le})&&(Ce=!Ce),ze=p(Ce,ze),v===8&&(it.push(ze),v=0,ze=0)}}D=!D}return it}function I($e){var We=$e.height,K=Math.floor((We-17)/4);if(K<=6)return x.VERSIONS[K-1];for(var W=0,Ye=5;Ye>=0;Ye--)for(var Qe=We-9;Qe>=We-11;Qe--)W=p($e.get(Qe,Ye),W);for(var it=0,Qe=5;Qe>=0;Qe--)for(var Ye=We-9;Ye>=We-11;Ye--)it=p($e.get(Qe,Ye),it);for(var ze=1/0,v,D=0,_e=x.VERSIONS;D<_e.length;D++){var P=_e[D];if(P.infoBits===W||P.infoBits===it)return P;var Re=f(W,P.infoBits);Re<ze&&(v=P,ze=Re),Re=f(it,P.infoBits),Re<ze&&(v=P,ze=Re)}if(ze<=3)return v}function k($e){for(var We=0,K=0;K<=8;K++)K!==6&&(We=p($e.get(K,8),We));for(var W=7;W>=0;W--)W!==6&&(We=p($e.get(8,W),We));for(var Ye=$e.height,Qe=0,W=Ye-1;W>=Ye-7;W--)Qe=p($e.get(8,W),Qe);for(var K=Ye-8;K<Ye;K++)Qe=p($e.get(K,8),Qe);for(var it=1/0,ze=null,v=0,D=g;v<D.length;v++){var _e=D[v],P=_e.bits,Re=_e.formatInfo;if(P===We||P===Qe)return Re;var Fe=f(We,P);Fe<it&&(ze=Re,it=Fe),We!==Qe&&(Fe=f(Qe,P),Fe<it&&(ze=Re,it=Fe))}return it<=3?ze:null}function je($e,We,K){var W=We.errorCorrectionLevels[K],Ye=[],Qe=0;if(W.ecBlocks.forEach(function(Ce){for(var L=0;L<Ce.numBlocks;L++)Ye.push({numDataCodewords:Ce.dataCodewordsPerBlock,codewords:[]}),Qe+=Ce.dataCodewordsPerBlock+W.ecCodewordsPerBlock}),$e.length<Qe)return null;$e=$e.slice(0,Qe);for(var it=W.ecBlocks[0].dataCodewordsPerBlock,ze=0;ze<it;ze++)for(var v=0,D=Ye;v<D.length;v++){var _e=D[v];_e.codewords.push($e.shift())}if(W.ecBlocks.length>1)for(var P=W.ecBlocks[0].numBlocks,Re=W.ecBlocks[1].numBlocks,ze=0;ze<Re;ze++)Ye[P+ze].codewords.push($e.shift());for(;$e.length>0;)for(var Fe=0,Le=Ye;Fe<Le.length;Fe++){var _e=Le[Fe];_e.codewords.push($e.shift())}return Ye}function Ve($e){var We=I($e);if(!We)return null;var K=k($e);if(!K)return null;var W=R($e,We,K),Ye=je(W,We,K.errorCorrectionLevel);if(!Ye)return null;for(var Qe=Ye.reduce(function(Fe,Le){return Fe+Le.numDataCodewords},0),it=new Uint8ClampedArray(Qe),ze=0,v=0,D=Ye;v<D.length;v++){var _e=D[v],P=u.decode(_e.codewords,_e.codewords.length-_e.numDataCodewords);if(!P)return null;for(var Re=0;Re<_e.numDataCodewords;Re++)it[ze++]=P[Re]}try{return l.decode(it,We.versionNumber)}catch{return null}}function q($e){if($e==null)return null;var We=Ve($e);if(We)return We;for(var K=0;K<$e.width;K++)for(var W=K+1;W<$e.height;W++)$e.get(K,W)!==$e.get(W,K)&&($e.set(K,W,!$e.get(K,W)),$e.set(W,K,!$e.get(W,K)));return Ve($e)}n.decode=q}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(7),l=s(8),u;(function(I){I.Numeric="numeric",I.Alphanumeric="alphanumeric",I.Byte="byte",I.Kanji="kanji",I.ECI="eci"})(u=n.Mode||(n.Mode={}));var x;(function(I){I[I.Terminator=0]="Terminator",I[I.Numeric=1]="Numeric",I[I.Alphanumeric=2]="Alphanumeric",I[I.Byte=4]="Byte",I[I.Kanji=8]="Kanji",I[I.ECI=7]="ECI"})(x||(x={}));function f(I,k){for(var je=[],Ve="",q=[10,12,14][k],$e=I.readBits(q);$e>=3;){var We=I.readBits(10);if(We>=1e3)throw new Error("Invalid numeric value above 999");var K=Math.floor(We/100),W=Math.floor(We/10)%10,Ye=We%10;je.push(48+K,48+W,48+Ye),Ve+=K.toString()+W.toString()+Ye.toString(),$e-=3}if($e===2){var We=I.readBits(7);if(We>=100)throw new Error("Invalid numeric value above 99");var K=Math.floor(We/10),W=We%10;je.push(48+K,48+W),Ve+=K.toString()+W.toString()}else if($e===1){var We=I.readBits(4);if(We>=10)throw new Error("Invalid numeric value above 9");je.push(48+We),Ve+=We.toString()}return{bytes:je,text:Ve}}var p=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function g(I,k){for(var je=[],Ve="",q=[9,11,13][k],$e=I.readBits(q);$e>=2;){var We=I.readBits(11),K=Math.floor(We/45),W=We%45;je.push(p[K].charCodeAt(0),p[W].charCodeAt(0)),Ve+=p[K]+p[W],$e-=2}if($e===1){var K=I.readBits(6);je.push(p[K].charCodeAt(0)),Ve+=p[K]}return{bytes:je,text:Ve}}function y(I,k){for(var je=[],Ve="",q=[8,16,16][k],$e=I.readBits(q),We=0;We<$e;We++){var K=I.readBits(8);je.push(K)}try{Ve+=decodeURIComponent(je.map(function(W){return"%"+("0"+W.toString(16)).substr(-2)}).join(""))}catch{}return{bytes:je,text:Ve}}function w(I,k){for(var je=[],Ve="",q=[8,10,12][k],$e=I.readBits(q),We=0;We<$e;We++){var K=I.readBits(13),W=Math.floor(K/192)<<8|K%192;W<7936?W+=33088:W+=49472,je.push(W>>8,W&255),Ve+=String.fromCharCode(l.shiftJISTable[W])}return{bytes:je,text:Ve}}function R(I,k){for(var je,Ve,q,$e,We=new a.BitStream(I),K=k<=9?0:k<=26?1:2,W={text:"",bytes:[],chunks:[],version:k};We.available()>=4;){var Ye=We.readBits(4);if(Ye===x.Terminator)return W;if(Ye===x.ECI)We.readBits(1)===0?W.chunks.push({type:u.ECI,assignmentNumber:We.readBits(7)}):We.readBits(1)===0?W.chunks.push({type:u.ECI,assignmentNumber:We.readBits(14)}):We.readBits(1)===0?W.chunks.push({type:u.ECI,assignmentNumber:We.readBits(21)}):W.chunks.push({type:u.ECI,assignmentNumber:-1});else if(Ye===x.Numeric){var Qe=f(We,K);W.text+=Qe.text,(je=W.bytes).push.apply(je,Qe.bytes),W.chunks.push({type:u.Numeric,text:Qe.text})}else if(Ye===x.Alphanumeric){var it=g(We,K);W.text+=it.text,(Ve=W.bytes).push.apply(Ve,it.bytes),W.chunks.push({type:u.Alphanumeric,text:it.text})}else if(Ye===x.Byte){var ze=y(We,K);W.text+=ze.text,(q=W.bytes).push.apply(q,ze.bytes),W.chunks.push({type:u.Byte,bytes:ze.bytes,text:ze.text})}else if(Ye===x.Kanji){var v=w(We,K);W.text+=v.text,($e=W.bytes).push.apply($e,v.bytes),W.chunks.push({type:u.Kanji,bytes:v.bytes,text:v.text})}}if(We.available()===0||We.readBits(We.available())===0)return W}n.decode=R}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function l(u){this.byteOffset=0,this.bitOffset=0,this.bytes=u}return l.prototype.readBits=function(u){if(u<1||u>32||u>this.available())throw new Error("Cannot read "+u.toString()+" bits");var x=0;if(this.bitOffset>0){var f=8-this.bitOffset,p=u<f?u:f,g=f-p,y=255>>8-p<<g;x=(this.bytes[this.byteOffset]&y)>>g,u-=p,this.bitOffset+=p,this.bitOffset===8&&(this.bitOffset=0,this.byteOffset++)}if(u>0){for(;u>=8;)x=x<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,u-=8;if(u>0){var g=8-u,y=255>>g<<g;x=x<<u|(this.bytes[this.byteOffset]&y)>>g,this.bitOffset+=u}}return x},l.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},l})();n.BitStream=a}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.shiftJISTable={32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:165,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:8254,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:92,33120:12316,33121:8214,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:8722,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:162,33170:163,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:172,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081}}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(1),l=s(2);function u(g,y,w,R){var I;y.degree()<w.degree()&&(I=[w,y],y=I[0],w=I[1]);for(var k=y,je=w,Ve=g.zero,q=g.one;je.degree()>=R/2;){var $e=k,We=Ve;if(k=je,Ve=q,k.isZero())return null;je=$e;for(var K=g.zero,W=k.getCoefficient(k.degree()),Ye=g.inverse(W);je.degree()>=k.degree()&&!je.isZero();){var Qe=je.degree()-k.degree(),it=g.multiply(je.getCoefficient(je.degree()),Ye);K=K.addOrSubtract(g.buildMonomial(Qe,it)),je=je.addOrSubtract(k.multiplyByMonomial(Qe,it))}if(q=K.multiplyPoly(Ve).addOrSubtract(We),je.degree()>=k.degree())return null}var ze=q.getCoefficient(0);if(ze===0)return null;var v=g.inverse(ze);return[q.multiply(v),je.multiply(v)]}function x(g,y){var w=y.degree();if(w===1)return[y.getCoefficient(1)];for(var R=new Array(w),I=0,k=1;k<g.size&&I<w;k++)y.evaluateAt(k)===0&&(R[I]=g.inverse(k),I++);return I!==w?null:R}function f(g,y,w){for(var R=w.length,I=new Array(R),k=0;k<R;k++){for(var je=g.inverse(w[k]),Ve=1,q=0;q<R;q++)k!==q&&(Ve=g.multiply(Ve,a.addOrSubtractGF(1,g.multiply(w[q],je))));I[k]=g.multiply(y.evaluateAt(je),g.inverse(Ve)),g.generatorBase!==0&&(I[k]=g.multiply(I[k],je))}return I}function p(g,y){var w=new Uint8ClampedArray(g.length);w.set(g);for(var R=new a.default(285,256,0),I=new l.default(R,w),k=new Uint8ClampedArray(y),je=!1,Ve=0;Ve<y;Ve++){var q=I.evaluateAt(R.exp(Ve+R.generatorBase));k[k.length-1-Ve]=q,q!==0&&(je=!0)}if(!je)return w;var $e=new l.default(R,k),We=u(R,R.buildMonomial(y,1),$e,y);if(We===null)return null;var K=x(R,We[0]);if(K==null)return null;for(var W=f(R,We[1],K),Ye=0;Ye<K.length;Ye++){var Qe=w.length-1-R.log(K[Ye]);if(Qe<0)return null;w[Qe]=a.addOrSubtractGF(w[Qe],W[Ye])}return w}n.decode=p}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.VERSIONS=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,versionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,dataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,versionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},{numBlocks:61,dataCodewordsPerBlock:16}]}]}]}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=s(0);function l(p,g,y,w){var R=p.x-g.x+y.x-w.x,I=p.y-g.y+y.y-w.y;if(R===0&&I===0)return{a11:g.x-p.x,a12:g.y-p.y,a13:0,a21:y.x-g.x,a22:y.y-g.y,a23:0,a31:p.x,a32:p.y,a33:1};var k=g.x-y.x,je=w.x-y.x,Ve=g.y-y.y,q=w.y-y.y,$e=k*q-je*Ve,We=(R*q-je*I)/$e,K=(k*I-R*Ve)/$e;return{a11:g.x-p.x+We*g.x,a12:g.y-p.y+We*g.y,a13:We,a21:w.x-p.x+K*w.x,a22:w.y-p.y+K*w.y,a23:K,a31:p.x,a32:p.y,a33:1}}function u(p,g,y,w){var R=l(p,g,y,w);return{a11:R.a22*R.a33-R.a23*R.a32,a12:R.a13*R.a32-R.a12*R.a33,a13:R.a12*R.a23-R.a13*R.a22,a21:R.a23*R.a31-R.a21*R.a33,a22:R.a11*R.a33-R.a13*R.a31,a23:R.a13*R.a21-R.a11*R.a23,a31:R.a21*R.a32-R.a22*R.a31,a32:R.a12*R.a31-R.a11*R.a32,a33:R.a11*R.a22-R.a12*R.a21}}function x(p,g){return{a11:p.a11*g.a11+p.a21*g.a12+p.a31*g.a13,a12:p.a12*g.a11+p.a22*g.a12+p.a32*g.a13,a13:p.a13*g.a11+p.a23*g.a12+p.a33*g.a13,a21:p.a11*g.a21+p.a21*g.a22+p.a31*g.a23,a22:p.a12*g.a21+p.a22*g.a22+p.a32*g.a23,a23:p.a13*g.a21+p.a23*g.a22+p.a33*g.a23,a31:p.a11*g.a31+p.a21*g.a32+p.a31*g.a33,a32:p.a12*g.a31+p.a22*g.a32+p.a32*g.a33,a33:p.a13*g.a31+p.a23*g.a32+p.a33*g.a33}}function f(p,g){for(var y=u({x:3.5,y:3.5},{x:g.dimension-3.5,y:3.5},{x:g.dimension-6.5,y:g.dimension-6.5},{x:3.5,y:g.dimension-3.5}),w=l(g.topLeft,g.topRight,g.alignmentPattern,g.bottomLeft),R=x(w,y),I=a.BitMatrix.createEmpty(g.dimension,g.dimension),k=function(K,W){var Ye=R.a13*K+R.a23*W+R.a33;return{x:(R.a11*K+R.a21*W+R.a31)/Ye,y:(R.a12*K+R.a22*W+R.a32)/Ye}},je=0;je<g.dimension;je++)for(var Ve=0;Ve<g.dimension;Ve++){var q=Ve+.5,$e=je+.5,We=k(q,$e);I.set(Ve,je,p.get(Math.floor(We.x),Math.floor(We.y)))}return{matrix:I,mappingFunction:k}}n.extract=f}),(function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var a=4,l=.5,u=1.5,x=function(q,$e){return Math.sqrt(Math.pow($e.x-q.x,2)+Math.pow($e.y-q.y,2))};function f(q){return q.reduce(function($e,We){return $e+We})}function p(q,$e,We){var K,W,Ye,Qe,it=x(q,$e),ze=x($e,We),v=x(q,We),D,_e,P;return ze>=it&&ze>=v?(K=[$e,q,We],D=K[0],_e=K[1],P=K[2]):v>=ze&&v>=it?(W=[q,$e,We],D=W[0],_e=W[1],P=W[2]):(Ye=[q,We,$e],D=Ye[0],_e=Ye[1],P=Ye[2]),(P.x-_e.x)*(D.y-_e.y)-(P.y-_e.y)*(D.x-_e.x)<0&&(Qe=[P,D],D=Qe[0],P=Qe[1]),{bottomLeft:D,topLeft:_e,topRight:P}}function g(q,$e,We,K){var W=(f(w(q,We,K,5))/7+f(w(q,$e,K,5))/7+f(w(We,q,K,5))/7+f(w($e,q,K,5))/7)/4;if(W<1)throw new Error("Invalid module size");var Ye=Math.round(x(q,$e)/W),Qe=Math.round(x(q,We)/W),it=Math.floor((Ye+Qe)/2)+7;switch(it%4){case 0:it++;break;case 2:it--;break}return{dimension:it,moduleSize:W}}function y(q,$e,We,K){var W=[{x:Math.floor(q.x),y:Math.floor(q.y)}],Ye=Math.abs($e.y-q.y)>Math.abs($e.x-q.x),Qe,it,ze,v;Ye?(Qe=Math.floor(q.y),it=Math.floor(q.x),ze=Math.floor($e.y),v=Math.floor($e.x)):(Qe=Math.floor(q.x),it=Math.floor(q.y),ze=Math.floor($e.x),v=Math.floor($e.y));for(var D=Math.abs(ze-Qe),_e=Math.abs(v-it),P=Math.floor(-D/2),Re=Qe<ze?1:-1,Fe=it<v?1:-1,Le=!0,Ce=Qe,L=it;Ce!==ze+Re;Ce+=Re){var O=Ye?L:Ce,st=Ye?Ce:L;if(We.get(O,st)!==Le&&(Le=!Le,W.push({x:O,y:st}),W.length===K+1))break;if(P+=_e,P>0){if(L===v)break;L+=Fe,P-=D}}for(var lt=[],Xe=0;Xe<K;Xe++)W[Xe]&&W[Xe+1]?lt.push(x(W[Xe],W[Xe+1])):lt.push(0);return lt}function w(q,$e,We,K){var W,Ye=$e.y-q.y,Qe=$e.x-q.x,it=y(q,$e,We,Math.ceil(K/2)),ze=y(q,{x:q.x-Qe,y:q.y-Ye},We,Math.ceil(K/2)),v=it.shift()+ze.shift()-1;return(W=ze.concat(v)).concat.apply(W,it)}function R(q,$e){var We=f(q)/f($e),K=0;return $e.forEach(function(W,Ye){K+=Math.pow(q[Ye]-W*We,2)}),{averageSize:We,error:K}}function I(q,$e,We){try{var K=w(q,{x:-1,y:q.y},We,$e.length),W=w(q,{x:q.x,y:-1},We,$e.length),Ye={x:Math.max(0,q.x-q.y)-1,y:Math.max(0,q.y-q.x)-1},Qe=w(q,Ye,We,$e.length),it={x:Math.min(We.width,q.x+q.y)+1,y:Math.min(We.height,q.y+q.x)+1},ze=w(q,it,We,$e.length),v=R(K,$e),D=R(W,$e),_e=R(Qe,$e),P=R(ze,$e),Re=Math.sqrt(v.error*v.error+D.error*D.error+_e.error*_e.error+P.error*P.error),Fe=(v.averageSize+D.averageSize+_e.averageSize+P.averageSize)/4,Le=(Math.pow(v.averageSize-Fe,2)+Math.pow(D.averageSize-Fe,2)+Math.pow(_e.averageSize-Fe,2)+Math.pow(P.averageSize-Fe,2))/Fe;return Re+Le}catch{return 1/0}}function k(q,$e){for(var We=Math.round($e.x);q.get(We,Math.round($e.y));)We--;for(var K=Math.round($e.x);q.get(K,Math.round($e.y));)K++;for(var W=(We+K)/2,Ye=Math.round($e.y);q.get(Math.round(W),Ye);)Ye--;for(var Qe=Math.round($e.y);q.get(Math.round(W),Qe);)Qe++;var it=(Ye+Qe)/2;return{x:W,y:it}}function je(q){for(var $e=[],We=[],K=[],W=[],Ye=function(O){for(var st=0,lt=!1,Xe=[0,0,0,0,0],dt=function(ar){var dr=q.get(ar,O);if(dr===lt)st++;else{Xe=[Xe[1],Xe[2],Xe[3],Xe[4],st],st=1,lt=dr;var ir=f(Xe)/7,pt=Math.abs(Xe[0]-ir)<ir&&Math.abs(Xe[1]-ir)<ir&&Math.abs(Xe[2]-3*ir)<3*ir&&Math.abs(Xe[3]-ir)<ir&&Math.abs(Xe[4]-ir)<ir&&!dr,tr=f(Xe.slice(-3))/3,sr=Math.abs(Xe[2]-tr)<tr&&Math.abs(Xe[3]-tr)<tr&&Math.abs(Xe[4]-tr)<tr&&dr;if(pt){var nr=ar-Xe[3]-Xe[4],pr=nr-Xe[2],gr={startX:pr,endX:nr,y:O},mr=We.filter(function(xr){return pr>=xr.bottom.startX&&pr<=xr.bottom.endX||nr>=xr.bottom.startX&&pr<=xr.bottom.endX||pr<=xr.bottom.startX&&nr>=xr.bottom.endX&&Xe[2]/(xr.bottom.endX-xr.bottom.startX)<u&&Xe[2]/(xr.bottom.endX-xr.bottom.startX)>l});mr.length>0?mr[0].bottom=gr:We.push({top:gr,bottom:gr})}if(sr){var yr=ar-Xe[4],Er=yr-Xe[3],gr={startX:Er,y:O,endX:yr},mr=W.filter(function(wr){return Er>=wr.bottom.startX&&Er<=wr.bottom.endX||yr>=wr.bottom.startX&&Er<=wr.bottom.endX||Er<=wr.bottom.startX&&yr>=wr.bottom.endX&&Xe[2]/(wr.bottom.endX-wr.bottom.startX)<u&&Xe[2]/(wr.bottom.endX-wr.bottom.startX)>l});mr.length>0?mr[0].bottom=gr:W.push({top:gr,bottom:gr})}}},er=-1;er<=q.width;er++)dt(er);$e.push.apply($e,We.filter(function(ar){return ar.bottom.y!==O&&ar.bottom.y-ar.top.y>=2})),We=We.filter(function(ar){return ar.bottom.y===O}),K.push.apply(K,W.filter(function(ar){return ar.bottom.y!==O})),W=W.filter(function(ar){return ar.bottom.y===O})},Qe=0;Qe<=q.height;Qe++)Ye(Qe);$e.push.apply($e,We.filter(function(O){return O.bottom.y-O.top.y>=2})),K.push.apply(K,W);var it=$e.filter(function(O){return O.bottom.y-O.top.y>=2}).map(function(O){var st=(O.top.startX+O.top.endX+O.bottom.startX+O.bottom.endX)/4,lt=(O.top.y+O.bottom.y+1)/2;if(q.get(Math.round(st),Math.round(lt))){var Xe=[O.top.endX-O.top.startX,O.bottom.endX-O.bottom.startX,O.bottom.y-O.top.y+1],dt=f(Xe)/Xe.length,er=I({x:Math.round(st),y:Math.round(lt)},[1,1,3,1,1],q);return{score:er,x:st,y:lt,size:dt}}}).filter(function(O){return!!O}).sort(function(O,st){return O.score-st.score}).map(function(O,st,lt){if(st>a)return null;var Xe=lt.filter(function(er,ar){return st!==ar}).map(function(er){return{x:er.x,y:er.y,score:er.score+Math.pow(er.size-O.size,2)/O.size,size:er.size}}).sort(function(er,ar){return er.score-ar.score});if(Xe.length<2)return null;var dt=O.score+Xe[0].score+Xe[1].score;return{points:[O].concat(Xe.slice(0,2)),score:dt}}).filter(function(O){return!!O}).sort(function(O,st){return O.score-st.score});if(it.length===0)return null;var ze=p(it[0].points[0],it[0].points[1],it[0].points[2]),v=ze.topRight,D=ze.topLeft,_e=ze.bottomLeft,P=Ve(q,K,v,D,_e),Re=[];P&&Re.push({alignmentPattern:{x:P.alignmentPattern.x,y:P.alignmentPattern.y},bottomLeft:{x:_e.x,y:_e.y},dimension:P.dimension,topLeft:{x:D.x,y:D.y},topRight:{x:v.x,y:v.y}});var Fe=k(q,v),Le=k(q,D),Ce=k(q,_e),L=Ve(q,K,Fe,Le,Ce);return L&&Re.push({alignmentPattern:{x:L.alignmentPattern.x,y:L.alignmentPattern.y},bottomLeft:{x:Ce.x,y:Ce.y},topLeft:{x:Le.x,y:Le.y},topRight:{x:Fe.x,y:Fe.y},dimension:L.dimension}),Re.length===0?null:Re}n.locate=je;function Ve(q,$e,We,K,W){var Ye,Qe,it;try{Ye=g(K,We,W,q),Qe=Ye.dimension,it=Ye.moduleSize}catch{return null}var ze={x:We.x-K.x+W.x,y:We.y-K.y+W.y},v=(x(K,W)+x(K,We))/2/it,D=1-3/v,_e={x:K.x+D*(ze.x-K.x),y:K.y+D*(ze.y-K.y)},P=$e.map(function(Fe){var Le=(Fe.top.startX+Fe.top.endX+Fe.bottom.startX+Fe.bottom.endX)/4,Ce=(Fe.top.y+Fe.bottom.y+1)/2;if(q.get(Math.floor(Le),Math.floor(Ce))){var L=[Fe.top.endX-Fe.top.startX,Fe.bottom.endX-Fe.bottom.startX,Fe.bottom.y-Fe.top.y+1];f(L)/L.length;var O=I({x:Math.floor(Le),y:Math.floor(Ce)},[1,1,1],q),st=O+x({x:Le,y:Ce},_e);return{x:Le,y:Ce,score:st}}}).filter(function(Fe){return!!Fe}).sort(function(Fe,Le){return Fe.score-Le.score}),Re=v>=15&&P.length?P[0]:_e;return{alignmentPattern:Re,dimension:Qe}}})]).default})})(jsQR$2)),jsQR$2.exports}var jsQRExports=requireJsQR();const jsQR=getDefaultExportFromCjs$1(jsQRExports),ConnectSigner=({onBroadcastSuccess:e,bunkerURI:t})=>{const{decryptedKey:r}=useAuthStore(),{addConnection:n,removeConnection:s}=useConnectionsStore(),{currentKeypairId:a}=useWalletStore(),[l,u]=reactExports.useState(""),[x,f]=reactExports.useState(null),[p,g]=reactExports.useState(!1),[y,w]=reactExports.useState(null),[R,I]=reactExports.useState(null),[k,je]=reactExports.useState(!1),[Ve,q]=reactExports.useState(""),[$e,We]=reactExports.useState(!0),[K,W]=reactExports.useState(!1),Ye=reactExports.useRef(null),Qe=reactExports.useRef(null),[it,ze]=reactExports.useState(""),[v,D]=reactExports.useState(null),[_e,P]=reactExports.useState("nostrconnect"),[Re,Fe]=reactExports.useState(!1),[Le,Ce]=reactExports.useState(!1),[L,O]=reactExports.useState(null),[st,lt]=reactExports.useState(null),Xe=reactExports.useRef(null),dt=async gr=>{if(!r){f("Please unlock your vault first");return}if(!a){f("No active address selected");return}f(null),g(!0);try{const mr=gr||l,yr=ClientService.parseNostrConnectURI(mr);console.log("Parsed URI:",yr);const xr=useConnectionsStore.getState().connections.find(Cr=>Cr.keypairId!==a?!1:!!(Cr.appUrl&&yr.appUrl&&Cr.appUrl===yr.appUrl||!Cr.appUrl&&!yr.appUrl&&Cr.name&&yr.name&&Cr.name===yr.name));if(xr){g(!1),q(mr),I({connectionId:xr.id,name:xr.name||xr.appUrl||"Unknown App"});return}g(!1),w({uri:mr,name:yr.name||"Unknown App",pubkey:yr.signerPubkey,appUrl:yr.appUrl})}catch(mr){g(!1),f(mr.message)}},er=()=>{if(y)try{const gr=ClientService.parseNostrConnectURI(y.uri),mr=Math.random().toString(36).substring(7),yr={id:mr,keypairId:a,signerPubkey:gr.signerPubkey,relays:gr.relays,secret:gr.secret,name:gr.name,appUrl:gr.appUrl,status:"connecting",startedVia:"nostrconnect",connectedAt:Date.now()};n(yr),y.rulesToCopy&&y.rulesToCopy.length>0&&(console.log("[ConnectSigner] Copying",y.rulesToCopy.length,"rules to new connection"),y.rulesToCopy.forEach(Er=>{useConnectionsStore.getState().addRule({...Er,id:Math.random().toString(36).substring(7),connectionId:mr,createdAt:Date.now()})}),console.log("[ConnectSigner]  Rules copied successfully")),u(""),w(null)}catch(gr){f(gr.message)}},ar=async()=>{if(!st)return;const gr=useRelayStore.getState().relays.map(yr=>yr.url);if(gr.length===0)throw new Error("No relays connected");const mr=new NDK({explicitRelayUrls:gr});try{await Promise.race([mr.connect(),new Promise((yr,Er)=>setTimeout(()=>Er(new Error("Broadcast connection timed out")),5e3))])}catch(yr){console.warn("Broadcast connection timed out/failed, checking for partial connections...",yr);let Er=0;if(mr.pool.relays.forEach(xr=>{(xr.status===1||xr.status===5)&&Er++}),Er===0)throw console.error("No relays connected for broadcast"),yr;console.log(`Proceeding with broadcast via ${Er} relays`)}try{const yr=new NDKEvent(mr,st);await yr.publish(),console.log("Published event:",yr.id)}catch(yr){throw console.error("Broadcast failed:",yr),yr}},dr=async()=>{if(R){je(!0);try{const gr=$e?useConnectionsStore.getState().getRulesForConnection(R.connectionId):[];console.log("[ConnectSigner] Replacing connection, preserve rules:",$e,"Old rules count:",gr.length),s(R.connectionId),await new Promise(Er=>setTimeout(Er,100));const mr=Ve||l,yr=ClientService.parseNostrConnectURI(mr);I(null),q(""),w({uri:mr,name:yr.name||"Unknown App",pubkey:yr.signerPubkey,appUrl:yr.appUrl,rulesToCopy:gr})}finally{je(!1),We(!0)}}},ir=gr=>{gr.sig?(console.log("[Offline] Signed Event detected, showing broadcast modal"),lt(gr)):(console.log("[Offline] Unsigned Event detected, showing offline signer"),O(gr)),W(!1)},pt=async gr=>{const mr=gr.target.files?.[0];if(!mr){console.log("[QR Upload] No file selected"),ze("No file selected");return}if(mr.type==="application/json"||mr.name.endsWith(".json")){console.log("[Offline] JSON file detected:",mr.name);const yr=new FileReader;yr.onload=Er=>{try{const xr=Er.target?.result,Cr=JSON.parse(xr);Cr.kind!==void 0&&Cr.content!==void 0?(console.log("[Offline] JSON Event Found via file:",Cr),ir(Cr),W(!1)):f("File is valid JSON but not a Nostr event")}catch{f("Invalid JSON file")}},yr.readAsText(mr);return}console.log("[QR Upload] File selected:",mr.name,mr.type),f(null),ze(`File selected: ${mr.name} (${(mr.size/1024).toFixed(1)}KB)`);try{const yr=new Image,Er=new FileReader;Er.onload=xr=>{if(xr.target?.result){console.log("[QR Upload] File loaded, setting image source"),ze("File loaded, processing image...");const Cr=xr.target.result;yr.src=Cr,D(Cr)}},Er.onerror=()=>{console.error("[QR Upload] FileReader error"),f("Failed to read image file"),ze("ERROR: Failed to read file")},yr.onload=async()=>{console.log("[QR Upload] Image loaded, dimensions:",yr.width,"x",yr.height),ze(`Image loaded: ${yr.width}x${yr.height}px`);const xr=document.createElement("canvas"),Cr=xr.getContext("2d",{willReadFrequently:!0});if(!Cr){f("Canvas not supported"),ze("ERROR: Canvas not supported");return}const wr=(Dr,rr,cr=!1)=>{xr.width=Dr,xr.height=rr,Cr.drawImage(yr,0,0,Dr,rr);const Br=Cr.getImageData(0,0,Dr,rr),br=jsQR(Br.data,Dr,rr,{inversionAttempts:cr?"invertFirst":"dontInvert"});return br?br.data:null};let kr=wr(yr.width,yr.height);if(!kr&&(yr.width>800||yr.height>800)){const Dr=800/Math.max(yr.width,yr.height);console.log("[QR Upload] Retrying with scale:",Dr),kr=wr(Math.floor(yr.width*Dr),Math.floor(yr.height*Dr))}if(kr||(console.log("[QR Upload] Retrying with inversion"),kr=wr(yr.width,yr.height,!0)),kr)if(console.log("[QR Upload] QR code found:",kr),ze(`QR code found! Data: ${kr.substring(0,50)}...`),kr.startsWith("nostrconnect://")||kr.startsWith("bunker://"))u(kr),W(!1),await dt(kr);else if(kr.toLowerCase().startsWith("ur:"))try{if(Xe.current||(Xe.current=new distExports$3.URDecoder),Xe.current.receivePart(kr),Xe.current.isComplete()){const rr=Xe.current.resultUR().decodeCBOR();let cr;Buffer$1.isBuffer(rr)?cr=JSON.parse(rr.toString("utf8")):cr=rr,console.log("[Offline] UR Decode Complete:",cr),ir(cr),W(!1),Xe.current=null}else ze(`Scanning... ${Math.floor(Xe.current.estimatedPercentComplete()*100)}%`)}catch(Dr){console.error("[Offline] UR Decode Error:",Dr),ze("UR Error: "+Dr.message)}else if(kr.trim().startsWith("{"))try{const Dr=JSON.parse(kr);Dr.kind!==void 0&&Dr.content!==void 0?(console.log("[Offline] JSON Event Found:",Dr),ir(Dr),W(!1)):f("QR is JSON but not a valid Nostr event")}catch{f("Invalid QR format")}else f("QR code found but not a valid nostrconnect://, bunker://, or Event"),ze(`ERROR: Invalid URI format. Found: ${kr.substring(0,30)}...`),console.log("[QR Upload] Invalid format:",kr);else f("No QR code detected. Try cropping the image to just the QR code."),ze("ERROR: No QR code detected after multiple attempts"),console.log("[QR Upload] No QR code found")},yr.onerror=()=>{console.error("[QR Upload] Image load error"),f("Failed to load image"),ze("ERROR: Failed to load image")},Er.readAsDataURL(mr)}catch(yr){console.error("[QR Upload] Error:",yr);const Er="Failed to process image: "+yr.message;f(Er),ze("ERROR: "+Er)}},tr=async()=>{Xe.current=new distExports$3.URDecoder,W(!0),f(null)},sr=()=>{navigator.clipboard.writeText(t),Ce(!0),setTimeout(()=>Ce(!1),2e3)},nr=()=>{_e==="nostrconnect"?tr():Fe(!Re)};reactExports.useEffect(()=>{(K||y||R)&&window.history.pushState({modal:"connect-signer"},"");const mr=()=>{K&&W(!1),y&&w(null),R&&I(null)};return window.addEventListener("popstate",mr),()=>{window.removeEventListener("popstate",mr)}},[K,y,R]);const pr=(gr,mr)=>{if(!K){console.log("[Camera] Stopping scan loop"),mr.getTracks().forEach(Cr=>Cr.stop());return}const yr=document.createElement("canvas"),Er=yr.getContext("2d",{willReadFrequently:!0}),xr=async()=>{if(gr.readyState===gr.HAVE_ENOUGH_DATA&&Er){yr.height=gr.videoHeight,yr.width=gr.videoWidth,Er.drawImage(gr,0,0,yr.width,yr.height);const Cr=Er.getImageData(0,0,yr.width,yr.height),wr=jsQR(Cr.data,Cr.width,Cr.height,{inversionAttempts:"dontInvert"});if(wr){console.log("[Camera] QR Found:",wr.data);const kr=wr.data;if(kr.startsWith("nostrconnect://")||kr.startsWith("bunker://")){mr.getTracks().forEach(Dr=>Dr.stop()),W(!1),u(kr),await dt(kr);return}else if(kr.toLowerCase().startsWith("ur:"))try{if(Xe.current||(Xe.current=new distExports$3.URDecoder),Xe.current.receivePart(kr),Xe.current.isComplete()){const rr=Xe.current.resultUR().decodeCBOR();let cr;Buffer$1.isBuffer(rr)?cr=JSON.parse(rr.toString("utf8")):cr=rr,console.log("[Camera] UR Decode Complete:",cr),mr.getTracks().forEach(Br=>Br.stop()),W(!1),ir(cr),Xe.current=null;return}else ze(`Scanning... ${Math.floor(Xe.current.estimatedPercentComplete()*100)}%`)}catch(Dr){console.error("[Camera] UR Decode Error:",Dr);try{if(Xe.current=new distExports$3.URDecoder,Xe.current.receivePart(kr),Xe.current.isComplete()){const cr=Xe.current.resultUR().decodeCBOR();let Br;Buffer$1.isBuffer(cr)?Br=JSON.parse(cr.toString("utf8")):Br=cr,console.log("[Camera] UR Decode Complete (Recovery):",Br),mr.getTracks().forEach(br=>br.stop()),W(!1),ir(Br),Xe.current=null;return}ze("New QR Detected...")}catch(rr){console.error("[Camera] Retry failed:",rr),ze(`Frame Error: ${rr.message}`)}}else if(kr.trim().startsWith("{"))try{const Dr=JSON.parse(kr);if(Dr.kind!==void 0&&Dr.content!==void 0){console.log("[Camera] JSON Event Found:",Dr),mr.getTracks().forEach(rr=>rr.stop()),W(!1),ir(Dr);return}}catch{}}}document.getElementById("qr-modal")?requestAnimationFrame(xr):(console.log("[Camera] Modal closed, stopping tracks"),mr.getTracks().forEach(Cr=>Cr.stop()))};requestAnimationFrame(xr)};return reactExports.useEffect(()=>{let gr=null,mr=!0;return K&&(async()=>{if(K){console.log("[Camera] Starting camera initialization..."),ze("Requesting camera access...");try{const Er=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!mr){Er.getTracks().forEach(Cr=>Cr.stop());return}gr=Er,console.log("[Camera] Stream obtained:",Er.id,Er.active),ze("Camera access granted. Starting video...");const xr=Qe.current;if(xr){console.log("[Camera] Video element found"),xr.srcObject=Er,xr.setAttribute("playsinline","true"),xr.onloadedmetadata=()=>{console.log("[Camera] Video metadata loaded:",xr.videoWidth,"x",xr.videoHeight),ze(`Video ready: ${xr.videoWidth}x${xr.videoHeight}`)},xr.onplay=()=>{console.log("[Camera] Video playing")};try{await xr.play(),console.log("[Camera] Video play promise resolved"),pr(xr,Er)}catch(Cr){console.error("[Camera] Play failed:",Cr),ze("ERROR: Video play failed: "+Cr.message)}}else console.error("[Camera] Video element NOT found in ref"),ze("ERROR: Video element not found")}catch(Er){console.error("[Camera] Access failed:",Er),ze("ERROR: Camera access failed: "+Er.message)}}})(),()=>{mr=!1,gr&&(console.log("[Camera] Cleaning up stream"),gr.getTracks().forEach(Er=>Er.stop()))}},[K]),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:_e==="nostrconnect"?"NOSTRCONNECT:// URI":"BUNKER URI"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:_e==="nostrconnect"?"Paste a nostrconnect:// URI from an app to act as its remote signer":"Copy this bunker string to the nostr client you want to connect to"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>P(_e==="nostrconnect"?"bunker":"nostrconnect"),className:"flex-shrink-0 mt-1 p-2 hover:bg-slate-800 rounded-lg transition-colors",title:`Switch to ${_e==="nostrconnect"?"Bunker":"NostrConnect"} mode`,children:jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:"text",value:_e==="nostrconnect"?l:t,onChange:_e==="nostrconnect"?gr=>u(gr.target.value):void 0,readOnly:_e==="bunker",placeholder:_e==="nostrconnect"?"nostrconnect://...":"",className:`w-full bg-slate-950 border border-slate-800 rounded-lg ${_e==="bunker"?"pl-4 pr-20":"px-4"} py-3 text-white ${_e==="nostrconnect"?"focus:ring-2 focus:ring-amber-500 focus:border-transparent":""} outline-none transition-all font-mono text-sm ${_e==="bunker"?"text-slate-300":""}`}),_e==="bunker"&&jsxRuntimeExports.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:nr,className:`p-2 rounded-md transition-colors ${Re?"bg-amber-500/20 text-amber-500":"hover:bg-slate-800 text-slate-400"}`,title:"Show QR Code",children:jsxRuntimeExports.jsx(QrCode,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:sr,className:"p-2 hover:bg-slate-800 rounded-md transition-colors",title:"Copy URI",children:Le?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4 text-green-400"}):jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),Re&&_e==="bunker"&&jsxRuntimeExports.jsx("div",{className:"flex justify-center p-4 bg-white rounded-xl",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:t,size:256})}),x&&jsxRuntimeExports.jsx("div",{className:"text-red-400 text-sm bg-red-400/10 p-3 rounded-lg",children:x}),_e==="nostrconnect"&&jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>dt(),disabled:p||!l,className:"flex-1 bg-slate-800 hover:bg-slate-700 text-slate-200 font-bold py-3 px-4 rounded-xl border border-slate-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-5 h-5 animate-spin"}),"Connecting..."]}):"Connect"}),jsxRuntimeExports.jsx("button",{onClick:nr,disabled:p,className:"bg-amber-500 hover:bg-amber-400 text-slate-950 py-3 px-4 rounded-xl transition-colors shadow-lg disabled:opacity-50",title:"Scan QR & Connect",children:jsxRuntimeExports.jsx(QrCode,{className:"w-6 h-6"})})]})]}),y&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-amber-500/10 rounded-full",children:jsxRuntimeExports.jsx(QrCode,{className:"w-6 h-6 text-amber-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Approve Connection"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Do you want to connect to this app?"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 mb-6 border border-slate-800 space-y-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"App Name"}),jsxRuntimeExports.jsx("p",{className:"text-white font-medium",children:y.name})]}),y.appUrl&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Website"}),jsxRuntimeExports.jsx("p",{className:"text-amber-400 truncate",children:y.appUrl})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"App Pubkey"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 font-mono text-xs break-all",children:y.pubkey})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>window.history.back(),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsxs("button",{onClick:er,className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),"Connect"]})]})]})}),R&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Replace Existing Connection?"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-4",children:["You already have a connection to ",jsxRuntimeExports.jsx("span",{className:"text-amber-400 font-semibold",children:R.name}),". Do you want to replace it with this new connection?"]}),jsxRuntimeExports.jsx("div",{className:"mb-6",children:jsxRuntimeExports.jsx("button",{onClick:()=>We(!$e),className:"w-full p-4 bg-slate-800/50 hover:bg-slate-800/70 rounded-lg border border-slate-700/50 transition-colors",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-4",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-300 text-left flex-1",children:"Keep existing auto-approval rules"}),jsxRuntimeExports.jsx("div",{className:`relative w-14 h-7 rounded-md transition-all duration-300 ${$e?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:jsxRuntimeExports.jsx("div",{className:`absolute top-0.5 left-0.5 w-6 h-6 bg-white rounded-md shadow-lg transition-all duration-300 flex items-center justify-center ${$e?"translate-x-7":"translate-x-0"}`,children:$e?jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]})})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>window.history.back(),disabled:k,className:"flex-1 bg-slate-800 hover:bg-slate-700 disabled:bg-slate-700 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:dr,disabled:k,className:"flex-1 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:k?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Replacing..."]}):"Replace"})]})]})}),K&&jsxRuntimeExports.jsx("div",{id:"qr-modal",className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-50 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 rounded-xl p-4 border border-slate-800 my-auto",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-4 text-center",children:"Scan QR Code"}),jsxRuntimeExports.jsxs("div",{className:"relative aspect-square bg-black rounded-lg overflow-hidden mb-4",children:[jsxRuntimeExports.jsx("video",{ref:Qe,id:"qr-video",className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 border-2 border-amber-500/50 rounded-lg pointer-events-none"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("p",{className:"text-center text-slate-400 text-sm",children:"Camera not working? Upload an image instead."}),it&&jsxRuntimeExports.jsx("div",{className:`p-3 rounded-lg text-sm font-mono break-all ${it.startsWith("ERROR")?"bg-red-500/10 text-red-400":"bg-blue-500/10 text-blue-400"}`,children:it}),v&&jsxRuntimeExports.jsxs("div",{className:"relative max-h-48 overflow-hidden rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Uploaded Image:"}),jsxRuntimeExports.jsx("img",{src:v,alt:"Uploaded QR",className:"w-full object-contain bg-black/50"})]}),jsxRuntimeExports.jsx("input",{type:"file",ref:Ye,onChange:pt,accept:"image/*,application/json,.json",capture:"environment",className:"hidden"}),jsxRuntimeExports.jsxs("button",{onClick:()=>Ye.current?.click(),className:"w-full bg-slate-800 hover:bg-slate-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5"}),"Upload QR Image / JSON File"]}),jsxRuntimeExports.jsx("button",{onClick:()=>window.history.back(),className:"w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 font-medium py-3 px-4 rounded-lg transition-colors",children:"Cancel"})]})]})}),L&&jsxRuntimeExports.jsx(OfflineSigner,{event:L,onClose:()=>O(null)}),st&&jsxRuntimeExports.jsx(BroadcastModal,{eventJson:st,onClose:()=>lt(null),onBroadcast:ar,onSuccess:e})]})};class ProfileService{static ndk=null;static connecting=null;static getNDK(){return this.ndk||(this.ndk=new NDK({explicitRelayUrls:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io","wss://purplepag.es","wss://relay.snort.social","wss://eden.nostr.land"]})),this.ndk}static async ensureConnection(){const t=this.getNDK();if(this.connecting)console.log("[ProfileService] Waiting for existing connection...");else{if(t.pool.connectedRelays().length>0){console.log("[ProfileService] Already connected to",t.pool.connectedRelays().length,"relays");return}console.log("[ProfileService] Initiating new NDK connection..."),this.connecting=t.connect().then(()=>{console.log("[ProfileService] NDK connection established"),this.connecting=null}).catch(n=>{console.warn("[ProfileService] Connection promise failed:",n),this.connecting=null})}const r=new Promise((n,s)=>setTimeout(()=>s(new Error("Connection timeout")),5e3));try{this.connecting&&await Promise.race([this.connecting,r]),console.log("[ProfileService] NDK ready for use")}catch{console.warn("[ProfileService] Connection timed out or failed, attempting to fetch anyway...")}}static async fetchProfile(t){try{console.log("[ProfileService] Starting fetchProfile for",t);const r=this.getNDK();await this.ensureConnection();const s=new NDKUser({npub:t}).pubkey;console.log("[ProfileService] Pubkey:",s),console.log("[ProfileService] Fetching Kind 0 events...");const a=r.fetchEvents({kinds:[0],authors:[s],limit:1}),l=new Promise((w,R)=>setTimeout(()=>R(new Error("Fetch timeout after 10 seconds")),1e4)),u=await Promise.race([a,l]);if(console.log("[ProfileService] Received",u.size,"events"),u.size===0)return console.log("[ProfileService] No Kind 0 event found for",t),null;const x=Array.from(u)[0];console.log("[ProfileService] Raw event:",x),console.log("[ProfileService] Event content:",x.content);const f=JSON.parse(x.content);console.log("[ProfileService] Parsed content:",f);const p=f.display_name||f.displayName||f.name||void 0,g=f.picture||f.image||void 0,y={name:p,picture:g,about:f.about,banner:f.banner,lud16:f.lud16,nip05:f.nip05,website:f.website,npub:t};return console.log("[ProfileService] Returning profile:",y),y}catch(r){return console.error("[ProfileService] Failed to fetch profile:",r),console.error("[ProfileService] Error stack:",r instanceof Error?r.stack:"No stack"),this.connecting=null,null}}static async fetchContacts(t){try{console.log("[ProfileService] Fetching contacts for:",t);const r=this.getNDK();await this.ensureConnection(),console.log("[ProfileService] NDK connected");const s=await r.getUser({npub:t}).follows();if(console.log("[ProfileService] Found",s.size,"follows"),s.size===0)return[];const l=Array.from(s).map(p=>p.pubkey).slice(0,100);if(console.log("[ProfileService] Fetching profiles for",l.length,"contacts"),l.length===0)return[];const u=await r.fetchEvents({kinds:[0],authors:l});console.log("[ProfileService] Received",u.size,"profile events");const x=new Map;for(const p of u)try{const g=JSON.parse(p.content),y=new NDKUser({pubkey:p.pubkey}).npub;x.set(y,{name:g.name,picture:g.picture||g.image,about:g.about,nip05:g.nip05,lud16:g.lud16,banner:g.banner,website:g.website,npub:y})}catch{}const f=Array.from(x.values());return console.log("[ProfileService] Returning",f.length,"contacts"),f}catch(r){return console.error("[ProfileService] Error fetching contacts:",r),[]}}static async publishProfile(t,r){try{const n=new NDKPrivateKeySigner(t),s=new NDK({explicitRelayUrls:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io"],signer:n});await s.connect();const a=new NDKEvent(s);a.kind=0,a.content=JSON.stringify({name:r.name||"",picture:r.picture||"",about:r.about||"",banner:r.banner||"",lud16:r.lud16||"",nip05:r.nip05||"",website:r.website||""}),await a.sign(n),await a.publish(),console.log("Profile published successfully")}catch(n){throw console.error("Failed to publish profile:",n),n}}}const profile=Object.freeze(Object.defineProperty({__proto__:null,ProfileService},Symbol.toStringTag,{value:"Module"})),ViewPrivateKeyModal=({encryptedNsec:e,onClose:t})=>{const[r,n]=reactExports.useState(""),[s,a]=reactExports.useState(null),[l,u]=reactExports.useState(null),[x,f]=reactExports.useState(!1),[p,g]=reactExports.useState(!1),[y,w]=reactExports.useState(!1),R=async k=>{k.preventDefault(),u(null),f(!0);try{const je=await CryptoService.decrypt(e,r);a(je),n("")}catch{u("Incorrect password")}finally{f(!1)}},I=()=>{s&&(navigator.clipboard.writeText(s),g(!0),setTimeout(()=>g(!1),2e3))};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:t,children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",onClick:k=>k.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"View Private Key"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),s?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Private Key (nsec)"}),jsxRuntimeExports.jsx("button",{onClick:()=>w(!y),className:"text-slate-400 hover:text-white transition-colors",children:y?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("div",{className:"font-mono text-sm break-all text-white",children:y?s:"".repeat(63)})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:I,className:"flex-1 flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:p?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),"Copied!"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),"Copy"]})}),jsxRuntimeExports.jsx("button",{onClick:t,className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors",children:"Close"})]})]}):jsxRuntimeExports.jsxs("form",{onSubmit:R,className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:" Never share your private key with anyone. Anyone with this key can control this account."})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Enter your password to reveal the private key"}),jsxRuntimeExports.jsx("input",{type:"password",inputMode:"numeric",value:r,onChange:k=>n(k.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Password",required:!0,autoFocus:!0})]}),l&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:l}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:x,className:"flex-1 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors",children:x?"Decrypting...":"Reveal"})]})]})]})})},ProfileEditor=({keypair:e,walletId:t,onBack:r})=>{const{updateKeypair:n,getWallet:s}=useWalletStore(),[a,l]=reactExports.useState({name:e.profile?.name||"",picture:e.profile?.picture||"",about:e.profile?.about||"",banner:e.profile?.banner||"",lud16:e.profile?.lud16||"",nip05:e.profile?.nip05||"",website:e.profile?.website||""}),[u,x]=reactExports.useState(""),[f,p]=reactExports.useState(!1),[g,y]=reactExports.useState(!1),[w,R]=reactExports.useState(null),[I,k]=reactExports.useState(!1),je=s(t);reactExports.useEffect(()=>{(async()=>{y(!0);try{const $e=await ProfileService.fetchProfile(e.npub);$e&&l($e)}catch($e){console.error("Failed to fetch profile:",$e)}finally{y(!1)}})()},[e.npub]);const Ve=async q=>{q.preventDefault(),R(null),k(!1),p(!0);try{if(!je)throw new Error("Wallet not found");const $e=await CryptoService.decrypt(e.encryptedNsec,u),We=CryptoService.nsecToHex($e);await ProfileService.publishProfile(We,a),n(t,e.id,{profile:{...a,lastFetched:Date.now()}}),k(!0),x(""),setTimeout(()=>{r()},1500)}catch($e){console.error("Failed to publish profile:",$e),R("Failed to publish profile. Please check your password and try again.")}finally{p(!1)}};return jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:r,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold flex items-center gap-2 mb-2",children:"Edit Profile"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-400 text-sm",children:["Update your Nostr profile (kind:0) for ",e.npub.slice(0,12),"..."]})]}),g&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-4 bg-slate-900 rounded-xl border border-slate-800 flex items-center gap-3",children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-300",children:"Fetching latest profile from relays..."})]}),jsxRuntimeExports.jsxs("form",{onSubmit:Ve,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-900 rounded-xl border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"w-16 h-16 rounded-lg bg-slate-800 flex items-center justify-center overflow-hidden flex-shrink-0",children:[a.picture?jsxRuntimeExports.jsx("img",{src:a.picture,alt:"Profile",className:"w-full h-full object-cover",onError:q=>{q.currentTarget.style.display="none",q.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx(User,{className:`w-8 h-8 text-slate-600 ${a.picture?"hidden":""}`})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-slate-300",children:"Profile Preview"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 truncate",children:a.name||"No name set"})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Display Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:a.name||"",onChange:q=>l({...a,name:q.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Your name"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Bio"}),jsxRuntimeExports.jsx("textarea",{value:a.about||"",onChange:q=>l({...a,about:q.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all resize-none",placeholder:"Tell us about yourself",rows:3})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Profile Picture URL"}),jsxRuntimeExports.jsx("input",{type:"url",value:a.picture||"",onChange:q=>l({...a,picture:q.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://example.com/avatar.jpg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Banner Image URL"}),jsxRuntimeExports.jsx("input",{type:"url",value:a.banner||"",onChange:q=>l({...a,banner:q.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://example.com/banner.jpg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Lightning Address"}),jsxRuntimeExports.jsx("input",{type:"text",value:a.lud16||"",onChange:q=>l({...a,lud16:q.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"you@getalby.com"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"NIP-05 Identifier"}),jsxRuntimeExports.jsx("input",{type:"text",value:a.nip05||"",onChange:q=>l({...a,nip05:q.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"you@example.com"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Website"}),jsxRuntimeExports.jsx("input",{type:"url",value:a.website||"",onChange:q=>l({...a,website:q.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://yourwebsite.com"})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Wallet Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:u,onChange:q=>x(q.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Enter password to publish",required:!0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Your password is required to sign and publish the profile update."})]}),w&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:w}),I&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-green-400 text-sm",children:"Profile published successfully! Redirecting..."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:f||!u,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 rounded-lg transition-colors font-bold",children:f?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Publishing..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Save,{className:"w-4 h-4"}),"Save Profile"]})})]})]})]})},PasswordModal=({isOpen:e,onClose:t,onSubmit:r,title:n,description:s,submitLabel:a="Confirm",error:l})=>{const[u,x]=reactExports.useState("");reactExports.useEffect(()=>{e&&x("")},[e]);const f=p=>{p.preventDefault(),u&&r(u)};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-800 max-w-md w-full p-6 shadow-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Lock,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:n})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),s&&jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:s}),jsxRuntimeExports.jsxs("form",{onSubmit:f,children:[jsxRuntimeExports.jsx("input",{type:"password",value:u,onChange:p=>x(p.target.value),placeholder:"Enter password",inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 mb-3 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",autoFocus:!0,required:!0}),l&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm mb-3",children:l}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:a})]})]})]})}):null},InputModal=({isOpen:e,onClose:t,onSubmit:r,title:n,description:s,placeholder:a="Enter value",initialValue:l="",submitLabel:u="Save"})=>{const[x,f]=reactExports.useState(l);reactExports.useEffect(()=>{e&&f(l)},[e,l]);const p=g=>{g.preventDefault(),x.trim()&&r(x.trim())};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-800 max-w-md w-full p-6 shadow-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Pen,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:n})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),s&&jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:s}),jsxRuntimeExports.jsxs("form",{onSubmit:p,children:[jsxRuntimeExports.jsx("input",{type:"text",value:x,onChange:g=>f(g.target.value),placeholder:a,className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 mb-4 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",autoFocus:!0,required:!0}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:u})]})]})]})}):null},BackupModal=({isOpen:e,onClose:t,mnemonic:r,onDownload:n})=>{const[s,a]=reactExports.useState(!1),[l,u]=reactExports.useState(!1);if(!e)return null;const x=()=>{navigator.clipboard.writeText(r),a(!0),setTimeout(()=>a(!1),2e3)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Wallet Backup"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"These are your recovery words. Write them down and keep them safe."})}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 relative group",children:[jsxRuntimeExports.jsx("div",{className:`grid grid-cols-3 gap-2 ${l?"":"blur-sm select-none"}`,children:r.split(" ").map((f,p)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 p-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500 text-xs w-4",children:[p+1,"."]}),jsxRuntimeExports.jsx("span",{className:"font-mono font-medium text-amber-50",children:f})]},p))}),jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>u(!l),className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:l?"Hide seed phrase":"Show seed phrase",children:l?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4 text-slate-400"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("button",{onClick:x,className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:"Copy to clipboard",children:s?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 flex items-start gap-3",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:"Anyone with these words can access your funds. Never share them."})]}),jsxRuntimeExports.jsxs("button",{onClick:n,className:"w-full py-3 px-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors border border-slate-700 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),"Download Encrypted Backup"]})]})]})})},KeypairManager=({walletId:e,onBack:t})=>{const{getWallet:r,addKeypair:n,updateKeypair:s,removeKeypair:a,setCurrentKeypair:l,currentKeypairId:u,updateWallet:x,removeWallet:f,currentWalletId:p,setCurrentWallet:g,wallets:y}=useWalletStore(),{unlock:w}=useAuthStore(),[R,I]=reactExports.useState(""),[k,je]=reactExports.useState(!1),[Ve,q]=reactExports.useState(null),[$e,We]=reactExports.useState(null),[K,W]=reactExports.useState(null),[Ye,Qe]=reactExports.useState(null),[it,ze]=reactExports.useState(null),[v,D]=reactExports.useState(!1),[_e,P]=reactExports.useState(null),[Re,Fe]=reactExports.useState(!1),[Le,Ce]=reactExports.useState(null),[L,O]=reactExports.useState(!1),[st,lt]=reactExports.useState(!1),[Xe,dt]=reactExports.useState(!1),[er,ar]=reactExports.useState(""),[dr,ir]=reactExports.useState(null),[pt,tr]=reactExports.useState(!1),[sr,nr]=reactExports.useState(null),[pr,gr]=reactExports.useState(null),mr=r(e);if(!mr)return jsxRuntimeExports.jsx("div",{children:"Wallet not found"});reactExports.useEffect(()=>{(async()=>{for(const lr of mr.keypairs){if(lr.profile?.lastFetched&&Date.now()-lr.profile.lastFetched<1e4){console.log("[KeypairManager] Skipping profile fetch for",lr.npub,"- fetched recently");continue}try{console.log("[KeypairManager] Fetching profile for",lr.npub);const Sr=await ProfileService.fetchProfile(lr.npub);Sr&&s(mr.id,lr.id,{profile:{...Sr,lastFetched:Date.now()}})}catch(Sr){console.error(`Failed to fetch profile for ${lr.npub}:`,Sr)}}})()},[mr.id]);const yr=async br=>{br.preventDefault(),ze(null),D(!0);try{if(Ve==="add"){if(mr.type==="imported")throw new Error("Cannot derive new addresses for imported wallets");const lr=await CryptoService.decrypt(mr.encryptedSeed,R);let Sr=0;mr.keypairs.forEach(_r=>{if(_r.derivationPath){const Nr=_r.derivationPath.match(/(\d+)$/);if(Nr){const Hr=parseInt(Nr[1]);Hr>=Sr&&(Sr=Hr+1)}}});const{nsec:yt,npub:Je,path:ft}=CryptoService.deriveKeypair(lr,Sr),or=await CryptoService.encrypt(yt,R),Ar={id:crypto.randomUUID(),walletId:mr.id,name:`Address ${Sr+1}`,derivationPath:ft,encryptedNsec:or,npub:Je,createdAt:Date.now(),connections:[]};n(mr.id,Ar),je(!1),I(""),q(null),setTimeout(async()=>{try{const _r=await ProfileService.fetchProfile(Je);_r&&s(mr.id,Ar.id,{profile:{..._r,lastFetched:Date.now()}})}catch(_r){console.error("Failed to fetch profile for new keypair:",_r)}},100)}else if(Ve==="switch"&&$e){const lr=await CryptoService.decrypt($e.encryptedNsec,R),Sr=CryptoService.nsecToHex(lr),{isUnlocked:yt,publicKey:Je}=useAuthStore.getState();yt&&Je&&useEcashStore.getState().saveSession(Je),mr.id!==p&&g(mr.id),l($e.id);const ft=CryptoService.getPublicKeyHex(lr);w(Sr,ft,R),useEcashStore.getState().loadSession(ft),je(!1),I(""),q(null),We(null)}}catch{ze("Incorrect password or operation failed")}finally{D(!1)}},Er=()=>{q("add"),je(!0),ze(null)},xr=async br=>{try{console.log("[KeypairManager] Manually refreshing profile for",br.npub);const lr=await ProfileService.fetchProfile(br.npub);lr?(s(mr.id,br.id,{profile:{...lr,lastFetched:Date.now()}}),gr({message:"Profile refreshed!",type:"success"})):gr({message:"No profile found",type:"error"})}catch(lr){console.error("Failed to refresh profile:",lr),gr({message:"Failed to refresh profile",type:"error"})}},Cr=async br=>{const{password:lr}=useAuthStore.getState();if(lr)try{const Sr=await CryptoService.decrypt(br.encryptedNsec,lr),yt=CryptoService.nsecToHex(Sr),Je=CryptoService.getPublicKeyHex(Sr),{isUnlocked:ft,publicKey:or}=useAuthStore.getState();ft&&or&&useEcashStore.getState().saveSession(or),l(br.id),w(yt,Je,lr),useEcashStore.getState().loadSession(Je);return}catch{console.error("[KeypairManager] Cached password failed, prompting for password")}We(br),q("switch"),je(!0),ze(null)},wr=(br,lr)=>{navigator.clipboard.writeText(br),P(lr),setTimeout(()=>P(null),2e3)},kr=br=>{br&&br!==mr.name&&(x(mr.id,{name:br}),gr({message:"Address Book renamed successfully!",type:"success"})),O(!1)},Dr=br=>{br&&Le&&(s(mr.id,Le.id,{name:br}),gr({message:"Address renamed successfully!",type:"success"})),Fe(!1),Ce(null)},rr=async br=>{try{const{CryptoService:lr}=await __vitePreload(async()=>{const{CryptoService:yt}=await Promise.resolve().then(()=>crypto$2);return{CryptoService:yt}},void 0,import.meta.url),Sr=await lr.decrypt(mr.encryptedSeed,br);ar(Sr),I(br),lt(!1),dt(!0),ir(null)}catch(lr){console.error("Failed to export backup:",lr),ir("Failed to decrypt wallet. Incorrect password.")}},cr=async()=>{try{const{CryptoService:br}=await __vitePreload(async()=>{const{CryptoService:or}=await Promise.resolve().then(()=>crypto$2);return{CryptoService:or}},void 0,import.meta.url),lr=await br.encrypt(er,R),Sr=JSON.stringify({wallet:mr.name,encrypted:lr,timestamp:Date.now()},null,2),yt=new Blob([Sr],{type:"application/json"}),Je=URL.createObjectURL(yt),ft=document.createElement("a");ft.href=Je,ft.download=`${mr.name.toLowerCase().replace(/\s+/g,"-")}-backup-encrypted.json`,document.body.appendChild(ft),ft.click(),document.body.removeChild(ft),URL.revokeObjectURL(Je),gr({message:"Encrypted backup downloaded successfully!",type:"success"})}catch(br){console.error("Failed to download backup:",br),gr({message:"Failed to generate backup file",type:"error"})}},Br=async br=>{try{const{CryptoService:lr}=await __vitePreload(async()=>{const{CryptoService:Je}=await Promise.resolve().then(()=>crypto$2);return{CryptoService:Je}},void 0,import.meta.url);mr.type==="mnemonic"&&mr.encryptedSeed?await lr.decrypt(mr.encryptedSeed,br):mr.keypairs.length>0&&await lr.decrypt(mr.keypairs[0].encryptedNsec,br);const{lock:Sr}=useAuthStore.getState(),yt=y.filter(Je=>Je.id!==mr.id);f(mr.id),yt.length===0?Sr():t()}catch(lr){console.error("Failed to delete wallet:",lr),nr("Incorrect password. Cannot delete wallet.")}};return Ye?jsxRuntimeExports.jsx(ProfileEditor,{keypair:Ye,walletId:e,onBack:()=>Qe(null)}):jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:t,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Address Books"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold",children:mr.name}),jsxRuntimeExports.jsx("button",{onClick:()=>O(!0),className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Rename address book",children:jsxRuntimeExports.jsx(Pen,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm",children:"Manage your addresses"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[mr.id!==p&&jsxRuntimeExports.jsxs("button",{onClick:()=>{je(!0),q("switch"),We(mr.keypairs[0])},className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Activate Wallet"})]}),mr.type==="mnemonic"&&mr.encryptedSeed&&jsxRuntimeExports.jsxs("button",{onClick:()=>{ir(null),lt(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Export Backup"})]}),mr.type==="mnemonic"&&jsxRuntimeExports.jsxs("button",{onClick:Er,className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Add Address"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{nr(null),tr(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-red-500/10 hover:text-red-500 text-slate-400 rounded-lg transition-colors text-sm font-medium",title:"Delete Wallet",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]}),k&&jsxRuntimeExports.jsx("div",{className:"mb-6 p-4 bg-slate-900 rounded-xl border border-slate-800",children:jsxRuntimeExports.jsxs("form",{onSubmit:yr,children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:Ve==="add"?"Enter wallet password to add new address":"Enter wallet password to switch address"}),jsxRuntimeExports.jsx("input",{type:"password",value:R,onChange:br=>I(br.target.value),inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 mb-3 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",placeholder:"Password",required:!0,autoFocus:!0}),it&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm mb-3",children:it}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{je(!1),I(""),ze(null),q(null),We(null)},className:"flex-1 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:v,className:"flex-1 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold disabled:opacity-50",children:v?"Processing...":"Confirm"})]})]})}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:mr.keypairs.map(br=>{const lr=br.npub.length>16?`${br.npub.slice(0,8)}...${br.npub.slice(-6)}`:br.npub;return jsxRuntimeExports.jsxs("div",{className:`p-4 rounded-xl border transition-all ${u===br.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[jsxRuntimeExports.jsxs("div",{className:`relative rounded-lg flex-shrink-0 cursor-pointer group ${u===br.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,onClick:Sr=>{Sr.stopPropagation();const yt=Sr.currentTarget;yt.classList.add("opacity-50"),xr(br).finally(()=>yt.classList.remove("opacity-50"))},title:"Click to refresh profile",children:[br.profile?.picture?jsxRuntimeExports.jsx("img",{src:br.profile.picture,alt:br.profile.name||"Profile",className:"w-10 h-10 rounded-lg object-cover",onError:Sr=>{Sr.currentTarget.style.display="none",Sr.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx("div",{className:`w-10 h-10 flex items-center justify-center ${br.profile?.picture?"hidden":""}`,children:jsxRuntimeExports.jsx(User,{className:"w-6 h-6"})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100 rounded-lg",children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 text-white"})})]}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg truncate",children:br.profile?.name||br.name}),jsxRuntimeExports.jsx("button",{onClick:()=>{Ce(br),Fe(!0)},className:"p-1 text-slate-500 hover:text-white hover:bg-slate-800 rounded transition-colors",title:"Rename address",children:jsxRuntimeExports.jsx(Pen,{className:"w-3 h-3"})}),u===br.id&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex-shrink-0",children:"Active"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"font-mono bg-slate-950 px-2 py-0.5 rounded text-xs",children:lr}),jsxRuntimeExports.jsx("button",{onClick:()=>wr(br.npub,br.id),className:"text-slate-500 hover:text-white transition-colors flex-shrink-0 p-1 hover:bg-slate-800 rounded",title:"Copy npub",children:_e===br.id?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:()=>W(br),className:"text-slate-500 hover:text-white transition-colors flex-shrink-0 p-1 hover:bg-slate-800 rounded",title:"View private key",children:jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"})})]}),br.derivationPath&&jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mt-1 font-mono truncate",children:br.derivationPath})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-slate-800",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>Qe(br),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors text-sm",children:[jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Edit Profile"})]}),u!==br.id&&mr.id===p&&jsxRuntimeExports.jsxs("button",{onClick:()=>Cr(br),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-slate-800 hover:bg-slate-700 text-slate-300 text-sm font-medium rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Switch"})]}),mr.keypairs.length>1&&jsxRuntimeExports.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this address?")&&a(mr.id,br.id)},className:"px-3 py-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete address",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]},br.id)})}),K&&jsxRuntimeExports.jsx(ViewPrivateKeyModal,{encryptedNsec:K.encryptedNsec,onClose:()=>W(null)}),jsxRuntimeExports.jsx(InputModal,{isOpen:Re,onClose:()=>{Fe(!1),Ce(null)},onSubmit:Dr,title:"Rename Address",description:"Enter a new name for this address",placeholder:"Address name",initialValue:Le?.name||"",submitLabel:"Rename"}),jsxRuntimeExports.jsx(InputModal,{isOpen:L,onClose:()=>O(!1),onSubmit:kr,title:"Rename Address Book",description:"Enter a new name for your address book",placeholder:"Address book name",initialValue:mr.name,submitLabel:"Rename"}),jsxRuntimeExports.jsx(PasswordModal,{isOpen:st,onClose:()=>{lt(!1),ir(null)},onSubmit:rr,title:"Export Encrypted Backup",description:"Enter your wallet password to export an encrypted backup file",submitLabel:"Export",error:dr}),jsxRuntimeExports.jsx(BackupModal,{isOpen:Xe,onClose:()=>{dt(!1),ar(""),I("")},mnemonic:er,onDownload:cr}),jsxRuntimeExports.jsx(PasswordModal,{isOpen:pt,onClose:()=>{tr(!1),nr(null)},onSubmit:Br,title:"Delete Address Book",description:`Are you sure you want to delete "${mr.name}"? This action cannot be undone. Enter your password to confirm.`,submitLabel:"Delete Address Book",error:sr}),pr&&jsxRuntimeExports.jsx(Toast,{message:pr.message,type:pr.type,isOpen:!!pr,onClose:()=>gr(null)})]})},WalletManager=({onBack:e})=>{const[t,r]=reactExports.useState("list"),[n,s]=reactExports.useState(null),{wallets:a,currentWalletId:l,setCurrentWallet:u}=useWalletStore(),{lock:x}=useAuthStore(),f=()=>{t==="list"&&e?e():(r("list"),s(null))},p=y=>{u(y),x()},g=y=>{s(y),r("keypairs")};return t==="create"?jsxRuntimeExports.jsx(CreateWallet,{onBack:f,onComplete:f}):t==="import"?jsxRuntimeExports.jsx(ImportWallet,{onBack:f,onComplete:f}):t==="keypairs"&&n?jsxRuntimeExports.jsx(KeypairManager,{walletId:n,onBack:f}):jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e&&t==="list"&&jsxRuntimeExports.jsxs("button",{onClick:e,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Connections"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-6 h-6 text-amber-500"}),"Address Books"]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>r("import"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"sm:inline",children:"Import"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>r("create"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"sm:inline",children:"Create"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:a.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12 bg-slate-900/50 rounded-xl border border-slate-800 border-dashed",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No Address Books Found"}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 max-w-xs mx-auto mb-6",children:"Create a new address book or import an existing one to get started."}),jsxRuntimeExports.jsxs("div",{className:"flex justify-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>r("create"),className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg font-bold transition-colors",children:"Create New"}),jsxRuntimeExports.jsx("button",{onClick:()=>r("import"),className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors",children:"Import"})]})]}):a.map(y=>jsxRuntimeExports.jsx("div",{className:`p-4 rounded-xl border transition-all ${l===y.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg ${l===y.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:y.type==="imported"?jsxRuntimeExports.jsx(Key,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(Notebook,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[y.name,l===y.id&&jsxRuntimeExports.jsxs("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex items-center gap-1",children:[jsxRuntimeExports.jsx(Check,{className:"w-3 h-3"})," Active"]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3 text-sm text-slate-400 mt-1",children:jsxRuntimeExports.jsxs("span",{children:[y.keypairs.length," address",y.keypairs.length!==1?"es":""]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>g(y.id),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Manage Keys",children:jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"})}),l!==y.id&&jsxRuntimeExports.jsx("button",{onClick:()=>p(y.id),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Switch to this wallet",children:jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"})})]})]})},y.id))})]})},RelayManager=({onClose:e})=>{const{relays:t,addRelay:r,removeRelay:n}=useRelayStore(),[s,a]=reactExports.useState(""),[l,u]=reactExports.useState(null),x=async()=>{if(u(null),!s.trim()){u("Please enter a relay URL");return}if(!s.startsWith("wss://")&&!s.startsWith("ws://")){u("Relay URL must start with wss:// or ws://");return}const w=s.trim();r(w),a(""),window.dispatchEvent(new CustomEvent("add-relay",{detail:{url:w}}))},f=w=>{if(t.length<=1){u("Cannot remove the last relay");return}n(w)},p=w=>{switch(w.status){case"connected":return jsxRuntimeExports.jsx(Wifi,{className:"w-4 h-4 text-green-500"});case"connecting":return jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 text-yellow-500 animate-spin"});case"disconnected":case"error":return jsxRuntimeExports.jsx(WifiOff,{className:"w-4 h-4 text-red-500"})}},g=w=>{switch(w.status){case"connected":return"Connected";case"connecting":return"Connecting...";case"disconnected":return"Disconnected";case"error":return"Error"}},y=w=>{switch(w.status){case"connected":return"text-green-500";case"connecting":return"text-yellow-500";case"disconnected":case"error":return"text-red-500"}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:e,children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-2xl w-full border border-slate-800 shadow-2xl max-h-[80vh] flex flex-col",onClick:w=>w.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white",children:"Relay Management"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Manage your Nostr relay connections"})]}),jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",title:"Close",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Add New Relay"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsx("input",{type:"text",value:s,onChange:w=>a(w.target.value),onKeyDown:w=>w.key==="Enter"&&x(),placeholder:"wss://relay.example.com",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none"}),jsxRuntimeExports.jsxs("button",{onClick:x,className:"w-full px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg font-bold transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),"Add Relay"]})]}),l&&jsxRuntimeExports.jsx("p",{className:"text-red-400 text-sm mt-2",children:l})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-slate-400 mb-3",children:["Active Relays (",t.length,")"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:t.map(w=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-950 rounded-xl border border-slate-800 hover:border-slate-700 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[p(w),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"font-mono text-sm text-white truncate",children:w.url}),jsxRuntimeExports.jsxs("div",{className:`text-xs ${y(w)} mt-0.5`,children:[g(w),w.lastConnected&&w.status==="connected"&&jsxRuntimeExports.jsxs("span",{className:"text-slate-500 ml-2",children:[" Last: ",new Date(w.lastConnected).toLocaleTimeString()]}),w.failedAttempts>0&&jsxRuntimeExports.jsxs("span",{className:"text-slate-500 ml-2",children:[" Failed attempts: ",w.failedAttempts]})]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>f(w.url),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors ml-2",title:"Remove relay",disabled:t.length<=1,children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]},w.url))})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 p-4 bg-slate-950 rounded-lg border border-slate-800",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-400",children:[jsxRuntimeExports.jsx("strong",{className:"text-slate-300",children:"Note:"})," Relays are used to communicate with Nostr apps. The PWA will automatically attempt to reconnect to disconnected relays every 5 seconds."]})})]})})},BottomNav=({currentView:e,onChange:t})=>jsxRuntimeExports.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-900 border-t border-slate-800 pb-safe",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-around items-center h-16 max-w-md mx-auto",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>t("connections"),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${e==="connections"?"text-amber-500":"text-slate-500 hover:text-slate-400"}`,children:[jsxRuntimeExports.jsx(FilePenLine,{className:"w-6 h-6 mb-1"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:"Connections"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>t("wallet"),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${e==="wallet"?"text-amber-500":"text-slate-500 hover:text-slate-400"}`,children:[jsxRuntimeExports.jsx(Wallet,{className:"w-6 h-6 mb-1"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:"Wallet"})]})]})}),bitcoin$1={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};function check$d(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;const t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return!1;const r=e[5+t];return!(r===0||6+t+r!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||r>1&&e[t+6]===0&&!(e[t+7]&128))}function decode$i(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");const t=e[3];if(t===0)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(e[4+t]!==2)throw new Error("Expected DER integer (2)");const r=e[5+t];if(r===0)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(t>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[t+6]&128)throw new Error("S value is negative");if(r>1&&e[t+6]===0&&!(e[t+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}function encode$j(e,t){const r=e.length,n=t.length;if(r===0)throw new Error("R length is zero");if(n===0)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(n>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(t[0]&128)throw new Error("S value is negative");if(r>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(n>1&&t[0]===0&&!(t[1]&128))throw new Error("S value excessively padded");const s=new Uint8Array(6+r+n);return s[0]=48,s[1]=s.length-2,s[2]=2,s[3]=e.length,s.set(e,4),s[4+r]=2,s[5+r]=t.length,s.set(t,6+r),s}var OPS$7;(function(e){e[e.OP_FALSE=0]="OP_FALSE",e[e.OP_0=0]="OP_0",e[e.OP_PUSHDATA1=76]="OP_PUSHDATA1",e[e.OP_PUSHDATA2=77]="OP_PUSHDATA2",e[e.OP_PUSHDATA4=78]="OP_PUSHDATA4",e[e.OP_1NEGATE=79]="OP_1NEGATE",e[e.OP_RESERVED=80]="OP_RESERVED",e[e.OP_TRUE=81]="OP_TRUE",e[e.OP_1=81]="OP_1",e[e.OP_2=82]="OP_2",e[e.OP_3=83]="OP_3",e[e.OP_4=84]="OP_4",e[e.OP_5=85]="OP_5",e[e.OP_6=86]="OP_6",e[e.OP_7=87]="OP_7",e[e.OP_8=88]="OP_8",e[e.OP_9=89]="OP_9",e[e.OP_10=90]="OP_10",e[e.OP_11=91]="OP_11",e[e.OP_12=92]="OP_12",e[e.OP_13=93]="OP_13",e[e.OP_14=94]="OP_14",e[e.OP_15=95]="OP_15",e[e.OP_16=96]="OP_16",e[e.OP_NOP=97]="OP_NOP",e[e.OP_VER=98]="OP_VER",e[e.OP_IF=99]="OP_IF",e[e.OP_NOTIF=100]="OP_NOTIF",e[e.OP_VERIF=101]="OP_VERIF",e[e.OP_VERNOTIF=102]="OP_VERNOTIF",e[e.OP_ELSE=103]="OP_ELSE",e[e.OP_ENDIF=104]="OP_ENDIF",e[e.OP_VERIFY=105]="OP_VERIFY",e[e.OP_RETURN=106]="OP_RETURN",e[e.OP_TOALTSTACK=107]="OP_TOALTSTACK",e[e.OP_FROMALTSTACK=108]="OP_FROMALTSTACK",e[e.OP_2DROP=109]="OP_2DROP",e[e.OP_2DUP=110]="OP_2DUP",e[e.OP_3DUP=111]="OP_3DUP",e[e.OP_2OVER=112]="OP_2OVER",e[e.OP_2ROT=113]="OP_2ROT",e[e.OP_2SWAP=114]="OP_2SWAP",e[e.OP_IFDUP=115]="OP_IFDUP",e[e.OP_DEPTH=116]="OP_DEPTH",e[e.OP_DROP=117]="OP_DROP",e[e.OP_DUP=118]="OP_DUP",e[e.OP_NIP=119]="OP_NIP",e[e.OP_OVER=120]="OP_OVER",e[e.OP_PICK=121]="OP_PICK",e[e.OP_ROLL=122]="OP_ROLL",e[e.OP_ROT=123]="OP_ROT",e[e.OP_SWAP=124]="OP_SWAP",e[e.OP_TUCK=125]="OP_TUCK",e[e.OP_CAT=126]="OP_CAT",e[e.OP_SUBSTR=127]="OP_SUBSTR",e[e.OP_LEFT=128]="OP_LEFT",e[e.OP_RIGHT=129]="OP_RIGHT",e[e.OP_SIZE=130]="OP_SIZE",e[e.OP_INVERT=131]="OP_INVERT",e[e.OP_AND=132]="OP_AND",e[e.OP_OR=133]="OP_OR",e[e.OP_XOR=134]="OP_XOR",e[e.OP_EQUAL=135]="OP_EQUAL",e[e.OP_EQUALVERIFY=136]="OP_EQUALVERIFY",e[e.OP_RESERVED1=137]="OP_RESERVED1",e[e.OP_RESERVED2=138]="OP_RESERVED2",e[e.OP_1ADD=139]="OP_1ADD",e[e.OP_1SUB=140]="OP_1SUB",e[e.OP_2MUL=141]="OP_2MUL",e[e.OP_2DIV=142]="OP_2DIV",e[e.OP_NEGATE=143]="OP_NEGATE",e[e.OP_ABS=144]="OP_ABS",e[e.OP_NOT=145]="OP_NOT",e[e.OP_0NOTEQUAL=146]="OP_0NOTEQUAL",e[e.OP_ADD=147]="OP_ADD",e[e.OP_SUB=148]="OP_SUB",e[e.OP_MUL=149]="OP_MUL",e[e.OP_DIV=150]="OP_DIV",e[e.OP_MOD=151]="OP_MOD",e[e.OP_LSHIFT=152]="OP_LSHIFT",e[e.OP_RSHIFT=153]="OP_RSHIFT",e[e.OP_BOOLAND=154]="OP_BOOLAND",e[e.OP_BOOLOR=155]="OP_BOOLOR",e[e.OP_NUMEQUAL=156]="OP_NUMEQUAL",e[e.OP_NUMEQUALVERIFY=157]="OP_NUMEQUALVERIFY",e[e.OP_NUMNOTEQUAL=158]="OP_NUMNOTEQUAL",e[e.OP_LESSTHAN=159]="OP_LESSTHAN",e[e.OP_GREATERTHAN=160]="OP_GREATERTHAN",e[e.OP_LESSTHANOREQUAL=161]="OP_LESSTHANOREQUAL",e[e.OP_GREATERTHANOREQUAL=162]="OP_GREATERTHANOREQUAL",e[e.OP_MIN=163]="OP_MIN",e[e.OP_MAX=164]="OP_MAX",e[e.OP_WITHIN=165]="OP_WITHIN",e[e.OP_RIPEMD160=166]="OP_RIPEMD160",e[e.OP_SHA1=167]="OP_SHA1",e[e.OP_SHA256=168]="OP_SHA256",e[e.OP_HASH160=169]="OP_HASH160",e[e.OP_HASH256=170]="OP_HASH256",e[e.OP_CODESEPARATOR=171]="OP_CODESEPARATOR",e[e.OP_CHECKSIG=172]="OP_CHECKSIG",e[e.OP_CHECKSIGVERIFY=173]="OP_CHECKSIGVERIFY",e[e.OP_CHECKMULTISIG=174]="OP_CHECKMULTISIG",e[e.OP_CHECKMULTISIGVERIFY=175]="OP_CHECKMULTISIGVERIFY",e[e.OP_NOP1=176]="OP_NOP1",e[e.OP_CHECKLOCKTIMEVERIFY=177]="OP_CHECKLOCKTIMEVERIFY",e[e.OP_NOP2=177]="OP_NOP2",e[e.OP_CHECKSEQUENCEVERIFY=178]="OP_CHECKSEQUENCEVERIFY",e[e.OP_NOP3=178]="OP_NOP3",e[e.OP_NOP4=179]="OP_NOP4",e[e.OP_NOP5=180]="OP_NOP5",e[e.OP_NOP6=181]="OP_NOP6",e[e.OP_NOP7=182]="OP_NOP7",e[e.OP_NOP8=183]="OP_NOP8",e[e.OP_NOP9=184]="OP_NOP9",e[e.OP_NOP10=185]="OP_NOP10",e[e.OP_CHECKSIGADD=186]="OP_CHECKSIGADD",e[e.OP_PUBKEYHASH=253]="OP_PUBKEYHASH",e[e.OP_PUBKEY=254]="OP_PUBKEY",e[e.OP_INVALIDOPCODE=255]="OP_INVALIDOPCODE"})(OPS$7||(OPS$7={}));const HEX_STRINGS$2="0123456789abcdefABCDEF",HEX_CODES=HEX_STRINGS$2.split("").map(e=>e.codePointAt(0)),HEX_CODEPOINTS=Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=HEX_STRINGS$2.indexOf(r);return n<0?void 0:n<16?n:n-6}),ENCODER=new TextEncoder,DECODER=new TextDecoder;function toUtf8(e){return DECODER.decode(e)}function fromUtf8(e){return ENCODER.encode(e)}function concat$1(e){const t=e.reduce((s,a)=>s+a.length,0),r=new Uint8Array(t);let n=0;for(const s of e)r.set(s,n),n+=s.length;return r}function toHex(e){const t=e||new Uint8Array;return t.length>512?_toHexLengthPerf(t):_toHexIterPerf(t)}function _toHexIterPerf(e){let t="";for(let r=0;r<e.length;++r)t+=HEX_STRINGS$2[HEX_CODEPOINTS[HEX_CODES[e[r]>>4]]],t+=HEX_STRINGS$2[HEX_CODEPOINTS[HEX_CODES[e[r]&15]]];return t}function _toHexLengthPerf(e){const t=new Uint8Array(e.length*2);for(let r=0;r<e.length;++r)t[r*2]=HEX_CODES[e[r]>>4],t[r*2+1]=HEX_CODES[e[r]&15];return DECODER.decode(t)}function fromHex(e){const t=ENCODER.encode(e||""),r=new Uint8Array(Math.floor(t.length/2));let n;for(n=0;n<r.length;n++){const s=HEX_CODEPOINTS[t[n*2]],a=HEX_CODEPOINTS[t[n*2+1]];if(s===void 0||a===void 0)break;r[n]=s<<4|a}return n===r.length?r:r.slice(0,n)}function toBase64(e){return btoa(String.fromCharCode(...e))}function fromBase64(e){const t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}function compare(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return e.length===t.length?0:e.length>t.length?1:-1}function writeUInt8(e,t,r){if(t+1>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r>255)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 255. Received ${r}`);return e[t]=r,t+1}function writeUInt16$1(e,t,r,n){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>65535)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${r}`);return n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255):(e[t]=r>>8&255,e[t+1]=r&255),t+2}function writeUInt32$2(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${r}`);return n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255),t+4}function writeUInt64$1(e,t,r,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>0xffffffffffffffffn)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${r}`);return n==="LE"?(e[t]=Number(r&0xffn),e[t+1]=Number(r>>8n&0xffn),e[t+2]=Number(r>>16n&0xffn),e[t+3]=Number(r>>24n&0xffn),e[t+4]=Number(r>>32n&0xffn),e[t+5]=Number(r>>40n&0xffn),e[t+6]=Number(r>>48n&0xffn),e[t+7]=Number(r>>56n&0xffn)):(e[t]=Number(r>>56n&0xffn),e[t+1]=Number(r>>48n&0xffn),e[t+2]=Number(r>>40n&0xffn),e[t+3]=Number(r>>32n&0xffn),e[t+4]=Number(r>>24n&0xffn),e[t+5]=Number(r>>16n&0xffn),e[t+6]=Number(r>>8n&0xffn),e[t+7]=Number(r&0xffn)),t+8}function readUInt8(e,t){if(t+1>e.length)throw new Error("Offset is outside the bounds of Uint8Array");return e[t]}function readUInt16$1(e,t,r){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+1],n=(n<<8)+e[t],n}else{let n=0;return n=(n<<8)+e[t],n=(n<<8)+e[t+1],n}}function readUInt32$1(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+3]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t]>>>0,n}else{let n=0;return n=(n<<8)+e[t]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+3]>>>0,n}}function writeInt32(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r>2147483647||r<-2147483648)throw new Error(`The value of "value" is out of range. It must be >= -2147483648 and <= 2147483647. Received ${r}`);return n=n.toUpperCase(),n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255),t+4}function writeInt64(e,t,r,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r>0x7fffffffffffffffn||r<-0x8000000000000000n)throw new Error(`The value of "value" is out of range. It must be >= ${-0x8000000000000000n} and <= ${0x7fffffffffffffffn}. Received ${r}`);return n=n.toUpperCase(),n==="LE"?(e[t]=Number(r&0xffn),e[t+1]=Number(r>>8n&0xffn),e[t+2]=Number(r>>16n&0xffn),e[t+3]=Number(r>>24n&0xffn),e[t+4]=Number(r>>32n&0xffn),e[t+5]=Number(r>>40n&0xffn),e[t+6]=Number(r>>48n&0xffn),e[t+7]=Number(r>>56n&0xffn)):(e[t]=Number(r>>56n&0xffn),e[t+1]=Number(r>>48n&0xffn),e[t+2]=Number(r>>40n&0xffn),e[t+3]=Number(r>>32n&0xffn),e[t+4]=Number(r>>24n&0xffn),e[t+5]=Number(r>>16n&0xffn),e[t+6]=Number(r>>8n&0xffn),e[t+7]=Number(r&0xffn)),t+8}function readInt32(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){const n=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24>>>0);return e[t+3]<=127?n:n-4294967296}else{const n=(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];return e[t]<=127?n:n-4294967296}}function readInt64(e,t,r){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");r=r.toUpperCase();let n=0n;if(r==="LE")return n=(n<<8n)+BigInt(e[t+7]),n=(n<<8n)+BigInt(e[t+6]),n=(n<<8n)+BigInt(e[t+5]),n=(n<<8n)+BigInt(e[t+4]),n=(n<<8n)+BigInt(e[t+3]),n=(n<<8n)+BigInt(e[t+2]),n=(n<<8n)+BigInt(e[t+1]),n=(n<<8n)+BigInt(e[t]),e[t+7]<=127?n:n-0x10000000000000000n;{let s=0n;return s=(s<<8n)+BigInt(e[t]),s=(s<<8n)+BigInt(e[t+1]),s=(s<<8n)+BigInt(e[t+2]),s=(s<<8n)+BigInt(e[t+3]),s=(s<<8n)+BigInt(e[t+4]),s=(s<<8n)+BigInt(e[t+5]),s=(s<<8n)+BigInt(e[t+6]),s=(s<<8n)+BigInt(e[t+7]),e[t]<=127?s:s-0x10000000000000000n}}function encodingLength$1(e){return e<OPS$7.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}function encode$i(e,t,r){const n=encodingLength$1(t);return n===1?writeUInt8(e,r,t):n===2?(writeUInt8(e,r,OPS$7.OP_PUSHDATA1),writeUInt8(e,r+1,t)):n===3?(writeUInt8(e,r,OPS$7.OP_PUSHDATA2),writeUInt16$1(e,r+1,t,"LE")):(writeUInt8(e,r,OPS$7.OP_PUSHDATA4),writeUInt32$2(e,r+1,t,"LE")),n}function decode$h(e,t){const r=readUInt8(e,t);let n,s;if(r<OPS$7.OP_PUSHDATA1)n=r,s=1;else if(r===OPS$7.OP_PUSHDATA1){if(t+2>e.length)return null;n=readUInt8(e,t+1),s=2}else if(r===OPS$7.OP_PUSHDATA2){if(t+3>e.length)return null;n=readUInt16$1(e,t+1,"LE"),s=3}else{if(t+5>e.length)return null;if(r!==OPS$7.OP_PUSHDATA4)throw new Error("Unexpected opcode");n=readUInt32$1(e,t+1,"LE"),s=5}return{opcode:r,number:n,size:s}}function scriptNumSize(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function encode$h(e){let t=Math.abs(e);const r=scriptNumSize(t),n=new Uint8Array(r),s=e<0;for(let a=0;a<r;++a)writeUInt8(n,a,t&255),t>>=8;return n[r-1]&128?writeUInt8(n,r-1,s?128:0):s&&(n[r-1]|=128),n}var store$1;function getGlobalConfig$1(e){return{lang:e?.lang??store$1?.lang,message:e?.message,abortEarly:e?.abortEarly??store$1?.abortEarly,abortPipeEarly:e?.abortPipeEarly??store$1?.abortPipeEarly}}var store2$1;function getGlobalMessage$1(e){return store2$1?.get(e)}var store3$1;function getSchemaMessage$1(e){return store3$1?.get(e)}var store4$1;function getSpecificMessage$1(e,t){return store4$1?.get(e)?.get(t)}function _stringify$1(e){const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function _addIssue$1(e,t,r,n,s){const a=s&&"input"in s?s.input:r.value,l=s?.expected??e.expects??null,u=s?.received??_stringify$1(a),x={kind:e.kind,type:e.type,input:a,expected:l,received:u,message:`Invalid ${t}: ${l?`Expected ${l} but r`:"R"}eceived ${u}`,requirement:e.requirement,path:s?.path,issues:s?.issues,lang:n.lang,abortEarly:n.abortEarly,abortPipeEarly:n.abortPipeEarly},f=e.kind==="schema",p=s?.message??e.message??getSpecificMessage$1(e.reference,x.lang)??(f?getSchemaMessage$1(x.lang):null)??n.message??getGlobalMessage$1(x.lang);p&&(x.message=typeof p=="function"?p(x):p),f&&(r.typed=!1),r.issues?r.issues.push(x):r.issues=[x]}function _joinExpects(e,t){const r=[...new Set(e)];return r.length>1?`(${r.join(` ${t} `)})`:r[0]??"never"}var ValiError$1=class extends Error{issues;constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function everyItem(e,t){return{kind:"validation",type:"every_item",reference:everyItem,async:!1,expects:null,requirement:e,message:t,_run(r,n){return r.typed&&!r.value.every(this.requirement)&&_addIssue$1(this,"item",r,n),r}}}function integer$1(e){return{kind:"validation",type:"integer",reference:integer$1,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(t,r){return t.typed&&!this.requirement(t.value)&&_addIssue$1(this,"integer",t,r),t}}}function length$1(e,t){return{kind:"validation",type:"length",reference:length$1,async:!1,expects:`${e}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value.length!==this.requirement&&_addIssue$1(this,"length",r,n,{received:`${r.value.length}`}),r}}}function maxValue$1(e,t){return{kind:"validation",type:"max_value",reference:maxValue$1,async:!1,expects:`<=${e instanceof Date?e.toJSON():_stringify$1(e)}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value>this.requirement&&_addIssue$1(this,"value",r,n,{received:r.value instanceof Date?r.value.toJSON():_stringify$1(r.value)}),r}}}function minValue$1(e,t){return{kind:"validation",type:"min_value",reference:minValue$1,async:!1,expects:`>=${e instanceof Date?e.toJSON():_stringify$1(e)}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value<this.requirement&&_addIssue$1(this,"value",r,n,{received:r.value instanceof Date?r.value.toJSON():_stringify$1(r.value)}),r}}}function regex$1(e,t){return{kind:"validation",type:"regex",reference:regex$1,async:!1,expects:`${e}`,requirement:e,message:t,_run(r,n){return r.typed&&!this.requirement.test(r.value)&&_addIssue$1(this,"format",r,n),r}}}function getDefault$1(e,t,r){return typeof e.default=="function"?e.default(t,r):e.default}function is(e,t){return!e._run({typed:!1,value:t},{abortEarly:!0}).issues}function any(){return{kind:"schema",type:"any",reference:any,expects:"any",async:!1,_run(e){return e.typed=!0,e}}}function array(e,t){return{kind:"schema",type:"array",reference:array,expects:"Array",async:!1,item:e,message:t,_run(r,n){const s=r.value;if(Array.isArray(s)){r.typed=!0,r.value=[];for(let a=0;a<s.length;a++){const l=s[a],u=this.item._run({typed:!1,value:l},n);if(u.issues){const x={type:"array",origin:"value",input:s,key:a,value:l};for(const f of u.issues)f.path?f.path.unshift(x):f.path=[x],r.issues?.push(f);if(r.issues||(r.issues=u.issues),n.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),r.value.push(u.value)}}else _addIssue$1(this,"type",r,n);return r}}}function bigint(e){return{kind:"schema",type:"bigint",reference:bigint,expects:"bigint",async:!1,message:e,_run(t,r){return typeof t.value=="bigint"?t.typed=!0:_addIssue$1(this,"type",t,r),t}}}function custom(e,t){return{kind:"schema",type:"custom",reference:custom,expects:"unknown",async:!1,check:e,message:t,_run(r,n){return this.check(r.value)?r.typed=!0:_addIssue$1(this,"type",r,n),r}}}function instance$1(e,t){return{kind:"schema",type:"instance",reference:instance$1,expects:e.name,async:!1,class:e,message:t,_run(r,n){return r.value instanceof this.class?r.typed=!0:_addIssue$1(this,"type",r,n),r}}}function nullable(e,...t){const r={kind:"schema",type:"nullable",reference:nullable,expects:`(${e.expects} | null)`,async:!1,wrapped:e,_run(n,s){return n.value===null&&("default"in this&&(n.value=getDefault$1(this,n,s)),n.value===null)?(n.typed=!0,n):this.wrapped._run(n,s)}};return 0 in t&&(r.default=t[0]),r}function nullish(e,...t){const r={kind:"schema",type:"nullish",reference:nullish,expects:`(${e.expects} | null | undefined)`,async:!1,wrapped:e,_run(n,s){return(n.value===null||n.value===void 0)&&("default"in this&&(n.value=getDefault$1(this,n,s)),n.value===null||n.value===void 0)?(n.typed=!0,n):this.wrapped._run(n,s)}};return 0 in t&&(r.default=t[0]),r}function number$1(e){return{kind:"schema",type:"number",reference:number$1,expects:"number",async:!1,message:e,_run(t,r){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:_addIssue$1(this,"type",t,r),t}}}function object$1(e,t){return{kind:"schema",type:"object",reference:object$1,expects:"Object",async:!1,entries:e,message:t,_run(r,n){const s=r.value;if(s&&typeof s=="object"){r.typed=!0,r.value={};for(const a in this.entries){const l=s[a],u=this.entries[a]._run({typed:!1,value:l},n);if(u.issues){const x={type:"object",origin:"value",input:s,key:a,value:l};for(const f of u.issues)f.path?f.path.unshift(x):f.path=[x],r.issues?.push(f);if(r.issues||(r.issues=u.issues),n.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),(u.value!==void 0||a in s)&&(r.value[a]=u.value)}}else _addIssue$1(this,"type",r,n);return r}}}function optional$1(e,...t){const r={kind:"schema",type:"optional",reference:optional$1,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,_run(n,s){return n.value===void 0&&("default"in this&&(n.value=getDefault$1(this,n,s)),n.value===void 0)?(n.typed=!0,n):this.wrapped._run(n,s)}};return 0 in t&&(r.default=t[0]),r}function string$1(e){return{kind:"schema",type:"string",reference:string$1,expects:"string",async:!1,message:e,_run(t,r){return typeof t.value=="string"?t.typed=!0:_addIssue$1(this,"type",t,r),t}}}function tuple(e,t){return{kind:"schema",type:"tuple",reference:tuple,expects:"Array",async:!1,items:e,message:t,_run(r,n){const s=r.value;if(Array.isArray(s)){r.typed=!0,r.value=[];for(let a=0;a<this.items.length;a++){const l=s[a],u=this.items[a]._run({typed:!1,value:l},n);if(u.issues){const x={type:"array",origin:"value",input:s,key:a,value:l};for(const f of u.issues)f.path?f.path.unshift(x):f.path=[x],r.issues?.push(f);if(r.issues||(r.issues=u.issues),n.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),r.value.push(u.value)}}else _addIssue$1(this,"type",r,n);return r}}}function _subIssues$1(e){let t;if(e)for(const r of e)t?t.push(...r.issues):t=r.issues;return t}function union$1(e,t){return{kind:"schema",type:"union",reference:union$1,expects:_joinExpects(e.map(r=>r.expects),"|"),async:!1,options:e,message:t,_run(r,n){let s,a,l;for(const u of this.options){const x=u._run({typed:!1,value:r.value},n);if(x.typed)if(x.issues)a?a.push(x):a=[x];else{s=x;break}else l?l.push(x):l=[x]}if(s)return s;if(a){if(a.length===1)return a[0];_addIssue$1(this,"type",r,n,{issues:_subIssues$1(a)}),r.typed=!0}else{if(l?.length===1)return l[0];_addIssue$1(this,"type",r,n,{issues:_subIssues$1(l)})}return r}}}function parse$1(e,t,r){const n=e._run({typed:!1,value:t},getGlobalConfig$1(r));if(n.issues)throw new ValiError$1(n.issues);return n.value}function partial(e,t){const r={};for(const n in e.entries)r[n]=optional$1(e.entries[n]);return{...e,entries:r}}function pipe$1(...e){return{...e[0],pipe:e,_run(t,r){for(const n of e)if(n.kind!=="metadata"){if(t.issues&&(n.kind==="schema"||n.kind==="transformation")){t.typed=!1;break}(!t.issues||!r.abortEarly&&!r.abortPipeEarly)&&(t=n._run(t,r))}return t}}}const ZERO32=new Uint8Array(32),EC_P=fromHex("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),NBufferSchemaFactory=e=>pipe$1(instance$1(Uint8Array),length$1(e));function stacksEqual(e,t){return e.length!==t.length?!1:e.every((r,n)=>compare(r,t[n])===0)}function isPoint(e){if(!(e instanceof Uint8Array)||e.length<33)return!1;const t=e[0],r=e.slice(1,33);if(compare(ZERO32,r)===0||compare(r,EC_P)>=0)return!1;if((t===2||t===3)&&e.length===33)return!0;const n=e.slice(33);return compare(ZERO32,n)===0||compare(n,EC_P)>=0?!1:t===4&&e.length===65}const TAPLEAF_VERSION_MASK=254;function isTapleaf(e){return!e||!("output"in e)||!(e.output instanceof Uint8Array)?!1:e.version!==void 0?(e.version&TAPLEAF_VERSION_MASK)===e.version:!0}function isTaptree(e){return Array.isArray(e)?e.length!==2?!1:e.every(t=>isTaptree(t)):isTapleaf(e)}const Buffer256bitSchema=NBufferSchemaFactory(32),Hash160bitSchema=NBufferSchemaFactory(20),Hash256bitSchema=NBufferSchemaFactory(32),BufferSchema=instance$1(Uint8Array);pipe$1(string$1(),regex$1(/^([0-9a-f]{2})+$/i));const UInt8Schema=pipe$1(number$1(),integer$1(),minValue$1(0),maxValue$1(255)),UInt32Schema=pipe$1(number$1(),integer$1(),minValue$1(0),maxValue$1(4294967295)),SatoshiSchema=pipe$1(bigint(),minValue$1(0n),maxValue$1(0x7fffffffffffffffn)),NullablePartial=e=>object$1(Object.entries(e).reduce((t,r)=>({...t,[r[0]]:nullish(r[1])}),{})),ZERO$1=new Uint8Array(1);function toDER(e){let t=0;for(;e[t]===0;)++t;return t===e.length?ZERO$1:(e=e.slice(t),e[0]&128?concat$1([ZERO$1,e]):e)}function fromDER(e){e[0]===0&&(e=e.slice(1));const t=new Uint8Array(32),r=Math.max(0,32-e.length);return t.set(e,r),t}function decode$g(e){const t=readUInt8(e,e.length-1);if(!isDefinedHashType(t))throw new Error("Invalid hashType "+t);const r=decode$i(e.subarray(0,-1)),n=fromDER(r.r),s=fromDER(r.s);return{signature:concat$1([n,s]),hashType:t}}function encode$g(e,t){if(parse$1(object$1({signature:NBufferSchemaFactory(64),hashType:UInt8Schema}),{signature:e,hashType:t}),!isDefinedHashType(t))throw new Error("Invalid hashType "+t);const r=new Uint8Array(1);writeUInt8(r,0,t);const n=toDER(e.slice(0,32)),s=toDER(e.slice(32,64));return concat$1([encode$j(n,s),r])}const scriptSignature=Object.freeze(Object.defineProperty({__proto__:null,decode:decode$g,encode:encode$g},Symbol.toStringTag,{value:"Module"})),OP_INT_BASE$1=OPS$7.OP_RESERVED,StackSchema=array(union$1([instance$1(Uint8Array),number$1()]));function isOPInt(e){return is(number$1(),e)&&(e===OPS$7.OP_0||e>=OPS$7.OP_1&&e<=OPS$7.OP_16||e===OPS$7.OP_1NEGATE)}function isPushOnlyChunk(e){return is(BufferSchema,e)||isOPInt(e)}function isPushOnly(e){return is(pipe$1(any(),everyItem(isPushOnlyChunk)),e)}function countNonPushOnlyOPs(e){return e.length-e.filter(isPushOnlyChunk).length}function asMinimalOP(e){if(e.length===0)return OPS$7.OP_0;if(e.length===1){if(e[0]>=1&&e[0]<=16)return OP_INT_BASE$1+e[0];if(e[0]===129)return OPS$7.OP_1NEGATE}}function chunksIsBuffer(e){return e instanceof Uint8Array}function chunksIsArray(e){return is(StackSchema,e)}function singleChunkIsBuffer(e){return e instanceof Uint8Array}function compile(e){if(chunksIsBuffer(e))return e;parse$1(StackSchema,e);const t=e.reduce((s,a)=>singleChunkIsBuffer(a)?a.length===1&&asMinimalOP(a)!==void 0?s+1:s+encodingLength$1(a.length)+a.length:s+1,0),r=new Uint8Array(t);let n=0;if(e.forEach(s=>{if(singleChunkIsBuffer(s)){const a=asMinimalOP(s);if(a!==void 0){writeUInt8(r,n,a),n+=1;return}n+=encode$i(r,s.length,n),r.set(s,n),n+=s.length}else writeUInt8(r,n,s),n+=1}),n!==r.length)throw new Error("Could not decode chunks");return r}function decompile(e){if(chunksIsArray(e))return e;parse$1(BufferSchema,e);const t=[];let r=0;for(;r<e.length;){const n=e[r];if(n>OPS$7.OP_0&&n<=OPS$7.OP_PUSHDATA4){const s=decode$h(e,r);if(s===null||(r+=s.size,r+s.number>e.length))return null;const a=e.slice(r,r+s.number);r+=s.number;const l=asMinimalOP(a);l!==void 0?t.push(l):t.push(a)}else t.push(n),r+=1}return t}function toASM(e){if(chunksIsBuffer(e)&&(e=decompile(e)),!e)throw new Error("Could not convert invalid chunks to ASM");return e.map(t=>{if(singleChunkIsBuffer(t)){const r=asMinimalOP(t);if(r===void 0)return toHex(t);t=r}return OPS$7[t]}).join(" ")}function toStack(e){return e=decompile(e),parse$1(custom(isPushOnly),e),e.map(t=>singleChunkIsBuffer(t)?t:t===OPS$7.OP_0?new Uint8Array(0):encode$h(t-OP_INT_BASE$1))}function isCanonicalPubKey(e){return isPoint(e)}function isDefinedHashType(e){const t=e&-129;return t>0&&t<4}function isCanonicalScriptSignature(e){return!(e instanceof Uint8Array)||!isDefinedHashType(e[e.length-1])?!1:check$d(e.slice(0,-1))}const signature=scriptSignature;function prop(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){const n=r.call(this);return this[t]=n,n},set(n){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:n,writable:!0})}})}function value(e){let t;return()=>(t!==void 0||(t=e()),t)}const OPS$6=OPS$7,OP_INT_BASE=OPS$6.OP_RESERVED;function p2ms(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&e.m!==void 0)&&!e.signatures)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{});function r(x){return isCanonicalScriptSignature(x)||(t.allowIncomplete&&x===OPS$6.OP_0)!==void 0}parse$1(partial(object$1({network:object$1({}),m:number$1(),n:number$1(),output:BufferSchema,pubkeys:array(custom(isPoint),"Received invalid pubkey"),signatures:array(custom(r),"Expected signature to be of type isAcceptableSignature"),input:BufferSchema})),e);const s={network:e.network||bitcoin$1};let a=[],l=!1;function u(x){l||(l=!0,a=decompile(x),s.m=a[0]-OP_INT_BASE,s.n=a[a.length-2]-OP_INT_BASE,s.pubkeys=a.slice(1,-2))}if(prop(s,"output",()=>{if(e.m&&s.n&&e.pubkeys)return compile([].concat(OP_INT_BASE+e.m,e.pubkeys,OP_INT_BASE+s.n,OPS$6.OP_CHECKMULTISIG))}),prop(s,"m",()=>{if(s.output)return u(s.output),s.m}),prop(s,"n",()=>{if(s.pubkeys)return s.pubkeys.length}),prop(s,"pubkeys",()=>{if(e.output)return u(e.output),s.pubkeys}),prop(s,"signatures",()=>{if(e.input)return decompile(e.input).slice(1)}),prop(s,"input",()=>{if(e.signatures)return compile([OPS$6.OP_0].concat(e.signatures))}),prop(s,"witness",()=>{if(s.input)return[]}),prop(s,"name",()=>{if(!(!s.m||!s.n))return`p2ms(${s.m} of ${s.n})`}),t.validate){if(e.output){if(u(e.output),parse$1(number$1(),a[0],{message:"Output is invalid"}),parse$1(number$1(),a[a.length-2],{message:"Output is invalid"}),a[a.length-1]!==OPS$6.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(s.m<=0||s.n>16||s.m>s.n||s.n!==a.length-3)throw new TypeError("Output is invalid");if(!s.pubkeys.every(x=>isPoint(x)))throw new TypeError("Output is invalid");if(e.m!==void 0&&e.m!==s.m)throw new TypeError("m mismatch");if(e.n!==void 0&&e.n!==s.n)throw new TypeError("n mismatch");if(e.pubkeys&&!stacksEqual(e.pubkeys,s.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(e.n!==void 0&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(s.n=e.pubkeys.length,s.n<s.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<s.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>s.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==OPS$6.OP_0)throw new TypeError("Input is invalid");if(s.signatures.length===0||!s.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!stacksEqual(e.signatures,s.signatures))throw new TypeError("Signature mismatch");if(e.m!==void 0&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(s,e)}const OPS$5=OPS$7;function p2pk(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),output:BufferSchema,pubkey:custom(isPoint,"invalid pubkey"),signature:custom(isCanonicalScriptSignature,"Expected signature to be of type isCanonicalScriptSignature"),input:BufferSchema})),e);const r=value(()=>decompile(e.input)),s={name:"p2pk",network:e.network||bitcoin$1};if(prop(s,"output",()=>{if(e.pubkey)return compile([e.pubkey,OPS$5.OP_CHECKSIG])}),prop(s,"pubkey",()=>{if(e.output)return e.output.slice(1,-1)}),prop(s,"signature",()=>{if(e.input)return r()[0]}),prop(s,"input",()=>{if(e.signature)return compile([e.signature])}),prop(s,"witness",()=>{if(s.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==OPS$5.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!isPoint(s.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&compare(e.pubkey,s.pubkey)!==0)throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&compare(e.input,s.input)!==0)throw new TypeError("Signature mismatch");if(e.input){if(r().length!==1)throw new TypeError("Input is invalid");if(!isCanonicalScriptSignature(s.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(s,e)}const ripemd160=ripemd160$2;function hash160(e){return ripemd160(sha256$5(e))}function hash256(e){return sha256$5(sha256$5(e))}const TAGGED_HASH_PREFIXES={"BIP0340/challenge":Uint8Array.from([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":Uint8Array.from([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":Uint8Array.from([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:Uint8Array.from([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:Uint8Array.from([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:Uint8Array.from([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:Uint8Array.from([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":Uint8Array.from([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":Uint8Array.from([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])};function taggedHash(e,t){return sha256$5(concat$1([TAGGED_HASH_PREFIXES[e],t]))}function base(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let f=0;f<t.length;f++)t[f]=255;for(let f=0;f<e.length;f++){const p=e.charAt(f),g=p.charCodeAt(0);if(t[g]!==255)throw new TypeError(p+" is ambiguous");t[g]=f}const r=e.length,n=e.charAt(0),s=Math.log(r)/Math.log(256),a=Math.log(256)/Math.log(r);function l(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";let p=0,g=0,y=0;const w=f.length;for(;y!==w&&f[y]===0;)y++,p++;const R=(w-y)*a+1>>>0,I=new Uint8Array(R);for(;y!==w;){let Ve=f[y],q=0;for(let $e=R-1;(Ve!==0||q<g)&&$e!==-1;$e--,q++)Ve+=256*I[$e]>>>0,I[$e]=Ve%r>>>0,Ve=Ve/r>>>0;if(Ve!==0)throw new Error("Non-zero carry");g=q,y++}let k=R-g;for(;k!==R&&I[k]===0;)k++;let je=n.repeat(p);for(;k<R;++k)je+=e.charAt(I[k]);return je}function u(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;let p=0,g=0,y=0;for(;f[p]===n;)g++,p++;const w=(f.length-p)*s+1>>>0,R=new Uint8Array(w);for(;p<f.length;){const Ve=f.charCodeAt(p);if(Ve>255)return;let q=t[Ve];if(q===255)return;let $e=0;for(let We=w-1;(q!==0||$e<y)&&We!==-1;We--,$e++)q+=r*R[We]>>>0,R[We]=q%256>>>0,q=q/256>>>0;if(q!==0)throw new Error("Non-zero carry");y=$e,p++}let I=w-y;for(;I!==w&&R[I]===0;)I++;const k=new Uint8Array(g+(w-I));let je=g;for(;I!==w;)k[je++]=R[I++];return k}function x(f){const p=u(f);if(p)return p;throw new Error("Non-base"+r+" character")}return{encode:l,decodeUnsafe:u,decode:x}}var ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const base58=base(ALPHABET);function bs58checkBase(e){function t(a){var l=Uint8Array.from(a),u=e(l),x=l.length+4,f=new Uint8Array(x);return f.set(l,0),f.set(u.subarray(0,4),l.length),base58.encode(f)}function r(a){var l=a.slice(0,-4),u=a.slice(-4),x=e(l);if(!(u[0]^x[0]|u[1]^x[1]|u[2]^x[2]|u[3]^x[3]))return l}function n(a){var l=base58.decodeUnsafe(a);if(l!=null)return r(l)}function s(a){var l=base58.decode(a),u=r(l);if(u==null)throw new Error("Invalid checksum");return u}return{encode:t,decode:s,decodeUnsafe:n}}function sha256x2(e){return sha256$5(sha256$5(e))}const bs58Check=bs58checkBase(sha256x2),OPS$4=OPS$7;function p2pkh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),address:string$1(),hash:Hash160bitSchema,output:NBufferSchemaFactory(25),pubkey:custom(isPoint),signature:custom(isCanonicalScriptSignature),input:BufferSchema})),e);const r=value(()=>{const l=bs58Check.decode(e.address),u=readUInt8(l,0),x=l.slice(1);return{version:u,hash:x}}),n=value(()=>decompile(e.input)),s=e.network||bitcoin$1,a={name:"p2pkh",network:s};if(prop(a,"address",()=>{if(!a.hash)return;const l=new Uint8Array(21);return writeUInt8(l,0,s.pubKeyHash),l.set(a.hash,1),bs58Check.encode(l)}),prop(a,"hash",()=>{if(e.output)return e.output.slice(3,23);if(e.address)return r().hash;if(e.pubkey||a.pubkey)return hash160(e.pubkey||a.pubkey)}),prop(a,"output",()=>{if(a.hash)return compile([OPS$4.OP_DUP,OPS$4.OP_HASH160,a.hash,OPS$4.OP_EQUALVERIFY,OPS$4.OP_CHECKSIG])}),prop(a,"pubkey",()=>{if(e.input)return n()[1]}),prop(a,"signature",()=>{if(e.input)return n()[0]}),prop(a,"input",()=>{if(e.pubkey&&e.signature)return compile([e.signature,e.pubkey])}),prop(a,"witness",()=>{if(a.input)return[]}),t.validate){let l=Uint8Array.from([]);if(e.address){if(r().version!==s.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(r().hash.length!==20)throw new TypeError("Invalid address");l=r().hash}if(e.hash){if(l.length>0&&compare(l,e.hash)!==0)throw new TypeError("Hash mismatch");l=e.hash}if(e.output){if(e.output.length!==25||e.output[0]!==OPS$4.OP_DUP||e.output[1]!==OPS$4.OP_HASH160||e.output[2]!==20||e.output[23]!==OPS$4.OP_EQUALVERIFY||e.output[24]!==OPS$4.OP_CHECKSIG)throw new TypeError("Output is invalid");const u=e.output.slice(3,23);if(l.length>0&&compare(l,u)!==0)throw new TypeError("Hash mismatch");l=u}if(e.pubkey){const u=hash160(e.pubkey);if(l.length>0&&compare(l,u)!==0)throw new TypeError("Hash mismatch");l=u}if(e.input){const u=n();if(u.length!==2)throw new TypeError("Input is invalid");if(!isCanonicalScriptSignature(u[0]))throw new TypeError("Input has invalid signature");if(!isPoint(u[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&compare(e.signature,u[0])!==0)throw new TypeError("Signature mismatch");if(e.pubkey&&compare(e.pubkey,u[1])!==0)throw new TypeError("Pubkey mismatch");const x=hash160(u[1]);if(l.length>0&&compare(l,x)!==0)throw new TypeError("Hash mismatch")}}return Object.assign(a,e)}const OPS$3=OPS$7;function p2sh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),address:string$1(),hash:NBufferSchemaFactory(20),output:NBufferSchemaFactory(23),redeem:partial(object$1({network:object$1({}),output:BufferSchema,input:BufferSchema,witness:array(BufferSchema)})),input:BufferSchema,witness:array(BufferSchema)})),e);let r=e.network;r||(r=e.redeem&&e.redeem.network||bitcoin$1);const n={network:r},s=value(()=>{const u=bs58Check.decode(e.address),x=readUInt8(u,0),f=u.slice(1);return{version:x,hash:f}}),a=value(()=>decompile(e.input)),l=value(()=>{const u=a(),x=u[u.length-1];return{network:r,output:x===OPS$3.OP_FALSE?Uint8Array.from([]):x,input:compile(u.slice(0,-1)),witness:e.witness||[]}});if(prop(n,"address",()=>{if(!n.hash)return;const u=new Uint8Array(21);return writeUInt8(u,0,n.network.scriptHash),u.set(n.hash,1),bs58Check.encode(u)}),prop(n,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return s().hash;if(n.redeem&&n.redeem.output)return hash160(n.redeem.output)}),prop(n,"output",()=>{if(n.hash)return compile([OPS$3.OP_HASH160,n.hash,OPS$3.OP_EQUAL])}),prop(n,"redeem",()=>{if(e.input)return l()}),prop(n,"input",()=>{if(!(!e.redeem||!e.redeem.input||!e.redeem.output))return compile([].concat(decompile(e.redeem.input),e.redeem.output))}),prop(n,"witness",()=>{if(n.redeem&&n.redeem.witness)return n.redeem.witness;if(n.input)return[]}),prop(n,"name",()=>{const u=["p2sh"];return n.redeem!==void 0&&n.redeem.name!==void 0&&u.push(n.redeem.name),u.join("-")}),t.validate){let u=Uint8Array.from([]);if(e.address){if(s().version!==r.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(s().hash.length!==20)throw new TypeError("Invalid address");u=s().hash}if(e.hash){if(u.length>0&&compare(u,e.hash)!==0)throw new TypeError("Hash mismatch");u=e.hash}if(e.output){if(e.output.length!==23||e.output[0]!==OPS$3.OP_HASH160||e.output[1]!==20||e.output[22]!==OPS$3.OP_EQUAL)throw new TypeError("Output is invalid");const f=e.output.slice(2,22);if(u.length>0&&compare(u,f)!==0)throw new TypeError("Hash mismatch");u=f}const x=f=>{if(f.output){const p=decompile(f.output);if(!p||p.length<1)throw new TypeError("Redeem.output too short");if(f.output.byteLength>520)throw new TypeError("Redeem.output unspendable if larger than 520 bytes");if(countNonPushOnlyOPs(p)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const g=hash160(f.output);if(u.length>0&&compare(u,g)!==0)throw new TypeError("Hash mismatch");u=g}if(f.input){const p=f.input.length>0,g=f.witness&&f.witness.length>0;if(!p&&!g)throw new TypeError("Empty input");if(p&&g)throw new TypeError("Input and witness provided");if(p){const y=decompile(f.input);if(!isPushOnly(y))throw new TypeError("Non push-only scriptSig")}}};if(e.input){const f=a();if(!f||f.length<1)throw new TypeError("Input too short");if(!(l().output instanceof Uint8Array))throw new TypeError("Input is invalid");x(l())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==r)throw new TypeError("Network mismatch");if(e.input){const f=l();if(e.redeem.output&&compare(e.redeem.output,f.output)!==0)throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&compare(e.redeem.input,f.input)!==0)throw new TypeError("Redeem.input mismatch")}x(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!stacksEqual(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(n,e)}var dist$1={},hasRequiredDist$1;function requireDist$1(){if(hasRequiredDist$1)return dist$1;hasRequiredDist$1=1,Object.defineProperty(dist$1,"__esModule",{value:!0}),dist$1.bech32m=dist$1.bech32=void 0;const e="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={};for(let f=0;f<e.length;f++){const p=e.charAt(f);t[p]=f}function r(f){const p=f>>25;return(f&33554431)<<5^-(p>>0&1)&996825010^-(p>>1&1)&642813549^-(p>>2&1)&513874426^-(p>>3&1)&1027748829^-(p>>4&1)&705979059}function n(f){let p=1;for(let g=0;g<f.length;++g){const y=f.charCodeAt(g);if(y<33||y>126)return"Invalid prefix ("+f+")";p=r(p)^y>>5}p=r(p);for(let g=0;g<f.length;++g){const y=f.charCodeAt(g);p=r(p)^y&31}return p}function s(f,p,g,y){let w=0,R=0;const I=(1<<g)-1,k=[];for(let je=0;je<f.length;++je)for(w=w<<p|f[je],R+=p;R>=g;)R-=g,k.push(w>>R&I);if(y)R>0&&k.push(w<<g-R&I);else{if(R>=p)return"Excess padding";if(w<<g-R&I)return"Non-zero padding"}return k}function a(f){return s(f,8,5,!0)}function l(f){const p=s(f,5,8,!1);if(Array.isArray(p))return p}function u(f){const p=s(f,5,8,!1);if(Array.isArray(p))return p;throw new Error(p)}function x(f){let p;f==="bech32"?p=1:p=734539939;function g(I,k,je){if(je=je||90,I.length+7+k.length>je)throw new TypeError("Exceeds length limit");I=I.toLowerCase();let Ve=n(I);if(typeof Ve=="string")throw new Error(Ve);let q=I+"1";for(let $e=0;$e<k.length;++$e){const We=k[$e];if(We>>5!==0)throw new Error("Non 5-bit word");Ve=r(Ve)^We,q+=e.charAt(We)}for(let $e=0;$e<6;++$e)Ve=r(Ve);Ve^=p;for(let $e=0;$e<6;++$e){const We=Ve>>(5-$e)*5&31;q+=e.charAt(We)}return q}function y(I,k){if(k=k||90,I.length<8)return I+" too short";if(I.length>k)return"Exceeds length limit";const je=I.toLowerCase(),Ve=I.toUpperCase();if(I!==je&&I!==Ve)return"Mixed-case string "+I;I=je;const q=I.lastIndexOf("1");if(q===-1)return"No separator character for "+I;if(q===0)return"Missing prefix for "+I;const $e=I.slice(0,q),We=I.slice(q+1);if(We.length<6)return"Data too short";let K=n($e);if(typeof K=="string")return K;const W=[];for(let Ye=0;Ye<We.length;++Ye){const Qe=We.charAt(Ye),it=t[Qe];if(it===void 0)return"Unknown character "+Qe;K=r(K)^it,!(Ye+6>=We.length)&&W.push(it)}return K!==p?"Invalid checksum for "+I:{prefix:$e,words:W}}function w(I,k){const je=y(I,k);if(typeof je=="object")return je}function R(I,k){const je=y(I,k);if(typeof je=="object")return je;throw new Error(je)}return{decodeUnsafe:w,decode:R,encode:g,toWords:a,fromWordsUnsafe:l,fromWords:u}}return dist$1.bech32=x("bech32"),dist$1.bech32m=x("bech32m"),dist$1}var distExports$1=requireDist$1();const OPS$2=OPS$7,EMPTY_BUFFER$2=new Uint8Array(0);function p2wpkh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({address:string$1(),hash:NBufferSchemaFactory(20),input:NBufferSchemaFactory(0),network:object$1({}),output:NBufferSchemaFactory(22),pubkey:custom(isPoint,"Not a valid pubkey"),signature:custom(isCanonicalScriptSignature),witness:array(BufferSchema)})),e);const r=value(()=>{const a=distExports$1.bech32.decode(e.address),l=a.words.shift(),u=distExports$1.bech32.fromWords(a.words);return{version:l,prefix:a.prefix,data:Uint8Array.from(u)}}),n=e.network||bitcoin$1,s={name:"p2wpkh",network:n};if(prop(s,"address",()=>{if(!s.hash)return;const a=distExports$1.bech32.toWords(s.hash);return a.unshift(0),distExports$1.bech32.encode(n.bech32,a)}),prop(s,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return r().data;if(e.pubkey||s.pubkey)return hash160(e.pubkey||s.pubkey)}),prop(s,"output",()=>{if(s.hash)return compile([OPS$2.OP_0,s.hash])}),prop(s,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.witness)return e.witness[1]}),prop(s,"signature",()=>{if(e.witness)return e.witness[0]}),prop(s,"input",()=>{if(s.witness)return EMPTY_BUFFER$2}),prop(s,"witness",()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]}),t.validate){let a=Uint8Array.from([]);if(e.address){if(n&&n.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==20)throw new TypeError("Invalid address data");a=r().data}if(e.hash){if(a.length>0&&compare(a,e.hash)!==0)throw new TypeError("Hash mismatch");a=e.hash}if(e.output){if(e.output.length!==22||e.output[0]!==OPS$2.OP_0||e.output[1]!==20)throw new TypeError("Output is invalid");if(a.length>0&&compare(a,e.output.slice(2))!==0)throw new TypeError("Hash mismatch");a=e.output.slice(2)}if(e.pubkey){const l=hash160(e.pubkey);if(a.length>0&&compare(a,l)!==0)throw new TypeError("Hash mismatch");if(a=l,!isPoint(e.pubkey)||e.pubkey.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(e.witness.length!==2)throw new TypeError("Witness is invalid");if(!isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!isPoint(e.witness[1])||e.witness[1].length!==33)throw new TypeError("Witness has invalid pubkey");if(e.signature&&compare(e.signature,e.witness[0])!==0)throw new TypeError("Signature mismatch");if(e.pubkey&&compare(e.pubkey,e.witness[1])!==0)throw new TypeError("Pubkey mismatch");const l=hash160(e.witness[1]);if(a.length>0&&compare(a,l)!==0)throw new TypeError("Hash mismatch")}}return Object.assign(s,e)}const OPS$1=OPS$7,EMPTY_BUFFER$1=new Uint8Array(0);function chunkHasUncompressedPubkey(e){return!!(e instanceof Uint8Array&&e.length===65&&e[0]===4&&isPoint(e))}function p2wsh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(NullablePartial({network:object$1({}),address:string$1(),hash:Buffer256bitSchema,output:NBufferSchemaFactory(34),redeem:NullablePartial({input:BufferSchema,network:object$1({}),output:BufferSchema,witness:array(BufferSchema)}),input:NBufferSchemaFactory(0),witness:array(BufferSchema)}),e);const r=value(()=>{const l=distExports$1.bech32.decode(e.address),u=l.words.shift(),x=distExports$1.bech32.fromWords(l.words);return{version:u,prefix:l.prefix,data:Uint8Array.from(x)}}),n=value(()=>decompile(e.redeem.input));let s=e.network;s||(s=e.redeem&&e.redeem.network||bitcoin$1);const a={network:s};if(prop(a,"address",()=>{if(!a.hash)return;const l=distExports$1.bech32.toWords(a.hash);return l.unshift(0),distExports$1.bech32.encode(s.bech32,l)}),prop(a,"hash",()=>{if(e.output)return e.output.slice(2);if(e.address)return r().data;if(a.redeem&&a.redeem.output)return sha256$5(a.redeem.output)}),prop(a,"output",()=>{if(a.hash)return compile([OPS$1.OP_0,a.hash])}),prop(a,"redeem",()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:EMPTY_BUFFER$1,witness:e.witness.slice(0,-1)}}),prop(a,"input",()=>{if(a.witness)return EMPTY_BUFFER$1}),prop(a,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){const l=toStack(n());return a.redeem=Object.assign({witness:l},e.redeem),a.redeem.input=EMPTY_BUFFER$1,[].concat(l,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),prop(a,"name",()=>{const l=["p2wsh"];return a.redeem!==void 0&&a.redeem.name!==void 0&&l.push(a.redeem.name),l.join("-")}),t.validate){let l=Uint8Array.from([]);if(e.address){if(r().prefix!==s.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");l=r().data}if(e.hash){if(l.length>0&&compare(l,e.hash)!==0)throw new TypeError("Hash mismatch");l=e.hash}if(e.output){if(e.output.length!==34||e.output[0]!==OPS$1.OP_0||e.output[1]!==32)throw new TypeError("Output is invalid");const u=e.output.slice(2);if(l.length>0&&compare(l,u)!==0)throw new TypeError("Hash mismatch");l=u}if(e.redeem){if(e.redeem.network&&e.redeem.network!==s)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){const u=decompile(e.redeem.output);if(!u||u.length<1)throw new TypeError("Redeem.output is invalid");if(e.redeem.output.byteLength>3600)throw new TypeError("Redeem.output unspendable if larger than 3600 bytes");if(countNonPushOnlyOPs(u)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const x=sha256$5(e.redeem.output);if(l.length>0&&compare(l,x)!==0)throw new TypeError("Hash mismatch");l=x}if(e.redeem.input&&!isPushOnly(n()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!stacksEqual(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&n().some(chunkHasUncompressedPubkey)||e.redeem.output&&(decompile(e.redeem.output)||[]).some(chunkHasUncompressedPubkey))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){const u=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&compare(e.redeem.output,u)!==0)throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(chunkHasUncompressedPubkey)||(decompile(u)||[]).some(chunkHasUncompressedPubkey))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(a,e)}const _ECCLIB_CACHE={};function initEccLib(e,t){e?e!==_ECCLIB_CACHE.eccLib&&(verifyEcc(e),_ECCLIB_CACHE.eccLib=e):_ECCLIB_CACHE.eccLib=e}function getEccLib(){if(!_ECCLIB_CACHE.eccLib)throw new Error("No ECC Library provided. You must call initEccLib() with a valid TinySecp256k1Interface instance");return _ECCLIB_CACHE.eccLib}const h$1=e=>fromHex(e);function verifyEcc(e){assert$1(typeof e.isXOnlyPoint=="function"),assert$1(e.isXOnlyPoint(h$1("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert$1(e.isXOnlyPoint(h$1("fffffffffffffffffffffffffffffffffffffffffffffffffffffffeeffffc2e"))),assert$1(e.isXOnlyPoint(h$1("f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9"))),assert$1(e.isXOnlyPoint(h$1("0000000000000000000000000000000000000000000000000000000000000001"))),assert$1(!e.isXOnlyPoint(h$1("0000000000000000000000000000000000000000000000000000000000000000"))),assert$1(!e.isXOnlyPoint(h$1("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"))),assert$1(typeof e.xOnlyPointAddTweak=="function"),tweakAddVectors.forEach(t=>{const r=e.xOnlyPointAddTweak(h$1(t.pubkey),h$1(t.tweak));t.result===null?assert$1(r===null):(assert$1(r!==null),assert$1(r.parity===t.parity),assert$1(compare(r.xOnlyPubkey,h$1(t.result))===0))})}function assert$1(e){if(!e)throw new Error("ecc library invalid")}const tweakAddVectors=[{pubkey:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",tweak:"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140",parity:-1,result:null},{pubkey:"1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b",tweak:"a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac",parity:1,result:"e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"},{pubkey:"2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",tweak:"823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47",parity:0,result:"9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"}],HEX_STRINGS$1="0123456789abcdefABCDEF";HEX_STRINGS$1.split("").map(e=>e.codePointAt(0));Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=HEX_STRINGS$1.indexOf(r);return n<0?void 0:n<16?n:n-6});new TextEncoder;new TextDecoder;function writeUInt16(e,t,r,n){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>65535)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${r}`);n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255):(e[t]=r>>8&255,e[t+1]=r&255)}function writeUInt32$1(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${r}`);n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255)}function writeUInt64(e,t,r,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>0xffffffffffffffffn)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${r}`);n==="LE"?(e[t]=Number(r&0xffn),e[t+1]=Number(r>>8n&0xffn),e[t+2]=Number(r>>16n&0xffn),e[t+3]=Number(r>>24n&0xffn),e[t+4]=Number(r>>32n&0xffn),e[t+5]=Number(r>>40n&0xffn),e[t+6]=Number(r>>48n&0xffn),e[t+7]=Number(r>>56n&0xffn)):(e[t]=Number(r>>56n&0xffn),e[t+1]=Number(r>>48n&0xffn),e[t+2]=Number(r>>40n&0xffn),e[t+3]=Number(r>>32n&0xffn),e[t+4]=Number(r>>24n&0xffn),e[t+5]=Number(r>>16n&0xffn),e[t+6]=Number(r>>8n&0xffn),e[t+7]=Number(r&0xffn))}function readUInt16(e,t,r){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+1],n=(n<<8)+e[t],n}else{let n=0;return n=(n<<8)+e[t],n=(n<<8)+e[t+1],n}}function readUInt32(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+3]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t]>>>0,n}else{let n=0;return n=(n<<8)+e[t]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+3]>>>0,n}}function readUInt64(e,t,r){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0n;return n=(n<<8n)+BigInt(e[t+7]),n=(n<<8n)+BigInt(e[t+6]),n=(n<<8n)+BigInt(e[t+5]),n=(n<<8n)+BigInt(e[t+4]),n=(n<<8n)+BigInt(e[t+3]),n=(n<<8n)+BigInt(e[t+2]),n=(n<<8n)+BigInt(e[t+1]),n=(n<<8n)+BigInt(e[t]),n}else{let n=0n;return n=(n<<8n)+BigInt(e[t]),n=(n<<8n)+BigInt(e[t+1]),n=(n<<8n)+BigInt(e[t+2]),n=(n<<8n)+BigInt(e[t+3]),n=(n<<8n)+BigInt(e[t+4]),n=(n<<8n)+BigInt(e[t+5]),n=(n<<8n)+BigInt(e[t+6]),n=(n<<8n)+BigInt(e[t+7]),n}}const checkUInt64=e=>{if(e<0||e>0xffffffffffffffffn)throw new RangeError("value out of range")};function checkUInt53(e){if(e<0||e>Number.MAX_SAFE_INTEGER||e%1!==0)throw new RangeError("value out of range")}function checkUint53OrUint64(e){typeof e=="number"?checkUInt53(e):checkUInt64(e)}function encode$f(e,t,r){checkUint53OrUint64(e),r===void 0&&(r=0),t===void 0&&(t=new Uint8Array(encodingLength(e)));let n=0;return e<253?(t.set([Number(e)],r),n=1):e<=65535?(t.set([253],r),writeUInt16(t,r+1,Number(e),"LE"),n=3):e<=4294967295?(t.set([254],r),writeUInt32$1(t,r+1,Number(e),"LE"),n=5):(t.set([255],r),writeUInt64(t,r+1,BigInt(e),"LE"),n=9),{buffer:t,bytes:n}}function decode$f(e,t){t===void 0&&(t=0);const r=e.at(t);if(r===void 0)throw new Error("buffer too small");if(r<253)return{numberValue:r,bigintValue:BigInt(r),bytes:1};if(r===253){const n=readUInt16(e,t+1,"LE");return{numberValue:n,bigintValue:BigInt(n),bytes:3}}else if(r===254){const n=readUInt32(e,t+1,"LE");return{numberValue:n,bigintValue:BigInt(n),bytes:5}}else{const n=readUInt64(e,t+1,"LE");return{numberValue:n<=Number.MAX_SAFE_INTEGER?Number(n):null,bigintValue:n,bytes:9}}}function encodingLength(e){return checkUint53OrUint64(e),e<253?1:e<=65535?3:e<=4294967295?5:9}const MAX_JS_NUMBER=9007199254740991;function verifuint(e,t){if(typeof e!="number"&&typeof e!="bigint")throw new Error("cannot write a non-number as a number");if(e<0&&e<BigInt(0))throw new Error("specified a negative value for writing an unsigned value");if(e>t&&e>BigInt(t))throw new Error("RangeError: value out of range");if(Math.floor(Number(e))!==Number(e))throw new Error("value has a fractional component")}function reverseBuffer(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}function cloneBuffer(e){const t=new Uint8Array(e.length);return t.set(e),t}class BufferWriter{buffer;offset;static withCapacity(t){return new BufferWriter(new Uint8Array(t))}constructor(t,r=0){this.buffer=t,this.offset=r,parse$1(tuple([BufferSchema,UInt32Schema]),[t,r])}writeUInt8(t){this.offset=writeUInt8(this.buffer,this.offset,t)}writeInt32(t){this.offset=writeInt32(this.buffer,this.offset,t,"LE")}writeInt64(t){this.offset=writeInt64(this.buffer,this.offset,BigInt(t),"LE")}writeUInt32(t){this.offset=writeUInt32$2(this.buffer,this.offset,t,"LE")}writeUInt64(t){this.offset=writeUInt64$1(this.buffer,this.offset,BigInt(t),"LE")}writeVarInt(t){const{bytes:r}=encode$f(t,this.buffer,this.offset);this.offset+=r}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw new Error("Cannot write slice out of bounds");this.buffer.set(t,this.offset),this.offset+=t.length}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(r=>this.writeVarSlice(r))}end(){if(this.buffer.length===this.offset)return this.buffer;throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}}class BufferReader{buffer;offset;constructor(t,r=0){this.buffer=t,this.offset=r,parse$1(tuple([BufferSchema,UInt32Schema]),[t,r])}readUInt8(){const t=readUInt8(this.buffer,this.offset);return this.offset++,t}readInt32(){const t=readInt32(this.buffer,this.offset,"LE");return this.offset+=4,t}readUInt32(){const t=readUInt32$1(this.buffer,this.offset,"LE");return this.offset+=4,t}readInt64(){const t=readInt64(this.buffer,this.offset,"LE");return this.offset+=8,t}readVarInt(){const{bigintValue:t,bytes:r}=decode$f(this.buffer,this.offset);return this.offset+=r,t}readSlice(t){verifuint(t,MAX_JS_NUMBER);const r=Number(t);if(this.buffer.length<this.offset+r)throw new Error("Cannot read slice out of bounds");const n=this.buffer.slice(this.offset,this.offset+r);return this.offset+=r,n}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const t=this.readVarInt(),r=[];for(let n=0;n<t;n++)r.push(this.readVarSlice());return r}}const LEAF_VERSION_TAPSCRIPT=192,MAX_TAPTREE_DEPTH=128,isHashBranch=e=>"left"in e&&"right"in e;function rootHashFromPath(e,t){if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);const r=(e.length-33)/32;let n=t;for(let s=0;s<r;s++){const a=e.slice(33+32*s,65+32*s);compare(n,a)<0?n=tapBranchHash(n,a):n=tapBranchHash(a,n)}return n}function toHashTree(e){if(isTapleaf(e))return{hash:tapleafHash(e)};const t=[toHashTree(e[0]),toHashTree(e[1])];t.sort((s,a)=>compare(s.hash,a.hash));const[r,n]=t;return{hash:tapBranchHash(r.hash,n.hash),left:r,right:n}}function findScriptPath(e,t){if(isHashBranch(e)){const r=findScriptPath(e.left,t);if(r!==void 0)return[...r,e.right.hash];const n=findScriptPath(e.right,t);if(n!==void 0)return[...n,e.left.hash]}else if(compare(e.hash,t)===0)return[]}function tapleafHash(e){const t=e.version||LEAF_VERSION_TAPSCRIPT;return taggedHash("TapLeaf",concat$1([Uint8Array.from([t]),serializeScript(e.output)]))}function tapTweakHash(e,t){return taggedHash("TapTweak",concat$1(t?[e,t]:[e]))}function tweakKey(e,t){if(!(e instanceof Uint8Array)||e.length!==32||t&&t.length!==32)return null;const r=tapTweakHash(e,t),n=getEccLib().xOnlyPointAddTweak(e,r);return!n||n.xOnlyPubkey===null?null:{parity:n.parity,x:Uint8Array.from(n.xOnlyPubkey)}}function tapBranchHash(e,t){return taggedHash("TapBranch",concat$1([e,t]))}function serializeScript(e){const t=encodingLength(e.length),r=new Uint8Array(t);return encode$f(e.length,r),concat$1([r,e])}const OPS=OPS$7,TAPROOT_WITNESS_VERSION=1,ANNEX_PREFIX=80;function p2tr(e,t){if(!e.address&&!e.output&&!e.pubkey&&!e.internalPubkey&&!(e.witness&&e.witness.length>1))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({address:string$1(),input:NBufferSchemaFactory(0),network:object$1({}),output:NBufferSchemaFactory(34),internalPubkey:NBufferSchemaFactory(32),hash:NBufferSchemaFactory(32),pubkey:NBufferSchemaFactory(32),signature:union$1([NBufferSchemaFactory(64),NBufferSchemaFactory(65)]),witness:array(BufferSchema),scriptTree:custom(isTaptree,"Taptree is not of type isTaptree"),redeem:partial(object$1({output:BufferSchema,redeemVersion:number$1(),witness:array(BufferSchema)})),redeemVersion:number$1()})),e);const r=value(()=>fromBech32(e.address)),n=value(()=>{if(!(!e.witness||!e.witness.length))return e.witness.length>=2&&e.witness[e.witness.length-1][0]===ANNEX_PREFIX?e.witness.slice(0,-1):e.witness.slice()}),s=value(()=>{if(e.scriptTree)return toHashTree(e.scriptTree);if(e.hash)return{hash:e.hash}}),a=e.network||bitcoin$1,l={name:"p2tr",network:a};if(prop(l,"address",()=>{if(!l.pubkey)return;const u=distExports$1.bech32m.toWords(l.pubkey);return u.unshift(TAPROOT_WITNESS_VERSION),distExports$1.bech32m.encode(a.bech32,u)}),prop(l,"hash",()=>{const u=s();if(u)return u.hash;const x=n();if(x&&x.length>1){const f=x[x.length-1],p=f[0]&TAPLEAF_VERSION_MASK,g=x[x.length-2],y=tapleafHash({output:g,version:p});return rootHashFromPath(f,y)}return null}),prop(l,"output",()=>{if(l.pubkey)return compile([OPS.OP_1,l.pubkey])}),prop(l,"redeemVersion",()=>e.redeemVersion?e.redeemVersion:e.redeem&&e.redeem.redeemVersion!==void 0&&e.redeem.redeemVersion!==null?e.redeem.redeemVersion:LEAF_VERSION_TAPSCRIPT),prop(l,"redeem",()=>{const u=n();if(!(!u||u.length<2))return{output:u[u.length-2],witness:u.slice(0,-2),redeemVersion:u[u.length-1][0]&TAPLEAF_VERSION_MASK}}),prop(l,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.output)return e.output.slice(2);if(e.address)return r().data;if(l.internalPubkey){const u=tweakKey(l.internalPubkey,l.hash);if(u)return u.x}}),prop(l,"internalPubkey",()=>{if(e.internalPubkey)return e.internalPubkey;const u=n();if(u&&u.length>1)return u[u.length-1].slice(1,33)}),prop(l,"signature",()=>{if(e.signature)return e.signature;const u=n();if(!(!u||u.length!==1))return u[0]}),prop(l,"witness",()=>{if(e.witness)return e.witness;const u=s();if(u&&e.redeem&&e.redeem.output&&e.internalPubkey){const x=tapleafHash({output:e.redeem.output,version:l.redeemVersion}),f=findScriptPath(u,x);if(!f)return;const p=tweakKey(e.internalPubkey,u.hash);if(!p)return;const g=concat$1([Uint8Array.from([l.redeemVersion|p.parity]),e.internalPubkey].concat(f));return[e.redeem.output,g]}if(e.signature)return[e.signature]}),t.validate){let u=Uint8Array.from([]);if(e.address){if(a&&a.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==TAPROOT_WITNESS_VERSION)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");u=r().data}if(e.pubkey){if(u.length>0&&compare(u,e.pubkey)!==0)throw new TypeError("Pubkey mismatch");u=e.pubkey}if(e.output){if(e.output.length!==34||e.output[0]!==OPS.OP_1||e.output[1]!==32)throw new TypeError("Output is invalid");if(u.length>0&&compare(u,e.output.slice(2))!==0)throw new TypeError("Pubkey mismatch");u=e.output.slice(2)}if(e.internalPubkey){const p=tweakKey(e.internalPubkey,l.hash);if(u.length>0&&compare(u,p.x)!==0)throw new TypeError("Pubkey mismatch");u=p.x}if(u&&u.length&&!getEccLib().isXOnlyPoint(u))throw new TypeError("Invalid pubkey for p2tr");const x=s();if(e.hash&&x&&compare(e.hash,x.hash)!==0)throw new TypeError("Hash mismatch");if(e.redeem&&e.redeem.output&&x){const p=tapleafHash({output:e.redeem.output,version:l.redeemVersion});if(!findScriptPath(x,p))throw new TypeError("Redeem script not in tree")}const f=n();if(e.redeem&&l.redeem){if(e.redeem.redeemVersion&&e.redeem.redeemVersion!==l.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(e.redeem.output){if(decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");if(l.redeem.output&&compare(e.redeem.output,l.redeem.output)!==0)throw new TypeError("Redeem.output and witness mismatch")}if(e.redeem.witness&&l.redeem.witness&&!stacksEqual(e.redeem.witness,l.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(f&&f.length)if(f.length===1){if(e.signature&&compare(e.signature,f[0])!==0)throw new TypeError("Signature mismatch")}else{const p=f[f.length-1];if(p.length<33)throw new TypeError(`The control-block length is too small. Got ${p.length}, expected min 33.`);if((p.length-33)%32!==0)throw new TypeError(`The control-block length of ${p.length} is incorrect!`);const g=(p.length-33)/32;if(g>128)throw new TypeError(`The script path is too long. Got ${g}, expected max 128.`);const y=p.slice(1,33);if(e.internalPubkey&&compare(e.internalPubkey,y)!==0)throw new TypeError("Internal pubkey mismatch");if(!getEccLib().isXOnlyPoint(y))throw new TypeError("Invalid internalPubkey for p2tr witness");const w=p[0]&TAPLEAF_VERSION_MASK,R=f[f.length-2],I=tapleafHash({output:R,version:w}),k=rootHashFromPath(p,I),je=tweakKey(y,k);if(!je)throw new TypeError("Invalid outputKey for p2tr witness");if(u.length&&compare(u,je.x)!==0)throw new TypeError("Pubkey mismatch for p2tr witness");if(je.parity!==(p[0]&1))throw new Error("Incorrect parity")}}return Object.assign(l,e)}const FUTURE_SEGWIT_MAX_SIZE=40,FUTURE_SEGWIT_MIN_SIZE=2,FUTURE_SEGWIT_MAX_VERSION=16,FUTURE_SEGWIT_MIN_VERSION=2,FUTURE_SEGWIT_VERSION_DIFF=80,FUTURE_SEGWIT_VERSION_WARNING="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.",WARNING_STATES=[!1,!1];function _toFutureSegwitAddress(e,t){const r=e.slice(2);if(r.length<FUTURE_SEGWIT_MIN_SIZE||r.length>FUTURE_SEGWIT_MAX_SIZE)throw new TypeError("Invalid program length for segwit address");const n=e[0]-FUTURE_SEGWIT_VERSION_DIFF;if(n<FUTURE_SEGWIT_MIN_VERSION||n>FUTURE_SEGWIT_MAX_VERSION)throw new TypeError("Invalid version for segwit address");if(e[1]!==r.length)throw new TypeError("Invalid script for segwit address");return WARNING_STATES[0]===!1&&(console.warn(FUTURE_SEGWIT_VERSION_WARNING),WARNING_STATES[0]=!0),toBech32(r,n,t.bech32)}function fromBase58Check(e){const t=bs58Check.decode(e);if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");const r=readUInt8(t,0),n=t.slice(1);return{version:r,hash:n}}function fromBech32(e){let t,r;try{t=distExports$1.bech32.decode(e)}catch{}if(t){if(r=t.words[0],r!==0)throw new TypeError(e+" uses wrong encoding")}else if(t=distExports$1.bech32m.decode(e),r=t.words[0],r===0)throw new TypeError(e+" uses wrong encoding");const n=distExports$1.bech32.fromWords(t.words.slice(1));return{version:r,prefix:t.prefix,data:Uint8Array.from(n)}}function toBech32(e,t,r){const n=distExports$1.bech32.toWords(e);return n.unshift(t),t===0?distExports$1.bech32.encode(r,n):distExports$1.bech32m.encode(r,n)}function fromOutputScript(e,t){t=t||bitcoin$1;try{return p2pkh({output:e,network:t}).address}catch{}try{return p2sh({output:e,network:t}).address}catch{}try{return p2wpkh({output:e,network:t}).address}catch{}try{return p2wsh({output:e,network:t}).address}catch{}try{return p2tr({output:e,network:t}).address}catch{}try{return _toFutureSegwitAddress(e,t)}catch{}throw new Error(toASM(e)+" has no matching Address")}function toOutputScript(e,t){t=t||bitcoin$1;let r,n;try{r=fromBase58Check(e)}catch{}if(r){if(r.version===t.pubKeyHash)return p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return p2sh({hash:r.hash}).output}else{try{n=fromBech32(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0){if(n.data.length===20)return p2wpkh({hash:n.data}).output;if(n.data.length===32)return p2wsh({hash:n.data}).output}else if(n.version===1){if(n.data.length===32)return p2tr({pubkey:n.data}).output}else if(n.version>=FUTURE_SEGWIT_MIN_VERSION&&n.version<=FUTURE_SEGWIT_MAX_VERSION&&n.data.length>=FUTURE_SEGWIT_MIN_SIZE&&n.data.length<=FUTURE_SEGWIT_MAX_SIZE)return WARNING_STATES[1]===!1&&(console.warn(FUTURE_SEGWIT_VERSION_WARNING),WARNING_STATES[1]=!0),compile([n.version+FUTURE_SEGWIT_VERSION_DIFF,n.data])}}throw new Error(e+" has no matching Script")}function varSliceSize(e){const t=e.length;return encodingLength(t)+t}function vectorSize(e){const t=e.length;return encodingLength(t)+e.reduce((r,n)=>r+varSliceSize(n),0)}const EMPTY_BUFFER=new Uint8Array(0),EMPTY_WITNESS=[],ZERO=fromHex("0000000000000000000000000000000000000000000000000000000000000000"),ONE=fromHex("0000000000000000000000000000000000000000000000000000000000000001"),VALUE_UINT64_MAX=fromHex("ffffffffffffffff"),BLANK_OUTPUT={script:EMPTY_BUFFER,valueBuffer:VALUE_UINT64_MAX};function isOutput(e){return e.value!==void 0}class Transaction{static DEFAULT_SEQUENCE=4294967295;static SIGHASH_DEFAULT=0;static SIGHASH_ALL=1;static SIGHASH_NONE=2;static SIGHASH_SINGLE=3;static SIGHASH_ANYONECANPAY=128;static SIGHASH_OUTPUT_MASK=3;static SIGHASH_INPUT_MASK=128;static ADVANCED_TRANSACTION_MARKER=0;static ADVANCED_TRANSACTION_FLAG=1;static fromBuffer(t,r){const n=new BufferReader(t),s=new Transaction;s.version=n.readUInt32();const a=n.readUInt8(),l=n.readUInt8();let u=!1;a===Transaction.ADVANCED_TRANSACTION_MARKER&&l===Transaction.ADVANCED_TRANSACTION_FLAG?u=!0:n.offset-=2;const x=n.readVarInt();for(let p=0;p<x;++p)s.ins.push({hash:n.readSlice(32),index:n.readUInt32(),script:n.readVarSlice(),sequence:n.readUInt32(),witness:EMPTY_WITNESS});const f=n.readVarInt();for(let p=0;p<f;++p)s.outs.push({value:n.readInt64(),script:n.readVarSlice()});if(u){for(let p=0;p<x;++p)s.ins[p].witness=n.readVector();if(!s.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(s.locktime=n.readUInt32(),r)return s;if(n.offset!==t.length)throw new Error("Transaction has unexpected data");return s}static fromHex(t){return Transaction.fromBuffer(fromHex(t),!1)}static isCoinbaseHash(t){parse$1(Hash256bitSchema,t);for(let r=0;r<32;++r)if(t[r]!==0)return!1;return!0}version=1;locktime=0;ins=[];outs=[];isCoinbase(){return this.ins.length===1&&Transaction.isCoinbaseHash(this.ins[0].hash)}addInput(t,r,n,s){return parse$1(tuple([Hash256bitSchema,UInt32Schema,nullable(optional$1(UInt32Schema)),nullable(optional$1(BufferSchema))]),[t,r,n,s]),n==null&&(n=Transaction.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:r,script:s||EMPTY_BUFFER,sequence:n,witness:EMPTY_WITNESS})-1}addOutput(t,r){return parse$1(tuple([BufferSchema,SatoshiSchema]),[t,r]),this.outs.push({script:t,value:r})-1}hasWitnesses(){return this.ins.some(t=>t.witness.length!==0)}stripWitnesses(){this.ins.forEach(t=>{t.witness=EMPTY_WITNESS})}weight(){const t=this.byteLength(!1),r=this.byteLength(!0);return t*3+r}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(t=!0){const r=t&&this.hasWitnesses();return(r?10:8)+encodingLength(this.ins.length)+encodingLength(this.outs.length)+this.ins.reduce((n,s)=>n+40+varSliceSize(s.script),0)+this.outs.reduce((n,s)=>n+8+varSliceSize(s.script),0)+(r?this.ins.reduce((n,s)=>n+vectorSize(s.witness),0):0)}clone(){const t=new Transaction;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(r=>({hash:r.hash,index:r.index,script:r.script,sequence:r.sequence,witness:r.witness})),t.outs=this.outs.map(r=>({script:r.script,value:r.value})),t}hashForSignature(t,r,n){if(parse$1(tuple([UInt32Schema,BufferSchema,number$1()]),[t,r,n]),t>=this.ins.length)return ONE;const s=compile(decompile(r).filter(u=>u!==OPS$7.OP_CODESEPARATOR)),a=this.clone();if((n&31)===Transaction.SIGHASH_NONE)a.outs=[],a.ins.forEach((u,x)=>{x!==t&&(u.sequence=0)});else if((n&31)===Transaction.SIGHASH_SINGLE){if(t>=this.outs.length)return ONE;a.outs.length=t+1;for(let u=0;u<t;u++)a.outs[u]=BLANK_OUTPUT;a.ins.forEach((u,x)=>{x!==t&&(u.sequence=0)})}n&Transaction.SIGHASH_ANYONECANPAY?(a.ins=[a.ins[t]],a.ins[0].script=s):(a.ins.forEach(u=>{u.script=EMPTY_BUFFER}),a.ins[t].script=s);const l=new Uint8Array(a.byteLength(!1)+4);return writeInt32(l,l.length-4,n,"LE"),a.__toBuffer(l,0,!1),hash256(l)}hashForWitnessV1(t,r,n,s,a,l){if(parse$1(tuple([UInt32Schema,array(BufferSchema),array(SatoshiSchema),UInt32Schema]),[t,r,n,s]),n.length!==this.ins.length||r.length!==this.ins.length)throw new Error("Must supply prevout script and value for all inputs");const u=s===Transaction.SIGHASH_DEFAULT?Transaction.SIGHASH_ALL:s&Transaction.SIGHASH_OUTPUT_MASK,f=(s&Transaction.SIGHASH_INPUT_MASK)===Transaction.SIGHASH_ANYONECANPAY,p=u===Transaction.SIGHASH_NONE,g=u===Transaction.SIGHASH_SINGLE;let y=EMPTY_BUFFER,w=EMPTY_BUFFER,R=EMPTY_BUFFER,I=EMPTY_BUFFER,k=EMPTY_BUFFER;if(!f){let $e=BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(We=>{$e.writeSlice(We.hash),$e.writeUInt32(We.index)}),y=sha256$5($e.end()),$e=BufferWriter.withCapacity(8*this.ins.length),n.forEach(We=>$e.writeInt64(We)),w=sha256$5($e.end()),$e=BufferWriter.withCapacity(r.map(varSliceSize).reduce((We,K)=>We+K)),r.forEach(We=>$e.writeVarSlice(We)),R=sha256$5($e.end()),$e=BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(We=>$e.writeUInt32(We.sequence)),I=sha256$5($e.end())}if(p||g){if(g&&t<this.outs.length){const $e=this.outs[t],We=BufferWriter.withCapacity(8+varSliceSize($e.script));We.writeInt64($e.value),We.writeVarSlice($e.script),k=sha256$5(We.end())}}else{if(!this.outs.length)throw new Error("Add outputs to the transaction before signing.");const $e=this.outs.map(K=>8+varSliceSize(K.script)).reduce((K,W)=>K+W),We=BufferWriter.withCapacity($e);this.outs.forEach(K=>{We.writeInt64(K.value),We.writeVarSlice(K.script)}),k=sha256$5(We.end())}const je=(a?2:0)+(l?1:0),Ve=174-(f?49:0)-(p?32:0)+(l?32:0)+(a?37:0),q=BufferWriter.withCapacity(Ve);if(q.writeUInt8(s),q.writeUInt32(this.version),q.writeUInt32(this.locktime),q.writeSlice(y),q.writeSlice(w),q.writeSlice(R),q.writeSlice(I),p||g||q.writeSlice(k),q.writeUInt8(je),f){const $e=this.ins[t];q.writeSlice($e.hash),q.writeUInt32($e.index),q.writeInt64(n[t]),q.writeVarSlice(r[t]),q.writeUInt32($e.sequence)}else q.writeUInt32(t);if(l){const $e=BufferWriter.withCapacity(varSliceSize(l));$e.writeVarSlice(l),q.writeSlice(sha256$5($e.end()))}return g&&q.writeSlice(k),a&&(q.writeSlice(a),q.writeUInt8(0),q.writeUInt32(4294967295)),taggedHash("TapSighash",concat$1([Uint8Array.from([0]),q.end()]))}hashForWitnessV0(t,r,n,s){parse$1(tuple([UInt32Schema,BufferSchema,SatoshiSchema,UInt32Schema]),[t,r,n,s]);let a=Uint8Array.from([]),l,u=ZERO,x=ZERO,f=ZERO;if(s&Transaction.SIGHASH_ANYONECANPAY||(a=new Uint8Array(36*this.ins.length),l=new BufferWriter(a,0),this.ins.forEach(g=>{l.writeSlice(g.hash),l.writeUInt32(g.index)}),x=hash256(a)),!(s&Transaction.SIGHASH_ANYONECANPAY)&&(s&31)!==Transaction.SIGHASH_SINGLE&&(s&31)!==Transaction.SIGHASH_NONE&&(a=new Uint8Array(4*this.ins.length),l=new BufferWriter(a,0),this.ins.forEach(g=>{l.writeUInt32(g.sequence)}),f=hash256(a)),(s&31)!==Transaction.SIGHASH_SINGLE&&(s&31)!==Transaction.SIGHASH_NONE){const g=this.outs.reduce((y,w)=>y+8+varSliceSize(w.script),0);a=new Uint8Array(g),l=new BufferWriter(a,0),this.outs.forEach(y=>{l.writeInt64(y.value),l.writeVarSlice(y.script)}),u=hash256(a)}else if((s&31)===Transaction.SIGHASH_SINGLE&&t<this.outs.length){const g=this.outs[t];a=new Uint8Array(8+varSliceSize(g.script)),l=new BufferWriter(a,0),l.writeInt64(g.value),l.writeVarSlice(g.script),u=hash256(a)}a=new Uint8Array(156+varSliceSize(r)),l=new BufferWriter(a,0);const p=this.ins[t];return l.writeUInt32(this.version),l.writeSlice(x),l.writeSlice(f),l.writeSlice(p.hash),l.writeUInt32(p.index),l.writeVarSlice(r),l.writeInt64(n),l.writeUInt32(p.sequence),l.writeSlice(u),l.writeUInt32(this.locktime),l.writeUInt32(s),hash256(a)}getHash(t){return t&&this.isCoinbase()?new Uint8Array(32):hash256(this.__toBuffer(void 0,void 0,t))}getId(){return toHex(reverseBuffer(this.getHash(!1)))}toBuffer(t,r){return this.__toBuffer(t,r,!0)}toHex(){return toHex(this.toBuffer(void 0,void 0))}setInputScript(t,r){parse$1(tuple([number$1(),BufferSchema]),[t,r]),this.ins[t].script=r}setWitness(t,r){parse$1(tuple([number$1(),array(BufferSchema)]),[t,r]),this.ins[t].witness=r}__toBuffer(t,r,n=!1){t||(t=new Uint8Array(this.byteLength(n)));const s=new BufferWriter(t,r||0);s.writeUInt32(this.version);const a=n&&this.hasWitnesses();return a&&(s.writeUInt8(Transaction.ADVANCED_TRANSACTION_MARKER),s.writeUInt8(Transaction.ADVANCED_TRANSACTION_FLAG)),s.writeVarInt(this.ins.length),this.ins.forEach(l=>{s.writeSlice(l.hash),s.writeUInt32(l.index),s.writeVarSlice(l.script),s.writeUInt32(l.sequence)}),s.writeVarInt(this.outs.length),this.outs.forEach(l=>{isOutput(l)?s.writeInt64(l.value):s.writeSlice(l.valueBuffer),s.writeVarSlice(l.script)}),a&&this.ins.forEach(l=>{s.writeVector(l.witness)}),s.writeUInt32(this.locktime),r!==void 0?t.slice(r,s.offset):t}}var GlobalTypes;(function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"})(GlobalTypes||(GlobalTypes={}));var InputTypes;(function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT",e[e.TAP_KEY_SIG=19]="TAP_KEY_SIG",e[e.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",e[e.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",e[e.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",e[e.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"})(InputTypes||(InputTypes={}));var OutputTypes;(function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",e[e.TAP_TREE=6]="TAP_TREE",e[e.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"})(OutputTypes||(OutputTypes={}));const range$3=e=>[...Array(e).keys()];function decode$e(e){if(e.key[0]!==GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+toHex(e.key));if(e.key.length!==79||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+toHex(e.key));if(e.value.length/4%1!==0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");const t=e.key.slice(1),r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(const n of range$3(e.value.length/4-1)){const s=readUInt32$1(e.value,n*4+4,"LE"),a=!!(s&2147483648),l=s&2147483647;r.path+="/"+l.toString(10)+(a?"'":"")}return r}function encode$e(e){const t=new Uint8Array([GlobalTypes.GLOBAL_XPUB]),r=concat$1([t,e.extendedPubkey]),n=e.path.split("/"),s=new Uint8Array(n.length*4);s.set(e.masterFingerprint,0);let a=4;return n.slice(1).forEach(l=>{const u=l.slice(-1)==="'";let x=2147483647&parseInt(u?l.slice(0,-1):l,10);u&&(x+=2147483648),writeUInt32$2(s,a,x,"LE"),a+=4}),{key:r,value:s}}const expected$c="{ masterFingerprint: Uint8Array; extendedPubkey: Uint8Array; path: string; }";function check$c(e){const t=e.extendedPubkey,r=e.masterFingerprint,n=e.path;return t instanceof Uint8Array&&t.length===78&&[2,3].indexOf(t[45])>-1&&r instanceof Uint8Array&&r.length===4&&typeof n=="string"&&!!n.match(/^m(\/\d+'?)*$/)}function canAddToArray$3(e,t,r){const n=toHex(t.extendedPubkey);return r.has(n)?!1:(r.add(n),e.filter(s=>compare(s.extendedPubkey,t.extendedPubkey)).length===0)}const globalXpub=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$3,check:check$c,decode:decode$e,encode:encode$e,expected:expected$c},Symbol.toStringTag,{value:"Module"}));function encode$d(e){return{key:new Uint8Array([GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}const unsignedTx=Object.freeze(Object.defineProperty({__proto__:null,encode:encode$d},Symbol.toStringTag,{value:"Module"}));function decode$d(e){if(e.key[0]!==InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+toHex(e.key));return e.value}function encode$c(e){return{key:new Uint8Array([InputTypes.FINAL_SCRIPTSIG]),value:e}}const expected$b="Uint8Array";function check$b(e){return e instanceof Uint8Array}function canAdd$8(e,t){return!!e&&!!t&&e.finalScriptSig===void 0}const finalScriptSig=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$8,check:check$b,decode:decode$d,encode:encode$c,expected:expected$b},Symbol.toStringTag,{value:"Module"}));function decode$c(e){if(e.key[0]!==InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+toHex(e.key));return e.value}function encode$b(e){return{key:new Uint8Array([InputTypes.FINAL_SCRIPTWITNESS]),value:e}}const expected$a="Uint8Array";function check$a(e){return e instanceof Uint8Array}function canAdd$7(e,t){return!!e&&!!t&&e.finalScriptWitness===void 0}const finalScriptWitness=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$7,check:check$a,decode:decode$c,encode:encode$b,expected:expected$a},Symbol.toStringTag,{value:"Module"}));function decode$b(e){if(e.key[0]!==InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+toHex(e.key));return e.value}function encode$a(e){return{key:new Uint8Array([InputTypes.NON_WITNESS_UTXO]),value:e}}const expected$9="Uint8Array";function check$9(e){return e instanceof Uint8Array}function canAdd$6(e,t){return!!e&&!!t&&e.nonWitnessUtxo===void 0}const nonWitnessUtxo=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$6,check:check$9,decode:decode$b,encode:encode$a,expected:expected$9},Symbol.toStringTag,{value:"Module"}));function decode$a(e){if(e.key[0]!==InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+toHex(e.key));if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+toHex(e.key));return{pubkey:e.key.slice(1),signature:e.value}}function encode$9(e){const t=new Uint8Array([InputTypes.PARTIAL_SIG]);return{key:concat$1([t,e.pubkey]),value:e.signature}}const expected$8="{ pubkey: Uint8Array; signature: Uint8Array; }";function check$8(e){return e.pubkey instanceof Uint8Array&&e.signature instanceof Uint8Array&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&isDerSigWithSighash(e.signature)}function isDerSigWithSighash(e){if(!(e instanceof Uint8Array)||e.length<9||e[0]!==48||e.length!==e[1]+3||e[2]!==2)return!1;const t=e[3];if(t>33||t<1||e[3+t+1]!==2)return!1;const r=e[3+t+2];return!(r>33||r<1||e.length!==3+t+2+r+2)}function canAddToArray$2(e,t,r){const n=toHex(t.pubkey);return r.has(n)?!1:(r.add(n),e.filter(s=>compare(s.pubkey,t.pubkey)===0).length===0)}const partialSig=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$2,check:check$8,decode:decode$a,encode:encode$9,expected:expected$8},Symbol.toStringTag,{value:"Module"}));function decode$9(e){if(e.key[0]!==InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+toHex(e.key));return toUtf8(e.value)}function encode$8(e){return{key:new Uint8Array([InputTypes.POR_COMMITMENT]),value:fromUtf8(e)}}const expected$7="string";function check$7(e){return typeof e=="string"}function canAdd$5(e,t){return!!e&&!!t&&e.porCommitment===void 0}const porCommitment=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$5,check:check$7,decode:decode$9,encode:encode$8,expected:expected$7},Symbol.toStringTag,{value:"Module"}));function decode$8(e){if(e.key[0]!==InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+toHex(e.key));return Number(readUInt32$1(e.value,0,"LE"))}function encode$7(e){const t=Uint8Array.from([InputTypes.SIGHASH_TYPE]),r=new Uint8Array(4);return writeUInt32$2(r,0,e,"LE"),{key:t,value:r}}const expected$6="number";function check$6(e){return typeof e=="number"}function canAdd$4(e,t){return!!e&&!!t&&e.sighashType===void 0}const sighashType=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$4,check:check$6,decode:decode$8,encode:encode$7,expected:expected$6},Symbol.toStringTag,{value:"Module"}));function decode$7(e){if(e.key[0]!==InputTypes.TAP_KEY_SIG||e.key.length!==1)throw new Error("Decode Error: could not decode tapKeySig with key 0x"+toHex(e.key));if(!check$5(e.value))throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value}function encode$6(e){return{key:Uint8Array.from([InputTypes.TAP_KEY_SIG]),value:e}}const expected$5="Uint8Array";function check$5(e){return e instanceof Uint8Array&&(e.length===64||e.length===65)}function canAdd$3(e,t){return!!e&&!!t&&e.tapKeySig===void 0}const tapKeySig=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$3,check:check$5,decode:decode$7,encode:encode$6,expected:expected$5},Symbol.toStringTag,{value:"Module"}));function decode$6(e){if(e.key[0]!==InputTypes.TAP_LEAF_SCRIPT)throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+toHex(e.key));if((e.key.length-2)%32!==0)throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+toHex(e.key));const t=e.value[e.value.length-1];if((e.key[1]&254)!==t)throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+toHex(e.key));const r=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:r,leafVersion:t}}function encode$5(e){const t=Uint8Array.from([InputTypes.TAP_LEAF_SCRIPT]),r=Uint8Array.from([e.leafVersion]);return{key:concat$1([t,e.controlBlock]),value:concat$1([e.script,r])}}const expected$4="{ controlBlock: Uint8Array; leafVersion: number, script: Uint8Array; }";function check$4(e){return e.controlBlock instanceof Uint8Array&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&e.script instanceof Uint8Array}function canAddToArray$1(e,t,r){const n=toHex(t.controlBlock);return r.has(n)?!1:(r.add(n),e.filter(s=>compare(s.controlBlock,t.controlBlock)===0).length===0)}const tapLeafScript=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$1,check:check$4,decode:decode$6,encode:encode$5,expected:expected$4},Symbol.toStringTag,{value:"Module"}));function decode$5(e){if(e.key[0]!==InputTypes.TAP_MERKLE_ROOT||e.key.length!==1)throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+toHex(e.key));if(!check$3(e.value))throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value}function encode$4(e){return{key:Uint8Array.from([InputTypes.TAP_MERKLE_ROOT]),value:e}}const expected$3="Uint8Array";function check$3(e){return e instanceof Uint8Array&&e.length===32}function canAdd$2(e,t){return!!e&&!!t&&e.tapMerkleRoot===void 0}const tapMerkleRoot=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$2,check:check$3,decode:decode$5,encode:encode$4,expected:expected$3},Symbol.toStringTag,{value:"Module"}));function decode$4(e){if(e.key[0]!==InputTypes.TAP_SCRIPT_SIG)throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+toHex(e.key));if(e.key.length!==65)throw new Error("Decode Error: tapScriptSig has invalid key 0x"+toHex(e.key));if(e.value.length!==64&&e.value.length!==65)throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+toHex(e.key));const t=e.key.slice(1,33),r=e.key.slice(33);return{pubkey:t,leafHash:r,signature:e.value}}function encode$3(e){const t=Uint8Array.from([InputTypes.TAP_SCRIPT_SIG]);return{key:concat$1([t,e.pubkey,e.leafHash]),value:e.signature}}const expected$2="{ pubkey: Uint8Array; leafHash: Uint8Array; signature: Uint8Array; }";function check$2(e){return e.pubkey instanceof Uint8Array&&e.leafHash instanceof Uint8Array&&e.signature instanceof Uint8Array&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}function canAddToArray(e,t,r){const n=toHex(t.pubkey)+toHex(t.leafHash);return r.has(n)?!1:(r.add(n),e.filter(s=>compare(s.pubkey,t.pubkey)===0&&compare(s.leafHash,t.leafHash)===0).length===0)}const tapScriptSig=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray,check:check$2,decode:decode$4,encode:encode$3,expected:expected$2},Symbol.toStringTag,{value:"Module"}));function decode$3(e){if(e.key[0]!==InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+toHex(e.key));const t=readInt64(e.value,0,"LE");let r=8;const{numberValue:n,bytes:s}=decode$f(e.value,r);r+=s;const a=e.value.slice(r);if(a.length!==n)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:a,value:t}}function encode$2(e){const{script:t,value:r}=e,n=encodingLength(t.length),s=new Uint8Array(8+n+t.length);return writeInt64(s,0,BigInt(r),"LE"),encode$f(t.length,s,8),s.set(t,8+n),{key:Uint8Array.from([InputTypes.WITNESS_UTXO]),value:s}}const expected$1="{ script: Uint8Array; value: bigint; }";function check$1(e){return e.script instanceof Uint8Array&&typeof e.value=="bigint"}function canAdd$1(e,t){return!!e&&!!t&&e.witnessUtxo===void 0}const witnessUtxo=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$1,check:check$1,decode:decode$3,encode:encode$2,expected:expected$1},Symbol.toStringTag,{value:"Module"}));function decode$2(e){if(e.key[0]!==OutputTypes.TAP_TREE||e.key.length!==1)throw new Error("Decode Error: could not decode tapTree with key 0x"+toHex(e.key));let t=0;const r=[];for(;t<e.value.length;){const n=e.value[t++],s=e.value[t++],{numberValue:a,bytes:l}=decode$f(e.value,t);t+=l,r.push({depth:n,leafVersion:s,script:e.value.slice(t,t+a)}),t+=a}return{leaves:r}}function encode$1(e){const t=Uint8Array.from([OutputTypes.TAP_TREE]),r=[].concat(...e.leaves.map(n=>[Uint8Array.of(n.depth,n.leafVersion),encode$f(BigInt(n.script.length)).buffer,n.script]));return{key:t,value:concat$1(r)}}const expected="{ leaves: [{ depth: number; leafVersion: number, script: Uint8Array; }] }";function check(e){return Array.isArray(e.leaves)&&e.leaves.every(t=>t.depth>=0&&t.depth<=128&&(t.leafVersion&254)===t.leafVersion&&t.script instanceof Uint8Array)}function canAdd(e,t){return!!e&&!!t&&e.tapTree===void 0}const tapTree=Object.freeze(Object.defineProperty({__proto__:null,canAdd,check,decode:decode$2,encode:encode$1,expected},Symbol.toStringTag,{value:"Module"})),range$2=e=>[...Array(e).keys()],isValidDERKey=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&e[0]===4;function makeConverter$4(e,t=isValidDERKey){function r(u){if(u.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+toHex(u.key));const x=u.key.slice(1);if(!t(x))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+toHex(u.key));if(u.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");const f={masterFingerprint:u.value.slice(0,4),pubkey:x,path:"m"};for(const p of range$2(u.value.length/4-1)){const g=readUInt32$1(u.value,p*4+4,"LE"),y=!!(g&2147483648),w=g&2147483647;f.path+="/"+w.toString(10)+(y?"'":"")}return f}function n(u){const x=Uint8Array.from([e]),f=concat$1([x,u.pubkey]),p=u.path.split("/"),g=new Uint8Array(p.length*4);g.set(u.masterFingerprint,0);let y=4;return p.slice(1).forEach(w=>{const R=w.slice(-1)==="'";let I=2147483647&parseInt(R?w.slice(0,-1):w,10);R&&(I+=2147483648),writeUInt32$2(g,y,I,"LE"),y+=4}),{key:f,value:g}}const s="{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; }";function a(u){return u.pubkey instanceof Uint8Array&&u.masterFingerprint instanceof Uint8Array&&typeof u.path=="string"&&t(u.pubkey)&&u.masterFingerprint.length===4}function l(u,x,f){const p=toHex(x.pubkey);return f.has(p)?!1:(f.add(p),u.filter(g=>compare(g.pubkey,x.pubkey)===0).length===0)}return{decode:r,encode:n,check:a,expected:s,canAddToArray:l}}function makeChecker(e){return t;function t(r){let n;if(e.includes(r.key[0])&&(n=r.key.slice(1),!(n.length===33||n.length===65)||![2,3,4].includes(n[0])))throw new Error("Format Error: invalid pubkey in key 0x"+toHex(r.key));return n}}function makeConverter$3(e){function t(l){if(l.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+toHex(l.key));return l.value}function r(l){return{key:Uint8Array.from([e]),value:l}}const n="Uint8Array";function s(l){return l instanceof Uint8Array}function a(l,u){return!!l&&!!u&&l.redeemScript===void 0}return{decode:t,encode:r,check:s,expected:n,canAdd:a}}const isValidBIP340Key=e=>e.length===32;function makeConverter$2(e){const t=makeConverter$4(e,isValidBIP340Key);function r(l){const{numberValue:u,bytes:x}=decode$f(l.value),f=t.decode({key:l.key,value:l.value.slice(x+Number(u)*32)}),p=new Array(Number(u));for(let g=0,y=x;g<u;g++,y+=32)p[g]=l.value.slice(y,y+32);return{...f,leafHashes:p}}function n(l){const u=t.encode(l),x=encodingLength(l.leafHashes.length),f=new Uint8Array(x);encode$f(l.leafHashes.length,f);const p=concat$1([f,...l.leafHashes,u.value]);return{...u,value:p}}const s="{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; leafHashes: Uint8Array[]; }";function a(l){return Array.isArray(l.leafHashes)&&l.leafHashes.every(u=>u instanceof Uint8Array&&u.length===32)&&t.check(l)}return{decode:r,encode:n,check:a,expected:s,canAddToArray:t.canAddToArray}}function makeConverter$1(e){function t(l){if(l.key[0]!==e||l.key.length!==1)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+toHex(l.key));if(l.value.length!==32)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return l.value}function r(l){return{key:Uint8Array.from([e]),value:l}}const n="Uint8Array";function s(l){return l instanceof Uint8Array&&l.length===32}function a(l,u){return!!l&&!!u&&l.tapInternalKey===void 0}return{decode:t,encode:r,check:s,expected:n,canAdd:a}}function makeConverter(e){function t(l){if(l.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+toHex(l.key));return l.value}function r(l){return{key:Uint8Array.from([e]),value:l}}const n="Uint8Array";function s(l){return l instanceof Uint8Array}function a(l,u){return!!l&&!!u&&l.witnessScript===void 0}return{decode:t,encode:r,check:s,expected:n,canAdd:a}}const globals={unsignedTx,globalXpub,checkPubkey:makeChecker([])},inputs={nonWitnessUtxo,partialSig,sighashType,finalScriptSig,finalScriptWitness,porCommitment,witnessUtxo,bip32Derivation:makeConverter$4(InputTypes.BIP32_DERIVATION),redeemScript:makeConverter$3(InputTypes.REDEEM_SCRIPT),witnessScript:makeConverter(InputTypes.WITNESS_SCRIPT),checkPubkey:makeChecker([InputTypes.PARTIAL_SIG,InputTypes.BIP32_DERIVATION]),tapKeySig,tapScriptSig,tapLeafScript,tapBip32Derivation:makeConverter$2(InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:makeConverter$1(InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot},outputs={bip32Derivation:makeConverter$4(OutputTypes.BIP32_DERIVATION),redeemScript:makeConverter$3(OutputTypes.REDEEM_SCRIPT),witnessScript:makeConverter(OutputTypes.WITNESS_SCRIPT),checkPubkey:makeChecker([OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:makeConverter$2(OutputTypes.TAP_BIP32_DERIVATION),tapTree,tapInternalKey:makeConverter$1(OutputTypes.TAP_INTERNAL_KEY)},converter=Object.freeze(Object.defineProperty({__proto__:null,globals,inputs,outputs},Symbol.toStringTag,{value:"Module"})),range$1=e=>[...Array(e).keys()];function keyValsToBuffer(e){const t=e.map(keyValToBuffer);return t.push(Uint8Array.from([0])),concat$1(t)}function keyValToBuffer(e){const t=e.key.length,r=e.value.length,n=encodingLength(t),s=encodingLength(r),a=new Uint8Array(n+t+s+r);return encode$f(t,a,0),a.set(e.key,n),encode$f(r,a,n+t),a.set(e.value,n+t+s),a}function psbtFromBuffer(e,t){let r=0;function n(){const{numberValue:k,bytes:je}=decode$f(e,r);r+=je;const Ve=e.slice(r,r+Number(k));return r+=Number(k),Ve}function s(){const k=readUInt32$1(e,r,"BE");return r+=4,k}function a(){const k=readUInt8(e,r);return r+=1,k}function l(){const k=n(),je=n();return{key:k,value:je}}function u(){if(r>=e.length)throw new Error("Format Error: Unexpected End of PSBT");const k=readUInt8(e,r)===0;return k&&r++,k}if(s()!==1886610036)throw new Error("Format Error: Invalid Magic Number");if(a()!==255)throw new Error("Format Error: Magic Number must be followed by 0xff separator");const x=[],f={};for(;!u();){const k=l(),je=toHex(k.key);if(f[je])throw new Error("Format Error: Keys must be unique for global keymap: key "+je);f[je]=1,x.push(k)}const p=x.filter(k=>k.key[0]===GlobalTypes.UNSIGNED_TX);if(p.length!==1)throw new Error("Format Error: Only one UNSIGNED_TX allowed");const g=t(p[0].value),{inputCount:y,outputCount:w}=g.getInputOutputCounts(),R=[],I=[];for(const k of range$1(y)){const je={},Ve=[];for(;!u();){const q=l(),$e=toHex(q.key);if(je[$e])throw new Error("Format Error: Keys must be unique for each input: input index "+k+" key "+$e);je[$e]=1,Ve.push(q)}R.push(Ve)}for(const k of range$1(w)){const je={},Ve=[];for(;!u();){const q=l(),$e=toHex(q.key);if(je[$e])throw new Error("Format Error: Keys must be unique for each output: output index "+k+" key "+$e);je[$e]=1,Ve.push(q)}I.push(Ve)}return psbtFromKeyVals(g,{globalMapKeyVals:x,inputKeyVals:R,outputKeyVals:I})}function checkKeyBuffer(e,t,r){if(compare(t,Uint8Array.from([r])))throw new Error(`Format Error: Invalid ${e} key: ${toHex(t)}`)}function psbtFromKeyVals(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){const s={unsignedTx:e};let a=0;for(const p of t)switch(p.key[0]){case GlobalTypes.UNSIGNED_TX:if(checkKeyBuffer("global",p.key,GlobalTypes.UNSIGNED_TX),a>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");a++;break;case GlobalTypes.GLOBAL_XPUB:s.globalXpub===void 0&&(s.globalXpub=[]),s.globalXpub.push(globals.globalXpub.decode(p));break;default:s.unknownKeyVals||(s.unknownKeyVals=[]),s.unknownKeyVals.push(p)}const l=r.length,u=n.length,x=[],f=[];for(const p of range$1(l)){const g={};for(const y of r[p])switch(inputs.checkPubkey(y),y.key[0]){case InputTypes.NON_WITNESS_UTXO:if(checkKeyBuffer("input",y.key,InputTypes.NON_WITNESS_UTXO),g.nonWitnessUtxo!==void 0)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");g.nonWitnessUtxo=inputs.nonWitnessUtxo.decode(y);break;case InputTypes.WITNESS_UTXO:if(checkKeyBuffer("input",y.key,InputTypes.WITNESS_UTXO),g.witnessUtxo!==void 0)throw new Error("Format Error: Input has multiple WITNESS_UTXO");g.witnessUtxo=inputs.witnessUtxo.decode(y);break;case InputTypes.PARTIAL_SIG:g.partialSig===void 0&&(g.partialSig=[]),g.partialSig.push(inputs.partialSig.decode(y));break;case InputTypes.SIGHASH_TYPE:if(checkKeyBuffer("input",y.key,InputTypes.SIGHASH_TYPE),g.sighashType!==void 0)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");g.sighashType=inputs.sighashType.decode(y);break;case InputTypes.REDEEM_SCRIPT:if(checkKeyBuffer("input",y.key,InputTypes.REDEEM_SCRIPT),g.redeemScript!==void 0)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");g.redeemScript=inputs.redeemScript.decode(y);break;case InputTypes.WITNESS_SCRIPT:if(checkKeyBuffer("input",y.key,InputTypes.WITNESS_SCRIPT),g.witnessScript!==void 0)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");g.witnessScript=inputs.witnessScript.decode(y);break;case InputTypes.BIP32_DERIVATION:g.bip32Derivation===void 0&&(g.bip32Derivation=[]),g.bip32Derivation.push(inputs.bip32Derivation.decode(y));break;case InputTypes.FINAL_SCRIPTSIG:checkKeyBuffer("input",y.key,InputTypes.FINAL_SCRIPTSIG),g.finalScriptSig=inputs.finalScriptSig.decode(y);break;case InputTypes.FINAL_SCRIPTWITNESS:checkKeyBuffer("input",y.key,InputTypes.FINAL_SCRIPTWITNESS),g.finalScriptWitness=inputs.finalScriptWitness.decode(y);break;case InputTypes.POR_COMMITMENT:checkKeyBuffer("input",y.key,InputTypes.POR_COMMITMENT),g.porCommitment=inputs.porCommitment.decode(y);break;case InputTypes.TAP_KEY_SIG:checkKeyBuffer("input",y.key,InputTypes.TAP_KEY_SIG),g.tapKeySig=inputs.tapKeySig.decode(y);break;case InputTypes.TAP_SCRIPT_SIG:g.tapScriptSig===void 0&&(g.tapScriptSig=[]),g.tapScriptSig.push(inputs.tapScriptSig.decode(y));break;case InputTypes.TAP_LEAF_SCRIPT:g.tapLeafScript===void 0&&(g.tapLeafScript=[]),g.tapLeafScript.push(inputs.tapLeafScript.decode(y));break;case InputTypes.TAP_BIP32_DERIVATION:g.tapBip32Derivation===void 0&&(g.tapBip32Derivation=[]),g.tapBip32Derivation.push(inputs.tapBip32Derivation.decode(y));break;case InputTypes.TAP_INTERNAL_KEY:checkKeyBuffer("input",y.key,InputTypes.TAP_INTERNAL_KEY),g.tapInternalKey=inputs.tapInternalKey.decode(y);break;case InputTypes.TAP_MERKLE_ROOT:checkKeyBuffer("input",y.key,InputTypes.TAP_MERKLE_ROOT),g.tapMerkleRoot=inputs.tapMerkleRoot.decode(y);break;default:g.unknownKeyVals||(g.unknownKeyVals=[]),g.unknownKeyVals.push(y)}x.push(g)}for(const p of range$1(u)){const g={};for(const y of n[p])switch(outputs.checkPubkey(y),y.key[0]){case OutputTypes.REDEEM_SCRIPT:if(checkKeyBuffer("output",y.key,OutputTypes.REDEEM_SCRIPT),g.redeemScript!==void 0)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");g.redeemScript=outputs.redeemScript.decode(y);break;case OutputTypes.WITNESS_SCRIPT:if(checkKeyBuffer("output",y.key,OutputTypes.WITNESS_SCRIPT),g.witnessScript!==void 0)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");g.witnessScript=outputs.witnessScript.decode(y);break;case OutputTypes.BIP32_DERIVATION:g.bip32Derivation===void 0&&(g.bip32Derivation=[]),g.bip32Derivation.push(outputs.bip32Derivation.decode(y));break;case OutputTypes.TAP_INTERNAL_KEY:checkKeyBuffer("output",y.key,OutputTypes.TAP_INTERNAL_KEY),g.tapInternalKey=outputs.tapInternalKey.decode(y);break;case OutputTypes.TAP_TREE:checkKeyBuffer("output",y.key,OutputTypes.TAP_TREE),g.tapTree=outputs.tapTree.decode(y);break;case OutputTypes.TAP_BIP32_DERIVATION:g.tapBip32Derivation===void 0&&(g.tapBip32Derivation=[]),g.tapBip32Derivation.push(outputs.tapBip32Derivation.decode(y));break;default:g.unknownKeyVals||(g.unknownKeyVals=[]),g.unknownKeyVals.push(y)}f.push(g)}return{globalMap:s,inputs:x,outputs:f}}function psbtToBuffer({globalMap:e,inputs:t,outputs:r}){const{globalKeyVals:n,inputKeyVals:s,outputKeyVals:a}=psbtToKeyVals({globalMap:e,inputs:t,outputs:r}),l=keyValsToBuffer(n),u=g=>g.length===0?[Uint8Array.from([0])]:g.map(keyValsToBuffer),x=u(s),f=u(a),p=new Uint8Array(5);return p.set([112,115,98,116,255],0),concat$1([p,l].concat(x,f))}const sortKeyVals=(e,t)=>compare(e.key,t.key);function keyValsFromMap(e,t){const r=new Set,n=Object.entries(e).reduce((a,[l,u])=>{if(l==="unknownKeyVals")return a;const x=t[l];if(x===void 0)return a;const f=(Array.isArray(u)?u:[u]).map(x.encode);return f.map(g=>toHex(g.key)).forEach(g=>{if(r.has(g))throw new Error("Serialize Error: Duplicate key: "+g);r.add(g)}),a.concat(f)},[]),s=e.unknownKeyVals?e.unknownKeyVals.filter(a=>!r.has(toHex(a.key))):[];return n.concat(s).sort(sortKeyVals)}function psbtToKeyVals({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:keyValsFromMap(e,globals),inputKeyVals:t.map(n=>keyValsFromMap(n,inputs)),outputKeyVals:r.map(n=>keyValsFromMap(n,outputs))}}function combine(e){const t=e[0],r=psbtToKeyVals(t),n=e.slice(1);if(n.length===0)throw new Error("Combine: Nothing to combine");const s=getTx(t);if(s===void 0)throw new Error("Combine: Self missing transaction");const a=getKeySet(r.globalKeyVals),l=r.inputKeyVals.map(getKeySet),u=r.outputKeyVals.map(getKeySet);for(const x of n){const f=getTx(x);if(f===void 0||compare(f.toBuffer(),s.toBuffer())!==0)throw new Error("Combine: One of the Psbts does not have the same transaction.");const p=psbtToKeyVals(x);getKeySet(p.globalKeyVals).forEach(keyPusher(a,r.globalKeyVals,p.globalKeyVals)),p.inputKeyVals.map(getKeySet).forEach((R,I)=>R.forEach(keyPusher(l[I],r.inputKeyVals[I],p.inputKeyVals[I]))),p.outputKeyVals.map(getKeySet).forEach((R,I)=>R.forEach(keyPusher(u[I],r.outputKeyVals[I],p.outputKeyVals[I])))}return psbtFromKeyVals(s,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}function keyPusher(e,t,r){return n=>{if(e.has(n))return;const s=r.filter(a=>toHex(a.key)===n)[0];t.push(s),e.add(n)}}function getTx(e){return e.globalMap.unsignedTx}function getKeySet(e){const t=new Set;return e.forEach(r=>{const n=toHex(r.key);if(t.has(n))throw new Error("Combine: KeyValue Map keys should be unique");t.add(n)}),t}function checkForInput(e,t){const r=e[t];if(r===void 0)throw new Error(`No input #${t}`);return r}function checkForOutput(e,t){const r=e[t];if(r===void 0)throw new Error(`No output #${t}`);return r}function checkHasKey(e,t,r){if(e.key[0]<r)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&t.filter(n=>compare(n.key,e.key)===0).length!==0)throw new Error(`Duplicate Key: ${toHex(e.key)}`)}function getEnumLength(e){let t=0;return Object.keys(e).forEach(r=>{Number(isNaN(Number(r)))&&t++}),t}function inputCheckUncleanFinalized(e,t){let r=!1;if(t.nonWitnessUtxo||t.witnessUtxo){const n=!!t.redeemScript,s=!!t.witnessScript,a=!n||!!t.finalScriptSig,l=!s||!!t.finalScriptWitness,u=!!t.finalScriptSig||!!t.finalScriptWitness;r=a&&l&&u}if(r===!1)throw new Error(`Input #${e} has too much or too little data to clean`)}function throwForUpdateMaker(e,t,r,n){throw new Error(`Data for ${e} key ${t} is incorrect: Expected ${r} and got ${JSON.stringify(n)}`)}function updateMaker(e){return(t,r)=>{for(const n of Object.keys(t)){const s=t[n],{canAdd:a,canAddToArray:l,check:u,expected:x}=converter[e+"s"][n]||{},f=!!l;if(u)if(f){if(!Array.isArray(s)||r[n]&&!Array.isArray(r[n]))throw new Error(`Key type ${n} must be an array`);s.every(u)||throwForUpdateMaker(e,n,x,s);const p=r[n]||[],g=new Set;if(!s.every(y=>l(p,y,g)))throw new Error("Can not add duplicate data to array");r[n]=p.concat(s)}else{if(u(s)||throwForUpdateMaker(e,n,x,s),!a(r,s))throw new Error(`Can not add duplicate data to ${e}`);r[n]=s}}}}const updateGlobal=updateMaker("global"),updateInput=updateMaker("input"),updateOutput=updateMaker("output");function addInputAttributes(e,t){const r=e.length-1,n=checkForInput(e,r);updateInput(t,n)}function addOutputAttributes(e,t){const r=e.length-1,n=checkForOutput(e,r);updateOutput(t,n)}let Psbt$1=class{constructor(t){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:t}}static fromBase64(t,r){const n=fromBase64(t);return this.fromBuffer(n,r)}static fromHex(t,r){const n=fromHex(t);return this.fromBuffer(n,r)}static fromBuffer(t,r){const n=psbtFromBuffer(t,r),s=new this(n.globalMap.unsignedTx);return Object.assign(s,n),s}toBase64(){const t=this.toBuffer();return toBase64(t)}toHex(){const t=this.toBuffer();return toHex(t)}toBuffer(){return psbtToBuffer(this)}updateGlobal(t){return updateGlobal(t,this.globalMap),this}updateInput(t,r){const n=checkForInput(this.inputs,t);return updateInput(r,n),this}updateOutput(t,r){const n=checkForOutput(this.outputs,t);return updateOutput(r,n),this}addUnknownKeyValToGlobal(t){return checkHasKey(t,this.globalMap.unknownKeyVals,getEnumLength(GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(t),this}addUnknownKeyValToInput(t,r){const n=checkForInput(this.inputs,t);return checkHasKey(r,n.unknownKeyVals,getEnumLength(InputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addUnknownKeyValToOutput(t,r){const n=checkForOutput(this.outputs,t);return checkHasKey(r,n.unknownKeyVals,getEnumLength(OutputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addInput(t){this.globalMap.unsignedTx.addInput(t),this.inputs.push({unknownKeyVals:[]});const r=t.unknownKeyVals||[],n=this.inputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(s=>this.addUnknownKeyValToInput(n,s)),addInputAttributes(this.inputs,t),this}addOutput(t){this.globalMap.unsignedTx.addOutput(t),this.outputs.push({unknownKeyVals:[]});const r=t.unknownKeyVals||[],n=this.outputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(s=>this.addUnknownKeyValToOutput(n,s)),addOutputAttributes(this.outputs,t),this}clearFinalizedInput(t){const r=checkForInput(this.inputs,t);inputCheckUncleanFinalized(t,r);for(const n of Object.keys(r))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(n)||delete r[n];return this}combine(...t){const r=combine([this].concat(t));return Object.assign(this,r),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}};function isPaymentFactory(e){return t=>{try{return e({output:t}),!0}catch{return!1}}}const isP2MS=isPaymentFactory(p2ms),isP2PK=isPaymentFactory(p2pk),isP2PKH=isPaymentFactory(p2pkh),isP2WPKH=isPaymentFactory(p2wpkh),isP2WSHScript=isPaymentFactory(p2wsh),isP2SHScript=isPaymentFactory(p2sh),isP2TR=isPaymentFactory(p2tr);function witnessStackToScriptWitness(e){let t=new Uint8Array(0);function r(l){t=concat$1([t,l])}function n(l){const u=t.length,x=encodingLength(l);t=concat$1([t,new Uint8Array(x)]),encode$f(l,t,u)}function s(l){n(l.length),r(l)}function a(l){n(l.length),l.forEach(s)}return a(e),t}function pubkeyPositionInScript(e,t){const r=hash160(e),n=e.slice(1,33),s=decompile(t);if(s===null)throw new Error("Unknown script error");return s.findIndex(a=>typeof a=="number"?!1:compare(e,a)===0||compare(r,a)===0||compare(n,a)===0)}function pubkeyInScript(e,t){return pubkeyPositionInScript(e,t)!==-1}function checkInputForSig(e,t){return extractPartialSigs(e).some(n=>signatureBlocksAction(n,signature.decode,t))}function signatureBlocksAction(e,t,r){const{hashType:n}=t(e),s=[];switch(n&Transaction.SIGHASH_ANYONECANPAY&&s.push("addInput"),n&31){case Transaction.SIGHASH_ALL:break;case Transaction.SIGHASH_SINGLE:case Transaction.SIGHASH_NONE:s.push("addOutput"),s.push("setInputSequence");break}return s.indexOf(r)===-1}function extractPartialSigs(e){let t=[];if((e.partialSig||[]).length===0){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=getPsigsFromInputFinalScripts(e)}else t=e.partialSig;return t.map(r=>r.signature)}function getPsigsFromInputFinalScripts(e){const t=e.finalScriptSig?decompile(e.finalScriptSig)||[]:[],r=e.finalScriptWitness?decompile(e.finalScriptWitness)||[]:[];return t.concat(r).filter(n=>n instanceof Uint8Array&&isCanonicalScriptSignature(n)).map(n=>({signature:n}))}const toXOnly$1=e=>e.length===32?e:e.slice(1,33);function tapScriptFinalizer(e,t,r){const n=findTapLeafToFinalize(t,e,r);try{const a=sortSignatures(t,n).concat(n.script).concat(n.controlBlock);return{finalScriptWitness:witnessStackToScriptWitness(a)}}catch(s){throw new Error(`Can not finalize taproot input #${e}: ${s}`)}}function serializeTaprootSignature(e,t){const r=Uint8Array.from(t?[t]:[]);return concat$1([e,r])}function isTaprootInput(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&isP2TR(e.witnessUtxo.script))}function isTaprootOutput(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t)}function checkTaprootInputFields(e,t,r){checkMixedTaprootAndNonTaprootInputFields(e,t,r),checkIfTapLeafInTree(e,t,r)}function checkTaprootOutputFields(e,t,r){checkMixedTaprootAndNonTaprootOutputFields(e,t,r),checkTaprootScriptPubkey(e,t)}function checkTaprootScriptPubkey(e,t){if(!t.tapTree&&!t.tapInternalKey)return;const r=t.tapInternalKey||e.tapInternalKey,n=t.tapTree||e.tapTree;if(r){const{script:s}=e,a=getTaprootScripPubkey(r,n);if(s&&compare(a,s)!==0)throw new Error("Error adding output. Script or address mismatch.")}}function getTaprootScripPubkey(e,t){const r=t&&tapTreeFromList(t.leaves),{output:n}=p2tr({internalPubkey:e,scriptTree:r});return n}function tapTreeFromList(e=[]){return e.length===1&&e[0].depth===0?{output:e[0].script,version:e[0].leafVersion}:instertLeavesInTree(e)}function checkTaprootInputForSigs(e,t){return extractTaprootSigs(e).some(n=>signatureBlocksAction(n,decodeSchnorrSignature,t))}function decodeSchnorrSignature(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||Transaction.SIGHASH_DEFAULT}}function extractTaprootSigs(e){const t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(r=>r.signature)),!t.length){const r=getTapKeySigFromWitness(e.finalScriptWitness);r&&t.push(r)}return t}function getTapKeySigFromWitness(e){if(!e)return;const t=e.slice(2);if(t.length===64||t.length===65)return t}function instertLeavesInTree(e){let t;for(const r of e)if(t=instertLeafInTree(r,t),!t)throw new Error("No room left to insert tapleaf in tree");return t}function instertLeafInTree(e,t,r=0){if(r>MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===r)return t?void 0:{output:e.script,version:e.leafVersion};if(isTapleaf(t))return;const n=instertLeafInTree(e,t&&t[0],r+1);if(n)return[n,t&&t[1]];const s=instertLeafInTree(e,t&&t[1],r+1);if(s)return[t&&t[0],s]}function checkMixedTaprootAndNonTaprootInputFields(e,t,r){const n=isTaprootInput(e)&&hasNonTaprootFields(t),s=hasNonTaprootFields(e)&&isTaprootInput(t),a=e===t&&isTaprootInput(t)&&hasNonTaprootFields(t);if(n||s||a)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function checkMixedTaprootAndNonTaprootOutputFields(e,t,r){const n=isTaprootOutput(e)&&hasNonTaprootFields(t),s=hasNonTaprootFields(e)&&isTaprootOutput(t),a=e===t&&isTaprootOutput(t)&&hasNonTaprootFields(t);if(n||s||a)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function checkIfTapLeafInTree(e,t,r){if(t.tapMerkleRoot){const n=(t.tapLeafScript||[]).every(a=>isTapLeafInTree(a,t.tapMerkleRoot)),s=(e.tapLeafScript||[]).every(a=>isTapLeafInTree(a,t.tapMerkleRoot));if(!n||!s)throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(s=>isTapLeafInTree(s,e.tapMerkleRoot)))throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}function isTapLeafInTree(e,t){if(!t)return!0;const r=tapleafHash({output:e.script,version:e.leafVersion}),n=rootHashFromPath(e.controlBlock,r);return compare(n,t)===0}function sortSignatures(e,t){const r=tapleafHash({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(n=>compare(n.leafHash,r)===0).map(n=>addPubkeyPositionInScript(t.script,n)).sort((n,s)=>s.positionInScript-n.positionInScript).map(n=>n.signature)}function addPubkeyPositionInScript(e,t){return Object.assign({positionInScript:pubkeyPositionInScript(t.pubkey,e)},t)}function findTapLeafToFinalize(e,t,r){if(!e.tapScriptSig||!e.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);const n=(e.tapLeafScript||[]).sort((s,a)=>s.controlBlock.length-a.controlBlock.length).find(s=>canFinalizeLeaf(s,e.tapScriptSig,r));if(!n)throw new Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return n}function canFinalizeLeaf(e,t,r){const n=tapleafHash({output:e.script,version:e.leafVersion});return(!r||compare(n,r)===0)&&t.find(a=>compare(a.leafHash,n)===0)!==void 0}function hasNonTaprootFields(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}const DEFAULT_OPTS={network:bitcoin$1,maximumFeeRate:5e3};class Psbt{data;static fromBase64(t,r={}){const n=fromBase64(t);return this.fromBuffer(n,r)}static fromHex(t,r={}){const n=fromHex(t);return this.fromBuffer(n,r)}static fromBuffer(t,r={}){const n=Psbt$1.fromBuffer(t,transactionFromBuffer),s=new Psbt(r,n);return checkTxForDupeIns(s.__CACHE.__TX,s.__CACHE),s}__CACHE;opts;constructor(t={},r=new Psbt$1(new PsbtTransaction)){this.data=r,this.opts=Object.assign({},DEFAULT_OPTS,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},this.data.inputs.length===0&&this.setVersion(2);const n=(s,a,l,u)=>Object.defineProperty(s,a,{enumerable:l,writable:u});n(this,"__CACHE",!1,!0),n(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:cloneBuffer(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let r;try{r=fromOutputScript(t.script,this.opts.network)}catch{}return{script:cloneBuffer(t.script),value:t.value,address:r}})}combine(...t){return this.data.combine(...t.map(r=>r.data)),this}clone(){const t=Psbt.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){check32Bit(t),this.opts.maximumFeeRate=t}setVersion(t){check32Bit(t),checkInputsForPartialSig(this.data.inputs,"setVersion");const r=this.__CACHE;return r.__TX.version=t,r.__EXTRACTED_TX=void 0,this}setLocktime(t){check32Bit(t),checkInputsForPartialSig(this.data.inputs,"setLocktime");const r=this.__CACHE;return r.__TX.locktime=t,r.__EXTRACTED_TX=void 0,this}setInputSequence(t,r){check32Bit(r),checkInputsForPartialSig(this.data.inputs,"setInputSequence");const n=this.__CACHE;if(n.__TX.ins.length<=t)throw new Error("Input index too high");return n.__TX.ins[t].sequence=r,n.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(r=>this.addInput(r)),this}addInput(t){if(arguments.length>1||!t||t.hash===void 0||t.index===void 0)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");checkTaprootInputFields(t,t,"addInput"),checkInputsForPartialSig(this.data.inputs,"addInput"),t.witnessScript&&checkInvalidP2WSH(t.witnessScript);const r=this.__CACHE;this.data.addInput(t);const n=r.__TX.ins[r.__TX.ins.length-1];checkTxInputCache(r,n);const s=this.data.inputs.length-1,a=this.data.inputs[s];return a.nonWitnessUtxo&&addNonWitnessTxCache(this.__CACHE,a,s),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(r=>this.addOutput(r)),this}addOutput(t){if(arguments.length>1||!t||t.value===void 0||t.address===void 0&&t.script===void 0)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");checkInputsForPartialSig(this.data.inputs,"addOutput");const{address:r}=t;if(typeof r=="string"){const{network:s}=this.opts,a=toOutputScript(r,s);t=Object.assign({},t,{script:a})}checkTaprootOutputFields(t,t,"addOutput");const n=this.__CACHE;return this.data.addOutput(t),n.__FEE=void 0,n.__FEE_RATE=void 0,n.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(isFinalized))throw new Error("Not finalized");const r=this.__CACHE;if(t||checkFees(this,r,this.opts),r.__EXTRACTED_TX)return r.__EXTRACTED_TX;const n=r.__TX.clone();return inputFinalizeGetAmts(this.data.inputs,n,r,!0),n}getFeeRate(){return getTxCacheValue("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return getTxCacheValue("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return checkForInput(this.data.inputs,0),range(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,r){const n=checkForInput(this.data.inputs,t);return isTaprootInput(n)?this._finalizeTaprootInput(t,n,void 0,r):this._finalizeInput(t,n,r)}finalizeTaprootInput(t,r,n=tapScriptFinalizer){const s=checkForInput(this.data.inputs,t);if(isTaprootInput(s))return this._finalizeTaprootInput(t,s,r,n);throw new Error(`Cannot finalize input #${t}. Not Taproot.`)}_finalizeInput(t,r,n=getFinalScripts){const{script:s,isP2SH:a,isP2WSH:l,isSegwit:u}=getScriptFromInput(t,r,this.__CACHE);if(!s)throw new Error(`No script found for input #${t}`);checkPartialSigSighashes(r);const{finalScriptSig:x,finalScriptWitness:f}=n(t,r,s,u,a,l);if(x&&this.data.updateInput(t,{finalScriptSig:x}),f&&this.data.updateInput(t,{finalScriptWitness:f}),!x&&!f)throw new Error(`Unknown error finalizing input #${t}`);return this.data.clearFinalizedInput(t),this}_finalizeTaprootInput(t,r,n,s=tapScriptFinalizer){if(!r.witnessUtxo)throw new Error(`Cannot finalize input #${t}. Missing withness utxo.`);if(r.tapKeySig){const a=p2tr({output:r.witnessUtxo.script,signature:r.tapKeySig}),l=witnessStackToScriptWitness(a.witness);this.data.updateInput(t,{finalScriptWitness:l})}else{const{finalScriptWitness:a}=s(t,r,n);this.data.updateInput(t,{finalScriptWitness:a})}return this.data.clearFinalizedInput(t),this}getInputType(t){const r=checkForInput(this.data.inputs,t),n=getScriptFromUtxo(t,r,this.__CACHE),s=getMeaningfulScript(n,t,"input",r.redeemScript||redeemFromFinalScriptSig(r.finalScriptSig),r.witnessScript||redeemFromFinalWitnessScript(r.finalScriptWitness)),a=s.type==="raw"?"":s.type+"-",l=classifyScript(s.meaningfulScript);return a+l}inputHasPubkey(t,r){const n=checkForInput(this.data.inputs,t);return pubkeyInInput(r,n,t,this.__CACHE)}inputHasHDKey(t,r){const n=checkForInput(this.data.inputs,t),s=bip32DerivationIsMine(r);return!!n.bip32Derivation&&n.bip32Derivation.some(s)}outputHasPubkey(t,r){const n=checkForOutput(this.data.outputs,t);return pubkeyInOutput(r,n,t,this.__CACHE)}outputHasHDKey(t,r){const n=checkForOutput(this.data.outputs,t),s=bip32DerivationIsMine(r);return!!n.bip32Derivation&&n.bip32Derivation.some(s)}validateSignaturesOfAllInputs(t){return checkForInput(this.data.inputs,0),range(this.data.inputs.length).map(n=>this.validateSignaturesOfInput(n,t)).reduce((n,s)=>s===!0&&n,!0)}validateSignaturesOfInput(t,r,n){const s=this.data.inputs[t];return isTaprootInput(s)?this.validateSignaturesOfTaprootInput(t,r,n):this._validateSignaturesOfInput(t,r,n)}_validateSignaturesOfInput(t,r,n){const s=this.data.inputs[t],a=(s||{}).partialSig;if(!s||!a||a.length<1)throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");const l=n?a.filter(g=>compare(g.pubkey,n)===0):a;if(l.length<1)throw new Error("No signatures for this pubkey");const u=[];let x,f,p;for(const g of l){const y=signature.decode(g.signature),{hash:w,script:R}=p!==y.hashType?getHashForSig(t,Object.assign({},s,{sighashType:y.hashType}),this.__CACHE,!0):{hash:x,script:f};p=y.hashType,x=w,f=R,checkScriptForPubkey(g.pubkey,R,"verify"),u.push(r(g.pubkey,w,y.signature))}return u.every(g=>g===!0)}validateSignaturesOfTaprootInput(t,r,n){const s=this.data.inputs[t],a=(s||{}).tapKeySig,l=(s||{}).tapScriptSig;if(!s&&!a&&!(l&&!l.length))throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");n=n&&toXOnly$1(n);const u=n?getTaprootHashesForSig(t,s,this.data.inputs,n,this.__CACHE):getAllTaprootHashesForSig(t,s,this.data.inputs,this.__CACHE);if(!u.length)throw new Error("No signatures for this pubkey");const x=u.find(p=>!p.leafHash);let f=0;if(a&&x){if(!r(x.pubkey,x.hash,trimTaprootSig(a)))return!1;f++}if(l)for(const p of l){const g=u.find(y=>compare(y.pubkey,p.pubkey)===0);if(g){if(!r(p.pubkey,g.hash,trimTaprootSig(p.signature)))return!1;f++}}return f>0}signAllInputsHD(t,r=[Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");const n=[];for(const s of range(this.data.inputs.length))try{this.signInputHD(s,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(s=>s===!1))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(t,r=[Transaction.SIGHASH_ALL]){return new Promise((n,s)=>{if(!t||!t.publicKey||!t.fingerprint)return s(new Error("Need HDSigner to sign input"));const a=[],l=[];for(const u of range(this.data.inputs.length))l.push(this.signInputHDAsync(u,t,r).then(()=>{a.push(!0)},()=>{a.push(!1)}));return Promise.all(l).then(()=>{if(a.every(u=>u===!1))return s(new Error("No inputs were signed"));n()})})}signInputHD(t,r,n=[Transaction.SIGHASH_ALL]){if(!r||!r.publicKey||!r.fingerprint)throw new Error("Need HDSigner to sign input");return getSignersFromHD(t,this.data.inputs,r).forEach(a=>this.signInput(t,a,n)),this}signInputHDAsync(t,r,n=[Transaction.SIGHASH_ALL]){return new Promise((s,a)=>{if(!r||!r.publicKey||!r.fingerprint)return a(new Error("Need HDSigner to sign input"));const u=getSignersFromHD(t,this.data.inputs,r).map(x=>this.signInputAsync(t,x,n));return Promise.all(u).then(()=>{s()}).catch(a)})}signAllInputs(t,r){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const n=[];for(const s of range(this.data.inputs.length))try{this.signInput(s,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(s=>s===!1))throw new Error("No inputs were signed");return this}signAllInputsAsync(t,r){return new Promise((n,s)=>{if(!t||!t.publicKey)return s(new Error("Need Signer to sign input"));const a=[],l=[];for(const[u]of this.data.inputs.entries())l.push(this.signInputAsync(u,t,r).then(()=>{a.push(!0)},()=>{a.push(!1)}));return Promise.all(l).then(()=>{if(a.every(u=>u===!1))return s(new Error("No inputs were signed"));n()})})}signInput(t,r,n){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const s=checkForInput(this.data.inputs,t);return isTaprootInput(s)?this._signTaprootInput(t,s,r,void 0,n):this._signInput(t,r,n)}signTaprootInput(t,r,n,s){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const a=checkForInput(this.data.inputs,t);if(isTaprootInput(a))return this._signTaprootInput(t,a,r,n,s);throw new Error(`Input #${t} is not of type Taproot.`)}_signInput(t,r,n=[Transaction.SIGHASH_ALL]){const{hash:s,sighashType:a}=getHashAndSighashType(this.data.inputs,t,r.publicKey,this.__CACHE,n),l=[{pubkey:r.publicKey,signature:signature.encode(r.sign(s),a)}];return this.data.updateInput(t,{partialSig:l}),this}_signTaprootInput(t,r,n,s,a=[Transaction.SIGHASH_DEFAULT]){const l=this.checkTaprootHashesForSig(t,r,n,s,a),u=l.filter(f=>!f.leafHash).map(f=>serializeTaprootSignature(n.signSchnorr(f.hash),r.sighashType))[0],x=l.filter(f=>!!f.leafHash).map(f=>({pubkey:toXOnly$1(n.publicKey),signature:serializeTaprootSignature(n.signSchnorr(f.hash),r.sighashType),leafHash:f.leafHash}));return u&&this.data.updateInput(t,{tapKeySig:u}),x.length&&this.data.updateInput(t,{tapScriptSig:x}),this}signInputAsync(t,r,n){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const s=checkForInput(this.data.inputs,t);return isTaprootInput(s)?this._signTaprootInputAsync(t,s,r,void 0,n):this._signInputAsync(t,r,n)})}signTaprootInputAsync(t,r,n,s){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const a=checkForInput(this.data.inputs,t);if(isTaprootInput(a))return this._signTaprootInputAsync(t,a,r,n,s);throw new Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(t,r,n=[Transaction.SIGHASH_ALL]){const{hash:s,sighashType:a}=getHashAndSighashType(this.data.inputs,t,r.publicKey,this.__CACHE,n);return Promise.resolve(r.sign(s)).then(l=>{const u=[{pubkey:r.publicKey,signature:signature.encode(l,a)}];this.data.updateInput(t,{partialSig:u})})}async _signTaprootInputAsync(t,r,n,s,a=[Transaction.SIGHASH_DEFAULT]){const l=this.checkTaprootHashesForSig(t,r,n,s,a),u=[],x=l.filter(p=>!p.leafHash)[0];if(x){const p=Promise.resolve(n.signSchnorr(x.hash)).then(g=>({tapKeySig:serializeTaprootSignature(g,r.sighashType)}));u.push(p)}const f=l.filter(p=>!!p.leafHash);if(f.length){const p=f.map(g=>Promise.resolve(n.signSchnorr(g.hash)).then(y=>({tapScriptSig:[{pubkey:toXOnly$1(n.publicKey),signature:serializeTaprootSignature(y,r.sighashType),leafHash:g.leafHash}]})));u.push(...p)}return Promise.all(u).then(p=>{p.forEach(g=>this.data.updateInput(t,g))})}checkTaprootHashesForSig(t,r,n,s,a){if(typeof n.signSchnorr!="function")throw new Error(`Need Schnorr Signer to sign taproot input #${t}.`);const l=getTaprootHashesForSig(t,r,this.data.inputs,n.publicKey,this.__CACHE,s,a);if(!l||!l.length)throw new Error(`Can not sign for input #${t} with the key ${toHex(n.publicKey)}`);return l}toBuffer(){return checkCache(this.__CACHE),this.data.toBuffer()}toHex(){return checkCache(this.__CACHE),this.data.toHex()}toBase64(){return checkCache(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,r){return r.witnessScript&&checkInvalidP2WSH(r.witnessScript),checkTaprootInputFields(this.data.inputs[t],r,"updateInput"),this.data.updateInput(t,r),r.nonWitnessUtxo&&addNonWitnessTxCache(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,r){const n=this.data.outputs[t];return checkTaprootOutputFields(n,r,"updateOutput"),this.data.updateOutput(t,r),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,r){return this.data.addUnknownKeyValToInput(t,r),this}addUnknownKeyValToOutput(t,r){return this.data.addUnknownKeyValToOutput(t,r),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}}const transactionFromBuffer=e=>new PsbtTransaction(e);class PsbtTransaction{tx;constructor(t=Uint8Array.from([2,0,0,0,0,0,0,0,0,0])){this.tx=Transaction.fromBuffer(t),checkTxEmpty(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(t.hash===void 0||t.index===void 0||!(t.hash instanceof Uint8Array)&&typeof t.hash!="string"||typeof t.index!="number")throw new Error("Error adding input.");const r=typeof t.hash=="string"?reverseBuffer(fromHex(t.hash)):t.hash;this.tx.addInput(r,t.index,t.sequence)}addOutput(t){if(t.script===void 0||t.value===void 0||!(t.script instanceof Uint8Array)||typeof t.value!="bigint")throw new Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}}function canFinalize(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return hasSigs(1,e.partialSig);case"multisig":const n=p2ms({output:t});return hasSigs(n.m,e.partialSig,n.pubkeys);default:return!1}}function checkCache(e){if(e.__UNSAFE_SIGN_NONSEGWIT!==!1)throw new Error("Not BIP174 compliant, can not export")}function hasSigs(e,t,r){if(!t)return!1;let n;if(r?n=r.map(s=>{const a=compressPubkey(s);return t.find(l=>compare(l.pubkey,a)===0)}).filter(s=>!!s):n=t,n.length>e)throw new Error("Too many signatures");return n.length===e}function isFinalized(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function bip32DerivationIsMine(e){return t=>!(compare(e.fingerprint,t.masterFingerprint)||compare(e.derivePath(t.path).publicKey,t.pubkey))}function check32Bit(e){if(typeof e!="number"||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function checkFees(e,t,r){const n=t.__FEE_RATE||e.getFeeRate(),s=t.__EXTRACTED_TX.virtualSize(),a=n*s;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(a/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${s} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}function checkInputsForPartialSig(e,t){e.forEach(r=>{if(isTaprootInput(r)?checkTaprootInputForSigs(r,t):checkInputForSig(r,t))throw new Error("Can not modify transaction, signatures exist.")})}function checkPartialSigSighashes(e){if(!e.sighashType||!e.partialSig)return;const{partialSig:t,sighashType:r}=e;t.forEach(n=>{const{hashType:s}=signature.decode(n.signature);if(r!==s)throw new Error("Signature sighash does not match input sighash type")})}function checkScriptForPubkey(e,t,r){if(!pubkeyInScript(e,t))throw new Error(`Can not ${r} for this input with the key ${toHex(e)}`)}function checkTxEmpty(e){if(!e.ins.every(r=>r.script&&r.script.length===0&&r.witness&&r.witness.length===0))throw new Error("Format Error: Transaction ScriptSigs are not empty")}function checkTxForDupeIns(e,t){e.ins.forEach(r=>{checkTxInputCache(t,r)})}function checkTxInputCache(e,t){const r=toHex(reverseBuffer(Uint8Array.from(t.hash)))+":"+t.index;if(e.__TX_IN_CACHE[r])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function scriptCheckerFactory(e,t){return(r,n,s,a)=>{const l=e({redeem:{output:s}}).output;if(compare(n,l))throw new Error(`${t} for ${a} #${r} doesn't match the scriptPubKey in the prevout`)}}const checkRedeemScript=scriptCheckerFactory(p2sh,"Redeem script"),checkWitnessScript=scriptCheckerFactory(p2wsh,"Witness script");function getTxCacheValue(e,t,r,n){if(!r.every(isFinalized))throw new Error(`PSBT must be finalized to calculate ${t}`);if(e==="__FEE_RATE"&&n.__FEE_RATE)return n.__FEE_RATE;if(e==="__FEE"&&n.__FEE)return n.__FEE;let s,a=!0;if(n.__EXTRACTED_TX?(s=n.__EXTRACTED_TX,a=!1):s=n.__TX.clone(),inputFinalizeGetAmts(r,s,n,a),e==="__FEE_RATE")return n.__FEE_RATE;if(e==="__FEE")return n.__FEE}function getFinalScripts(e,t,r,n,s,a){const l=classifyScript(r);if(!canFinalize(t,r,l))throw new Error(`Can not finalize input #${e}`);return prepareFinalScripts(r,l,t.partialSig,n,s,a)}function prepareFinalScripts(e,t,r,n,s,a){let l,u;const x=getPayment(e,t,r),f=a?p2wsh({redeem:x}):null,p=s?p2sh({redeem:f||x}):null;return n?(f?u=witnessStackToScriptWitness(f.witness):u=witnessStackToScriptWitness(x.witness),p&&(l=p.input)):p?l=p.input:l=x.input,{finalScriptSig:l,finalScriptWitness:u}}function getHashAndSighashType(e,t,r,n,s){const a=checkForInput(e,t),{hash:l,sighashType:u,script:x}=getHashForSig(t,a,n,!1,s);return checkScriptForPubkey(r,x,"sign"),{hash:l,sighashType:u}}function getHashForSig(e,t,r,n,s){const a=r.__TX,l=t.sighashType||Transaction.SIGHASH_ALL;checkSighashTypeAllowed(l,s);let u,x;if(t.nonWitnessUtxo){const g=nonWitnessUtxoTxFromCache(r,t,e),y=a.ins[e].hash,w=g.getHash();if(compare(y,w)!==0)throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);const R=a.ins[e].index;x=g.outs[R]}else if(t.witnessUtxo)x=t.witnessUtxo;else throw new Error("Need a Utxo input item for signing");const{meaningfulScript:f,type:p}=getMeaningfulScript(x.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(p)>=0)u=a.hashForWitnessV0(e,f,x.value,l);else if(isP2WPKH(f)){const g=p2pkh({hash:f.slice(2)}).output;u=a.hashForWitnessV0(e,g,x.value,l)}else{if(t.nonWitnessUtxo===void 0&&r.__UNSAFE_SIGN_NONSEGWIT===!1)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${toHex(f)}`);!n&&r.__UNSAFE_SIGN_NONSEGWIT!==!1&&console.warn(`Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecessor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.
*********************
PROCEED WITH CAUTION!
*********************`),u=a.hashForSignature(e,f,l)}return{script:f,sighashType:l,hash:u}}function getAllTaprootHashesForSig(e,t,r,n){const s=[];if(t.tapInternalKey){const l=getPrevoutTaprootKey(e,t,n);l&&s.push(l)}if(t.tapScriptSig){const l=t.tapScriptSig.map(u=>u.pubkey);s.push(...l)}return s.map(l=>getTaprootHashesForSig(e,t,r,l,n)).flat()}function getPrevoutTaprootKey(e,t,r){const{script:n}=getScriptAndAmountFromUtxo(e,t,r);return isP2TR(n)?n.subarray(2,34):null}function trimTaprootSig(e){return e.length===64?e:e.subarray(0,64)}function getTaprootHashesForSig(e,t,r,n,s,a,l){const u=s.__TX,x=t.sighashType||Transaction.SIGHASH_DEFAULT;checkSighashTypeAllowed(x,l);const f=r.map((R,I)=>getScriptAndAmountFromUtxo(I,R,s)),p=f.map(R=>R.script),g=f.map(R=>R.value),y=[];if(t.tapInternalKey&&!a){const R=getPrevoutTaprootKey(e,t,s)||Uint8Array.from([]);if(compare(toXOnly$1(n),R)===0){const I=u.hashForWitnessV1(e,p,g,x);y.push({pubkey:n,hash:I})}}const w=(t.tapLeafScript||[]).filter(R=>pubkeyInScript(n,R.script)).map(R=>{const I=tapleafHash({output:R.script,version:R.leafVersion});return Object.assign({hash:I},R)}).filter(R=>!a||compare(a,R.hash)===0).map(R=>{const I=u.hashForWitnessV1(e,p,g,x,R.hash);return{pubkey:n,hash:I,leafHash:R.hash}});return y.concat(w)}function checkSighashTypeAllowed(e,t){if(t&&t.indexOf(e)<0){const r=sighashTypeToString(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${r}`)}}function getPayment(e,t,r){let n;switch(t){case"multisig":const s=getSortedSigs(e,r);n=p2ms({output:e,signatures:s});break;case"pubkey":n=p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break}return n}function getScriptFromInput(e,t,r){const n=r.__TX,s={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(s.isP2SH=!!t.redeemScript,s.isP2WSH=!!t.witnessScript,t.witnessScript)s.script=t.witnessScript;else if(t.redeemScript)s.script=t.redeemScript;else if(t.nonWitnessUtxo){const a=nonWitnessUtxoTxFromCache(r,t,e),l=n.ins[e].index;s.script=a.outs[l].script}else t.witnessUtxo&&(s.script=t.witnessUtxo.script);return(t.witnessScript||isP2WPKH(s.script))&&(s.isSegwit=!0),s}function getSignersFromHD(e,t,r){const n=checkForInput(t,e);if(!n.bip32Derivation||n.bip32Derivation.length===0)throw new Error("Need bip32Derivation to sign with HD");const s=n.bip32Derivation.map(l=>{if(compare(l.masterFingerprint,r.fingerprint)===0)return l}).filter(l=>!!l);if(s.length===0)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return s.map(l=>{const u=r.derivePath(l.path);if(compare(l.pubkey,u.publicKey)!==0)throw new Error("pubkey did not match bip32Derivation");return u})}function getSortedSigs(e,t){return p2ms({output:e}).pubkeys.map(n=>(t.filter(s=>compare(s.pubkey,n)===0)[0]||{}).signature).filter(n=>!!n)}function scriptWitnessToWitnessStack(e){let t=0;function r(l){return t+=l,e.slice(t-l,t)}function n(){const l=decode$f(e,t);return t+=encodingLength(l.bigintValue),l.numberValue}function s(){return r(n())}function a(){const l=n(),u=[];for(let x=0;x<l;x++)u.push(s());return u}return a()}function sighashTypeToString(e){let t=e&Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(e&31){case Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case Transaction.SIGHASH_NONE:t+="SIGHASH_NONE";break}return t}function addNonWitnessTxCache(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;const n=Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;const s=e,a=r;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){const l=s.__NON_WITNESS_UTXO_BUF_CACHE[a],u=s.__NON_WITNESS_UTXO_TX_CACHE[a];if(l!==void 0)return l;{const x=u.toBuffer();return s.__NON_WITNESS_UTXO_BUF_CACHE[a]=x,x}},set(l){s.__NON_WITNESS_UTXO_BUF_CACHE[a]=l}})}function inputFinalizeGetAmts(e,t,r,n){let s=0n;e.forEach((x,f)=>{if(n&&x.finalScriptSig&&(t.ins[f].script=x.finalScriptSig),n&&x.finalScriptWitness&&(t.ins[f].witness=scriptWitnessToWitnessStack(x.finalScriptWitness)),x.witnessUtxo)s+=x.witnessUtxo.value;else if(x.nonWitnessUtxo){const p=nonWitnessUtxoTxFromCache(r,x,f),g=t.ins[f].index,y=p.outs[g];s+=y.value}});const a=t.outs.reduce((x,f)=>x+f.value,0n),l=s-a;if(l<0)throw new Error("Outputs are spending more than Inputs");const u=t.virtualSize();r.__FEE=l,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(Number(l/BigInt(u)))}function nonWitnessUtxoTxFromCache(e,t,r){const n=e.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||addNonWitnessTxCache(e,t,r),n[r]}function getScriptFromUtxo(e,t,r){const{script:n}=getScriptAndAmountFromUtxo(e,t,r);return n}function getScriptAndAmountFromUtxo(e,t,r){if(t.witnessUtxo!==void 0)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(t.nonWitnessUtxo!==void 0){const s=nonWitnessUtxoTxFromCache(r,t,e).outs[r.__TX.ins[e].index];return{script:s.script,value:s.value}}else throw new Error("Can't find pubkey in input without Utxo data")}function pubkeyInInput(e,t,r,n){const s=getScriptFromUtxo(r,t,n),{meaningfulScript:a}=getMeaningfulScript(s,r,"input",t.redeemScript,t.witnessScript);return pubkeyInScript(e,a)}function pubkeyInOutput(e,t,r,n){const s=n.__TX.outs[r].script,{meaningfulScript:a}=getMeaningfulScript(s,r,"output",t.redeemScript,t.witnessScript);return pubkeyInScript(e,a)}function redeemFromFinalScriptSig(e){if(!e)return;const t=decompile(e);if(!t)return;const r=t[t.length-1];if(!(!(r instanceof Uint8Array)||isPubkeyLike(r)||isSigLike(r)||!decompile(r)))return r}function redeemFromFinalWitnessScript(e){if(!e)return;const t=scriptWitnessToWitnessStack(e),r=t[t.length-1];if(!(isPubkeyLike(r)||!decompile(r)))return r}function compressPubkey(e){if(e.length===65){const t=e[64]&1,r=e.slice(0,33);return r[0]=2|t,r}return e.slice()}function isPubkeyLike(e){return e.length===33&&isCanonicalPubKey(e)}function isSigLike(e){return isCanonicalScriptSignature(e)}function getMeaningfulScript(e,t,r,n,s){const a=isP2SHScript(e),l=a&&n&&isP2WSHScript(n),u=isP2WSHScript(e);if(a&&n===void 0)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((u||l)&&s===void 0)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let x;return l?(x=s,checkRedeemScript(t,e,n,r),checkWitnessScript(t,n,s,r),checkInvalidP2WSH(x)):u?(x=s,checkWitnessScript(t,e,s,r),checkInvalidP2WSH(x)):a?(x=n,checkRedeemScript(t,e,n,r)):x=e,{meaningfulScript:x,type:l?"p2sh-p2wsh":a?"p2sh":u?"p2wsh":"raw"}}function checkInvalidP2WSH(e){if(isP2WPKH(e)||isP2SHScript(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function classifyScript(e){return isP2WPKH(e)?"witnesspubkeyhash":isP2PKH(e)?"pubkeyhash":isP2MS(e)?"multisig":isP2PK(e)?"pubkey":"nonstandard"}function range(e){return[...Array(e).keys()]}var dist={},secp256k1={},sha2={},_md={},utils$4={},crypto$1={},hasRequiredCrypto;function requireCrypto(){return hasRequiredCrypto||(hasRequiredCrypto=1,Object.defineProperty(crypto$1,"__esModule",{value:!0}),crypto$1.crypto=void 0,crypto$1.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0),crypto$1}var hasRequiredUtils$4;function requireUtils$4(){return hasRequiredUtils$4||(hasRequiredUtils$4=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.Hash=e.nextTick=e.swap32IfBE=e.byteSwapIfBE=e.swap8IfBE=e.isLE=void 0,e.isBytes=r,e.anumber=n,e.abytes=s,e.ahash=a,e.aexists=l,e.aoutput=u,e.u8=x,e.u32=f,e.clean=p,e.createView=g,e.rotr=y,e.rotl=w,e.byteSwap=R,e.byteSwap32=I,e.bytesToHex=Ve,e.hexToBytes=We,e.asyncLoop=W,e.utf8ToBytes=Ye,e.bytesToUtf8=Qe,e.toBytes=it,e.kdfInputToBytes=ze,e.concatBytes=v,e.checkOpts=D,e.createHasher=P,e.createOptHasher=Re,e.createXOFer=Fe,e.randomBytes=Le;const t=requireCrypto();function r(Ce){return Ce instanceof Uint8Array||ArrayBuffer.isView(Ce)&&Ce.constructor.name==="Uint8Array"}function n(Ce){if(!Number.isSafeInteger(Ce)||Ce<0)throw new Error("positive integer expected, got "+Ce)}function s(Ce,...L){if(!r(Ce))throw new Error("Uint8Array expected");if(L.length>0&&!L.includes(Ce.length))throw new Error("Uint8Array expected of length "+L+", got length="+Ce.length)}function a(Ce){if(typeof Ce!="function"||typeof Ce.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");n(Ce.outputLen),n(Ce.blockLen)}function l(Ce,L=!0){if(Ce.destroyed)throw new Error("Hash instance has been destroyed");if(L&&Ce.finished)throw new Error("Hash#digest() has already been called")}function u(Ce,L){s(Ce);const O=L.outputLen;if(Ce.length<O)throw new Error("digestInto() expects output buffer of length at least "+O)}function x(Ce){return new Uint8Array(Ce.buffer,Ce.byteOffset,Ce.byteLength)}function f(Ce){return new Uint32Array(Ce.buffer,Ce.byteOffset,Math.floor(Ce.byteLength/4))}function p(...Ce){for(let L=0;L<Ce.length;L++)Ce[L].fill(0)}function g(Ce){return new DataView(Ce.buffer,Ce.byteOffset,Ce.byteLength)}function y(Ce,L){return Ce<<32-L|Ce>>>L}function w(Ce,L){return Ce<<L|Ce>>>32-L>>>0}e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function R(Ce){return Ce<<24&4278190080|Ce<<8&16711680|Ce>>>8&65280|Ce>>>24&255}e.swap8IfBE=e.isLE?Ce=>Ce:Ce=>R(Ce),e.byteSwapIfBE=e.swap8IfBE;function I(Ce){for(let L=0;L<Ce.length;L++)Ce[L]=R(Ce[L]);return Ce}e.swap32IfBE=e.isLE?Ce=>Ce:I;const k=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",je=Array.from({length:256},(Ce,L)=>L.toString(16).padStart(2,"0"));function Ve(Ce){if(s(Ce),k)return Ce.toHex();let L="";for(let O=0;O<Ce.length;O++)L+=je[Ce[O]];return L}const q={_0:48,_9:57,A:65,F:70,a:97,f:102};function $e(Ce){if(Ce>=q._0&&Ce<=q._9)return Ce-q._0;if(Ce>=q.A&&Ce<=q.F)return Ce-(q.A-10);if(Ce>=q.a&&Ce<=q.f)return Ce-(q.a-10)}function We(Ce){if(typeof Ce!="string")throw new Error("hex string expected, got "+typeof Ce);if(k)return Uint8Array.fromHex(Ce);const L=Ce.length,O=L/2;if(L%2)throw new Error("hex string expected, got unpadded hex of length "+L);const st=new Uint8Array(O);for(let lt=0,Xe=0;lt<O;lt++,Xe+=2){const dt=$e(Ce.charCodeAt(Xe)),er=$e(Ce.charCodeAt(Xe+1));if(dt===void 0||er===void 0){const ar=Ce[Xe]+Ce[Xe+1];throw new Error('hex string expected, got non-hex character "'+ar+'" at index '+Xe)}st[lt]=dt*16+er}return st}const K=async()=>{};e.nextTick=K;async function W(Ce,L,O){let st=Date.now();for(let lt=0;lt<Ce;lt++){O(lt);const Xe=Date.now()-st;Xe>=0&&Xe<L||(await(0,e.nextTick)(),st+=Xe)}}function Ye(Ce){if(typeof Ce!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(Ce))}function Qe(Ce){return new TextDecoder().decode(Ce)}function it(Ce){return typeof Ce=="string"&&(Ce=Ye(Ce)),s(Ce),Ce}function ze(Ce){return typeof Ce=="string"&&(Ce=Ye(Ce)),s(Ce),Ce}function v(...Ce){let L=0;for(let st=0;st<Ce.length;st++){const lt=Ce[st];s(lt),L+=lt.length}const O=new Uint8Array(L);for(let st=0,lt=0;st<Ce.length;st++){const Xe=Ce[st];O.set(Xe,lt),lt+=Xe.length}return O}function D(Ce,L){if(L!==void 0&&{}.toString.call(L)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(Ce,L)}class _e{}e.Hash=_e;function P(Ce){const L=st=>Ce().update(it(st)).digest(),O=Ce();return L.outputLen=O.outputLen,L.blockLen=O.blockLen,L.create=()=>Ce(),L}function Re(Ce){const L=(st,lt)=>Ce(lt).update(it(st)).digest(),O=Ce({});return L.outputLen=O.outputLen,L.blockLen=O.blockLen,L.create=st=>Ce(st),L}function Fe(Ce){const L=(st,lt)=>Ce(lt).update(it(st)).digest(),O=Ce({});return L.outputLen=O.outputLen,L.blockLen=O.blockLen,L.create=st=>Ce(st),L}e.wrapConstructor=P,e.wrapConstructorWithOpts=Re,e.wrapXOFConstructorWithOpts=Fe;function Le(Ce=32){if(t.crypto&&typeof t.crypto.getRandomValues=="function")return t.crypto.getRandomValues(new Uint8Array(Ce));if(t.crypto&&typeof t.crypto.randomBytes=="function")return Uint8Array.from(t.crypto.randomBytes(Ce));throw new Error("crypto.getRandomValues must be defined")}})(utils$4)),utils$4}var hasRequired_md;function require_md(){if(hasRequired_md)return _md;hasRequired_md=1,Object.defineProperty(_md,"__esModule",{value:!0}),_md.SHA512_IV=_md.SHA384_IV=_md.SHA224_IV=_md.SHA256_IV=_md.HashMD=void 0,_md.setBigUint64=t,_md.Chi=r,_md.Maj=n;const e=requireUtils$4();function t(a,l,u,x){if(typeof a.setBigUint64=="function")return a.setBigUint64(l,u,x);const f=BigInt(32),p=BigInt(4294967295),g=Number(u>>f&p),y=Number(u&p),w=x?4:0,R=x?0:4;a.setUint32(l+w,g,x),a.setUint32(l+R,y,x)}function r(a,l,u){return a&l^~a&u}function n(a,l,u){return a&l^a&u^l&u}class s extends e.Hash{constructor(l,u,x,f){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=l,this.outputLen=u,this.padOffset=x,this.isLE=f,this.buffer=new Uint8Array(l),this.view=(0,e.createView)(this.buffer)}update(l){(0,e.aexists)(this),l=(0,e.toBytes)(l),(0,e.abytes)(l);const{view:u,buffer:x,blockLen:f}=this,p=l.length;for(let g=0;g<p;){const y=Math.min(f-this.pos,p-g);if(y===f){const w=(0,e.createView)(l);for(;f<=p-g;g+=f)this.process(w,g);continue}x.set(l.subarray(g,g+y),this.pos),this.pos+=y,g+=y,this.pos===f&&(this.process(u,0),this.pos=0)}return this.length+=l.length,this.roundClean(),this}digestInto(l){(0,e.aexists)(this),(0,e.aoutput)(l,this),this.finished=!0;const{buffer:u,view:x,blockLen:f,isLE:p}=this;let{pos:g}=this;u[g++]=128,(0,e.clean)(this.buffer.subarray(g)),this.padOffset>f-g&&(this.process(x,0),g=0);for(let k=g;k<f;k++)u[k]=0;t(x,f-8,BigInt(this.length*8),p),this.process(x,0);const y=(0,e.createView)(l),w=this.outputLen;if(w%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const R=w/4,I=this.get();if(R>I.length)throw new Error("_sha2: outputLen bigger than state");for(let k=0;k<R;k++)y.setUint32(4*k,I[k],p)}digest(){const{buffer:l,outputLen:u}=this;this.digestInto(l);const x=l.slice(0,u);return this.destroy(),x}_cloneInto(l){l||(l=new this.constructor),l.set(...this.get());const{blockLen:u,buffer:x,length:f,finished:p,destroyed:g,pos:y}=this;return l.destroyed=g,l.finished=p,l.length=f,l.pos=y,f%u&&l.buffer.set(x),l}clone(){return this._cloneInto()}}return _md.HashMD=s,_md.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),_md.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),_md.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),_md.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),_md}var _u64={},hasRequired_u64;function require_u64(){if(hasRequired_u64)return _u64;hasRequired_u64=1,Object.defineProperty(_u64,"__esModule",{value:!0}),_u64.toBig=_u64.shrSL=_u64.shrSH=_u64.rotrSL=_u64.rotrSH=_u64.rotrBL=_u64.rotrBH=_u64.rotr32L=_u64.rotr32H=_u64.rotlSL=_u64.rotlSH=_u64.rotlBL=_u64.rotlBH=_u64.add5L=_u64.add5H=_u64.add4L=_u64.add4H=_u64.add3L=_u64.add3H=void 0,_u64.add=je,_u64.fromBig=r,_u64.split=n;const e=BigInt(2**32-1),t=BigInt(32);function r(Qe,it=!1){return it?{h:Number(Qe&e),l:Number(Qe>>t&e)}:{h:Number(Qe>>t&e)|0,l:Number(Qe&e)|0}}function n(Qe,it=!1){const ze=Qe.length;let v=new Uint32Array(ze),D=new Uint32Array(ze);for(let _e=0;_e<ze;_e++){const{h:P,l:Re}=r(Qe[_e],it);[v[_e],D[_e]]=[P,Re]}return[v,D]}const s=(Qe,it)=>BigInt(Qe>>>0)<<t|BigInt(it>>>0);_u64.toBig=s;const a=(Qe,it,ze)=>Qe>>>ze;_u64.shrSH=a;const l=(Qe,it,ze)=>Qe<<32-ze|it>>>ze;_u64.shrSL=l;const u=(Qe,it,ze)=>Qe>>>ze|it<<32-ze;_u64.rotrSH=u;const x=(Qe,it,ze)=>Qe<<32-ze|it>>>ze;_u64.rotrSL=x;const f=(Qe,it,ze)=>Qe<<64-ze|it>>>ze-32;_u64.rotrBH=f;const p=(Qe,it,ze)=>Qe>>>ze-32|it<<64-ze;_u64.rotrBL=p;const g=(Qe,it)=>it;_u64.rotr32H=g;const y=(Qe,it)=>Qe;_u64.rotr32L=y;const w=(Qe,it,ze)=>Qe<<ze|it>>>32-ze;_u64.rotlSH=w;const R=(Qe,it,ze)=>it<<ze|Qe>>>32-ze;_u64.rotlSL=R;const I=(Qe,it,ze)=>it<<ze-32|Qe>>>64-ze;_u64.rotlBH=I;const k=(Qe,it,ze)=>Qe<<ze-32|it>>>64-ze;_u64.rotlBL=k;function je(Qe,it,ze,v){const D=(it>>>0)+(v>>>0);return{h:Qe+ze+(D/2**32|0)|0,l:D|0}}const Ve=(Qe,it,ze)=>(Qe>>>0)+(it>>>0)+(ze>>>0);_u64.add3L=Ve;const q=(Qe,it,ze,v)=>it+ze+v+(Qe/2**32|0)|0;_u64.add3H=q;const $e=(Qe,it,ze,v)=>(Qe>>>0)+(it>>>0)+(ze>>>0)+(v>>>0);_u64.add4L=$e;const We=(Qe,it,ze,v,D)=>it+ze+v+D+(Qe/2**32|0)|0;_u64.add4H=We;const K=(Qe,it,ze,v,D)=>(Qe>>>0)+(it>>>0)+(ze>>>0)+(v>>>0)+(D>>>0);_u64.add5L=K;const W=(Qe,it,ze,v,D,_e)=>it+ze+v+D+_e+(Qe/2**32|0)|0;_u64.add5H=W;const Ye={fromBig:r,split:n,toBig:s,shrSH:a,shrSL:l,rotrSH:u,rotrSL:x,rotrBH:f,rotrBL:p,rotr32H:g,rotr32L:y,rotlSH:w,rotlSL:R,rotlBH:I,rotlBL:k,add:je,add3L:Ve,add3H:q,add4L:$e,add4H:We,add5H:W,add5L:K};return _u64.default=Ye,_u64}var hasRequiredSha2;function requireSha2(){if(hasRequiredSha2)return sha2;hasRequiredSha2=1,Object.defineProperty(sha2,"__esModule",{value:!0}),sha2.sha512_224=sha2.sha512_256=sha2.sha384=sha2.sha512=sha2.sha224=sha2.sha256=sha2.SHA512_256=sha2.SHA512_224=sha2.SHA384=sha2.SHA512=sha2.SHA224=sha2.SHA256=void 0;const e=require_md(),t=require_u64(),r=requireUtils$4(),n=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),s=new Uint32Array(64);class a extends e.HashMD{constructor(q=32){super(64,q,8,!1),this.A=e.SHA256_IV[0]|0,this.B=e.SHA256_IV[1]|0,this.C=e.SHA256_IV[2]|0,this.D=e.SHA256_IV[3]|0,this.E=e.SHA256_IV[4]|0,this.F=e.SHA256_IV[5]|0,this.G=e.SHA256_IV[6]|0,this.H=e.SHA256_IV[7]|0}get(){const{A:q,B:$e,C:We,D:K,E:W,F:Ye,G:Qe,H:it}=this;return[q,$e,We,K,W,Ye,Qe,it]}set(q,$e,We,K,W,Ye,Qe,it){this.A=q|0,this.B=$e|0,this.C=We|0,this.D=K|0,this.E=W|0,this.F=Ye|0,this.G=Qe|0,this.H=it|0}process(q,$e){for(let D=0;D<16;D++,$e+=4)s[D]=q.getUint32($e,!1);for(let D=16;D<64;D++){const _e=s[D-15],P=s[D-2],Re=(0,r.rotr)(_e,7)^(0,r.rotr)(_e,18)^_e>>>3,Fe=(0,r.rotr)(P,17)^(0,r.rotr)(P,19)^P>>>10;s[D]=Fe+s[D-7]+Re+s[D-16]|0}let{A:We,B:K,C:W,D:Ye,E:Qe,F:it,G:ze,H:v}=this;for(let D=0;D<64;D++){const _e=(0,r.rotr)(Qe,6)^(0,r.rotr)(Qe,11)^(0,r.rotr)(Qe,25),P=v+_e+(0,e.Chi)(Qe,it,ze)+n[D]+s[D]|0,Fe=((0,r.rotr)(We,2)^(0,r.rotr)(We,13)^(0,r.rotr)(We,22))+(0,e.Maj)(We,K,W)|0;v=ze,ze=it,it=Qe,Qe=Ye+P|0,Ye=W,W=K,K=We,We=P+Fe|0}We=We+this.A|0,K=K+this.B|0,W=W+this.C|0,Ye=Ye+this.D|0,Qe=Qe+this.E|0,it=it+this.F|0,ze=ze+this.G|0,v=v+this.H|0,this.set(We,K,W,Ye,Qe,it,ze,v)}roundClean(){(0,r.clean)(s)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,r.clean)(this.buffer)}}sha2.SHA256=a;class l extends a{constructor(){super(28),this.A=e.SHA224_IV[0]|0,this.B=e.SHA224_IV[1]|0,this.C=e.SHA224_IV[2]|0,this.D=e.SHA224_IV[3]|0,this.E=e.SHA224_IV[4]|0,this.F=e.SHA224_IV[5]|0,this.G=e.SHA224_IV[6]|0,this.H=e.SHA224_IV[7]|0}}sha2.SHA224=l;const u=t.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(Ve=>BigInt(Ve))),x=u[0],f=u[1],p=new Uint32Array(80),g=new Uint32Array(80);class y extends e.HashMD{constructor(q=64){super(128,q,16,!1),this.Ah=e.SHA512_IV[0]|0,this.Al=e.SHA512_IV[1]|0,this.Bh=e.SHA512_IV[2]|0,this.Bl=e.SHA512_IV[3]|0,this.Ch=e.SHA512_IV[4]|0,this.Cl=e.SHA512_IV[5]|0,this.Dh=e.SHA512_IV[6]|0,this.Dl=e.SHA512_IV[7]|0,this.Eh=e.SHA512_IV[8]|0,this.El=e.SHA512_IV[9]|0,this.Fh=e.SHA512_IV[10]|0,this.Fl=e.SHA512_IV[11]|0,this.Gh=e.SHA512_IV[12]|0,this.Gl=e.SHA512_IV[13]|0,this.Hh=e.SHA512_IV[14]|0,this.Hl=e.SHA512_IV[15]|0}get(){const{Ah:q,Al:$e,Bh:We,Bl:K,Ch:W,Cl:Ye,Dh:Qe,Dl:it,Eh:ze,El:v,Fh:D,Fl:_e,Gh:P,Gl:Re,Hh:Fe,Hl:Le}=this;return[q,$e,We,K,W,Ye,Qe,it,ze,v,D,_e,P,Re,Fe,Le]}set(q,$e,We,K,W,Ye,Qe,it,ze,v,D,_e,P,Re,Fe,Le){this.Ah=q|0,this.Al=$e|0,this.Bh=We|0,this.Bl=K|0,this.Ch=W|0,this.Cl=Ye|0,this.Dh=Qe|0,this.Dl=it|0,this.Eh=ze|0,this.El=v|0,this.Fh=D|0,this.Fl=_e|0,this.Gh=P|0,this.Gl=Re|0,this.Hh=Fe|0,this.Hl=Le|0}process(q,$e){for(let O=0;O<16;O++,$e+=4)p[O]=q.getUint32($e),g[O]=q.getUint32($e+=4);for(let O=16;O<80;O++){const st=p[O-15]|0,lt=g[O-15]|0,Xe=t.rotrSH(st,lt,1)^t.rotrSH(st,lt,8)^t.shrSH(st,lt,7),dt=t.rotrSL(st,lt,1)^t.rotrSL(st,lt,8)^t.shrSL(st,lt,7),er=p[O-2]|0,ar=g[O-2]|0,dr=t.rotrSH(er,ar,19)^t.rotrBH(er,ar,61)^t.shrSH(er,ar,6),ir=t.rotrSL(er,ar,19)^t.rotrBL(er,ar,61)^t.shrSL(er,ar,6),pt=t.add4L(dt,ir,g[O-7],g[O-16]),tr=t.add4H(pt,Xe,dr,p[O-7],p[O-16]);p[O]=tr|0,g[O]=pt|0}let{Ah:We,Al:K,Bh:W,Bl:Ye,Ch:Qe,Cl:it,Dh:ze,Dl:v,Eh:D,El:_e,Fh:P,Fl:Re,Gh:Fe,Gl:Le,Hh:Ce,Hl:L}=this;for(let O=0;O<80;O++){const st=t.rotrSH(D,_e,14)^t.rotrSH(D,_e,18)^t.rotrBH(D,_e,41),lt=t.rotrSL(D,_e,14)^t.rotrSL(D,_e,18)^t.rotrBL(D,_e,41),Xe=D&P^~D&Fe,dt=_e&Re^~_e&Le,er=t.add5L(L,lt,dt,f[O],g[O]),ar=t.add5H(er,Ce,st,Xe,x[O],p[O]),dr=er|0,ir=t.rotrSH(We,K,28)^t.rotrBH(We,K,34)^t.rotrBH(We,K,39),pt=t.rotrSL(We,K,28)^t.rotrBL(We,K,34)^t.rotrBL(We,K,39),tr=We&W^We&Qe^W&Qe,sr=K&Ye^K&it^Ye&it;Ce=Fe|0,L=Le|0,Fe=P|0,Le=Re|0,P=D|0,Re=_e|0,{h:D,l:_e}=t.add(ze|0,v|0,ar|0,dr|0),ze=Qe|0,v=it|0,Qe=W|0,it=Ye|0,W=We|0,Ye=K|0;const nr=t.add3L(dr,pt,sr);We=t.add3H(nr,ar,ir,tr),K=nr|0}({h:We,l:K}=t.add(this.Ah|0,this.Al|0,We|0,K|0)),{h:W,l:Ye}=t.add(this.Bh|0,this.Bl|0,W|0,Ye|0),{h:Qe,l:it}=t.add(this.Ch|0,this.Cl|0,Qe|0,it|0),{h:ze,l:v}=t.add(this.Dh|0,this.Dl|0,ze|0,v|0),{h:D,l:_e}=t.add(this.Eh|0,this.El|0,D|0,_e|0),{h:P,l:Re}=t.add(this.Fh|0,this.Fl|0,P|0,Re|0),{h:Fe,l:Le}=t.add(this.Gh|0,this.Gl|0,Fe|0,Le|0),{h:Ce,l:L}=t.add(this.Hh|0,this.Hl|0,Ce|0,L|0),this.set(We,K,W,Ye,Qe,it,ze,v,D,_e,P,Re,Fe,Le,Ce,L)}roundClean(){(0,r.clean)(p,g)}destroy(){(0,r.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}sha2.SHA512=y;class w extends y{constructor(){super(48),this.Ah=e.SHA384_IV[0]|0,this.Al=e.SHA384_IV[1]|0,this.Bh=e.SHA384_IV[2]|0,this.Bl=e.SHA384_IV[3]|0,this.Ch=e.SHA384_IV[4]|0,this.Cl=e.SHA384_IV[5]|0,this.Dh=e.SHA384_IV[6]|0,this.Dl=e.SHA384_IV[7]|0,this.Eh=e.SHA384_IV[8]|0,this.El=e.SHA384_IV[9]|0,this.Fh=e.SHA384_IV[10]|0,this.Fl=e.SHA384_IV[11]|0,this.Gh=e.SHA384_IV[12]|0,this.Gl=e.SHA384_IV[13]|0,this.Hh=e.SHA384_IV[14]|0,this.Hl=e.SHA384_IV[15]|0}}sha2.SHA384=w;const R=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),I=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class k extends y{constructor(){super(28),this.Ah=R[0]|0,this.Al=R[1]|0,this.Bh=R[2]|0,this.Bl=R[3]|0,this.Ch=R[4]|0,this.Cl=R[5]|0,this.Dh=R[6]|0,this.Dl=R[7]|0,this.Eh=R[8]|0,this.El=R[9]|0,this.Fh=R[10]|0,this.Fl=R[11]|0,this.Gh=R[12]|0,this.Gl=R[13]|0,this.Hh=R[14]|0,this.Hl=R[15]|0}}sha2.SHA512_224=k;class je extends y{constructor(){super(32),this.Ah=I[0]|0,this.Al=I[1]|0,this.Bh=I[2]|0,this.Bl=I[3]|0,this.Ch=I[4]|0,this.Cl=I[5]|0,this.Dh=I[6]|0,this.Dl=I[7]|0,this.Eh=I[8]|0,this.El=I[9]|0,this.Fh=I[10]|0,this.Fl=I[11]|0,this.Gh=I[12]|0,this.Gl=I[13]|0,this.Hh=I[14]|0,this.Hl=I[15]|0}}return sha2.SHA512_256=je,sha2.sha256=(0,r.createHasher)(()=>new a),sha2.sha224=(0,r.createHasher)(()=>new l),sha2.sha512=(0,r.createHasher)(()=>new y),sha2.sha384=(0,r.createHasher)(()=>new w),sha2.sha512_256=(0,r.createHasher)(()=>new je),sha2.sha512_224=(0,r.createHasher)(()=>new k),sha2}var _shortw_utils={},weierstrass={},hmac={},hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;const t=requireUtils$4();class r extends t.Hash{constructor(a,l){super(),this.finished=!1,this.destroyed=!1,(0,t.ahash)(a);const u=(0,t.toBytes)(l);if(this.iHash=a.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const x=this.blockLen,f=new Uint8Array(x);f.set(u.length>x?a.create().update(u).digest():u);for(let p=0;p<f.length;p++)f[p]^=54;this.iHash.update(f),this.oHash=a.create();for(let p=0;p<f.length;p++)f[p]^=106;this.oHash.update(f),(0,t.clean)(f)}update(a){return(0,t.aexists)(this),this.iHash.update(a),this}digestInto(a){(0,t.aexists)(this),(0,t.abytes)(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){const a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));const{oHash:l,iHash:u,finished:x,destroyed:f,blockLen:p,outputLen:g}=this;return a=a,a.finished=x,a.destroyed=f,a.blockLen=p,a.outputLen=g,a.oHash=l._cloneInto(a.oHash),a.iHash=u._cloneInto(a.iHash),a}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.HMAC=r;const n=(s,a,l)=>new r(s,a).update(l).digest();e.hmac=n,e.hmac.create=(s,a)=>new r(s,a)})(hmac)),hmac}var utils$3={},hasRequiredUtils$3;function requireUtils$3(){return hasRequiredUtils$3||(hasRequiredUtils$3=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.notImplemented=e.bitMask=e.utf8ToBytes=e.randomBytes=e.isBytes=e.hexToBytes=e.concatBytes=e.bytesToUtf8=e.bytesToHex=e.anumber=e.abytes=void 0,e.abool=a,e._abool2=l,e._abytes2=u,e.numberToHexUnpadded=x,e.hexToNumber=f,e.bytesToNumberBE=p,e.bytesToNumberLE=g,e.numberToBytesBE=y,e.numberToBytesLE=w,e.numberToVarBytesBE=R,e.ensureBytes=I,e.equalBytes=k,e.copyBytes=je,e.asciiToBytes=Ve,e.inRange=$e,e.aInRange=We,e.bitLen=K,e.bitGet=W,e.bitSet=Ye,e.createHmacDrbg=it,e.validateObject=v,e.isHash=D,e._validateObject=_e,e.memoized=Re;const t=requireUtils$4();var r=requireUtils$4();Object.defineProperty(e,"abytes",{enumerable:!0,get:function(){return r.abytes}}),Object.defineProperty(e,"anumber",{enumerable:!0,get:function(){return r.anumber}}),Object.defineProperty(e,"bytesToHex",{enumerable:!0,get:function(){return r.bytesToHex}}),Object.defineProperty(e,"bytesToUtf8",{enumerable:!0,get:function(){return r.bytesToUtf8}}),Object.defineProperty(e,"concatBytes",{enumerable:!0,get:function(){return r.concatBytes}}),Object.defineProperty(e,"hexToBytes",{enumerable:!0,get:function(){return r.hexToBytes}}),Object.defineProperty(e,"isBytes",{enumerable:!0,get:function(){return r.isBytes}}),Object.defineProperty(e,"randomBytes",{enumerable:!0,get:function(){return r.randomBytes}}),Object.defineProperty(e,"utf8ToBytes",{enumerable:!0,get:function(){return r.utf8ToBytes}});const n=BigInt(0),s=BigInt(1);function a(Fe,Le){if(typeof Le!="boolean")throw new Error(Fe+" boolean expected, got "+Le)}function l(Fe,Le=""){if(typeof Fe!="boolean"){const Ce=Le&&`"${Le}"`;throw new Error(Ce+"expected boolean, got type="+typeof Fe)}return Fe}function u(Fe,Le,Ce=""){const L=(0,t.isBytes)(Fe),O=Fe?.length,st=Le!==void 0;if(!L||st&&O!==Le){const lt=Ce&&`"${Ce}" `,Xe=st?` of length ${Le}`:"",dt=L?`length=${O}`:`type=${typeof Fe}`;throw new Error(lt+"expected Uint8Array"+Xe+", got "+dt)}return Fe}function x(Fe){const Le=Fe.toString(16);return Le.length&1?"0"+Le:Le}function f(Fe){if(typeof Fe!="string")throw new Error("hex string expected, got "+typeof Fe);return Fe===""?n:BigInt("0x"+Fe)}function p(Fe){return f((0,t.bytesToHex)(Fe))}function g(Fe){return(0,t.abytes)(Fe),f((0,t.bytesToHex)(Uint8Array.from(Fe).reverse()))}function y(Fe,Le){return(0,t.hexToBytes)(Fe.toString(16).padStart(Le*2,"0"))}function w(Fe,Le){return y(Fe,Le).reverse()}function R(Fe){return(0,t.hexToBytes)(x(Fe))}function I(Fe,Le,Ce){let L;if(typeof Le=="string")try{L=(0,t.hexToBytes)(Le)}catch(st){throw new Error(Fe+" must be hex string or Uint8Array, cause: "+st)}else if((0,t.isBytes)(Le))L=Uint8Array.from(Le);else throw new Error(Fe+" must be hex string or Uint8Array");const O=L.length;if(typeof Ce=="number"&&O!==Ce)throw new Error(Fe+" of length "+Ce+" expected, got "+O);return L}function k(Fe,Le){if(Fe.length!==Le.length)return!1;let Ce=0;for(let L=0;L<Fe.length;L++)Ce|=Fe[L]^Le[L];return Ce===0}function je(Fe){return Uint8Array.from(Fe)}function Ve(Fe){return Uint8Array.from(Fe,(Le,Ce)=>{const L=Le.charCodeAt(0);if(Le.length!==1||L>127)throw new Error(`string contains non-ASCII character "${Fe[Ce]}" with code ${L} at position ${Ce}`);return L})}const q=Fe=>typeof Fe=="bigint"&&n<=Fe;function $e(Fe,Le,Ce){return q(Fe)&&q(Le)&&q(Ce)&&Le<=Fe&&Fe<Ce}function We(Fe,Le,Ce,L){if(!$e(Le,Ce,L))throw new Error("expected valid "+Fe+": "+Ce+" <= n < "+L+", got "+Le)}function K(Fe){let Le;for(Le=0;Fe>n;Fe>>=s,Le+=1);return Le}function W(Fe,Le){return Fe>>BigInt(Le)&s}function Ye(Fe,Le,Ce){return Fe|(Ce?s:n)<<BigInt(Le)}const Qe=Fe=>(s<<BigInt(Fe))-s;e.bitMask=Qe;function it(Fe,Le,Ce){if(typeof Fe!="number"||Fe<2)throw new Error("hashLen must be a number");if(typeof Le!="number"||Le<2)throw new Error("qByteLen must be a number");if(typeof Ce!="function")throw new Error("hmacFn must be a function");const L=pt=>new Uint8Array(pt),O=pt=>Uint8Array.of(pt);let st=L(Fe),lt=L(Fe),Xe=0;const dt=()=>{st.fill(1),lt.fill(0),Xe=0},er=(...pt)=>Ce(lt,st,...pt),ar=(pt=L(0))=>{lt=er(O(0),pt),st=er(),pt.length!==0&&(lt=er(O(1),pt),st=er())},dr=()=>{if(Xe++>=1e3)throw new Error("drbg: tried 1000 values");let pt=0;const tr=[];for(;pt<Le;){st=er();const sr=st.slice();tr.push(sr),pt+=st.length}return(0,t.concatBytes)(...tr)};return(pt,tr)=>{dt(),ar(pt);let sr;for(;!(sr=tr(dr()));)ar();return dt(),sr}}const ze={bigint:Fe=>typeof Fe=="bigint",function:Fe=>typeof Fe=="function",boolean:Fe=>typeof Fe=="boolean",string:Fe=>typeof Fe=="string",stringOrUint8Array:Fe=>typeof Fe=="string"||(0,t.isBytes)(Fe),isSafeInteger:Fe=>Number.isSafeInteger(Fe),array:Fe=>Array.isArray(Fe),field:(Fe,Le)=>Le.Fp.isValid(Fe),hash:Fe=>typeof Fe=="function"&&Number.isSafeInteger(Fe.outputLen)};function v(Fe,Le,Ce={}){const L=(O,st,lt)=>{const Xe=ze[st];if(typeof Xe!="function")throw new Error("invalid validator function");const dt=Fe[O];if(!(lt&&dt===void 0)&&!Xe(dt,Fe))throw new Error("param "+String(O)+" is invalid. Expected "+st+", got "+dt)};for(const[O,st]of Object.entries(Le))L(O,st,!1);for(const[O,st]of Object.entries(Ce))L(O,st,!0);return Fe}function D(Fe){return typeof Fe=="function"&&Number.isSafeInteger(Fe.outputLen)}function _e(Fe,Le,Ce={}){if(!Fe||typeof Fe!="object")throw new Error("expected valid options object");function L(O,st,lt){const Xe=Fe[O];if(lt&&Xe===void 0)return;const dt=typeof Xe;if(dt!==st||Xe===null)throw new Error(`param "${O}" is invalid: expected ${st}, got ${dt}`)}Object.entries(Le).forEach(([O,st])=>L(O,st,!1)),Object.entries(Ce).forEach(([O,st])=>L(O,st,!0))}const P=()=>{throw new Error("not implemented")};e.notImplemented=P;function Re(Fe){const Le=new WeakMap;return(Ce,...L)=>{const O=Le.get(Ce);if(O!==void 0)return O;const st=Fe(Ce,...L);return Le.set(Ce,st),st}}})(utils$3)),utils$3}var curve={},modular={},hasRequiredModular;function requireModular(){if(hasRequiredModular)return modular;hasRequiredModular=1,Object.defineProperty(modular,"__esModule",{value:!0}),modular.isNegativeLE=void 0,modular.mod=g,modular.pow=y,modular.pow2=w,modular.invert=R,modular.tonelliShanks=q,modular.FpSqrt=$e,modular.validateField=W,modular.FpPow=Ye,modular.FpInvertBatch=Qe,modular.FpDiv=it,modular.FpLegendre=ze,modular.FpIsSquare=v,modular.nLength=D,modular.Field=_e,modular.FpSqrtOdd=P,modular.FpSqrtEven=Re,modular.hashToPrivateScalar=Fe,modular.getFieldBytesLength=Le,modular.getMinHashLength=Ce,modular.mapHashToField=L;const e=requireUtils$3(),t=BigInt(0),r=BigInt(1),n=BigInt(2),s=BigInt(3),a=BigInt(4),l=BigInt(5),u=BigInt(7),x=BigInt(8),f=BigInt(9),p=BigInt(16);function g(O,st){const lt=O%st;return lt>=t?lt:st+lt}function y(O,st,lt){return Ye(_e(lt),O,st)}function w(O,st,lt){let Xe=O;for(;st-- >t;)Xe*=Xe,Xe%=lt;return Xe}function R(O,st){if(O===t)throw new Error("invert: expected non-zero number");if(st<=t)throw new Error("invert: expected positive modulus, got "+st);let lt=g(O,st),Xe=st,dt=t,er=r;for(;lt!==t;){const dr=Xe/lt,ir=Xe%lt,pt=dt-er*dr;Xe=lt,lt=ir,dt=er,er=pt}if(Xe!==r)throw new Error("invert: does not exist");return g(dt,st)}function I(O,st,lt){if(!O.eql(O.sqr(st),lt))throw new Error("Cannot find square root")}function k(O,st){const lt=(O.ORDER+r)/a,Xe=O.pow(st,lt);return I(O,Xe,st),Xe}function je(O,st){const lt=(O.ORDER-l)/x,Xe=O.mul(st,n),dt=O.pow(Xe,lt),er=O.mul(st,dt),ar=O.mul(O.mul(er,n),dt),dr=O.mul(er,O.sub(ar,O.ONE));return I(O,dr,st),dr}function Ve(O){const st=_e(O),lt=q(O),Xe=lt(st,st.neg(st.ONE)),dt=lt(st,Xe),er=lt(st,st.neg(Xe)),ar=(O+u)/p;return(dr,ir)=>{let pt=dr.pow(ir,ar),tr=dr.mul(pt,Xe);const sr=dr.mul(pt,dt),nr=dr.mul(pt,er),pr=dr.eql(dr.sqr(tr),ir),gr=dr.eql(dr.sqr(sr),ir);pt=dr.cmov(pt,tr,pr),tr=dr.cmov(nr,sr,gr);const mr=dr.eql(dr.sqr(tr),ir),yr=dr.cmov(pt,tr,mr);return I(dr,yr,ir),yr}}function q(O){if(O<s)throw new Error("sqrt is not defined for small field");let st=O-r,lt=0;for(;st%n===t;)st/=n,lt++;let Xe=n;const dt=_e(O);for(;ze(dt,Xe)===1;)if(Xe++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(lt===1)return k;let er=dt.pow(Xe,st);const ar=(st+r)/n;return function(ir,pt){if(ir.is0(pt))return pt;if(ze(ir,pt)!==1)throw new Error("Cannot find square root");let tr=lt,sr=ir.mul(ir.ONE,er),nr=ir.pow(pt,st),pr=ir.pow(pt,ar);for(;!ir.eql(nr,ir.ONE);){if(ir.is0(nr))return ir.ZERO;let gr=1,mr=ir.sqr(nr);for(;!ir.eql(mr,ir.ONE);)if(gr++,mr=ir.sqr(mr),gr===tr)throw new Error("Cannot find square root");const yr=r<<BigInt(tr-gr-1),Er=ir.pow(sr,yr);tr=gr,sr=ir.sqr(Er),nr=ir.mul(nr,sr),pr=ir.mul(pr,Er)}return pr}}function $e(O){return O%a===s?k:O%x===l?je:O%p===f?Ve(O):q(O)}const We=(O,st)=>(g(O,st)&r)===r;modular.isNegativeLE=We;const K=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function W(O){const st={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},lt=K.reduce((Xe,dt)=>(Xe[dt]="function",Xe),st);return(0,e._validateObject)(O,lt),O}function Ye(O,st,lt){if(lt<t)throw new Error("invalid exponent, negatives unsupported");if(lt===t)return O.ONE;if(lt===r)return st;let Xe=O.ONE,dt=st;for(;lt>t;)lt&r&&(Xe=O.mul(Xe,dt)),dt=O.sqr(dt),lt>>=r;return Xe}function Qe(O,st,lt=!1){const Xe=new Array(st.length).fill(lt?O.ZERO:void 0),dt=st.reduce((ar,dr,ir)=>O.is0(dr)?ar:(Xe[ir]=ar,O.mul(ar,dr)),O.ONE),er=O.inv(dt);return st.reduceRight((ar,dr,ir)=>O.is0(dr)?ar:(Xe[ir]=O.mul(ar,Xe[ir]),O.mul(ar,dr)),er),Xe}function it(O,st,lt){return O.mul(st,typeof lt=="bigint"?R(lt,O.ORDER):O.inv(lt))}function ze(O,st){const lt=(O.ORDER-r)/n,Xe=O.pow(st,lt),dt=O.eql(Xe,O.ONE),er=O.eql(Xe,O.ZERO),ar=O.eql(Xe,O.neg(O.ONE));if(!dt&&!er&&!ar)throw new Error("invalid Legendre symbol result");return dt?1:er?0:-1}function v(O,st){return ze(O,st)===1}function D(O,st){st!==void 0&&(0,e.anumber)(st);const lt=st!==void 0?st:O.toString(2).length,Xe=Math.ceil(lt/8);return{nBitLength:lt,nByteLength:Xe}}function _e(O,st,lt=!1,Xe={}){if(O<=t)throw new Error("invalid field: expected ORDER > 0, got "+O);let dt,er,ar=!1,dr;if(typeof st=="object"&&st!=null){if(Xe.sqrt||lt)throw new Error("cannot specify opts in two arguments");const nr=st;nr.BITS&&(dt=nr.BITS),nr.sqrt&&(er=nr.sqrt),typeof nr.isLE=="boolean"&&(lt=nr.isLE),typeof nr.modFromBytes=="boolean"&&(ar=nr.modFromBytes),dr=nr.allowedLengths}else typeof st=="number"&&(dt=st),Xe.sqrt&&(er=Xe.sqrt);const{nBitLength:ir,nByteLength:pt}=D(O,dt);if(pt>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let tr;const sr=Object.freeze({ORDER:O,isLE:lt,BITS:ir,BYTES:pt,MASK:(0,e.bitMask)(ir),ZERO:t,ONE:r,allowedLengths:dr,create:nr=>g(nr,O),isValid:nr=>{if(typeof nr!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof nr);return t<=nr&&nr<O},is0:nr=>nr===t,isValidNot0:nr=>!sr.is0(nr)&&sr.isValid(nr),isOdd:nr=>(nr&r)===r,neg:nr=>g(-nr,O),eql:(nr,pr)=>nr===pr,sqr:nr=>g(nr*nr,O),add:(nr,pr)=>g(nr+pr,O),sub:(nr,pr)=>g(nr-pr,O),mul:(nr,pr)=>g(nr*pr,O),pow:(nr,pr)=>Ye(sr,nr,pr),div:(nr,pr)=>g(nr*R(pr,O),O),sqrN:nr=>nr*nr,addN:(nr,pr)=>nr+pr,subN:(nr,pr)=>nr-pr,mulN:(nr,pr)=>nr*pr,inv:nr=>R(nr,O),sqrt:er||(nr=>(tr||(tr=$e(O)),tr(sr,nr))),toBytes:nr=>lt?(0,e.numberToBytesLE)(nr,pt):(0,e.numberToBytesBE)(nr,pt),fromBytes:(nr,pr=!0)=>{if(dr){if(!dr.includes(nr.length)||nr.length>pt)throw new Error("Field.fromBytes: expected "+dr+" bytes, got "+nr.length);const mr=new Uint8Array(pt);mr.set(nr,lt?0:mr.length-nr.length),nr=mr}if(nr.length!==pt)throw new Error("Field.fromBytes: expected "+pt+" bytes, got "+nr.length);let gr=lt?(0,e.bytesToNumberLE)(nr):(0,e.bytesToNumberBE)(nr);if(ar&&(gr=g(gr,O)),!pr&&!sr.isValid(gr))throw new Error("invalid field element: outside of range 0..ORDER");return gr},invertBatch:nr=>Qe(sr,nr),cmov:(nr,pr,gr)=>gr?pr:nr});return Object.freeze(sr)}function P(O,st){if(!O.isOdd)throw new Error("Field doesn't have isOdd");const lt=O.sqrt(st);return O.isOdd(lt)?lt:O.neg(lt)}function Re(O,st){if(!O.isOdd)throw new Error("Field doesn't have isOdd");const lt=O.sqrt(st);return O.isOdd(lt)?O.neg(lt):lt}function Fe(O,st,lt=!1){O=(0,e.ensureBytes)("privateHash",O);const Xe=O.length,dt=D(st).nByteLength+8;if(dt<24||Xe<dt||Xe>1024)throw new Error("hashToPrivateScalar: expected "+dt+"-1024 bytes of input, got "+Xe);const er=lt?(0,e.bytesToNumberLE)(O):(0,e.bytesToNumberBE)(O);return g(er,st-r)+r}function Le(O){if(typeof O!="bigint")throw new Error("field order must be bigint");const st=O.toString(2).length;return Math.ceil(st/8)}function Ce(O){const st=Le(O);return st+Math.ceil(st/2)}function L(O,st,lt=!1){const Xe=O.length,dt=Le(st),er=Ce(st);if(Xe<16||Xe<er||Xe>1024)throw new Error("expected "+er+"-1024 bytes of input, got "+Xe);const ar=lt?(0,e.bytesToNumberLE)(O):(0,e.bytesToNumberBE)(O),dr=g(ar,st-r)+r;return lt?(0,e.numberToBytesLE)(dr,dt):(0,e.numberToBytesBE)(dr,dt)}return modular}var hasRequiredCurve;function requireCurve(){if(hasRequiredCurve)return curve;hasRequiredCurve=1,Object.defineProperty(curve,"__esModule",{value:!0}),curve.wNAF=void 0,curve.negateCt=s,curve.normalizeZ=a,curve.mulEndoUnsafe=k,curve.pippenger=je,curve.precomputeMSMUnsafe=Ve,curve.validateBasic=q,curve._createCurveFields=We;const e=requireUtils$3(),t=requireModular(),r=BigInt(0),n=BigInt(1);function s(K,W){const Ye=W.negate();return K?Ye:W}function a(K,W){const Ye=(0,t.FpInvertBatch)(K.Fp,W.map(Qe=>Qe.Z));return W.map((Qe,it)=>K.fromAffine(Qe.toAffine(Ye[it])))}function l(K,W){if(!Number.isSafeInteger(K)||K<=0||K>W)throw new Error("invalid window size, expected [1.."+W+"], got W="+K)}function u(K,W){l(K,W);const Ye=Math.ceil(W/K)+1,Qe=2**(K-1),it=2**K,ze=(0,e.bitMask)(K),v=BigInt(K);return{windows:Ye,windowSize:Qe,mask:ze,maxNumber:it,shiftBy:v}}function x(K,W,Ye){const{windowSize:Qe,mask:it,maxNumber:ze,shiftBy:v}=Ye;let D=Number(K&it),_e=K>>v;D>Qe&&(D-=ze,_e+=n);const P=W*Qe,Re=P+Math.abs(D)-1,Fe=D===0,Le=D<0,Ce=W%2!==0;return{nextN:_e,offset:Re,isZero:Fe,isNeg:Le,isNegF:Ce,offsetF:P}}function f(K,W){if(!Array.isArray(K))throw new Error("array expected");K.forEach((Ye,Qe)=>{if(!(Ye instanceof W))throw new Error("invalid point at index "+Qe)})}function p(K,W){if(!Array.isArray(K))throw new Error("array of scalars expected");K.forEach((Ye,Qe)=>{if(!W.isValid(Ye))throw new Error("invalid scalar at index "+Qe)})}const g=new WeakMap,y=new WeakMap;function w(K){return y.get(K)||1}function R(K){if(K!==r)throw new Error("invalid wNAF")}class I{constructor(W,Ye){this.BASE=W.BASE,this.ZERO=W.ZERO,this.Fn=W.Fn,this.bits=Ye}_unsafeLadder(W,Ye,Qe=this.ZERO){let it=W;for(;Ye>r;)Ye&n&&(Qe=Qe.add(it)),it=it.double(),Ye>>=n;return Qe}precomputeWindow(W,Ye){const{windows:Qe,windowSize:it}=u(Ye,this.bits),ze=[];let v=W,D=v;for(let _e=0;_e<Qe;_e++){D=v,ze.push(D);for(let P=1;P<it;P++)D=D.add(v),ze.push(D);v=D.double()}return ze}wNAF(W,Ye,Qe){if(!this.Fn.isValid(Qe))throw new Error("invalid scalar");let it=this.ZERO,ze=this.BASE;const v=u(W,this.bits);for(let D=0;D<v.windows;D++){const{nextN:_e,offset:P,isZero:Re,isNeg:Fe,isNegF:Le,offsetF:Ce}=x(Qe,D,v);Qe=_e,Re?ze=ze.add(s(Le,Ye[Ce])):it=it.add(s(Fe,Ye[P]))}return R(Qe),{p:it,f:ze}}wNAFUnsafe(W,Ye,Qe,it=this.ZERO){const ze=u(W,this.bits);for(let v=0;v<ze.windows&&Qe!==r;v++){const{nextN:D,offset:_e,isZero:P,isNeg:Re}=x(Qe,v,ze);if(Qe=D,!P){const Fe=Ye[_e];it=it.add(Re?Fe.negate():Fe)}}return R(Qe),it}getPrecomputes(W,Ye,Qe){let it=g.get(Ye);return it||(it=this.precomputeWindow(Ye,W),W!==1&&(typeof Qe=="function"&&(it=Qe(it)),g.set(Ye,it))),it}cached(W,Ye,Qe){const it=w(W);return this.wNAF(it,this.getPrecomputes(it,W,Qe),Ye)}unsafe(W,Ye,Qe,it){const ze=w(W);return ze===1?this._unsafeLadder(W,Ye,it):this.wNAFUnsafe(ze,this.getPrecomputes(ze,W,Qe),Ye,it)}createCache(W,Ye){l(Ye,this.bits),y.set(W,Ye),g.delete(W)}hasCache(W){return w(W)!==1}}curve.wNAF=I;function k(K,W,Ye,Qe){let it=W,ze=K.ZERO,v=K.ZERO;for(;Ye>r||Qe>r;)Ye&n&&(ze=ze.add(it)),Qe&n&&(v=v.add(it)),it=it.double(),Ye>>=n,Qe>>=n;return{p1:ze,p2:v}}function je(K,W,Ye,Qe){f(Ye,K),p(Qe,W);const it=Ye.length,ze=Qe.length;if(it!==ze)throw new Error("arrays of points and scalars must have equal length");const v=K.ZERO,D=(0,e.bitLen)(BigInt(it));let _e=1;D>12?_e=D-3:D>4?_e=D-2:D>0&&(_e=2);const P=(0,e.bitMask)(_e),Re=new Array(Number(P)+1).fill(v),Fe=Math.floor((W.BITS-1)/_e)*_e;let Le=v;for(let Ce=Fe;Ce>=0;Ce-=_e){Re.fill(v);for(let O=0;O<ze;O++){const st=Qe[O],lt=Number(st>>BigInt(Ce)&P);Re[lt]=Re[lt].add(Ye[O])}let L=v;for(let O=Re.length-1,st=v;O>0;O--)st=st.add(Re[O]),L=L.add(st);if(Le=Le.add(L),Ce!==0)for(let O=0;O<_e;O++)Le=Le.double()}return Le}function Ve(K,W,Ye,Qe){l(Qe,W.BITS),f(Ye,K);const it=K.ZERO,ze=2**Qe-1,v=Math.ceil(W.BITS/Qe),D=(0,e.bitMask)(Qe),_e=Ye.map(P=>{const Re=[];for(let Fe=0,Le=P;Fe<ze;Fe++)Re.push(Le),Le=Le.add(P);return Re});return P=>{if(p(P,W),P.length>Ye.length)throw new Error("array of scalars must be smaller than array of points");let Re=it;for(let Fe=0;Fe<v;Fe++){if(Re!==it)for(let Ce=0;Ce<Qe;Ce++)Re=Re.double();const Le=BigInt(v*Qe-(Fe+1)*Qe);for(let Ce=0;Ce<P.length;Ce++){const L=P[Ce],O=Number(L>>Le&D);O&&(Re=Re.add(_e[Ce][O-1]))}}return Re}}function q(K){return(0,t.validateField)(K.Fp),(0,e.validateObject)(K,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,t.nLength)(K.n,K.nBitLength),...K,p:K.Fp.ORDER})}function $e(K,W,Ye){if(W){if(W.ORDER!==K)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,t.validateField)(W),W}else return(0,t.Field)(K,{isLE:Ye})}function We(K,W,Ye={},Qe){if(Qe===void 0&&(Qe=K==="edwards"),!W||typeof W!="object")throw new Error(`expected valid ${K} CURVE object`);for(const _e of["p","n","h"]){const P=W[_e];if(!(typeof P=="bigint"&&P>r))throw new Error(`CURVE.${_e} must be positive bigint`)}const it=$e(W.p,Ye.Fp,Qe),ze=$e(W.n,Ye.Fn,Qe),D=["Gx","Gy","a",K==="weierstrass"?"b":"d"];for(const _e of D)if(!it.isValid(W[_e]))throw new Error(`CURVE.${_e} must be valid field element of CURVE.Fp`);return W=Object.freeze(Object.assign({},W)),{CURVE:W,Fp:it,Fn:ze}}return curve}var hasRequiredWeierstrass;function requireWeierstrass(){return hasRequiredWeierstrass||(hasRequiredWeierstrass=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DER=e.DERErr=void 0,e._splitEndoScalar=u,e._normFnElement=k,e.weierstrassN=je,e.SWUFpSqrtRatio=q,e.mapToCurveSimpleSWU=$e,e.ecdh=K,e.ecdsa=W,e.weierstrassPoints=Ye,e._legacyHelperEquat=ze,e.weierstrass=_e;const t=requireHmac(),r=requireUtils$4(),n=requireUtils$3(),s=requireCurve(),a=requireModular(),l=(P,Re)=>(P+(P>=0?Re:-Re)/w)/Re;function u(P,Re,Fe){const[[Le,Ce],[L,O]]=Re,st=l(O*P,Fe),lt=l(-Ce*P,Fe);let Xe=P-st*Le-lt*L,dt=-st*Ce-lt*O;const er=Xe<g,ar=dt<g;er&&(Xe=-Xe),ar&&(dt=-dt);const dr=(0,n.bitMask)(Math.ceil((0,n.bitLen)(Fe)/2))+y;if(Xe<g||Xe>=dr||dt<g||dt>=dr)throw new Error("splitScalar (endomorphism): failed, k="+P);return{k1neg:er,k1:Xe,k2neg:ar,k2:dt}}function x(P){if(!["compact","recovered","der"].includes(P))throw new Error('Signature format must be "compact", "recovered", or "der"');return P}function f(P,Re){const Fe={};for(let Le of Object.keys(Re))Fe[Le]=P[Le]===void 0?Re[Le]:P[Le];return(0,n._abool2)(Fe.lowS,"lowS"),(0,n._abool2)(Fe.prehash,"prehash"),Fe.format!==void 0&&x(Fe.format),Fe}class p extends Error{constructor(Re=""){super(Re)}}e.DERErr=p,e.DER={Err:p,_tlv:{encode:(P,Re)=>{const{Err:Fe}=e.DER;if(P<0||P>256)throw new Fe("tlv.encode: wrong tag");if(Re.length&1)throw new Fe("tlv.encode: unpadded data");const Le=Re.length/2,Ce=(0,n.numberToHexUnpadded)(Le);if(Ce.length/2&128)throw new Fe("tlv.encode: long form length too big");const L=Le>127?(0,n.numberToHexUnpadded)(Ce.length/2|128):"";return(0,n.numberToHexUnpadded)(P)+L+Ce+Re},decode(P,Re){const{Err:Fe}=e.DER;let Le=0;if(P<0||P>256)throw new Fe("tlv.encode: wrong tag");if(Re.length<2||Re[Le++]!==P)throw new Fe("tlv.decode: wrong tlv");const Ce=Re[Le++],L=!!(Ce&128);let O=0;if(!L)O=Ce;else{const lt=Ce&127;if(!lt)throw new Fe("tlv.decode(long): indefinite length not supported");if(lt>4)throw new Fe("tlv.decode(long): byte length is too big");const Xe=Re.subarray(Le,Le+lt);if(Xe.length!==lt)throw new Fe("tlv.decode: length bytes not complete");if(Xe[0]===0)throw new Fe("tlv.decode(long): zero leftmost byte");for(const dt of Xe)O=O<<8|dt;if(Le+=lt,O<128)throw new Fe("tlv.decode(long): not minimal encoding")}const st=Re.subarray(Le,Le+O);if(st.length!==O)throw new Fe("tlv.decode: wrong value length");return{v:st,l:Re.subarray(Le+O)}}},_int:{encode(P){const{Err:Re}=e.DER;if(P<g)throw new Re("integer: negative integers are not allowed");let Fe=(0,n.numberToHexUnpadded)(P);if(Number.parseInt(Fe[0],16)&8&&(Fe="00"+Fe),Fe.length&1)throw new Re("unexpected DER parsing assertion: unpadded hex");return Fe},decode(P){const{Err:Re}=e.DER;if(P[0]&128)throw new Re("invalid signature integer: negative");if(P[0]===0&&!(P[1]&128))throw new Re("invalid signature integer: unnecessary leading zero");return(0,n.bytesToNumberBE)(P)}},toSig(P){const{Err:Re,_int:Fe,_tlv:Le}=e.DER,Ce=(0,n.ensureBytes)("signature",P),{v:L,l:O}=Le.decode(48,Ce);if(O.length)throw new Re("invalid signature: left bytes after parsing");const{v:st,l:lt}=Le.decode(2,L),{v:Xe,l:dt}=Le.decode(2,lt);if(dt.length)throw new Re("invalid signature: left bytes after parsing");return{r:Fe.decode(st),s:Fe.decode(Xe)}},hexFromSig(P){const{_tlv:Re,_int:Fe}=e.DER,Le=Re.encode(2,Fe.encode(P.r)),Ce=Re.encode(2,Fe.encode(P.s)),L=Le+Ce;return Re.encode(48,L)}};const g=BigInt(0),y=BigInt(1),w=BigInt(2),R=BigInt(3),I=BigInt(4);function k(P,Re){const{BYTES:Fe}=P;let Le;if(typeof Re=="bigint")Le=Re;else{let Ce=(0,n.ensureBytes)("private key",Re);try{Le=P.fromBytes(Ce)}catch{throw new Error(`invalid private key: expected ui8a of size ${Fe}, got ${typeof Re}`)}}if(!P.isValidNot0(Le))throw new Error("invalid private key: out of range [1..N-1]");return Le}function je(P,Re={}){const Fe=(0,s._createCurveFields)("weierstrass",P,Re),{Fp:Le,Fn:Ce}=Fe;let L=Fe.CURVE;const{h:O,n:st}=L;(0,n._validateObject)(Re,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:lt}=Re;if(lt&&(!Le.is0(L.a)||typeof lt.beta!="bigint"||!Array.isArray(lt.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const Xe=We(Le,Ce);function dt(){if(!Le.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function er(Dr,rr,cr){const{x:Br,y:br}=rr.toAffine(),lr=Le.toBytes(Br);if((0,n._abool2)(cr,"isCompressed"),cr){dt();const Sr=!Le.isOdd(br);return(0,n.concatBytes)(Ve(Sr),lr)}else return(0,n.concatBytes)(Uint8Array.of(4),lr,Le.toBytes(br))}function ar(Dr){(0,n._abytes2)(Dr,void 0,"Point");const{publicKey:rr,publicKeyUncompressed:cr}=Xe,Br=Dr.length,br=Dr[0],lr=Dr.subarray(1);if(Br===rr&&(br===2||br===3)){const Sr=Le.fromBytes(lr);if(!Le.isValid(Sr))throw new Error("bad point: is not on curve, wrong x");const yt=pt(Sr);let Je;try{Je=Le.sqrt(yt)}catch(Ar){const _r=Ar instanceof Error?": "+Ar.message:"";throw new Error("bad point: is not on curve, sqrt error"+_r)}dt();const ft=Le.isOdd(Je);return(br&1)===1!==ft&&(Je=Le.neg(Je)),{x:Sr,y:Je}}else if(Br===cr&&br===4){const Sr=Le.BYTES,yt=Le.fromBytes(lr.subarray(0,Sr)),Je=Le.fromBytes(lr.subarray(Sr,Sr*2));if(!tr(yt,Je))throw new Error("bad point: is not on curve");return{x:yt,y:Je}}else throw new Error(`bad point: got length ${Br}, expected compressed=${rr} or uncompressed=${cr}`)}const dr=Re.toBytes||er,ir=Re.fromBytes||ar;function pt(Dr){const rr=Le.sqr(Dr),cr=Le.mul(rr,Dr);return Le.add(Le.add(cr,Le.mul(Dr,L.a)),L.b)}function tr(Dr,rr){const cr=Le.sqr(rr),Br=pt(Dr);return Le.eql(cr,Br)}if(!tr(L.Gx,L.Gy))throw new Error("bad curve params: generator point");const sr=Le.mul(Le.pow(L.a,R),I),nr=Le.mul(Le.sqr(L.b),BigInt(27));if(Le.is0(Le.add(sr,nr)))throw new Error("bad curve params: a or b");function pr(Dr,rr,cr=!1){if(!Le.isValid(rr)||cr&&Le.is0(rr))throw new Error(`bad point coordinate ${Dr}`);return rr}function gr(Dr){if(!(Dr instanceof Cr))throw new Error("ProjectivePoint expected")}function mr(Dr){if(!lt||!lt.basises)throw new Error("no endo");return u(Dr,lt.basises,Ce.ORDER)}const yr=(0,n.memoized)((Dr,rr)=>{const{X:cr,Y:Br,Z:br}=Dr;if(Le.eql(br,Le.ONE))return{x:cr,y:Br};const lr=Dr.is0();rr==null&&(rr=lr?Le.ONE:Le.inv(br));const Sr=Le.mul(cr,rr),yt=Le.mul(Br,rr),Je=Le.mul(br,rr);if(lr)return{x:Le.ZERO,y:Le.ZERO};if(!Le.eql(Je,Le.ONE))throw new Error("invZ was invalid");return{x:Sr,y:yt}}),Er=(0,n.memoized)(Dr=>{if(Dr.is0()){if(Re.allowInfinityPoint&&!Le.is0(Dr.Y))return;throw new Error("bad point: ZERO")}const{x:rr,y:cr}=Dr.toAffine();if(!Le.isValid(rr)||!Le.isValid(cr))throw new Error("bad point: x or y not field elements");if(!tr(rr,cr))throw new Error("bad point: equation left != right");if(!Dr.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function xr(Dr,rr,cr,Br,br){return cr=new Cr(Le.mul(cr.X,Dr),cr.Y,cr.Z),rr=(0,s.negateCt)(Br,rr),cr=(0,s.negateCt)(br,cr),rr.add(cr)}class Cr{constructor(rr,cr,Br){this.X=pr("x",rr),this.Y=pr("y",cr,!0),this.Z=pr("z",Br),Object.freeze(this)}static CURVE(){return L}static fromAffine(rr){const{x:cr,y:Br}=rr||{};if(!rr||!Le.isValid(cr)||!Le.isValid(Br))throw new Error("invalid affine point");if(rr instanceof Cr)throw new Error("projective point not allowed");return Le.is0(cr)&&Le.is0(Br)?Cr.ZERO:new Cr(cr,Br,Le.ONE)}static fromBytes(rr){const cr=Cr.fromAffine(ir((0,n._abytes2)(rr,void 0,"point")));return cr.assertValidity(),cr}static fromHex(rr){return Cr.fromBytes((0,n.ensureBytes)("pointHex",rr))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(rr=8,cr=!0){return kr.createCache(this,rr),cr||this.multiply(R),this}assertValidity(){Er(this)}hasEvenY(){const{y:rr}=this.toAffine();if(!Le.isOdd)throw new Error("Field doesn't support isOdd");return!Le.isOdd(rr)}equals(rr){gr(rr);const{X:cr,Y:Br,Z:br}=this,{X:lr,Y:Sr,Z:yt}=rr,Je=Le.eql(Le.mul(cr,yt),Le.mul(lr,br)),ft=Le.eql(Le.mul(Br,yt),Le.mul(Sr,br));return Je&&ft}negate(){return new Cr(this.X,Le.neg(this.Y),this.Z)}double(){const{a:rr,b:cr}=L,Br=Le.mul(cr,R),{X:br,Y:lr,Z:Sr}=this;let yt=Le.ZERO,Je=Le.ZERO,ft=Le.ZERO,or=Le.mul(br,br),Ar=Le.mul(lr,lr),_r=Le.mul(Sr,Sr),Nr=Le.mul(br,lr);return Nr=Le.add(Nr,Nr),ft=Le.mul(br,Sr),ft=Le.add(ft,ft),yt=Le.mul(rr,ft),Je=Le.mul(Br,_r),Je=Le.add(yt,Je),yt=Le.sub(Ar,Je),Je=Le.add(Ar,Je),Je=Le.mul(yt,Je),yt=Le.mul(Nr,yt),ft=Le.mul(Br,ft),_r=Le.mul(rr,_r),Nr=Le.sub(or,_r),Nr=Le.mul(rr,Nr),Nr=Le.add(Nr,ft),ft=Le.add(or,or),or=Le.add(ft,or),or=Le.add(or,_r),or=Le.mul(or,Nr),Je=Le.add(Je,or),_r=Le.mul(lr,Sr),_r=Le.add(_r,_r),or=Le.mul(_r,Nr),yt=Le.sub(yt,or),ft=Le.mul(_r,Ar),ft=Le.add(ft,ft),ft=Le.add(ft,ft),new Cr(yt,Je,ft)}add(rr){gr(rr);const{X:cr,Y:Br,Z:br}=this,{X:lr,Y:Sr,Z:yt}=rr;let Je=Le.ZERO,ft=Le.ZERO,or=Le.ZERO;const Ar=L.a,_r=Le.mul(L.b,R);let Nr=Le.mul(cr,lr),Hr=Le.mul(Br,Sr),Gr=Le.mul(br,yt),Vr=Le.add(cr,Br),zr=Le.add(lr,Sr);Vr=Le.mul(Vr,zr),zr=Le.add(Nr,Hr),Vr=Le.sub(Vr,zr),zr=Le.add(cr,br);let Zr=Le.add(lr,yt);return zr=Le.mul(zr,Zr),Zr=Le.add(Nr,Gr),zr=Le.sub(zr,Zr),Zr=Le.add(Br,br),Je=Le.add(Sr,yt),Zr=Le.mul(Zr,Je),Je=Le.add(Hr,Gr),Zr=Le.sub(Zr,Je),or=Le.mul(Ar,zr),Je=Le.mul(_r,Gr),or=Le.add(Je,or),Je=Le.sub(Hr,or),or=Le.add(Hr,or),ft=Le.mul(Je,or),Hr=Le.add(Nr,Nr),Hr=Le.add(Hr,Nr),Gr=Le.mul(Ar,Gr),zr=Le.mul(_r,zr),Hr=Le.add(Hr,Gr),Gr=Le.sub(Nr,Gr),Gr=Le.mul(Ar,Gr),zr=Le.add(zr,Gr),Nr=Le.mul(Hr,zr),ft=Le.add(ft,Nr),Nr=Le.mul(Zr,zr),Je=Le.mul(Vr,Je),Je=Le.sub(Je,Nr),Nr=Le.mul(Vr,Hr),or=Le.mul(Zr,or),or=Le.add(or,Nr),new Cr(Je,ft,or)}subtract(rr){return this.add(rr.negate())}is0(){return this.equals(Cr.ZERO)}multiply(rr){const{endo:cr}=Re;if(!Ce.isValidNot0(rr))throw new Error("invalid scalar: out of range");let Br,br;const lr=Sr=>kr.cached(this,Sr,yt=>(0,s.normalizeZ)(Cr,yt));if(cr){const{k1neg:Sr,k1:yt,k2neg:Je,k2:ft}=mr(rr),{p:or,f:Ar}=lr(yt),{p:_r,f:Nr}=lr(ft);br=Ar.add(Nr),Br=xr(cr.beta,or,_r,Sr,Je)}else{const{p:Sr,f:yt}=lr(rr);Br=Sr,br=yt}return(0,s.normalizeZ)(Cr,[Br,br])[0]}multiplyUnsafe(rr){const{endo:cr}=Re,Br=this;if(!Ce.isValid(rr))throw new Error("invalid scalar: out of range");if(rr===g||Br.is0())return Cr.ZERO;if(rr===y)return Br;if(kr.hasCache(this))return this.multiply(rr);if(cr){const{k1neg:br,k1:lr,k2neg:Sr,k2:yt}=mr(rr),{p1:Je,p2:ft}=(0,s.mulEndoUnsafe)(Cr,Br,lr,yt);return xr(cr.beta,Je,ft,br,Sr)}else return kr.unsafe(Br,rr)}multiplyAndAddUnsafe(rr,cr,Br){const br=this.multiplyUnsafe(cr).add(rr.multiplyUnsafe(Br));return br.is0()?void 0:br}toAffine(rr){return yr(this,rr)}isTorsionFree(){const{isTorsionFree:rr}=Re;return O===y?!0:rr?rr(Cr,this):kr.unsafe(this,st).is0()}clearCofactor(){const{clearCofactor:rr}=Re;return O===y?this:rr?rr(Cr,this):this.multiplyUnsafe(O)}isSmallOrder(){return this.multiplyUnsafe(O).is0()}toBytes(rr=!0){return(0,n._abool2)(rr,"isCompressed"),this.assertValidity(),dr(Cr,this,rr)}toHex(rr=!0){return(0,n.bytesToHex)(this.toBytes(rr))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(rr=!0){return this.toBytes(rr)}_setWindowSize(rr){this.precompute(rr)}static normalizeZ(rr){return(0,s.normalizeZ)(Cr,rr)}static msm(rr,cr){return(0,s.pippenger)(Cr,Ce,rr,cr)}static fromPrivateKey(rr){return Cr.BASE.multiply(k(Ce,rr))}}Cr.BASE=new Cr(L.Gx,L.Gy,Le.ONE),Cr.ZERO=new Cr(Le.ZERO,Le.ONE,Le.ZERO),Cr.Fp=Le,Cr.Fn=Ce;const wr=Ce.BITS,kr=new s.wNAF(Cr,Re.endo?Math.ceil(wr/2):wr);return Cr.BASE.precompute(8),Cr}function Ve(P){return Uint8Array.of(P?2:3)}function q(P,Re){const Fe=P.ORDER;let Le=g;for(let ir=Fe-y;ir%w===g;ir/=w)Le+=y;const Ce=Le,L=w<<Ce-y-y,O=L*w,st=(Fe-y)/O,lt=(st-y)/w,Xe=O-y,dt=L,er=P.pow(Re,st),ar=P.pow(Re,(st+y)/w);let dr=(ir,pt)=>{let tr=er,sr=P.pow(pt,Xe),nr=P.sqr(sr);nr=P.mul(nr,pt);let pr=P.mul(ir,nr);pr=P.pow(pr,lt),pr=P.mul(pr,sr),sr=P.mul(pr,pt),nr=P.mul(pr,ir);let gr=P.mul(nr,sr);pr=P.pow(gr,dt);let mr=P.eql(pr,P.ONE);sr=P.mul(nr,ar),pr=P.mul(gr,tr),nr=P.cmov(sr,nr,mr),gr=P.cmov(pr,gr,mr);for(let yr=Ce;yr>y;yr--){let Er=yr-w;Er=w<<Er-y;let xr=P.pow(gr,Er);const Cr=P.eql(xr,P.ONE);sr=P.mul(nr,tr),tr=P.mul(tr,tr),xr=P.mul(gr,tr),nr=P.cmov(sr,nr,Cr),gr=P.cmov(xr,gr,Cr)}return{isValid:mr,value:nr}};if(P.ORDER%I===R){const ir=(P.ORDER-R)/I,pt=P.sqrt(P.neg(Re));dr=(tr,sr)=>{let nr=P.sqr(sr);const pr=P.mul(tr,sr);nr=P.mul(nr,pr);let gr=P.pow(nr,ir);gr=P.mul(gr,pr);const mr=P.mul(gr,pt),yr=P.mul(P.sqr(gr),sr),Er=P.eql(yr,tr);let xr=P.cmov(mr,gr,Er);return{isValid:Er,value:xr}}}return dr}function $e(P,Re){(0,a.validateField)(P);const{A:Fe,B:Le,Z:Ce}=Re;if(!P.isValid(Fe)||!P.isValid(Le)||!P.isValid(Ce))throw new Error("mapToCurveSimpleSWU: invalid opts");const L=q(P,Ce);if(!P.isOdd)throw new Error("Field does not have .isOdd()");return O=>{let st,lt,Xe,dt,er,ar,dr,ir;st=P.sqr(O),st=P.mul(st,Ce),lt=P.sqr(st),lt=P.add(lt,st),Xe=P.add(lt,P.ONE),Xe=P.mul(Xe,Le),dt=P.cmov(Ce,P.neg(lt),!P.eql(lt,P.ZERO)),dt=P.mul(dt,Fe),lt=P.sqr(Xe),ar=P.sqr(dt),er=P.mul(ar,Fe),lt=P.add(lt,er),lt=P.mul(lt,Xe),ar=P.mul(ar,dt),er=P.mul(ar,Le),lt=P.add(lt,er),dr=P.mul(st,Xe);const{isValid:pt,value:tr}=L(lt,ar);ir=P.mul(st,O),ir=P.mul(ir,tr),dr=P.cmov(dr,Xe,pt),ir=P.cmov(ir,tr,pt);const sr=P.isOdd(O)===P.isOdd(ir);ir=P.cmov(P.neg(ir),ir,sr);const nr=(0,a.FpInvertBatch)(P,[dt],!0)[0];return dr=P.mul(dr,nr),{x:dr,y:ir}}}function We(P,Re){return{secretKey:Re.BYTES,publicKey:1+P.BYTES,publicKeyUncompressed:1+2*P.BYTES,publicKeyHasPrefix:!0,signature:2*Re.BYTES}}function K(P,Re={}){const{Fn:Fe}=P,Le=Re.randomBytes||n.randomBytes,Ce=Object.assign(We(P.Fp,Fe),{seed:(0,a.getMinHashLength)(Fe.ORDER)});function L(dr){try{return!!k(Fe,dr)}catch{return!1}}function O(dr,ir){const{publicKey:pt,publicKeyUncompressed:tr}=Ce;try{const sr=dr.length;return ir===!0&&sr!==pt||ir===!1&&sr!==tr?!1:!!P.fromBytes(dr)}catch{return!1}}function st(dr=Le(Ce.seed)){return(0,a.mapHashToField)((0,n._abytes2)(dr,Ce.seed,"seed"),Fe.ORDER)}function lt(dr,ir=!0){return P.BASE.multiply(k(Fe,dr)).toBytes(ir)}function Xe(dr){const ir=st(dr);return{secretKey:ir,publicKey:lt(ir)}}function dt(dr){if(typeof dr=="bigint")return!1;if(dr instanceof P)return!0;const{secretKey:ir,publicKey:pt,publicKeyUncompressed:tr}=Ce;if(Fe.allowedLengths||ir===pt)return;const sr=(0,n.ensureBytes)("key",dr).length;return sr===pt||sr===tr}function er(dr,ir,pt=!0){if(dt(dr)===!0)throw new Error("first arg must be private key");if(dt(ir)===!1)throw new Error("second arg must be public key");const tr=k(Fe,dr);return P.fromHex(ir).multiply(tr).toBytes(pt)}return Object.freeze({getPublicKey:lt,getSharedSecret:er,keygen:Xe,Point:P,utils:{isValidSecretKey:L,isValidPublicKey:O,randomSecretKey:st,isValidPrivateKey:L,randomPrivateKey:st,normPrivateKeyToScalar:dr=>k(Fe,dr),precompute(dr=8,ir=P.BASE){return ir.precompute(dr,!1)}},lengths:Ce})}function W(P,Re,Fe={}){(0,r.ahash)(Re),(0,n._validateObject)(Fe,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const Le=Fe.randomBytes||n.randomBytes,Ce=Fe.hmac||((cr,...Br)=>(0,t.hmac)(Re,cr,(0,n.concatBytes)(...Br))),{Fp:L,Fn:O}=P,{ORDER:st,BITS:lt}=O,{keygen:Xe,getPublicKey:dt,getSharedSecret:er,utils:ar,lengths:dr}=K(P,Fe),ir={prehash:!1,lowS:typeof Fe.lowS=="boolean"?Fe.lowS:!1,format:void 0,extraEntropy:!1},pt="compact";function tr(cr){const Br=st>>y;return cr>Br}function sr(cr,Br){if(!O.isValidNot0(Br))throw new Error(`invalid signature ${cr}: out of range 1..Point.Fn.ORDER`);return Br}function nr(cr,Br){x(Br);const br=dr.signature,lr=Br==="compact"?br:Br==="recovered"?br+1:void 0;return(0,n._abytes2)(cr,lr,`${Br} signature`)}class pr{constructor(Br,br,lr){this.r=sr("r",Br),this.s=sr("s",br),lr!=null&&(this.recovery=lr),Object.freeze(this)}static fromBytes(Br,br=pt){nr(Br,br);let lr;if(br==="der"){const{r:ft,s:or}=e.DER.toSig((0,n._abytes2)(Br));return new pr(ft,or)}br==="recovered"&&(lr=Br[0],br="compact",Br=Br.subarray(1));const Sr=O.BYTES,yt=Br.subarray(0,Sr),Je=Br.subarray(Sr,Sr*2);return new pr(O.fromBytes(yt),O.fromBytes(Je),lr)}static fromHex(Br,br){return this.fromBytes((0,n.hexToBytes)(Br),br)}addRecoveryBit(Br){return new pr(this.r,this.s,Br)}recoverPublicKey(Br){const br=L.ORDER,{r:lr,s:Sr,recovery:yt}=this;if(yt==null||![0,1,2,3].includes(yt))throw new Error("recovery id invalid");if(st*w<br&&yt>1)throw new Error("recovery id is ambiguous for h>1 curve");const ft=yt===2||yt===3?lr+st:lr;if(!L.isValid(ft))throw new Error("recovery id 2 or 3 invalid");const or=L.toBytes(ft),Ar=P.fromBytes((0,n.concatBytes)(Ve((yt&1)===0),or)),_r=O.inv(ft),Nr=mr((0,n.ensureBytes)("msgHash",Br)),Hr=O.create(-Nr*_r),Gr=O.create(Sr*_r),Vr=P.BASE.multiplyUnsafe(Hr).add(Ar.multiplyUnsafe(Gr));if(Vr.is0())throw new Error("point at infinify");return Vr.assertValidity(),Vr}hasHighS(){return tr(this.s)}toBytes(Br=pt){if(x(Br),Br==="der")return(0,n.hexToBytes)(e.DER.hexFromSig(this));const br=O.toBytes(this.r),lr=O.toBytes(this.s);if(Br==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return(0,n.concatBytes)(Uint8Array.of(this.recovery),br,lr)}return(0,n.concatBytes)(br,lr)}toHex(Br){return(0,n.bytesToHex)(this.toBytes(Br))}assertValidity(){}static fromCompact(Br){return pr.fromBytes((0,n.ensureBytes)("sig",Br),"compact")}static fromDER(Br){return pr.fromBytes((0,n.ensureBytes)("sig",Br),"der")}normalizeS(){return this.hasHighS()?new pr(this.r,O.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,n.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,n.bytesToHex)(this.toBytes("compact"))}}const gr=Fe.bits2int||function(Br){if(Br.length>8192)throw new Error("input is too large");const br=(0,n.bytesToNumberBE)(Br),lr=Br.length*8-lt;return lr>0?br>>BigInt(lr):br},mr=Fe.bits2int_modN||function(Br){return O.create(gr(Br))},yr=(0,n.bitMask)(lt);function Er(cr){return(0,n.aInRange)("num < 2^"+lt,cr,g,yr),O.toBytes(cr)}function xr(cr,Br){return(0,n._abytes2)(cr,void 0,"message"),Br?(0,n._abytes2)(Re(cr),void 0,"prehashed message"):cr}function Cr(cr,Br,br){if(["recovered","canonical"].some(Hr=>Hr in br))throw new Error("sign() legacy options not supported");const{lowS:lr,prehash:Sr,extraEntropy:yt}=f(br,ir);cr=xr(cr,Sr);const Je=mr(cr),ft=k(O,Br),or=[Er(ft),Er(Je)];if(yt!=null&&yt!==!1){const Hr=yt===!0?Le(dr.secretKey):yt;or.push((0,n.ensureBytes)("extraEntropy",Hr))}const Ar=(0,n.concatBytes)(...or),_r=Je;function Nr(Hr){const Gr=gr(Hr);if(!O.isValidNot0(Gr))return;const Vr=O.inv(Gr),zr=P.BASE.multiply(Gr).toAffine(),Zr=O.create(zr.x);if(Zr===g)return;const xn=O.create(Vr*O.create(_r+Zr*ft));if(xn===g)return;let nn=(zr.x===Zr?0:2)|Number(zr.y&y),Yn=xn;return lr&&tr(xn)&&(Yn=O.neg(xn),nn^=1),new pr(Zr,Yn,nn)}return{seed:Ar,k2sig:Nr}}function wr(cr,Br,br={}){cr=(0,n.ensureBytes)("message",cr);const{seed:lr,k2sig:Sr}=Cr(cr,Br,br);return(0,n.createHmacDrbg)(Re.outputLen,O.BYTES,Ce)(lr,Sr)}function kr(cr){let Br;const br=typeof cr=="string"||(0,n.isBytes)(cr),lr=!br&&cr!==null&&typeof cr=="object"&&typeof cr.r=="bigint"&&typeof cr.s=="bigint";if(!br&&!lr)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(lr)Br=new pr(cr.r,cr.s);else if(br){try{Br=pr.fromBytes((0,n.ensureBytes)("sig",cr),"der")}catch(Sr){if(!(Sr instanceof e.DER.Err))throw Sr}if(!Br)try{Br=pr.fromBytes((0,n.ensureBytes)("sig",cr),"compact")}catch{return!1}}return Br||!1}function Dr(cr,Br,br,lr={}){const{lowS:Sr,prehash:yt,format:Je}=f(lr,ir);if(br=(0,n.ensureBytes)("publicKey",br),Br=xr((0,n.ensureBytes)("message",Br),yt),"strict"in lr)throw new Error("options.strict was renamed to lowS");const ft=Je===void 0?kr(cr):pr.fromBytes((0,n.ensureBytes)("sig",cr),Je);if(ft===!1)return!1;try{const or=P.fromBytes(br);if(Sr&&ft.hasHighS())return!1;const{r:Ar,s:_r}=ft,Nr=mr(Br),Hr=O.inv(_r),Gr=O.create(Nr*Hr),Vr=O.create(Ar*Hr),zr=P.BASE.multiplyUnsafe(Gr).add(or.multiplyUnsafe(Vr));return zr.is0()?!1:O.create(zr.x)===Ar}catch{return!1}}function rr(cr,Br,br={}){const{prehash:lr}=f(br,ir);return Br=xr(Br,lr),pr.fromBytes(cr,"recovered").recoverPublicKey(Br).toBytes()}return Object.freeze({keygen:Xe,getPublicKey:dt,getSharedSecret:er,utils:ar,lengths:dr,Point:P,sign:wr,verify:Dr,recoverPublicKey:rr,Signature:pr,hash:Re})}function Ye(P){const{CURVE:Re,curveOpts:Fe}=Qe(P),Le=je(Re,Fe);return v(P,Le)}function Qe(P){const Re={a:P.a,b:P.b,p:P.Fp.ORDER,n:P.n,h:P.h,Gx:P.Gx,Gy:P.Gy},Fe=P.Fp;let Le=P.allowedPrivateKeyLengths?Array.from(new Set(P.allowedPrivateKeyLengths.map(O=>Math.ceil(O/2)))):void 0;const Ce=(0,a.Field)(Re.n,{BITS:P.nBitLength,allowedLengths:Le,modFromBytes:P.wrapPrivateKey}),L={Fp:Fe,Fn:Ce,allowInfinityPoint:P.allowInfinityPoint,endo:P.endo,isTorsionFree:P.isTorsionFree,clearCofactor:P.clearCofactor,fromBytes:P.fromBytes,toBytes:P.toBytes};return{CURVE:Re,curveOpts:L}}function it(P){const{CURVE:Re,curveOpts:Fe}=Qe(P),Le={hmac:P.hmac,randomBytes:P.randomBytes,lowS:P.lowS,bits2int:P.bits2int,bits2int_modN:P.bits2int_modN};return{CURVE:Re,curveOpts:Fe,hash:P.hash,ecdsaOpts:Le}}function ze(P,Re,Fe){function Le(Ce){const L=P.sqr(Ce),O=P.mul(L,Ce);return P.add(P.add(O,P.mul(Ce,Re)),Fe)}return Le}function v(P,Re){const{Fp:Fe,Fn:Le}=Re;function Ce(O){return(0,n.inRange)(O,y,Le.ORDER)}const L=ze(Fe,P.a,P.b);return Object.assign({},{CURVE:P,Point:Re,ProjectivePoint:Re,normPrivateKeyToScalar:O=>k(Le,O),weierstrassEquation:L,isWithinCurveOrder:Ce})}function D(P,Re){const Fe=Re.Point;return Object.assign({},Re,{ProjectivePoint:Fe,CURVE:Object.assign({},P,(0,a.nLength)(Fe.Fn.ORDER,Fe.Fn.BITS))})}function _e(P){const{CURVE:Re,curveOpts:Fe,hash:Le,ecdsaOpts:Ce}=it(P),L=je(Re,Fe),O=W(L,Le,Ce);return D(P,O)}})(weierstrass)),weierstrass}var hasRequired_shortw_utils;function require_shortw_utils(){if(hasRequired_shortw_utils)return _shortw_utils;hasRequired_shortw_utils=1,Object.defineProperty(_shortw_utils,"__esModule",{value:!0}),_shortw_utils.getHash=t,_shortw_utils.createCurve=r;const e=requireWeierstrass();function t(n){return{hash:n}}function r(n,s){const a=l=>(0,e.weierstrass)({...n,hash:l});return{...a(s),create:a}}return _shortw_utils}var hashToCurve={},hasRequiredHashToCurve;function requireHashToCurve(){return hasRequiredHashToCurve||(hasRequiredHashToCurve=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._DST_scalar=void 0,e.expand_message_xmd=x,e.expand_message_xof=f,e.hash_to_field=p,e.isogenyMap=g,e.createHasher=y;const t=requireUtils$3(),r=requireModular(),n=t.bytesToNumberBE;function s(w,R){if(l(w),l(R),w<0||w>=1<<8*R)throw new Error("invalid I2OSP input: "+w);const I=Array.from({length:R}).fill(0);for(let k=R-1;k>=0;k--)I[k]=w&255,w>>>=8;return new Uint8Array(I)}function a(w,R){const I=new Uint8Array(w.length);for(let k=0;k<w.length;k++)I[k]=w[k]^R[k];return I}function l(w){if(!Number.isSafeInteger(w))throw new Error("number expected")}function u(w){if(!(0,t.isBytes)(w)&&typeof w!="string")throw new Error("DST must be Uint8Array or string");return typeof w=="string"?(0,t.utf8ToBytes)(w):w}function x(w,R,I,k){(0,t.abytes)(w),l(I),R=u(R),R.length>255&&(R=k((0,t.concatBytes)((0,t.utf8ToBytes)("H2C-OVERSIZE-DST-"),R)));const{outputLen:je,blockLen:Ve}=k,q=Math.ceil(I/je);if(I>65535||q>255)throw new Error("expand_message_xmd: invalid lenInBytes");const $e=(0,t.concatBytes)(R,s(R.length,1)),We=s(0,Ve),K=s(I,2),W=new Array(q),Ye=k((0,t.concatBytes)(We,w,K,s(0,1),$e));W[0]=k((0,t.concatBytes)(Ye,s(1,1),$e));for(let it=1;it<=q;it++){const ze=[a(Ye,W[it-1]),s(it+1,1),$e];W[it]=k((0,t.concatBytes)(...ze))}return(0,t.concatBytes)(...W).slice(0,I)}function f(w,R,I,k,je){if((0,t.abytes)(w),l(I),R=u(R),R.length>255){const Ve=Math.ceil(2*k/8);R=je.create({dkLen:Ve}).update((0,t.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(R).digest()}if(I>65535||R.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return je.create({dkLen:I}).update(w).update(s(I,2)).update(R).update(s(R.length,1)).digest()}function p(w,R,I){(0,t._validateObject)(I,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:k,k:je,m:Ve,hash:q,expand:$e,DST:We}=I;if(!(0,t.isHash)(I.hash))throw new Error("expected valid hash");(0,t.abytes)(w),l(R);const K=k.toString(2).length,W=Math.ceil((K+je)/8),Ye=R*Ve*W;let Qe;if($e==="xmd")Qe=x(w,We,Ye,q);else if($e==="xof")Qe=f(w,We,Ye,je,q);else if($e==="_internal_pass")Qe=w;else throw new Error('expand must be "xmd" or "xof"');const it=new Array(R);for(let ze=0;ze<R;ze++){const v=new Array(Ve);for(let D=0;D<Ve;D++){const _e=W*(D+ze*Ve),P=Qe.subarray(_e,_e+W);v[D]=(0,r.mod)(n(P),k)}it[ze]=v}return it}function g(w,R){const I=R.map(k=>Array.from(k).reverse());return(k,je)=>{const[Ve,q,$e,We]=I.map(Ye=>Ye.reduce((Qe,it)=>w.add(w.mul(Qe,k),it))),[K,W]=(0,r.FpInvertBatch)(w,[q,We],!0);return k=w.mul(Ve,K),je=w.mul(je,w.mul($e,W)),{x:k,y:je}}}e._DST_scalar=(0,t.utf8ToBytes)("HashToScalar-");function y(w,R,I){if(typeof R!="function")throw new Error("mapToCurve() must be defined");function k(Ve){return w.fromAffine(R(Ve))}function je(Ve){const q=Ve.clearCofactor();return q.equals(w.ZERO)?w.ZERO:(q.assertValidity(),q)}return{defaults:I,hashToCurve(Ve,q){const $e=Object.assign({},I,q),We=p(Ve,2,$e),K=k(We[0]),W=k(We[1]);return je(K.add(W))},encodeToCurve(Ve,q){const $e=I.encodeDST?{DST:I.encodeDST}:{},We=Object.assign({},I,$e,q),K=p(Ve,1,We),W=k(K[0]);return je(W)},mapToCurve(Ve){if(!Array.isArray(Ve))throw new Error("expected array of bigints");for(const q of Ve)if(typeof q!="bigint")throw new Error("expected array of bigints");return je(k(Ve))},hashToScalar(Ve,q){const $e=w.Fn.ORDER,We=Object.assign({},I,{p:$e,m:1,DST:e._DST_scalar},q);return p(Ve,1,We)[0][0]}}}})(hashToCurve)),hashToCurve}var hasRequiredSecp256k1;function requireSecp256k1(){return hasRequiredSecp256k1||(hasRequiredSecp256k1=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.encodeToCurve=e.hashToCurve=e.secp256k1_hasher=e.schnorr=e.secp256k1=void 0;const t=requireSha2(),r=requireUtils$4(),n=require_shortw_utils(),s=requireHashToCurve(),a=requireModular(),l=requireWeierstrass(),u=requireUtils$3(),x={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},f={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},p=BigInt(0),g=BigInt(1),y=BigInt(2);function w(D){const _e=x.p,P=BigInt(3),Re=BigInt(6),Fe=BigInt(11),Le=BigInt(22),Ce=BigInt(23),L=BigInt(44),O=BigInt(88),st=D*D*D%_e,lt=st*st*D%_e,Xe=(0,a.pow2)(lt,P,_e)*lt%_e,dt=(0,a.pow2)(Xe,P,_e)*lt%_e,er=(0,a.pow2)(dt,y,_e)*st%_e,ar=(0,a.pow2)(er,Fe,_e)*er%_e,dr=(0,a.pow2)(ar,Le,_e)*ar%_e,ir=(0,a.pow2)(dr,L,_e)*dr%_e,pt=(0,a.pow2)(ir,O,_e)*ir%_e,tr=(0,a.pow2)(pt,L,_e)*dr%_e,sr=(0,a.pow2)(tr,P,_e)*lt%_e,nr=(0,a.pow2)(sr,Ce,_e)*ar%_e,pr=(0,a.pow2)(nr,Re,_e)*st%_e,gr=(0,a.pow2)(pr,y,_e);if(!R.eql(R.sqr(gr),D))throw new Error("Cannot find square root");return gr}const R=(0,a.Field)(x.p,{sqrt:w});e.secp256k1=(0,n.createCurve)({...x,Fp:R,lowS:!0,endo:f},t.sha256);const I={};function k(D,..._e){let P=I[D];if(P===void 0){const Re=(0,t.sha256)((0,u.utf8ToBytes)(D));P=(0,u.concatBytes)(Re,Re),I[D]=P}return(0,t.sha256)((0,u.concatBytes)(P,..._e))}const je=D=>D.toBytes(!0).slice(1),Ve=e.secp256k1.Point,q=D=>D%y===p;function $e(D){const{Fn:_e,BASE:P}=Ve,Re=(0,l._normFnElement)(_e,D),Fe=P.multiply(Re);return{scalar:q(Fe.y)?Re:_e.neg(Re),bytes:je(Fe)}}function We(D){const _e=R;if(!_e.isValidNot0(D))throw new Error("invalid x: Fail if x  p");const P=_e.create(D*D),Re=_e.create(P*D+BigInt(7));let Fe=_e.sqrt(Re);q(Fe)||(Fe=_e.neg(Fe));const Le=Ve.fromAffine({x:D,y:Fe});return Le.assertValidity(),Le}const K=u.bytesToNumberBE;function W(...D){return Ve.Fn.create(K(k("BIP0340/challenge",...D)))}function Ye(D){return $e(D).bytes}function Qe(D,_e,P=(0,r.randomBytes)(32)){const{Fn:Re}=Ve,Fe=(0,u.ensureBytes)("message",D),{bytes:Le,scalar:Ce}=$e(_e),L=(0,u.ensureBytes)("auxRand",P,32),O=Re.toBytes(Ce^K(k("BIP0340/aux",L))),st=k("BIP0340/nonce",O,Le,Fe),{bytes:lt,scalar:Xe}=$e(st),dt=W(lt,Le,Fe),er=new Uint8Array(64);if(er.set(lt,0),er.set(Re.toBytes(Re.create(Xe+dt*Ce)),32),!it(er,Fe,Le))throw new Error("sign: Invalid signature produced");return er}function it(D,_e,P){const{Fn:Re,BASE:Fe}=Ve,Le=(0,u.ensureBytes)("signature",D,64),Ce=(0,u.ensureBytes)("message",_e),L=(0,u.ensureBytes)("publicKey",P,32);try{const O=We(K(L)),st=K(Le.subarray(0,32));if(!(0,u.inRange)(st,g,x.p))return!1;const lt=K(Le.subarray(32,64));if(!(0,u.inRange)(lt,g,x.n))return!1;const Xe=W(Re.toBytes(st),je(O),Ce),dt=Fe.multiplyUnsafe(lt).add(O.multiplyUnsafe(Re.neg(Xe))),{x:er,y:ar}=dt.toAffine();return!(dt.is0()||!q(ar)||er!==st)}catch{return!1}}e.schnorr=(()=>{const P=(Fe=(0,r.randomBytes)(48))=>(0,a.mapHashToField)(Fe,x.n);e.secp256k1.utils.randomSecretKey;function Re(Fe){const Le=P(Fe);return{secretKey:Le,publicKey:Ye(Le)}}return{keygen:Re,getPublicKey:Ye,sign:Qe,verify:it,Point:Ve,utils:{randomSecretKey:P,randomPrivateKey:P,taggedHash:k,lift_x:We,pointToBytes:je,numberToBytesBE:u.numberToBytesBE,bytesToNumberBE:u.bytesToNumberBE,mod:a.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})();const ze=(0,s.isogenyMap)(R,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(D=>D.map(_e=>BigInt(_e)))),v=(0,l.mapToCurveSimpleSWU)(R,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:R.create(BigInt("-11"))});e.secp256k1_hasher=(0,s.createHasher)(e.secp256k1.Point,D=>{const{x:_e,y:P}=v(R.create(D[0]));return ze(_e,P)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:R.ORDER,m:1,k:128,expand:"xmd",hash:t.sha256}),e.hashToCurve=e.secp256k1_hasher.hashToCurve,e.encodeToCurve=e.secp256k1_hasher.encodeToCurve})(secp256k1)),secp256k1}var utils$2={},hasRequiredUtils$2;function requireUtils$2(){if(hasRequiredUtils$2)return utils$2;hasRequiredUtils$2=1,Object.defineProperty(utils$2,"__esModule",{value:!0}),utils$2.isHash=utils$2.validateObject=utils$2.memoized=utils$2.notImplemented=utils$2.createHmacDrbg=utils$2.bitMask=utils$2.bitSet=utils$2.bitGet=utils$2.bitLen=utils$2.aInRange=utils$2.inRange=utils$2.asciiToBytes=utils$2.copyBytes=utils$2.equalBytes=utils$2.ensureBytes=utils$2.numberToVarBytesBE=utils$2.numberToBytesLE=utils$2.numberToBytesBE=utils$2.bytesToNumberLE=utils$2.bytesToNumberBE=utils$2.hexToNumber=utils$2.numberToHexUnpadded=utils$2.abool=utils$2.utf8ToBytes=utils$2.randomBytes=utils$2.isBytes=utils$2.hexToBytes=utils$2.concatBytes=utils$2.bytesToUtf8=utils$2.bytesToHex=utils$2.anumber=utils$2.abytes=void 0;const e=requireUtils$3();return utils$2.abytes=e.abytes,utils$2.anumber=e.anumber,utils$2.bytesToHex=e.bytesToHex,utils$2.bytesToUtf8=e.bytesToUtf8,utils$2.concatBytes=e.concatBytes,utils$2.hexToBytes=e.hexToBytes,utils$2.isBytes=e.isBytes,utils$2.randomBytes=e.randomBytes,utils$2.utf8ToBytes=e.utf8ToBytes,utils$2.abool=e.abool,utils$2.numberToHexUnpadded=e.numberToHexUnpadded,utils$2.hexToNumber=e.hexToNumber,utils$2.bytesToNumberBE=e.bytesToNumberBE,utils$2.bytesToNumberLE=e.bytesToNumberLE,utils$2.numberToBytesBE=e.numberToBytesBE,utils$2.numberToBytesLE=e.numberToBytesLE,utils$2.numberToVarBytesBE=e.numberToVarBytesBE,utils$2.ensureBytes=e.ensureBytes,utils$2.equalBytes=e.equalBytes,utils$2.copyBytes=e.copyBytes,utils$2.asciiToBytes=e.asciiToBytes,utils$2.inRange=e.inRange,utils$2.aInRange=e.aInRange,utils$2.bitLen=e.bitLen,utils$2.bitGet=e.bitGet,utils$2.bitSet=e.bitSet,utils$2.bitMask=e.bitMask,utils$2.createHmacDrbg=e.createHmacDrbg,utils$2.notImplemented=e.notImplemented,utils$2.memoized=e.memoized,utils$2.validateObject=e.validateObject,utils$2.isHash=e.isHash,utils$2}var hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1;var e=requireSecp256k1(),t=requireModular(),r=requireUtils$2();function n(lr){var Sr=Object.create(null);return lr&&Object.keys(lr).forEach(function(yt){if(yt!=="default"){var Je=Object.getOwnPropertyDescriptor(lr,yt);Object.defineProperty(Sr,yt,Je.get?Je:{enumerable:!0,get:function(){return lr[yt]}})}}),Sr.default=lr,Object.freeze(Sr)}var s=n(t),a=n(r);const l=e.secp256k1.ProjectivePoint,u="Expected Private",x="Expected Point",f="Expected Tweak",p="Expected Hash",g="Expected Signature",y="Expected Extra Data (32 bytes)",w="Expected Scalar",R="Bad Recovery Id",I=32,k=32,je=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65]),Ve=32,q=new Uint8Array(32),$e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,69,81,35,25,80,183,95,196,64,45,161,114,47,201,186,238]),We=BigInt(1);function K(lr){return lr instanceof Uint8Array}function W(lr,Sr){for(let yt=0;yt<32;++yt)if(lr[yt]!==Sr[yt])return lr[yt]<Sr[yt]?-1:1;return 0}function Ye(lr){return W(lr,q)===0}function Qe(lr){return!(!(lr instanceof Uint8Array)||lr.length!==k||W(lr,je)>=0)}function it(lr){return lr instanceof Uint8Array&&lr.length===64&&W(lr.subarray(0,32),je)<0&&W(lr.subarray(32,64),je)<0}function ze(lr){return K(lr)&&lr.length===64&&W(lr.subarray(0,32),$e)<0}function v(lr){return!(Ye(lr.subarray(0,32))||Ye(lr.subarray(32,64)))}function D(lr){return lr instanceof Uint8Array&&lr.length===I}function _e(lr){return lr===void 0||lr instanceof Uint8Array&&lr.length===Ve}function P(lr){let Sr;if(typeof lr=="bigint")Sr=lr;else if(typeof lr=="number"&&Number.isSafeInteger(lr)&&lr>=0)Sr=BigInt(lr);else if(typeof lr=="string"){if(lr.length!==64)throw new Error("Expected 32 bytes of private scalar");Sr=a.hexToNumber(lr)}else if(lr instanceof Uint8Array){if(lr.length!==32)throw new Error("Expected 32 bytes of private scalar");Sr=a.bytesToNumberBE(lr)}else throw new TypeError("Expected valid private scalar");if(Sr<0)throw new Error("Expected private scalar >= 0");return Sr}function Re(lr){return e.secp256k1.utils.normPrivateKeyToScalar(lr)}function Fe(lr,Sr){const yt=Re(lr),Je=P(Sr),ft=a.numberToBytesBE(s.mod(yt+Je,e.secp256k1.CURVE.n),32);return e.secp256k1.utils.isValidPrivateKey(ft)?ft:null}function Le(lr,Sr){const yt=Re(lr),Je=P(Sr),ft=a.numberToBytesBE(s.mod(yt-Je,e.secp256k1.CURVE.n),32);return e.secp256k1.utils.isValidPrivateKey(ft)?ft:null}function Ce(lr){const Sr=Re(lr),yt=a.numberToBytesBE(e.secp256k1.CURVE.n-Sr,32);return e.secp256k1.utils.isValidPrivateKey(yt)?yt:null}function L(lr,Sr,yt){const Je=dt(lr),ft=P(Sr),or=l.BASE.multiplyAndAddUnsafe(Je,ft,We);if(!or)throw new Error("Tweaked point at infinity");return or.toRawBytes(yt)}function O(lr,Sr,yt){const Je=dt(lr),ft=typeof Sr=="string"?Sr:a.bytesToHex(Sr),or=a.hexToNumber(ft);return Je.multiply(or).toRawBytes(yt)}function st(lr,Sr){return lr===void 0?Sr!==void 0?dr(Sr):!0:!!lr}function lt(lr){try{return lr()}catch{return null}}function Xe(lr){return e.schnorr.utils.lift_x(a.bytesToNumberBE(lr))}function dt(lr){return lr.length===32?Xe(lr):l.fromHex(lr)}function er(lr,Sr){if(lr.length===32!==Sr)return!1;try{return Sr?!!Xe(lr):!!l.fromHex(lr)}catch{return!1}}function ar(lr){return er(lr,!1)}function dr(lr){return er(lr,!1)&&lr.length===33}function ir(lr){return e.secp256k1.utils.isValidPrivateKey(lr)}function pt(lr){return er(lr,!0)}function tr(lr,Sr){if(!pt(lr))throw new Error(x);if(!Qe(Sr))throw new Error(f);return lt(()=>{const yt=L(lr,Sr,!0);return{parity:yt[0]%2===1?1:0,xOnlyPubkey:yt.slice(1)}})}function sr(lr){if(!ar(lr))throw new Error(x);return lr.slice(1,33)}function nr(lr,Sr){if(!ir(lr))throw new Error(u);return lt(()=>e.secp256k1.getPublicKey(lr,st(Sr)))}function pr(lr){if(!ir(lr))throw new Error(u);return sr(nr(lr))}function gr(lr,Sr){if(!ar(lr))throw new Error(x);return dt(lr).toRawBytes(st(Sr,lr))}function mr(lr,Sr,yt){if(!ar(lr))throw new Error(x);if(!Qe(Sr))throw new Error(f);return lt(()=>O(lr,Sr,st(yt,lr)))}function yr(lr,Sr,yt){if(!ar(lr)||!ar(Sr))throw new Error(x);return lt(()=>{const Je=dt(lr),ft=dt(Sr);return Je.equals(ft.negate())?null:Je.add(ft).toRawBytes(st(yt,lr))})}function Er(lr,Sr,yt){if(!ar(lr))throw new Error(x);if(!Qe(Sr))throw new Error(f);return lt(()=>L(lr,Sr,st(yt,lr)))}function xr(lr,Sr){if(!ir(lr))throw new Error(u);if(!Qe(Sr))throw new Error(f);return lt(()=>Fe(lr,Sr))}function Cr(lr,Sr){if(!ir(lr))throw new Error(u);if(!Qe(Sr))throw new Error(f);return lt(()=>Le(lr,Sr))}function wr(lr){if(!ir(lr))throw new Error(u);return Ce(lr)}function kr(lr,Sr,yt){if(!ir(Sr))throw new Error(u);if(!D(lr))throw new Error(w);if(!_e(yt))throw new Error(y);return e.secp256k1.sign(lr,Sr,{extraEntropy:yt}).toCompactRawBytes()}function Dr(lr,Sr,yt){if(!ir(Sr))throw new Error(u);if(!D(lr))throw new Error(w);if(!_e(yt))throw new Error(y);const Je=e.secp256k1.sign(lr,Sr,{extraEntropy:yt});return{signature:Je.toCompactRawBytes(),recoveryId:Je.recovery}}function rr(lr,Sr,yt){if(!ir(Sr))throw new Error(u);if(!D(lr))throw new Error(w);if(!_e(yt))throw new Error(y);return e.schnorr.sign(lr,Sr,yt)}function cr(lr,Sr,yt,Je){if(!D(lr))throw new Error(p);if(!it(Sr)||!v(Sr))throw new Error(g);if(yt&2&&!ze(Sr))throw new Error(R);if(!pt(Sr.subarray(0,32)))throw new Error(g);const or=e.secp256k1.Signature.fromCompact(Sr).addRecoveryBit(yt).recoverPublicKey(lr);if(!or)throw new Error(g);return or.toRawBytes(st(Je))}function Br(lr,Sr,yt,Je){if(!ar(Sr))throw new Error(x);if(!it(yt))throw new Error(g);if(!D(lr))throw new Error(w);return e.secp256k1.verify(yt,lr,Sr,{lowS:Je})}function br(lr,Sr,yt){if(!pt(Sr))throw new Error(x);if(!it(yt))throw new Error(g);if(!D(lr))throw new Error(w);return e.schnorr.verify(yt,lr,Sr)}return dist.isPoint=ar,dist.isPointCompressed=dr,dist.isPrivate=ir,dist.isXOnlyPoint=pt,dist.pointAdd=yr,dist.pointAddScalar=Er,dist.pointCompress=gr,dist.pointFromScalar=nr,dist.pointMultiply=mr,dist.privateAdd=xr,dist.privateNegate=wr,dist.privateSub=Cr,dist.recover=cr,dist.sign=kr,dist.signRecoverable=Dr,dist.signSchnorr=rr,dist.verify=Br,dist.verifySchnorr=br,dist.xOnlyPointAddTweak=tr,dist.xOnlyPointFromPoint=sr,dist.xOnlyPointFromScalar=pr,dist}var distExports=requireDist();const index=getDefaultExportFromCjs$1(distExports),ecc=_mergeNamespaces({__proto__:null,default:index},[distExports]),bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};var store;function getGlobalConfig(e){return{lang:e?.lang??store?.lang,message:e?.message,abortEarly:e?.abortEarly??store?.abortEarly,abortPipeEarly:e?.abortPipeEarly??store?.abortPipeEarly}}var store2;function getGlobalMessage(e){return store2?.get(e)}var store3;function getSchemaMessage(e){return store3?.get(e)}var store4;function getSpecificMessage(e,t){return store4?.get(e)?.get(t)}function _stringify(e){const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function _addIssue(e,t,r,n,s){const a=s&&"input"in s?s.input:r.value,l=s?.expected??e.expects??null,u=s?.received??_stringify(a),x={kind:e.kind,type:e.type,input:a,expected:l,received:u,message:`Invalid ${t}: ${l?`Expected ${l} but r`:"R"}eceived ${u}`,requirement:e.requirement,path:s?.path,issues:s?.issues,lang:n.lang,abortEarly:n.abortEarly,abortPipeEarly:n.abortPipeEarly},f=e.kind==="schema",p=s?.message??e.message??getSpecificMessage(e.reference,x.lang)??(f?getSchemaMessage(x.lang):null)??n.message??getGlobalMessage(x.lang);p&&(x.message=typeof p=="function"?p(x):p),f&&(r.typed=!1),r.issues?r.issues.push(x):r.issues=[x]}var ValiError=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function integer(e){return{kind:"validation",type:"integer",reference:integer,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(t,r){return t.typed&&!this.requirement(t.value)&&_addIssue(this,"integer",t,r),t}}}function length(e,t){return{kind:"validation",type:"length",reference:length,async:!1,expects:`${e}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value.length!==this.requirement&&_addIssue(this,"length",r,n,{received:`${r.value.length}`}),r}}}function maxValue(e,t){return{kind:"validation",type:"max_value",reference:maxValue,async:!1,expects:`<=${e instanceof Date?e.toJSON():_stringify(e)}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value>this.requirement&&_addIssue(this,"value",r,n,{received:r.value instanceof Date?r.value.toJSON():_stringify(r.value)}),r}}}function minValue(e,t){return{kind:"validation",type:"min_value",reference:minValue,async:!1,expects:`>=${e instanceof Date?e.toJSON():_stringify(e)}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value<this.requirement&&_addIssue(this,"value",r,n,{received:r.value instanceof Date?r.value.toJSON():_stringify(r.value)}),r}}}function transform(e){return{kind:"transformation",type:"transform",reference:transform,async:!1,operation:e,_run(t){return t.value=this.operation(t.value),t}}}function getDefault(e,t,r){return typeof e.default=="function"?e.default(t,r):e.default}function boolean(e){return{kind:"schema",type:"boolean",reference:boolean,expects:"boolean",async:!1,message:e,_run(t,r){return typeof t.value=="boolean"?t.typed=!0:_addIssue(this,"type",t,r),t}}}function instance(e,t){return{kind:"schema",type:"instance",reference:instance,expects:e.name,async:!1,class:e,message:t,_run(r,n){return r.value instanceof this.class?r.typed=!0:_addIssue(this,"type",r,n),r}}}function number(e){return{kind:"schema",type:"number",reference:number,expects:"number",async:!1,message:e,_run(t,r){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:_addIssue(this,"type",t,r),t}}}function object(e,t){return{kind:"schema",type:"object",reference:object,expects:"Object",async:!1,entries:e,message:t,_run(r,n){const s=r.value;if(s&&typeof s=="object"){r.typed=!0,r.value={};for(const a in this.entries){const l=s[a],u=this.entries[a]._run({typed:!1,value:l},n);if(u.issues){const x={type:"object",origin:"value",input:s,key:a,value:l};for(const f of u.issues)f.path?f.path.unshift(x):f.path=[x],r.issues?.push(f);if(r.issues||(r.issues=u.issues),n.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),(u.value!==void 0||a in s)&&(r.value[a]=u.value)}}else _addIssue(this,"type",r,n);return r}}}function optional(e,...t){const r={kind:"schema",type:"optional",reference:optional,expects:`${e.expects} | undefined`,async:!1,wrapped:e,_run(n,s){return n.value===void 0&&("default"in this&&(n.value=getDefault(this,n,s)),n.value===void 0)?(n.typed=!0,n):this.wrapped._run(n,s)}};return 0 in t&&(r.default=t[0]),r}function string(e){return{kind:"schema",type:"string",reference:string,expects:"string",async:!1,message:e,_run(t,r){return typeof t.value=="string"?t.typed=!0:_addIssue(this,"type",t,r),t}}}function _subIssues(e){let t;if(e)for(const r of e)t?t.push(...r.issues):t=r.issues;return t}function union(e,t){return{kind:"schema",type:"union",reference:union,expects:[...new Set(e.map(r=>r.expects))].join(" | ")||"never",async:!1,options:e,message:t,_run(r,n){let s,a,l;for(const u of this.options){const x=u._run({typed:!1,value:r.value},n);if(x.typed)if(x.issues)a?a.push(x):a=[x];else{s=x;break}else l?l.push(x):l=[x]}if(s)return s;if(a){if(a.length===1)return a[0];_addIssue(this,"type",r,n,{issues:_subIssues(a)}),r.typed=!0}else{if(l?.length===1)return l[0];_addIssue(this,"type",r,n,{issues:_subIssues(l)})}return r}}}function parse(e,t,r){const n=e._run({typed:!1,value:t},getGlobalConfig(r));if(n.issues)throw new ValiError(n.issues);return n.value}function pipe(...e){return{...e[0],pipe:e,_run(t,r){for(const n of e)if(n.kind!=="metadata"){if(t.issues&&(n.kind==="schema"||n.kind==="transformation")){t.typed=!1;break}(!t.issues||!r.abortEarly&&!r.abortPipeEarly)&&(t=n._run(t,r))}return t}}}const Uint32Schema=pipe(number(),integer(),minValue(0),maxValue(4294967295)),Uint8Schema=pipe(number(),integer(),minValue(0),maxValue(255)),NetworkSchema=object({messagePrefix:union([string(),instance(Uint8Array)]),bech32:string(),bip32:object({public:Uint32Schema,private:Uint32Schema}),pubKeyHash:Uint8Schema,scriptHash:Uint8Schema,wif:Uint8Schema}),Buffer256Bit=pipe(instance(Uint8Array),length(32));function decodeRaw(e,t){if(e.length===33)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(e.length!==34)throw new Error("Invalid WIF length");if(e[33]!==1)throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function encodeRaw(e,t,r){if(t.length!==32)throw new TypeError("Invalid privateKey length");var n=new Uint8Array(r?34:33),s=new DataView(n.buffer);return s.setUint8(0,e),n.set(t,1),r&&(n[33]=1),n}function decode$1(e,t){return decodeRaw(bs58Check.decode(e))}function encode(e){return bs58Check.encode(encodeRaw(e.version,e.privateKey,e.compressed))}const h=e=>Buffer.from(e,"hex");function testEcc(e){assert(e.isPoint(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(!e.isPoint(h("030000000000000000000000000000000000000000000000000000000000000005"))),assert(e.isPrivate(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),assert(!e.isPrivate(h("0000000000000000000000000000000000000000000000000000000000000000"))),assert(!e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),assert(!e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),assert(Buffer.from(e.privateAdd(h("0000000000000000000000000000000000000000000000000000000000000001"),h("0000000000000000000000000000000000000000000000000000000000000000"))).equals(h("0000000000000000000000000000000000000000000000000000000000000001"))),assert(e.privateAdd(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),h("0000000000000000000000000000000000000000000000000000000000000003"))===null),assert(Buffer.from(e.privateAdd(h("e211078564db65c3ce7704f08262b1f38f1ef412ad15b5ac2d76657a63b2c500"),h("b51fbb69051255d1becbd683de5848242a89c229348dd72896a87ada94ae8665"))).equals(h("9730c2ee69edbb958d42db7460bafa18fef9d955325aec99044c81c8282b0a24"))),assert(Buffer.from(e.privateNegate(h("0000000000000000000000000000000000000000000000000000000000000001"))).equals(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),assert(Buffer.from(e.privateNegate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(h("0000000000000000000000000000000000000000000000000000000000000003"))),assert(Buffer.from(e.privateNegate(h("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(h("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792"))),assert(Buffer.from(e.pointCompress(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(Buffer.from(e.pointCompress(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),assert(Buffer.from(e.pointCompress(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(Buffer.from(e.pointCompress(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),assert(Buffer.from(e.pointFromScalar(h("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(h("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),assert(e.xOnlyPointAddTweak(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))===null);let t=e.xOnlyPointAddTweak(h("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),h("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));assert(Buffer.from(t.xOnlyPubkey).equals(h("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&t.parity===1),t=e.xOnlyPointAddTweak(h("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),h("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47")),assert(Buffer.from(t.xOnlyPubkey).equals(h("9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"))&&t.parity===0),assert(Buffer.from(e.sign(h("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(h("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),assert(e.verify(h("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),h("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),e.signSchnorr&&assert(Buffer.from(e.signSchnorr(h("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),h("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),h("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(h("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),e.verifySchnorr&&assert(e.verifySchnorr(h("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),h("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),h("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}function assert(e){if(!e)throw new Error("ecc library invalid")}const HEX_STRINGS="0123456789abcdefABCDEF";HEX_STRINGS.split("").map(e=>e.codePointAt(0));Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=HEX_STRINGS.indexOf(r);return n<0?void 0:n<16?n:n-6});new TextEncoder;new TextDecoder;function concat(e){const t=e.reduce((s,a)=>s+a.length,0),r=new Uint8Array(t);let n=0;for(const s of e)r.set(s,n),n+=s.length;return r}function writeUInt32(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${r}`);n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255)}const ECPairOptionsSchema=optional(object({compressed:optional(boolean()),network:optional(NetworkSchema),rng:optional(pipe(instance(Function),transform(e=>t=>{const r=parse(optional(number()),t),n=e(r);return parse(instance(Uint8Array),n)})))})),toXOnly=e=>e.length===32?e:e.subarray(1,33);function ECPairFactory(e){testEcc(e);function t(u){return e.isPoint(u)}function r(u,x){if(parse(Buffer256Bit,u),!e.isPrivate(u))throw new TypeError("Private key not in range [1, n)");return parse(ECPairOptionsSchema,x),new l(u,void 0,x)}function n(u,x){if(!e.isPoint(u))throw new Error("Point not on the curve");return parse(ECPairOptionsSchema,x),new l(void 0,u,x)}function s(u,x){const f=decode$1(u),p=f.version;if(Array.isArray(x)){if(x=x.filter(g=>p===g.wif).pop(),!x)throw new Error("Unknown network version")}else if(x=x||bitcoin,p!==x.wif)throw new Error("Invalid network version");return r(f.privateKey,{compressed:f.compressed,network:x})}function a(u){parse(ECPairOptionsSchema,u),u===void 0&&(u={});const x=u.rng||(p=>crypto.getRandomValues(new Uint8Array(p)));let f;do f=x(32),parse(Buffer256Bit,f);while(!e.isPrivate(f));return r(f,u)}class l{__D;__Q;compressed;network;lowR;constructor(x,f,p){this.__D=x,this.__Q=f,this.lowR=!1,p===void 0&&(p={}),this.compressed=p.compressed===void 0?!0:p.compressed,this.network=p.network||bitcoin,f!==void 0&&(this.__Q=e.pointCompress(f,this.compressed))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){const x=e.pointFromScalar(this.__D,this.compressed);this.__Q=x}return this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return encode({compressed:this.compressed,privateKey:this.__D,version:this.network.wif})}tweak(x){return this.privateKey?this.tweakFromPrivateKey(x):this.tweakFromPublicKey(x)}sign(x,f){if(!this.__D)throw new Error("Missing private key");if(f===void 0&&(f=this.lowR),f===!1)return e.sign(x,this.__D);{let p=e.sign(x,this.__D);const g=new Uint8Array(32);let y=0;for(;p[0]>127;)y++,writeUInt32(g,0,y,"LE"),p=e.sign(x,this.__D,g);return p}}signSchnorr(x){if(!this.privateKey)throw new Error("Missing private key");if(!e.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return e.signSchnorr(x,this.privateKey)}verify(x,f){return e.verify(x,this.publicKey,f)}verifySchnorr(x,f){if(!e.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return e.verifySchnorr(x,this.publicKey.subarray(1,33),f)}tweakFromPublicKey(x){const f=toXOnly(this.publicKey),p=e.xOnlyPointAddTweak(f,x);if(!p||p.xOnlyPubkey===null)throw new Error("Cannot tweak public key!");const g=Uint8Array.from([p.parity===0?2:3]);return n(concat([g,p.xOnlyPubkey]),{network:this.network,compressed:this.compressed})}tweakFromPrivateKey(x){const p=this.publicKey[0]===3||this.publicKey[0]===4&&(this.publicKey[64]&1)===1?e.privateNegate(this.privateKey):this.privateKey,g=e.privateAdd(p,x);if(!g)throw new Error("Invalid tweaked private key!");return r(g,{network:this.network,compressed:this.compressed})}}return{isPoint:t,fromPrivateKey:r,fromPublicKey:n,fromWIF:s,makeRandom:a}}let ECPair=null;function getECPair(){return ECPair||(initEccLib(ecc),ECPair=ECPairFactory(ecc)),ECPair}function nostrPubkeyToBitcoinAddress(e){try{getECPair();const t=Buffer.from(e,"hex"),{address:r}=p2tr({internalPubkey:t,network:bitcoin$1});return r||""}catch(t){return console.error("Error generating Bitcoin address:",t),""}}function npubToBitcoinAddress(e){try{const t=nip19_exports$1.decode(e);if(t.type!=="npub")throw new Error("Invalid npub format");const r=t.data;return nostrPubkeyToBitcoinAddress(r)}catch(t){throw console.error("Error converting npub to Bitcoin address:",t),t}}async function fetchUTXOs(e){const t=await fetch(`https://blockstream.info/api/address/${e}/utxo`);if(!t.ok)throw new Error("Failed to fetch UTXOs");return t.json()}async function getFeeRates(){const e=await fetch("https://blockstream.info/api/fee-estimates");if(!e.ok)throw new Error("Failed to fetch fee estimates");const t=await e.json();return{fastestFee:Math.ceil(t[1]||1),halfHourFee:Math.ceil(t[3]||1),hourFee:Math.ceil(t[6]||1),economyFee:Math.ceil(t[144]||1),minimumFee:Math.ceil(t[504]||1)}}async function broadcastTransaction(e){const t=await fetch("https://blockstream.info/api/tx",{method:"POST",body:e});if(!t.ok){const r=await t.text();throw new Error(`Failed to broadcast transaction: ${r}`)}return t.text()}async function createBitcoinTransaction(e,t,r,n,s){const a=Buffer.from(e,"hex"),l=getECPair().fromPrivateKey(a),u=l.publicKey.slice(1,33),{address:x}=p2tr({internalPubkey:u,network:bitcoin$1});if(!x)throw new Error("Failed to generate change address");const f=new Psbt({network:bitcoin$1});let p=0;for(const je of n)f.addInput({hash:je.txid,index:je.vout,witnessUtxo:{script:p2tr({internalPubkey:u,network:bitcoin$1}).output,value:BigInt(je.value)},tapInternalKey:u}),p+=je.value;const g=n.length*57.5+86+10.5,y=Math.ceil(g*s),w=p-r-y;if(w<0)throw new Error(`Insufficient funds. Need ${r+y} sats, have ${p} sats`);f.addOutput({address:t,value:BigInt(r)}),w>546&&f.addOutput({address:x,value:BigInt(w)});const I=l.tweak(taggedHash("TapTweak",u));for(let je=0;je<n.length;je++)f.signInput(je,I);return f.finalizeAllInputs(),{txHex:f.extractTransaction().toHex(),fee:y}}function satsToBTC(e){return(e/1e8).toFixed(8)}function btcToSats(e){return Math.round(e*1e8)}async function fetchTxHistory(e){const t=await fetch(`https://blockstream.info/api/address/${e}/txs`);if(!t.ok)throw new Error("Failed to fetch transaction history");return t.json()}var browser={},canPromise,hasRequiredCanPromise;function requireCanPromise(){return hasRequiredCanPromise||(hasRequiredCanPromise=1,canPromise=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),canPromise}var qrcode={},utils$1={},hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;hasRequiredUtils$1=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return utils$1.getSymbolSize=function(n){if(!n)throw new Error('"version" cannot be null or undefined');if(n<1||n>40)throw new Error('"version" should be in range from 1 to 40');return n*4+17},utils$1.getSymbolTotalCodewords=function(n){return t[n]},utils$1.getBCHDigit=function(r){let n=0;for(;r!==0;)n++,r>>>=1;return n},utils$1.setToSJISFunction=function(n){if(typeof n!="function")throw new Error('"toSJISFunc" is not a valid function.');e=n},utils$1.isKanjiModeEnabled=function(){return typeof e<"u"},utils$1.toSJIS=function(n){return e(n)},utils$1}var errorCorrectionLevel={},hasRequiredErrorCorrectionLevel;function requireErrorCorrectionLevel(){return hasRequiredErrorCorrectionLevel||(hasRequiredErrorCorrectionLevel=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},e.from=function(n,s){if(e.isValid(n))return n;try{return t(n)}catch{return s}}})(errorCorrectionLevel)),errorCorrectionLevel}var bitBuffer,hasRequiredBitBuffer;function requireBitBuffer(){if(hasRequiredBitBuffer)return bitBuffer;hasRequiredBitBuffer=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const r=Math.floor(t/8);return(this.buffer[r]>>>7-t%8&1)===1},put:function(t,r){for(let n=0;n<r;n++)this.putBit((t>>>r-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}},bitBuffer=e,bitBuffer}var bitMatrix,hasRequiredBitMatrix;function requireBitMatrix(){if(hasRequiredBitMatrix)return bitMatrix;hasRequiredBitMatrix=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,r,n,s){const a=t*this.size+r;this.data[a]=n,s&&(this.reservedBit[a]=!0)},e.prototype.get=function(t,r){return this.data[t*this.size+r]},e.prototype.xor=function(t,r,n){this.data[t*this.size+r]^=n},e.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]},bitMatrix=e,bitMatrix}var alignmentPattern={},hasRequiredAlignmentPattern;function requireAlignmentPattern(){return hasRequiredAlignmentPattern||(hasRequiredAlignmentPattern=1,(function(e){const t=requireUtils$1().getSymbolSize;e.getRowColCoords=function(n){if(n===1)return[];const s=Math.floor(n/7)+2,a=t(n),l=a===145?26:Math.ceil((a-13)/(2*s-2))*2,u=[a-7];for(let x=1;x<s-1;x++)u[x]=u[x-1]-l;return u.push(6),u.reverse()},e.getPositions=function(n){const s=[],a=e.getRowColCoords(n),l=a.length;for(let u=0;u<l;u++)for(let x=0;x<l;x++)u===0&&x===0||u===0&&x===l-1||u===l-1&&x===0||s.push([a[u],a[x]]);return s}})(alignmentPattern)),alignmentPattern}var finderPattern={},hasRequiredFinderPattern;function requireFinderPattern(){if(hasRequiredFinderPattern)return finderPattern;hasRequiredFinderPattern=1;const e=requireUtils$1().getSymbolSize,t=7;return finderPattern.getPositions=function(n){const s=e(n);return[[0,0],[s-t,0],[0,s-t]]},finderPattern}var maskPattern={},hasRequiredMaskPattern;function requireMaskPattern(){return hasRequiredMaskPattern||(hasRequiredMaskPattern=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},e.from=function(s){return e.isValid(s)?parseInt(s,10):void 0},e.getPenaltyN1=function(s){const a=s.size;let l=0,u=0,x=0,f=null,p=null;for(let g=0;g<a;g++){u=x=0,f=p=null;for(let y=0;y<a;y++){let w=s.get(g,y);w===f?u++:(u>=5&&(l+=t.N1+(u-5)),f=w,u=1),w=s.get(y,g),w===p?x++:(x>=5&&(l+=t.N1+(x-5)),p=w,x=1)}u>=5&&(l+=t.N1+(u-5)),x>=5&&(l+=t.N1+(x-5))}return l},e.getPenaltyN2=function(s){const a=s.size;let l=0;for(let u=0;u<a-1;u++)for(let x=0;x<a-1;x++){const f=s.get(u,x)+s.get(u,x+1)+s.get(u+1,x)+s.get(u+1,x+1);(f===4||f===0)&&l++}return l*t.N2},e.getPenaltyN3=function(s){const a=s.size;let l=0,u=0,x=0;for(let f=0;f<a;f++){u=x=0;for(let p=0;p<a;p++)u=u<<1&2047|s.get(f,p),p>=10&&(u===1488||u===93)&&l++,x=x<<1&2047|s.get(p,f),p>=10&&(x===1488||x===93)&&l++}return l*t.N3},e.getPenaltyN4=function(s){let a=0;const l=s.data.length;for(let x=0;x<l;x++)a+=s.data[x];return Math.abs(Math.ceil(a*100/l/5)-10)*t.N4};function r(n,s,a){switch(n){case e.Patterns.PATTERN000:return(s+a)%2===0;case e.Patterns.PATTERN001:return s%2===0;case e.Patterns.PATTERN010:return a%3===0;case e.Patterns.PATTERN011:return(s+a)%3===0;case e.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(a/3))%2===0;case e.Patterns.PATTERN101:return s*a%2+s*a%3===0;case e.Patterns.PATTERN110:return(s*a%2+s*a%3)%2===0;case e.Patterns.PATTERN111:return(s*a%3+(s+a)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}e.applyMask=function(s,a){const l=a.size;for(let u=0;u<l;u++)for(let x=0;x<l;x++)a.isReserved(x,u)||a.xor(x,u,r(s,x,u))},e.getBestMask=function(s,a){const l=Object.keys(e.Patterns).length;let u=0,x=1/0;for(let f=0;f<l;f++){a(f),e.applyMask(f,s);const p=e.getPenaltyN1(s)+e.getPenaltyN2(s)+e.getPenaltyN3(s)+e.getPenaltyN4(s);e.applyMask(f,s),p<x&&(x=p,u=f)}return u}})(maskPattern)),maskPattern}var errorCorrectionCode={},hasRequiredErrorCorrectionCode;function requireErrorCorrectionCode(){if(hasRequiredErrorCorrectionCode)return errorCorrectionCode;hasRequiredErrorCorrectionCode=1;const e=requireErrorCorrectionLevel(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],r=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return errorCorrectionCode.getBlocksCount=function(s,a){switch(a){case e.L:return t[(s-1)*4+0];case e.M:return t[(s-1)*4+1];case e.Q:return t[(s-1)*4+2];case e.H:return t[(s-1)*4+3];default:return}},errorCorrectionCode.getTotalCodewordsCount=function(s,a){switch(a){case e.L:return r[(s-1)*4+0];case e.M:return r[(s-1)*4+1];case e.Q:return r[(s-1)*4+2];case e.H:return r[(s-1)*4+3];default:return}},errorCorrectionCode}var polynomial={},galoisField={},hasRequiredGaloisField;function requireGaloisField(){if(hasRequiredGaloisField)return galoisField;hasRequiredGaloisField=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let n=1;for(let s=0;s<255;s++)e[s]=n,t[n]=s,n<<=1,n&256&&(n^=285);for(let s=255;s<512;s++)e[s]=e[s-255]})(),galoisField.log=function(n){if(n<1)throw new Error("log("+n+")");return t[n]},galoisField.exp=function(n){return e[n]},galoisField.mul=function(n,s){return n===0||s===0?0:e[t[n]+t[s]]},galoisField}var hasRequiredPolynomial;function requirePolynomial(){return hasRequiredPolynomial||(hasRequiredPolynomial=1,(function(e){const t=requireGaloisField();e.mul=function(n,s){const a=new Uint8Array(n.length+s.length-1);for(let l=0;l<n.length;l++)for(let u=0;u<s.length;u++)a[l+u]^=t.mul(n[l],s[u]);return a},e.mod=function(n,s){let a=new Uint8Array(n);for(;a.length-s.length>=0;){const l=a[0];for(let x=0;x<s.length;x++)a[x]^=t.mul(s[x],l);let u=0;for(;u<a.length&&a[u]===0;)u++;a=a.slice(u)}return a},e.generateECPolynomial=function(n){let s=new Uint8Array([1]);for(let a=0;a<n;a++)s=e.mul(s,new Uint8Array([1,t.exp(a)]));return s}})(polynomial)),polynomial}var reedSolomonEncoder,hasRequiredReedSolomonEncoder;function requireReedSolomonEncoder(){if(hasRequiredReedSolomonEncoder)return reedSolomonEncoder;hasRequiredReedSolomonEncoder=1;const e=requirePolynomial();function t(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(n){this.degree=n,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(n){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(n.length+this.degree);s.set(n);const a=e.mod(s,this.genPoly),l=this.degree-a.length;if(l>0){const u=new Uint8Array(this.degree);return u.set(a,l),u}return a},reedSolomonEncoder=t,reedSolomonEncoder}var version={},mode={},versionCheck={},hasRequiredVersionCheck;function requireVersionCheck(){return hasRequiredVersionCheck||(hasRequiredVersionCheck=1,versionCheck.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),versionCheck}var regex={},hasRequiredRegex;function requireRegex(){if(hasRequiredRegex)return regex;hasRequiredRegex=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const n="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+`)(?:.|[\r
]))+`;regex.KANJI=new RegExp(r,"g"),regex.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),regex.BYTE=new RegExp(n,"g"),regex.NUMERIC=new RegExp(e,"g"),regex.ALPHANUMERIC=new RegExp(t,"g");const s=new RegExp("^"+r+"$"),a=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return regex.testKanji=function(x){return s.test(x)},regex.testNumeric=function(x){return a.test(x)},regex.testAlphanumeric=function(x){return l.test(x)},regex}var hasRequiredMode;function requireMode(){return hasRequiredMode||(hasRequiredMode=1,(function(e){const t=requireVersionCheck(),r=requireRegex();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(a,l){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?a.ccBits[0]:l<27?a.ccBits[1]:a.ccBits[2]},e.getBestModeForData=function(a){return r.testNumeric(a)?e.NUMERIC:r.testAlphanumeric(a)?e.ALPHANUMERIC:r.testKanji(a)?e.KANJI:e.BYTE},e.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},e.isValid=function(a){return a&&a.bit&&a.ccBits};function n(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+s)}}e.from=function(a,l){if(e.isValid(a))return a;try{return n(a)}catch{return l}}})(mode)),mode}var hasRequiredVersion;function requireVersion(){return hasRequiredVersion||(hasRequiredVersion=1,(function(e){const t=requireUtils$1(),r=requireErrorCorrectionCode(),n=requireErrorCorrectionLevel(),s=requireMode(),a=requireVersionCheck(),l=7973,u=t.getBCHDigit(l);function x(y,w,R){for(let I=1;I<=40;I++)if(w<=e.getCapacity(I,R,y))return I}function f(y,w){return s.getCharCountIndicator(y,w)+4}function p(y,w){let R=0;return y.forEach(function(I){const k=f(I.mode,w);R+=k+I.getBitsLength()}),R}function g(y,w){for(let R=1;R<=40;R++)if(p(y,R)<=e.getCapacity(R,w,s.MIXED))return R}e.from=function(w,R){return a.isValid(w)?parseInt(w,10):R},e.getCapacity=function(w,R,I){if(!a.isValid(w))throw new Error("Invalid QR Code version");typeof I>"u"&&(I=s.BYTE);const k=t.getSymbolTotalCodewords(w),je=r.getTotalCodewordsCount(w,R),Ve=(k-je)*8;if(I===s.MIXED)return Ve;const q=Ve-f(I,w);switch(I){case s.NUMERIC:return Math.floor(q/10*3);case s.ALPHANUMERIC:return Math.floor(q/11*2);case s.KANJI:return Math.floor(q/13);case s.BYTE:default:return Math.floor(q/8)}},e.getBestVersionForData=function(w,R){let I;const k=n.from(R,n.M);if(Array.isArray(w)){if(w.length>1)return g(w,k);if(w.length===0)return 1;I=w[0]}else I=w;return x(I.mode,I.getLength(),k)},e.getEncodedBits=function(w){if(!a.isValid(w)||w<7)throw new Error("Invalid QR Code version");let R=w<<12;for(;t.getBCHDigit(R)-u>=0;)R^=l<<t.getBCHDigit(R)-u;return w<<12|R}})(version)),version}var formatInfo={},hasRequiredFormatInfo;function requireFormatInfo(){if(hasRequiredFormatInfo)return formatInfo;hasRequiredFormatInfo=1;const e=requireUtils$1(),t=1335,r=21522,n=e.getBCHDigit(t);return formatInfo.getEncodedBits=function(a,l){const u=a.bit<<3|l;let x=u<<10;for(;e.getBCHDigit(x)-n>=0;)x^=t<<e.getBCHDigit(x)-n;return(u<<10|x)^r},formatInfo}var segments={},numericData,hasRequiredNumericData;function requireNumericData(){if(hasRequiredNumericData)return numericData;hasRequiredNumericData=1;const e=requireMode();function t(r){this.mode=e.NUMERIC,this.data=r.toString()}return t.getBitsLength=function(n){return 10*Math.floor(n/3)+(n%3?n%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){let s,a,l;for(s=0;s+3<=this.data.length;s+=3)a=this.data.substr(s,3),l=parseInt(a,10),n.put(l,10);const u=this.data.length-s;u>0&&(a=this.data.substr(s),l=parseInt(a,10),n.put(l,u*3+1))},numericData=t,numericData}var alphanumericData,hasRequiredAlphanumericData;function requireAlphanumericData(){if(hasRequiredAlphanumericData)return alphanumericData;hasRequiredAlphanumericData=1;const e=requireMode(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function r(n){this.mode=e.ALPHANUMERIC,this.data=n}return r.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(s){let a;for(a=0;a+2<=this.data.length;a+=2){let l=t.indexOf(this.data[a])*45;l+=t.indexOf(this.data[a+1]),s.put(l,11)}this.data.length%2&&s.put(t.indexOf(this.data[a]),6)},alphanumericData=r,alphanumericData}var byteData,hasRequiredByteData;function requireByteData(){if(hasRequiredByteData)return byteData;hasRequiredByteData=1;const e=requireMode();function t(r){this.mode=e.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}return t.getBitsLength=function(n){return n*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){for(let n=0,s=this.data.length;n<s;n++)r.put(this.data[n],8)},byteData=t,byteData}var kanjiData,hasRequiredKanjiData;function requireKanjiData(){if(hasRequiredKanjiData)return kanjiData;hasRequiredKanjiData=1;const e=requireMode(),t=requireUtils$1();function r(n){this.mode=e.KANJI,this.data=n}return r.getBitsLength=function(s){return s*13},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(n){let s;for(s=0;s<this.data.length;s++){let a=t.toSJIS(this.data[s]);if(a>=33088&&a<=40956)a-=33088;else if(a>=57408&&a<=60351)a-=49472;else throw new Error("Invalid SJIS character: "+this.data[s]+`
Make sure your charset is UTF-8`);a=(a>>>8&255)*192+(a&255),n.put(a,13)}},kanjiData=r,kanjiData}var dijkstra={exports:{}},hasRequiredDijkstra;function requireDijkstra(){return hasRequiredDijkstra||(hasRequiredDijkstra=1,(function(e){var t={single_source_shortest_paths:function(r,n,s){var a={},l={};l[n]=0;var u=t.PriorityQueue.make();u.push(n,0);for(var x,f,p,g,y,w,R,I,k;!u.empty();){x=u.pop(),f=x.value,g=x.cost,y=r[f]||{};for(p in y)y.hasOwnProperty(p)&&(w=y[p],R=g+w,I=l[p],k=typeof l[p]>"u",(k||I>R)&&(l[p]=R,u.push(p,R),a[p]=f))}if(typeof s<"u"&&typeof l[s]>"u"){var je=["Could not find a path from ",n," to ",s,"."].join("");throw new Error(je)}return a},extract_shortest_path_from_predecessor_list:function(r,n){for(var s=[],a=n;a;)s.push(a),r[a],a=r[a];return s.reverse(),s},find_path:function(r,n,s){var a=t.single_source_shortest_paths(r,n,s);return t.extract_shortest_path_from_predecessor_list(a,s)},PriorityQueue:{make:function(r){var n=t.PriorityQueue,s={},a;r=r||{};for(a in n)n.hasOwnProperty(a)&&(s[a]=n[a]);return s.queue=[],s.sorter=r.sorter||n.default_sorter,s},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var s={value:r,cost:n};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(dijkstra)),dijkstra.exports}var hasRequiredSegments;function requireSegments(){return hasRequiredSegments||(hasRequiredSegments=1,(function(e){const t=requireMode(),r=requireNumericData(),n=requireAlphanumericData(),s=requireByteData(),a=requireKanjiData(),l=requireRegex(),u=requireUtils$1(),x=requireDijkstra();function f(je){return unescape(encodeURIComponent(je)).length}function p(je,Ve,q){const $e=[];let We;for(;(We=je.exec(q))!==null;)$e.push({data:We[0],index:We.index,mode:Ve,length:We[0].length});return $e}function g(je){const Ve=p(l.NUMERIC,t.NUMERIC,je),q=p(l.ALPHANUMERIC,t.ALPHANUMERIC,je);let $e,We;return u.isKanjiModeEnabled()?($e=p(l.BYTE,t.BYTE,je),We=p(l.KANJI,t.KANJI,je)):($e=p(l.BYTE_KANJI,t.BYTE,je),We=[]),Ve.concat(q,$e,We).sort(function(W,Ye){return W.index-Ye.index}).map(function(W){return{data:W.data,mode:W.mode,length:W.length}})}function y(je,Ve){switch(Ve){case t.NUMERIC:return r.getBitsLength(je);case t.ALPHANUMERIC:return n.getBitsLength(je);case t.KANJI:return a.getBitsLength(je);case t.BYTE:return s.getBitsLength(je)}}function w(je){return je.reduce(function(Ve,q){const $e=Ve.length-1>=0?Ve[Ve.length-1]:null;return $e&&$e.mode===q.mode?(Ve[Ve.length-1].data+=q.data,Ve):(Ve.push(q),Ve)},[])}function R(je){const Ve=[];for(let q=0;q<je.length;q++){const $e=je[q];switch($e.mode){case t.NUMERIC:Ve.push([$e,{data:$e.data,mode:t.ALPHANUMERIC,length:$e.length},{data:$e.data,mode:t.BYTE,length:$e.length}]);break;case t.ALPHANUMERIC:Ve.push([$e,{data:$e.data,mode:t.BYTE,length:$e.length}]);break;case t.KANJI:Ve.push([$e,{data:$e.data,mode:t.BYTE,length:f($e.data)}]);break;case t.BYTE:Ve.push([{data:$e.data,mode:t.BYTE,length:f($e.data)}])}}return Ve}function I(je,Ve){const q={},$e={start:{}};let We=["start"];for(let K=0;K<je.length;K++){const W=je[K],Ye=[];for(let Qe=0;Qe<W.length;Qe++){const it=W[Qe],ze=""+K+Qe;Ye.push(ze),q[ze]={node:it,lastCount:0},$e[ze]={};for(let v=0;v<We.length;v++){const D=We[v];q[D]&&q[D].node.mode===it.mode?($e[D][ze]=y(q[D].lastCount+it.length,it.mode)-y(q[D].lastCount,it.mode),q[D].lastCount+=it.length):(q[D]&&(q[D].lastCount=it.length),$e[D][ze]=y(it.length,it.mode)+4+t.getCharCountIndicator(it.mode,Ve))}}We=Ye}for(let K=0;K<We.length;K++)$e[We[K]].end=0;return{map:$e,table:q}}function k(je,Ve){let q;const $e=t.getBestModeForData(je);if(q=t.from(Ve,$e),q!==t.BYTE&&q.bit<$e.bit)throw new Error('"'+je+'" cannot be encoded with mode '+t.toString(q)+`.
 Suggested mode is: `+t.toString($e));switch(q===t.KANJI&&!u.isKanjiModeEnabled()&&(q=t.BYTE),q){case t.NUMERIC:return new r(je);case t.ALPHANUMERIC:return new n(je);case t.KANJI:return new a(je);case t.BYTE:return new s(je)}}e.fromArray=function(Ve){return Ve.reduce(function(q,$e){return typeof $e=="string"?q.push(k($e,null)):$e.data&&q.push(k($e.data,$e.mode)),q},[])},e.fromString=function(Ve,q){const $e=g(Ve,u.isKanjiModeEnabled()),We=R($e),K=I(We,q),W=x.find_path(K.map,"start","end"),Ye=[];for(let Qe=1;Qe<W.length-1;Qe++)Ye.push(K.table[W[Qe]].node);return e.fromArray(w(Ye))},e.rawSplit=function(Ve){return e.fromArray(g(Ve,u.isKanjiModeEnabled()))}})(segments)),segments}var hasRequiredQrcode;function requireQrcode(){if(hasRequiredQrcode)return qrcode;hasRequiredQrcode=1;const e=requireUtils$1(),t=requireErrorCorrectionLevel(),r=requireBitBuffer(),n=requireBitMatrix(),s=requireAlignmentPattern(),a=requireFinderPattern(),l=requireMaskPattern(),u=requireErrorCorrectionCode(),x=requireReedSolomonEncoder(),f=requireVersion(),p=requireFormatInfo(),g=requireMode(),y=requireSegments();function w(K,W){const Ye=K.size,Qe=a.getPositions(W);for(let it=0;it<Qe.length;it++){const ze=Qe[it][0],v=Qe[it][1];for(let D=-1;D<=7;D++)if(!(ze+D<=-1||Ye<=ze+D))for(let _e=-1;_e<=7;_e++)v+_e<=-1||Ye<=v+_e||(D>=0&&D<=6&&(_e===0||_e===6)||_e>=0&&_e<=6&&(D===0||D===6)||D>=2&&D<=4&&_e>=2&&_e<=4?K.set(ze+D,v+_e,!0,!0):K.set(ze+D,v+_e,!1,!0))}}function R(K){const W=K.size;for(let Ye=8;Ye<W-8;Ye++){const Qe=Ye%2===0;K.set(Ye,6,Qe,!0),K.set(6,Ye,Qe,!0)}}function I(K,W){const Ye=s.getPositions(W);for(let Qe=0;Qe<Ye.length;Qe++){const it=Ye[Qe][0],ze=Ye[Qe][1];for(let v=-2;v<=2;v++)for(let D=-2;D<=2;D++)v===-2||v===2||D===-2||D===2||v===0&&D===0?K.set(it+v,ze+D,!0,!0):K.set(it+v,ze+D,!1,!0)}}function k(K,W){const Ye=K.size,Qe=f.getEncodedBits(W);let it,ze,v;for(let D=0;D<18;D++)it=Math.floor(D/3),ze=D%3+Ye-8-3,v=(Qe>>D&1)===1,K.set(it,ze,v,!0),K.set(ze,it,v,!0)}function je(K,W,Ye){const Qe=K.size,it=p.getEncodedBits(W,Ye);let ze,v;for(ze=0;ze<15;ze++)v=(it>>ze&1)===1,ze<6?K.set(ze,8,v,!0):ze<8?K.set(ze+1,8,v,!0):K.set(Qe-15+ze,8,v,!0),ze<8?K.set(8,Qe-ze-1,v,!0):ze<9?K.set(8,15-ze-1+1,v,!0):K.set(8,15-ze-1,v,!0);K.set(Qe-8,8,1,!0)}function Ve(K,W){const Ye=K.size;let Qe=-1,it=Ye-1,ze=7,v=0;for(let D=Ye-1;D>0;D-=2)for(D===6&&D--;;){for(let _e=0;_e<2;_e++)if(!K.isReserved(it,D-_e)){let P=!1;v<W.length&&(P=(W[v]>>>ze&1)===1),K.set(it,D-_e,P),ze--,ze===-1&&(v++,ze=7)}if(it+=Qe,it<0||Ye<=it){it-=Qe,Qe=-Qe;break}}}function q(K,W,Ye){const Qe=new r;Ye.forEach(function(_e){Qe.put(_e.mode.bit,4),Qe.put(_e.getLength(),g.getCharCountIndicator(_e.mode,K)),_e.write(Qe)});const it=e.getSymbolTotalCodewords(K),ze=u.getTotalCodewordsCount(K,W),v=(it-ze)*8;for(Qe.getLengthInBits()+4<=v&&Qe.put(0,4);Qe.getLengthInBits()%8!==0;)Qe.putBit(0);const D=(v-Qe.getLengthInBits())/8;for(let _e=0;_e<D;_e++)Qe.put(_e%2?17:236,8);return $e(Qe,K,W)}function $e(K,W,Ye){const Qe=e.getSymbolTotalCodewords(W),it=u.getTotalCodewordsCount(W,Ye),ze=Qe-it,v=u.getBlocksCount(W,Ye),D=Qe%v,_e=v-D,P=Math.floor(Qe/v),Re=Math.floor(ze/v),Fe=Re+1,Le=P-Re,Ce=new x(Le);let L=0;const O=new Array(v),st=new Array(v);let lt=0;const Xe=new Uint8Array(K.buffer);for(let ir=0;ir<v;ir++){const pt=ir<_e?Re:Fe;O[ir]=Xe.slice(L,L+pt),st[ir]=Ce.encode(O[ir]),L+=pt,lt=Math.max(lt,pt)}const dt=new Uint8Array(Qe);let er=0,ar,dr;for(ar=0;ar<lt;ar++)for(dr=0;dr<v;dr++)ar<O[dr].length&&(dt[er++]=O[dr][ar]);for(ar=0;ar<Le;ar++)for(dr=0;dr<v;dr++)dt[er++]=st[dr][ar];return dt}function We(K,W,Ye,Qe){let it;if(Array.isArray(K))it=y.fromArray(K);else if(typeof K=="string"){let P=W;if(!P){const Re=y.rawSplit(K);P=f.getBestVersionForData(Re,Ye)}it=y.fromString(K,P||40)}else throw new Error("Invalid data");const ze=f.getBestVersionForData(it,Ye);if(!ze)throw new Error("The amount of data is too big to be stored in a QR Code");if(!W)W=ze;else if(W<ze)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+ze+`.
`);const v=q(W,Ye,it),D=e.getSymbolSize(W),_e=new n(D);return w(_e,W),R(_e),I(_e,W),je(_e,Ye,0),W>=7&&k(_e,W),Ve(_e,v),isNaN(Qe)&&(Qe=l.getBestMask(_e,je.bind(null,_e,Ye))),l.applyMask(Qe,_e),je(_e,Ye,Qe),{modules:_e,version:W,errorCorrectionLevel:Ye,maskPattern:Qe,segments:it}}return qrcode.create=function(W,Ye){if(typeof W>"u"||W==="")throw new Error("No input text");let Qe=t.M,it,ze;return typeof Ye<"u"&&(Qe=t.from(Ye.errorCorrectionLevel,t.M),it=f.from(Ye.version),ze=l.from(Ye.maskPattern),Ye.toSJISFunc&&e.setToSJISFunction(Ye.toSJISFunc)),We(W,it,Qe,ze)},qrcode}var canvas={},utils={},hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(a){return[a,a]}))),n.length===6&&n.push("F","F");const s=parseInt(n.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+n.slice(0,6).join("")}}e.getOptions=function(n){n||(n={}),n.color||(n.color={});const s=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,a=n.width&&n.width>=21?n.width:void 0,l=n.scale||4;return{width:a,scale:a?4:l,margin:s,color:{dark:t(n.color.dark||"#000000ff"),light:t(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},e.getScale=function(n,s){return s.width&&s.width>=n+s.margin*2?s.width/(n+s.margin*2):s.scale},e.getImageWidth=function(n,s){const a=e.getScale(n,s);return Math.floor((n+s.margin*2)*a)},e.qrToImageData=function(n,s,a){const l=s.modules.size,u=s.modules.data,x=e.getScale(l,a),f=Math.floor((l+a.margin*2)*x),p=a.margin*x,g=[a.color.light,a.color.dark];for(let y=0;y<f;y++)for(let w=0;w<f;w++){let R=(y*f+w)*4,I=a.color.light;if(y>=p&&w>=p&&y<f-p&&w<f-p){const k=Math.floor((y-p)/x),je=Math.floor((w-p)/x);I=g[u[k*l+je]?1:0]}n[R++]=I.r,n[R++]=I.g,n[R++]=I.b,n[R]=I.a}}})(utils)),utils}var hasRequiredCanvas;function requireCanvas(){return hasRequiredCanvas||(hasRequiredCanvas=1,(function(e){const t=requireUtils();function r(s,a,l){s.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=l,a.width=l,a.style.height=l+"px",a.style.width=l+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(a,l,u){let x=u,f=l;typeof x>"u"&&(!l||!l.getContext)&&(x=l,l=void 0),l||(f=n()),x=t.getOptions(x);const p=t.getImageWidth(a.modules.size,x),g=f.getContext("2d"),y=g.createImageData(p,p);return t.qrToImageData(y.data,a,x),r(g,f,p),g.putImageData(y,0,0),f},e.renderToDataURL=function(a,l,u){let x=u;typeof x>"u"&&(!l||!l.getContext)&&(x=l,l=void 0),x||(x={});const f=e.render(a,l,x),p=x.type||"image/png",g=x.rendererOpts||{};return f.toDataURL(p,g.quality)}})(canvas)),canvas}var svgTag={},hasRequiredSvgTag;function requireSvgTag(){if(hasRequiredSvgTag)return svgTag;hasRequiredSvgTag=1;const e=requireUtils();function t(s,a){const l=s.a/255,u=a+'="'+s.hex+'"';return l<1?u+" "+a+'-opacity="'+l.toFixed(2).slice(1)+'"':u}function r(s,a,l){let u=s+a;return typeof l<"u"&&(u+=" "+l),u}function n(s,a,l){let u="",x=0,f=!1,p=0;for(let g=0;g<s.length;g++){const y=Math.floor(g%a),w=Math.floor(g/a);!y&&!f&&(f=!0),s[g]?(p++,g>0&&y>0&&s[g-1]||(u+=f?r("M",y+l,.5+w+l):r("m",x,0),x=0,f=!1),y+1<a&&s[g+1]||(u+=r("h",p),p=0)):x++}return u}return svgTag.render=function(a,l,u){const x=e.getOptions(l),f=a.modules.size,p=a.modules.data,g=f+x.margin*2,y=x.color.light.a?"<path "+t(x.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",w="<path "+t(x.color.dark,"stroke")+' d="'+n(p,f,x.margin)+'"/>',R='viewBox="0 0 '+g+" "+g+'"',k='<svg xmlns="http://www.w3.org/2000/svg" '+(x.width?'width="'+x.width+'" height="'+x.width+'" ':"")+R+' shape-rendering="crispEdges">'+y+w+`</svg>
`;return typeof u=="function"&&u(null,k),k},svgTag}var hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser;hasRequiredBrowser=1;const e=requireCanPromise(),t=requireQrcode(),r=requireCanvas(),n=requireSvgTag();function s(a,l,u,x,f){const p=[].slice.call(arguments,1),g=p.length,y=typeof p[g-1]=="function";if(!y&&!e())throw new Error("Callback required as last argument");if(y){if(g<2)throw new Error("Too few arguments provided");g===2?(f=u,u=l,l=x=void 0):g===3&&(l.getContext&&typeof f>"u"?(f=x,x=void 0):(f=x,x=u,u=l,l=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(u=l,l=x=void 0):g===2&&!l.getContext&&(x=u,u=l,l=void 0),new Promise(function(w,R){try{const I=t.create(u,x);w(a(I,l,x))}catch(I){R(I)}})}try{const w=t.create(u,x);f(null,a(w,l,x))}catch(w){f(w)}}return browser.create=t.create,browser.toCanvas=s.bind(null,r.render),browser.toDataURL=s.bind(null,r.renderToDataURL),browser.toString=s.bind(null,function(a,l,u){return n.render(a,u)}),browser}var browserExports=requireBrowser();const QRCode=getDefaultExportFromCjs$1(browserExports),ReceiveModal=({isOpen:e,onClose:t,address:r})=>{const[n,s]=reactExports.useState(""),[a,l]=reactExports.useState(!1);if(reactExports.useEffect(()=>{e&&r&&QRCode.toDataURL(r,{width:300,margin:2,color:{dark:"#000000",light:"#ffffff"}}).then(x=>s(x)).catch(x=>console.error("Error generating QR code:",x))},[e,r]),!e)return null;const u=()=>{navigator.clipboard.writeText(r),l(!0),setTimeout(()=>l(!1),2e3)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-sm overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Receive Bitcoin"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 flex flex-col items-center",children:[n&&jsxRuntimeExports.jsx("div",{className:"bg-white p-4 rounded-xl mb-6",children:jsxRuntimeExports.jsx("img",{src:n,alt:"Bitcoin Address QR Code",className:"w-48 h-48"})}),jsxRuntimeExports.jsx("div",{className:"w-full bg-slate-950 p-4 rounded-xl border border-slate-800 flex items-center justify-between gap-3 mb-2",children:jsxRuntimeExports.jsx("p",{className:"font-mono text-sm text-slate-300 break-all text-center",children:r})}),jsxRuntimeExports.jsxs("button",{onClick:u,className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors text-sm",children:[a?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),a?"Copied!":"Copy Address"]})]})]})})},SatoshiIcon=({className:e=""})=>jsxRuntimeExports.jsx("i",{className:`fak fa-satoshisymbol-solid ${e}`}),SendModal=({isOpen:e,onClose:t,utxos:r,onSuccess:n,initialRecipient:s=""})=>{const{decryptedKey:a}=useAuthStore(),[l,u]=reactExports.useState("details"),[x,f]=reactExports.useState(s),[p,g]=reactExports.useState(""),[y,w]=reactExports.useState(""),[R,I]=reactExports.useState("sats"),[k,je]=reactExports.useState(1),[Ve,q]=reactExports.useState(null),[$e,We]=reactExports.useState(null),[K,W]=reactExports.useState(""),[Ye,Qe]=reactExports.useState(0),{currentKeypairId:it,wallets:ze,currentWalletId:v}=useWalletStore(),_e=ze.find(nr=>nr.id===v)?.keypairs.find(nr=>nr.id===it),[P,Re]=reactExports.useState([]),[Fe,Le]=reactExports.useState(!1),[Ce,L]=reactExports.useState(!1),[O,st]=reactExports.useState(null);reactExports.useEffect(()=>{e&&_e&&(console.log("[SendModal] Fetching contacts for keypair:",_e.npub),Le(!0),st(null),ProfileService.fetchContacts(_e.npub).then(nr=>{console.log("[SendModal] Received contacts:",nr.length),Re(nr)}).catch(nr=>{console.error("[SendModal] Error fetching contacts:",nr),st("Failed to fetch user follows")}).finally(()=>Le(!1)))},[e,_e]),reactExports.useEffect(()=>{e&&(getFeeRates().then(q).catch(console.error),u("details"),f(s),g(""),w(""),We(null))},[e]),reactExports.useEffect(()=>{const nr=x.trim();if(nr.startsWith("npub"))try{const pr=npubToBitcoinAddress(nr);g(pr)}catch{g("")}else nr.startsWith("bc1")||nr.startsWith("1")||nr.startsWith("3")?g(nr):g("")},[x]);const lt=async()=>{if(We(null),!p){We("Invalid Bitcoin address or npub");return}const nr=R==="btc"?btcToSats(parseFloat(y)):parseInt(y);if(isNaN(nr)||nr<=0){We("Invalid amount");return}if(!a){We("Wallet locked");return}try{const{txHex:pr,fee:gr}=await createBitcoinTransaction(a,p,nr,r,k);W(pr),Qe(gr),u("confirm")}catch(pr){console.error(pr),We(pr.message||"Failed to create transaction")}},Xe=async()=>{u("broadcasting");try{await broadcastTransaction(K),u("success"),setTimeout(()=>{n(),t()},2e3)}catch(nr){console.error(nr),We(nr.message||"Failed to broadcast transaction"),u("confirm")}},dt=reactExports.useRef(null),[er,ar]=reactExports.useState(!1),[dr,ir]=reactExports.useState(null),pt=reactExports.useRef(null),tr=nr=>{const pr=nr.target.files?.[0];if(!pr)return;const gr=new FileReader;gr.onload=mr=>{const yr=mr.target?.result;ir(yr);const Er=new Image;Er.src=yr,Er.onload=()=>{const xr=document.createElement("canvas"),Cr=xr.getContext("2d");if(!Cr)return;const wr=(Dr,rr,cr=!1)=>{xr.width=Dr,xr.height=rr,Cr.drawImage(Er,0,0,Dr,rr);const Br=Cr.getImageData(0,0,Dr,rr),br=jsQR(Br.data,Dr,rr,{inversionAttempts:cr?"invertFirst":"dontInvert"});return br?br.data:null};let kr=wr(Er.width,Er.height);if(!kr&&(Er.width>800||Er.height>800)){const Dr=800/Math.max(Er.width,Er.height);kr=wr(Math.floor(Er.width*Dr),Math.floor(Er.height*Dr))}if(kr||(kr=wr(Er.width,Er.height,!0)),kr){console.log("[Upload] QR Found:",kr);const Dr=kr.replace("bitcoin:","").split("?")[0];f(Dr),ar(!1),ir(null)}else We("No QR code found in image")}},gr.readAsDataURL(pr)},sr=(nr,pr)=>{if(!er){pr.getTracks().forEach(Er=>Er.stop());return}const gr=document.createElement("canvas"),mr=gr.getContext("2d",{willReadFrequently:!0}),yr=()=>{if(nr.readyState===nr.HAVE_ENOUGH_DATA&&mr){gr.height=nr.videoHeight,gr.width=nr.videoWidth,mr.drawImage(nr,0,0,gr.width,gr.height);const Er=mr.getImageData(0,0,gr.width,gr.height),xr=jsQR(Er.data,Er.width,Er.height,{inversionAttempts:"dontInvert"});if(xr){console.log("[Camera] QR Found:",xr.data);const wr=xr.data.replace("bitcoin:","").split("?")[0];f(wr),pr.getTracks().forEach(kr=>kr.stop()),ar(!1);return}}document.getElementById("qr-modal")?requestAnimationFrame(yr):pr.getTracks().forEach(Er=>Er.stop())};requestAnimationFrame(yr)};return reactExports.useEffect(()=>{let nr=null,pr=!0;return er&&(async()=>{if(er)try{const mr=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!pr){mr.getTracks().forEach(Er=>Er.stop());return}nr=mr;const yr=dt.current;yr&&(yr.srcObject=mr,yr.setAttribute("playsinline","true"),yr.onloadedmetadata=()=>{yr.play().catch(Er=>console.error("Play failed",Er)),sr(yr,mr)})}catch(mr){console.error("Camera error:",mr),We("Failed to access camera"),ar(!1)}})(),()=>{pr=!1,nr&&nr.getTracks().forEach(mr=>mr.stop())}},[er]),e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:er?jsxRuntimeExports.jsx("div",{id:"qr-modal",className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-50 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 rounded-xl p-4 border border-slate-800 my-auto",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-4 text-center",children:"Scan BTC Address"}),jsxRuntimeExports.jsxs("div",{className:"relative aspect-square bg-black rounded-lg overflow-hidden mb-4",children:[jsxRuntimeExports.jsx("video",{ref:dt,className:"w-full h-full object-cover",playsInline:!0,muted:!0}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 border-2 border-amber-500/50 rounded-lg pointer-events-none"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("p",{className:"text-center text-slate-400 text-sm",children:"Camera not working? Upload an image instead."}),dr&&jsxRuntimeExports.jsxs("div",{className:"relative max-h-48 overflow-hidden rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Uploaded Image:"}),jsxRuntimeExports.jsx("img",{src:dr,alt:"Uploaded QR",className:"w-full object-contain bg-black/50"})]}),jsxRuntimeExports.jsx("input",{type:"file",ref:pt,onChange:tr,accept:"image/*",capture:"environment",className:"hidden"}),jsxRuntimeExports.jsxs("button",{onClick:()=>pt.current?.click(),className:"w-full bg-slate-800 hover:bg-slate-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5"}),"Upload QR Image"]}),jsxRuntimeExports.jsx("button",{onClick:()=>ar(!1),className:"w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 font-medium py-3 px-4 rounded-lg transition-colors",children:"Cancel"})]})]})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Send Bitcoin"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[l==="details"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Recipient"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 border border-slate-800 rounded-xl p-2 pr-2 focus-within:ring-2 focus-within:ring-amber-500 focus-within:border-transparent transition-all",children:[jsxRuntimeExports.jsx("input",{type:"text",value:x,onChange:nr=>f(nr.target.value),placeholder:"Bitcoin address or npub...",className:"flex-1 bg-transparent text-white outline-none font-mono text-sm px-2 min-w-0"}),jsxRuntimeExports.jsx("button",{onClick:()=>ar(!0),className:"p-2 hover:bg-slate-800 rounded-lg text-amber-500 transition-colors flex-shrink-0",title:"Scan QR Code",children:jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5"})})]}),x.startsWith("npub")&&p&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-green-500 mt-1 break-all",children:["Resolved: ",p]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[_e&&jsxRuntimeExports.jsxs("button",{onClick:()=>f(_e.npub),className:"px-3 py-2 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 text-xs font-medium rounded-lg transition-colors flex items-center gap-2",children:[jsxRuntimeExports.jsx(ArrowRight,{className:"w-3.5 h-3.5"}),"Send to Myself"]}),_e&&jsxRuntimeExports.jsxs("button",{onClick:()=>L(!Ce),className:`px-3 py-2 text-xs font-medium rounded-lg transition-colors flex items-center gap-2 ${Ce?"bg-amber-500/20 text-amber-400":"bg-amber-500/10 hover:bg-amber-500/20 text-amber-500"}`,children:[jsxRuntimeExports.jsx(User,{className:"w-3.5 h-3.5"}),Ce?"Hide Follows":"Select from Follows"]})]}),Ce&&jsxRuntimeExports.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto bg-slate-950 border border-slate-800 rounded-xl p-2 space-y-2 custom-scrollbar",children:Fe?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-slate-400 gap-2",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-5 h-5 animate-spin text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:"Currently fetching user follows..."})]}):O?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-red-400 gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:O})]}):P.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-slate-400 gap-2",children:[jsxRuntimeExports.jsx(User,{className:"w-5 h-5 opacity-50"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:"User not following anyone"})]}):P.map(nr=>{let pr="";try{pr=nr.npub?npubToBitcoinAddress(nr.npub):""}catch{return null}if(!pr)return null;const gr=nr.npub===x;return jsxRuntimeExports.jsxs("div",{onClick:()=>{f(nr.npub)},className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors group border ${gr?"bg-amber-500/10 border-amber-500/30":"hover:bg-slate-900 border-transparent"}`,children:[nr.picture?jsxRuntimeExports.jsx("img",{src:nr.picture,alt:nr.name,className:"w-8 h-8 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-slate-500"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"font-bold text-sm text-white truncate",children:nr.name||"Unknown"}),nr.nip05&&jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 truncate",children:nr.nip05})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[jsxRuntimeExports.jsxs("span",{className:"font-mono truncate",children:[nr.npub.slice(0,8),"...",nr.npub.slice(-8)]}),jsxRuntimeExports.jsx("button",{onClick:mr=>{mr.stopPropagation(),navigator.clipboard.writeText(nr.npub)},className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",title:"Copy npub",children:jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[jsxRuntimeExports.jsx("span",{className:"font-mono truncate text-amber-500/70",children:pr.length>16?`${pr.slice(0,8)}...${pr.slice(-8)}`:pr}),jsxRuntimeExports.jsx("button",{onClick:mr=>{mr.stopPropagation(),navigator.clipboard.writeText(pr)},className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",title:"Copy Bitcoin Address",children:jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]})]})]},nr.npub)})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-1",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"Amount"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-slate-500",children:["Available: ",r.reduce((nr,pr)=>nr+pr.value,0).toLocaleString()," sats"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 border border-slate-800 rounded-xl p-3 focus-within:ring-2 focus-within:ring-amber-500 focus:border-transparent transition-all",children:[R==="sats"?jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-xl text-amber-500 flex-shrink-0"}):jsxRuntimeExports.jsx("span",{className:"text-xl text-amber-500 flex-shrink-0",children:""}),jsxRuntimeExports.jsx("input",{type:"number",value:y,onChange:nr=>w(nr.target.value),placeholder:"0.00",className:"flex-1 bg-transparent text-white outline-none font-mono text-lg min-w-0"}),jsxRuntimeExports.jsx("button",{onClick:()=>{const nr=r.reduce((pr,gr)=>pr+gr.value,0);w(R==="sats"?nr.toString():satsToBTC(nr).toString())},className:"px-2 py-1 bg-amber-500/10 hover:bg-amber-500/20 text-amber-500 text-xs font-bold rounded transition-colors",children:"MAX"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>I(R==="sats"?"btc":"sats"),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Toggle unit",children:jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("span",{className:"text-slate-400 font-medium text-sm flex-shrink-0",children:R==="sats"?"sats":"BTC"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Fee Rate (sat/vB)"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>Ve&&je(Ve.hourFee),className:`p-2 rounded-lg border text-xs transition-all ${k===Ve?.hourFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Slow"}),jsxRuntimeExports.jsxs("div",{children:[Ve?.hourFee||"-"," sat/vB"]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Ve&&je(Ve.halfHourFee),className:`p-2 rounded-lg border text-xs transition-all ${k===Ve?.halfHourFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Normal"}),jsxRuntimeExports.jsxs("div",{children:[Ve?.halfHourFee||"-"," sat/vB"]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Ve&&je(Ve.fastestFee),className:`p-2 rounded-lg border text-xs transition-all ${k===Ve?.fastestFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Fast"}),jsxRuntimeExports.jsxs("div",{children:[Ve?.fastestFee||"-"," sat/vB"]})]})]}),jsxRuntimeExports.jsx("input",{type:"number",value:k,onChange:nr=>je(parseInt(nr.target.value)||1),className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm"})]}),$e&&jsxRuntimeExports.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),$e]}),jsxRuntimeExports.jsxs("button",{onClick:lt,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:["Review Transaction",jsxRuntimeExports.jsx(ArrowRight,{className:"w-4 h-4"})]})]}),l==="confirm"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:"Amount"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("span",{className:"text-lg text-amber-500",children:""}),jsxRuntimeExports.jsxs("span",{className:"font-mono font-bold text-white",children:[R==="btc"?y:satsToBTC(parseInt(y))," BTC"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:"Fee"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"w-3.5 h-3.5 text-slate-400"}),jsxRuntimeExports.jsxs("span",{className:"font-mono text-slate-300",children:[Ye," sats"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-slate-800 pt-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400 block mb-1",children:"To"}),jsxRuntimeExports.jsx("span",{className:"font-mono text-xs text-slate-300 break-all",children:p})]})]}),$e&&jsxRuntimeExports.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),$e]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>u("details"),className:"flex-1 py-3 px-4 bg-slate-800 hover:bg-slate-700 text-slate-300 font-medium rounded-xl transition-colors",children:"Back"}),jsxRuntimeExports.jsx("button",{onClick:Xe,className:"flex-1 py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors",children:"Confirm Send"})]})]}),l==="broadcasting"&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-12 h-12 text-amber-500 animate-spin mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-slate-300 font-medium",children:"Broadcasting transaction..."})]}),l==="success"&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(Check,{className:"w-8 h-8 text-green-500"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Sent!"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-center",children:"Your transaction has been broadcast successfully."})]})]})]})})}):null},TransactionDetailsModal=({isOpen:e,onClose:t,txid:r})=>{const[n,s]=reactExports.useState(!1);if(!e)return null;const a=()=>{navigator.clipboard.writeText(r),s(!0),setTimeout(()=>s(!1),2e3)},l=[{name:"Mempool.space",url:`https://mempool.space/tx/${r}`},{name:"Blockstream",url:`https://blockstream.info/tx/${r}`},{name:"Blockchain.com",url:`https://www.blockchain.com/explorer/transactions/btc/${r}`}];return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-800 w-full max-w-md overflow-hidden shadow-xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-800 flex items-center justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg text-white",children:"Transaction Details"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Transaction ID"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 rounded-lg p-3 border border-slate-800",children:[jsxRuntimeExports.jsx("code",{className:"text-sm text-slate-300 break-all font-mono flex-1",children:r}),jsxRuntimeExports.jsx("button",{onClick:a,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Copy TXID",children:n?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"View on Explorer"}),jsxRuntimeExports.jsx("div",{className:"grid gap-2",children:l.map(u=>jsxRuntimeExports.jsxs("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 bg-slate-800 hover:bg-slate-700 rounded-xl transition-colors group",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-slate-200",children:u.name}),jsxRuntimeExports.jsx(ExternalLink,{className:"w-4 h-4 text-slate-500 group-hover:text-white transition-colors"})]},u.name))})]})]})]})})},BitcoinWallet=()=>{const{currentKeypairId:e,wallets:t,currentWalletId:r}=useWalletStore(),[n,s]=reactExports.useState(""),[a,l]=reactExports.useState(0),[u,x]=reactExports.useState([]),[f,p]=reactExports.useState([]),[g,y]=reactExports.useState(!1),[w,R]=reactExports.useState(!1),[I,k]=reactExports.useState(!1),[je,Ve]=reactExports.useState(!1),[q,$e]=reactExports.useState(null),K=t.find(Qe=>Qe.id===r)?.keypairs.find(Qe=>Qe.id===e),W=async()=>{if(n){y(!0);try{const[Qe,it]=await Promise.all([fetchUTXOs(n),fetchTxHistory(n)]);x(Qe),p(it);const ze=Qe.reduce((v,D)=>v+D.value,0);l(ze),ze>=1e6&&Ve(!0)}catch(Qe){console.error("Error fetching Bitcoin data:",Qe)}finally{y(!1)}}};reactExports.useEffect(()=>{if(K)try{const Qe=npubToBitcoinAddress(K.npub);s(Qe)}catch(Qe){console.error("Error deriving Bitcoin address:",Qe)}},[K]),reactExports.useEffect(()=>{W()},[n]);const Ye=Qe=>{let it=0;return Qe.vin.forEach(ze=>{ze.prevout&&ze.prevout.scriptpubkey_address===n&&(it-=ze.prevout.value)}),Qe.vout.forEach(ze=>{ze.scriptpubkey_address===n&&(it+=ze.value)}),{netChange:it,isReceive:it>0,absAmount:Math.abs(it)}};return K?jsxRuntimeExports.jsxs("div",{className:"pb-24",children:[jsxRuntimeExports.jsx("div",{className:"pb-4",children:jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-br from-amber-500/20 to-orange-600/20 border border-amber-500/20 rounded-2xl p-6 relative overflow-hidden",children:jsxRuntimeExports.jsxs("div",{className:"relative z-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("h2",{className:"text-slate-400 text-sm font-medium",children:"Total Balance"}),jsxRuntimeExports.jsx("button",{onClick:()=>Ve(!je),className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors",title:"Toggle display format",children:jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4 text-slate-400"})})]}),je?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-3xl max-[400px]:text-2xl max-[300px]:text-xl text-amber-500",children:""}),jsxRuntimeExports.jsx("span",{className:"text-4xl max-[400px]:text-3xl max-[300px]:text-2xl font-bold text-white",children:satsToBTC(a)}),jsxRuntimeExports.jsx("span",{className:"text-amber-500 font-bold",children:"BTC"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-sm mt-1",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"w-3.5 h-3.5"}),jsxRuntimeExports.jsxs("span",{children:[a.toLocaleString()," sats"]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-2",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-3xl max-[400px]:text-2xl max-[300px]:text-xl text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-4xl max-[400px]:text-3xl max-[300px]:text-2xl font-bold text-white",children:a.toLocaleString()}),jsxRuntimeExports.jsx("span",{className:"text-amber-500 font-bold",children:"sats"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-sm mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-base",children:""}),jsxRuntimeExports.jsxs("span",{children:[" ",satsToBTC(a)," BTC"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 flex gap-3 flex-wrap",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>R(!0),className:"flex-1 bg-slate-900/50 hover:bg-slate-900/70 text-white py-2 px-4 rounded-xl font-medium transition-colors flex items-center justify-center gap-2 border border-white/10",children:[jsxRuntimeExports.jsx(ArrowDownLeft,{className:"w-4 h-4 text-green-400"}),"Receive"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>k(!0),className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 py-2 px-4 rounded-xl font-bold transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4"}),"Send"]})]})]})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"History"}),jsxRuntimeExports.jsx("button",{onClick:W,disabled:g,className:`p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors ${g?"animate-spin":""}`,children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:f.length===0?jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-slate-500",children:"No transactions found"}):f.map(Qe=>{const{isReceive:it,absAmount:ze}=Ye(Qe);return jsxRuntimeExports.jsx("button",{onClick:()=>$e(Qe.txid),className:"w-full text-left bg-slate-900 border border-slate-800 rounded-xl p-4 hover:border-slate-700 transition-colors",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-full ${it?"bg-green-500/10 text-green-500":"bg-amber-500/10 text-amber-500"}`,children:it?jsxRuntimeExports.jsx(ArrowDownLeft,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-white",children:it?"Received":"Sent"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400",children:new Date((Qe.status.block_time||Date.now()/1e3)*1e3).toLocaleDateString()})]})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsxs("div",{className:`font-bold ${it?"text-green-500":"text-white"}`,children:[it?"+":"-",ze.toLocaleString()," sats"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-end gap-1 text-xs text-slate-500",children:[jsxRuntimeExports.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Qe.status.confirmed?"bg-green-500":"bg-amber-500"}`}),jsxRuntimeExports.jsx("span",{children:Qe.status.confirmed?"Confirmed":"Pending"})]})]})]})},Qe.txid)})})]}),jsxRuntimeExports.jsx(ReceiveModal,{isOpen:w,onClose:()=>R(!1),address:n}),jsxRuntimeExports.jsx(SendModal,{isOpen:I,onClose:()=>k(!1),utxos:u,onSuccess:W}),jsxRuntimeExports.jsx(TransactionDetailsModal,{isOpen:!!q,onClose:()=>$e(null),txid:q||""})]}):jsxRuntimeExports.jsx("div",{className:"p-4 text-center text-slate-400",children:"No active keypair"})};class CashuService{static mints=new Map;static getMint(t){return this.mints.has(t)||this.mints.set(t,new S(t)),this.mints.get(t)}static async getInitializedWallet(t){let n=useEcashStore.getState().mints[t]?.keys;n||(console.log(`keys not found in store for ${t}, fetching...`),n=await this.loadMint(t));const s=this.getMint(t),a=n;a&&a.keysets&&a.keysets.forEach(x=>{x.active===void 0&&(x.active=!0)});const l={keysets:a?.keysets,keys:a?.keysets,unit:"sat"};return new Ze(s,l)}static async loadMint(t){const r=this.getMint(t);try{const n=await r.getKeys();return useEcashStore.getState().addMint(t,n),n}catch(n){throw console.error("Failed to load mint:",t,n),n}}static async receiveToken(t){try{const r=pe(t);let n=r.token;if(!n&&r.proofs&&r.mint&&(console.log(" Detected flat token structure, normalizing..."),n=[{mint:r.mint,proofs:r.proofs}]),!n)throw new Error('Invalid token structure: missing "token" array and not a valid flat token.');const s=[],{decryptedKey:a,publicKey:l}=useAuthStore.getState();for(const u of n){const x=u.mint;let f=!1;if(u.proofs.forEach(R=>{try{const I=JSON.parse(R.secret);if(Array.isArray(I)&&I[0]==="P2PK"){const k=I[1].data;a?(k.length===66?k.substring(2):k)!==l&&(console.warn(` Skipping Token: Locked to ${k.substring(0,6)}... (Not us)`),f=!0):console.error(" P2PK Token found but NO decrypted private key available in store!")}}catch{}}),f)continue;const p=await this.getInitializedWallet(x),g=Array.from(new Set(u.proofs.map(R=>R.id))),y=()=>p.keys instanceof Map?Array.from(p.keys.keys()):Object.keys(p.keys||{});let w=!1;for(const R of g){if(typeof R!="string")continue;if(!y().includes(R)){console.warn(` Warning: Wallet missing keys for keyset ${R}. Attempting to fetch...`);try{const k=await p.mint.getKeys(R),je=useEcashStore.getState().mints[x];if(je&&je.keys){const Ve=je.keys;if(Ve.keysets&&!new Set(Ve.keysets.map($e=>$e.id)).has(k.keysets[0].id)){const We={keysets:[...Ve.keysets,k.keysets[0]]};useEcashStore.getState().addMint(x,We),console.log(` Fetched and saved keys for ${R} to store.`),w=!0}}}catch(k){console.error(` Failed to fetch keys for ${R}:`,k)}}}if(w){console.log(" Reloading wallet with updated keys...");const R=await this.getInitializedWallet(x),I={};a&&(I.privkey=a);const k=await R.receive(t,I);s.push(...k)}else{const R={};a&&(R.privkey=a);const I=await p.receive(t,R);s.push(...I)}}return useEcashStore.getState().addProofs(s,!0),console.log(" Publishing receive state to NIP-60 (skip merge)..."),await useEcashStore.getState().publishProofsToNostr(!0),s}catch(r){throw console.error("Receive failed:",r),r}}static async consolidateProofs(t,r){console.log(` Consolidating ${r.length} proofs from ${t}...`);const n=await this.getInitializedWallet(t),s=He({mint:t,proofs:r}),a=await n.receive(s);return console.log(` Consolidated ${r.length} proofs  ${a.length} proofs`),a}static async transferBetweenMints(t,r,n){try{console.log(` Transferring ${t} sats from ${r} to ${n}...`),console.log(" Creating mint quote at destination...");const s=await this.getInitializedWallet(n),a=await s.createMintQuote(t);if(!a.request)throw new Error("Failed to create mint quote - no invoice received");console.log(` Mint quote created: ${a.quote}`),console.log(` Lightning invoice: ${a.request.substring(0,50)}...`),console.log(" Melting proofs at source mint...");const l=await this.meltTokens(r,a.request);console.log(` Melt successful! Spent ${l.amountSpent} sats`),console.log(" Claiming minted proofs at destination...");const u=await s.mintProofs(t,a.quote);return useEcashStore.getState().addProofs(u,!0),console.log(" Publishing updated wallet state to NIP-60..."),await useEcashStore.getState().publishProofsToNostr(!0),console.log(` Transfer complete! Received ${u.length} proofs at destination`),{success:!0,newProofs:u}}catch(s){return console.error(" Transfer failed:",s),{success:!1,error:s.message||"Unknown error"}}}static async checkProofStates(t,r){console.log(` Checking ${r.length} proofs at ${t}...`);const n=await this.getInitializedWallet(t);try{const s=await n.checkProofsStates(r),a=[],l=[];return r.forEach((u,x)=>{const f=s[x];f&&f.state==="SPENT"?a.push(u):l.push(u)}),console.log(` Check complete: ${l.length} valid, ${a.length} spent`),{valid:l,spent:a}}catch(s){return console.error(" Failed to check proof states:",s),{valid:r,spent:[]}}}static async sendToken(t,r,n,s,a=!1){console.log(` CashuService: Sending ${t} from ${r}${a?" (keeping proofs for later removal)":""}`);const l=await this.getInitializedWallet(r),u=useEcashStore.getState().proofs,x=new Set;l.keys&&l.keys.size>0?l.keys.forEach((je,Ve)=>x.add(Ve)):console.warn(" Wallet keys map is empty, falling back to all keysets logic might be needed if this fails.");const f=u.filter(je=>x.has(je.id));if(console.log(` CashuService: Found ${f.length} proofs for this mint (out of ${u.length} total)`),console.log(" CashuService: Valid Keysets:",Array.from(x)),f.length===0)throw new Error("No proofs found for this specific mint");const p=f.reduce((je,Ve)=>je+Ve.amount,0);if(p<t)throw new Error(`Insufficient balance in this mint. Have: ${p}, Need: ${t}`);let g;if(n)try{const je=nip19_exports$1.decode(n);je.type==="npub"&&(g=je.data,g.length===64&&(g="02"+g))}catch{throw new Error("Invalid Recipient Npub")}let y;try{console.log(" Initiating wallet.send..."),y=await l.send(t,f,{pubkey:g}),console.log(" Wallet send successful. Response keys:",Object.keys(y))}catch(je){throw console.error(" Crash inside wallet.send:",je),console.error(" Stack trace:",je.stack),new Error(`Wallet send failed: ${je.message}`)}const w=y.keep||y.returnChange||[],R=y.send||[];if(console.log(` Swap complete. Keep: ${w.length}, Send: ${R.length}`),a)console.log(" Removing original proofs from wallet (already spent at mint)..."),useEcashStore.getState().removeProofs(f,!0),useEcashStore.getState().addProofs(w,!0),console.log(" Original proofs removed, change added to wallet.");else try{console.log(" Updating store (removing inputs, adding keep)..."),useEcashStore.getState().removeProofs(f),useEcashStore.getState().addProofs(w),console.log(" Store updated."),console.log(" Publishing send state to NIP-60 (skip merge)..."),await useEcashStore.getState().publishProofsToNostr(!0)}catch(je){throw console.error(" Store update failed:",je),je}console.log(" Encoding token...");const k=He({mint:r,proofs:R,memo:s,unit:"sat"},{version:3});return a?{token:k,usedProofs:f}:k}static getMintBalance(t){return 0}static async validateMint(t){try{return await this.getMint(t).getKeys(),"online"}catch{return"offline"}}static async getMintQuote(t,r){return await(await this.getInitializedWallet(t)).createMintQuote(r)}static async claimMintQuote(t,r,n){const a=await(await this.getInitializedWallet(t)).mintProofs(n,r);return useEcashStore.getState().addProofs(a),a}static async getMeltQuote(t,r){return await(await this.getInitializedWallet(t)).createMeltQuote(r)}static async meltTokens(t,r){const n=await this.getInitializedWallet(t),s=await n.createMeltQuote(r),a=useEcashStore.getState().proofs,{mints:l}=useEcashStore.getState();console.log(` meltTokens: Looking for proofs for mint: ${t}`),console.log(` Total proofs available: ${a.length}`),console.log(" Available mints:",Object.keys(l));const u=a.filter(w=>{const R=l[t]?.keys;if(!R)return!1;let I=!1;return R.keysets&&Array.isArray(R.keysets)?I=R.keysets.some(k=>k.id===w.id):R[w.id]&&(I=!0),console.log(`  Proof ${w.secret.substring(0,10)}... (keyset: ${w.id}) -> ${I?"MATCH":"NO MATCH"}`),I});console.log(` Found ${u.length} proofs for ${t}`);const x=u.reduce((w,R)=>w+R.amount,0),f=s.amount+s.fee_reserve;if(console.log(` Quote: amount=${s.amount} sats, fee_reserve=${s.fee_reserve} sats`),console.log(` Required: ${f} sats, Available: ${x} sats`),x<f)throw new Error(`Insufficient balance. Need ${f} sats, have ${x} sats`);let p=[],g=0;for(const w of u){if(g>=f)break;p.push(w),g+=w.amount}console.log(` Selected ${p.length} proofs totaling ${g} sats`);const y=await n.meltProofs(s,p);return useEcashStore.getState().removeProofs(p),y.change&&y.change.length>0&&useEcashStore.getState().addProofs(y.change),console.log(" Publishing melt state to NIP-60 (skip merge)..."),await useEcashStore.getState().publishProofsToNostr(!0),{quote:s,response:y,amountSpent:g,change:y.change}}}const KIND_NIP60_TOKEN=7375,KIND_NIP61_NUTZAP=9321;class Nip60Service{static async encryptWalletState(t,r,n){const{nip44:s}=await __vitePreload(async()=>{const{nip44:p}=await Promise.resolve().then(()=>index$3);return{nip44:p}},void 0,import.meta.url),a=new Uint8Array(r.match(/.{1,2}/g).map(p=>parseInt(p,16))),l=s.v2.utils.getConversationKey(a,n),u=t.history.sort((p,g)=>g.timestamp-p.timestamp).slice(0,1e3),x=JSON.stringify({proofs:t.proofs,history:u});return s.v2.encrypt(x,l)}static async decryptWalletState(t,r,n){const{nip44:s}=await __vitePreload(async()=>{const{nip44:f}=await Promise.resolve().then(()=>index$3);return{nip44:f}},void 0,import.meta.url),a=new Uint8Array(r.match(/.{1,2}/g).map(f=>parseInt(f,16))),l=s.v2.utils.getConversationKey(a,n),u=s.v2.decrypt(t,l),x=JSON.parse(u);return Array.isArray(x)?(console.log(" Detected old NIP-60 format (proofs only)"),{proofs:x,history:[]}):{proofs:x.proofs||[],history:x.history||[]}}static createProofEvent(t){return{kind:30078,content:t,tags:[["d","proofs"]],created_at:Math.floor(Date.now()/1e3)}}static async publishWalletState(t,r,n,s){try{console.log(` Publishing ${r.proofs.length} proofs + ${r.history.length} history entries to Nostr...`);const a=await this.encryptWalletState(r,n,s),l=this.createProofEvent(a),{NDKEvent:u}=await __vitePreload(async()=>{const{NDKEvent:p}=await Promise.resolve().then(()=>index$1);return{NDKEvent:p}},void 0,import.meta.url),x=new u(t,l);await x.sign();const f=await x.publish();console.log(` Wallet state published to ${f.size} relays`),f.size===0&&console.warn(" Published to 0 relays - wallet state may not sync")}catch(a){throw console.error(" Failed to publish wallet state:",a),a}}static subscribeToWalletState(t,r,n,s){console.log(" Subscribing to NIP-60 wallet state events...");let a=0;const l=t.subscribe({kinds:[30078],authors:[r],"#d":["proofs"]});return l.on("event",async u=>{try{if(u.created_at<=a){console.log(` Skipping older NIP-60 event (${u.created_at} <= ${a})`);return}console.log(" Received NIP-60 wallet state event:",u.id),a=u.created_at;const x=await this.decryptWalletState(u.content,n,r);console.log(` Decrypted ${x.proofs.length} proofs + ${x.history.length} history entries from Nostr`),s(x)}catch(x){console.error(" Failed to decrypt wallet state event:",x)}}),l}static createTokenEvent(t,r){return{kind:KIND_NIP60_TOKEN,content:t,tags:r?[["p",r]]:[],created_at:Math.floor(Date.now()/1e3)}}}class Nip61Service{static createNutZapEvent(t,r,n,s,a){const l=[["p",s],["amount",n.toString()],["mint",r],["u",r]];return a&&l.push(["desc",a]),{kind:KIND_NIP61_NUTZAP,content:t,tags:l,created_at:Math.floor(Date.now()/1e3)}}static parseNutZap(t){if(t.kind!==KIND_NIP61_NUTZAP)return console.log("NIP61: Invalid kind",t.kind),null;try{if(!t.content.startsWith("cashu"))return console.log("NIP61: Content does not start with cashu"),null;const n=t.tags.find(a=>a[0]==="amount"),s=t.tags.find(a=>a[0]==="mint"||a[0]==="u");return!n&&!s&&console.log("NIP61: Missing amount or mint tags. Proceeding with limited info."),{mint:s?s[1]:"",proofs:[],amount:n?parseInt(n[1]):0,memo:t.tags.find(a=>a[0]==="desc")?.[1]||"",sender:t.pubkey}}catch(r){return console.error("NIP61: Parse error",r),null}}}const nip61=Object.freeze(Object.defineProperty({__proto__:null,KIND_NIP60_TOKEN,KIND_NIP61_NUTZAP,Nip60Service,Nip61Service},Symbol.toStringTag,{value:"Module"})),KIND_MINT_INFO=38172,KIND_MINT_RECOMMENDATION=38e3;class Nip87Service{static parseMintInfo(t){try{const r=t.tags.find(n=>n[0]==="u");return!r||!r[1]?null:{url:r[1].replace(/\/$/,""),pubkey:t.pubkey}}catch{return null}}static subscribeToMints(t){console.log(" Nip87Service: Subscribing to mints (kinds 38172, 38000)...");const r=t.subscribe({kinds:[KIND_MINT_INFO,KIND_MINT_RECOMMENDATION],limit:500},{closeOnEose:!1});r.on("eose",()=>{console.log(" Nip87Service: EOSE reached for mint subscription")});let n=0,s=Date.now();return r.on("event",a=>{n++;const l=Date.now();l-s>5e3&&(console.log(` NIP-87: Received ${n} mint discovery events`),s=l);const u=useEcashStore.getState();if(a.kind===KIND_MINT_INFO){const x=this.parseMintInfo(a);x&&x.url&&!u.discoveredMints[x.url]&&!u.mints[x.url]&&u.addDiscoveredMint({url:x.url,status:"unknown",trustScore:0,reviews:0,lastSeen:Date.now()})}else if(a.kind===KIND_MINT_RECOMMENDATION){const x=a.tags.find(f=>f[0]==="u");if(x&&x[1]){const f=x[1].replace(/\/$/,"");u.discoveredMints[f]&&u.updateMintTrust(f,1)}}}),r}}const EcashReceiveModal=({isOpen:e,onClose:t})=>{const r=useWalletStore(v=>v.wallets.find(D=>D.id===v.currentWalletId)?.keypairs.find(D=>D.id===v.currentKeypairId)),{mints:n,addHistoryItem:s}=useEcashStore(),[a,l]=reactExports.useState("nutzap"),[u,x]=reactExports.useState(""),[f,p]=reactExports.useState(!1),[g,y]=reactExports.useState(null),[w,R]=reactExports.useState(100),[I,k]=reactExports.useState(""),[je,Ve]=reactExports.useState(null),[q,$e]=reactExports.useState(!1),[We,K]=reactExports.useState(!1),[W,Ye]=reactExports.useState(!1);reactExports.useEffect(()=>{if(e&&!I){const v=Object.values(n).filter(D=>D.active);v.length>0&&k(v[0].url)}},[e,n]),reactExports.useEffect(()=>{e||(Ye(!1),Ve(null),K(!1),y(null),x(""))},[e]),reactExports.useEffect(()=>{a!=="lightning"&&(Ye(!1),Ve(null),K(!1))},[a]);const Qe=async()=>{if(u){p(!0),y(null);try{const D=(await CashuService.receiveToken(u)).reduce((_e,P)=>_e+P.amount,0);y({type:"success",msg:`Successfully received ${D} sats!`}),x(""),setTimeout(t,2e3)}catch(v){y({type:"error",msg:v.message||"Failed to claim token"})}finally{p(!1)}}},it=async()=>{if(!(!I||w<=0)){$e(!0),Ye(!1);try{const v=await CashuService.getMintQuote(I,w);Ve(v),K(!0),ze(I,v.quote)}catch(v){console.error(v),y({type:"error",msg:"Failed to generate invoice"})}finally{$e(!1)}}},ze=async(v,D)=>{const _e=setInterval(async()=>{try{const P=await CashuService.claimMintQuote(v,D,w);P&&P.length>0&&(clearInterval(_e),K(!1),Ye(!0),s({id:`mint-${D}-${Date.now()}`,type:"receive",amount:w,timestamp:Math.floor(Date.now()/1e3),mint:v,isNutzap:!1}),setTimeout(t,2e3))}catch{}},3e3);setTimeout(()=>{clearInterval(_e),We&&K(!1)},3e5)};return!e||!r?null:jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Receive eCash"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white rounded-lg",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex border-b border-slate-800",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{l("nutzap"),Ye(!1),Ve(null)},className:`flex-1 py-3 text-sm font-bold transition-colors border-b-2 ${a==="nutzap"?"border-purple-500 text-purple-400":"border-transparent text-slate-500 hover:text-slate-300"}`,children:"NutZap"}),jsxRuntimeExports.jsx("button",{onClick:()=>{l("lightning"),Ye(!1),Ve(null)},className:`flex-1 py-3 text-sm font-bold transition-colors border-b-2 ${a==="lightning"?"border-purple-500 text-purple-400":"border-transparent text-slate-500 hover:text-slate-300"}`,children:"Lightning"})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[a==="nutzap"?jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-white p-4 rounded-xl",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:r.npub,size:180})}),jsxRuntimeExports.jsxs("p",{className:"text-slate-400 text-sm text-center",children:["Share this QR to receive ",jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:"NutZaps"}),"."]}),jsxRuntimeExports.jsxs("button",{onClick:()=>navigator.clipboard.writeText(r.npub),className:"flex items-center gap-2 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 rounded-lg text-slate-300 text-xs font-mono transition-colors",children:[jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"}),r.npub.slice(0,10),"...",r.npub.slice(-10)]})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-slate-800"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Import Token"}),jsxRuntimeExports.jsx("textarea",{value:u,onChange:v=>x(v.target.value),placeholder:"Paste cashuA... token here",className:"w-full h-24 bg-slate-950 border border-slate-800 rounded-xl p-3 text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition-all font-mono text-xs resize-none"}),jsxRuntimeExports.jsx("button",{onClick:Qe,disabled:f||!u,className:"w-full mt-3 py-3 px-4 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:f?jsxRuntimeExports.jsx(LoaderCircle,{className:"w-4 h-4 animate-spin"}):"Claim Token"})]})]}):jsxRuntimeExports.jsx("div",{className:"space-y-6",children:je?jsxRuntimeExports.jsx("div",{className:"space-y-6 text-center",children:W?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2 py-8 animate-in zoom-in",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-green-500/10 rounded-full flex items-center justify-center ring-4 ring-green-500/20 mb-2",children:jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-8 h-8 text-green-500"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white",children:"Payment Received!"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-400",children:["Successfully minted ",w," sats."]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"p-4 bg-white rounded-xl mx-auto w-fit",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:je.request,size:200})}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("h3",{className:"font-bold text-white text-lg",children:[w," sats"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 break-all bg-slate-950 p-2 rounded border border-slate-800 font-mono select-all",children:je.request})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 text-purple-400 text-sm animate-pulse",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-4 h-4 animate-spin"}),jsxRuntimeExports.jsx("span",{children:"Waiting for payment..."})]})]})}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Receive to Mint"}),Object.values(n).filter(v=>v.active).length===0?jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-red-300 text-sm",children:"No active mints found. Please add a mint in the wallet view first."}):jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("select",{value:I,onChange:v=>k(v.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-xl p-3 text-white outline-none focus:border-purple-500 appearance-none pr-10",children:Object.values(n).filter(v=>v.active).map(v=>jsxRuntimeExports.jsx("option",{value:v.url,className:"bg-slate-800 text-white",children:v.url.replace("https://","").replace(/\/$/,"")},v.url))}),jsxRuntimeExports.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400",children:jsxRuntimeExports.jsx(ChevronDown,{className:"w-4 h-4"})})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Amount (sats)"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:"number",value:w,onChange:v=>R(parseInt(v.target.value)||0),className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 pl-3 pr-12 text-white outline-none focus:border-purple-500 font-mono text-lg"}),jsxRuntimeExports.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-500 text-sm font-bold",children:"SATS"})]})]}),jsxRuntimeExports.jsx("button",{onClick:it,disabled:q||!I||w<=0,className:"w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:q?jsxRuntimeExports.jsx(LoaderCircle,{className:"w-4 h-4 animate-spin"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Zap,{className:"w-4 h-4 fill-current"})," Generate Invoice"]})})]})}),g&&jsxRuntimeExports.jsxs("div",{className:`mt-4 p-3 rounded-lg text-sm flex items-center gap-2 ${g.type==="success"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:[g.type==="success"?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4"}),g.msg]})]})]})})};class LnurlService{static isLightningAddress(t){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t.trim())}static parseLightningAddress(t){const[r,n]=t.split("@");return{username:r,domain:n}}static async resolveToInvoice(t,r){try{const{username:n,domain:s}=this.parseLightningAddress(t);console.log(` Resolving ${n}@${s} for ${r} sats`);const a=`https://${s}/.well-known/lnurlp/${n}`;console.log(` Fetching: ${a}`);const l=await fetch(a);if(!l.ok)throw new Error(`Failed to fetch Lightning address info: ${l.statusText}`);const u=await l.json();if(u.tag!=="payRequest")throw new Error("Invalid LNURL-pay response");const x=r*1e3;if(x<u.minSendable||x>u.maxSendable){const y=Math.ceil(u.minSendable/1e3),w=Math.floor(u.maxSendable/1e3);throw new Error(`Amount must be between ${y} and ${w} sats`)}const f=`${u.callback}?amount=${x}`;console.log(` Requesting invoice: ${f}`);const p=await fetch(f);if(!p.ok)throw new Error(`Failed to get invoice: ${p.statusText}`);const g=await p.json();if(!g.pr)throw new Error("No invoice returned from Lightning address");return console.log(" Lightning address resolved to invoice"),g.pr}catch(n){throw console.error(" Lightning address resolution failed:",n),new Error(`Failed to resolve ${t}: ${n.message}`)}}}var bech32,hasRequiredBech32;function requireBech32(){if(hasRequiredBech32)return bech32;hasRequiredBech32=1;for(var e="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={},r=0;r<e.length;r++){var n=e.charAt(r);if(t[n]!==void 0)throw new TypeError(n+" is ambiguous");t[n]=r}function s(I){var k=I>>25;return(I&33554431)<<5^-(k>>0&1)&996825010^-(k>>1&1)&642813549^-(k>>2&1)&513874426^-(k>>3&1)&1027748829^-(k>>4&1)&705979059}function a(I){for(var k=1,je=0;je<I.length;++je){var Ve=I.charCodeAt(je);if(Ve<33||Ve>126)return"Invalid prefix ("+I+")";k=s(k)^Ve>>5}for(k=s(k),je=0;je<I.length;++je){var q=I.charCodeAt(je);k=s(k)^q&31}return k}function l(I,k,je){if(je=je||90,I.length+7+k.length>je)throw new TypeError("Exceeds length limit");I=I.toLowerCase();var Ve=a(I);if(typeof Ve=="string")throw new Error(Ve);for(var q=I+"1",$e=0;$e<k.length;++$e){var We=k[$e];if(We>>5!==0)throw new Error("Non 5-bit word");Ve=s(Ve)^We,q+=e.charAt(We)}for($e=0;$e<6;++$e)Ve=s(Ve);for(Ve^=1,$e=0;$e<6;++$e){var K=Ve>>(5-$e)*5&31;q+=e.charAt(K)}return q}function u(I,k){if(k=k||90,I.length<8)return I+" too short";if(I.length>k)return"Exceeds length limit";var je=I.toLowerCase(),Ve=I.toUpperCase();if(I!==je&&I!==Ve)return"Mixed-case string "+I;I=je;var q=I.lastIndexOf("1");if(q===-1)return"No separator character for "+I;if(q===0)return"Missing prefix for "+I;var $e=I.slice(0,q),We=I.slice(q+1);if(We.length<6)return"Data too short";var K=a($e);if(typeof K=="string")return K;for(var W=[],Ye=0;Ye<We.length;++Ye){var Qe=We.charAt(Ye),it=t[Qe];if(it===void 0)return"Unknown character "+Qe;K=s(K)^it,!(Ye+6>=We.length)&&W.push(it)}return K!==1?"Invalid checksum for "+I:{prefix:$e,words:W}}function x(){var I=u.apply(null,arguments);if(typeof I=="object")return I}function f(I){var k=u.apply(null,arguments);if(typeof k=="object")return k;throw new Error(k)}function p(I,k,je,Ve){for(var q=0,$e=0,We=(1<<je)-1,K=[],W=0;W<I.length;++W)for(q=q<<k|I[W],$e+=k;$e>=je;)$e-=je,K.push(q>>$e&We);if(Ve)$e>0&&K.push(q<<je-$e&We);else{if($e>=k)return"Excess padding";if(q<<je-$e&We)return"Non-zero padding"}return K}function g(I){var k=p(I,8,5,!0);if(Array.isArray(k))return k}function y(I){var k=p(I,8,5,!0);if(Array.isArray(k))return k;throw new Error(k)}function w(I){var k=p(I,5,8,!1);if(Array.isArray(k))return k}function R(I){var k=p(I,5,8,!1);if(Array.isArray(k))return k;throw new Error(k)}return bech32={decodeUnsafe:x,decode:f,encode:l,toWordsUnsafe:g,toWords:y,fromWordsUnsafe:w,fromWords:R},bech32}var bech32Exports=requireBech32(),bn$1={exports:{}},bn=bn$1.exports,hasRequiredBn;function requireBn(){return hasRequiredBn||(hasRequiredBn=1,(function(e){(function(t,r){function n(ze,v){if(!ze)throw new Error(v||"Assertion failed")}function s(ze,v){ze.super_=v;var D=function(){};D.prototype=v.prototype,ze.prototype=new D,ze.prototype.constructor=ze}function a(ze,v,D){if(a.isBN(ze))return ze;this.negative=0,this.words=null,this.length=0,this.red=null,ze!==null&&((v==="le"||v==="be")&&(D=v,v=10),this._init(ze||0,v||10,D||"be"))}typeof t=="object"?t.exports=a:r.BN=a,a.BN=a,a.wordSize=26;var l;try{typeof window<"u"&&typeof window.Buffer<"u"?l=window.Buffer:l=requireDist$4().Buffer}catch{}a.isBN=function(v){return v instanceof a?!0:v!==null&&typeof v=="object"&&v.constructor.wordSize===a.wordSize&&Array.isArray(v.words)},a.max=function(v,D){return v.cmp(D)>0?v:D},a.min=function(v,D){return v.cmp(D)<0?v:D},a.prototype._init=function(v,D,_e){if(typeof v=="number")return this._initNumber(v,D,_e);if(typeof v=="object")return this._initArray(v,D,_e);D==="hex"&&(D=16),n(D===(D|0)&&D>=2&&D<=36),v=v.toString().replace(/\s+/g,"");var P=0;v[0]==="-"&&(P++,this.negative=1),P<v.length&&(D===16?this._parseHex(v,P,_e):(this._parseBase(v,D,P),_e==="le"&&this._initArray(this.toArray(),D,_e)))},a.prototype._initNumber=function(v,D,_e){v<0&&(this.negative=1,v=-v),v<67108864?(this.words=[v&67108863],this.length=1):v<4503599627370496?(this.words=[v&67108863,v/67108864&67108863],this.length=2):(n(v<9007199254740992),this.words=[v&67108863,v/67108864&67108863,1],this.length=3),_e==="le"&&this._initArray(this.toArray(),D,_e)},a.prototype._initArray=function(v,D,_e){if(n(typeof v.length=="number"),v.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(v.length/3),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var Re,Fe,Le=0;if(_e==="be")for(P=v.length-1,Re=0;P>=0;P-=3)Fe=v[P]|v[P-1]<<8|v[P-2]<<16,this.words[Re]|=Fe<<Le&67108863,this.words[Re+1]=Fe>>>26-Le&67108863,Le+=24,Le>=26&&(Le-=26,Re++);else if(_e==="le")for(P=0,Re=0;P<v.length;P+=3)Fe=v[P]|v[P+1]<<8|v[P+2]<<16,this.words[Re]|=Fe<<Le&67108863,this.words[Re+1]=Fe>>>26-Le&67108863,Le+=24,Le>=26&&(Le-=26,Re++);return this.strip()};function u(ze,v){var D=ze.charCodeAt(v);return D>=65&&D<=70?D-55:D>=97&&D<=102?D-87:D-48&15}function x(ze,v,D){var _e=u(ze,D);return D-1>=v&&(_e|=u(ze,D-1)<<4),_e}a.prototype._parseHex=function(v,D,_e){this.length=Math.ceil((v.length-D)/6),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var Re=0,Fe=0,Le;if(_e==="be")for(P=v.length-1;P>=D;P-=2)Le=x(v,D,P)<<Re,this.words[Fe]|=Le&67108863,Re>=18?(Re-=18,Fe+=1,this.words[Fe]|=Le>>>26):Re+=8;else{var Ce=v.length-D;for(P=Ce%2===0?D+1:D;P<v.length;P+=2)Le=x(v,D,P)<<Re,this.words[Fe]|=Le&67108863,Re>=18?(Re-=18,Fe+=1,this.words[Fe]|=Le>>>26):Re+=8}this.strip()};function f(ze,v,D,_e){for(var P=0,Re=Math.min(ze.length,D),Fe=v;Fe<Re;Fe++){var Le=ze.charCodeAt(Fe)-48;P*=_e,Le>=49?P+=Le-49+10:Le>=17?P+=Le-17+10:P+=Le}return P}a.prototype._parseBase=function(v,D,_e){this.words=[0],this.length=1;for(var P=0,Re=1;Re<=67108863;Re*=D)P++;P--,Re=Re/D|0;for(var Fe=v.length-_e,Le=Fe%P,Ce=Math.min(Fe,Fe-Le)+_e,L=0,O=_e;O<Ce;O+=P)L=f(v,O,O+P,D),this.imuln(Re),this.words[0]+L<67108864?this.words[0]+=L:this._iaddn(L);if(Le!==0){var st=1;for(L=f(v,O,v.length,D),O=0;O<Le;O++)st*=D;this.imuln(st),this.words[0]+L<67108864?this.words[0]+=L:this._iaddn(L)}this.strip()},a.prototype.copy=function(v){v.words=new Array(this.length);for(var D=0;D<this.length;D++)v.words[D]=this.words[D];v.length=this.length,v.negative=this.negative,v.red=this.red},a.prototype.clone=function(){var v=new a(null);return this.copy(v),v},a.prototype._expand=function(v){for(;this.length<v;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(v,D){v=v||10,D=D|0||1;var _e;if(v===16||v==="hex"){_e="";for(var P=0,Re=0,Fe=0;Fe<this.length;Fe++){var Le=this.words[Fe],Ce=((Le<<P|Re)&16777215).toString(16);Re=Le>>>24-P&16777215,P+=2,P>=26&&(P-=26,Fe--),Re!==0||Fe!==this.length-1?_e=p[6-Ce.length]+Ce+_e:_e=Ce+_e}for(Re!==0&&(_e=Re.toString(16)+_e);_e.length%D!==0;)_e="0"+_e;return this.negative!==0&&(_e="-"+_e),_e}if(v===(v|0)&&v>=2&&v<=36){var L=g[v],O=y[v];_e="";var st=this.clone();for(st.negative=0;!st.isZero();){var lt=st.modn(O).toString(v);st=st.idivn(O),st.isZero()?_e=lt+_e:_e=p[L-lt.length]+lt+_e}for(this.isZero()&&(_e="0"+_e);_e.length%D!==0;)_e="0"+_e;return this.negative!==0&&(_e="-"+_e),_e}n(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var v=this.words[0];return this.length===2?v+=this.words[1]*67108864:this.length===3&&this.words[2]===1?v+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-v:v},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(v,D){return n(typeof l<"u"),this.toArrayLike(l,v,D)},a.prototype.toArray=function(v,D){return this.toArrayLike(Array,v,D)},a.prototype.toArrayLike=function(v,D,_e){var P=this.byteLength(),Re=_e||Math.max(1,P);n(P<=Re,"byte array longer than desired length"),n(Re>0,"Requested array length <= 0"),this.strip();var Fe=D==="le",Le=new v(Re),Ce,L,O=this.clone();if(Fe){for(L=0;!O.isZero();L++)Ce=O.andln(255),O.iushrn(8),Le[L]=Ce;for(;L<Re;L++)Le[L]=0}else{for(L=0;L<Re-P;L++)Le[L]=0;for(L=0;!O.isZero();L++)Ce=O.andln(255),O.iushrn(8),Le[Re-L-1]=Ce}return Le},Math.clz32?a.prototype._countBits=function(v){return 32-Math.clz32(v)}:a.prototype._countBits=function(v){var D=v,_e=0;return D>=4096&&(_e+=13,D>>>=13),D>=64&&(_e+=7,D>>>=7),D>=8&&(_e+=4,D>>>=4),D>=2&&(_e+=2,D>>>=2),_e+D},a.prototype._zeroBits=function(v){if(v===0)return 26;var D=v,_e=0;return(D&8191)===0&&(_e+=13,D>>>=13),(D&127)===0&&(_e+=7,D>>>=7),(D&15)===0&&(_e+=4,D>>>=4),(D&3)===0&&(_e+=2,D>>>=2),(D&1)===0&&_e++,_e},a.prototype.bitLength=function(){var v=this.words[this.length-1],D=this._countBits(v);return(this.length-1)*26+D};function w(ze){for(var v=new Array(ze.bitLength()),D=0;D<v.length;D++){var _e=D/26|0,P=D%26;v[D]=(ze.words[_e]&1<<P)>>>P}return v}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var v=0,D=0;D<this.length;D++){var _e=this._zeroBits(this.words[D]);if(v+=_e,_e!==26)break}return v},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(v){return this.negative!==0?this.abs().inotn(v).iaddn(1):this.clone()},a.prototype.fromTwos=function(v){return this.testn(v-1)?this.notn(v).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(v){for(;this.length<v.length;)this.words[this.length++]=0;for(var D=0;D<v.length;D++)this.words[D]=this.words[D]|v.words[D];return this.strip()},a.prototype.ior=function(v){return n((this.negative|v.negative)===0),this.iuor(v)},a.prototype.or=function(v){return this.length>v.length?this.clone().ior(v):v.clone().ior(this)},a.prototype.uor=function(v){return this.length>v.length?this.clone().iuor(v):v.clone().iuor(this)},a.prototype.iuand=function(v){var D;this.length>v.length?D=v:D=this;for(var _e=0;_e<D.length;_e++)this.words[_e]=this.words[_e]&v.words[_e];return this.length=D.length,this.strip()},a.prototype.iand=function(v){return n((this.negative|v.negative)===0),this.iuand(v)},a.prototype.and=function(v){return this.length>v.length?this.clone().iand(v):v.clone().iand(this)},a.prototype.uand=function(v){return this.length>v.length?this.clone().iuand(v):v.clone().iuand(this)},a.prototype.iuxor=function(v){var D,_e;this.length>v.length?(D=this,_e=v):(D=v,_e=this);for(var P=0;P<_e.length;P++)this.words[P]=D.words[P]^_e.words[P];if(this!==D)for(;P<D.length;P++)this.words[P]=D.words[P];return this.length=D.length,this.strip()},a.prototype.ixor=function(v){return n((this.negative|v.negative)===0),this.iuxor(v)},a.prototype.xor=function(v){return this.length>v.length?this.clone().ixor(v):v.clone().ixor(this)},a.prototype.uxor=function(v){return this.length>v.length?this.clone().iuxor(v):v.clone().iuxor(this)},a.prototype.inotn=function(v){n(typeof v=="number"&&v>=0);var D=Math.ceil(v/26)|0,_e=v%26;this._expand(D),_e>0&&D--;for(var P=0;P<D;P++)this.words[P]=~this.words[P]&67108863;return _e>0&&(this.words[P]=~this.words[P]&67108863>>26-_e),this.strip()},a.prototype.notn=function(v){return this.clone().inotn(v)},a.prototype.setn=function(v,D){n(typeof v=="number"&&v>=0);var _e=v/26|0,P=v%26;return this._expand(_e+1),D?this.words[_e]=this.words[_e]|1<<P:this.words[_e]=this.words[_e]&~(1<<P),this.strip()},a.prototype.iadd=function(v){var D;if(this.negative!==0&&v.negative===0)return this.negative=0,D=this.isub(v),this.negative^=1,this._normSign();if(this.negative===0&&v.negative!==0)return v.negative=0,D=this.isub(v),v.negative=1,D._normSign();var _e,P;this.length>v.length?(_e=this,P=v):(_e=v,P=this);for(var Re=0,Fe=0;Fe<P.length;Fe++)D=(_e.words[Fe]|0)+(P.words[Fe]|0)+Re,this.words[Fe]=D&67108863,Re=D>>>26;for(;Re!==0&&Fe<_e.length;Fe++)D=(_e.words[Fe]|0)+Re,this.words[Fe]=D&67108863,Re=D>>>26;if(this.length=_e.length,Re!==0)this.words[this.length]=Re,this.length++;else if(_e!==this)for(;Fe<_e.length;Fe++)this.words[Fe]=_e.words[Fe];return this},a.prototype.add=function(v){var D;return v.negative!==0&&this.negative===0?(v.negative=0,D=this.sub(v),v.negative^=1,D):v.negative===0&&this.negative!==0?(this.negative=0,D=v.sub(this),this.negative=1,D):this.length>v.length?this.clone().iadd(v):v.clone().iadd(this)},a.prototype.isub=function(v){if(v.negative!==0){v.negative=0;var D=this.iadd(v);return v.negative=1,D._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(v),this.negative=1,this._normSign();var _e=this.cmp(v);if(_e===0)return this.negative=0,this.length=1,this.words[0]=0,this;var P,Re;_e>0?(P=this,Re=v):(P=v,Re=this);for(var Fe=0,Le=0;Le<Re.length;Le++)D=(P.words[Le]|0)-(Re.words[Le]|0)+Fe,Fe=D>>26,this.words[Le]=D&67108863;for(;Fe!==0&&Le<P.length;Le++)D=(P.words[Le]|0)+Fe,Fe=D>>26,this.words[Le]=D&67108863;if(Fe===0&&Le<P.length&&P!==this)for(;Le<P.length;Le++)this.words[Le]=P.words[Le];return this.length=Math.max(this.length,Le),P!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(v){return this.clone().isub(v)};function R(ze,v,D){D.negative=v.negative^ze.negative;var _e=ze.length+v.length|0;D.length=_e,_e=_e-1|0;var P=ze.words[0]|0,Re=v.words[0]|0,Fe=P*Re,Le=Fe&67108863,Ce=Fe/67108864|0;D.words[0]=Le;for(var L=1;L<_e;L++){for(var O=Ce>>>26,st=Ce&67108863,lt=Math.min(L,v.length-1),Xe=Math.max(0,L-ze.length+1);Xe<=lt;Xe++){var dt=L-Xe|0;P=ze.words[dt]|0,Re=v.words[Xe]|0,Fe=P*Re+st,O+=Fe/67108864|0,st=Fe&67108863}D.words[L]=st|0,Ce=O|0}return Ce!==0?D.words[L]=Ce|0:D.length--,D.strip()}var I=function(v,D,_e){var P=v.words,Re=D.words,Fe=_e.words,Le=0,Ce,L,O,st=P[0]|0,lt=st&8191,Xe=st>>>13,dt=P[1]|0,er=dt&8191,ar=dt>>>13,dr=P[2]|0,ir=dr&8191,pt=dr>>>13,tr=P[3]|0,sr=tr&8191,nr=tr>>>13,pr=P[4]|0,gr=pr&8191,mr=pr>>>13,yr=P[5]|0,Er=yr&8191,xr=yr>>>13,Cr=P[6]|0,wr=Cr&8191,kr=Cr>>>13,Dr=P[7]|0,rr=Dr&8191,cr=Dr>>>13,Br=P[8]|0,br=Br&8191,lr=Br>>>13,Sr=P[9]|0,yt=Sr&8191,Je=Sr>>>13,ft=Re[0]|0,or=ft&8191,Ar=ft>>>13,_r=Re[1]|0,Nr=_r&8191,Hr=_r>>>13,Gr=Re[2]|0,Vr=Gr&8191,zr=Gr>>>13,Zr=Re[3]|0,xn=Zr&8191,nn=Zr>>>13,Yn=Re[4]|0,vn=Yn&8191,gn=Yn>>>13,Ai=Re[5]|0,fr=Ai&8191,ht=Ai>>>13,Ft=Re[6]|0,vr=Ft&8191,jr=Ft>>>13,Pr=Re[7]|0,Or=Pr&8191,Xr=Pr>>>13,An=Re[8]|0,tn=An&8191,Jr=An>>>13,rn=Re[9]|0,dn=rn&8191,_n=rn>>>13;_e.negative=v.negative^D.negative,_e.length=19,Ce=Math.imul(lt,or),L=Math.imul(lt,Ar),L=L+Math.imul(Xe,or)|0,O=Math.imul(Xe,Ar);var Bi=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Bi>>>26)|0,Bi&=67108863,Ce=Math.imul(er,or),L=Math.imul(er,Ar),L=L+Math.imul(ar,or)|0,O=Math.imul(ar,Ar),Ce=Ce+Math.imul(lt,Nr)|0,L=L+Math.imul(lt,Hr)|0,L=L+Math.imul(Xe,Nr)|0,O=O+Math.imul(Xe,Hr)|0;var ko=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(ko>>>26)|0,ko&=67108863,Ce=Math.imul(ir,or),L=Math.imul(ir,Ar),L=L+Math.imul(pt,or)|0,O=Math.imul(pt,Ar),Ce=Ce+Math.imul(er,Nr)|0,L=L+Math.imul(er,Hr)|0,L=L+Math.imul(ar,Nr)|0,O=O+Math.imul(ar,Hr)|0,Ce=Ce+Math.imul(lt,Vr)|0,L=L+Math.imul(lt,zr)|0,L=L+Math.imul(Xe,Vr)|0,O=O+Math.imul(Xe,zr)|0;var Do=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Do>>>26)|0,Do&=67108863,Ce=Math.imul(sr,or),L=Math.imul(sr,Ar),L=L+Math.imul(nr,or)|0,O=Math.imul(nr,Ar),Ce=Ce+Math.imul(ir,Nr)|0,L=L+Math.imul(ir,Hr)|0,L=L+Math.imul(pt,Nr)|0,O=O+Math.imul(pt,Hr)|0,Ce=Ce+Math.imul(er,Vr)|0,L=L+Math.imul(er,zr)|0,L=L+Math.imul(ar,Vr)|0,O=O+Math.imul(ar,zr)|0,Ce=Ce+Math.imul(lt,xn)|0,L=L+Math.imul(lt,nn)|0,L=L+Math.imul(Xe,xn)|0,O=O+Math.imul(Xe,nn)|0;var qi=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(qi>>>26)|0,qi&=67108863,Ce=Math.imul(gr,or),L=Math.imul(gr,Ar),L=L+Math.imul(mr,or)|0,O=Math.imul(mr,Ar),Ce=Ce+Math.imul(sr,Nr)|0,L=L+Math.imul(sr,Hr)|0,L=L+Math.imul(nr,Nr)|0,O=O+Math.imul(nr,Hr)|0,Ce=Ce+Math.imul(ir,Vr)|0,L=L+Math.imul(ir,zr)|0,L=L+Math.imul(pt,Vr)|0,O=O+Math.imul(pt,zr)|0,Ce=Ce+Math.imul(er,xn)|0,L=L+Math.imul(er,nn)|0,L=L+Math.imul(ar,xn)|0,O=O+Math.imul(ar,nn)|0,Ce=Ce+Math.imul(lt,vn)|0,L=L+Math.imul(lt,gn)|0,L=L+Math.imul(Xe,vn)|0,O=O+Math.imul(Xe,gn)|0;var Ts=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Ts>>>26)|0,Ts&=67108863,Ce=Math.imul(Er,or),L=Math.imul(Er,Ar),L=L+Math.imul(xr,or)|0,O=Math.imul(xr,Ar),Ce=Ce+Math.imul(gr,Nr)|0,L=L+Math.imul(gr,Hr)|0,L=L+Math.imul(mr,Nr)|0,O=O+Math.imul(mr,Hr)|0,Ce=Ce+Math.imul(sr,Vr)|0,L=L+Math.imul(sr,zr)|0,L=L+Math.imul(nr,Vr)|0,O=O+Math.imul(nr,zr)|0,Ce=Ce+Math.imul(ir,xn)|0,L=L+Math.imul(ir,nn)|0,L=L+Math.imul(pt,xn)|0,O=O+Math.imul(pt,nn)|0,Ce=Ce+Math.imul(er,vn)|0,L=L+Math.imul(er,gn)|0,L=L+Math.imul(ar,vn)|0,O=O+Math.imul(ar,gn)|0,Ce=Ce+Math.imul(lt,fr)|0,L=L+Math.imul(lt,ht)|0,L=L+Math.imul(Xe,fr)|0,O=O+Math.imul(Xe,ht)|0;var Ci=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Ci>>>26)|0,Ci&=67108863,Ce=Math.imul(wr,or),L=Math.imul(wr,Ar),L=L+Math.imul(kr,or)|0,O=Math.imul(kr,Ar),Ce=Ce+Math.imul(Er,Nr)|0,L=L+Math.imul(Er,Hr)|0,L=L+Math.imul(xr,Nr)|0,O=O+Math.imul(xr,Hr)|0,Ce=Ce+Math.imul(gr,Vr)|0,L=L+Math.imul(gr,zr)|0,L=L+Math.imul(mr,Vr)|0,O=O+Math.imul(mr,zr)|0,Ce=Ce+Math.imul(sr,xn)|0,L=L+Math.imul(sr,nn)|0,L=L+Math.imul(nr,xn)|0,O=O+Math.imul(nr,nn)|0,Ce=Ce+Math.imul(ir,vn)|0,L=L+Math.imul(ir,gn)|0,L=L+Math.imul(pt,vn)|0,O=O+Math.imul(pt,gn)|0,Ce=Ce+Math.imul(er,fr)|0,L=L+Math.imul(er,ht)|0,L=L+Math.imul(ar,fr)|0,O=O+Math.imul(ar,ht)|0,Ce=Ce+Math.imul(lt,vr)|0,L=L+Math.imul(lt,jr)|0,L=L+Math.imul(Xe,vr)|0,O=O+Math.imul(Xe,jr)|0;var Ss=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Ss>>>26)|0,Ss&=67108863,Ce=Math.imul(rr,or),L=Math.imul(rr,Ar),L=L+Math.imul(cr,or)|0,O=Math.imul(cr,Ar),Ce=Ce+Math.imul(wr,Nr)|0,L=L+Math.imul(wr,Hr)|0,L=L+Math.imul(kr,Nr)|0,O=O+Math.imul(kr,Hr)|0,Ce=Ce+Math.imul(Er,Vr)|0,L=L+Math.imul(Er,zr)|0,L=L+Math.imul(xr,Vr)|0,O=O+Math.imul(xr,zr)|0,Ce=Ce+Math.imul(gr,xn)|0,L=L+Math.imul(gr,nn)|0,L=L+Math.imul(mr,xn)|0,O=O+Math.imul(mr,nn)|0,Ce=Ce+Math.imul(sr,vn)|0,L=L+Math.imul(sr,gn)|0,L=L+Math.imul(nr,vn)|0,O=O+Math.imul(nr,gn)|0,Ce=Ce+Math.imul(ir,fr)|0,L=L+Math.imul(ir,ht)|0,L=L+Math.imul(pt,fr)|0,O=O+Math.imul(pt,ht)|0,Ce=Ce+Math.imul(er,vr)|0,L=L+Math.imul(er,jr)|0,L=L+Math.imul(ar,vr)|0,O=O+Math.imul(ar,jr)|0,Ce=Ce+Math.imul(lt,Or)|0,L=L+Math.imul(lt,Xr)|0,L=L+Math.imul(Xe,Or)|0,O=O+Math.imul(Xe,Xr)|0;var _s=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(_s>>>26)|0,_s&=67108863,Ce=Math.imul(br,or),L=Math.imul(br,Ar),L=L+Math.imul(lr,or)|0,O=Math.imul(lr,Ar),Ce=Ce+Math.imul(rr,Nr)|0,L=L+Math.imul(rr,Hr)|0,L=L+Math.imul(cr,Nr)|0,O=O+Math.imul(cr,Hr)|0,Ce=Ce+Math.imul(wr,Vr)|0,L=L+Math.imul(wr,zr)|0,L=L+Math.imul(kr,Vr)|0,O=O+Math.imul(kr,zr)|0,Ce=Ce+Math.imul(Er,xn)|0,L=L+Math.imul(Er,nn)|0,L=L+Math.imul(xr,xn)|0,O=O+Math.imul(xr,nn)|0,Ce=Ce+Math.imul(gr,vn)|0,L=L+Math.imul(gr,gn)|0,L=L+Math.imul(mr,vn)|0,O=O+Math.imul(mr,gn)|0,Ce=Ce+Math.imul(sr,fr)|0,L=L+Math.imul(sr,ht)|0,L=L+Math.imul(nr,fr)|0,O=O+Math.imul(nr,ht)|0,Ce=Ce+Math.imul(ir,vr)|0,L=L+Math.imul(ir,jr)|0,L=L+Math.imul(pt,vr)|0,O=O+Math.imul(pt,jr)|0,Ce=Ce+Math.imul(er,Or)|0,L=L+Math.imul(er,Xr)|0,L=L+Math.imul(ar,Or)|0,O=O+Math.imul(ar,Xr)|0,Ce=Ce+Math.imul(lt,tn)|0,L=L+Math.imul(lt,Jr)|0,L=L+Math.imul(Xe,tn)|0,O=O+Math.imul(Xe,Jr)|0;var $s=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+($s>>>26)|0,$s&=67108863,Ce=Math.imul(yt,or),L=Math.imul(yt,Ar),L=L+Math.imul(Je,or)|0,O=Math.imul(Je,Ar),Ce=Ce+Math.imul(br,Nr)|0,L=L+Math.imul(br,Hr)|0,L=L+Math.imul(lr,Nr)|0,O=O+Math.imul(lr,Hr)|0,Ce=Ce+Math.imul(rr,Vr)|0,L=L+Math.imul(rr,zr)|0,L=L+Math.imul(cr,Vr)|0,O=O+Math.imul(cr,zr)|0,Ce=Ce+Math.imul(wr,xn)|0,L=L+Math.imul(wr,nn)|0,L=L+Math.imul(kr,xn)|0,O=O+Math.imul(kr,nn)|0,Ce=Ce+Math.imul(Er,vn)|0,L=L+Math.imul(Er,gn)|0,L=L+Math.imul(xr,vn)|0,O=O+Math.imul(xr,gn)|0,Ce=Ce+Math.imul(gr,fr)|0,L=L+Math.imul(gr,ht)|0,L=L+Math.imul(mr,fr)|0,O=O+Math.imul(mr,ht)|0,Ce=Ce+Math.imul(sr,vr)|0,L=L+Math.imul(sr,jr)|0,L=L+Math.imul(nr,vr)|0,O=O+Math.imul(nr,jr)|0,Ce=Ce+Math.imul(ir,Or)|0,L=L+Math.imul(ir,Xr)|0,L=L+Math.imul(pt,Or)|0,O=O+Math.imul(pt,Xr)|0,Ce=Ce+Math.imul(er,tn)|0,L=L+Math.imul(er,Jr)|0,L=L+Math.imul(ar,tn)|0,O=O+Math.imul(ar,Jr)|0,Ce=Ce+Math.imul(lt,dn)|0,L=L+Math.imul(lt,_n)|0,L=L+Math.imul(Xe,dn)|0,O=O+Math.imul(Xe,_n)|0;var Rs=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Rs>>>26)|0,Rs&=67108863,Ce=Math.imul(yt,Nr),L=Math.imul(yt,Hr),L=L+Math.imul(Je,Nr)|0,O=Math.imul(Je,Hr),Ce=Ce+Math.imul(br,Vr)|0,L=L+Math.imul(br,zr)|0,L=L+Math.imul(lr,Vr)|0,O=O+Math.imul(lr,zr)|0,Ce=Ce+Math.imul(rr,xn)|0,L=L+Math.imul(rr,nn)|0,L=L+Math.imul(cr,xn)|0,O=O+Math.imul(cr,nn)|0,Ce=Ce+Math.imul(wr,vn)|0,L=L+Math.imul(wr,gn)|0,L=L+Math.imul(kr,vn)|0,O=O+Math.imul(kr,gn)|0,Ce=Ce+Math.imul(Er,fr)|0,L=L+Math.imul(Er,ht)|0,L=L+Math.imul(xr,fr)|0,O=O+Math.imul(xr,ht)|0,Ce=Ce+Math.imul(gr,vr)|0,L=L+Math.imul(gr,jr)|0,L=L+Math.imul(mr,vr)|0,O=O+Math.imul(mr,jr)|0,Ce=Ce+Math.imul(sr,Or)|0,L=L+Math.imul(sr,Xr)|0,L=L+Math.imul(nr,Or)|0,O=O+Math.imul(nr,Xr)|0,Ce=Ce+Math.imul(ir,tn)|0,L=L+Math.imul(ir,Jr)|0,L=L+Math.imul(pt,tn)|0,O=O+Math.imul(pt,Jr)|0,Ce=Ce+Math.imul(er,dn)|0,L=L+Math.imul(er,_n)|0,L=L+Math.imul(ar,dn)|0,O=O+Math.imul(ar,_n)|0;var jn=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(jn>>>26)|0,jn&=67108863,Ce=Math.imul(yt,Vr),L=Math.imul(yt,zr),L=L+Math.imul(Je,Vr)|0,O=Math.imul(Je,zr),Ce=Ce+Math.imul(br,xn)|0,L=L+Math.imul(br,nn)|0,L=L+Math.imul(lr,xn)|0,O=O+Math.imul(lr,nn)|0,Ce=Ce+Math.imul(rr,vn)|0,L=L+Math.imul(rr,gn)|0,L=L+Math.imul(cr,vn)|0,O=O+Math.imul(cr,gn)|0,Ce=Ce+Math.imul(wr,fr)|0,L=L+Math.imul(wr,ht)|0,L=L+Math.imul(kr,fr)|0,O=O+Math.imul(kr,ht)|0,Ce=Ce+Math.imul(Er,vr)|0,L=L+Math.imul(Er,jr)|0,L=L+Math.imul(xr,vr)|0,O=O+Math.imul(xr,jr)|0,Ce=Ce+Math.imul(gr,Or)|0,L=L+Math.imul(gr,Xr)|0,L=L+Math.imul(mr,Or)|0,O=O+Math.imul(mr,Xr)|0,Ce=Ce+Math.imul(sr,tn)|0,L=L+Math.imul(sr,Jr)|0,L=L+Math.imul(nr,tn)|0,O=O+Math.imul(nr,Jr)|0,Ce=Ce+Math.imul(ir,dn)|0,L=L+Math.imul(ir,_n)|0,L=L+Math.imul(pt,dn)|0,O=O+Math.imul(pt,_n)|0;var Ki=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Ki>>>26)|0,Ki&=67108863,Ce=Math.imul(yt,xn),L=Math.imul(yt,nn),L=L+Math.imul(Je,xn)|0,O=Math.imul(Je,nn),Ce=Ce+Math.imul(br,vn)|0,L=L+Math.imul(br,gn)|0,L=L+Math.imul(lr,vn)|0,O=O+Math.imul(lr,gn)|0,Ce=Ce+Math.imul(rr,fr)|0,L=L+Math.imul(rr,ht)|0,L=L+Math.imul(cr,fr)|0,O=O+Math.imul(cr,ht)|0,Ce=Ce+Math.imul(wr,vr)|0,L=L+Math.imul(wr,jr)|0,L=L+Math.imul(kr,vr)|0,O=O+Math.imul(kr,jr)|0,Ce=Ce+Math.imul(Er,Or)|0,L=L+Math.imul(Er,Xr)|0,L=L+Math.imul(xr,Or)|0,O=O+Math.imul(xr,Xr)|0,Ce=Ce+Math.imul(gr,tn)|0,L=L+Math.imul(gr,Jr)|0,L=L+Math.imul(mr,tn)|0,O=O+Math.imul(mr,Jr)|0,Ce=Ce+Math.imul(sr,dn)|0,L=L+Math.imul(sr,_n)|0,L=L+Math.imul(nr,dn)|0,O=O+Math.imul(nr,_n)|0;var zi=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(zi>>>26)|0,zi&=67108863,Ce=Math.imul(yt,vn),L=Math.imul(yt,gn),L=L+Math.imul(Je,vn)|0,O=Math.imul(Je,gn),Ce=Ce+Math.imul(br,fr)|0,L=L+Math.imul(br,ht)|0,L=L+Math.imul(lr,fr)|0,O=O+Math.imul(lr,ht)|0,Ce=Ce+Math.imul(rr,vr)|0,L=L+Math.imul(rr,jr)|0,L=L+Math.imul(cr,vr)|0,O=O+Math.imul(cr,jr)|0,Ce=Ce+Math.imul(wr,Or)|0,L=L+Math.imul(wr,Xr)|0,L=L+Math.imul(kr,Or)|0,O=O+Math.imul(kr,Xr)|0,Ce=Ce+Math.imul(Er,tn)|0,L=L+Math.imul(Er,Jr)|0,L=L+Math.imul(xr,tn)|0,O=O+Math.imul(xr,Jr)|0,Ce=Ce+Math.imul(gr,dn)|0,L=L+Math.imul(gr,_n)|0,L=L+Math.imul(mr,dn)|0,O=O+Math.imul(mr,_n)|0;var vs=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(vs>>>26)|0,vs&=67108863,Ce=Math.imul(yt,fr),L=Math.imul(yt,ht),L=L+Math.imul(Je,fr)|0,O=Math.imul(Je,ht),Ce=Ce+Math.imul(br,vr)|0,L=L+Math.imul(br,jr)|0,L=L+Math.imul(lr,vr)|0,O=O+Math.imul(lr,jr)|0,Ce=Ce+Math.imul(rr,Or)|0,L=L+Math.imul(rr,Xr)|0,L=L+Math.imul(cr,Or)|0,O=O+Math.imul(cr,Xr)|0,Ce=Ce+Math.imul(wr,tn)|0,L=L+Math.imul(wr,Jr)|0,L=L+Math.imul(kr,tn)|0,O=O+Math.imul(kr,Jr)|0,Ce=Ce+Math.imul(Er,dn)|0,L=L+Math.imul(Er,_n)|0,L=L+Math.imul(xr,dn)|0,O=O+Math.imul(xr,_n)|0;var ks=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(ks>>>26)|0,ks&=67108863,Ce=Math.imul(yt,vr),L=Math.imul(yt,jr),L=L+Math.imul(Je,vr)|0,O=Math.imul(Je,jr),Ce=Ce+Math.imul(br,Or)|0,L=L+Math.imul(br,Xr)|0,L=L+Math.imul(lr,Or)|0,O=O+Math.imul(lr,Xr)|0,Ce=Ce+Math.imul(rr,tn)|0,L=L+Math.imul(rr,Jr)|0,L=L+Math.imul(cr,tn)|0,O=O+Math.imul(cr,Jr)|0,Ce=Ce+Math.imul(wr,dn)|0,L=L+Math.imul(wr,_n)|0,L=L+Math.imul(kr,dn)|0,O=O+Math.imul(kr,_n)|0;var No=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(No>>>26)|0,No&=67108863,Ce=Math.imul(yt,Or),L=Math.imul(yt,Xr),L=L+Math.imul(Je,Or)|0,O=Math.imul(Je,Xr),Ce=Ce+Math.imul(br,tn)|0,L=L+Math.imul(br,Jr)|0,L=L+Math.imul(lr,tn)|0,O=O+Math.imul(lr,Jr)|0,Ce=Ce+Math.imul(rr,dn)|0,L=L+Math.imul(rr,_n)|0,L=L+Math.imul(cr,dn)|0,O=O+Math.imul(cr,_n)|0;var Vi=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,Ce=Math.imul(yt,tn),L=Math.imul(yt,Jr),L=L+Math.imul(Je,tn)|0,O=Math.imul(Je,Jr),Ce=Ce+Math.imul(br,dn)|0,L=L+Math.imul(br,_n)|0,L=L+Math.imul(lr,dn)|0,O=O+Math.imul(lr,_n)|0;var Gi=(Le+Ce|0)+((L&8191)<<13)|0;Le=(O+(L>>>13)|0)+(Gi>>>26)|0,Gi&=67108863,Ce=Math.imul(yt,dn),L=Math.imul(yt,_n),L=L+Math.imul(Je,dn)|0,O=Math.imul(Je,_n);var jo=(Le+Ce|0)+((L&8191)<<13)|0;return Le=(O+(L>>>13)|0)+(jo>>>26)|0,jo&=67108863,Fe[0]=Bi,Fe[1]=ko,Fe[2]=Do,Fe[3]=qi,Fe[4]=Ts,Fe[5]=Ci,Fe[6]=Ss,Fe[7]=_s,Fe[8]=$s,Fe[9]=Rs,Fe[10]=jn,Fe[11]=Ki,Fe[12]=zi,Fe[13]=vs,Fe[14]=ks,Fe[15]=No,Fe[16]=Vi,Fe[17]=Gi,Fe[18]=jo,Le!==0&&(Fe[19]=Le,_e.length++),_e};Math.imul||(I=R);function k(ze,v,D){D.negative=v.negative^ze.negative,D.length=ze.length+v.length;for(var _e=0,P=0,Re=0;Re<D.length-1;Re++){var Fe=P;P=0;for(var Le=_e&67108863,Ce=Math.min(Re,v.length-1),L=Math.max(0,Re-ze.length+1);L<=Ce;L++){var O=Re-L,st=ze.words[O]|0,lt=v.words[L]|0,Xe=st*lt,dt=Xe&67108863;Fe=Fe+(Xe/67108864|0)|0,dt=dt+Le|0,Le=dt&67108863,Fe=Fe+(dt>>>26)|0,P+=Fe>>>26,Fe&=67108863}D.words[Re]=Le,_e=Fe,Fe=P}return _e!==0?D.words[Re]=_e:D.length--,D.strip()}function je(ze,v,D){var _e=new Ve;return _e.mulp(ze,v,D)}a.prototype.mulTo=function(v,D){var _e,P=this.length+v.length;return this.length===10&&v.length===10?_e=I(this,v,D):P<63?_e=R(this,v,D):P<1024?_e=k(this,v,D):_e=je(this,v,D),_e};function Ve(ze,v){this.x=ze,this.y=v}Ve.prototype.makeRBT=function(v){for(var D=new Array(v),_e=a.prototype._countBits(v)-1,P=0;P<v;P++)D[P]=this.revBin(P,_e,v);return D},Ve.prototype.revBin=function(v,D,_e){if(v===0||v===_e-1)return v;for(var P=0,Re=0;Re<D;Re++)P|=(v&1)<<D-Re-1,v>>=1;return P},Ve.prototype.permute=function(v,D,_e,P,Re,Fe){for(var Le=0;Le<Fe;Le++)P[Le]=D[v[Le]],Re[Le]=_e[v[Le]]},Ve.prototype.transform=function(v,D,_e,P,Re,Fe){this.permute(Fe,v,D,_e,P,Re);for(var Le=1;Le<Re;Le<<=1)for(var Ce=Le<<1,L=Math.cos(2*Math.PI/Ce),O=Math.sin(2*Math.PI/Ce),st=0;st<Re;st+=Ce)for(var lt=L,Xe=O,dt=0;dt<Le;dt++){var er=_e[st+dt],ar=P[st+dt],dr=_e[st+dt+Le],ir=P[st+dt+Le],pt=lt*dr-Xe*ir;ir=lt*ir+Xe*dr,dr=pt,_e[st+dt]=er+dr,P[st+dt]=ar+ir,_e[st+dt+Le]=er-dr,P[st+dt+Le]=ar-ir,dt!==Ce&&(pt=L*lt-O*Xe,Xe=L*Xe+O*lt,lt=pt)}},Ve.prototype.guessLen13b=function(v,D){var _e=Math.max(D,v)|1,P=_e&1,Re=0;for(_e=_e/2|0;_e;_e=_e>>>1)Re++;return 1<<Re+1+P},Ve.prototype.conjugate=function(v,D,_e){if(!(_e<=1))for(var P=0;P<_e/2;P++){var Re=v[P];v[P]=v[_e-P-1],v[_e-P-1]=Re,Re=D[P],D[P]=-D[_e-P-1],D[_e-P-1]=-Re}},Ve.prototype.normalize13b=function(v,D){for(var _e=0,P=0;P<D/2;P++){var Re=Math.round(v[2*P+1]/D)*8192+Math.round(v[2*P]/D)+_e;v[P]=Re&67108863,Re<67108864?_e=0:_e=Re/67108864|0}return v},Ve.prototype.convert13b=function(v,D,_e,P){for(var Re=0,Fe=0;Fe<D;Fe++)Re=Re+(v[Fe]|0),_e[2*Fe]=Re&8191,Re=Re>>>13,_e[2*Fe+1]=Re&8191,Re=Re>>>13;for(Fe=2*D;Fe<P;++Fe)_e[Fe]=0;n(Re===0),n((Re&-8192)===0)},Ve.prototype.stub=function(v){for(var D=new Array(v),_e=0;_e<v;_e++)D[_e]=0;return D},Ve.prototype.mulp=function(v,D,_e){var P=2*this.guessLen13b(v.length,D.length),Re=this.makeRBT(P),Fe=this.stub(P),Le=new Array(P),Ce=new Array(P),L=new Array(P),O=new Array(P),st=new Array(P),lt=new Array(P),Xe=_e.words;Xe.length=P,this.convert13b(v.words,v.length,Le,P),this.convert13b(D.words,D.length,O,P),this.transform(Le,Fe,Ce,L,P,Re),this.transform(O,Fe,st,lt,P,Re);for(var dt=0;dt<P;dt++){var er=Ce[dt]*st[dt]-L[dt]*lt[dt];L[dt]=Ce[dt]*lt[dt]+L[dt]*st[dt],Ce[dt]=er}return this.conjugate(Ce,L,P),this.transform(Ce,L,Xe,Fe,P,Re),this.conjugate(Xe,Fe,P),this.normalize13b(Xe,P),_e.negative=v.negative^D.negative,_e.length=v.length+D.length,_e.strip()},a.prototype.mul=function(v){var D=new a(null);return D.words=new Array(this.length+v.length),this.mulTo(v,D)},a.prototype.mulf=function(v){var D=new a(null);return D.words=new Array(this.length+v.length),je(this,v,D)},a.prototype.imul=function(v){return this.clone().mulTo(v,this)},a.prototype.imuln=function(v){n(typeof v=="number"),n(v<67108864);for(var D=0,_e=0;_e<this.length;_e++){var P=(this.words[_e]|0)*v,Re=(P&67108863)+(D&67108863);D>>=26,D+=P/67108864|0,D+=Re>>>26,this.words[_e]=Re&67108863}return D!==0&&(this.words[_e]=D,this.length++),this.length=v===0?1:this.length,this},a.prototype.muln=function(v){return this.clone().imuln(v)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(v){var D=w(v);if(D.length===0)return new a(1);for(var _e=this,P=0;P<D.length&&D[P]===0;P++,_e=_e.sqr());if(++P<D.length)for(var Re=_e.sqr();P<D.length;P++,Re=Re.sqr())D[P]!==0&&(_e=_e.mul(Re));return _e},a.prototype.iushln=function(v){n(typeof v=="number"&&v>=0);var D=v%26,_e=(v-D)/26,P=67108863>>>26-D<<26-D,Re;if(D!==0){var Fe=0;for(Re=0;Re<this.length;Re++){var Le=this.words[Re]&P,Ce=(this.words[Re]|0)-Le<<D;this.words[Re]=Ce|Fe,Fe=Le>>>26-D}Fe&&(this.words[Re]=Fe,this.length++)}if(_e!==0){for(Re=this.length-1;Re>=0;Re--)this.words[Re+_e]=this.words[Re];for(Re=0;Re<_e;Re++)this.words[Re]=0;this.length+=_e}return this.strip()},a.prototype.ishln=function(v){return n(this.negative===0),this.iushln(v)},a.prototype.iushrn=function(v,D,_e){n(typeof v=="number"&&v>=0);var P;D?P=(D-D%26)/26:P=0;var Re=v%26,Fe=Math.min((v-Re)/26,this.length),Le=67108863^67108863>>>Re<<Re,Ce=_e;if(P-=Fe,P=Math.max(0,P),Ce){for(var L=0;L<Fe;L++)Ce.words[L]=this.words[L];Ce.length=Fe}if(Fe!==0)if(this.length>Fe)for(this.length-=Fe,L=0;L<this.length;L++)this.words[L]=this.words[L+Fe];else this.words[0]=0,this.length=1;var O=0;for(L=this.length-1;L>=0&&(O!==0||L>=P);L--){var st=this.words[L]|0;this.words[L]=O<<26-Re|st>>>Re,O=st&Le}return Ce&&O!==0&&(Ce.words[Ce.length++]=O),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(v,D,_e){return n(this.negative===0),this.iushrn(v,D,_e)},a.prototype.shln=function(v){return this.clone().ishln(v)},a.prototype.ushln=function(v){return this.clone().iushln(v)},a.prototype.shrn=function(v){return this.clone().ishrn(v)},a.prototype.ushrn=function(v){return this.clone().iushrn(v)},a.prototype.testn=function(v){n(typeof v=="number"&&v>=0);var D=v%26,_e=(v-D)/26,P=1<<D;if(this.length<=_e)return!1;var Re=this.words[_e];return!!(Re&P)},a.prototype.imaskn=function(v){n(typeof v=="number"&&v>=0);var D=v%26,_e=(v-D)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=_e)return this;if(D!==0&&_e++,this.length=Math.min(_e,this.length),D!==0){var P=67108863^67108863>>>D<<D;this.words[this.length-1]&=P}return this.strip()},a.prototype.maskn=function(v){return this.clone().imaskn(v)},a.prototype.iaddn=function(v){return n(typeof v=="number"),n(v<67108864),v<0?this.isubn(-v):this.negative!==0?this.length===1&&(this.words[0]|0)<v?(this.words[0]=v-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(v),this.negative=1,this):this._iaddn(v)},a.prototype._iaddn=function(v){this.words[0]+=v;for(var D=0;D<this.length&&this.words[D]>=67108864;D++)this.words[D]-=67108864,D===this.length-1?this.words[D+1]=1:this.words[D+1]++;return this.length=Math.max(this.length,D+1),this},a.prototype.isubn=function(v){if(n(typeof v=="number"),n(v<67108864),v<0)return this.iaddn(-v);if(this.negative!==0)return this.negative=0,this.iaddn(v),this.negative=1,this;if(this.words[0]-=v,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var D=0;D<this.length&&this.words[D]<0;D++)this.words[D]+=67108864,this.words[D+1]-=1;return this.strip()},a.prototype.addn=function(v){return this.clone().iaddn(v)},a.prototype.subn=function(v){return this.clone().isubn(v)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(v,D,_e){var P=v.length+_e,Re;this._expand(P);var Fe,Le=0;for(Re=0;Re<v.length;Re++){Fe=(this.words[Re+_e]|0)+Le;var Ce=(v.words[Re]|0)*D;Fe-=Ce&67108863,Le=(Fe>>26)-(Ce/67108864|0),this.words[Re+_e]=Fe&67108863}for(;Re<this.length-_e;Re++)Fe=(this.words[Re+_e]|0)+Le,Le=Fe>>26,this.words[Re+_e]=Fe&67108863;if(Le===0)return this.strip();for(n(Le===-1),Le=0,Re=0;Re<this.length;Re++)Fe=-(this.words[Re]|0)+Le,Le=Fe>>26,this.words[Re]=Fe&67108863;return this.negative=1,this.strip()},a.prototype._wordDiv=function(v,D){var _e=this.length-v.length,P=this.clone(),Re=v,Fe=Re.words[Re.length-1]|0,Le=this._countBits(Fe);_e=26-Le,_e!==0&&(Re=Re.ushln(_e),P.iushln(_e),Fe=Re.words[Re.length-1]|0);var Ce=P.length-Re.length,L;if(D!=="mod"){L=new a(null),L.length=Ce+1,L.words=new Array(L.length);for(var O=0;O<L.length;O++)L.words[O]=0}var st=P.clone()._ishlnsubmul(Re,1,Ce);st.negative===0&&(P=st,L&&(L.words[Ce]=1));for(var lt=Ce-1;lt>=0;lt--){var Xe=(P.words[Re.length+lt]|0)*67108864+(P.words[Re.length+lt-1]|0);for(Xe=Math.min(Xe/Fe|0,67108863),P._ishlnsubmul(Re,Xe,lt);P.negative!==0;)Xe--,P.negative=0,P._ishlnsubmul(Re,1,lt),P.isZero()||(P.negative^=1);L&&(L.words[lt]=Xe)}return L&&L.strip(),P.strip(),D!=="div"&&_e!==0&&P.iushrn(_e),{div:L||null,mod:P}},a.prototype.divmod=function(v,D,_e){if(n(!v.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var P,Re,Fe;return this.negative!==0&&v.negative===0?(Fe=this.neg().divmod(v,D),D!=="mod"&&(P=Fe.div.neg()),D!=="div"&&(Re=Fe.mod.neg(),_e&&Re.negative!==0&&Re.iadd(v)),{div:P,mod:Re}):this.negative===0&&v.negative!==0?(Fe=this.divmod(v.neg(),D),D!=="mod"&&(P=Fe.div.neg()),{div:P,mod:Fe.mod}):(this.negative&v.negative)!==0?(Fe=this.neg().divmod(v.neg(),D),D!=="div"&&(Re=Fe.mod.neg(),_e&&Re.negative!==0&&Re.isub(v)),{div:Fe.div,mod:Re}):v.length>this.length||this.cmp(v)<0?{div:new a(0),mod:this}:v.length===1?D==="div"?{div:this.divn(v.words[0]),mod:null}:D==="mod"?{div:null,mod:new a(this.modn(v.words[0]))}:{div:this.divn(v.words[0]),mod:new a(this.modn(v.words[0]))}:this._wordDiv(v,D)},a.prototype.div=function(v){return this.divmod(v,"div",!1).div},a.prototype.mod=function(v){return this.divmod(v,"mod",!1).mod},a.prototype.umod=function(v){return this.divmod(v,"mod",!0).mod},a.prototype.divRound=function(v){var D=this.divmod(v);if(D.mod.isZero())return D.div;var _e=D.div.negative!==0?D.mod.isub(v):D.mod,P=v.ushrn(1),Re=v.andln(1),Fe=_e.cmp(P);return Fe<0||Re===1&&Fe===0?D.div:D.div.negative!==0?D.div.isubn(1):D.div.iaddn(1)},a.prototype.modn=function(v){n(v<=67108863);for(var D=(1<<26)%v,_e=0,P=this.length-1;P>=0;P--)_e=(D*_e+(this.words[P]|0))%v;return _e},a.prototype.idivn=function(v){n(v<=67108863);for(var D=0,_e=this.length-1;_e>=0;_e--){var P=(this.words[_e]|0)+D*67108864;this.words[_e]=P/v|0,D=P%v}return this.strip()},a.prototype.divn=function(v){return this.clone().idivn(v)},a.prototype.egcd=function(v){n(v.negative===0),n(!v.isZero());var D=this,_e=v.clone();D.negative!==0?D=D.umod(v):D=D.clone();for(var P=new a(1),Re=new a(0),Fe=new a(0),Le=new a(1),Ce=0;D.isEven()&&_e.isEven();)D.iushrn(1),_e.iushrn(1),++Ce;for(var L=_e.clone(),O=D.clone();!D.isZero();){for(var st=0,lt=1;(D.words[0]&lt)===0&&st<26;++st,lt<<=1);if(st>0)for(D.iushrn(st);st-- >0;)(P.isOdd()||Re.isOdd())&&(P.iadd(L),Re.isub(O)),P.iushrn(1),Re.iushrn(1);for(var Xe=0,dt=1;(_e.words[0]&dt)===0&&Xe<26;++Xe,dt<<=1);if(Xe>0)for(_e.iushrn(Xe);Xe-- >0;)(Fe.isOdd()||Le.isOdd())&&(Fe.iadd(L),Le.isub(O)),Fe.iushrn(1),Le.iushrn(1);D.cmp(_e)>=0?(D.isub(_e),P.isub(Fe),Re.isub(Le)):(_e.isub(D),Fe.isub(P),Le.isub(Re))}return{a:Fe,b:Le,gcd:_e.iushln(Ce)}},a.prototype._invmp=function(v){n(v.negative===0),n(!v.isZero());var D=this,_e=v.clone();D.negative!==0?D=D.umod(v):D=D.clone();for(var P=new a(1),Re=new a(0),Fe=_e.clone();D.cmpn(1)>0&&_e.cmpn(1)>0;){for(var Le=0,Ce=1;(D.words[0]&Ce)===0&&Le<26;++Le,Ce<<=1);if(Le>0)for(D.iushrn(Le);Le-- >0;)P.isOdd()&&P.iadd(Fe),P.iushrn(1);for(var L=0,O=1;(_e.words[0]&O)===0&&L<26;++L,O<<=1);if(L>0)for(_e.iushrn(L);L-- >0;)Re.isOdd()&&Re.iadd(Fe),Re.iushrn(1);D.cmp(_e)>=0?(D.isub(_e),P.isub(Re)):(_e.isub(D),Re.isub(P))}var st;return D.cmpn(1)===0?st=P:st=Re,st.cmpn(0)<0&&st.iadd(v),st},a.prototype.gcd=function(v){if(this.isZero())return v.abs();if(v.isZero())return this.abs();var D=this.clone(),_e=v.clone();D.negative=0,_e.negative=0;for(var P=0;D.isEven()&&_e.isEven();P++)D.iushrn(1),_e.iushrn(1);do{for(;D.isEven();)D.iushrn(1);for(;_e.isEven();)_e.iushrn(1);var Re=D.cmp(_e);if(Re<0){var Fe=D;D=_e,_e=Fe}else if(Re===0||_e.cmpn(1)===0)break;D.isub(_e)}while(!0);return _e.iushln(P)},a.prototype.invm=function(v){return this.egcd(v).a.umod(v)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(v){return this.words[0]&v},a.prototype.bincn=function(v){n(typeof v=="number");var D=v%26,_e=(v-D)/26,P=1<<D;if(this.length<=_e)return this._expand(_e+1),this.words[_e]|=P,this;for(var Re=P,Fe=_e;Re!==0&&Fe<this.length;Fe++){var Le=this.words[Fe]|0;Le+=Re,Re=Le>>>26,Le&=67108863,this.words[Fe]=Le}return Re!==0&&(this.words[Fe]=Re,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(v){var D=v<0;if(this.negative!==0&&!D)return-1;if(this.negative===0&&D)return 1;this.strip();var _e;if(this.length>1)_e=1;else{D&&(v=-v),n(v<=67108863,"Number is too big");var P=this.words[0]|0;_e=P===v?0:P<v?-1:1}return this.negative!==0?-_e|0:_e},a.prototype.cmp=function(v){if(this.negative!==0&&v.negative===0)return-1;if(this.negative===0&&v.negative!==0)return 1;var D=this.ucmp(v);return this.negative!==0?-D|0:D},a.prototype.ucmp=function(v){if(this.length>v.length)return 1;if(this.length<v.length)return-1;for(var D=0,_e=this.length-1;_e>=0;_e--){var P=this.words[_e]|0,Re=v.words[_e]|0;if(P!==Re){P<Re?D=-1:P>Re&&(D=1);break}}return D},a.prototype.gtn=function(v){return this.cmpn(v)===1},a.prototype.gt=function(v){return this.cmp(v)===1},a.prototype.gten=function(v){return this.cmpn(v)>=0},a.prototype.gte=function(v){return this.cmp(v)>=0},a.prototype.ltn=function(v){return this.cmpn(v)===-1},a.prototype.lt=function(v){return this.cmp(v)===-1},a.prototype.lten=function(v){return this.cmpn(v)<=0},a.prototype.lte=function(v){return this.cmp(v)<=0},a.prototype.eqn=function(v){return this.cmpn(v)===0},a.prototype.eq=function(v){return this.cmp(v)===0},a.red=function(v){return new Qe(v)},a.prototype.toRed=function(v){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),v.convertTo(this)._forceRed(v)},a.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(v){return this.red=v,this},a.prototype.forceRed=function(v){return n(!this.red,"Already a number in reduction context"),this._forceRed(v)},a.prototype.redAdd=function(v){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,v)},a.prototype.redIAdd=function(v){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,v)},a.prototype.redSub=function(v){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,v)},a.prototype.redISub=function(v){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,v)},a.prototype.redShl=function(v){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,v)},a.prototype.redMul=function(v){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,v),this.red.mul(this,v)},a.prototype.redIMul=function(v){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,v),this.red.imul(this,v)},a.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(v){return n(this.red&&!v.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,v)};var q={k256:null,p224:null,p192:null,p25519:null};function $e(ze,v){this.name=ze,this.p=new a(v,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}$e.prototype._tmp=function(){var v=new a(null);return v.words=new Array(Math.ceil(this.n/13)),v},$e.prototype.ireduce=function(v){var D=v,_e;do this.split(D,this.tmp),D=this.imulK(D),D=D.iadd(this.tmp),_e=D.bitLength();while(_e>this.n);var P=_e<this.n?-1:D.ucmp(this.p);return P===0?(D.words[0]=0,D.length=1):P>0?D.isub(this.p):D.strip!==void 0?D.strip():D._strip(),D},$e.prototype.split=function(v,D){v.iushrn(this.n,0,D)},$e.prototype.imulK=function(v){return v.imul(this.k)};function We(){$e.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(We,$e),We.prototype.split=function(v,D){for(var _e=4194303,P=Math.min(v.length,9),Re=0;Re<P;Re++)D.words[Re]=v.words[Re];if(D.length=P,v.length<=9){v.words[0]=0,v.length=1;return}var Fe=v.words[9];for(D.words[D.length++]=Fe&_e,Re=10;Re<v.length;Re++){var Le=v.words[Re]|0;v.words[Re-10]=(Le&_e)<<4|Fe>>>22,Fe=Le}Fe>>>=22,v.words[Re-10]=Fe,Fe===0&&v.length>10?v.length-=10:v.length-=9},We.prototype.imulK=function(v){v.words[v.length]=0,v.words[v.length+1]=0,v.length+=2;for(var D=0,_e=0;_e<v.length;_e++){var P=v.words[_e]|0;D+=P*977,v.words[_e]=D&67108863,D=P*64+(D/67108864|0)}return v.words[v.length-1]===0&&(v.length--,v.words[v.length-1]===0&&v.length--),v};function K(){$e.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(K,$e);function W(){$e.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(W,$e);function Ye(){$e.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(Ye,$e),Ye.prototype.imulK=function(v){for(var D=0,_e=0;_e<v.length;_e++){var P=(v.words[_e]|0)*19+D,Re=P&67108863;P>>>=26,v.words[_e]=Re,D=P}return D!==0&&(v.words[v.length++]=D),v},a._prime=function(v){if(q[v])return q[v];var D;if(v==="k256")D=new We;else if(v==="p224")D=new K;else if(v==="p192")D=new W;else if(v==="p25519")D=new Ye;else throw new Error("Unknown prime "+v);return q[v]=D,D};function Qe(ze){if(typeof ze=="string"){var v=a._prime(ze);this.m=v.p,this.prime=v}else n(ze.gtn(1),"modulus must be greater than 1"),this.m=ze,this.prime=null}Qe.prototype._verify1=function(v){n(v.negative===0,"red works only with positives"),n(v.red,"red works only with red numbers")},Qe.prototype._verify2=function(v,D){n((v.negative|D.negative)===0,"red works only with positives"),n(v.red&&v.red===D.red,"red works only with red numbers")},Qe.prototype.imod=function(v){return this.prime?this.prime.ireduce(v)._forceRed(this):v.umod(this.m)._forceRed(this)},Qe.prototype.neg=function(v){return v.isZero()?v.clone():this.m.sub(v)._forceRed(this)},Qe.prototype.add=function(v,D){this._verify2(v,D);var _e=v.add(D);return _e.cmp(this.m)>=0&&_e.isub(this.m),_e._forceRed(this)},Qe.prototype.iadd=function(v,D){this._verify2(v,D);var _e=v.iadd(D);return _e.cmp(this.m)>=0&&_e.isub(this.m),_e},Qe.prototype.sub=function(v,D){this._verify2(v,D);var _e=v.sub(D);return _e.cmpn(0)<0&&_e.iadd(this.m),_e._forceRed(this)},Qe.prototype.isub=function(v,D){this._verify2(v,D);var _e=v.isub(D);return _e.cmpn(0)<0&&_e.iadd(this.m),_e},Qe.prototype.shl=function(v,D){return this._verify1(v),this.imod(v.ushln(D))},Qe.prototype.imul=function(v,D){return this._verify2(v,D),this.imod(v.imul(D))},Qe.prototype.mul=function(v,D){return this._verify2(v,D),this.imod(v.mul(D))},Qe.prototype.isqr=function(v){return this.imul(v,v.clone())},Qe.prototype.sqr=function(v){return this.mul(v,v)},Qe.prototype.sqrt=function(v){if(v.isZero())return v.clone();var D=this.m.andln(3);if(n(D%2===1),D===3){var _e=this.m.add(new a(1)).iushrn(2);return this.pow(v,_e)}for(var P=this.m.subn(1),Re=0;!P.isZero()&&P.andln(1)===0;)Re++,P.iushrn(1);n(!P.isZero());var Fe=new a(1).toRed(this),Le=Fe.redNeg(),Ce=this.m.subn(1).iushrn(1),L=this.m.bitLength();for(L=new a(2*L*L).toRed(this);this.pow(L,Ce).cmp(Le)!==0;)L.redIAdd(Le);for(var O=this.pow(L,P),st=this.pow(v,P.addn(1).iushrn(1)),lt=this.pow(v,P),Xe=Re;lt.cmp(Fe)!==0;){for(var dt=lt,er=0;dt.cmp(Fe)!==0;er++)dt=dt.redSqr();n(er<Xe);var ar=this.pow(O,new a(1).iushln(Xe-er-1));st=st.redMul(ar),O=ar.redSqr(),lt=lt.redMul(O),Xe=er}return st},Qe.prototype.invm=function(v){var D=v._invmp(this.m);return D.negative!==0?(D.negative=0,this.imod(D).redNeg()):this.imod(D)},Qe.prototype.pow=function(v,D){if(D.isZero())return new a(1).toRed(this);if(D.cmpn(1)===0)return v.clone();var _e=4,P=new Array(1<<_e);P[0]=new a(1).toRed(this),P[1]=v;for(var Re=2;Re<P.length;Re++)P[Re]=this.mul(P[Re-1],v);var Fe=P[0],Le=0,Ce=0,L=D.bitLength()%26;for(L===0&&(L=26),Re=D.length-1;Re>=0;Re--){for(var O=D.words[Re],st=L-1;st>=0;st--){var lt=O>>st&1;if(Fe!==P[0]&&(Fe=this.sqr(Fe)),lt===0&&Le===0){Ce=0;continue}Le<<=1,Le|=lt,Ce++,!(Ce!==_e&&(Re!==0||st!==0))&&(Fe=this.mul(Fe,P[Le]),Ce=0,Le=0)}L=26}return Fe},Qe.prototype.convertTo=function(v){var D=v.umod(this.m);return D===v?D.clone():D},Qe.prototype.convertFrom=function(v){var D=v.clone();return D.red=null,D},a.mont=function(v){return new it(v)};function it(ze){Qe.call(this,ze),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(it,Qe),it.prototype.convertTo=function(v){return this.imod(v.ushln(this.shift))},it.prototype.convertFrom=function(v){var D=this.imod(v.mul(this.rinv));return D.red=null,D},it.prototype.imul=function(v,D){if(v.isZero()||D.isZero())return v.words[0]=0,v.length=1,v;var _e=v.imul(D),P=_e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Re=_e.isub(P).iushrn(this.shift),Fe=Re;return Re.cmp(this.m)>=0?Fe=Re.isub(this.m):Re.cmpn(0)<0&&(Fe=Re.iadd(this.m)),Fe._forceRed(this)},it.prototype.mul=function(v,D){if(v.isZero()||D.isZero())return new a(0)._forceRed(this);var _e=v.mul(D),P=_e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Re=_e.isub(P).iushrn(this.shift),Fe=Re;return Re.cmp(this.m)>=0?Fe=Re.isub(this.m):Re.cmpn(0)<0&&(Fe=Re.iadd(this.m)),Fe._forceRed(this)},it.prototype.invm=function(v){var D=this.imod(v._invmp(this.m).mul(this.r2));return D._forceRed(this)}})(e,bn)})(bn$1)),bn$1.exports}var bnExports=requireBn(),DEFAULTNETWORK={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},TESTNETWORK={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},SIGNETNETWORK={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},REGTESTNETWORK={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},SIMNETWORK={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},FEATUREBIT_ORDER=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],DIVISORS={m:new bnExports.BN(1e3,10),u:new bnExports.BN(1e6,10),n:new bnExports.BN(1e9,10),p:new bnExports.BN(1e12,10)},MAX_MILLISATS=new bnExports.BN("2100000000000000000",10),MILLISATS_PER_BTC=new bnExports.BN(1e11,10),TAGCODES={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},TAGNAMES={};for(var i=0,keys=Object.keys(TAGCODES);i<keys.length;i++){var currentName=keys[i],currentCode=TAGCODES[keys[i]].toString();TAGNAMES[currentCode]=currentName}var TAGPARSERS={1:function(e){return wordsToBuffer(e)},16:function(e){return wordsToBuffer(e)},13:function(e){return wordsToBuffer(e).toString("utf8")},19:function(e){return wordsToBuffer(e)},23:function(e){return wordsToBuffer(e)},27:function(e){return wordsToBuffer(e)},6:wordsToIntBE,24:wordsToIntBE,3:routingInfoParser,5:featureBitsParser};function getUnknownParser(e){return function(t){return{tagCode:parseInt(e),words:bech32Exports.encode("unknown",t,Number.MAX_SAFE_INTEGER)}}}function wordsToIntBE(e){return e.reverse().reduce(function(t,r,n){return t+r*Math.pow(32,n)},0)}function convert(e,t,r){for(var n=0,s=0,a=(1<<r)-1,l=[],u=0;u<e.length;++u)for(n=n<<t|e[u],s+=t;s>=r;)s-=r,l.push(n>>s&a);return s>0&&l.push(n<<r-s&a),l}function wordsToBuffer(e,t){var r=Buffer$1.from(convert(e,5,8));return e.length*5%8!==0&&(r=r.slice(0,-1)),r}function routingInfoParser(e){for(var t=[],r,n,s,a,l,u=wordsToBuffer(e);u.length>0;)r=u.slice(0,33).toString("hex"),n=u.slice(33,41).toString("hex"),s=parseInt(u.slice(41,45).toString("hex"),16),a=parseInt(u.slice(45,49).toString("hex"),16),l=parseInt(u.slice(49,51).toString("hex"),16),u=u.slice(51),t.push({pubkey:r,short_channel_id:n,fee_base_msat:s,fee_proportional_millionths:a,cltv_expiry_delta:l});return t}function featureBitsParser(e){for(var t=e.slice().reverse().map(function(s){return[!!(s&1),!!(s&2),!!(s&4),!!(s&8),!!(s&16)]}).reduce(function(s,a){return s.concat(a)},[]);t.length<FEATUREBIT_ORDER.length*2;)t.push(!1);var r={extra_bits:{}};if(FEATUREBIT_ORDER.forEach(function(s,a){var l;t[a*2]?l="required":t[a*2+1]&&(l="supported"),r[s]=l}),t.length>FEATUREBIT_ORDER.length*2){var n=t.slice(FEATUREBIT_ORDER.length*2);r.extra_bits={start_bit:FEATUREBIT_ORDER.length*2,bits:n,required:n.reduce(function(s,a,l){return l%2!==0?s||!1:s||a},!1)}}return r}function hrpToMillisat(e,t){var r,n;if(e.slice(-1).match(/^[munp]$/))r=e.slice(-1),n=e.slice(0,-1);else{if(e.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");n=e}if(!n.match(/^\d+$/))throw new Error("Not a valid human readable amount");var s=new bnExports.BN(n,10),a=r?s.mul(MILLISATS_PER_BTC).div(DIVISORS[r]):s.mul(MILLISATS_PER_BTC);if(r==="p"&&!s.mod(new bnExports.BN(10,10)).eq(new bnExports.BN(0,10))||a.gt(MAX_MILLISATS))throw new Error("Amount is outside of valid range");return t?a.toString():a}function decode(e,t){if(typeof e!="string")throw new Error("Lightning Payment Request must be string");if(e.slice(0,2).toLowerCase()!=="ln")throw new Error("Not a proper lightning payment request");var r=[],n=bech32Exports.decode(e,Number.MAX_SAFE_INTEGER);e=e.toLowerCase();var s=n.prefix,a=n.words,l=e.slice(s.length+1),u=a.slice(-104);a=a.slice(0,-104);var x=s.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(x&&!x[2]&&(x=s.match(/^ln(\S+)$/)),!x)throw new Error("Not a proper lightning payment request");r.push({name:"lightning_network",letters:"ln"});var f=x[1],p;switch(f){case DEFAULTNETWORK.bech32:p=DEFAULTNETWORK;break;case TESTNETWORK.bech32:p=TESTNETWORK;break;case SIGNETNETWORK.bech32:p=SIGNETNETWORK;break;case REGTESTNETWORK.bech32:p=REGTESTNETWORK;break;case SIMNETWORK.bech32:p=SIMNETWORK;break}if(!p||p.bech32!==f)throw new Error("Unknown coin bech32 prefix");r.push({name:"coin_network",letters:f,value:p});var g=x[2],y;if(g){var w=x[3];y=hrpToMillisat(g+w,!0),r.push({name:"amount",letters:x[2]+x[3],value:y})}else y=null;r.push({name:"separator",letters:"1"});var R=wordsToIntBE(a.slice(0,7));a=a.slice(7),r.push({name:"timestamp",letters:l.slice(0,7),value:R}),l=l.slice(7);for(var I,k,je,Ve;a.length>0;){var q=a[0].toString();I=TAGNAMES[q]||"unknown_tag",k=TAGPARSERS[q]||getUnknownParser(q),a=a.slice(1),je=wordsToIntBE(a.slice(0,2)),a=a.slice(2),Ve=a.slice(0,je),a=a.slice(je),r.push({name:I,tag:l[0],letters:l.slice(0,3+je),value:k(Ve)}),l=l.slice(3+je)}r.push({name:"signature",letters:l.slice(0,104),value:wordsToBuffer(u)}),l=l.slice(104),r.push({name:"checksum",letters:l});var $e={paymentRequest:e,sections:r,get expiry(){var Ye=r.find(function(Qe){return Qe.name==="expiry"});if(Ye)return W("timestamp")+Ye.value},get route_hints(){return r.filter(function(Ye){return Ye.name==="route_hint"}).map(function(Ye){return Ye.value})}},We=function(Ye){if(Ye==="route_hint")return"continue";Object.defineProperty($e,Ye,{get:function(){return W(Ye)}})};for(var K in TAGCODES)We(K);return $e;function W(Ye){var Qe=r.find(function(it){return it.name===Ye});return Qe?Qe.value:void 0}}const EcashSendModal=({isOpen:e,onClose:t})=>{const[r,n]=reactExports.useState(""),[s,a]=reactExports.useState(""),[l,u]=reactExports.useState(!1),[x,f]=reactExports.useState(!1),[p,g]=reactExports.useState(null),[y,w]=reactExports.useState(null),[R,I]=reactExports.useState("sats"),[k,je]=reactExports.useState(!1),[Ve,q]=reactExports.useState(!1),$e=reactExports.useRef(null),We=reactExports.useRef(null),[K,W]=reactExports.useState(null),[Ye,Qe]=reactExports.useState({total:0,sent:0,failed:0}),[it,ze]=reactExports.useState(null),[v,D]=reactExports.useState("unknown"),[_e,P]=reactExports.useState([]),[Re,Fe]=reactExports.useState(!1),[Le,Ce]=reactExports.useState(!1),[L,O]=reactExports.useState(null),{currentKeypairId:st,wallets:lt,currentWalletId:Xe}=useWalletStore(),er=lt.find(wr=>wr.id===Xe)?.keypairs.find(wr=>wr.id===st),ar=wr=>{const kr=wr.trim();return kr.startsWith("npub")?"npub":kr.startsWith("lnbc")||kr.startsWith("lntb")?"lightning_invoice":LnurlService.isLightningAddress(kr)?"lightning_address":"unknown"};reactExports.useEffect(()=>{const wr=ar(s);if(D(wr),wr==="lightning_invoice")try{const kr=decode(s.trim());if(kr.sections){const Dr=kr.sections.find(rr=>rr.name==="amount");if(Dr&&Dr.value){const rr=Math.floor(parseInt(Dr.value)/1e3);n(rr.toString())}}}catch(kr){console.error("Failed to decode invoice:",kr)}},[s]),reactExports.useEffect(()=>{e&&er&&(console.log("[EcashSendModal] Fetching contacts for keypair:",er.npub),Fe(!0),O(null),ProfileService.fetchContacts(er.npub).then(wr=>{console.log("[EcashSendModal] Received contacts:",wr.length),P(wr)}).catch(wr=>{console.error("[EcashSendModal] Error fetching contacts:",wr),O("Failed to fetch user follows")}).finally(()=>Fe(!1)))},[e,er]);const{mints:dr,proofs:ir}=useEcashStore(),pt=React.useMemo(()=>ir.reduce((wr,kr)=>wr+kr.amount,0),[ir]),tr=React.useMemo(()=>{const wr=new Map;return ir.forEach(kr=>{const Dr=Object.keys(dr).find(rr=>{const cr=dr[rr].keys;return cr.keysets&&Array.isArray(cr.keysets)&&cr.keysets.some(Br=>Br.id===kr.id)||cr[kr.id]});Dr&&wr.set(Dr,(wr.get(Dr)||0)+kr.amount)}),wr},[ir,dr]),sr=React.useMemo(()=>{const wr=Object.keys(dr);if(wr.length===0)return;const kr=parseInt(r);if(!r||isNaN(kr)||kr<=0){let rr=wr[0],cr=tr.get(rr)||0;return wr.forEach(Br=>{const br=tr.get(Br)||0;br>cr&&(cr=br,rr=Br)}),rr}if(v==="npub"){for(const rr of wr)if((tr.get(rr)||0)>=kr)return rr}if(v==="lightning_invoice"||v==="lightning_address"){let rr=wr[0],cr=tr.get(rr)||0;return wr.forEach(Br=>{const br=tr.get(Br)||0;br>cr&&(cr=br,rr=Br)}),console.log(` Selected mint: ${rr} (balance: ${cr} sats)`),rr}const Dr=wr[0];return console.log(` Selected mint: ${Dr} (balance: ${tr.get(Dr)||0} sats)`),Dr},[dr,r,v,tr]);reactExports.useEffect(()=>{e||(g(null),w(null),n(""),a(""),f(!1))},[e]);const nr=wr=>{const kr=[];let Dr=wr;const rr=Array.from(tr.entries()).sort((cr,Br)=>Br[1]-cr[1]);for(const[cr,Br]of rr){if(Dr<=0)break;const br=Math.min(Br,Dr);br>0&&(kr.push({mintUrl:cr,amount:br,status:"pending"}),Dr-=br)}return Dr>0?null:kr.length>1?kr:null},pr=async()=>{if(!sr){w("No mints available");return}f(!0),w(null);try{const wr=await CashuService.meltTokens(sr,s);useEcashStore.getState().addHistoryItem({id:Math.random().toString(36).substring(7),type:"send",amount:wr.quote.amount,mint:sr,timestamp:Math.floor(Date.now()/1e3),isNutzap:!1,memo:"Lightning payment"}),g("paid"),setTimeout(t,2e3)}catch(wr){w(wr.message||"Payment failed")}finally{f(!1)}},gr=async()=>{if(!sr){w("No mints available");return}f(!0),w(null);try{const wr=parseInt(r);if(isNaN(wr)||wr<=0)throw new Error("Invalid amount");console.log(`Resolving Lightning address: ${s}`);const kr=await LnurlService.resolveToInvoice(s,wr),Dr=await CashuService.meltTokens(sr,kr);useEcashStore.getState().addHistoryItem({id:Math.random().toString(36).substring(7),type:"send",amount:Dr.quote.amount,mint:sr,timestamp:Math.floor(Date.now()/1e3),isNutzap:!1,memo:`Lightning payment to ${s}`}),g("paid"),setTimeout(t,2e3)}catch(wr){w(wr.message||"Payment failed")}finally{f(!1)}},mr=wr=>{const kr=wr.target.files?.[0];if(!kr)return;const Dr=new FileReader;Dr.onload=rr=>{const cr=rr.target?.result,Br=new Image;Br.src=cr,Br.onload=()=>{const br=document.createElement("canvas"),lr=br.getContext("2d");if(!lr)return;br.width=Br.width,br.height=Br.height,lr.drawImage(Br,0,0);const Sr=lr.getImageData(0,0,br.width,br.height),yt=jsQR(Sr.data,br.width,br.height);if(yt){const Je=yt.data;a(Je),je(!1)}else w("No QR code found in image")}},Dr.readAsDataURL(kr)},yr=(wr,kr)=>{if(!k){kr.getTracks().forEach(Br=>Br.stop());return}const Dr=document.createElement("canvas"),rr=Dr.getContext("2d",{willReadFrequently:!0}),cr=()=>{if(wr.readyState===wr.HAVE_ENOUGH_DATA&&rr){Dr.height=wr.videoHeight,Dr.width=wr.videoWidth,rr.drawImage(wr,0,0,Dr.width,Dr.height);const Br=rr.getImageData(0,0,Dr.width,Dr.height),br=jsQR(Br.data,Br.width,Br.height);if(br){const lr=br.data;a(lr),kr.getTracks().forEach(Sr=>Sr.stop()),je(!1);return}}document.getElementById("qr-modal")?requestAnimationFrame(cr):kr.getTracks().forEach(Br=>Br.stop())};requestAnimationFrame(cr)};reactExports.useEffect(()=>{let wr=null,kr=!0;return k&&(async()=>{if(k)try{const rr=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!kr){rr.getTracks().forEach(Br=>Br.stop());return}wr=rr;const cr=$e.current;cr&&(cr.srcObject=rr,cr.setAttribute("playsinline","true"),cr.onloadedmetadata=()=>{cr.play().catch(Br=>console.error("Play failed",Br)),yr(cr,rr)})}catch(rr){console.error("Camera error:",rr),w("Failed to access camera"),je(!1)}})(),()=>{kr=!1,wr&&wr.getTracks().forEach(rr=>rr.stop())}},[k]);const Er=async()=>{const wr=parseInt(r);if(isNaN(wr)||wr<=0){w("Invalid amount");return}const kr=sr&&tr.get(sr)||0;if(!sr||kr<wr){const rr=nr(wr);if(rr){W(rr);return}else{const cr=tr.size;if(cr>1){const Br=Array.from(tr.entries()).map(([br,lr])=>`${br.replace("https://","").replace(/\/$/,"")}: ${lr} sats`).join(`
`);w(`Insufficient balance.
Need: ${wr} sats
Have: ${pt} sats across ${cr} mints

`+Br)}else w("Insufficient balance");return}}f(!0),w(null);try{const rr=parseInt(r);if(isNaN(rr)||rr<=0)throw new Error("Invalid amount");const cr=await CashuService.sendToken(rr,sr,s,void 0,!l);let Br,br=[];if(typeof cr=="string"?Br=cr:(Br=cr.token,br=cr.usedProofs),l)g(Br),useEcashStore.getState().addHistoryItem({id:Math.random().toString(36).substring(7),type:"send",amount:rr,mint:sr,timestamp:Math.floor(Date.now()/1e3),isNutzap:!1,recipient:s,token:Br});else{const{decryptedKey:lr}=useAuthStore.getState();if(!lr)throw new Error("Wallet must be unlocked to send NutZaps");let Sr=s;try{const _r=nip19_exports$1.decode(s);_r.type==="npub"&&(Sr=_r.data)}catch(_r){console.warn("Could not decode recipient as npub, using as-is:",_r)}const{publishNutZapWithRetry:yt}=await __vitePreload(async()=>{const{publishNutZapWithRetry:_r}=await import("./nutZapPublisher-B45QRP64.js");return{publishNutZapWithRetry:_r}},[],import.meta.url),Je=`pending-${Date.now()}`,ft=br.map(_r=>_r.secret);console.log(` Creating pending send (ID: ${Je})...`),useEcashStore.getState().addPendingSend({id:Je,token:Br,recipient:Sr,amount:rr,mint:sr,timestamp:Math.floor(Date.now()/1e3),attempts:0,proofSecrets:ft});const or=!1;console.log(" Publishing NutZap with retry logic...");const Ar=await yt(Br,sr,rr,Sr,lr);if(!Ar.success)throw console.error(" NutZap publish failed after all retries:",Ar.error),useEcashStore.getState().updatePendingSendAttempt(Je,Ar.error),new Error(`Failed to publish NutZap after 3 attempts: ${Ar.error}

Your proofs are protected in pending sends (ID: ${Je}). They will not be removed by auto-cleanup.`);console.log(` NutZap published successfully to ${Ar.relayCount} relays`),console.log(` Removing pending send (ID: ${Je})...`),useEcashStore.getState().removePendingSend(Je),console.log(" Publishing updated wallet state to NIP-60..."),await useEcashStore.getState().publishProofsToNostr(!0),console.log(" Wallet state published"),useEcashStore.getState().addHistoryItem({id:Math.random().toString(36).substring(7)+"-send",type:"send",amount:rr,mint:sr,timestamp:Math.floor(Date.now()/1e3),isNutzap:!0,recipient:s}),t()}}catch(rr){w(rr.message||"Send failed")}finally{f(!1)}},xr=async()=>{if(!K)return;f(!0),w(null),Qe({total:K.length,sent:0,failed:0});let wr=0,kr=0;for(let Dr=0;Dr<K.length;Dr++){const{mintUrl:rr,amount:cr}=K[Dr];W(Br=>Br.map((br,lr)=>lr===Dr?{...br,status:"sending"}:br));try{const br=await CashuService.sendToken(cr,rr,s,void 0,!l);let lr,Sr=[];if(typeof br=="string"?lr=br:(lr=br.token,Sr=br.usedProofs),l)useEcashStore.getState().addHistoryItem({id:Math.random().toString(36).substring(7),type:"send",amount:cr,mint:rr,timestamp:Math.floor(Date.now()/1e3),isNutzap:!1,recipient:s,token:lr});else{const{decryptedKey:yt}=useAuthStore.getState();if(!yt)throw new Error("Wallet must be unlocked");let Je=s;try{const Nr=nip19_exports$1.decode(s);Nr.type==="npub"&&(Je=Nr.data)}catch{console.warn("Could not decode recipient as npub")}const ft=`pending-multi-${Date.now()}-${Dr}`,or=Sr.map(Nr=>Nr.secret);console.log(` Creating pending send for mint ${Dr+1}/${K.length} (ID: ${ft})...`),useEcashStore.getState().addPendingSend({id:ft,token:lr,recipient:Je,amount:cr,mint:rr,timestamp:Math.floor(Date.now()/1e3),attempts:0,proofSecrets:or});const{publishNutZapWithRetry:Ar}=await __vitePreload(async()=>{const{publishNutZapWithRetry:Nr}=await import("./nutZapPublisher-B45QRP64.js");return{publishNutZapWithRetry:Nr}},[],import.meta.url),_r=await Ar(lr,rr,cr,Je,yt);if(!_r.success)throw console.error(` NutZap publish failed for mint ${Dr+1}: ${_r.error}`),useEcashStore.getState().updatePendingSendAttempt(ft,_r.error),new Error(`Failed to publish NutZap: ${_r.error}`);console.log(` Removing pending send for mint ${Dr+1} (ID: ${ft})...`),useEcashStore.getState().removePendingSend(ft),console.log(" Publishing updated wallet state to NIP-60..."),await useEcashStore.getState().publishProofsToNostr(!0),useEcashStore.getState().addHistoryItem({id:Math.random().toString(36).substring(7),type:"send",amount:cr,mint:rr,timestamp:Math.floor(Date.now()/1e3),isNutzap:!0,recipient:s})}W(yt=>yt.map((Je,ft)=>ft===Dr?{...Je,status:"success"}:Je)),Qe(yt=>({...yt,sent:yt.sent+1})),wr+=cr}catch(Br){console.error(`Failed to send from ${rr}:`,Br),W(yt=>yt.map((Je,ft)=>ft===Dr?{...Je,status:"failed"}:Je)),Qe(yt=>({...yt,failed:yt.failed+1})),kr+=cr,console.log(` Attempting fallback for ${cr} sats...`);const br=new Set(K.slice(0,Dr+1).map(yt=>yt.mintUrl)),lr=new Map(Array.from(tr.entries()).filter(([yt])=>!br.has(yt)));let Sr=null;for(const[yt,Je]of lr.entries())if(Je>=cr){Sr=yt;break}if(Sr){console.log(` Found fallback mint: ${Sr} (${tr.get(Sr)} sats)`);const yt={mintUrl:Sr,amount:cr,status:"sending"};W(Je=>[...Je,yt]),Qe(Je=>({...Je,total:Je.total+1}));try{const Je=await CashuService.sendToken(cr,Sr,s);if(!l){const{decryptedKey:ft}=useAuthStore.getState();if(!ft)throw new Error("Wallet must be unlocked");let or=s;try{const Gr=nip19_exports$1.decode(s);Gr.type==="npub"&&(or=Gr.data)}catch{console.warn("Could not decode recipient as npub")}const Ar=Nip61Service.createNutZapEvent(Je,Sr,cr,or),_r=new NDKPrivateKeySigner(ft),Nr=new NDK({explicitRelayUrls:["wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band","wss://relay.primal.net","wss://relay.snort.social"],signer:_r});await Nr.connect(2e3);const Hr=new NDKEvent(Nr,Ar);await Hr.sign(),await Hr.publish(),useEcashStore.getState().addHistoryItem({id:Hr.id||Math.random().toString(36).substring(7),type:"send",amount:cr,mint:Sr,timestamp:Hr.created_at||Math.floor(Date.now()/1e3),isNutzap:!0,recipient:s})}W(ft=>ft.map((or,Ar)=>Ar===ft.length-1?{...or,status:"success"}:or)),Qe(ft=>({...ft,sent:ft.sent+1})),wr+=cr,kr-=cr,console.log(` Fallback successful! Sent ${cr} sats from ${Sr}`)}catch(Je){console.error(" Fallback also failed:",Je),W(ft=>ft.map((or,Ar)=>Ar===ft.length-1?{...or,status:"failed"}:or)),Qe(ft=>({...ft,failed:ft.failed+1}))}}else console.log(` No fallback mint available with ${cr} sats`)}}f(!1),ze({success:kr===0,totalSent:wr,totalFailed:kr})},Cr=async()=>{switch(ar(s)){case"npub":await Er();break;case"lightning_invoice":await pr();break;case"lightning_address":await gr();break;default:w("Invalid input. Enter npub, Lightning invoice (lnbc...), or Lightning address (name@domain.com)")}};return e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[k&&jsxRuntimeExports.jsx("div",{id:"qr-modal",className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[60] overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 rounded-xl p-4 border border-slate-800 my-auto",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-4 text-center",children:"Scan QR Code"}),jsxRuntimeExports.jsxs("div",{className:"relative aspect-square bg-black rounded-lg overflow-hidden mb-4",children:[jsxRuntimeExports.jsx("video",{ref:$e,className:"w-full h-full object-cover",playsInline:!0,muted:!0}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 border-2 border-purple-500/50 rounded-lg pointer-events-none"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("p",{className:"text-center text-slate-400 text-sm",children:"Camera not working? Upload an image instead."}),jsxRuntimeExports.jsx("input",{type:"file",ref:We,onChange:mr,accept:"image/*",capture:"environment",className:"hidden"}),jsxRuntimeExports.jsxs("button",{onClick:()=>We.current?.click(),className:"w-full bg-slate-800 hover:bg-slate-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5"}),"Upload QR Image"]}),jsxRuntimeExports.jsx("button",{onClick:()=>je(!1),className:"w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 font-medium py-3 px-4 rounded-lg transition-colors",children:"Cancel"})]})]})}),jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:p?jsxRuntimeExports.jsxs("div",{className:"p-6 text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto",children:jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-8 h-8 text-green-500"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white",children:p==="paid"?"Payment Sent!":"Token Generated!"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm",children:"This is a private token. Share it securely with the recipient."}),jsxRuntimeExports.jsx("div",{className:"bg-slate-950 p-3 rounded-lg border border-slate-800 text-left",children:jsxRuntimeExports.jsx("p",{className:"font-mono text-xs text-slate-500 break-all line-clamp-4",children:p})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{navigator.clipboard.writeText(p),q(!0),setTimeout(()=>q(!1),2e3)},className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-white rounded-xl font-medium transition-colors",children:Ve?" Copied!":"Copy Token"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"flex-1 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-xl font-bold",children:"Done"})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Send eCash"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white rounded-lg",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Send To"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 border border-slate-800 rounded-xl p-2 pr-2 focus-within:ring-2 focus-within:ring-purple-500 focus-within:border-transparent transition-all",children:[jsxRuntimeExports.jsx("input",{type:"text",value:s,onChange:wr=>a(wr.target.value),placeholder:"npub, Lightning invoice (lnbc...), or name@domain.com",className:"flex-1 bg-transparent text-white outline-none font-mono text-sm px-2 min-w-0"}),jsxRuntimeExports.jsx("button",{onClick:()=>je(!0),className:"p-2 hover:bg-slate-800 rounded-lg text-purple-500 transition-colors flex-shrink-0",title:"Scan QR Code",children:jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5"})})]}),v!=="unknown"&&s.trim()&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Detected: ",v==="npub"?" Nostr address (NutZap)":v==="lightning_invoice"?" Lightning invoice":" Lightning address"]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:er&&jsxRuntimeExports.jsxs("button",{onClick:()=>Ce(!Le),className:`px-3 py-2 text-xs font-medium rounded-lg transition-colors flex items-center gap-2 ${Le?"bg-purple-500/20 text-purple-400":"bg-purple-500/10 hover:bg-purple-500/20 text-purple-500"}`,children:[jsxRuntimeExports.jsx(User,{className:"w-3.5 h-3.5"}),Le?"Hide Follows":"Select from Follows"]})}),Le&&jsxRuntimeExports.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto bg-slate-950 border border-slate-800 rounded-xl p-2 space-y-2 custom-scrollbar",children:Re?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-slate-400 gap-2",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-5 h-5 animate-spin text-purple-500"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:"Currently fetching user follows..."})]}):L?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-red-400 gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:L})]}):_e.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-slate-400 gap-2",children:[jsxRuntimeExports.jsx(User,{className:"w-5 h-5 opacity-50"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:"User not following anyone"})]}):_e.map(wr=>{if(!wr.npub)return null;const kr=wr.npub===s;return jsxRuntimeExports.jsxs("div",{onClick:()=>{a(wr.npub)},className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors group border ${kr?"bg-purple-500/10 border-purple-500/30":"hover:bg-slate-900 border-transparent"}`,children:[wr.picture?jsxRuntimeExports.jsx("img",{src:wr.picture,alt:wr.name,className:"w-8 h-8 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-slate-500"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"font-bold text-sm text-white truncate",children:wr.name||"Unknown"}),wr.nip05&&jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 truncate",children:wr.nip05})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[jsxRuntimeExports.jsxs("span",{className:"font-mono truncate",children:[wr.npub.slice(0,8),"...",wr.npub.slice(-8)]}),jsxRuntimeExports.jsx("button",{onClick:Dr=>{Dr.stopPropagation(),navigator.clipboard.writeText(wr.npub)},className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",title:"Copy npub",children:jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]})]})]},wr.npub)})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-1",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"Amount"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-slate-500",children:["Available: ",pt.toLocaleString()," sats"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 border border-slate-800 rounded-xl p-3 focus-within:ring-2 focus-within:ring-purple-500 focus:border-transparent transition-all",children:[R==="sats"?jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-xl text-purple-500 flex-shrink-0"}):jsxRuntimeExports.jsx("span",{className:"text-xl text-purple-500 flex-shrink-0",children:""}),jsxRuntimeExports.jsx("input",{type:"number",value:r,onChange:wr=>n(wr.target.value),disabled:v==="lightning_invoice",placeholder:"0.00",className:"flex-1 bg-transparent text-white outline-none font-mono text-lg min-w-0 disabled:opacity-50 disabled:cursor-not-allowed"}),jsxRuntimeExports.jsx("button",{onClick:()=>{n(R==="sats"?pt.toString():satsToBTC(pt).toString())},className:"px-2 py-1 bg-purple-500/10 hover:bg-purple-500/20 text-purple-500 text-xs font-bold rounded transition-colors",children:"MAX"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>I(R==="sats"?"btc":"sats"),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Toggle unit",children:jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("span",{className:"text-slate-400 font-medium text-sm flex-shrink-0",children:R==="sats"?"sats":"BTC"})]})]}),v==="npub"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl border border-slate-800",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>u(!1),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-sm font-medium transition-all ${l?"text-slate-400 hover:text-white":"bg-purple-600 text-white shadow-lg"}`,children:[jsxRuntimeExports.jsx(Globe,{className:"w-4 h-4"}),"Public (NutZap)"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>u(!0),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-sm font-medium transition-all ${l?"bg-slate-700 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:[jsxRuntimeExports.jsx(ShieldCheck,{className:"w-4 h-4"}),"Private Token"]})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 text-center px-4",children:l?"Generates a token you can manually share. No event is published.":"Publishes a NIP-61 event visible to the recipient."})]}),y&&jsxRuntimeExports.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4"}),y]}),jsxRuntimeExports.jsx("button",{onClick:Cr,disabled:x||!r||!s,className:"w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:x?jsxRuntimeExports.jsx(LoaderCircle,{className:"w-4 h-4 animate-spin"}):"Send"})]})]})})}),K&&!x&&!it&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:"Send from Multiple Mints?"}),jsxRuntimeExports.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"You don't have enough sats in one mint, but you have enough across multiple mints."}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 mb-4",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"This will send:"}),K.map(({mintUrl:wr,amount:kr})=>jsxRuntimeExports.jsxs("div",{className:"text-sm text-slate-300 mb-1",children:[" ",kr," sats from ",new URL(wr).hostname]},wr))]}),jsxRuntimeExports.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3 mb-4",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-yellow-200",children:" If one mint fails, a partial payment may be sent."})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>W(null),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:xr,className:"flex-1 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-lg transition-colors",children:"Send from Multiple"})]})]})}),x&&K&&!it&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[jsxRuntimeExports.jsxs("h3",{className:"text-xl font-bold text-white mb-4",children:["Sending ",r," sats..."]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 mb-4",children:K.map(({mintUrl:wr,amount:kr,status:Dr})=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[Dr==="success"&&jsxRuntimeExports.jsx("span",{className:"text-green-400",children:""}),Dr==="failed"&&jsxRuntimeExports.jsx("span",{className:"text-red-400",children:""}),Dr==="sending"&&jsxRuntimeExports.jsx(LoaderCircle,{className:"w-4 h-4 animate-spin text-purple-400"}),Dr==="pending"&&jsxRuntimeExports.jsx("span",{className:"text-slate-500",children:""}),jsxRuntimeExports.jsxs("span",{className:"text-slate-300",children:[kr," sats from ",new URL(wr).hostname]})]},wr))}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-1",children:[jsxRuntimeExports.jsx("span",{children:"Progress"}),jsxRuntimeExports.jsxs("span",{children:[Ye.sent+Ye.failed,"/",Ye.total]})]}),jsxRuntimeExports.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:jsxRuntimeExports.jsx("div",{className:"bg-purple-500 h-2 rounded-full transition-all duration-300",style:{width:`${(Ye.sent+Ye.failed)/Ye.total*100}%`}})})]})]})}),it&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:it.success?" Payment Sent!":" Partial Payment Sent"}),it.success?jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-4",children:["Successfully sent ",it.totalSent," sats across ",K?.length," mints to recipient."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-4",children:["Sent ",it.totalSent,"/",it.totalSent+it.totalFailed," sats.",it.totalFailed," sats failed."]}),jsxRuntimeExports.jsx("div",{className:"bg-slate-800/50 rounded-lg p-3 mb-4 space-y-1",children:K?.map(({mintUrl:wr,amount:kr,status:Dr})=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[Dr==="success"&&jsxRuntimeExports.jsx("span",{className:"text-green-400",children:""}),Dr==="failed"&&jsxRuntimeExports.jsx("span",{className:"text-red-400",children:""}),jsxRuntimeExports.jsxs("span",{className:"text-slate-300",children:[kr," sats from ",new URL(wr).hostname]})]},wr))})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{ze(null),W(null),it.success&&t()},className:"w-full px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-lg transition-colors",children:"Close"})]})})]}):null},MintsModal=({isOpen:e,onClose:t})=>{const{mints:r,discoveredMints:n,updateMintStatus:s}=useEcashStore(),[a,l]=reactExports.useState("my-mints"),[u,x]=reactExports.useState(""),[f,p]=reactExports.useState(null),[g,y]=reactExports.useState(null);if(!e)return null;const w=k=>{useEcashStore.getState().removeMint(k),p(null)},R=async k=>{y(k),s(k,"checking");try{const je=await CashuService.validateMint(k);s(k,je),je==="online"&&await CashuService.loadMint(k)}catch{s(k,"offline")}finally{y(null)}},I=Object.values(n).filter(k=>!r[k.url]).filter(k=>k.url.toLowerCase().includes(u.toLowerCase())).sort((k,je)=>je.trustScore-k.trustScore);return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md h-[500px] flex flex-col shadow-2xl animate-in fade-in zoom-in duration-200 overflow-hidden relative",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800 bg-slate-900/50",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Mints"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white rounded-lg",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex border-b border-slate-800",children:[jsxRuntimeExports.jsx("button",{onClick:()=>l("my-mints"),className:`flex-1 py-3 text-sm font-bold transition-colors border-b-2 ${a==="my-mints"?"border-purple-500 text-purple-400":"border-transparent text-slate-500 hover:text-slate-300"}`,children:"My Mints"}),jsxRuntimeExports.jsx("button",{onClick:()=>l("discover"),className:`flex-1 py-3 text-sm font-bold transition-colors border-b-2 ${a==="discover"?"border-purple-500 text-purple-400":"border-transparent text-slate-500 hover:text-slate-300"}`,children:"Discover"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a==="my-mints"?jsxRuntimeExports.jsx("div",{className:"space-y-3",children:Object.values(r).length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-slate-500",children:[jsxRuntimeExports.jsx("p",{children:"No mints added yet."}),jsxRuntimeExports.jsx("button",{onClick:()=>l("discover"),className:"text-purple-400 text-sm font-bold mt-2 hover:underline",children:"Discover Mints"})]}):Object.values(r).map(k=>jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3 flex items-center justify-between group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg",children:jsxRuntimeExports.jsx(Server,{className:"w-4 h-4 text-purple-400"})}),jsxRuntimeExports.jsxs("div",{className:"min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"text-sm font-medium text-white truncate max-w-[200px]",children:k.url.replace("https://","").replace(/\/$/,"")}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500",children:k.keys&&k.keys.id||"Unknown ID"})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>p(k.url),className:"p-2 text-slate-600 hover:text-red-400 hover:bg-red-900/10 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]},k.url))}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search mint URLs...",value:u,onChange:k=>x(k.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl py-2 pl-9 pr-4 text-white text-sm focus:border-purple-500 outline-none"})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:I.length===0?jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-slate-500 text-sm",children:u?"No matching mints found.":"No new mints discovered yet."}):I.map(k=>jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-slate-800/50 rounded-lg",children:jsxRuntimeExports.jsx(Globe,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("div",{className:`absolute -top-1 -right-1 w-2.5 h-2.5 rounded-full border-2 border-slate-950 ${k.status==="online"?"bg-green-500":k.status==="offline"?"bg-red-500":"bg-slate-500"}`})]}),jsxRuntimeExports.jsxs("div",{className:"min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"text-sm font-medium text-white truncate max-w-[150px]",children:k.url.replace("https://","")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[jsxRuntimeExports.jsx(Activity,{className:"w-3 h-3"}),jsxRuntimeExports.jsxs("span",{children:["Trust: ",k.trustScore>0?"+":"",k.trustScore]})]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>R(k.url),disabled:g===k.url||k.status==="offline",className:"p-2 bg-purple-600/20 hover:bg-purple-600/40 text-purple-400 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:jsxRuntimeExports.jsx(Plus,{className:`w-4 h-4 ${g===k.url?"animate-spin":""}`})})]},k.url))})]})}),f&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 animate-in fade-in duration-200",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl p-6 w-full max-w-sm text-center shadow-xl",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 bg-red-500/10 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx(TriangleAlert,{className:"w-6 h-6"})}),jsxRuntimeExports.jsx("h4",{className:"text-lg font-bold text-white mb-2",children:"Remove Mint?"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-400 text-sm mb-6",children:["Are you sure you want to remove ",jsxRuntimeExports.jsx("span",{className:"text-white font-mono",children:f.replace("https://","")}),"?",jsxRuntimeExports.jsx("br",{}),"Your proofs will remain, but you won't be able to transact until you re-add it."]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>p(null),className:"flex-1 py-2 px-4 bg-slate-800 hover:bg-slate-700 text-white rounded-xl font-medium transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:()=>w(f),className:"flex-1 py-2 px-4 bg-red-600 hover:bg-red-700 text-white rounded-xl font-bold transition-colors",children:"Remove"})]})]})})]})})},CrossMintTransferModal=({isOpen:e,onClose:t})=>{const{mints:r,proofs:n}=useEcashStore(),[s,a]=reactExports.useState(""),[l,u]=reactExports.useState(""),[x,f]=reactExports.useState(""),[p,g]=reactExports.useState(!1),[y,w]=reactExports.useState(null),[R,I]=reactExports.useState(!1),k=Object.keys(r),je=s?n.filter($e=>{const We=r[s]?.keys;return We?We.keysets&&Array.isArray(We.keysets)?We.keysets.some(K=>K.id===$e.id):!!We[$e.id]:!1}).reduce(($e,We)=>$e+We.amount,0):0;reactExports.useEffect(()=>{e&&(a(""),u(""),f(""),w(null),I(!1))},[e]);const Ve=async()=>{w(null),g(!0);try{const $e=parseInt(x);if(!s||!l)throw new Error("Please select both source and destination mints");if(s===l)throw new Error("Source and destination must be different");if(!$e||$e<=0)throw new Error("Amount must be greater than 0");if($e>je)throw new Error(`Insufficient balance. Available: ${je} sats`);const We=await CashuService.transferBetweenMints($e,s,l);if(!We.success)throw new Error(We.error||"Transfer failed");useEcashStore.getState().addHistoryItem({id:Math.random().toString(36).substring(7),type:"send",amount:$e,mint:s,timestamp:Math.floor(Date.now()/1e3),isNutzap:!1,recipient:`Transfer to ${l}`}),I(!0),setTimeout(()=>{t()},2e3)}catch($e){w($e.message||"Transfer failed")}finally{g(!1)}},q=()=>{f(je.toString())};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-white",children:"Move Between Mints"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-6 h-6"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"From Mint"}),jsxRuntimeExports.jsxs("select",{value:s,onChange:$e=>a($e.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select source mint"}),k.map($e=>jsxRuntimeExports.jsx("option",{value:$e,children:$e},$e))]}),s&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Available: ",je.toLocaleString()," sats"]})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx(ArrowRight,{className:"w-6 h-6 text-purple-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"To Mint"}),jsxRuntimeExports.jsxs("select",{value:l,onChange:$e=>u($e.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select destination mint"}),k.filter($e=>$e!==s).map($e=>jsxRuntimeExports.jsx("option",{value:$e,children:$e},$e))]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-2",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"Amount"}),s&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-slate-500",children:["Available: ",je.toLocaleString()," sats"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 border border-slate-800 rounded-xl p-3 focus-within:ring-2 focus-within:ring-purple-500 focus:border-transparent transition-all",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-xl text-purple-500 flex-shrink-0"}),jsxRuntimeExports.jsx("input",{type:"number",value:x,onChange:$e=>f($e.target.value),placeholder:"0",className:"flex-1 bg-transparent text-white text-lg outline-none placeholder-slate-600",disabled:!s}),jsxRuntimeExports.jsx("button",{onClick:q,disabled:!s,className:"px-3 py-1 bg-purple-500/20 text-purple-400 rounded-lg text-sm font-medium hover:bg-purple-500/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"MAX"}),jsxRuntimeExports.jsx("span",{className:"text-slate-400 text-sm",children:"sats"})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-yellow-200",children:[" ",jsxRuntimeExports.jsx("strong",{children:"Note:"})," Lightning fees may apply during the transfer."]})}),y&&jsxRuntimeExports.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-200",children:y})}),R&&jsxRuntimeExports.jsx("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-green-200",children:" Transfer successful!"})})]}),jsxRuntimeExports.jsx("div",{className:"p-6 border-t border-slate-800",children:jsxRuntimeExports.jsx("button",{onClick:Ve,disabled:p||!s||!l||!x||R,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold py-3 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Transferring...":"Transfer"})})]})}):null},ProofsModal=({isOpen:e,onClose:t})=>{const{mints:r,proofs:n}=useEcashStore(),[s,a]=reactExports.useState(new Set),[l,u]=reactExports.useState(!1),x=g=>{a(y=>{const w=new Set(y);return w.has(g)?w.delete(g):w.add(g),w})};e&&n.length>0&&console.log(" Current proofs:",n.map(g=>({amount:g.amount,secret:g.secret,id:g.id})));const f=reactExports.useMemo(()=>{const g=Object.values(r),y={};g.forEach(R=>{y[R.url]={url:R.url,amount:0,count:0,isUnknown:!1}});const w={};return g.forEach(R=>{const I=R.keys;I&&(w[I.id]=R.url,I.keysets&&(Array.isArray(I.keysets)?I.keysets.forEach(k=>w[k.id]=R.url):Object.keys(I.keysets).forEach(k=>w[k]=R.url)))}),n.forEach(R=>{const I=w[R.id];if(I)y[I]||(y[I]={url:I,amount:0,count:0,isUnknown:!1}),y[I].amount+=R.amount,y[I].count+=1;else{const k=`unknown-${R.id}`;y[k]||(y[k]={url:`Unknown Keyset: ${R.id}`,amount:0,count:0,isUnknown:!0}),y[k].amount+=R.amount,y[k].count+=1}}),Object.values(y).filter(R=>R.amount>0||!R.isUnknown).sort((R,I)=>I.amount-R.amount)},[r,n]),p=n.reduce((g,y)=>g+y.amount,0);return e?jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md max-h-[600px] flex flex-col shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Proof Composition"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white rounded-lg",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 bg-slate-900/50 text-center border-b border-slate-800",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-500 text-sm uppercase tracking-wider font-bold",children:"Total Balance"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"w-6 h-6 text-purple-400"}),jsxRuntimeExports.jsx("span",{className:"text-3xl font-bold text-white",children:p.toLocaleString()}),jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:"sats"})]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[n.length," proofs"]}),Object.keys(r).length>1&&jsxRuntimeExports.jsxs("button",{onClick:()=>u(!0),className:"mt-4 px-4 py-2 bg-purple-500/20 hover:bg-purple-500/30 text-purple-400 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 mx-auto",children:[jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"}),"Move Between Mints"]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:f.length===0?jsxRuntimeExports.jsx("div",{className:"text-center text-slate-500 py-4",children:"No proofs found."}):f.map(g=>{const y=s.has(g.url);return jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-slate-900/50 transition-colors",onClick:()=>x(g.url),children:[jsxRuntimeExports.jsxs("div",{className:"min-w-0 pr-4 flex-1",children:[jsxRuntimeExports.jsx("div",{className:`font-bold truncate ${g.isUnknown?"text-red-400":"text-white"}`,children:g.url.replace("https://","").replace(/\/$/,"")}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-slate-500",children:[g.count," proofs"]})]}),jsxRuntimeExports.jsxs("div",{className:"text-right whitespace-nowrap flex items-center gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"font-mono text-purple-400 font-bold",children:[g.amount.toLocaleString()," sats"]}),y?jsxRuntimeExports.jsx(ChevronUp,{className:"w-4 h-4 text-slate-400"}):jsxRuntimeExports.jsx(ChevronDown,{className:"w-4 h-4 text-slate-400"})]})]}),y&&jsxRuntimeExports.jsx("div",{className:"px-4 py-3 space-y-1 border-t border-white/10",children:n.filter(w=>{const R=Object.keys(r).find(I=>{const k=r[I].keys;return k.keysets&&Array.isArray(k.keysets)&&k.keysets.some(je=>je.id===w.id)||k[w.id]});return R===g.url||!R&&g.isUnknown&&g.url.includes(w.id)}).map((w,R)=>jsxRuntimeExports.jsxs("div",{className:"text-xs bg-slate-900/50 rounded p-2 font-mono",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-slate-400",children:[jsxRuntimeExports.jsx("span",{children:"Amount:"}),jsxRuntimeExports.jsxs("span",{className:"text-purple-400",children:[w.amount," sats"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-slate-500 mt-1",children:[jsxRuntimeExports.jsx("span",{children:"Secret:"}),jsxRuntimeExports.jsxs("span",{className:"truncate ml-2",children:[w.secret.substring(0,16),"..."]})]})]},R))})]},g.url)})})]}),jsxRuntimeExports.jsx(CrossMintTransferModal,{isOpen:l,onClose:()=>u(!1)})]}):null},PendingSendsModal=({isOpen:e,onClose:t})=>{const{pendingSends:r,removePendingSend:n,updatePendingSendAttempt:s}=useEcashStore(),{decryptedKey:a}=useAuthStore(),[l,u]=reactExports.useState(null),[x,f]=reactExports.useState(null),[p,g]=reactExports.useState(null),[y,w]=reactExports.useState(null);if(!e)return null;const R=async k=>{if(!a){alert("Wallet must be unlocked to retry");return}u(k.id);try{let je=k.recipient;try{const W=nip19_exports$1.decode(k.recipient);W.type==="npub"&&(je=W.data)}catch{console.warn("Could not decode recipient as npub")}const Ve=Nip61Service.createNutZapEvent(k.token,k.mint,k.amount,je),q=new NDKPrivateKeySigner(a),$e=new NDK({explicitRelayUrls:["wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band","wss://relay.primal.net","wss://relay.snort.social"],signer:q});await $e.connect(2e3);const We=new NDKEvent($e,Ve);await We.sign();const K=await We.publish();if(K.size>0)console.log(` Retry successful! Published to ${K.size} relays`),useEcashStore.getState().addHistoryItem({id:We.id||Math.random().toString(36).substring(7),type:"send",amount:k.amount,mint:k.mint,timestamp:We.created_at||Math.floor(Date.now()/1e3),isNutzap:!0,recipient:k.recipient}),n(k.id),console.log(" Publishing updated wallet state to NIP-60..."),await useEcashStore.getState().publishProofsToNostr(!0),g(`Successfully published to ${K.size} relays!`),setTimeout(()=>g(null),3e3);else throw new Error("No relays received the event")}catch(je){console.error("Retry failed:",je),s(k.id,je.message),w(`Retry failed: ${je.message}`),setTimeout(()=>w(null),5e3)}finally{u(null)}},I=k=>{navigator.clipboard.writeText(k.token),f(k.id),setTimeout(()=>f(null),2e3)};return jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-800",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white",children:"Stuck Sends"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:[r.length," pending ",r.length===1?"send":"sends"," waiting to be published"]})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12",children:[jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"No pending sends"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"All your sends have been published successfully!"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-4",children:r.map(k=>jsxRuntimeExports.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4",children:[jsxRuntimeExports.jsx("div",{className:"flex items-start justify-between mb-3",children:jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-lg font-bold text-white",children:[k.amount," sats"]}),jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500",children:""}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-slate-400 font-mono",children:[k.recipient.slice(0,12),"...",k.recipient.slice(-8)]})]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-slate-500",children:["From: ",new URL(k.mint).hostname]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500",children:new Date(k.timestamp).toLocaleString()}),k.attempts>0&&jsxRuntimeExports.jsxs("div",{className:"text-xs text-yellow-400 mt-1",children:[" ",k.attempts," failed ",k.attempts===1?"attempt":"attempts"]}),k.lastError&&jsxRuntimeExports.jsxs("div",{className:"text-xs text-red-400 mt-1",children:["Error: ",k.lastError]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>R(k),disabled:l===k.id,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-800 text-white text-sm font-bold rounded-lg transition-colors disabled:cursor-not-allowed",children:l===k.id?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 animate-spin"}),"Retrying..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4"}),"Retry Publish"]})}),jsxRuntimeExports.jsx("button",{onClick:()=>I(k),className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm rounded-lg transition-colors flex items-center gap-2",children:x===k.id?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),"Copied"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),"Copy Token"]})})]})]},k.id))})}),jsxRuntimeExports.jsx("div",{className:"p-6 border-t border-slate-800 bg-slate-900/50",children:jsxRuntimeExports.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-yellow-200",children:[" ",jsxRuntimeExports.jsx("strong",{children:"Tip:"}),' These tokens are already locked to the recipient. Use "Retry Publish" to send them via Nostr, or "Copy Token" to send manually.']})})})]}),p&&jsxRuntimeExports.jsx("div",{className:"fixed bottom-4 right-4 z-[60] animate-in slide-in-from-bottom-5 fade-in duration-300",children:jsxRuntimeExports.jsxs("div",{className:"bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[jsxRuntimeExports.jsx(Check,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:p})]})}),y&&jsxRuntimeExports.jsx("div",{className:"fixed bottom-4 right-4 z-[60] animate-in slide-in-from-bottom-5 fade-in duration-300",children:jsxRuntimeExports.jsxs("div",{className:"bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[jsxRuntimeExports.jsx(X,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:y})]})})]})},EcashTransactionDetailsModal=({isOpen:e,onClose:t,transaction:r})=>{const[n,s]=reactExports.useState(null);if(reactExports.useEffect(()=>{if(!r)return;const l=r.type==="receive"?r.sender:r.recipient;l?ProfileService.fetchProfile(l).then(s).catch(u=>console.error("Failed to fetch profile:",u)):s(null)},[r]),!e||!r)return null;const a=l=>{navigator.clipboard.writeText(l)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Transaction Details"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center pb-4 border-b border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:`text-3xl font-bold mb-1 ${r.type==="receive"?"text-green-500":"text-white"}`,children:[r.type==="receive"?"+":"-",r.amount,jsxRuntimeExports.jsx("span",{className:"text-lg ml-2 text-slate-400",children:"sats"})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-slate-400",children:[r.type==="receive"?"Received":"Sent"," ",r.isNutzap?"NutZap":"Private"]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Date & Time"}),jsxRuntimeExports.jsx("div",{className:"text-sm text-white",children:new Date(r.timestamp*1e3).toLocaleString()})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Mint"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-white font-mono truncate flex-1",children:r.mint}),jsxRuntimeExports.jsx("button",{onClick:()=>window.open(r.mint,"_blank"),className:"p-1.5 hover:bg-slate-800 rounded-lg transition-colors",title:"Open mint URL",children:jsxRuntimeExports.jsx(ExternalLink,{className:"w-4 h-4 text-slate-400"})})]})]}),r.type==="receive"&&r.sender&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"From"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 bg-slate-800/50 rounded-lg p-3",children:[n?.picture?jsxRuntimeExports.jsx("img",{src:n.picture,alt:n.name,className:"w-10 h-10 rounded-full object-cover flex-shrink-0"}):jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsx(User,{className:"w-5 h-5 text-slate-400"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("span",{className:"font-bold text-white truncate",children:n?.name||`${r.sender.slice(0,8)}...${r.sender.slice(-6)}`}),n?.nip05&&jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-purple-400 flex-shrink-0"})]}),n?.nip05&&jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400 truncate",children:n.nip05}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 font-mono truncate",children:r.sender})]}),jsxRuntimeExports.jsx("button",{onClick:()=>a(r.sender),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors flex-shrink-0",title:"Copy npub",children:jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),r.type==="send"&&r.recipient&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"To"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 bg-slate-800/50 rounded-lg p-3",children:[n?.picture?jsxRuntimeExports.jsx("img",{src:n.picture,alt:n.name,className:"w-10 h-10 rounded-full object-cover flex-shrink-0"}):jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsx(User,{className:"w-5 h-5 text-slate-400"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("span",{className:"font-bold text-white truncate",children:n?.name||`${r.recipient.slice(0,8)}...${r.recipient.slice(-6)}`}),n?.nip05&&jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-purple-400 flex-shrink-0"})]}),n?.nip05&&jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400 truncate",children:n.nip05}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 font-mono truncate",children:r.recipient})]}),jsxRuntimeExports.jsx("button",{onClick:()=>a(r.recipient),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors flex-shrink-0",title:"Copy npub",children:jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),r.memo&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Memo"}),jsxRuntimeExports.jsx("div",{className:"text-sm text-white bg-slate-800/50 rounded-lg p-3",children:r.memo})]}),!r.isNutzap&&r.token&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Token"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"text-xs text-white font-mono truncate flex-1 bg-slate-800/50 rounded-lg p-2",children:[r.token.slice(0,32),"..."]}),jsxRuntimeExports.jsx("button",{onClick:()=>a(r.token),className:"p-1.5 hover:bg-slate-800 rounded-lg transition-colors",title:"Copy token",children:jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),r.isNutzap&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Event ID"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-white font-mono truncate flex-1",children:r.id}),jsxRuntimeExports.jsx("button",{onClick:()=>a(r.id),className:"p-1.5 hover:bg-slate-800 rounded-lg transition-colors",title:"Copy event ID",children:jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]})]}),jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-slate-800",children:jsxRuntimeExports.jsx("button",{onClick:t,className:"w-full py-2 px-4 bg-purple-500 hover:bg-purple-600 text-white font-bold rounded-xl transition-colors",children:"Close"})})]})})},EcashWallet=()=>{const{mints:e,proofs:t,history:r,pendingSends:n}=useEcashStore(),{publicKey:s}=useAuthStore(),[a,l]=reactExports.useState(!1),[u,x]=reactExports.useState(!1),[f,p]=reactExports.useState(!1),[g,y]=reactExports.useState(!1),[w,R]=reactExports.useState(!1),[I,k]=reactExports.useState(null),[je,Ve]=reactExports.useState(new Map),[q,$e]=reactExports.useState(!0),[We,K]=reactExports.useState(!1),[W,Ye]=reactExports.useState(null),[Qe,it]=reactExports.useState(null),[ze]=reactExports.useState(0);reactExports.useEffect(()=>{console.log(` EcashWallet (v${ze}): Effect triggered. PublicKey: ${s?"Present":"Missing"}`);const Fe=new NDK({explicitRelayUrls:["wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band","wss://relay.primal.net","wss://relay.snort.social","wss://relay.azzamo.net","wss://relay.cashumints.space"]});let Le=null,Ce=null,L=null;return console.log(` EcashWallet (v${ze}): Initializing NDK...`),Promise.race([Fe.connect(),new Promise(O=>setTimeout(O,3e3))]).then(()=>{if(console.log(` EcashWallet (v${ze}): NDK Connected to relays`),s){Le=Fe.subscribe({kinds:[KIND_NIP61_NUTZAP],"#p":[s]}),console.log(` EcashWallet (v${ze}): Subscribed to NIP-61 NutZaps`),Le.on("event",async st=>{if(useEcashStore.getState().history.some(dt=>dt.id===st.id))return;console.log(" EcashWallet: Received NutZap",st.id);const Xe=Nip61Service.parseNutZap(st);if(Xe&&st.content)try{await CashuService.receiveToken(st.content),useEcashStore.getState().addHistoryItem({id:`${st.id}-receive`,type:"receive",amount:Xe.amount,mint:Xe.mint,timestamp:st.created_at,isNutzap:!0,sender:nip19_exports$1.npubEncode(st.pubkey),recipient:s}),console.log("NutZap Redeemed!"),Re()}catch(dt){dt.message?.includes("already spent")?(console.log(" Token already spent, marking as processed"),useEcashStore.getState().addHistoryItem({id:`${st.id}-receive`,type:"receive",amount:0,mint:Xe.mint,timestamp:st.created_at,isNutzap:!0,recipient:s})):console.error("Failed to redeem NutZap",dt)}});const{decryptedKey:O}=useAuthStore.getState();O&&(L=Nip60Service.subscribeToWalletState(Fe,s,O,st=>{useEcashStore.getState().mergeWalletState(st)}),console.log(` EcashWallet (v${ze}): Subscribed to NIP-60 Wallet State`))}else console.log(` EcashWallet (v${ze}): Skipping NIP-61 (No public key)`);Ce=Nip87Service.subscribeToMints(Fe),console.log(` EcashWallet (v${ze}): Subscribed to NIP-87 Mints`)}),()=>{Le&&Le.stop(),Ce&&Ce.stop(),L&&L.stop()}},[s,ze]),reactExports.useEffect(()=>{const Fe=async()=>{const Le=new Set;r.forEach(L=>{L.isNutzap&&(L.sender&&Le.add(L.sender),L.recipient&&Le.add(L.recipient))});const Ce=new Map(je);for(const L of Le)if(!Ce.has(L))try{const O=await ProfileService.fetchProfile(L);O&&Ce.set(L,O)}catch(O){console.error(`Failed to fetch profile for ${L}:`,O)}Ve(Ce)};r.length>0&&Fe()},[r]);const v=t.reduce((Fe,Le)=>Fe+Le.amount,0),D=(v/1e8).toFixed(8),_e=async()=>{try{K(!0);const Fe=useEcashStore.getState().proofs,Le={};Fe.forEach(L=>{let O=Object.keys(e).find(st=>{const lt=e[st].keys;return lt.keysets&&Array.isArray(lt.keysets)&&lt.keysets.some(Xe=>Xe.id===L.id)||lt[L.id]});if(!O){console.warn(` Skipping proof with keyset ${L.id} - mint not found`);return}Le[O]||(Le[O]=[]),Le[O].push(L)});let Ce=0;for(const[L,O]of Object.entries(Le)){if(O.length===0)continue;const st=await CashuService.consolidateProofs(L,O);useEcashStore.getState().removeProofs(O,!0),useEcashStore.getState().addProofs(st,!0),Ce+=O.length}console.log(" Publishing consolidated state to NIP-60 (skip merge)..."),await useEcashStore.getState().publishProofsToNostr(!0),it({success:!0,count:Ce})}catch(Fe){console.error("Consolidation failed:",Fe),it({success:!1,count:0})}finally{K(!1)}},P=async()=>{try{K(!0);const Fe=useEcashStore.getState().proofs,Le={},Ce=Object.keys(e).filter(Xe=>e[Xe].active);Fe.forEach(Xe=>{let dt=Object.keys(e).find(er=>{const ar=e[er].keys;return ar.keysets&&Array.isArray(ar.keysets)&&ar.keysets.some(dr=>dr.id===Xe.id)||ar[Xe.id]});!dt&&Ce.length>0&&(dt=Ce[0]),dt&&(Le[dt]||(Le[dt]=[]),Le[dt].push(Xe))});let L=0,O=0;const st=useEcashStore.getState().pendingSends,lt=new Set(st.flatMap(Xe=>Xe.proofSecrets||[]));lt.size>0&&console.log(` Manual cleanup: Protecting ${lt.size} proofs in ${st.length} pending send(s)`);for(const[Xe,dt]of Object.entries(Le)){if(dt.length===0)continue;const er=dt.filter(ir=>!lt.has(ir.secret));if(er.length===0){console.log(` Manual cleanup: Skipping ${Xe} - all ${dt.length} proofs are in pending sends`);continue}er.length<dt.length&&console.log(` Manual cleanup: Checking ${er.length}/${dt.length} proofs from ${Xe} (${dt.length-er.length} protected)`);const{valid:ar,spent:dr}=await CashuService.checkProofStates(Xe,er);L+=ar.length,O+=dr.length,dr.length>0&&(useEcashStore.getState().removeProofs(dr,!0),console.log(` Removed ${dr.length} spent proofs from ${Xe}`))}O>0?(console.log(" Publishing cleaned state to NIP-60 (skip merge)..."),await useEcashStore.getState().publishProofsToNostr(!0),Ye({spent:O,valid:L})):Ye({spent:0,valid:L})}catch(Fe){console.error("Check proofs failed:",Fe),Ye({spent:-1,valid:0})}finally{K(!1)}},Re=async()=>{try{console.log(" Auto-cleanup: Waiting for NIP-60 sync..."),await new Promise(lt=>setTimeout(lt,2e3)),console.log(" Auto-cleanup: Starting proof check...");const Fe=useEcashStore.getState().proofs,Le={},Ce=Object.keys(e).filter(lt=>e[lt].active);Fe.forEach(lt=>{let Xe=Object.keys(e).find(dt=>{const er=e[dt].keys;return Array.isArray(er)?er.some(ar=>ar.id===lt.id):!1});!Xe&&Ce.length>0&&(Xe=Ce[0]),Xe&&(Le[Xe]||(Le[Xe]=[]),Le[Xe].push(lt))});let L=0;const O=useEcashStore.getState().pendingSends,st=new Set(O.flatMap(lt=>lt.proofSecrets||[]));st.size>0&&console.log(` Auto-cleanup: Protecting ${st.size} proofs in ${O.length} pending send(s)`);for(const[lt,Xe]of Object.entries(Le)){if(Xe.length===0)continue;const dt=Xe.filter(ar=>!st.has(ar.secret));if(dt.length===0){console.log(` Auto-cleanup: Skipping ${lt} - all ${Xe.length} proofs are in pending sends`);continue}dt.length<Xe.length&&console.log(` Auto-cleanup: Checking ${dt.length}/${Xe.length} proofs from ${lt} (${Xe.length-dt.length} protected)`);const{spent:er}=await CashuService.checkProofStates(lt,dt);L+=er.length,er.length>0&&(useEcashStore.getState().removeProofs(er,!0),console.log(` Auto-cleanup: Removed ${er.length} spent proofs from ${lt}`))}L>0&&(console.log(" Auto-cleanup: Publishing cleaned state to NIP-60..."),await useEcashStore.getState().publishProofsToNostr(!0),Ye({spent:L,valid:Fe.length-L}),setTimeout(()=>Ye(null),3e3))}catch(Fe){console.error("Auto-cleanup failed:",Fe)}};return jsxRuntimeExports.jsxs("div",{className:"space-y-6 pb-24",children:[jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-br from-purple-900/40 to-indigo-900/40 border border-purple-500/20 rounded-2xl p-6 relative overflow-hidden",children:jsxRuntimeExports.jsxs("div",{className:"relative z-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400 font-medium text-sm",children:"Total Balance"}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsx("button",{onClick:()=>$e(!q),className:"p-1.5 hover:bg-slate-700/50 rounded-lg text-slate-300 hover:text-white transition-all",title:"Toggle denomination",children:jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4"})})})]}),jsxRuntimeExports.jsx("div",{className:"flex items-baseline gap-2 mb-1",children:q?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-3xl max-[400px]:text-2xl max-[300px]:text-xl text-purple-400"}),jsxRuntimeExports.jsx("span",{className:"text-4xl max-[400px]:text-3xl max-[300px]:text-2xl font-bold text-white",children:v.toLocaleString()}),jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:"sats"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"text-3xl max-[400px]:text-2xl max-[300px]:text-xl text-purple-400",children:""}),jsxRuntimeExports.jsx("span",{className:"text-4xl max-[400px]:text-3xl max-[300px]:text-2xl font-bold text-white",children:D}),jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:"BTC"})]})}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1.5 text-sm text-slate-500 mb-6",children:q?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"text-base text-purple-400",children:""}),jsxRuntimeExports.jsxs("span",{children:[" ",D," BTC"]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-xs"}),jsxRuntimeExports.jsxs("span",{children:[" ",v.toLocaleString()," sats"]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between gap-3 text-xs mb-6",children:[jsxRuntimeExports.jsxs("button",{onClick:P,disabled:We,className:"px-3 py-1.5 bg-slate-800/50 hover:bg-slate-700/50 border border-slate-600/30 hover:border-purple-500/50 rounded-lg text-slate-300 hover:text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[We&&jsxRuntimeExports.jsxs("svg",{className:"animate-spin h-3 w-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),We?"Checking...":"Clean Balance"]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>p(!0),className:"px-3 py-1.5 bg-slate-800/50 hover:bg-slate-700/50 border border-slate-600/30 hover:border-purple-500/50 rounded-lg text-slate-300 hover:text-white transition-all",children:[Object.keys(e).length," Mints"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>y(!0),className:"px-3 py-1.5 bg-slate-800/50 hover:bg-slate-700/50 border border-slate-600/30 hover:border-purple-500/50 rounded-lg text-slate-300 hover:text-white transition-all",children:[t.length," Proofs"]})]})]}),t.length>=1e3&&jsxRuntimeExports.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 mb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-yellow-500 text-lg",children:""}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h4",{className:"font-bold text-yellow-500 mb-1",children:"Too Many Proofs"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-yellow-200 mb-3",children:["You have ",t.length," proofs. Consolidate them to reduce sync size and improve performance."]}),jsxRuntimeExports.jsx("button",{onClick:_e,disabled:We,className:"px-4 py-2 bg-yellow-500 hover:bg-yellow-600 disabled:bg-yellow-700 text-black font-bold rounded-lg transition-colors disabled:cursor-not-allowed",children:We?"Consolidating...":"Consolidate Proofs"})]})]})}),n.length>0&&jsxRuntimeExports.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4 mb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-red-500 text-lg",children:""}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h4",{className:"font-bold text-red-500 mb-1",children:"Stuck Sends Detected"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-red-200 mb-3",children:["You have ",n.length," ",n.length===1?"send":"sends"," that failed to publish. The tokens are locked to recipients but not sent yet."]}),jsxRuntimeExports.jsxs("button",{onClick:()=>R(!0),className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white font-bold rounded-lg transition-colors",children:["Recover ",n.length," ",n.length===1?"Send":"Sends"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 flex-wrap",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>l(!0),className:"flex-1 bg-slate-900/50 hover:bg-slate-900/70 text-white py-2 px-4 rounded-xl font-medium transition-colors flex items-center justify-center gap-2 border border-white/10",children:[jsxRuntimeExports.jsx(ArrowDownLeft,{className:"w-4 h-4 text-green-400"}),"Receive"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>x(!0),className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-xl font-bold transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4"}),"Send"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-2 px-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"History (Nutzaps)"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500",children:"Latest 1000 transactions"})]}),r.filter(Fe=>Fe.amount>0).length===0?jsxRuntimeExports.jsx("div",{className:"p-8 text-center text-slate-500",children:"No transaction history found."}):r.filter(Fe=>Fe.amount>0).map(Fe=>{const Le=Fe.type==="receive"?Fe.sender:Fe.recipient,Ce=Le?je.get(Le):null;return jsxRuntimeExports.jsxs("button",{onClick:()=>k(Fe),className:"w-full text-left bg-slate-900 border border-slate-800 rounded-xl p-4 flex items-center justify-between hover:border-purple-500/50 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-full flex-shrink-0 ${Fe.type==="receive"?"bg-green-500/10 text-green-500":"bg-purple-500/10 text-purple-500"}`,children:Fe.type==="receive"?jsxRuntimeExports.jsx(ArrowDownLeft,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4"})}),Le?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[Ce?.picture?jsxRuntimeExports.jsx("img",{src:Ce.picture,alt:Ce.name,className:"w-8 h-8 rounded-full object-cover flex-shrink-0"}):jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-slate-500"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-400",children:Fe.type==="receive"?"from":"to"}),jsxRuntimeExports.jsx("span",{className:"font-bold text-white truncate",children:Ce?.name||`${Le.slice(0,8)}...${Le.slice(-6)}`}),Ce?.nip05&&jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-purple-400 flex-shrink-0"})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400",children:new Date(Fe.timestamp*1e3).toLocaleDateString()})]})]}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-white",children:Fe.type==="receive"?"Received NutZap":"Sent NutZap"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400",children:new Date(Fe.timestamp*1e3).toLocaleDateString()})]})]}),jsxRuntimeExports.jsx("div",{className:"text-right flex-shrink-0 ml-3",children:jsxRuntimeExports.jsxs("span",{className:`font-bold ${Fe.type==="receive"?"text-green-500":"text-white"}`,children:[Fe.type==="receive"?"+":"-",Fe.amount," sats"]})})]},Fe.id)})]}),jsxRuntimeExports.jsx(EcashReceiveModal,{isOpen:a,onClose:()=>{l(!1),Re()}}),jsxRuntimeExports.jsx(EcashSendModal,{isOpen:u,onClose:()=>{x(!1),Re()}}),jsxRuntimeExports.jsx(MintsModal,{isOpen:f,onClose:()=>p(!1)}),jsxRuntimeExports.jsx(ProofsModal,{isOpen:g,onClose:()=>y(!1)}),jsxRuntimeExports.jsx(PendingSendsModal,{isOpen:w,onClose:()=>R(!1)}),jsxRuntimeExports.jsx(EcashTransactionDetailsModal,{isOpen:!!I,onClose:()=>k(null),transaction:I}),W&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md p-6 shadow-2xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:W.spent===-1?" Check Failed":" Clean Complete"}),W.spent===-1?jsxRuntimeExports.jsx("p",{className:"text-slate-300 mb-6",children:"Failed to check proofs. Please try again."}):W.spent>0?jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-6",children:["Cleaned ",jsxRuntimeExports.jsx("span",{className:"text-red-400 font-bold",children:W.spent})," spent proofs!",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("span",{className:"text-green-400 font-bold",children:W.valid})," valid proofs remaining."]}):jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-6",children:["All ",jsxRuntimeExports.jsx("span",{className:"text-green-400 font-bold",children:W.valid})," proofs are valid!"]}),jsxRuntimeExports.jsx("button",{onClick:()=>Ye(null),className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white font-bold rounded-lg transition-colors",children:"Close"})]})}),Qe&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md p-6 shadow-2xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:Qe.success?" Consolidation Complete":" Consolidation Failed"}),Qe.success?jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-6",children:["Successfully consolidated ",jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:Qe.count})," proofs!",jsxRuntimeExports.jsx("br",{}),"Your wallet now has fewer, more efficient proofs."]}):jsxRuntimeExports.jsx("p",{className:"text-slate-300 mb-6",children:"Failed to consolidate proofs. Please try again."}),jsxRuntimeExports.jsx("button",{onClick:()=>it(null),className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white font-bold rounded-lg transition-colors",children:"Close"})]})})]})},WalletView=()=>{const[e,t]=reactExports.useState("bitcoin");return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"px-6 mb-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900/50 p-1 rounded-xl border border-slate-800 flex gap-1 relative",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>t("bitcoin"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-sm font-bold transition-all ${e==="bitcoin"?"bg-amber-500 text-slate-950 shadow-lg":"text-slate-400 hover:text-white"}`,children:[jsxRuntimeExports.jsx(Bitcoin,{className:"w-4 h-4"}),"Bitcoin"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>t("ecash"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-sm font-bold transition-all ${e==="ecash"?"bg-purple-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:[jsxRuntimeExports.jsx(Banknote,{className:"w-4 h-4"}),"eCash"]})]})}),jsxRuntimeExports.jsx("div",{className:"animate-in fade-in duration-300",children:e==="bitcoin"?jsxRuntimeExports.jsx(BitcoinWallet,{}):jsxRuntimeExports.jsx(EcashWallet,{})})]})},About=({onBack:e,onNavigateChangelog:t})=>{const[r,n]=reactExports.useState(null),[s,a]=reactExports.useState(!1),[l,u]=reactExports.useState(""),[x,f]=reactExports.useState(!1),[p,g]=reactExports.useState(!1),[y,w]=reactExports.useState(!1),[R,I]=reactExports.useState(!1),[k,je]=reactExports.useState([]),{eventCreatorMode:Ve,toggleEventCreatorMode:q}=useSettingsStore(),[$e,We]=reactExports.useState(0),[K,W]=reactExports.useState(0),[Ye,Qe]=reactExports.useState(()=>localStorage.getItem("dev-mode")==="true"),it="npub18n4ysp43ux5c98fs6h9c57qpr4p8r3j8f6e32v0vj8egzy878aqqyzzk9r",{currentKeypairId:ze,wallets:v,currentWalletId:D}=useWalletStore(),P=v.find(Ce=>Ce.id===D)?.keypairs.find(Ce=>Ce.id===ze);reactExports.useEffect(()=>{ProfileService.fetchProfile(it).then(n);try{const Ce=npubToBitcoinAddress(it);u(Ce)}catch{console.error("Failed to derive dev BTC address")}},[]),reactExports.useEffect(()=>{if(s&&P)try{const Ce=npubToBitcoinAddress(P.npub);fetchUTXOs(Ce).then(je)}catch(Ce){console.error(Ce)}},[s,P]);const Re=(Ce,L)=>{navigator.clipboard.writeText(Ce),L(!0),setTimeout(()=>L(!1),2e3)},Fe=(Ce,L=8)=>Ce.length<=L*2?Ce:`${Ce.slice(0,L)}...${Ce.slice(-L)}`,Le=()=>{const Ce=Date.now();if(Ce-K>5e3){We(1),W(Ce);return}const O=$e+1;if(We(O),W(Ce),O===5){const st=!Ye;if(Qe(st),localStorage.setItem("dev-mode",st.toString()),st)__vitePreload(()=>import("./eruda-BuUB97co.js").then(lt=>lt.e),[],import.meta.url).then(lt=>{lt.default.init(),console.log("[DevMode] Eruda console enabled")});else if(window.eruda){try{typeof window.eruda.destroy=="function"&&window.eruda.destroy()}catch(lt){console.warn("[DevMode] Eruda destroy failed:",lt)}setTimeout(()=>{const lt=document.getElementById("eruda");lt&&lt.remove()},100),console.log("[DevMode] Eruda console disabled")}We(0)}};return reactExports.useEffect(()=>{Ye&&__vitePreload(()=>import("./eruda-BuUB97co.js").then(Ce=>Ce.e),[],import.meta.url).then(Ce=>{Ce.default.init()})},[]),jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-md mx-auto space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-900 rounded-full transition-colors",children:jsxRuntimeExports.jsx(ArrowLeft,{className:"w-6 h-6 text-slate-400"})}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold",children:"About"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto bg-slate-900 rounded-2xl flex items-center justify-center border border-slate-800 shadow-xl overflow-hidden",children:jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"PWANS Logo",className:"w-full h-full object-cover"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-amber-500",children:"PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Progressive Web App Nostr Signer"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800 text-center",children:[jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-4",children:[jsxRuntimeExports.jsx("strong",{children:"PWANS"})," is a Progressive Web App Nostr Signer."]}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"It stores your nsec/keypair locally on your device and allows other Nostr applications to connect and sign events remotely via NIP-46. It also bridges Nostr to the real world with Bitcoin seamlessly"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 text-center",children:"Vibe Coded By"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-full bg-slate-800 overflow-hidden border-2 border-amber-500/20",children:r?.picture?jsxRuntimeExports.jsx("img",{src:r.picture,alt:"Dev",className:"w-full h-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-2xl font-bold",children:"?"})}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h4",{className:"font-bold text-lg text-white",children:r?.name||"Unknown Developer"}),r?.nip05&&jsxRuntimeExports.jsxs("div",{className:"text-amber-500 text-sm flex items-center justify-center gap-1",children:[jsxRuntimeExports.jsx("span",{children:r.nip05}),jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3 h-3"})]})]}),jsxRuntimeExports.jsxs("div",{className:"w-full space-y-3 mt-2",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-3 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 font-bold",children:"Nostr Public Key"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>w(!y),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(QrCode,{className:"w-3.5 h-3.5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>Re(it,f),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:x?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-3.5 h-3.5"})})]})]}),y?jsxRuntimeExports.jsx("div",{className:"flex justify-center py-2 bg-white rounded-lg mb-2",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:it,size:150})}):jsxRuntimeExports.jsx("div",{className:"font-mono text-xs text-slate-300 text-center break-all",children:Fe(it,12)})]}),l&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-3 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 font-bold",children:"Bitcoin Address"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>I(!R),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(QrCode,{className:"w-3.5 h-3.5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>Re(l,g),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:p?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-3.5 h-3.5"})})]})]}),R?jsxRuntimeExports.jsx("div",{className:"flex justify-center py-2 bg-white rounded-lg mb-2",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:l,size:150})}):jsxRuntimeExports.jsx("div",{className:"font-mono text-xs text-amber-500/80 text-center break-all",children:Fe(l,12)})]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>a(!0),className:"w-full py-3 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white font-bold rounded-xl shadow-lg shadow-amber-500/20 transition-all flex items-center justify-center gap-2 mt-2",children:[jsxRuntimeExports.jsx(Heart,{className:"w-5 h-5 fill-white"}),"Tip Developer"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"text-center pb-8 space-y-3",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsxs("button",{onClick:()=>q(),className:"bg-slate-900 border border-slate-800 rounded-lg p-4 flex items-center gap-4 transition-colors hover:bg-slate-800",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Event Creator Mode"}),jsxRuntimeExports.jsx("div",{className:`relative w-14 h-7 rounded-md transition-all duration-300 ${Ve?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:jsxRuntimeExports.jsx("div",{className:`absolute top-0.5 left-0.5 w-6 h-6 bg-white rounded-md shadow-lg transition-all duration-300 flex items-center justify-center ${Ve?"translate-x-7":"translate-x-0"}`,children:Ve?jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]})}),jsxRuntimeExports.jsxs("p",{className:"text-slate-500 text-xs max-w-xs mx-auto leading-relaxed",children:[jsxRuntimeExports.jsx("strong",{children:"Disclaimer:"})," PWANS and its creator(s) hold no responsibility for any lost or compromised accounts or funds. The user holds full responsibility for how they use this PWA"]}),jsxRuntimeExports.jsxs("p",{className:"text-slate-600 text-xs font-mono cursor-pointer select-none",onClick:Le,children:["v1.0.2 ",Ye&&""]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-amber-500 text-xs hover:text-amber-400 transition-colors underline",children:"Changelog"})]})]}),s&&jsxRuntimeExports.jsx(SendModal,{isOpen:s,onClose:()=>a(!1),utxos:k,onSuccess:()=>a(!1),initialRecipient:l})]})},Changelog=({onBack:e})=>jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center gap-4 mb-8 border-b border-slate-800 pb-4",children:[jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(ArrowLeft,{className:"w-6 h-6"})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-amber-500",children:"Changelog"})]}),jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-amber-500",children:"v1.0.2"}),jsxRuntimeExports.jsxs("div",{className:"relative flex items-center justify-center",children:[jsxRuntimeExports.jsx("div",{className:"absolute w-3 h-3 bg-green-500 rounded-full animate-ping opacity-75"}),jsxRuntimeExports.jsx("div",{className:"relative w-2 h-2 bg-green-500 rounded-full"})]}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-400",children:"Latest"})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-xs mb-4",children:"12 December 2025"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-3 text-slate-300",children:[jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"eCash Wallet:"})," Full Cashu implementation with NutZap support for public ecash transfers over Nostr, private token sends, and Lightning integration for seamless on/off-ramping"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Multi-Mint Support:"})," Manage funds across multiple Cashu mints with automatic mint discovery via NIP-87 and intelligent multi-mint sending"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Robust Send System:"})," Pending sends tracking with automatic retry for failed NutZap publications, ensuring no funds are lost during network issues"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Cross-Mint Transfers:"})," Move funds between different mints using Lightning as the bridge for flexible mint management"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Enhanced UI/UX:"})," Comprehensive improvements across send/receive flows, wallet management, and transaction history with better visual feedback and error handling"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("p",{className:"text-slate-300 text-center mb-4",children:"Appreciate this release? Want to help feed the dev(s) behind it?"}),jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsxs("button",{onClick:e,className:"bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-6 rounded-lg transition-colors flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:""}),"Support"]})}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-xs text-center mt-3",children:"Send a tip on the About page"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-bold text-amber-500 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:""}),"Future Scope"]}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-xs mb-4",children:"Potential features that might come in future updates (no promises!)"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-3 text-slate-300",children:[jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Bitcoin Cold Signing:"})," Offline signing of Bitcoin transactions similarly to Nostr events"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"DNN Support:"})," Native implementation for Decentralized Name/ID resolution"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3 mb-4",children:jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-slate-400",children:"v1.0.1"})}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-xs mb-4",children:"07 December 2025"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-3 text-slate-300",children:[jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Unified Connection UI:"}),' Merged "Connect App" and "Bunker" views into a single, streamlined interface for easier access']})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Event Creator Mode:"})," Create, sign, and broadcast arbitrary events directly (enable in About page)"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Offline Cold Signing:"}),' "Sign & Show QR" flow allows fully air-gapped signing. Import/Export events via file or Animated QRs to turn any device into a cold storage signer']})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"UX Polish:"})," Improved Npub truncation, copy buttons, and general UI refinements"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Connectivity Health Check:"}),' Improved detection of network changes and relay connection status to prevent stale "online" states']})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Manual Reconnect:"})," Added a refresh button on the dashboard to force valid connection checks and clear stale sockets"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Friendly Signing UI:"}),' Redesigned the signing request modal with a "Simple View" that uses human-readable descriptions and a toggle for technical details']})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Update Notifications:"})," Implemented new version detection with a reload prompt to easily update to the latest version"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Developer Mode:"})," Added developer mode to view detailed logs - enable by tapping the version number 5 times on the About page"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Auto-Approval Rules:"})," Added option to keep auto-approval rules when replacing an existing connection from the same client"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Relay Improvements:"})," Enhanced custom relay management and improved WebSocket connectivity for better reliability"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Bunker QR Code:"})," Added support for generating QR codes for your bunker connection string to easily connect other apps"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Auto-Block Action:"})," Added the ability to auto-block specific types of requests from apps, preventing them from prompting you again"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-slate-400",children:"v1.0.0"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-500",children:"Initial Release"})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-xs mb-4",children:"06 December 2025"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-3 text-slate-400",children:[jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-600 mt-1",children:""}),jsxRuntimeExports.jsx("span",{children:"Initial PWA release with NIP-46 remote signing support"})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-600 mt-1",children:""}),jsxRuntimeExports.jsx("span",{children:"Multi-wallet and multi-keypair management"})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-600 mt-1",children:""}),jsxRuntimeExports.jsx("span",{children:"Connection management with auto-approval rules"})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-600 mt-1",children:""}),jsxRuntimeExports.jsx("span",{children:"Custom relay support"})]})]})]})]})]}),ActivityLog=({onClose:e})=>{const{entries:t,clearLog:r}=useActivityLogStore(),[n,s]=reactExports.useState(new Set),[a,l]=reactExports.useState(!1),u=g=>{s(y=>{const w=new Set(y);return w.has(g)?w.delete(g):w.add(g),w})},x=()=>{r(),l(!1)},f=g=>({approved:"bg-green-500/10 text-green-400 border-green-500/20",rejected:"bg-red-500/10 text-red-400 border-red-500/20",published:"bg-blue-500/10 text-blue-400 border-blue-500/20",error:"bg-orange-500/10 text-orange-400 border-orange-500/20"})[g],p=g=>new Date(g).toLocaleString();return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl max-w-3xl w-full max-h-[80vh] border border-slate-800 shadow-2xl flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6 border-b border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(FileText,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Activity Log"})]}),jsxRuntimeExports.jsx("button",{onClick:e,className:"text-slate-400 hover:text-white transition-colors","aria-label":"Close",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsx("div",{className:"px-4 sm:px-6 pt-4 pb-2",children:jsxRuntimeExports.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3 text-sm text-blue-300",children:[jsxRuntimeExports.jsx("strong",{children:"Privacy:"})," Activity logs are stored locally on your device only. They include full event details for debugging purposes."]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-3",children:t.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12",children:[jsxRuntimeExports.jsx(FileText,{className:"w-12 h-12 text-slate-700 mx-auto mb-3"}),jsxRuntimeExports.jsx("p",{className:"text-slate-500",children:"No activity yet"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Events will appear here as you use the signer"})]}):t.map(g=>{const y=n.has(g.id);return jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg border border-slate-800",children:[jsxRuntimeExports.jsx("div",{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase border ${f(g.action)}`,children:g.action}),jsxRuntimeExports.jsx("span",{className:"text-sm font-mono text-white",children:g.method})]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-slate-500",children:[g.appName||"Unknown App","  ",g.appPubkey.slice(0,8),"...",g.appPubkey.slice(-8)]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-600 mt-1",children:p(g.timestamp)}),g.error&&jsxRuntimeExports.jsxs("div",{className:"text-xs text-red-400 mt-2 font-mono",children:["Error: ",g.error]})]}),g.event&&jsxRuntimeExports.jsx("button",{onClick:()=>u(g.id),className:"p-1.5 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors flex-shrink-0",title:y?"Collapse":"Expand",children:y?jsxRuntimeExports.jsx(ChevronDown,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4"})})]})}),y&&g.event&&jsxRuntimeExports.jsxs("div",{className:"border-t border-slate-800 p-4 bg-slate-900/50",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400 mb-2 font-bold uppercase tracking-wider",children:"Event Data"}),jsxRuntimeExports.jsx("pre",{className:"text-xs text-slate-300 font-mono overflow-x-auto bg-slate-950 p-3 rounded border border-slate-800",children:JSON.stringify(g.event,null,2)})]})]},g.id)})}),t.length>0&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6 border-t border-slate-800 bg-slate-950/50",children:[jsxRuntimeExports.jsxs("div",{className:"text-sm text-slate-400",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:t.length})," ",t.length===1?"entry":"entries"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>l(!0),className:"px-3 py-1.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-3.5 h-3.5"}),"Clear Log"]})]}),a&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center rounded-xl",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 max-w-sm mx-4 border border-slate-700",children:[jsxRuntimeExports.jsx("h4",{className:"text-lg font-bold text-white mb-2",children:"Clear Activity Log?"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-slate-400 mb-4",children:["This will permanently delete all ",t.length," log entries. This cannot be undone."]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>l(!1),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors",children:"Clear Log"})]})]})})]})})},ConnectedAppsList=()=>{const{connections:e,removeConnection:t,getRulesForConnection:r,removeRule:n}=useConnectionsStore(),{currentKeypairId:s}=useWalletStore(),[a,l]=reactExports.useState(null),[u,x]=reactExports.useState(!1),f=e.filter(y=>y.keypairId===s),p=y=>{t(y)},g=y=>{switch(y){case"connected":return jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4 text-green-400"});case"connecting":return jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 text-yellow-400 animate-spin"});case"error":case"disconnected":return jsxRuntimeExports.jsx(CircleX,{className:"w-4 h-4 text-red-400"});default:return null}};return f.length===0?null:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white",children:"Active Connections"}),jsxRuntimeExports.jsx("button",{onClick:()=>x(!0),className:"p-2 hover:bg-slate-800 rounded-lg text-slate-400 hover:text-white transition-colors",title:"Activity Log",children:jsxRuntimeExports.jsx(FileText,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:f.map(y=>jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 border border-slate-800 flex items-center justify-between group",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"font-bold text-white flex items-center gap-2",children:[y.name||"Unknown App",g(y.status)]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-slate-500 font-mono flex items-center gap-1",children:[y.signerPubkey.slice(0,8),"...",y.signerPubkey.slice(-8),y.startedVia==="nostrconnect"&&jsxRuntimeExports.jsx("span",{className:"bg-blue-500/10 text-blue-400 px-1.5 rounded text-[10px]",children:"CLIENT"}),y.startedVia==="bunker"&&jsxRuntimeExports.jsx("span",{className:"bg-purple-500/10 text-purple-400 px-1.5 rounded text-[10px]",children:"BUNKER"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>l(y.id),className:"p-2 hover:bg-slate-800 rounded-md text-slate-400 hover:text-white transition-colors",title:"Settings",children:jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:()=>p(y.id),className:"p-2 hover:bg-red-500/20 rounded-md text-slate-400 hover:text-red-400 transition-colors",title:"Disconnect",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]},y.id))})]}),a&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Connection Settings"}),jsxRuntimeExports.jsx("button",{onClick:()=>l(null),className:"text-slate-400 hover:text-white",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Auto-Approval Rules"}),r(a).length===0?jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 italic",children:"No active rules"}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:r(a).map(y=>jsxRuntimeExports.jsxs("div",{className:"bg-slate-800 rounded-lg p-3 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:`text-sm font-bold ${y.policy==="reject"?"text-red-400":"text-green-400"}`,children:y.kinds.map(w=>{const R=y.policy==="reject"?"Auto-Block":"Auto-Approve";return w===-4?`${R} NIP-04 Decryption`:w===-5?`${R} NIP-04 Encryption`:`${R} Kind ${w}`}).join(", ")}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-500",children:["Created ",new Date(y.createdAt).toLocaleDateString()]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>n(y.id),className:"p-1.5 hover:bg-red-500/20 rounded text-red-400 hover:text-red-300 transition-colors",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})]},y.id))})]}),jsxRuntimeExports.jsx("div",{className:"pt-4 border-t border-slate-800",children:jsxRuntimeExports.jsxs("button",{onClick:()=>{p(a),l(null)},className:"w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"}),"Disconnect App"]})})]})]})}),u&&jsxRuntimeExports.jsx(ActivityLog,{onClose:()=>x(!1)})]})},useClientConnections=(e,t)=>{const[r,n]=reactExports.useState(new Map),s=useConnectionsStore(x=>x.connections),a=reactExports.useRef(new Map),l=reactExports.useRef(new Set),u=reactExports.useRef(new Map);return reactExports.useEffect(()=>{if(!e||!t)return;(async()=>{const f=new Map(a.current);let p=!1;const g=s.filter(y=>y.keypairId===e.id);console.log(`[useClientConnections] Found ${g.length} connections for current keypair:`,g.map(y=>({id:y.id,name:y.name,signerPubkey:y.signerPubkey.slice(0,8),status:y.status})));for(const y of g){const w=u.current.get(y.id)||0;if(!f.has(y.id)&&!l.current.has(y.id)&&y.status!=="disconnected"&&w<3){l.current.add(y.id);try{console.log(`[useClientConnections] Initializing client for: ${y.name} (Attempt ${w+1}/3)`);const R=new ClientService(t,y.id,{signerPubkey:y.signerPubkey,relays:y.relays,secret:y.secret,name:y.name,appUrl:y.appUrl,startedVia:y.startedVia});await R.connect(),useConnectionsStore.getState().connections.find(k=>k.id===y.id)?(f.set(y.id,R),p=!0,u.current.delete(y.id)):R.disconnect()}catch(R){console.error("Failed to init client:",R),u.current.set(y.id,w+1)}finally{l.current.delete(y.id)}}}for(const[y]of f.entries())s.find(w=>w.id===y)||(console.log("[useClientConnections] Removing client for:",y),f.get(y)?.disconnect(),f.delete(y),p=!0,u.current.delete(y));p&&(a.current=f,n(new Map(f)))})()},[s,e,t]),{clients:r}},useRelayMonitor=e=>{const{relays:t,updateRelayStatus:r,incrementFailedAttempts:n}=useRelayStore(),s=reactExports.useRef(null),a=reactExports.useRef(Date.now());reactExports.useEffect(()=>{if(!e)return;const l=async(p=!1,g=!1)=>{const y=t.filter(w=>w.status==="disconnected"||w.status==="error");if(y.length>0&&(console.log("[RelayMonitor] Attempting to reconnect",y.length,"relays"),y.forEach(w=>{if(!(w.failedAttempts>=10)){r(w.url,"connecting");try{e.ndk?.pool?.relays?.get(w.url)?.connect()}catch{r(w.url,"error"),n(w.url)}}})),e.hasActiveSubscription&&e.isSubscriptionHealthy){const w=e.hasActiveSubscription(),R=e.isSubscriptionHealthy();if(!w)console.warn("[RelayMonitor]  No active subscription! Reconnecting..."),await e.reconnectSubscription();else if(!R||p||g){let I=!1;if(g)console.log("[RelayMonitor] Network recovery detected - TRIGGERING FORCE RECONNECT."),I=!0;else if(p){const k=Date.now()-a.current;k<6e4?(console.log(`[RelayMonitor] App backgrounded for ${Math.round(k/1e3)}s - skipping FORCE reconnect.`),I=!1):(console.log(`[RelayMonitor] App backgrounded for ${Math.round(k/1e3)}s - TRIGGERING FORCE RECONNECT.`),I=!0)}else I=!1;(!R||I)&&(console.warn(`[RelayMonitor]  ${g?"Network Recovery":I?"Deep Sleep Wakeup":"Subscription unhealthy"}. Reconnecting... (Force: ${I})`),await e.reconnectSubscription(I))}}a.current=Date.now()};s.current=setInterval(()=>l(!1),1e4);const u=()=>{document.visibilityState==="visible"?(console.log("[RelayMonitor] App became visible..."),l(!0)):a.current=Date.now()};document.addEventListener("visibilitychange",u);const x=()=>{console.log("[RelayMonitor] Network online - triggering health check..."),l(!0,!0)},f=()=>{console.warn("[RelayMonitor] Network offline - pausing active checks (logs will be silent)")};return window.addEventListener("online",x),window.addEventListener("offline",f),()=>{s.current&&clearInterval(s.current),document.removeEventListener("visibilitychange",u),window.removeEventListener("online",x),window.removeEventListener("offline",f)}},[e,t,r,n])},Dashboard=()=>{const{logout:e,decryptedKey:t}=useAuthStore(),{currentWalletId:r,wallets:n,currentKeypairId:s}=useWalletStore(),{requests:a}=useRequestStore(),[l,u]=reactExports.useState(""),[x,f]=reactExports.useState(navigator.onLine);reactExports.useEffect(()=>{const Le=()=>f(!0),Ce=()=>f(!1);return window.addEventListener("online",Le),window.addEventListener("offline",Ce),()=>{window.removeEventListener("online",Le),window.removeEventListener("offline",Ce)}},[]);const[p,g]=reactExports.useState("connections"),[y,w]=reactExports.useState(!1),[R,I]=reactExports.useState(!1),[k,je]=reactExports.useState(!1),[Ve,q]=reactExports.useState(null),$e=Le=>{q(Le)},[We,K]=reactExports.useState(!1),W=reactExports.useRef(null),{isOnline:Ye,relays:Qe}=useRelayStore(),it=n.find(Le=>Le.id===r),ze=it?.keypairs.find(Le=>Le.id===s),v=a.find(Le=>Le.source==="client")||a[0];useRelayMonitor(W.current),reactExports.useEffect(()=>{if(ze)try{const{data:Le}=nip19_exports$1.decode(ze.npub);u(`bunker://${Le}?relay=wss://relay.primal.net&relay=wss://relay.damus.io&relay=wss://nos.lol&relay=wss://relay.nostr.band`)}catch(Le){console.error("Invalid npub:",Le)}},[ze]),reactExports.useEffect(()=>{if(t&&!W.current){console.log("[Dashboard] Creating new SignerService instance");const Le=new SignerService(t);W.current=Le,Le.connect().catch(console.error);const Ce=L=>{const{url:O}=L.detail;console.log("[Dashboard] Received add-relay event for:",O),Le.addRelay(O)};return window.addEventListener("add-relay",Ce),()=>{console.log("[Dashboard] Cleaning up SignerService instance"),Le.disconnect(),W.current=null,window.removeEventListener("add-relay",Ce)}}else!t&&W.current&&(console.log("[Dashboard] Disconnecting SignerService due to no decryptedKey"),W.current.disconnect(),W.current=null,u(""))},[t]),reactExports.useEffect(()=>{window.history.pushState({dashboard:"root"},"");const Le=Ce=>{if(v){Fe(v.id,v.requestEventId,v.requestorPubkey),window.history.pushState({dashboard:"root"},"");return}if(k){je(!1),window.history.pushState({dashboard:"root"},"");return}if(R){I(!1),window.history.pushState({dashboard:"root"},"");return}if(y){w(!1),window.history.pushState({dashboard:"root"},"");return}if(p!=="connections"){g("connections"),window.history.pushState({dashboard:"root"},"");return}Ce.preventDefault(),window.history.pushState({dashboard:"root"},"")};return window.addEventListener("popstate",Le),()=>window.removeEventListener("popstate",Le)},[p,y,k,R,v]);const D=(Le,Ce)=>{window.history.pushState({view:Le},""),Ce(!0)},_e=()=>{window.history.pushState({view:"wallet"},""),g("wallet")},{clients:P}=useClientConnections(ze,t),Re=async(Le,Ce,L,O,st,lt=!1)=>{console.log("[Dashboard] handleApprove called with remember:",lt);const Xe=useRequestStore.getState().requests.find(dt=>dt.id===Le);if(Xe?.internal){console.log("[Dashboard] Processing INTERNAL request:",Le);try{if(O==="sign_event"&&W.current){const dt=await W.current.signEventInternal(st[0]);Xe.onSuccess&&Xe.onSuccess(dt)}}catch(dt){console.error("[Dashboard] Internal signing failed:",dt),Xe.onError&&Xe.onError(dt)}useRequestStore.getState().removeRequest(Le);return}if(lt){if(O==="sign_event")try{const dt=st[0],ar=JSON.parse(dt).kind;console.log("[Dashboard] Attempting to save auto-approval rule for kind:",ar),console.log("[Dashboard] Requestor pubkey:",L);let dr;if(v?.connectionId&&(dr=useConnectionsStore.getState().connections.find(ir=>ir.id===v.connectionId)),dr||(dr=useConnectionsStore.getState().connections.find(ir=>ir.signerPubkey===L)),dr){console.log("[Dashboard] Found connection:",dr.id,dr.name);const{addRule:ir}=useConnectionsStore.getState(),pt={id:Math.random().toString(36).substring(7),connectionId:dr.id,kinds:[ar],createdAt:Date.now()};console.log("[Dashboard] Calling addRule with:",pt),ir(pt),console.log(`[Dashboard]  Rule saved for kind ${ar}`)}else console.error("[Dashboard]  Connection not found for requestor:",L)}catch(dt){console.error("[Dashboard] Failed to save auto-approval rule:",dt)}else if(O==="nip04_decrypt"||O==="nip04_encrypt")try{console.log(`[Dashboard] Attempting to save auto-approval rule for ${O}`),console.log("[Dashboard] Requestor pubkey:",L);let dt;if(v?.connectionId&&(dt=useConnectionsStore.getState().connections.find(er=>er.id===v.connectionId)),dt||(dt=useConnectionsStore.getState().connections.find(er=>er.signerPubkey===L)),dt){console.log("[Dashboard] Found connection:",dt.id,dt.name);const{addRule:er}=useConnectionsStore.getState(),ar=O==="nip04_decrypt"?-4:-5,dr={id:Math.random().toString(36).substring(7),connectionId:dt.id,kinds:[ar],createdAt:Date.now()};console.log("[Dashboard] Calling addRule with:",dr),er(dr),console.log(`[Dashboard]  Rule saved for ${O}`);const ir=useRequestStore.getState().requests;console.log("[Dashboard] Checking pending requests for auto-approval:",ir.length);const pt=ir.filter(tr=>tr.id!==Le&&tr.method===O&&(tr.connectionId===dt.id||tr.requestorPubkey===L));pt.length>0&&(console.log(`[Dashboard] Found ${pt.length} pending requests to auto-approve`),setTimeout(async()=>{for(const tr of pt)if(console.log(`[Dashboard] Auto-approving pending request: ${tr.id}`),tr.connectionId){const sr=P.get(tr.connectionId);sr&&await sr.approveRequest(tr.id,tr.requestEventId,tr.requestorPubkey,tr.method,tr.params)}else W.current?.approveRequest(tr.id,tr.requestEventId,tr.requestorPubkey,tr.method,tr.params),useRequestStore.getState().removeRequest(tr.id)},100))}else console.error("[Dashboard]  Connection not found for requestor:",L)}catch(dt){console.error("[Dashboard] Failed to save auto-approval rule:",dt)}}if(O==="connect")try{const dt=useConnectionsStore.getState();dt.connections.find(ar=>ar.signerPubkey===L)||(console.log("[Dashboard] Saving new connection from connect request"),dt.addConnection({id:Math.random().toString(36).substring(7),keypairId:s,signerPubkey:L,name:"App "+L.slice(0,4),relays:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io"],secret:st[1]||"",status:"connected",startedVia:"bunker",connectedAt:Date.now()}))}catch(dt){console.error("[Dashboard] Failed to save connection:",dt)}if(v?.connectionId){const dt=P.get(v.connectionId);if(dt){console.log("[Dashboard] Approving via ClientService for connection:",v.connectionId),dt.approveRequest(Le,Ce,L,O,st,v.encryptionMethod);return}else console.warn("[ClientService] ClientService not found for connection:",v.connectionId)}console.log("[Dashboard] Approving via SignerService"),W.current?.approveRequest(Le,Ce,L,O,st),useRequestStore.getState().removeRequest(Le)},Fe=(Le,Ce,L,O=!1)=>{if(O&&v)try{const{method:st,params:lt}=v,Xe=useConnectionsStore.getState(),dt=v.connectionId?Xe.connections.find(er=>er.id===v.connectionId):Xe.connections.find(er=>er.signerPubkey===L);if(dt){let er=[];st==="sign_event"?er=[JSON.parse(lt[0]).kind]:st==="nip04_decrypt"?er=[-4]:st==="nip04_encrypt"&&(er=[-5]),er.length>0&&(Xe.addRule({id:Math.random().toString(36).substring(7),connectionId:dt.id,kinds:er,policy:"reject",createdAt:Date.now()}),console.log(`[Dashboard]  Auto-Block rule created for ${dt.name} (Kinds: ${er.join(", ")})`))}}catch(st){console.error("[Dashboard] Failed to save auto-block rule:",st)}if(v?.connectionId){const st=P.get(v.connectionId);if(st){console.log("[Dashboard] Rejecting via ClientService for connection:",v.connectionId),st.rejectRequest(Le,Ce,L);return}}W.current?.rejectRequest(Le,Ce,L),useRequestStore.getState().removeRequest(Le)};return reactExports.useEffect(()=>{if(!v)return;const{method:Le,params:Ce,connectionId:L,requestorPubkey:O,id:st}=v;if(Le!=="nip04_decrypt"&&Le!=="nip04_encrypt"&&Le!=="sign_event"&&Le!=="get_public_key")return;const lt=useConnectionsStore.getState();let Xe;if(L?Xe=lt.connections.find(dt=>dt.id===L):Xe=lt.connections.find(dt=>dt.signerPubkey===O),Xe){const dt=lt.getRulesForConnection(Xe.id);let er;if(Le==="sign_event")try{er=JSON.parse(Ce[0]).kind}catch{return}else if(Le==="nip04_decrypt")er=-4;else if(Le==="nip04_encrypt")er=-5;else if(Le==="get_public_key"){console.log(`[Dashboard]  Safety Net: Auto-approving get_public_key request ${st} for known connection`),Re(st,v.requestEventId,O,Le,Ce,!1);return}if(er!==void 0){const ar=dt.filter(dr=>dr.kinds.includes(er));ar.length>0&&(ar.some(ir=>ir.policy==="reject")?(console.log(`[Dashboard]  Safety Net: Auto-blocking ${Le} request ${st} due to existing rule`),Fe(st,v.requestEventId,O,!1)):(console.log(`[Dashboard]  Safety Net: Auto-approving ${Le} request ${st} due to existing rule`),Re(st,v.requestEventId,O,Le,Ce,!1)))}}},[v]),y?jsxRuntimeExports.jsx(WalletManager,{onBack:()=>w(!1)}):p==="about"?jsxRuntimeExports.jsx(About,{onBack:()=>g("connections"),onNavigateChangelog:()=>g("changelog")}):p==="changelog"?jsxRuntimeExports.jsx(Changelog,{onBack:()=>g("about")}):jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center mb-8 border-b border-slate-800 pb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{window.history.pushState({view:"about"},""),g("about")},className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"Logo",className:"w-8 h-8 rounded-lg"}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold text-amber-500",children:"PWANS"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>D("relay-manager",je),className:`flex items-center gap-1 text-xs px-2 py-1 rounded-full transition-colors cursor-pointer hover:opacity-80 ${Ye()&&x?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,title:`${Qe.filter(Le=>Le.status==="connected").length}/${Qe.length} relays connected - Click to manage`,children:[Ye()&&x?jsxRuntimeExports.jsx(Wifi,{className:"w-3 h-3"}):jsxRuntimeExports.jsx(WifiOff,{className:"w-3 h-3"}),Ye()&&x?"Online":"Offline"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[it&&jsxRuntimeExports.jsxs("button",{onClick:()=>D("wallet-manager",w),className:"flex items-center gap-2 px-3 py-2 bg-slate-900 hover:bg-slate-800 rounded-lg transition-colors border border-slate-800",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-4 h-4 text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:it.name})]}),jsxRuntimeExports.jsx("button",{onClick:async()=>{if(W.current&&!We){K(!0);try{await W.current.reconnectSubscription(!0),console.log("Manually reconnected")}catch(Le){console.error("Manual reconnect failed",Le)}finally{K(!1)}}},className:"p-2 hover:bg-slate-900 rounded-lg transition-colors text-slate-400 hover:text-white",title:"Force Reconnect",disabled:We,children:jsxRuntimeExports.jsx(RefreshCw,{className:`w-5 h-5 ${We?"animate-spin text-amber-500":""}`})}),jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-900 rounded-lg transition-colors",title:"Lock Wallet",children:jsxRuntimeExports.jsx(LogOut,{className:"w-5 h-5 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("main",{className:"max-w-2xl mx-auto space-y-6 pb-24",children:[ze&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-4 border border-slate-800 flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative rounded-lg bg-amber-500 text-slate-950 flex-shrink-0 overflow-hidden cursor-pointer group w-10 h-10",onClick:async Le=>{if(Le.stopPropagation(),!ze||!it)return;const Ce=Le.currentTarget;Ce.classList.add("opacity-50");try{const{ProfileService:L}=await __vitePreload(async()=>{const{ProfileService:lt}=await Promise.resolve().then(()=>profile);return{ProfileService:lt}},void 0,import.meta.url),{updateKeypair:O}=useWalletStore.getState(),st=await L.fetchProfile(ze.npub);st&&O(it.id,ze.id,{profile:{...st,lastFetched:Date.now()}})}catch(L){console.error("[Dashboard] Failed to refresh profile:",L)}finally{Ce.classList.remove("opacity-50")}},title:"Click to refresh profile",children:[ze.profile?.picture?jsxRuntimeExports.jsx("img",{src:ze.profile.picture,alt:ze.profile.name||"Profile",className:"w-full h-full object-cover",onError:Le=>{Le.currentTarget.style.display="none",Le.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx("div",{className:`w-full h-full flex items-center justify-center bg-amber-500 ${ze.profile?.picture?"hidden":""}`,children:jsxRuntimeExports.jsx(User,{className:"w-6 h-6 text-slate-950"})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 text-white"})})]}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg truncate",children:ze.profile?.name||ze.name}),jsxRuntimeExports.jsx("button",{onClick:()=>D("keypair-switcher",I),className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Switch Address",children:jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex-shrink-0",children:"Active"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400 font-mono truncate flex-1",children:ze.npub.length>16?`${ze.npub.slice(0,8)}...${ze.npub.slice(-6)}`:ze.npub}),jsxRuntimeExports.jsx("button",{onClick:()=>{navigator.clipboard.writeText(ze.npub),q("Npub copied!")},className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Copy npub",children:jsxRuntimeExports.jsx(Copy,{className:"w-3.5 h-3.5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>q("QR feature coming soon!"),className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Show QR code",children:jsxRuntimeExports.jsx(QrCode,{className:"w-3.5 h-3.5"})})]})]})]}),R&&it&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:()=>I(!1),children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",onClick:Le=>Le.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Switch Address"}),jsxRuntimeExports.jsx("button",{onClick:()=>I(!1),className:"p-1 hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:it.keypairs.map(Le=>jsxRuntimeExports.jsxs("button",{onClick:async()=>{const{password:Ce}=useAuthStore.getState();if(!Ce){console.error("[Dashboard] No cached password for keypair switch");return}try{const{CryptoService:L}=await __vitePreload(async()=>{const{CryptoService:lt}=await Promise.resolve().then(()=>crypto$2);return{CryptoService:lt}},void 0,import.meta.url),O=await L.decrypt(Le.encryptedNsec,Ce),st=L.nsecToHex(O);useWalletStore.getState().setCurrentKeypair(Le.id),useAuthStore.getState().unlock(st,Ce),I(!1)}catch(L){console.error("[Dashboard] Failed to switch keypair:",L)}},className:`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${s===Le.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-950 border-slate-800 hover:border-slate-700 hover:bg-slate-900"}`,children:[jsxRuntimeExports.jsxs("div",{className:`p-1 rounded-lg flex-shrink-0 ${s===Le.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:[Le.profile?.picture?jsxRuntimeExports.jsx("img",{src:Le.profile.picture,alt:Le.profile.name||"Profile",className:"w-8 h-8 rounded-lg object-cover",onError:Ce=>{Ce.currentTarget.style.display="none",Ce.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx(User,{className:`w-8 h-8 ${Le.profile?.picture?"hidden":""}`})]}),jsxRuntimeExports.jsxs("div",{className:"text-left flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-white truncate",children:Le.profile?.name||Le.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400 font-mono truncate",children:Le.npub})]}),s===Le.id&&jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5 text-amber-500"})]},Le.id))})]})}),p==="connections"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[useSettingsStore.getState().eventCreatorMode&&jsxRuntimeExports.jsx(EventCreator,{onBroadcastSuccess:()=>$e("Event published successfully!")}),jsxRuntimeExports.jsx("div",{className:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden p-6",children:jsxRuntimeExports.jsx(ConnectSigner,{bunkerURI:l,onBroadcastSuccess:()=>$e("Event published successfully!")})}),jsxRuntimeExports.jsx(ConnectedAppsList,{})]}),p==="wallet"&&jsxRuntimeExports.jsx(WalletView,{})]}),jsxRuntimeExports.jsx(BottomNav,{currentView:p,onChange:Le=>{Le==="wallet"?_e():g("connections")}}),v&&jsxRuntimeExports.jsx(RequestModal,{request:v,onApprove:Le=>Re(v.id,v.requestEventId,v.requestorPubkey,v.method,v.params,Le),onReject:Le=>Fe(v.id,v.requestEventId,v.requestorPubkey,Le)}),k&&jsxRuntimeExports.jsx(RelayManager,{onClose:()=>je(!1)}),Ve&&jsxRuntimeExports.jsx(Toast,{message:Ve,onClose:()=>q(null)})]})},PersistenceManager=()=>{const{publicKey:e,isUnlocked:t}=useAuthStore();return reactExports.useEffect(()=>{const r=useEcashStore.subscribe(()=>{t&&e&&useEcashStore.getState().saveSession(e)});return()=>{r()}},[e,t]),null},DisclaimerModal=({onAgree:e})=>jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-[100]",children:jsxRuntimeExports.jsx("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center text-center space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-amber-500/10 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(TriangleAlert,{className:"w-8 h-8 text-amber-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Please read this important disclaimer before continuing."})]}),jsxRuntimeExports.jsx("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800 text-left",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm leading-relaxed",children:["PWANS and its creator(s) hold ",jsxRuntimeExports.jsx("strong",{children:"no responsibility"})," for any lost or compromised accounts or funds.",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),"This is a self-custodial application. ",jsxRuntimeExports.jsx("strong",{children:"You"})," hold full responsibility for how you use this PWA and for securing your own keys."]})}),jsxRuntimeExports.jsxs("button",{onClick:e,className:"w-full py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5"}),"I Understand and Agree"]})]})})});function registerSW(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:s,onRegisteredSW:a,onRegisterError:l}=e;let u,x,f;const p=async(y=!0)=>{await x,f?.()};async function g(){if("serviceWorker"in navigator){if(u=await __vitePreload(async()=>{const{Workbox:y}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:y}},[],import.meta.url).then(({Workbox:y})=>new y("./sw.js",{scope:"./",type:"classic"})).catch(y=>{l?.(y)}),!u)return;f=()=>{u?.messageSkipWaiting()};{let y=!1;const w=()=>{y=!0,u?.addEventListener("controlling",R=>{R.isUpdate&&window.location.reload()}),r?.()};u.addEventListener("installed",R=>{typeof R.isUpdate>"u"?typeof R.isExternal<"u"&&R.isExternal?w():!y&&n?.():R.isUpdate||n?.()}),u.addEventListener("waiting",w)}u.register({immediate:t}).then(y=>{a?a("./sw.js",y):s?.(y)}).catch(y=>{l?.(y)})}}return x=g(),p}function useRegisterSW(e={}){const{immediate:t=!0,onNeedRefresh:r,onOfflineReady:n,onRegistered:s,onRegisteredSW:a,onRegisterError:l}=e,[u,x]=reactExports.useState(!1),[f,p]=reactExports.useState(!1),[g]=reactExports.useState(()=>registerSW({immediate:t,onOfflineReady(){p(!0),n?.()},onNeedRefresh(){x(!0),r?.()},onRegistered:s,onRegisteredSW:a,onRegisterError:l}));return{needRefresh:[u,x],offlineReady:[f,p],updateServiceWorker:g}}const UpdatePrompt=()=>{const[e,t]=reactExports.useState(!1),[r,n]=reactExports.useState(!1),{needRefresh:[s,a],updateServiceWorker:l}=useRegisterSW({onRegistered(f){if(console.log("[PWA] Service Worker registered:",f),f&&(console.log("[PWA] Checking for updates immediately..."),f.update().catch(p=>console.error("[PWA] Update check failed:",p))),f){const p=setInterval(()=>{console.log("[PWA] Periodic update check..."),f.update().catch(g=>console.error("[PWA] Periodic update check failed:",g))},6e4);return()=>clearInterval(p)}},onRegisterError(f){console.error("[PWA] Service Worker registration error:",f)}});reactExports.useEffect(()=>{s&&(console.log("[PWA] Update available! Showing prompt..."),t(!0))},[s]);const u=async()=>{n(!0),t(!1),a(!1);try{if(l&&await l(!0),"serviceWorker"in navigator){const f=await navigator.serviceWorker.getRegistrations();for(const p of f)await p.unregister()}if("caches"in window){const f=await caches.keys();await Promise.all(f.map(p=>caches.delete(p)))}window.location.reload()}catch(f){console.error("[PWA] Update failed:",f),t(!0),n(!1)}},x=()=>{t(!1),a(!1)};return e?jsxRuntimeExports.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-md z-50 animate-slide-up",children:jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-amber-500 to-amber-600 rounded-xl shadow-2xl border border-amber-400/20 p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 mt-0.5",children:jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-5 h-5 text-white"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("h3",{className:"text-white font-bold text-sm mb-1",children:" New Version Available!"}),jsxRuntimeExports.jsx("p",{className:"text-amber-50 text-xs mb-3",children:"A new version of PWANS is ready. Reload to get the latest features and improvements."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:u,disabled:r,className:"flex-1 bg-white hover:bg-amber-50 text-amber-600 font-bold py-2 px-4 rounded-lg transition-colors text-sm flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[jsxRuntimeExports.jsx(RefreshCw,{className:`w-4 h-4 ${r?"animate-spin":""}`}),r?"Updating...":"Reload Now"]}),jsxRuntimeExports.jsx("button",{onClick:x,disabled:r,className:"bg-white/10 hover:bg-white/20 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Dismiss",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})]})]})]})})}):null};function promisifyRequest(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function createStore(e,t){let r;const n=()=>{if(r)return r;const s=indexedDB.open(e);return s.onupgradeneeded=()=>s.result.createObjectStore(t),r=promisifyRequest(s),r.then(a=>{a.onclose=()=>r=void 0},()=>{}),r};return(s,a)=>n().then(l=>a(l.transaction(t,s).objectStore(t)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get(e,t=defaultGetStore()){return t("readonly",r=>promisifyRequest(r.get(e)))}function set(e,t,r=defaultGetStore()){return r("readwrite",n=>(n.put(t,e),promisifyRequest(n.transaction)))}function del(e,t=defaultGetStore()){return t("readwrite",r=>(r.delete(e),promisifyRequest(r.transaction)))}function App(){const{isUnlocked:e}=useAuthStore(),[t,r]=reactExports.useState(!1),[n,s]=reactExports.useState(!0);reactExports.useEffect(()=>{(async()=>{try{if(await get("disclaimer_accepted")){s(!1);return}const x=await get("wallet-storage");if(x)try{const f=JSON.parse(x);if(f.state&&f.state.wallets&&f.state.wallets.length>0){await set("disclaimer_accepted","true"),s(!1);return}}catch(f){console.error("Failed to parse wallet storage:",f)}r(!0)}catch(u){console.error("Error checking disclaimer status:",u)}finally{s(!1)}})()},[]);const a=async()=>{await set("disclaimer_accepted","true"),r(!1)};return n?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-8 h-8 text-amber-500 animate-spin"})}):t?jsxRuntimeExports.jsx(DisclaimerModal,{onAgree:a}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(PersistenceManager,{}),e?jsxRuntimeExports.jsx(Dashboard,{}):jsxRuntimeExports.jsx(Login,{}),jsxRuntimeExports.jsx(UpdatePrompt,{})]})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));export{Buffer as B,Nip61Service as N,getDefaultExportFromCjs$1 as a,NDKPrivateKeySigner as b,NDK as c,del as d,NDKEvent as e,get as g,process$1 as p,set as s};
