function _mergeNamespaces(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const c=Object.getOwnPropertyDescriptor(r,o);c&&Object.defineProperty(e,o,c.get?c:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production={};var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,o,c){var l=null;if(c!==void 0&&(l=""+c),o.key!==void 0&&(l=""+o.key),"key"in o){c={};for(var x in o)x!=="key"&&(c[x]=o[x])}else c=o;return o=c.ref,{$$typeof:e,type:r,key:l,ref:o!==void 0?o:null,props:c}}return reactJsxRuntime_production.Fragment=t,reactJsxRuntime_production.jsx=n,reactJsxRuntime_production.jsxs=n,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=x,base64Js.toByteArray=m,base64Js.fromByteArray=y;for(var e=[],t=[],n=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,c=r.length;o<c;++o)e[o]=r[o],t[r.charCodeAt(o)]=o;t[45]=62,t[95]=63;function l(w){var v=w.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _=w.indexOf("=");_===-1&&(_=v);var F=_===v?0:4-_%4;return[_,F]}function x(w){var v=l(w),_=v[0],F=v[1];return(_+F)*3/4-F}function f(w,v,_){return(v+_)*3/4-_}function m(w){var v,_=l(w),F=_[0],H=_[1],Y=new n(f(w,F,H)),T=0,L=H>0?F-4:F,N;for(N=0;N<L;N+=4)v=t[w.charCodeAt(N)]<<18|t[w.charCodeAt(N+1)]<<12|t[w.charCodeAt(N+2)]<<6|t[w.charCodeAt(N+3)],Y[T++]=v>>16&255,Y[T++]=v>>8&255,Y[T++]=v&255;return H===2&&(v=t[w.charCodeAt(N)]<<2|t[w.charCodeAt(N+1)]>>4,Y[T++]=v&255),H===1&&(v=t[w.charCodeAt(N)]<<10|t[w.charCodeAt(N+1)]<<4|t[w.charCodeAt(N+2)]>>2,Y[T++]=v>>8&255,Y[T++]=v&255),Y}function E(w){return e[w>>18&63]+e[w>>12&63]+e[w>>6&63]+e[w&63]}function g(w,v,_){for(var F,H=[],Y=v;Y<_;Y+=3)F=(w[Y]<<16&16711680)+(w[Y+1]<<8&65280)+(w[Y+2]&255),H.push(E(F));return H.join("")}function y(w){for(var v,_=w.length,F=_%3,H=[],Y=16383,T=0,L=_-F;T<L;T+=Y)H.push(g(w,T,T+Y>L?L:T+Y));return F===1?(v=w[_-1],H.push(e[v>>2]+e[v<<4&63]+"==")):F===2&&(v=(w[_-2]<<8)+w[_-1],H.push(e[v>>10]+e[v>>4&63]+e[v<<2&63]+"=")),H.join("")}return base64Js}var ieee754={};var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(e,t,n,r,o){var c,l,x=o*8-r-1,f=(1<<x)-1,m=f>>1,E=-7,g=n?o-1:0,y=n?-1:1,w=e[t+g];for(g+=y,c=w&(1<<-E)-1,w>>=-E,E+=x;E>0;c=c*256+e[t+g],g+=y,E-=8);for(l=c&(1<<-E)-1,c>>=-E,E+=r;E>0;l=l*256+e[t+g],g+=y,E-=8);if(c===0)c=1-m;else{if(c===f)return l?NaN:(w?-1:1)*(1/0);l=l+Math.pow(2,r),c=c-m}return(w?-1:1)*l*Math.pow(2,c-r)},ieee754.write=function(e,t,n,r,o,c){var l,x,f,m=c*8-o-1,E=(1<<m)-1,g=E>>1,y=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=r?0:c-1,v=r?1:-1,_=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(x=isNaN(t)?1:0,l=E):(l=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-l))<1&&(l--,f*=2),l+g>=1?t+=y/f:t+=y*Math.pow(2,1-g),t*f>=2&&(l++,f/=2),l+g>=E?(x=0,l=E):l+g>=1?(x=(t*f-1)*Math.pow(2,o),l=l+g):(x=t*Math.pow(2,g-1)*Math.pow(2,o),l=0));o>=8;e[n+w]=x&255,w+=v,x/=256,o-=8);for(l=l<<o|x,m+=o;m>0;e[n+w]=l&255,w+=v,l/=256,m-=8);e[n+w-v]|=_*128}),ieee754}var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,(function(e){const t=requireBase64Js(),n=requireIeee754(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=x,e.SlowBuffer=Y,e.INSPECT_MAX_BYTES=50;const o=2147483647;e.kMaxLength=o,x.TYPED_ARRAY_SUPPORT=c(),!x.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const G=new Uint8Array(1),B={foo:function(){return 42}};return Object.setPrototypeOf(B,Uint8Array.prototype),Object.setPrototypeOf(G,B),G.foo()===42}catch{return!1}}Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.buffer}}),Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.byteOffset}});function l(G){if(G>o)throw new RangeError('The value "'+G+'" is invalid for option "size"');const B=new Uint8Array(G);return Object.setPrototypeOf(B,x.prototype),B}function x(G,B,k){if(typeof G=="number"){if(typeof B=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(G)}return f(G,B,k)}x.poolSize=8192;function f(G,B,k){if(typeof G=="string")return y(G,B);if(ArrayBuffer.isView(G))return v(G);if(G==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof G);if(mt(G,ArrayBuffer)||G&&mt(G.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(mt(G,SharedArrayBuffer)||G&&mt(G.buffer,SharedArrayBuffer)))return _(G,B,k);if(typeof G=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const te=G.valueOf&&G.valueOf();if(te!=null&&te!==G)return x.from(te,B,k);const oe=F(G);if(oe)return oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof G[Symbol.toPrimitive]=="function")return x.from(G[Symbol.toPrimitive]("string"),B,k);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof G)}x.from=function(G,B,k){return f(G,B,k)},Object.setPrototypeOf(x.prototype,Uint8Array.prototype),Object.setPrototypeOf(x,Uint8Array);function m(G){if(typeof G!="number")throw new TypeError('"size" argument must be of type number');if(G<0)throw new RangeError('The value "'+G+'" is invalid for option "size"')}function E(G,B,k){return m(G),G<=0?l(G):B!==void 0?typeof k=="string"?l(G).fill(B,k):l(G).fill(B):l(G)}x.alloc=function(G,B,k){return E(G,B,k)};function g(G){return m(G),l(G<0?0:H(G)|0)}x.allocUnsafe=function(G){return g(G)},x.allocUnsafeSlow=function(G){return g(G)};function y(G,B){if((typeof B!="string"||B==="")&&(B="utf8"),!x.isEncoding(B))throw new TypeError("Unknown encoding: "+B);const k=T(G,B)|0;let te=l(k);const oe=te.write(G,B);return oe!==k&&(te=te.slice(0,oe)),te}function w(G){const B=G.length<0?0:H(G.length)|0,k=l(B);for(let te=0;te<B;te+=1)k[te]=G[te]&255;return k}function v(G){if(mt(G,Uint8Array)){const B=new Uint8Array(G);return _(B.buffer,B.byteOffset,B.byteLength)}return w(G)}function _(G,B,k){if(B<0||G.byteLength<B)throw new RangeError('"offset" is outside of buffer bounds');if(G.byteLength<B+(k||0))throw new RangeError('"length" is outside of buffer bounds');let te;return B===void 0&&k===void 0?te=new Uint8Array(G):k===void 0?te=new Uint8Array(G,B):te=new Uint8Array(G,B,k),Object.setPrototypeOf(te,x.prototype),te}function F(G){if(x.isBuffer(G)){const B=H(G.length)|0,k=l(B);return k.length===0||G.copy(k,0,0,B),k}if(G.length!==void 0)return typeof G.length!="number"||qe(G.length)?l(0):w(G);if(G.type==="Buffer"&&Array.isArray(G.data))return w(G.data)}function H(G){if(G>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return G|0}function Y(G){return+G!=G&&(G=0),x.alloc(+G)}x.isBuffer=function(B){return B!=null&&B._isBuffer===!0&&B!==x.prototype},x.compare=function(B,k){if(mt(B,Uint8Array)&&(B=x.from(B,B.offset,B.byteLength)),mt(k,Uint8Array)&&(k=x.from(k,k.offset,k.byteLength)),!x.isBuffer(B)||!x.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(B===k)return 0;let te=B.length,oe=k.length;for(let xe=0,pe=Math.min(te,oe);xe<pe;++xe)if(B[xe]!==k[xe]){te=B[xe],oe=k[xe];break}return te<oe?-1:oe<te?1:0},x.isEncoding=function(B){switch(String(B).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},x.concat=function(B,k){if(!Array.isArray(B))throw new TypeError('"list" argument must be an Array of Buffers');if(B.length===0)return x.alloc(0);let te;if(k===void 0)for(k=0,te=0;te<B.length;++te)k+=B[te].length;const oe=x.allocUnsafe(k);let xe=0;for(te=0;te<B.length;++te){let pe=B[te];if(mt(pe,Uint8Array))xe+pe.length>oe.length?(x.isBuffer(pe)||(pe=x.from(pe)),pe.copy(oe,xe)):Uint8Array.prototype.set.call(oe,pe,xe);else if(x.isBuffer(pe))pe.copy(oe,xe);else throw new TypeError('"list" argument must be an Array of Buffers');xe+=pe.length}return oe};function T(G,B){if(x.isBuffer(G))return G.length;if(ArrayBuffer.isView(G)||mt(G,ArrayBuffer))return G.byteLength;if(typeof G!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof G);const k=G.length,te=arguments.length>2&&arguments[2]===!0;if(!te&&k===0)return 0;let oe=!1;for(;;)switch(B){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":return rt(G).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k*2;case"hex":return k>>>1;case"base64":return Ke(G).length;default:if(oe)return te?-1:rt(G).length;B=(""+B).toLowerCase(),oe=!0}}x.byteLength=T;function L(G,B,k){let te=!1;if((B===void 0||B<0)&&(B=0),B>this.length||((k===void 0||k>this.length)&&(k=this.length),k<=0)||(k>>>=0,B>>>=0,k<=B))return"";for(G||(G="utf8");;)switch(G){case"hex":return P(this,B,k);case"utf8":case"utf-8":return M(this,B,k);case"ascii":return D(this,B,k);case"latin1":case"binary":return j(this,B,k);case"base64":return $(this,B,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,B,k);default:if(te)throw new TypeError("Unknown encoding: "+G);G=(G+"").toLowerCase(),te=!0}}x.prototype._isBuffer=!0;function N(G,B,k){const te=G[B];G[B]=G[k],G[k]=te}x.prototype.swap16=function(){const B=this.length;if(B%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let k=0;k<B;k+=2)N(this,k,k+1);return this},x.prototype.swap32=function(){const B=this.length;if(B%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let k=0;k<B;k+=4)N(this,k,k+3),N(this,k+1,k+2);return this},x.prototype.swap64=function(){const B=this.length;if(B%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let k=0;k<B;k+=8)N(this,k,k+7),N(this,k+1,k+6),N(this,k+2,k+5),N(this,k+3,k+4);return this},x.prototype.toString=function(){const B=this.length;return B===0?"":arguments.length===0?M(this,0,B):L.apply(this,arguments)},x.prototype.toLocaleString=x.prototype.toString,x.prototype.equals=function(B){if(!x.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B?!0:x.compare(this,B)===0},x.prototype.inspect=function(){let B="";const k=e.INSPECT_MAX_BYTES;return B=this.toString("hex",0,k).replace(/(.{2})/g,"$1 ").trim(),this.length>k&&(B+=" ... "),"<Buffer "+B+">"},r&&(x.prototype[r]=x.prototype.inspect),x.prototype.compare=function(B,k,te,oe,xe){if(mt(B,Uint8Array)&&(B=x.from(B,B.offset,B.byteLength)),!x.isBuffer(B))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof B);if(k===void 0&&(k=0),te===void 0&&(te=B?B.length:0),oe===void 0&&(oe=0),xe===void 0&&(xe=this.length),k<0||te>B.length||oe<0||xe>this.length)throw new RangeError("out of range index");if(oe>=xe&&k>=te)return 0;if(oe>=xe)return-1;if(k>=te)return 1;if(k>>>=0,te>>>=0,oe>>>=0,xe>>>=0,this===B)return 0;let pe=xe-oe,Ne=te-k;const Ie=Math.min(pe,Ne),$e=this.slice(oe,xe),Me=B.slice(k,te);for(let Le=0;Le<Ie;++Le)if($e[Le]!==Me[Le]){pe=$e[Le],Ne=Me[Le];break}return pe<Ne?-1:Ne<pe?1:0};function I(G,B,k,te,oe){if(G.length===0)return-1;if(typeof k=="string"?(te=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),k=+k,qe(k)&&(k=oe?0:G.length-1),k<0&&(k=G.length+k),k>=G.length){if(oe)return-1;k=G.length-1}else if(k<0)if(oe)k=0;else return-1;if(typeof B=="string"&&(B=x.from(B,te)),x.isBuffer(B))return B.length===0?-1:U(G,B,k,te,oe);if(typeof B=="number")return B=B&255,typeof Uint8Array.prototype.indexOf=="function"?oe?Uint8Array.prototype.indexOf.call(G,B,k):Uint8Array.prototype.lastIndexOf.call(G,B,k):U(G,[B],k,te,oe);throw new TypeError("val must be string, number or Buffer")}function U(G,B,k,te,oe){let xe=1,pe=G.length,Ne=B.length;if(te!==void 0&&(te=String(te).toLowerCase(),te==="ucs2"||te==="ucs-2"||te==="utf16le"||te==="utf-16le")){if(G.length<2||B.length<2)return-1;xe=2,pe/=2,Ne/=2,k/=2}function Ie(Me,Le){return xe===1?Me[Le]:Me.readUInt16BE(Le*xe)}let $e;if(oe){let Me=-1;for($e=k;$e<pe;$e++)if(Ie(G,$e)===Ie(B,Me===-1?0:$e-Me)){if(Me===-1&&(Me=$e),$e-Me+1===Ne)return Me*xe}else Me!==-1&&($e-=$e-Me),Me=-1}else for(k+Ne>pe&&(k=pe-Ne),$e=k;$e>=0;$e--){let Me=!0;for(let Le=0;Le<Ne;Le++)if(Ie(G,$e+Le)!==Ie(B,Le)){Me=!1;break}if(Me)return $e}return-1}x.prototype.includes=function(B,k,te){return this.indexOf(B,k,te)!==-1},x.prototype.indexOf=function(B,k,te){return I(this,B,k,te,!0)},x.prototype.lastIndexOf=function(B,k,te){return I(this,B,k,te,!1)};function W(G,B,k,te){k=Number(k)||0;const oe=G.length-k;te?(te=Number(te),te>oe&&(te=oe)):te=oe;const xe=B.length;te>xe/2&&(te=xe/2);let pe;for(pe=0;pe<te;++pe){const Ne=parseInt(B.substr(pe*2,2),16);if(qe(Ne))return pe;G[k+pe]=Ne}return pe}function O(G,B,k,te){return at(rt(B,G.length-k),G,k,te)}function Z(G,B,k,te){return at(st(B),G,k,te)}function z(G,B,k,te){return at(Ke(B),G,k,te)}function q(G,B,k,te){return at(Je(B,G.length-k),G,k,te)}x.prototype.write=function(B,k,te,oe){if(k===void 0)oe="utf8",te=this.length,k=0;else if(te===void 0&&typeof k=="string")oe=k,te=this.length,k=0;else if(isFinite(k))k=k>>>0,isFinite(te)?(te=te>>>0,oe===void 0&&(oe="utf8")):(oe=te,te=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const xe=this.length-k;if((te===void 0||te>xe)&&(te=xe),B.length>0&&(te<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");oe||(oe="utf8");let pe=!1;for(;;)switch(oe){case"hex":return W(this,B,k,te);case"utf8":case"utf-8":return O(this,B,k,te);case"ascii":case"latin1":case"binary":return Z(this,B,k,te);case"base64":return z(this,B,k,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,B,k,te);default:if(pe)throw new TypeError("Unknown encoding: "+oe);oe=(""+oe).toLowerCase(),pe=!0}},x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function $(G,B,k){return B===0&&k===G.length?t.fromByteArray(G):t.fromByteArray(G.slice(B,k))}function M(G,B,k){k=Math.min(G.length,k);const te=[];let oe=B;for(;oe<k;){const xe=G[oe];let pe=null,Ne=xe>239?4:xe>223?3:xe>191?2:1;if(oe+Ne<=k){let Ie,$e,Me,Le;switch(Ne){case 1:xe<128&&(pe=xe);break;case 2:Ie=G[oe+1],(Ie&192)===128&&(Le=(xe&31)<<6|Ie&63,Le>127&&(pe=Le));break;case 3:Ie=G[oe+1],$e=G[oe+2],(Ie&192)===128&&($e&192)===128&&(Le=(xe&15)<<12|(Ie&63)<<6|$e&63,Le>2047&&(Le<55296||Le>57343)&&(pe=Le));break;case 4:Ie=G[oe+1],$e=G[oe+2],Me=G[oe+3],(Ie&192)===128&&($e&192)===128&&(Me&192)===128&&(Le=(xe&15)<<18|(Ie&63)<<12|($e&63)<<6|Me&63,Le>65535&&Le<1114112&&(pe=Le))}}pe===null?(pe=65533,Ne=1):pe>65535&&(pe-=65536,te.push(pe>>>10&1023|55296),pe=56320|pe&1023),te.push(pe),oe+=Ne}return R(te)}const S=4096;function R(G){const B=G.length;if(B<=S)return String.fromCharCode.apply(String,G);let k="",te=0;for(;te<B;)k+=String.fromCharCode.apply(String,G.slice(te,te+=S));return k}function D(G,B,k){let te="";k=Math.min(G.length,k);for(let oe=B;oe<k;++oe)te+=String.fromCharCode(G[oe]&127);return te}function j(G,B,k){let te="";k=Math.min(G.length,k);for(let oe=B;oe<k;++oe)te+=String.fromCharCode(G[oe]);return te}function P(G,B,k){const te=G.length;(!B||B<0)&&(B=0),(!k||k<0||k>te)&&(k=te);let oe="";for(let xe=B;xe<k;++xe)oe+=De[G[xe]];return oe}function Q(G,B,k){const te=G.slice(B,k);let oe="";for(let xe=0;xe<te.length-1;xe+=2)oe+=String.fromCharCode(te[xe]+te[xe+1]*256);return oe}x.prototype.slice=function(B,k){const te=this.length;B=~~B,k=k===void 0?te:~~k,B<0?(B+=te,B<0&&(B=0)):B>te&&(B=te),k<0?(k+=te,k<0&&(k=0)):k>te&&(k=te),k<B&&(k=B);const oe=this.subarray(B,k);return Object.setPrototypeOf(oe,x.prototype),oe};function C(G,B,k){if(G%1!==0||G<0)throw new RangeError("offset is not uint");if(G+B>k)throw new RangeError("Trying to access beyond buffer length")}x.prototype.readUintLE=x.prototype.readUIntLE=function(B,k,te){B=B>>>0,k=k>>>0,te||C(B,k,this.length);let oe=this[B],xe=1,pe=0;for(;++pe<k&&(xe*=256);)oe+=this[B+pe]*xe;return oe},x.prototype.readUintBE=x.prototype.readUIntBE=function(B,k,te){B=B>>>0,k=k>>>0,te||C(B,k,this.length);let oe=this[B+--k],xe=1;for(;k>0&&(xe*=256);)oe+=this[B+--k]*xe;return oe},x.prototype.readUint8=x.prototype.readUInt8=function(B,k){return B=B>>>0,k||C(B,1,this.length),this[B]},x.prototype.readUint16LE=x.prototype.readUInt16LE=function(B,k){return B=B>>>0,k||C(B,2,this.length),this[B]|this[B+1]<<8},x.prototype.readUint16BE=x.prototype.readUInt16BE=function(B,k){return B=B>>>0,k||C(B,2,this.length),this[B]<<8|this[B+1]},x.prototype.readUint32LE=x.prototype.readUInt32LE=function(B,k){return B=B>>>0,k||C(B,4,this.length),(this[B]|this[B+1]<<8|this[B+2]<<16)+this[B+3]*16777216},x.prototype.readUint32BE=x.prototype.readUInt32BE=function(B,k){return B=B>>>0,k||C(B,4,this.length),this[B]*16777216+(this[B+1]<<16|this[B+2]<<8|this[B+3])},x.prototype.readBigUInt64LE=Se(function(B){B=B>>>0,be(B,"offset");const k=this[B],te=this[B+7];(k===void 0||te===void 0)&&Fe(B,this.length-8);const oe=k+this[++B]*2**8+this[++B]*2**16+this[++B]*2**24,xe=this[++B]+this[++B]*2**8+this[++B]*2**16+te*2**24;return BigInt(oe)+(BigInt(xe)<<BigInt(32))}),x.prototype.readBigUInt64BE=Se(function(B){B=B>>>0,be(B,"offset");const k=this[B],te=this[B+7];(k===void 0||te===void 0)&&Fe(B,this.length-8);const oe=k*2**24+this[++B]*2**16+this[++B]*2**8+this[++B],xe=this[++B]*2**24+this[++B]*2**16+this[++B]*2**8+te;return(BigInt(oe)<<BigInt(32))+BigInt(xe)}),x.prototype.readIntLE=function(B,k,te){B=B>>>0,k=k>>>0,te||C(B,k,this.length);let oe=this[B],xe=1,pe=0;for(;++pe<k&&(xe*=256);)oe+=this[B+pe]*xe;return xe*=128,oe>=xe&&(oe-=Math.pow(2,8*k)),oe},x.prototype.readIntBE=function(B,k,te){B=B>>>0,k=k>>>0,te||C(B,k,this.length);let oe=k,xe=1,pe=this[B+--oe];for(;oe>0&&(xe*=256);)pe+=this[B+--oe]*xe;return xe*=128,pe>=xe&&(pe-=Math.pow(2,8*k)),pe},x.prototype.readInt8=function(B,k){return B=B>>>0,k||C(B,1,this.length),this[B]&128?(255-this[B]+1)*-1:this[B]},x.prototype.readInt16LE=function(B,k){B=B>>>0,k||C(B,2,this.length);const te=this[B]|this[B+1]<<8;return te&32768?te|4294901760:te},x.prototype.readInt16BE=function(B,k){B=B>>>0,k||C(B,2,this.length);const te=this[B+1]|this[B]<<8;return te&32768?te|4294901760:te},x.prototype.readInt32LE=function(B,k){return B=B>>>0,k||C(B,4,this.length),this[B]|this[B+1]<<8|this[B+2]<<16|this[B+3]<<24},x.prototype.readInt32BE=function(B,k){return B=B>>>0,k||C(B,4,this.length),this[B]<<24|this[B+1]<<16|this[B+2]<<8|this[B+3]},x.prototype.readBigInt64LE=Se(function(B){B=B>>>0,be(B,"offset");const k=this[B],te=this[B+7];(k===void 0||te===void 0)&&Fe(B,this.length-8);const oe=this[B+4]+this[B+5]*2**8+this[B+6]*2**16+(te<<24);return(BigInt(oe)<<BigInt(32))+BigInt(k+this[++B]*2**8+this[++B]*2**16+this[++B]*2**24)}),x.prototype.readBigInt64BE=Se(function(B){B=B>>>0,be(B,"offset");const k=this[B],te=this[B+7];(k===void 0||te===void 0)&&Fe(B,this.length-8);const oe=(k<<24)+this[++B]*2**16+this[++B]*2**8+this[++B];return(BigInt(oe)<<BigInt(32))+BigInt(this[++B]*2**24+this[++B]*2**16+this[++B]*2**8+te)}),x.prototype.readFloatLE=function(B,k){return B=B>>>0,k||C(B,4,this.length),n.read(this,B,!0,23,4)},x.prototype.readFloatBE=function(B,k){return B=B>>>0,k||C(B,4,this.length),n.read(this,B,!1,23,4)},x.prototype.readDoubleLE=function(B,k){return B=B>>>0,k||C(B,8,this.length),n.read(this,B,!0,52,8)},x.prototype.readDoubleBE=function(B,k){return B=B>>>0,k||C(B,8,this.length),n.read(this,B,!1,52,8)};function K(G,B,k,te,oe,xe){if(!x.isBuffer(G))throw new TypeError('"buffer" argument must be a Buffer instance');if(B>oe||B<xe)throw new RangeError('"value" argument is out of bounds');if(k+te>G.length)throw new RangeError("Index out of range")}x.prototype.writeUintLE=x.prototype.writeUIntLE=function(B,k,te,oe){if(B=+B,k=k>>>0,te=te>>>0,!oe){const Ne=Math.pow(2,8*te)-1;K(this,B,k,te,Ne,0)}let xe=1,pe=0;for(this[k]=B&255;++pe<te&&(xe*=256);)this[k+pe]=B/xe&255;return k+te},x.prototype.writeUintBE=x.prototype.writeUIntBE=function(B,k,te,oe){if(B=+B,k=k>>>0,te=te>>>0,!oe){const Ne=Math.pow(2,8*te)-1;K(this,B,k,te,Ne,0)}let xe=te-1,pe=1;for(this[k+xe]=B&255;--xe>=0&&(pe*=256);)this[k+xe]=B/pe&255;return k+te},x.prototype.writeUint8=x.prototype.writeUInt8=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,1,255,0),this[k]=B&255,k+1},x.prototype.writeUint16LE=x.prototype.writeUInt16LE=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,2,65535,0),this[k]=B&255,this[k+1]=B>>>8,k+2},x.prototype.writeUint16BE=x.prototype.writeUInt16BE=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,2,65535,0),this[k]=B>>>8,this[k+1]=B&255,k+2},x.prototype.writeUint32LE=x.prototype.writeUInt32LE=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,4,4294967295,0),this[k+3]=B>>>24,this[k+2]=B>>>16,this[k+1]=B>>>8,this[k]=B&255,k+4},x.prototype.writeUint32BE=x.prototype.writeUInt32BE=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,4,4294967295,0),this[k]=B>>>24,this[k+1]=B>>>16,this[k+2]=B>>>8,this[k+3]=B&255,k+4};function J(G,B,k,te,oe){Re(B,te,oe,G,k,7);let xe=Number(B&BigInt(4294967295));G[k++]=xe,xe=xe>>8,G[k++]=xe,xe=xe>>8,G[k++]=xe,xe=xe>>8,G[k++]=xe;let pe=Number(B>>BigInt(32)&BigInt(4294967295));return G[k++]=pe,pe=pe>>8,G[k++]=pe,pe=pe>>8,G[k++]=pe,pe=pe>>8,G[k++]=pe,k}function ne(G,B,k,te,oe){Re(B,te,oe,G,k,7);let xe=Number(B&BigInt(4294967295));G[k+7]=xe,xe=xe>>8,G[k+6]=xe,xe=xe>>8,G[k+5]=xe,xe=xe>>8,G[k+4]=xe;let pe=Number(B>>BigInt(32)&BigInt(4294967295));return G[k+3]=pe,pe=pe>>8,G[k+2]=pe,pe=pe>>8,G[k+1]=pe,pe=pe>>8,G[k]=pe,k+8}x.prototype.writeBigUInt64LE=Se(function(B,k=0){return J(this,B,k,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeBigUInt64BE=Se(function(B,k=0){return ne(this,B,k,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeIntLE=function(B,k,te,oe){if(B=+B,k=k>>>0,!oe){const Ie=Math.pow(2,8*te-1);K(this,B,k,te,Ie-1,-Ie)}let xe=0,pe=1,Ne=0;for(this[k]=B&255;++xe<te&&(pe*=256);)B<0&&Ne===0&&this[k+xe-1]!==0&&(Ne=1),this[k+xe]=(B/pe>>0)-Ne&255;return k+te},x.prototype.writeIntBE=function(B,k,te,oe){if(B=+B,k=k>>>0,!oe){const Ie=Math.pow(2,8*te-1);K(this,B,k,te,Ie-1,-Ie)}let xe=te-1,pe=1,Ne=0;for(this[k+xe]=B&255;--xe>=0&&(pe*=256);)B<0&&Ne===0&&this[k+xe+1]!==0&&(Ne=1),this[k+xe]=(B/pe>>0)-Ne&255;return k+te},x.prototype.writeInt8=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,1,127,-128),B<0&&(B=255+B+1),this[k]=B&255,k+1},x.prototype.writeInt16LE=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,2,32767,-32768),this[k]=B&255,this[k+1]=B>>>8,k+2},x.prototype.writeInt16BE=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,2,32767,-32768),this[k]=B>>>8,this[k+1]=B&255,k+2},x.prototype.writeInt32LE=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,4,2147483647,-2147483648),this[k]=B&255,this[k+1]=B>>>8,this[k+2]=B>>>16,this[k+3]=B>>>24,k+4},x.prototype.writeInt32BE=function(B,k,te){return B=+B,k=k>>>0,te||K(this,B,k,4,2147483647,-2147483648),B<0&&(B=4294967295+B+1),this[k]=B>>>24,this[k+1]=B>>>16,this[k+2]=B>>>8,this[k+3]=B&255,k+4},x.prototype.writeBigInt64LE=Se(function(B,k=0){return J(this,B,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),x.prototype.writeBigInt64BE=Se(function(B,k=0){return ne(this,B,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function re(G,B,k,te,oe,xe){if(k+te>G.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function ie(G,B,k,te,oe){return B=+B,k=k>>>0,oe||re(G,B,k,4),n.write(G,B,k,te,23,4),k+4}x.prototype.writeFloatLE=function(B,k,te){return ie(this,B,k,!0,te)},x.prototype.writeFloatBE=function(B,k,te){return ie(this,B,k,!1,te)};function ce(G,B,k,te,oe){return B=+B,k=k>>>0,oe||re(G,B,k,8),n.write(G,B,k,te,52,8),k+8}x.prototype.writeDoubleLE=function(B,k,te){return ce(this,B,k,!0,te)},x.prototype.writeDoubleBE=function(B,k,te){return ce(this,B,k,!1,te)},x.prototype.copy=function(B,k,te,oe){if(!x.isBuffer(B))throw new TypeError("argument should be a Buffer");if(te||(te=0),!oe&&oe!==0&&(oe=this.length),k>=B.length&&(k=B.length),k||(k=0),oe>0&&oe<te&&(oe=te),oe===te||B.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(te<0||te>=this.length)throw new RangeError("Index out of range");if(oe<0)throw new RangeError("sourceEnd out of bounds");oe>this.length&&(oe=this.length),B.length-k<oe-te&&(oe=B.length-k+te);const xe=oe-te;return this===B&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(k,te,oe):Uint8Array.prototype.set.call(B,this.subarray(te,oe),k),xe},x.prototype.fill=function(B,k,te,oe){if(typeof B=="string"){if(typeof k=="string"?(oe=k,k=0,te=this.length):typeof te=="string"&&(oe=te,te=this.length),oe!==void 0&&typeof oe!="string")throw new TypeError("encoding must be a string");if(typeof oe=="string"&&!x.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);if(B.length===1){const pe=B.charCodeAt(0);(oe==="utf8"&&pe<128||oe==="latin1")&&(B=pe)}}else typeof B=="number"?B=B&255:typeof B=="boolean"&&(B=Number(B));if(k<0||this.length<k||this.length<te)throw new RangeError("Out of range index");if(te<=k)return this;k=k>>>0,te=te===void 0?this.length:te>>>0,B||(B=0);let xe;if(typeof B=="number")for(xe=k;xe<te;++xe)this[xe]=B;else{const pe=x.isBuffer(B)?B:x.from(B,oe),Ne=pe.length;if(Ne===0)throw new TypeError('The value "'+B+'" is invalid for argument "value"');for(xe=0;xe<te-k;++xe)this[xe+k]=pe[xe%Ne]}return this};const ue={};function ae(G,B,k){ue[G]=class extends k{constructor(){super(),Object.defineProperty(this,"message",{value:B.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${G}]`,this.stack,delete this.name}get code(){return G}set code(oe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:oe,writable:!0})}toString(){return`${this.name} [${G}]: ${this.message}`}}}ae("ERR_BUFFER_OUT_OF_BOUNDS",function(G){return G?`${G} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ae("ERR_INVALID_ARG_TYPE",function(G,B){return`The "${G}" argument must be of type number. Received type ${typeof B}`},TypeError),ae("ERR_OUT_OF_RANGE",function(G,B,k){let te=`The value of "${G}" is out of range.`,oe=k;return Number.isInteger(k)&&Math.abs(k)>2**32?oe=we(String(k)):typeof k=="bigint"&&(oe=String(k),(k>BigInt(2)**BigInt(32)||k<-(BigInt(2)**BigInt(32)))&&(oe=we(oe)),oe+="n"),te+=` It must be ${B}. Received ${oe}`,te},RangeError);function we(G){let B="",k=G.length;const te=G[0]==="-"?1:0;for(;k>=te+4;k-=3)B=`_${G.slice(k-3,k)}${B}`;return`${G.slice(0,k)}${B}`}function ke(G,B,k){be(B,"offset"),(G[B]===void 0||G[B+k]===void 0)&&Fe(B,G.length-(k+1))}function Re(G,B,k,te,oe,xe){if(G>k||G<B){const pe=typeof B=="bigint"?"n":"";let Ne;throw B===0||B===BigInt(0)?Ne=`>= 0${pe} and < 2${pe} ** ${(xe+1)*8}${pe}`:Ne=`>= -(2${pe} ** ${(xe+1)*8-1}${pe}) and < 2 ** ${(xe+1)*8-1}${pe}`,new ue.ERR_OUT_OF_RANGE("value",Ne,G)}ke(te,oe,xe)}function be(G,B){if(typeof G!="number")throw new ue.ERR_INVALID_ARG_TYPE(B,"number",G)}function Fe(G,B,k){throw Math.floor(G)!==G?(be(G,k),new ue.ERR_OUT_OF_RANGE("offset","an integer",G)):B<0?new ue.ERR_BUFFER_OUT_OF_BOUNDS:new ue.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${B}`,G)}const je=/[^+/0-9A-Za-z-_]/g;function Te(G){if(G=G.split("=")[0],G=G.trim().replace(je,""),G.length<2)return"";for(;G.length%4!==0;)G=G+"=";return G}function rt(G,B){B=B||1/0;let k;const te=G.length;let oe=null;const xe=[];for(let pe=0;pe<te;++pe){if(k=G.charCodeAt(pe),k>55295&&k<57344){if(!oe){if(k>56319){(B-=3)>-1&&xe.push(239,191,189);continue}else if(pe+1===te){(B-=3)>-1&&xe.push(239,191,189);continue}oe=k;continue}if(k<56320){(B-=3)>-1&&xe.push(239,191,189),oe=k;continue}k=(oe-55296<<10|k-56320)+65536}else oe&&(B-=3)>-1&&xe.push(239,191,189);if(oe=null,k<128){if((B-=1)<0)break;xe.push(k)}else if(k<2048){if((B-=2)<0)break;xe.push(k>>6|192,k&63|128)}else if(k<65536){if((B-=3)<0)break;xe.push(k>>12|224,k>>6&63|128,k&63|128)}else if(k<1114112){if((B-=4)<0)break;xe.push(k>>18|240,k>>12&63|128,k>>6&63|128,k&63|128)}else throw new Error("Invalid code point")}return xe}function st(G){const B=[];for(let k=0;k<G.length;++k)B.push(G.charCodeAt(k)&255);return B}function Je(G,B){let k,te,oe;const xe=[];for(let pe=0;pe<G.length&&!((B-=2)<0);++pe)k=G.charCodeAt(pe),te=k>>8,oe=k%256,xe.push(oe),xe.push(te);return xe}function Ke(G){return t.toByteArray(Te(G))}function at(G,B,k,te){let oe;for(oe=0;oe<te&&!(oe+k>=B.length||oe>=G.length);++oe)B[oe+k]=G[oe];return oe}function mt(G,B){return G instanceof B||G!=null&&G.constructor!=null&&G.constructor.name!=null&&G.constructor.name===B.name}function qe(G){return G!==G}const De=(function(){const G="0123456789abcdef",B=new Array(256);for(let k=0;k<16;++k){const te=k*16;for(let oe=0;oe<16;++oe)B[te+oe]=G[k]+G[oe]}return B})();function Se(G){return typeof BigInt>"u"?_e:G}function _e(){throw new Error("BigInt not supported")}})(buffer)),buffer}var bufferExports=requireBuffer();globalThis.Buffer=bufferExports.Buffer;var react={exports:{}},react_production={};var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),l=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),y=Symbol.iterator;function w(C){return C===null||typeof C!="object"?null:(C=y&&C[y]||C["@@iterator"],typeof C=="function"?C:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,F={};function H(C,K,J){this.props=C,this.context=K,this.refs=F,this.updater=J||v}H.prototype.isReactComponent={},H.prototype.setState=function(C,K){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,K,"setState")},H.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function Y(){}Y.prototype=H.prototype;function T(C,K,J){this.props=C,this.context=K,this.refs=F,this.updater=J||v}var L=T.prototype=new Y;L.constructor=T,_(L,H.prototype),L.isPureReactComponent=!0;var N=Array.isArray;function I(){}var U={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function O(C,K,J){var ne=J.ref;return{$$typeof:e,type:C,key:K,ref:ne!==void 0?ne:null,props:J}}function Z(C,K){return O(C.type,K,C.props)}function z(C){return typeof C=="object"&&C!==null&&C.$$typeof===e}function q(C){var K={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(J){return K[J]})}var $=/\/+/g;function M(C,K){return typeof C=="object"&&C!==null&&C.key!=null?q(""+C.key):K.toString(36)}function S(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(I,I):(C.status="pending",C.then(function(K){C.status==="pending"&&(C.status="fulfilled",C.value=K)},function(K){C.status==="pending"&&(C.status="rejected",C.reason=K)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function R(C,K,J,ne,re){var ie=typeof C;(ie==="undefined"||ie==="boolean")&&(C=null);var ce=!1;if(C===null)ce=!0;else switch(ie){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(C.$$typeof){case e:case t:ce=!0;break;case E:return ce=C._init,R(ce(C._payload),K,J,ne,re)}}if(ce)return re=re(C),ce=ne===""?"."+M(C,0):ne,N(re)?(J="",ce!=null&&(J=ce.replace($,"$&/")+"/"),R(re,K,J,"",function(we){return we})):re!=null&&(z(re)&&(re=Z(re,J+(re.key==null||C&&C.key===re.key?"":(""+re.key).replace($,"$&/")+"/")+ce)),K.push(re)),1;ce=0;var ue=ne===""?".":ne+":";if(N(C))for(var ae=0;ae<C.length;ae++)ne=C[ae],ie=ue+M(ne,ae),ce+=R(ne,K,J,ie,re);else if(ae=w(C),typeof ae=="function")for(C=ae.call(C),ae=0;!(ne=C.next()).done;)ne=ne.value,ie=ue+M(ne,ae++),ce+=R(ne,K,J,ie,re);else if(ie==="object"){if(typeof C.then=="function")return R(S(C),K,J,ne,re);throw K=String(C),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return ce}function D(C,K,J){if(C==null)return C;var ne=[],re=0;return R(C,ne,"","",function(ie){return K.call(J,ie,re++)}),ne}function j(C){if(C._status===-1){var K=C._result;K=K(),K.then(function(J){(C._status===0||C._status===-1)&&(C._status=1,C._result=J)},function(J){(C._status===0||C._status===-1)&&(C._status=2,C._result=J)}),C._status===-1&&(C._status=0,C._result=K)}if(C._status===1)return C._result.default;throw C._result}var P=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)},Q={map:D,forEach:function(C,K,J){D(C,function(){K.apply(this,arguments)},J)},count:function(C){var K=0;return D(C,function(){K++}),K},toArray:function(C){return D(C,function(K){return K})||[]},only:function(C){if(!z(C))throw Error("React.Children.only expected to receive a single React element child.");return C}};return react_production.Activity=g,react_production.Children=Q,react_production.Component=H,react_production.Fragment=n,react_production.Profiler=o,react_production.PureComponent=T,react_production.StrictMode=r,react_production.Suspense=f,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(C){return U.H.useMemoCache(C)}},react_production.cache=function(C){return function(){return C.apply(null,arguments)}},react_production.cacheSignal=function(){return null},react_production.cloneElement=function(C,K,J){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var ne=_({},C.props),re=C.key;if(K!=null)for(ie in K.key!==void 0&&(re=""+K.key),K)!W.call(K,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&K.ref===void 0||(ne[ie]=K[ie]);var ie=arguments.length-2;if(ie===1)ne.children=J;else if(1<ie){for(var ce=Array(ie),ue=0;ue<ie;ue++)ce[ue]=arguments[ue+2];ne.children=ce}return O(C.type,re,ne)},react_production.createContext=function(C){return C={$$typeof:l,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:c,_context:C},C},react_production.createElement=function(C,K,J){var ne,re={},ie=null;if(K!=null)for(ne in K.key!==void 0&&(ie=""+K.key),K)W.call(K,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(re[ne]=K[ne]);var ce=arguments.length-2;if(ce===1)re.children=J;else if(1<ce){for(var ue=Array(ce),ae=0;ae<ce;ae++)ue[ae]=arguments[ae+2];re.children=ue}if(C&&C.defaultProps)for(ne in ce=C.defaultProps,ce)re[ne]===void 0&&(re[ne]=ce[ne]);return O(C,ie,re)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(C){return{$$typeof:x,render:C}},react_production.isValidElement=z,react_production.lazy=function(C){return{$$typeof:E,_payload:{_status:-1,_result:C},_init:j}},react_production.memo=function(C,K){return{$$typeof:m,type:C,compare:K===void 0?null:K}},react_production.startTransition=function(C){var K=U.T,J={};U.T=J;try{var ne=C(),re=U.S;re!==null&&re(J,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(I,P)}catch(ie){P(ie)}finally{K!==null&&J.types!==null&&(K.types=J.types),U.T=K}},react_production.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},react_production.use=function(C){return U.H.use(C)},react_production.useActionState=function(C,K,J){return U.H.useActionState(C,K,J)},react_production.useCallback=function(C,K){return U.H.useCallback(C,K)},react_production.useContext=function(C){return U.H.useContext(C)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(C,K){return U.H.useDeferredValue(C,K)},react_production.useEffect=function(C,K){return U.H.useEffect(C,K)},react_production.useEffectEvent=function(C){return U.H.useEffectEvent(C)},react_production.useId=function(){return U.H.useId()},react_production.useImperativeHandle=function(C,K,J){return U.H.useImperativeHandle(C,K,J)},react_production.useInsertionEffect=function(C,K){return U.H.useInsertionEffect(C,K)},react_production.useLayoutEffect=function(C,K){return U.H.useLayoutEffect(C,K)},react_production.useMemo=function(C,K){return U.H.useMemo(C,K)},react_production.useOptimistic=function(C,K){return U.H.useOptimistic(C,K)},react_production.useReducer=function(C,K,J){return U.H.useReducer(C,K,J)},react_production.useRef=function(C){return U.H.useRef(C)},react_production.useState=function(C){return U.H.useState(C)},react_production.useSyncExternalStore=function(C,K,J){return U.H.useSyncExternalStore(C,K,J)},react_production.useTransition=function(){return U.H.useTransition()},react_production.version="19.2.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(e){function t(R,D){var j=R.length;R.push(D);e:for(;0<j;){var P=j-1>>>1,Q=R[P];if(0<o(Q,D))R[P]=D,R[j]=Q,j=P;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var D=R[0],j=R.pop();if(j!==D){R[0]=j;e:for(var P=0,Q=R.length,C=Q>>>1;P<C;){var K=2*(P+1)-1,J=R[K],ne=K+1,re=R[ne];if(0>o(J,j))ne<Q&&0>o(re,J)?(R[P]=re,R[ne]=j,P=ne):(R[P]=J,R[K]=j,P=K);else if(ne<Q&&0>o(re,j))R[P]=re,R[ne]=j,P=ne;else break e}}return D}function o(R,D){var j=R.sortIndex-D.sortIndex;return j!==0?j:R.id-D.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var l=Date,x=l.now();e.unstable_now=function(){return l.now()-x}}var f=[],m=[],E=1,g=null,y=3,w=!1,v=!1,_=!1,F=!1,H=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function L(R){for(var D=n(m);D!==null;){if(D.callback===null)r(m);else if(D.startTime<=R)r(m),D.sortIndex=D.expirationTime,t(f,D);else break;D=n(m)}}function N(R){if(_=!1,L(R),!v)if(n(f)!==null)v=!0,I||(I=!0,q());else{var D=n(m);D!==null&&S(N,D.startTime-R)}}var I=!1,U=-1,W=5,O=-1;function Z(){return F?!0:!(e.unstable_now()-O<W)}function z(){if(F=!1,I){var R=e.unstable_now();O=R;var D=!0;try{e:{v=!1,_&&(_=!1,Y(U),U=-1),w=!0;var j=y;try{t:{for(L(R),g=n(f);g!==null&&!(g.expirationTime>R&&Z());){var P=g.callback;if(typeof P=="function"){g.callback=null,y=g.priorityLevel;var Q=P(g.expirationTime<=R);if(R=e.unstable_now(),typeof Q=="function"){g.callback=Q,L(R),D=!0;break t}g===n(f)&&r(f),L(R)}else r(f);g=n(f)}if(g!==null)D=!0;else{var C=n(m);C!==null&&S(N,C.startTime-R),D=!1}}break e}finally{g=null,y=j,w=!1}D=void 0}}finally{D?q():I=!1}}}var q;if(typeof T=="function")q=function(){T(z)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,M=$.port2;$.port1.onmessage=z,q=function(){M.postMessage(null)}}else q=function(){H(z,0)};function S(R,D){U=H(function(){R(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(R){switch(y){case 1:case 2:case 3:var D=3;break;default:D=y}var j=y;y=D;try{return R()}finally{y=j}},e.unstable_requestPaint=function(){F=!0},e.unstable_runWithPriority=function(R,D){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var j=y;y=R;try{return D()}finally{y=j}},e.unstable_scheduleCallback=function(R,D,j){var P=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?P+j:P):j=P,R){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=j+Q,R={id:E++,callback:D,priorityLevel:R,startTime:j,expirationTime:Q,sortIndex:-1},j>P?(R.sortIndex=j,t(m,R),n(f)===null&&R===n(m)&&(_?(Y(U),U=-1):_=!0,S(N,j-P))):(R.sortIndex=Q,t(f,R),v||w||(v=!0,I||(I=!0,q()))),R},e.unstable_shouldYield=Z,e.unstable_wrapCallback=function(R){var D=y;return function(){var j=y;y=D;try{return R.apply(this,arguments)}finally{y=j}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var e=requireReact();function t(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)m+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(f,m,E){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:g==null?null:""+g,children:f,containerInfo:m,implementation:E}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function x(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,reactDom_production.createPortal=function(f,m){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return c(f,m,null,E)},reactDom_production.flushSync=function(f){var m=l.T,E=r.p;try{if(l.T=null,r.p=2,f)return f()}finally{l.T=m,r.p=E,r.d.f()}},reactDom_production.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(f,m))},reactDom_production.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},reactDom_production.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var E=m.as,g=x(E,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,w=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;E==="style"?r.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:w}):E==="script"&&r.d.X(f,{crossOrigin:g,integrity:y,fetchPriority:w,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},reactDom_production.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var E=x(m.as,m.crossOrigin);r.d.M(f,{crossOrigin:E,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(f)},reactDom_production.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var E=m.as,g=x(E,m.crossOrigin);r.d.L(f,E,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},reactDom_production.preloadModule=function(f,m){if(typeof f=="string")if(m){var E=x(m.as,m.crossOrigin);r.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:E,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(f)},reactDom_production.requestFormReset=function(f){r.d.r(f)},reactDom_production.unstable_batchedUpdates=function(f,m){return f(m)},reactDom_production.useFormState=function(f,m,E){return l.H.useFormState(f,m,E)},reactDom_production.useFormStatus=function(){return l.H.useHostTransitionStatus()},reactDom_production.version="19.2.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),reactDom.exports=requireReactDom_production(),reactDom.exports}var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var e=requireScheduler(),t=requireReact(),n=requireReactDom();function r(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var a=s,u=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(u=a.return),s=a.return;while(s)}return a.tag===3?u:null}function l(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function x(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function f(s){if(c(s)!==s)throw Error(r(188))}function m(s){var a=s.alternate;if(!a){if(a=c(s),a===null)throw Error(r(188));return a!==s?null:s}for(var u=s,p=a;;){var b=u.return;if(b===null)break;var A=b.alternate;if(A===null){if(p=b.return,p!==null){u=p;continue}break}if(b.child===A.child){for(A=b.child;A;){if(A===u)return f(b),s;if(A===p)return f(b),a;A=A.sibling}throw Error(r(188))}if(u.return!==p.return)u=b,p=A;else{for(var V=!1,se=b.child;se;){if(se===u){V=!0,u=b,p=A;break}if(se===p){V=!0,p=b,u=A;break}se=se.sibling}if(!V){for(se=A.child;se;){if(se===u){V=!0,u=A,p=b;break}if(se===p){V=!0,p=A,u=b;break}se=se.sibling}if(!V)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?s:a}function E(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=E(s),a!==null)return a;s=s.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),T=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function q(s){return s===null||typeof s!="object"?null:(s=z&&s[z]||s["@@iterator"],typeof s=="function"?s:null)}var $=Symbol.for("react.client.reference");function M(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===$?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case _:return"Fragment";case H:return"Profiler";case F:return"StrictMode";case N:return"Suspense";case I:return"SuspenseList";case O:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case T:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case L:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case U:return a=s.displayName||null,a!==null?a:M(s.type)||"Memo";case W:a=s._payload,s=s._init;try{return M(s(a))}catch{}}return null}var S=Array.isArray,R=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},P=[],Q=-1;function C(s){return{current:s}}function K(s){0>Q||(s.current=P[Q],P[Q]=null,Q--)}function J(s,a){Q++,P[Q]=s.current,s.current=a}var ne=C(null),re=C(null),ie=C(null),ce=C(null);function ue(s,a){switch(J(ie,a),J(re,s),J(ne,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?Zu(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=Zu(a),s=Qu(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}K(ne),J(ne,s)}function ae(){K(ne),K(re),K(ie)}function we(s){s.memoizedState!==null&&J(ce,s);var a=ne.current,u=Qu(a,s.type);a!==u&&(J(re,s),J(ne,u))}function ke(s){re.current===s&&(K(ne),K(re)),ce.current===s&&(K(ce),Js._currentValue=j)}var Re,be;function Fe(s){if(Re===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);Re=a&&a[1]||"",be=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Re+s+be}var je=!1;function Te(s,a){if(!s||je)return"";je=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(a){var Ce=function(){throw Error()};if(Object.defineProperty(Ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ce,[])}catch(Ae){var ye=Ae}Reflect.construct(s,[],Ce)}else{try{Ce.call()}catch(Ae){ye=Ae}s.call(Ce.prototype)}}else{try{throw Error()}catch(Ae){ye=Ae}(Ce=s())&&typeof Ce.catch=="function"&&Ce.catch(function(){})}}catch(Ae){if(Ae&&ye&&typeof Ae.stack=="string")return[Ae.stack,ye.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=p.DetermineComponentFrameRoot(),V=A[0],se=A[1];if(V&&se){var le=V.split(`
`),Ee=se.split(`
`);for(b=p=0;p<le.length&&!le[p].includes("DetermineComponentFrameRoot");)p++;for(;b<Ee.length&&!Ee[b].includes("DetermineComponentFrameRoot");)b++;if(p===le.length||b===Ee.length)for(p=le.length-1,b=Ee.length-1;1<=p&&0<=b&&le[p]!==Ee[b];)b--;for(;1<=p&&0<=b;p--,b--)if(le[p]!==Ee[b]){if(p!==1||b!==1)do if(p--,b--,0>b||le[p]!==Ee[b]){var ve=`
`+le[p].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=p&&0<=b);break}}}finally{je=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?Fe(u):""}function rt(s,a){switch(s.tag){case 26:case 27:case 5:return Fe(s.type);case 16:return Fe("Lazy");case 13:return s.child!==a&&a!==null?Fe("Suspense Fallback"):Fe("Suspense");case 19:return Fe("SuspenseList");case 0:case 15:return Te(s.type,!1);case 11:return Te(s.type.render,!1);case 1:return Te(s.type,!0);case 31:return Fe("Activity");default:return""}}function st(s){try{var a="",u=null;do a+=rt(s,u),u=s,s=s.return;while(s);return a}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Je=Object.prototype.hasOwnProperty,Ke=e.unstable_scheduleCallback,at=e.unstable_cancelCallback,mt=e.unstable_shouldYield,qe=e.unstable_requestPaint,De=e.unstable_now,Se=e.unstable_getCurrentPriorityLevel,_e=e.unstable_ImmediatePriority,G=e.unstable_UserBlockingPriority,B=e.unstable_NormalPriority,k=e.unstable_LowPriority,te=e.unstable_IdlePriority,oe=e.log,xe=e.unstable_setDisableYieldValue,pe=null,Ne=null;function Ie(s){if(typeof oe=="function"&&xe(s),Ne&&typeof Ne.setStrictMode=="function")try{Ne.setStrictMode(pe,s)}catch{}}var $e=Math.clz32?Math.clz32:It,Me=Math.log,Le=Math.LN2;function It(s){return s>>>=0,s===0?32:31-(Me(s)/Le|0)|0}var dt=256,wt=262144,En=4194304;function dn(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ar(s,a,u){var p=s.pendingLanes;if(p===0)return 0;var b=0,A=s.suspendedLanes,V=s.pingedLanes;s=s.warmLanes;var se=p&134217727;return se!==0?(p=se&~A,p!==0?b=dn(p):(V&=se,V!==0?b=dn(V):u||(u=se&~s,u!==0&&(b=dn(u))))):(se=p&~A,se!==0?b=dn(se):V!==0?b=dn(V):u||(u=p&~s,u!==0&&(b=dn(u)))),b===0?0:a!==0&&a!==b&&(a&A)===0&&(A=b&-b,u=a&-a,A>=u||A===32&&(u&4194048)!==0)?a:b}function xs(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function cd(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tc(){var s=En;return En<<=1,(En&62914560)===0&&(En=4194304),s}function go(s){for(var a=[],u=0;31>u;u++)a.push(s);return a}function ds(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ld(s,a,u,p,b,A){var V=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var se=s.entanglements,le=s.expirationTimes,Ee=s.hiddenUpdates;for(u=V&~u;0<u;){var ve=31-$e(u),Ce=1<<ve;se[ve]=0,le[ve]=-1;var ye=Ee[ve];if(ye!==null)for(Ee[ve]=null,ve=0;ve<ye.length;ve++){var Ae=ye[ve];Ae!==null&&(Ae.lane&=-536870913)}u&=~Ce}p!==0&&Nc(s,p,0),A!==0&&b===0&&s.tag!==0&&(s.suspendedLanes|=A&~(V&~a))}function Nc(s,a,u){s.pendingLanes|=a,s.suspendedLanes&=~a;var p=31-$e(a);s.entangledLanes|=a,s.entanglements[p]=s.entanglements[p]|1073741824|u&261930}function $c(s,a){var u=s.entangledLanes|=a;for(s=s.entanglements;u;){var p=31-$e(u),b=1<<p;b&a|s[p]&a&&(s[p]|=a),u&=~b}}function jc(s,a){var u=a&-a;return u=(u&42)!==0?1:yo(u),(u&(s.suspendedLanes|a))!==0?0:u}function yo(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function bo(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ic(){var s=D.p;return s!==0?s:(s=window.event,s===void 0?32:wx(s.type))}function Uc(s,a){var u=D.p;try{return D.p=s,a()}finally{D.p=u}}var Un=Math.random().toString(36).slice(2),Rt="__reactFiber$"+Un,Ot="__reactProps$"+Un,_r="__reactContainer$"+Un,wo="__reactEvents$"+Un,ud="__reactListeners$"+Un,xd="__reactHandles$"+Un,Oc="__reactResources$"+Un,fs="__reactMarker$"+Un;function Ao(s){delete s[Rt],delete s[Ot],delete s[wo],delete s[ud],delete s[xd]}function Sr(s){var a=s[Rt];if(a)return a;for(var u=s.parentNode;u;){if(a=u[_r]||u[Rt]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(s=ix(s);s!==null;){if(u=s[Rt])return u;s=ix(s)}return a}s=u,u=s.parentNode}return null}function Dr(s){if(s=s[Rt]||s[_r]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function hs(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(r(33))}function kr(s){var a=s[Oc];return a||(a=s[Oc]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function kt(s){s[fs]=!0}var Pc=new Set,Hc={};function cr(s,a){Fr(s,a),Fr(s+"Capture",a)}function Fr(s,a){for(Hc[s]=a,s=0;s<a.length;s++)Pc.add(a[s])}var dd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mc={},Lc={};function fd(s){return Je.call(Lc,s)?!0:Je.call(Mc,s)?!1:dd.test(s)?Lc[s]=!0:(Mc[s]=!0,!1)}function ri(s,a,u){if(fd(a))if(u===null)s.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var p=a.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+u)}}function si(s,a,u){if(u===null)s.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+u)}}function gn(s,a,u,p){if(p===null)s.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(a,u,""+p)}}function Qt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Kc(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function hd(s,a,u){var p=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var b=p.get,A=p.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return b.call(this)},set:function(V){u=""+V,A.call(this,V)}}),Object.defineProperty(s,a,{enumerable:p.enumerable}),{getValue:function(){return u},setValue:function(V){u=""+V},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function vo(s){if(!s._valueTracker){var a=Kc(s)?"checked":"value";s._valueTracker=hd(s,a,""+s[a])}}function zc(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var u=a.getValue(),p="";return s&&(p=Kc(s)?s.checked?"true":"false":s.value),s=p,s!==u?(a.setValue(s),!0):!1}function ii(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var pd=/[\n"\\]/g;function Jt(s){return s.replace(pd,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Bo(s,a,u,p,b,A,V,se){s.name="",V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?s.type=V:s.removeAttribute("type"),a!=null?V==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Qt(a)):s.value!==""+Qt(a)&&(s.value=""+Qt(a)):V!=="submit"&&V!=="reset"||s.removeAttribute("value"),a!=null?Co(s,V,Qt(a)):u!=null?Co(s,V,Qt(u)):p!=null&&s.removeAttribute("value"),b==null&&A!=null&&(s.defaultChecked=!!A),b!=null&&(s.checked=b&&typeof b!="function"&&typeof b!="symbol"),se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"?s.name=""+Qt(se):s.removeAttribute("name")}function Vc(s,a,u,p,b,A,V,se){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.type=A),a!=null||u!=null){if(!(A!=="submit"&&A!=="reset"||a!=null)){vo(s);return}u=u!=null?""+Qt(u):"",a=a!=null?""+Qt(a):u,se||a===s.value||(s.value=a),s.defaultValue=a}p=p??b,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=se?s.checked:!!p,s.defaultChecked=!!p,V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&(s.name=V),vo(s)}function Co(s,a,u){a==="number"&&ii(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Rr(s,a,u,p){if(s=s.options,a){a={};for(var b=0;b<u.length;b++)a["$"+u[b]]=!0;for(u=0;u<s.length;u++)b=a.hasOwnProperty("$"+s[u].value),s[u].selected!==b&&(s[u].selected=b),b&&p&&(s[u].defaultSelected=!0)}else{for(u=""+Qt(u),a=null,b=0;b<s.length;b++){if(s[b].value===u){s[b].selected=!0,p&&(s[b].defaultSelected=!0);return}a!==null||s[b].disabled||(a=s[b])}a!==null&&(a.selected=!0)}}function qc(s,a,u){if(a!=null&&(a=""+Qt(a),a!==s.value&&(s.value=a),u==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=u!=null?""+Qt(u):""}function Gc(s,a,u,p){if(a==null){if(p!=null){if(u!=null)throw Error(r(92));if(S(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),a=u}u=Qt(a),s.defaultValue=u,p=s.textContent,p===u&&p!==""&&p!==null&&(s.value=p),vo(s)}function Tr(s,a){if(a){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=a;return}}s.textContent=a}var md=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Wc(s,a,u){var p=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":p?s.setProperty(a,u):typeof u!="number"||u===0||md.has(a)?a==="float"?s.cssFloat=u:s[a]=(""+u).trim():s[a]=u+"px"}function Xc(s,a,u){if(a!=null&&typeof a!="object")throw Error(r(62));if(s=s.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||a!=null&&a.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var b in a)p=a[b],a.hasOwnProperty(b)&&u[b]!==p&&Wc(s,b,p)}else for(var A in a)a.hasOwnProperty(A)&&Wc(s,A,a[A])}function _o(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ed=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function oi(s){return gd.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function yn(){}var So=null;function Do(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Nr=null,$r=null;function Yc(s){var a=Dr(s);if(a&&(s=a.stateNode)){var u=s[Ot]||null;e:switch(s=a.stateNode,a.type){case"input":if(Bo(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Jt(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var p=u[a];if(p!==s&&p.form===s.form){var b=p[Ot]||null;if(!b)throw Error(r(90));Bo(p,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(a=0;a<u.length;a++)p=u[a],p.form===s.form&&zc(p)}break e;case"textarea":qc(s,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&Rr(s,!!u.multiple,a,!1)}}}var ko=!1;function Zc(s,a,u){if(ko)return s(a,u);ko=!0;try{var p=s(a);return p}finally{if(ko=!1,(Nr!==null||$r!==null)&&(Gi(),Nr&&(a=Nr,s=$r,$r=Nr=null,Yc(a),s)))for(a=0;a<s.length;a++)Yc(s[a])}}function ps(s,a){var u=s.stateNode;if(u===null)return null;var p=u[Ot]||null;if(p===null)return null;u=p[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(r(231,a,typeof u));return u}var bn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fo=!1;if(bn)try{var Es={};Object.defineProperty(Es,"passive",{get:function(){Fo=!0}}),window.addEventListener("test",Es,Es),window.removeEventListener("test",Es,Es)}catch{Fo=!1}var On=null,Ro=null,ai=null;function Qc(){if(ai)return ai;var s,a=Ro,u=a.length,p,b="value"in On?On.value:On.textContent,A=b.length;for(s=0;s<u&&a[s]===b[s];s++);var V=u-s;for(p=1;p<=V&&a[u-p]===b[A-p];p++);return ai=b.slice(s,1<p?1-p:void 0)}function ci(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function li(){return!0}function Jc(){return!1}function Pt(s){function a(u,p,b,A,V){this._reactName=u,this._targetInst=b,this.type=p,this.nativeEvent=A,this.target=V,this.currentTarget=null;for(var se in s)s.hasOwnProperty(se)&&(u=s[se],this[se]=u?u(A):A[se]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?li:Jc,this.isPropagationStopped=Jc,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=li)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=li)},persist:function(){},isPersistent:li}),a}var lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ui=Pt(lr),gs=g({},lr,{view:0,detail:0}),yd=Pt(gs),To,No,ys,xi=g({},gs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ys&&(ys&&s.type==="mousemove"?(To=s.screenX-ys.screenX,No=s.screenY-ys.screenY):No=To=0,ys=s),To)},movementY:function(s){return"movementY"in s?s.movementY:No}}),e0=Pt(xi),bd=g({},xi,{dataTransfer:0}),wd=Pt(bd),Ad=g({},gs,{relatedTarget:0}),$o=Pt(Ad),vd=g({},lr,{animationName:0,elapsedTime:0,pseudoElement:0}),Bd=Pt(vd),Cd=g({},lr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),_d=Pt(Cd),Sd=g({},lr,{data:0}),t0=Pt(Sd),Dd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rd(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Fd[s])?!!a[s]:!1}function jo(){return Rd}var Td=g({},gs,{key:function(s){if(s.key){var a=Dd[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=ci(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?kd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jo,charCode:function(s){return s.type==="keypress"?ci(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ci(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Nd=Pt(Td),$d=g({},xi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),n0=Pt($d),jd=g({},gs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jo}),Id=Pt(jd),Ud=g({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Od=Pt(Ud),Pd=g({},xi,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Hd=Pt(Pd),Md=g({},lr,{newState:0,oldState:0}),Ld=Pt(Md),Kd=[9,13,27,32],Io=bn&&"CompositionEvent"in window,bs=null;bn&&"documentMode"in document&&(bs=document.documentMode);var zd=bn&&"TextEvent"in window&&!bs,r0=bn&&(!Io||bs&&8<bs&&11>=bs),s0=" ",i0=!1;function o0(s,a){switch(s){case"keyup":return Kd.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function a0(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var jr=!1;function Vd(s,a){switch(s){case"compositionend":return a0(a);case"keypress":return a.which!==32?null:(i0=!0,s0);case"textInput":return s=a.data,s===s0&&i0?null:s;default:return null}}function qd(s,a){if(jr)return s==="compositionend"||!Io&&o0(s,a)?(s=Qc(),ai=Ro=On=null,jr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return r0&&a.locale!=="ko"?null:a.data;default:return null}}var Gd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c0(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Gd[s.type]:a==="textarea"}function l0(s,a,u,p){Nr?$r?$r.push(p):$r=[p]:Nr=p,a=eo(a,"onChange"),0<a.length&&(u=new ui("onChange","change",null,u,p),s.push({event:u,listeners:a}))}var ws=null,As=null;function Wd(s){Vu(s,0)}function di(s){var a=hs(s);if(zc(a))return s}function u0(s,a){if(s==="change")return a}var x0=!1;if(bn){var Uo;if(bn){var Oo="oninput"in document;if(!Oo){var d0=document.createElement("div");d0.setAttribute("oninput","return;"),Oo=typeof d0.oninput=="function"}Uo=Oo}else Uo=!1;x0=Uo&&(!document.documentMode||9<document.documentMode)}function f0(){ws&&(ws.detachEvent("onpropertychange",h0),As=ws=null)}function h0(s){if(s.propertyName==="value"&&di(As)){var a=[];l0(a,As,s,Do(s)),Zc(Wd,a)}}function Xd(s,a,u){s==="focusin"?(f0(),ws=a,As=u,ws.attachEvent("onpropertychange",h0)):s==="focusout"&&f0()}function Yd(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return di(As)}function Zd(s,a){if(s==="click")return di(a)}function Qd(s,a){if(s==="input"||s==="change")return di(a)}function Jd(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Vt=typeof Object.is=="function"?Object.is:Jd;function vs(s,a){if(Vt(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var u=Object.keys(s),p=Object.keys(a);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var b=u[p];if(!Je.call(a,b)||!Vt(s[b],a[b]))return!1}return!0}function p0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function m0(s,a){var u=p0(s);s=0;for(var p;u;){if(u.nodeType===3){if(p=s+u.textContent.length,s<=a&&p>=a)return{node:u,offset:a-s};s=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=p0(u)}}function E0(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?E0(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function g0(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=ii(s.document);a instanceof s.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)s=a.contentWindow;else break;a=ii(s.document)}return a}function Po(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var ef=bn&&"documentMode"in document&&11>=document.documentMode,Ir=null,Ho=null,Bs=null,Mo=!1;function y0(s,a,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Mo||Ir==null||Ir!==ii(p)||(p=Ir,"selectionStart"in p&&Po(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Bs&&vs(Bs,p)||(Bs=p,p=eo(Ho,"onSelect"),0<p.length&&(a=new ui("onSelect","select",null,a,u),s.push({event:a,listeners:p}),a.target=Ir)))}function ur(s,a){var u={};return u[s.toLowerCase()]=a.toLowerCase(),u["Webkit"+s]="webkit"+a,u["Moz"+s]="moz"+a,u}var Ur={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionrun:ur("Transition","TransitionRun"),transitionstart:ur("Transition","TransitionStart"),transitioncancel:ur("Transition","TransitionCancel"),transitionend:ur("Transition","TransitionEnd")},Lo={},b0={};bn&&(b0=document.createElement("div").style,"AnimationEvent"in window||(delete Ur.animationend.animation,delete Ur.animationiteration.animation,delete Ur.animationstart.animation),"TransitionEvent"in window||delete Ur.transitionend.transition);function xr(s){if(Lo[s])return Lo[s];if(!Ur[s])return s;var a=Ur[s],u;for(u in a)if(a.hasOwnProperty(u)&&u in b0)return Lo[s]=a[u];return s}var w0=xr("animationend"),A0=xr("animationiteration"),v0=xr("animationstart"),tf=xr("transitionrun"),nf=xr("transitionstart"),rf=xr("transitioncancel"),B0=xr("transitionend"),C0=new Map,Ko="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ko.push("scrollEnd");function ln(s,a){C0.set(s,a),cr(a,[s])}var fi=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},en=[],Or=0,zo=0;function hi(){for(var s=Or,a=zo=Or=0;a<s;){var u=en[a];en[a++]=null;var p=en[a];en[a++]=null;var b=en[a];en[a++]=null;var A=en[a];if(en[a++]=null,p!==null&&b!==null){var V=p.pending;V===null?b.next=b:(b.next=V.next,V.next=b),p.pending=b}A!==0&&_0(u,b,A)}}function pi(s,a,u,p){en[Or++]=s,en[Or++]=a,en[Or++]=u,en[Or++]=p,zo|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function Vo(s,a,u,p){return pi(s,a,u,p),mi(s)}function dr(s,a){return pi(s,null,null,a),mi(s)}function _0(s,a,u){s.lanes|=u;var p=s.alternate;p!==null&&(p.lanes|=u);for(var b=!1,A=s.return;A!==null;)A.childLanes|=u,p=A.alternate,p!==null&&(p.childLanes|=u),A.tag===22&&(s=A.stateNode,s===null||s._visibility&1||(b=!0)),s=A,A=A.return;return s.tag===3?(A=s.stateNode,b&&a!==null&&(b=31-$e(u),s=A.hiddenUpdates,p=s[b],p===null?s[b]=[a]:p.push(a),a.lane=u|536870912),A):null}function mi(s){if(50<qs)throw qs=0,tc=null,Error(r(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var Pr={};function sf(s,a,u,p){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qt(s,a,u,p){return new sf(s,a,u,p)}function qo(s){return s=s.prototype,!(!s||!s.isReactComponent)}function wn(s,a){var u=s.alternate;return u===null?(u=qt(s.tag,a,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=a,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,a=s.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function S0(s,a){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,a=u.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function Ei(s,a,u,p,b,A){var V=0;if(p=s,typeof s=="function")qo(s)&&(V=1);else if(typeof s=="string")V=uh(s,u,ne.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case O:return s=qt(31,u,a,b),s.elementType=O,s.lanes=A,s;case _:return fr(u.children,b,A,a);case F:V=8,b|=24;break;case H:return s=qt(12,u,a,b|2),s.elementType=H,s.lanes=A,s;case N:return s=qt(13,u,a,b),s.elementType=N,s.lanes=A,s;case I:return s=qt(19,u,a,b),s.elementType=I,s.lanes=A,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case T:V=10;break e;case Y:V=9;break e;case L:V=11;break e;case U:V=14;break e;case W:V=16,p=null;break e}V=29,u=Error(r(130,s===null?"null":typeof s,"")),p=null}return a=qt(V,u,a,b),a.elementType=s,a.type=p,a.lanes=A,a}function fr(s,a,u,p){return s=qt(7,s,p,a),s.lanes=u,s}function Go(s,a,u){return s=qt(6,s,null,a),s.lanes=u,s}function D0(s){var a=qt(18,null,null,0);return a.stateNode=s,a}function Wo(s,a,u){return a=qt(4,s.children!==null?s.children:[],s.key,a),a.lanes=u,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var k0=new WeakMap;function tn(s,a){if(typeof s=="object"&&s!==null){var u=k0.get(s);return u!==void 0?u:(a={value:s,source:a,stack:st(a)},k0.set(s,a),a)}return{value:s,source:a,stack:st(a)}}var Hr=[],Mr=0,gi=null,Cs=0,nn=[],rn=0,Pn=null,fn=1,hn="";function An(s,a){Hr[Mr++]=Cs,Hr[Mr++]=gi,gi=s,Cs=a}function F0(s,a,u){nn[rn++]=fn,nn[rn++]=hn,nn[rn++]=Pn,Pn=s;var p=fn;s=hn;var b=32-$e(p)-1;p&=~(1<<b),u+=1;var A=32-$e(a)+b;if(30<A){var V=b-b%5;A=(p&(1<<V)-1).toString(32),p>>=V,b-=V,fn=1<<32-$e(a)+b|u<<b|p,hn=A+s}else fn=1<<A|u<<b|p,hn=s}function Xo(s){s.return!==null&&(An(s,1),F0(s,1,0))}function Yo(s){for(;s===gi;)gi=Hr[--Mr],Hr[Mr]=null,Cs=Hr[--Mr],Hr[Mr]=null;for(;s===Pn;)Pn=nn[--rn],nn[rn]=null,hn=nn[--rn],nn[rn]=null,fn=nn[--rn],nn[rn]=null}function R0(s,a){nn[rn++]=fn,nn[rn++]=hn,nn[rn++]=Pn,fn=a.id,hn=a.overflow,Pn=s}var Tt=null,ht=null,Qe=!1,Hn=null,sn=!1,Zo=Error(r(519));function Mn(s){var a=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw _s(tn(a,s)),Zo}function T0(s){var a=s.stateNode,u=s.type,p=s.memoizedProps;switch(a[Rt]=s,a[Ot]=p,u){case"dialog":We("cancel",a),We("close",a);break;case"iframe":case"object":case"embed":We("load",a);break;case"video":case"audio":for(u=0;u<Ws.length;u++)We(Ws[u],a);break;case"source":We("error",a);break;case"img":case"image":case"link":We("error",a),We("load",a);break;case"details":We("toggle",a);break;case"input":We("invalid",a),Vc(a,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":We("invalid",a);break;case"textarea":We("invalid",a),Gc(a,p.value,p.defaultValue,p.children)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||p.suppressHydrationWarning===!0||Xu(a.textContent,u)?(p.popover!=null&&(We("beforetoggle",a),We("toggle",a)),p.onScroll!=null&&We("scroll",a),p.onScrollEnd!=null&&We("scrollend",a),p.onClick!=null&&(a.onclick=yn),a=!0):a=!1,a||Mn(s,!0)}function N0(s){for(Tt=s.return;Tt;)switch(Tt.tag){case 5:case 31:case 13:sn=!1;return;case 27:case 3:sn=!0;return;default:Tt=Tt.return}}function Lr(s){if(s!==Tt)return!1;if(!Qe)return N0(s),Qe=!0,!1;var a=s.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||mc(s.type,s.memoizedProps)),u=!u),u&&ht&&Mn(s),N0(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));ht=sx(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));ht=sx(s)}else a===27?(a=ht,tr(s.type)?(s=wc,wc=null,ht=s):ht=a):ht=Tt?an(s.stateNode.nextSibling):null;return!0}function hr(){ht=Tt=null,Qe=!1}function Qo(){var s=Hn;return s!==null&&(Kt===null?Kt=s:Kt.push.apply(Kt,s),Hn=null),s}function _s(s){Hn===null?Hn=[s]:Hn.push(s)}var Jo=C(null),pr=null,vn=null;function Ln(s,a,u){J(Jo,a._currentValue),a._currentValue=u}function Bn(s){s._currentValue=Jo.current,K(Jo)}function ea(s,a,u){for(;s!==null;){var p=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),s===u)break;s=s.return}}function ta(s,a,u,p){var b=s.child;for(b!==null&&(b.return=s);b!==null;){var A=b.dependencies;if(A!==null){var V=b.child;A=A.firstContext;e:for(;A!==null;){var se=A;A=b;for(var le=0;le<a.length;le++)if(se.context===a[le]){A.lanes|=u,se=A.alternate,se!==null&&(se.lanes|=u),ea(A.return,u,s),p||(V=null);break e}A=se.next}}else if(b.tag===18){if(V=b.return,V===null)throw Error(r(341));V.lanes|=u,A=V.alternate,A!==null&&(A.lanes|=u),ea(V,u,s),V=null}else V=b.child;if(V!==null)V.return=b;else for(V=b;V!==null;){if(V===s){V=null;break}if(b=V.sibling,b!==null){b.return=V.return,V=b;break}V=V.return}b=V}}function Kr(s,a,u,p){s=null;for(var b=a,A=!1;b!==null;){if(!A){if((b.flags&524288)!==0)A=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var V=b.alternate;if(V===null)throw Error(r(387));if(V=V.memoizedProps,V!==null){var se=b.type;Vt(b.pendingProps.value,V.value)||(s!==null?s.push(se):s=[se])}}else if(b===ce.current){if(V=b.alternate,V===null)throw Error(r(387));V.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(s!==null?s.push(Js):s=[Js])}b=b.return}s!==null&&ta(a,s,u,p),a.flags|=262144}function yi(s){for(s=s.firstContext;s!==null;){if(!Vt(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function mr(s){pr=s,vn=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Nt(s){return $0(pr,s)}function bi(s,a){return pr===null&&mr(s),$0(s,a)}function $0(s,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},vn===null){if(s===null)throw Error(r(308));vn=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else vn=vn.next=a;return u}var of=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(u,p){s.push(p)}};this.abort=function(){a.aborted=!0,s.forEach(function(u){return u()})}},af=e.unstable_scheduleCallback,cf=e.unstable_NormalPriority,Bt={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function na(){return{controller:new of,data:new Map,refCount:0}}function Ss(s){s.refCount--,s.refCount===0&&af(cf,function(){s.controller.abort()})}var Ds=null,ra=0,zr=0,Vr=null;function lf(s,a){if(Ds===null){var u=Ds=[];ra=0,zr=ac(),Vr={status:"pending",value:void 0,then:function(p){u.push(p)}}}return ra++,a.then(j0,j0),a}function j0(){if(--ra===0&&Ds!==null){Vr!==null&&(Vr.status="fulfilled");var s=Ds;Ds=null,zr=0,Vr=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function uf(s,a){var u=[],p={status:"pending",value:null,reason:null,then:function(b){u.push(b)}};return s.then(function(){p.status="fulfilled",p.value=a;for(var b=0;b<u.length;b++)(0,u[b])(a)},function(b){for(p.status="rejected",p.reason=b,b=0;b<u.length;b++)(0,u[b])(void 0)}),p}var I0=R.S;R.S=function(s,a){yu=De(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&lf(s,a),I0!==null&&I0(s,a)};var Er=C(null);function sa(){var s=Er.current;return s!==null?s:ft.pooledCache}function wi(s,a){a===null?J(Er,Er.current):J(Er,a.pool)}function U0(){var s=sa();return s===null?null:{parent:Bt._currentValue,pool:s}}var qr=Error(r(460)),ia=Error(r(474)),Ai=Error(r(542)),vi={then:function(){}};function O0(s){return s=s.status,s==="fulfilled"||s==="rejected"}function P0(s,a,u){switch(u=s[u],u===void 0?s.push(a):u!==a&&(a.then(yn,yn),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,M0(s),s;default:if(typeof a.status=="string")a.then(yn,yn);else{if(s=ft,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=a,s.status="pending",s.then(function(p){if(a.status==="pending"){var b=a;b.status="fulfilled",b.value=p}},function(p){if(a.status==="pending"){var b=a;b.status="rejected",b.reason=p}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,M0(s),s}throw yr=a,qr}}function gr(s){try{var a=s._init;return a(s._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(yr=u,qr):u}}var yr=null;function H0(){if(yr===null)throw Error(r(459));var s=yr;return yr=null,s}function M0(s){if(s===qr||s===Ai)throw Error(r(483))}var Gr=null,ks=0;function Bi(s){var a=ks;return ks+=1,Gr===null&&(Gr=[]),P0(Gr,s,a)}function Fs(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function Ci(s,a){throw a.$$typeof===y?Error(r(525)):(s=Object.prototype.toString.call(a),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function L0(s){function a(he,de){if(s){var me=he.deletions;me===null?(he.deletions=[de],he.flags|=16):me.push(de)}}function u(he,de){if(!s)return null;for(;de!==null;)a(he,de),de=de.sibling;return null}function p(he){for(var de=new Map;he!==null;)he.key!==null?de.set(he.key,he):de.set(he.index,he),he=he.sibling;return de}function b(he,de){return he=wn(he,de),he.index=0,he.sibling=null,he}function A(he,de,me){return he.index=me,s?(me=he.alternate,me!==null?(me=me.index,me<de?(he.flags|=67108866,de):me):(he.flags|=67108866,de)):(he.flags|=1048576,de)}function V(he){return s&&he.alternate===null&&(he.flags|=67108866),he}function se(he,de,me,Be){return de===null||de.tag!==6?(de=Go(me,he.mode,Be),de.return=he,de):(de=b(de,me),de.return=he,de)}function le(he,de,me,Be){var Pe=me.type;return Pe===_?ve(he,de,me.props.children,Be,me.key):de!==null&&(de.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===W&&gr(Pe)===de.type)?(de=b(de,me.props),Fs(de,me),de.return=he,de):(de=Ei(me.type,me.key,me.props,null,he.mode,Be),Fs(de,me),de.return=he,de)}function Ee(he,de,me,Be){return de===null||de.tag!==4||de.stateNode.containerInfo!==me.containerInfo||de.stateNode.implementation!==me.implementation?(de=Wo(me,he.mode,Be),de.return=he,de):(de=b(de,me.children||[]),de.return=he,de)}function ve(he,de,me,Be,Pe){return de===null||de.tag!==7?(de=fr(me,he.mode,Be,Pe),de.return=he,de):(de=b(de,me),de.return=he,de)}function Ce(he,de,me){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return de=Go(""+de,he.mode,me),de.return=he,de;if(typeof de=="object"&&de!==null){switch(de.$$typeof){case w:return me=Ei(de.type,de.key,de.props,null,he.mode,me),Fs(me,de),me.return=he,me;case v:return de=Wo(de,he.mode,me),de.return=he,de;case W:return de=gr(de),Ce(he,de,me)}if(S(de)||q(de))return de=fr(de,he.mode,me,null),de.return=he,de;if(typeof de.then=="function")return Ce(he,Bi(de),me);if(de.$$typeof===T)return Ce(he,bi(he,de),me);Ci(he,de)}return null}function ye(he,de,me,Be){var Pe=de!==null?de.key:null;if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Pe!==null?null:se(he,de,""+me,Be);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case w:return me.key===Pe?le(he,de,me,Be):null;case v:return me.key===Pe?Ee(he,de,me,Be):null;case W:return me=gr(me),ye(he,de,me,Be)}if(S(me)||q(me))return Pe!==null?null:ve(he,de,me,Be,null);if(typeof me.then=="function")return ye(he,de,Bi(me),Be);if(me.$$typeof===T)return ye(he,de,bi(he,me),Be);Ci(he,me)}return null}function Ae(he,de,me,Be,Pe){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return he=he.get(me)||null,se(de,he,""+Be,Pe);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case w:return he=he.get(Be.key===null?me:Be.key)||null,le(de,he,Be,Pe);case v:return he=he.get(Be.key===null?me:Be.key)||null,Ee(de,he,Be,Pe);case W:return Be=gr(Be),Ae(he,de,me,Be,Pe)}if(S(Be)||q(Be))return he=he.get(me)||null,ve(de,he,Be,Pe,null);if(typeof Be.then=="function")return Ae(he,de,me,Bi(Be),Pe);if(Be.$$typeof===T)return Ae(he,de,me,bi(de,Be),Pe);Ci(de,Be)}return null}function Ue(he,de,me,Be){for(var Pe=null,et=null,Oe=de,Ve=de=0,Ze=null;Oe!==null&&Ve<me.length;Ve++){Oe.index>Ve?(Ze=Oe,Oe=null):Ze=Oe.sibling;var tt=ye(he,Oe,me[Ve],Be);if(tt===null){Oe===null&&(Oe=Ze);break}s&&Oe&&tt.alternate===null&&a(he,Oe),de=A(tt,de,Ve),et===null?Pe=tt:et.sibling=tt,et=tt,Oe=Ze}if(Ve===me.length)return u(he,Oe),Qe&&An(he,Ve),Pe;if(Oe===null){for(;Ve<me.length;Ve++)Oe=Ce(he,me[Ve],Be),Oe!==null&&(de=A(Oe,de,Ve),et===null?Pe=Oe:et.sibling=Oe,et=Oe);return Qe&&An(he,Ve),Pe}for(Oe=p(Oe);Ve<me.length;Ve++)Ze=Ae(Oe,he,Ve,me[Ve],Be),Ze!==null&&(s&&Ze.alternate!==null&&Oe.delete(Ze.key===null?Ve:Ze.key),de=A(Ze,de,Ve),et===null?Pe=Ze:et.sibling=Ze,et=Ze);return s&&Oe.forEach(function(or){return a(he,or)}),Qe&&An(he,Ve),Pe}function He(he,de,me,Be){if(me==null)throw Error(r(151));for(var Pe=null,et=null,Oe=de,Ve=de=0,Ze=null,tt=me.next();Oe!==null&&!tt.done;Ve++,tt=me.next()){Oe.index>Ve?(Ze=Oe,Oe=null):Ze=Oe.sibling;var or=ye(he,Oe,tt.value,Be);if(or===null){Oe===null&&(Oe=Ze);break}s&&Oe&&or.alternate===null&&a(he,Oe),de=A(or,de,Ve),et===null?Pe=or:et.sibling=or,et=or,Oe=Ze}if(tt.done)return u(he,Oe),Qe&&An(he,Ve),Pe;if(Oe===null){for(;!tt.done;Ve++,tt=me.next())tt=Ce(he,tt.value,Be),tt!==null&&(de=A(tt,de,Ve),et===null?Pe=tt:et.sibling=tt,et=tt);return Qe&&An(he,Ve),Pe}for(Oe=p(Oe);!tt.done;Ve++,tt=me.next())tt=Ae(Oe,he,Ve,tt.value,Be),tt!==null&&(s&&tt.alternate!==null&&Oe.delete(tt.key===null?Ve:tt.key),de=A(tt,de,Ve),et===null?Pe=tt:et.sibling=tt,et=tt);return s&&Oe.forEach(function(wh){return a(he,wh)}),Qe&&An(he,Ve),Pe}function xt(he,de,me,Be){if(typeof me=="object"&&me!==null&&me.type===_&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case w:e:{for(var Pe=me.key;de!==null;){if(de.key===Pe){if(Pe=me.type,Pe===_){if(de.tag===7){u(he,de.sibling),Be=b(de,me.props.children),Be.return=he,he=Be;break e}}else if(de.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===W&&gr(Pe)===de.type){u(he,de.sibling),Be=b(de,me.props),Fs(Be,me),Be.return=he,he=Be;break e}u(he,de);break}else a(he,de);de=de.sibling}me.type===_?(Be=fr(me.props.children,he.mode,Be,me.key),Be.return=he,he=Be):(Be=Ei(me.type,me.key,me.props,null,he.mode,Be),Fs(Be,me),Be.return=he,he=Be)}return V(he);case v:e:{for(Pe=me.key;de!==null;){if(de.key===Pe)if(de.tag===4&&de.stateNode.containerInfo===me.containerInfo&&de.stateNode.implementation===me.implementation){u(he,de.sibling),Be=b(de,me.children||[]),Be.return=he,he=Be;break e}else{u(he,de);break}else a(he,de);de=de.sibling}Be=Wo(me,he.mode,Be),Be.return=he,he=Be}return V(he);case W:return me=gr(me),xt(he,de,me,Be)}if(S(me))return Ue(he,de,me,Be);if(q(me)){if(Pe=q(me),typeof Pe!="function")throw Error(r(150));return me=Pe.call(me),He(he,de,me,Be)}if(typeof me.then=="function")return xt(he,de,Bi(me),Be);if(me.$$typeof===T)return xt(he,de,bi(he,me),Be);Ci(he,me)}return typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint"?(me=""+me,de!==null&&de.tag===6?(u(he,de.sibling),Be=b(de,me),Be.return=he,he=Be):(u(he,de),Be=Go(me,he.mode,Be),Be.return=he,he=Be),V(he)):u(he,de)}return function(he,de,me,Be){try{ks=0;var Pe=xt(he,de,me,Be);return Gr=null,Pe}catch(Oe){if(Oe===qr||Oe===Ai)throw Oe;var et=qt(29,Oe,null,he.mode);return et.lanes=Be,et.return=he,et}finally{}}}var br=L0(!0),K0=L0(!1),Kn=!1;function oa(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function aa(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function zn(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Vn(s,a,u){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(nt&2)!==0){var b=p.pending;return b===null?a.next=a:(a.next=b.next,b.next=a),p.pending=a,a=mi(s),_0(s,null,u),a}return pi(s,p,a,u),mi(s)}function Rs(s,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var p=a.lanes;p&=s.pendingLanes,u|=p,a.lanes=u,$c(s,u)}}function ca(s,a){var u=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var b=null,A=null;if(u=u.firstBaseUpdate,u!==null){do{var V={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};A===null?b=A=V:A=A.next=V,u=u.next}while(u!==null);A===null?b=A=a:A=A.next=a}else b=A=a;u={baseState:p.baseState,firstBaseUpdate:b,lastBaseUpdate:A,shared:p.shared,callbacks:p.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=a:s.next=a,u.lastBaseUpdate=a}var la=!1;function Ts(){if(la){var s=Vr;if(s!==null)throw s}}function Ns(s,a,u,p){la=!1;var b=s.updateQueue;Kn=!1;var A=b.firstBaseUpdate,V=b.lastBaseUpdate,se=b.shared.pending;if(se!==null){b.shared.pending=null;var le=se,Ee=le.next;le.next=null,V===null?A=Ee:V.next=Ee,V=le;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,se=ve.lastBaseUpdate,se!==V&&(se===null?ve.firstBaseUpdate=Ee:se.next=Ee,ve.lastBaseUpdate=le))}if(A!==null){var Ce=b.baseState;V=0,ve=Ee=le=null,se=A;do{var ye=se.lane&-536870913,Ae=ye!==se.lane;if(Ae?(Ye&ye)===ye:(p&ye)===ye){ye!==0&&ye===zr&&(la=!0),ve!==null&&(ve=ve.next={lane:0,tag:se.tag,payload:se.payload,callback:null,next:null});e:{var Ue=s,He=se;ye=a;var xt=u;switch(He.tag){case 1:if(Ue=He.payload,typeof Ue=="function"){Ce=Ue.call(xt,Ce,ye);break e}Ce=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=He.payload,ye=typeof Ue=="function"?Ue.call(xt,Ce,ye):Ue,ye==null)break e;Ce=g({},Ce,ye);break e;case 2:Kn=!0}}ye=se.callback,ye!==null&&(s.flags|=64,Ae&&(s.flags|=8192),Ae=b.callbacks,Ae===null?b.callbacks=[ye]:Ae.push(ye))}else Ae={lane:ye,tag:se.tag,payload:se.payload,callback:se.callback,next:null},ve===null?(Ee=ve=Ae,le=Ce):ve=ve.next=Ae,V|=ye;if(se=se.next,se===null){if(se=b.shared.pending,se===null)break;Ae=se,se=Ae.next,Ae.next=null,b.lastBaseUpdate=Ae,b.shared.pending=null}}while(!0);ve===null&&(le=Ce),b.baseState=le,b.firstBaseUpdate=Ee,b.lastBaseUpdate=ve,A===null&&(b.shared.lanes=0),Yn|=V,s.lanes=V,s.memoizedState=Ce}}function z0(s,a){if(typeof s!="function")throw Error(r(191,s));s.call(a)}function V0(s,a){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)z0(u[s],a)}var Wr=C(null),_i=C(0);function q0(s,a){s=$n,J(_i,s),J(Wr,a),$n=s|a.baseLanes}function ua(){J(_i,$n),J(Wr,Wr.current)}function xa(){$n=_i.current,K(Wr),K(_i)}var Gt=C(null),on=null;function qn(s){var a=s.alternate;J(At,At.current&1),J(Gt,s),on===null&&(a===null||Wr.current!==null||a.memoizedState!==null)&&(on=s)}function da(s){J(At,At.current),J(Gt,s),on===null&&(on=s)}function G0(s){s.tag===22?(J(At,At.current),J(Gt,s),on===null&&(on=s)):Gn()}function Gn(){J(At,At.current),J(Gt,Gt.current)}function Wt(s){K(Gt),on===s&&(on=null),K(At)}var At=C(0);function Si(s){for(var a=s;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||yc(u)||bc(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Cn=0,ze=null,ct=null,Ct=null,Di=!1,Xr=!1,wr=!1,ki=0,$s=0,Yr=null,xf=0;function gt(){throw Error(r(321))}function fa(s,a){if(a===null)return!1;for(var u=0;u<a.length&&u<s.length;u++)if(!Vt(s[u],a[u]))return!1;return!0}function ha(s,a,u,p,b,A){return Cn=A,ze=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,R.H=s===null||s.memoizedState===null?Fl:Fa,wr=!1,A=u(p,b),wr=!1,Xr&&(A=X0(a,u,p,b)),W0(s),A}function W0(s){R.H=Us;var a=ct!==null&&ct.next!==null;if(Cn=0,Ct=ct=ze=null,Di=!1,$s=0,Yr=null,a)throw Error(r(300));s===null||_t||(s=s.dependencies,s!==null&&yi(s)&&(_t=!0))}function X0(s,a,u,p){ze=s;var b=0;do{if(Xr&&(Yr=null),$s=0,Xr=!1,25<=b)throw Error(r(301));if(b+=1,Ct=ct=null,s.updateQueue!=null){var A=s.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}R.H=Rl,A=a(u,p)}while(Xr);return A}function df(){var s=R.H,a=s.useState()[0];return a=typeof a.then=="function"?js(a):a,s=s.useState()[0],(ct!==null?ct.memoizedState:null)!==s&&(ze.flags|=1024),a}function pa(){var s=ki!==0;return ki=0,s}function ma(s,a,u){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~u}function Ea(s){if(Di){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Di=!1}Cn=0,Ct=ct=ze=null,Xr=!1,$s=ki=0,Yr=null}function Ut(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?ze.memoizedState=Ct=s:Ct=Ct.next=s,Ct}function vt(){if(ct===null){var s=ze.alternate;s=s!==null?s.memoizedState:null}else s=ct.next;var a=Ct===null?ze.memoizedState:Ct.next;if(a!==null)Ct=a,ct=s;else{if(s===null)throw ze.alternate===null?Error(r(467)):Error(r(310));ct=s,s={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},Ct===null?ze.memoizedState=Ct=s:Ct=Ct.next=s}return Ct}function Fi(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function js(s){var a=$s;return $s+=1,Yr===null&&(Yr=[]),s=P0(Yr,s,a),a=ze,(Ct===null?a.memoizedState:Ct.next)===null&&(a=a.alternate,R.H=a===null||a.memoizedState===null?Fl:Fa),s}function Ri(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return js(s);if(s.$$typeof===T)return Nt(s)}throw Error(r(438,String(s)))}function ga(s){var a=null,u=ze.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var p=ze.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(a={data:p.data.map(function(b){return b.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=Fi(),ze.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(s),p=0;p<s;p++)u[p]=Z;return a.index++,u}function _n(s,a){return typeof a=="function"?a(s):a}function Ti(s){var a=vt();return ya(a,ct,s)}function ya(s,a,u){var p=s.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var b=s.baseQueue,A=p.pending;if(A!==null){if(b!==null){var V=b.next;b.next=A.next,A.next=V}a.baseQueue=b=A,p.pending=null}if(A=s.baseState,b===null)s.memoizedState=A;else{a=b.next;var se=V=null,le=null,Ee=a,ve=!1;do{var Ce=Ee.lane&-536870913;if(Ce!==Ee.lane?(Ye&Ce)===Ce:(Cn&Ce)===Ce){var ye=Ee.revertLane;if(ye===0)le!==null&&(le=le.next={lane:0,revertLane:0,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),Ce===zr&&(ve=!0);else if((Cn&ye)===ye){Ee=Ee.next,ye===zr&&(ve=!0);continue}else Ce={lane:0,revertLane:Ee.revertLane,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},le===null?(se=le=Ce,V=A):le=le.next=Ce,ze.lanes|=ye,Yn|=ye;Ce=Ee.action,wr&&u(A,Ce),A=Ee.hasEagerState?Ee.eagerState:u(A,Ce)}else ye={lane:Ce,revertLane:Ee.revertLane,gesture:Ee.gesture,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},le===null?(se=le=ye,V=A):le=le.next=ye,ze.lanes|=Ce,Yn|=Ce;Ee=Ee.next}while(Ee!==null&&Ee!==a);if(le===null?V=A:le.next=se,!Vt(A,s.memoizedState)&&(_t=!0,ve&&(u=Vr,u!==null)))throw u;s.memoizedState=A,s.baseState=V,s.baseQueue=le,p.lastRenderedState=A}return b===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function ba(s){var a=vt(),u=a.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var p=u.dispatch,b=u.pending,A=a.memoizedState;if(b!==null){u.pending=null;var V=b=b.next;do A=s(A,V.action),V=V.next;while(V!==b);Vt(A,a.memoizedState)||(_t=!0),a.memoizedState=A,a.baseQueue===null&&(a.baseState=A),u.lastRenderedState=A}return[A,p]}function Y0(s,a,u){var p=ze,b=vt(),A=Qe;if(A){if(u===void 0)throw Error(r(407));u=u()}else u=a();var V=!Vt((ct||b).memoizedState,u);if(V&&(b.memoizedState=u,_t=!0),b=b.queue,va(J0.bind(null,p,b,s),[s]),b.getSnapshot!==a||V||Ct!==null&&Ct.memoizedState.tag&1){if(p.flags|=2048,Zr(9,{destroy:void 0},Q0.bind(null,p,b,u,a),null),ft===null)throw Error(r(349));A||(Cn&127)!==0||Z0(p,a,u)}return u}function Z0(s,a,u){s.flags|=16384,s={getSnapshot:a,value:u},a=ze.updateQueue,a===null?(a=Fi(),ze.updateQueue=a,a.stores=[s]):(u=a.stores,u===null?a.stores=[s]:u.push(s))}function Q0(s,a,u,p){a.value=u,a.getSnapshot=p,el(a)&&tl(s)}function J0(s,a,u){return u(function(){el(a)&&tl(s)})}function el(s){var a=s.getSnapshot;s=s.value;try{var u=a();return!Vt(s,u)}catch{return!0}}function tl(s){var a=dr(s,2);a!==null&&zt(a,s,2)}function wa(s){var a=Ut();if(typeof s=="function"){var u=s;if(s=u(),wr){Ie(!0);try{u()}finally{Ie(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_n,lastRenderedState:s},a}function nl(s,a,u,p){return s.baseState=u,ya(s,ct,typeof p=="function"?p:_n)}function ff(s,a,u,p,b){if(ji(s))throw Error(r(485));if(s=a.action,s!==null){var A={payload:b,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(V){A.listeners.push(V)}};R.T!==null?u(!0):A.isTransition=!1,p(A),u=a.pending,u===null?(A.next=a.pending=A,rl(a,A)):(A.next=u.next,a.pending=u.next=A)}}function rl(s,a){var u=a.action,p=a.payload,b=s.state;if(a.isTransition){var A=R.T,V={};R.T=V;try{var se=u(b,p),le=R.S;le!==null&&le(V,se),sl(s,a,se)}catch(Ee){Aa(s,a,Ee)}finally{A!==null&&V.types!==null&&(A.types=V.types),R.T=A}}else try{A=u(b,p),sl(s,a,A)}catch(Ee){Aa(s,a,Ee)}}function sl(s,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){il(s,a,p)},function(p){return Aa(s,a,p)}):il(s,a,u)}function il(s,a,u){a.status="fulfilled",a.value=u,ol(a),s.state=u,a=s.pending,a!==null&&(u=a.next,u===a?s.pending=null:(u=u.next,a.next=u,rl(s,u)))}function Aa(s,a,u){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do a.status="rejected",a.reason=u,ol(a),a=a.next;while(a!==p)}s.action=null}function ol(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function al(s,a){return a}function cl(s,a){if(Qe){var u=ft.formState;if(u!==null){e:{var p=ze;if(Qe){if(ht){t:{for(var b=ht,A=sn;b.nodeType!==8;){if(!A){b=null;break t}if(b=an(b.nextSibling),b===null){b=null;break t}}A=b.data,b=A==="F!"||A==="F"?b:null}if(b){ht=an(b.nextSibling),p=b.data==="F!";break e}}Mn(p)}p=!1}p&&(a=u[0])}}return u=Ut(),u.memoizedState=u.baseState=a,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:al,lastRenderedState:a},u.queue=p,u=Sl.bind(null,ze,p),p.dispatch=u,p=wa(!1),A=ka.bind(null,ze,!1,p.queue),p=Ut(),b={state:a,dispatch:null,action:s,pending:null},p.queue=b,u=ff.bind(null,ze,b,A,u),b.dispatch=u,p.memoizedState=s,[a,u,!1]}function ll(s){var a=vt();return ul(a,ct,s)}function ul(s,a,u){if(a=ya(s,a,al)[0],s=Ti(_n)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var p=js(a)}catch(V){throw V===qr?Ai:V}else p=a;a=vt();var b=a.queue,A=b.dispatch;return u!==a.memoizedState&&(ze.flags|=2048,Zr(9,{destroy:void 0},hf.bind(null,b,u),null)),[p,A,s]}function hf(s,a){s.action=a}function xl(s){var a=vt(),u=ct;if(u!==null)return ul(a,u,s);vt(),a=a.memoizedState,u=vt();var p=u.queue.dispatch;return u.memoizedState=s,[a,p,!1]}function Zr(s,a,u,p){return s={tag:s,create:u,deps:p,inst:a,next:null},a=ze.updateQueue,a===null&&(a=Fi(),ze.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=s.next=s:(p=u.next,u.next=s,s.next=p,a.lastEffect=s),s}function dl(){return vt().memoizedState}function Ni(s,a,u,p){var b=Ut();ze.flags|=s,b.memoizedState=Zr(1|a,{destroy:void 0},u,p===void 0?null:p)}function $i(s,a,u,p){var b=vt();p=p===void 0?null:p;var A=b.memoizedState.inst;ct!==null&&p!==null&&fa(p,ct.memoizedState.deps)?b.memoizedState=Zr(a,A,u,p):(ze.flags|=s,b.memoizedState=Zr(1|a,A,u,p))}function fl(s,a){Ni(8390656,8,s,a)}function va(s,a){$i(2048,8,s,a)}function pf(s){ze.flags|=4;var a=ze.updateQueue;if(a===null)a=Fi(),ze.updateQueue=a,a.events=[s];else{var u=a.events;u===null?a.events=[s]:u.push(s)}}function hl(s){var a=vt().memoizedState;return pf({ref:a,nextImpl:s}),function(){if((nt&2)!==0)throw Error(r(440));return a.impl.apply(void 0,arguments)}}function pl(s,a){return $i(4,2,s,a)}function ml(s,a){return $i(4,4,s,a)}function El(s,a){if(typeof a=="function"){s=s();var u=a(s);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function gl(s,a,u){u=u!=null?u.concat([s]):null,$i(4,4,El.bind(null,a,s),u)}function Ba(){}function yl(s,a){var u=vt();a=a===void 0?null:a;var p=u.memoizedState;return a!==null&&fa(a,p[1])?p[0]:(u.memoizedState=[s,a],s)}function bl(s,a){var u=vt();a=a===void 0?null:a;var p=u.memoizedState;if(a!==null&&fa(a,p[1]))return p[0];if(p=s(),wr){Ie(!0);try{s()}finally{Ie(!1)}}return u.memoizedState=[p,a],p}function Ca(s,a,u){return u===void 0||(Cn&1073741824)!==0&&(Ye&261930)===0?s.memoizedState=a:(s.memoizedState=u,s=wu(),ze.lanes|=s,Yn|=s,u)}function wl(s,a,u,p){return Vt(u,a)?u:Wr.current!==null?(s=Ca(s,u,p),Vt(s,a)||(_t=!0),s):(Cn&42)===0||(Cn&1073741824)!==0&&(Ye&261930)===0?(_t=!0,s.memoizedState=u):(s=wu(),ze.lanes|=s,Yn|=s,a)}function Al(s,a,u,p,b){var A=D.p;D.p=A!==0&&8>A?A:8;var V=R.T,se={};R.T=se,ka(s,!1,a,u);try{var le=b(),Ee=R.S;if(Ee!==null&&Ee(se,le),le!==null&&typeof le=="object"&&typeof le.then=="function"){var ve=uf(le,p);Is(s,a,ve,Zt(s))}else Is(s,a,p,Zt(s))}catch(Ce){Is(s,a,{then:function(){},status:"rejected",reason:Ce},Zt())}finally{D.p=A,V!==null&&se.types!==null&&(V.types=se.types),R.T=V}}function mf(){}function Sa(s,a,u,p){if(s.tag!==5)throw Error(r(476));var b=vl(s).queue;Al(s,b,a,j,u===null?mf:function(){return Bl(s),u(p)})}function vl(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_n,lastRenderedState:j},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_n,lastRenderedState:u},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function Bl(s){var a=vl(s);a.next===null&&(a=s.alternate.memoizedState),Is(s,a.next.queue,{},Zt())}function Da(){return Nt(Js)}function Cl(){return vt().memoizedState}function _l(){return vt().memoizedState}function Ef(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var u=Zt();s=zn(u);var p=Vn(a,s,u);p!==null&&(zt(p,a,u),Rs(p,a,u)),a={cache:na()},s.payload=a;return}a=a.return}}function gf(s,a,u){var p=Zt();u={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ji(s)?Dl(a,u):(u=Vo(s,a,u,p),u!==null&&(zt(u,s,p),kl(u,a,p)))}function Sl(s,a,u){var p=Zt();Is(s,a,u,p)}function Is(s,a,u,p){var b={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(ji(s))Dl(a,b);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=a.lastRenderedReducer,A!==null))try{var V=a.lastRenderedState,se=A(V,u);if(b.hasEagerState=!0,b.eagerState=se,Vt(se,V))return pi(s,a,b,0),ft===null&&hi(),!1}catch{}finally{}if(u=Vo(s,a,b,p),u!==null)return zt(u,s,p),kl(u,a,p),!0}return!1}function ka(s,a,u,p){if(p={lane:2,revertLane:ac(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},ji(s)){if(a)throw Error(r(479))}else a=Vo(s,u,p,2),a!==null&&zt(a,s,2)}function ji(s){var a=s.alternate;return s===ze||a!==null&&a===ze}function Dl(s,a){Xr=Di=!0;var u=s.pending;u===null?a.next=a:(a.next=u.next,u.next=a),s.pending=a}function kl(s,a,u){if((u&4194048)!==0){var p=a.lanes;p&=s.pendingLanes,u|=p,a.lanes=u,$c(s,u)}}var Us={readContext:Nt,use:Ri,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useLayoutEffect:gt,useInsertionEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useSyncExternalStore:gt,useId:gt,useHostTransitionStatus:gt,useFormState:gt,useActionState:gt,useOptimistic:gt,useMemoCache:gt,useCacheRefresh:gt};Us.useEffectEvent=gt;var Fl={readContext:Nt,use:Ri,useCallback:function(s,a){return Ut().memoizedState=[s,a===void 0?null:a],s},useContext:Nt,useEffect:fl,useImperativeHandle:function(s,a,u){u=u!=null?u.concat([s]):null,Ni(4194308,4,El.bind(null,a,s),u)},useLayoutEffect:function(s,a){return Ni(4194308,4,s,a)},useInsertionEffect:function(s,a){Ni(4,2,s,a)},useMemo:function(s,a){var u=Ut();a=a===void 0?null:a;var p=s();if(wr){Ie(!0);try{s()}finally{Ie(!1)}}return u.memoizedState=[p,a],p},useReducer:function(s,a,u){var p=Ut();if(u!==void 0){var b=u(a);if(wr){Ie(!0);try{u(a)}finally{Ie(!1)}}}else b=a;return p.memoizedState=p.baseState=b,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:b},p.queue=s,s=s.dispatch=gf.bind(null,ze,s),[p.memoizedState,s]},useRef:function(s){var a=Ut();return s={current:s},a.memoizedState=s},useState:function(s){s=wa(s);var a=s.queue,u=Sl.bind(null,ze,a);return a.dispatch=u,[s.memoizedState,u]},useDebugValue:Ba,useDeferredValue:function(s,a){var u=Ut();return Ca(u,s,a)},useTransition:function(){var s=wa(!1);return s=Al.bind(null,ze,s.queue,!0,!1),Ut().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,u){var p=ze,b=Ut();if(Qe){if(u===void 0)throw Error(r(407));u=u()}else{if(u=a(),ft===null)throw Error(r(349));(Ye&127)!==0||Z0(p,a,u)}b.memoizedState=u;var A={value:u,getSnapshot:a};return b.queue=A,fl(J0.bind(null,p,A,s),[s]),p.flags|=2048,Zr(9,{destroy:void 0},Q0.bind(null,p,A,u,a),null),u},useId:function(){var s=Ut(),a=ft.identifierPrefix;if(Qe){var u=hn,p=fn;u=(p&~(1<<32-$e(p)-1)).toString(32)+u,a="_"+a+"R_"+u,u=ki++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=xf++,a="_"+a+"r_"+u.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:Da,useFormState:cl,useActionState:cl,useOptimistic:function(s){var a=Ut();a.memoizedState=a.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=ka.bind(null,ze,!0,u),u.dispatch=a,[s,a]},useMemoCache:ga,useCacheRefresh:function(){return Ut().memoizedState=Ef.bind(null,ze)},useEffectEvent:function(s){var a=Ut(),u={impl:s};return a.memoizedState=u,function(){if((nt&2)!==0)throw Error(r(440));return u.impl.apply(void 0,arguments)}}},Fa={readContext:Nt,use:Ri,useCallback:yl,useContext:Nt,useEffect:va,useImperativeHandle:gl,useInsertionEffect:pl,useLayoutEffect:ml,useMemo:bl,useReducer:Ti,useRef:dl,useState:function(){return Ti(_n)},useDebugValue:Ba,useDeferredValue:function(s,a){var u=vt();return wl(u,ct.memoizedState,s,a)},useTransition:function(){var s=Ti(_n)[0],a=vt().memoizedState;return[typeof s=="boolean"?s:js(s),a]},useSyncExternalStore:Y0,useId:Cl,useHostTransitionStatus:Da,useFormState:ll,useActionState:ll,useOptimistic:function(s,a){var u=vt();return nl(u,ct,s,a)},useMemoCache:ga,useCacheRefresh:_l};Fa.useEffectEvent=hl;var Rl={readContext:Nt,use:Ri,useCallback:yl,useContext:Nt,useEffect:va,useImperativeHandle:gl,useInsertionEffect:pl,useLayoutEffect:ml,useMemo:bl,useReducer:ba,useRef:dl,useState:function(){return ba(_n)},useDebugValue:Ba,useDeferredValue:function(s,a){var u=vt();return ct===null?Ca(u,s,a):wl(u,ct.memoizedState,s,a)},useTransition:function(){var s=ba(_n)[0],a=vt().memoizedState;return[typeof s=="boolean"?s:js(s),a]},useSyncExternalStore:Y0,useId:Cl,useHostTransitionStatus:Da,useFormState:xl,useActionState:xl,useOptimistic:function(s,a){var u=vt();return ct!==null?nl(u,ct,s,a):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:ga,useCacheRefresh:_l};Rl.useEffectEvent=hl;function Ra(s,a,u,p){a=s.memoizedState,u=u(p,a),u=u==null?a:g({},a,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Ta={enqueueSetState:function(s,a,u){s=s._reactInternals;var p=Zt(),b=zn(p);b.payload=a,u!=null&&(b.callback=u),a=Vn(s,b,p),a!==null&&(zt(a,s,p),Rs(a,s,p))},enqueueReplaceState:function(s,a,u){s=s._reactInternals;var p=Zt(),b=zn(p);b.tag=1,b.payload=a,u!=null&&(b.callback=u),a=Vn(s,b,p),a!==null&&(zt(a,s,p),Rs(a,s,p))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var u=Zt(),p=zn(u);p.tag=2,a!=null&&(p.callback=a),a=Vn(s,p,u),a!==null&&(zt(a,s,u),Rs(a,s,u))}};function Tl(s,a,u,p,b,A,V){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,A,V):a.prototype&&a.prototype.isPureReactComponent?!vs(u,p)||!vs(b,A):!0}function Nl(s,a,u,p){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,p),a.state!==s&&Ta.enqueueReplaceState(a,a.state,null)}function Ar(s,a){var u=a;if("ref"in a){u={};for(var p in a)p!=="ref"&&(u[p]=a[p])}if(s=s.defaultProps){u===a&&(u=g({},u));for(var b in s)u[b]===void 0&&(u[b]=s[b])}return u}function $l(s){fi(s)}function jl(s){console.error(s)}function Il(s){fi(s)}function Ii(s,a){try{var u=s.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(p){setTimeout(function(){throw p})}}function Ul(s,a,u){try{var p=s.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function Na(s,a,u){return u=zn(u),u.tag=3,u.payload={element:null},u.callback=function(){Ii(s,a)},u}function Ol(s){return s=zn(s),s.tag=3,s}function Pl(s,a,u,p){var b=u.type.getDerivedStateFromError;if(typeof b=="function"){var A=p.value;s.payload=function(){return b(A)},s.callback=function(){Ul(a,u,p)}}var V=u.stateNode;V!==null&&typeof V.componentDidCatch=="function"&&(s.callback=function(){Ul(a,u,p),typeof b!="function"&&(Zn===null?Zn=new Set([this]):Zn.add(this));var se=p.stack;this.componentDidCatch(p.value,{componentStack:se!==null?se:""})})}function yf(s,a,u,p,b){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(a=u.alternate,a!==null&&Kr(a,u,b,!0),u=Gt.current,u!==null){switch(u.tag){case 31:case 13:return on===null?Wi():u.alternate===null&&yt===0&&(yt=3),u.flags&=-257,u.flags|=65536,u.lanes=b,p===vi?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([p]):a.add(p),sc(s,p,b)),!1;case 22:return u.flags|=65536,p===vi?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([p]):u.add(p)),sc(s,p,b)),!1}throw Error(r(435,u.tag))}return sc(s,p,b),Wi(),!1}if(Qe)return a=Gt.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=b,p!==Zo&&(s=Error(r(422),{cause:p}),_s(tn(s,u)))):(p!==Zo&&(a=Error(r(423),{cause:p}),_s(tn(a,u))),s=s.current.alternate,s.flags|=65536,b&=-b,s.lanes|=b,p=tn(p,u),b=Na(s.stateNode,p,b),ca(s,b),yt!==4&&(yt=2)),!1;var A=Error(r(520),{cause:p});if(A=tn(A,u),Vs===null?Vs=[A]:Vs.push(A),yt!==4&&(yt=2),a===null)return!0;p=tn(p,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,s=b&-b,u.lanes|=s,s=Na(u.stateNode,p,s),ca(u,s),!1;case 1:if(a=u.type,A=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Zn===null||!Zn.has(A))))return u.flags|=65536,b&=-b,u.lanes|=b,b=Ol(b),Pl(b,s,u,p),ca(u,b),!1}u=u.return}while(u!==null);return!1}var $a=Error(r(461)),_t=!1;function $t(s,a,u,p){a.child=s===null?K0(a,null,u,p):br(a,s.child,u,p)}function Hl(s,a,u,p,b){u=u.render;var A=a.ref;if("ref"in p){var V={};for(var se in p)se!=="ref"&&(V[se]=p[se])}else V=p;return mr(a),p=ha(s,a,u,V,A,b),se=pa(),s!==null&&!_t?(ma(s,a,b),Sn(s,a,b)):(Qe&&se&&Xo(a),a.flags|=1,$t(s,a,p,b),a.child)}function Ml(s,a,u,p,b){if(s===null){var A=u.type;return typeof A=="function"&&!qo(A)&&A.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=A,Ll(s,a,A,p,b)):(s=Ei(u.type,null,p,a,a.mode,b),s.ref=a.ref,s.return=a,a.child=s)}if(A=s.child,!La(s,b)){var V=A.memoizedProps;if(u=u.compare,u=u!==null?u:vs,u(V,p)&&s.ref===a.ref)return Sn(s,a,b)}return a.flags|=1,s=wn(A,p),s.ref=a.ref,s.return=a,a.child=s}function Ll(s,a,u,p,b){if(s!==null){var A=s.memoizedProps;if(vs(A,p)&&s.ref===a.ref)if(_t=!1,a.pendingProps=p=A,La(s,b))(s.flags&131072)!==0&&(_t=!0);else return a.lanes=s.lanes,Sn(s,a,b)}return ja(s,a,u,p,b)}function Kl(s,a,u,p){var b=p.children,A=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((a.flags&128)!==0){if(A=A!==null?A.baseLanes|u:u,s!==null){for(p=a.child=s.child,b=0;p!==null;)b=b|p.lanes|p.childLanes,p=p.sibling;p=b&~A}else p=0,a.child=null;return zl(s,a,A,u,p)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&wi(a,A!==null?A.cachePool:null),A!==null?q0(a,A):ua(),G0(a);else return p=a.lanes=536870912,zl(s,a,A!==null?A.baseLanes|u:u,u,p)}else A!==null?(wi(a,A.cachePool),q0(a,A),Gn(),a.memoizedState=null):(s!==null&&wi(a,null),ua(),Gn());return $t(s,a,b,u),a.child}function Os(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function zl(s,a,u,p,b){var A=sa();return A=A===null?null:{parent:Bt._currentValue,pool:A},a.memoizedState={baseLanes:u,cachePool:A},s!==null&&wi(a,null),ua(),G0(a),s!==null&&Kr(s,a,p,!0),a.childLanes=b,null}function Ui(s,a){return a=Pi({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Vl(s,a,u){return br(a,s.child,null,u),s=Ui(a,a.pendingProps),s.flags|=2,Wt(a),a.memoizedState=null,s}function bf(s,a,u){var p=a.pendingProps,b=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Qe){if(p.mode==="hidden")return s=Ui(a,p),a.lanes=536870912,Os(null,s);if(da(a),(s=ht)?(s=rx(s,sn),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Pn!==null?{id:fn,overflow:hn}:null,retryLane:536870912,hydrationErrors:null},u=D0(s),u.return=a,a.child=u,Tt=a,ht=null)):s=null,s===null)throw Mn(a);return a.lanes=536870912,null}return Ui(a,p)}var A=s.memoizedState;if(A!==null){var V=A.dehydrated;if(da(a),b)if(a.flags&256)a.flags&=-257,a=Vl(s,a,u);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(r(558));else if(_t||Kr(s,a,u,!1),b=(u&s.childLanes)!==0,_t||b){if(p=ft,p!==null&&(V=jc(p,u),V!==0&&V!==A.retryLane))throw A.retryLane=V,dr(s,V),zt(p,s,V),$a;Wi(),a=Vl(s,a,u)}else s=A.treeContext,ht=an(V.nextSibling),Tt=a,Qe=!0,Hn=null,sn=!1,s!==null&&R0(a,s),a=Ui(a,p),a.flags|=4096;return a}return s=wn(s.child,{mode:p.mode,children:p.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Oi(s,a){var u=a.ref;if(u===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(s===null||s.ref!==u)&&(a.flags|=4194816)}}function ja(s,a,u,p,b){return mr(a),u=ha(s,a,u,p,void 0,b),p=pa(),s!==null&&!_t?(ma(s,a,b),Sn(s,a,b)):(Qe&&p&&Xo(a),a.flags|=1,$t(s,a,u,b),a.child)}function ql(s,a,u,p,b,A){return mr(a),a.updateQueue=null,u=X0(a,p,u,b),W0(s),p=pa(),s!==null&&!_t?(ma(s,a,A),Sn(s,a,A)):(Qe&&p&&Xo(a),a.flags|=1,$t(s,a,u,A),a.child)}function Gl(s,a,u,p,b){if(mr(a),a.stateNode===null){var A=Pr,V=u.contextType;typeof V=="object"&&V!==null&&(A=Nt(V)),A=new u(p,A),a.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Ta,a.stateNode=A,A._reactInternals=a,A=a.stateNode,A.props=p,A.state=a.memoizedState,A.refs={},oa(a),V=u.contextType,A.context=typeof V=="object"&&V!==null?Nt(V):Pr,A.state=a.memoizedState,V=u.getDerivedStateFromProps,typeof V=="function"&&(Ra(a,u,V,p),A.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(V=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),V!==A.state&&Ta.enqueueReplaceState(A,A.state,null),Ns(a,p,A,b),Ts(),A.state=a.memoizedState),typeof A.componentDidMount=="function"&&(a.flags|=4194308),p=!0}else if(s===null){A=a.stateNode;var se=a.memoizedProps,le=Ar(u,se);A.props=le;var Ee=A.context,ve=u.contextType;V=Pr,typeof ve=="object"&&ve!==null&&(V=Nt(ve));var Ce=u.getDerivedStateFromProps;ve=typeof Ce=="function"||typeof A.getSnapshotBeforeUpdate=="function",se=a.pendingProps!==se,ve||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(se||Ee!==V)&&Nl(a,A,p,V),Kn=!1;var ye=a.memoizedState;A.state=ye,Ns(a,p,A,b),Ts(),Ee=a.memoizedState,se||ye!==Ee||Kn?(typeof Ce=="function"&&(Ra(a,u,Ce,p),Ee=a.memoizedState),(le=Kn||Tl(a,u,le,p,ye,Ee,V))?(ve||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(a.flags|=4194308)):(typeof A.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=Ee),A.props=p,A.state=Ee,A.context=V,p=le):(typeof A.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{A=a.stateNode,aa(s,a),V=a.memoizedProps,ve=Ar(u,V),A.props=ve,Ce=a.pendingProps,ye=A.context,Ee=u.contextType,le=Pr,typeof Ee=="object"&&Ee!==null&&(le=Nt(Ee)),se=u.getDerivedStateFromProps,(Ee=typeof se=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(V!==Ce||ye!==le)&&Nl(a,A,p,le),Kn=!1,ye=a.memoizedState,A.state=ye,Ns(a,p,A,b),Ts();var Ae=a.memoizedState;V!==Ce||ye!==Ae||Kn||s!==null&&s.dependencies!==null&&yi(s.dependencies)?(typeof se=="function"&&(Ra(a,u,se,p),Ae=a.memoizedState),(ve=Kn||Tl(a,u,ve,p,ye,Ae,le)||s!==null&&s.dependencies!==null&&yi(s.dependencies))?(Ee||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(p,Ae,le),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(p,Ae,le)),typeof A.componentDidUpdate=="function"&&(a.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof A.componentDidUpdate!="function"||V===s.memoizedProps&&ye===s.memoizedState||(a.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||V===s.memoizedProps&&ye===s.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=Ae),A.props=p,A.state=Ae,A.context=le,p=ve):(typeof A.componentDidUpdate!="function"||V===s.memoizedProps&&ye===s.memoizedState||(a.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||V===s.memoizedProps&&ye===s.memoizedState||(a.flags|=1024),p=!1)}return A=p,Oi(s,a),p=(a.flags&128)!==0,A||p?(A=a.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:A.render(),a.flags|=1,s!==null&&p?(a.child=br(a,s.child,null,b),a.child=br(a,null,u,b)):$t(s,a,u,b),a.memoizedState=A.state,s=a.child):s=Sn(s,a,b),s}function Wl(s,a,u,p){return hr(),a.flags|=256,$t(s,a,u,p),a.child}var Ia={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ua(s){return{baseLanes:s,cachePool:U0()}}function Oa(s,a,u){return s=s!==null?s.childLanes&~u:0,a&&(s|=Yt),s}function Xl(s,a,u){var p=a.pendingProps,b=!1,A=(a.flags&128)!==0,V;if((V=A)||(V=s!==null&&s.memoizedState===null?!1:(At.current&2)!==0),V&&(b=!0,a.flags&=-129),V=(a.flags&32)!==0,a.flags&=-33,s===null){if(Qe){if(b?qn(a):Gn(),(s=ht)?(s=rx(s,sn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Pn!==null?{id:fn,overflow:hn}:null,retryLane:536870912,hydrationErrors:null},u=D0(s),u.return=a,a.child=u,Tt=a,ht=null)):s=null,s===null)throw Mn(a);return bc(s)?a.lanes=32:a.lanes=536870912,null}var se=p.children;return p=p.fallback,b?(Gn(),b=a.mode,se=Pi({mode:"hidden",children:se},b),p=fr(p,b,u,null),se.return=a,p.return=a,se.sibling=p,a.child=se,p=a.child,p.memoizedState=Ua(u),p.childLanes=Oa(s,V,u),a.memoizedState=Ia,Os(null,p)):(qn(a),Pa(a,se))}var le=s.memoizedState;if(le!==null&&(se=le.dehydrated,se!==null)){if(A)a.flags&256?(qn(a),a.flags&=-257,a=Ha(s,a,u)):a.memoizedState!==null?(Gn(),a.child=s.child,a.flags|=128,a=null):(Gn(),se=p.fallback,b=a.mode,p=Pi({mode:"visible",children:p.children},b),se=fr(se,b,u,null),se.flags|=2,p.return=a,se.return=a,p.sibling=se,a.child=p,br(a,s.child,null,u),p=a.child,p.memoizedState=Ua(u),p.childLanes=Oa(s,V,u),a.memoizedState=Ia,a=Os(null,p));else if(qn(a),bc(se)){if(V=se.nextSibling&&se.nextSibling.dataset,V)var Ee=V.dgst;V=Ee,p=Error(r(419)),p.stack="",p.digest=V,_s({value:p,source:null,stack:null}),a=Ha(s,a,u)}else if(_t||Kr(s,a,u,!1),V=(u&s.childLanes)!==0,_t||V){if(V=ft,V!==null&&(p=jc(V,u),p!==0&&p!==le.retryLane))throw le.retryLane=p,dr(s,p),zt(V,s,p),$a;yc(se)||Wi(),a=Ha(s,a,u)}else yc(se)?(a.flags|=192,a.child=s.child,a=null):(s=le.treeContext,ht=an(se.nextSibling),Tt=a,Qe=!0,Hn=null,sn=!1,s!==null&&R0(a,s),a=Pa(a,p.children),a.flags|=4096);return a}return b?(Gn(),se=p.fallback,b=a.mode,le=s.child,Ee=le.sibling,p=wn(le,{mode:"hidden",children:p.children}),p.subtreeFlags=le.subtreeFlags&65011712,Ee!==null?se=wn(Ee,se):(se=fr(se,b,u,null),se.flags|=2),se.return=a,p.return=a,p.sibling=se,a.child=p,Os(null,p),p=a.child,se=s.child.memoizedState,se===null?se=Ua(u):(b=se.cachePool,b!==null?(le=Bt._currentValue,b=b.parent!==le?{parent:le,pool:le}:b):b=U0(),se={baseLanes:se.baseLanes|u,cachePool:b}),p.memoizedState=se,p.childLanes=Oa(s,V,u),a.memoizedState=Ia,Os(s.child,p)):(qn(a),u=s.child,s=u.sibling,u=wn(u,{mode:"visible",children:p.children}),u.return=a,u.sibling=null,s!==null&&(V=a.deletions,V===null?(a.deletions=[s],a.flags|=16):V.push(s)),a.child=u,a.memoizedState=null,u)}function Pa(s,a){return a=Pi({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Pi(s,a){return s=qt(22,s,null,a),s.lanes=0,s}function Ha(s,a,u){return br(a,s.child,null,u),s=Pa(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function Yl(s,a,u){s.lanes|=a;var p=s.alternate;p!==null&&(p.lanes|=a),ea(s.return,a,u)}function Ma(s,a,u,p,b,A){var V=s.memoizedState;V===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:b,treeForkCount:A}:(V.isBackwards=a,V.rendering=null,V.renderingStartTime=0,V.last=p,V.tail=u,V.tailMode=b,V.treeForkCount=A)}function Zl(s,a,u){var p=a.pendingProps,b=p.revealOrder,A=p.tail;p=p.children;var V=At.current,se=(V&2)!==0;if(se?(V=V&1|2,a.flags|=128):V&=1,J(At,V),$t(s,a,p,u),p=Qe?Cs:0,!se&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Yl(s,u,a);else if(s.tag===19)Yl(s,u,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(b){case"forwards":for(u=a.child,b=null;u!==null;)s=u.alternate,s!==null&&Si(s)===null&&(b=u),u=u.sibling;u=b,u===null?(b=a.child,a.child=null):(b=u.sibling,u.sibling=null),Ma(a,!1,b,u,A,p);break;case"backwards":case"unstable_legacy-backwards":for(u=null,b=a.child,a.child=null;b!==null;){if(s=b.alternate,s!==null&&Si(s)===null){a.child=b;break}s=b.sibling,b.sibling=u,u=b,b=s}Ma(a,!0,u,null,A,p);break;case"together":Ma(a,!1,null,null,void 0,p);break;default:a.memoizedState=null}return a.child}function Sn(s,a,u){if(s!==null&&(a.dependencies=s.dependencies),Yn|=a.lanes,(u&a.childLanes)===0)if(s!==null){if(Kr(s,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(r(153));if(a.child!==null){for(s=a.child,u=wn(s,s.pendingProps),a.child=u,u.return=a;s.sibling!==null;)s=s.sibling,u=u.sibling=wn(s,s.pendingProps),u.return=a;u.sibling=null}return a.child}function La(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&yi(s)))}function wf(s,a,u){switch(a.tag){case 3:ue(a,a.stateNode.containerInfo),Ln(a,Bt,s.memoizedState.cache),hr();break;case 27:case 5:we(a);break;case 4:ue(a,a.stateNode.containerInfo);break;case 10:Ln(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,da(a),null;break;case 13:var p=a.memoizedState;if(p!==null)return p.dehydrated!==null?(qn(a),a.flags|=128,null):(u&a.child.childLanes)!==0?Xl(s,a,u):(qn(a),s=Sn(s,a,u),s!==null?s.sibling:null);qn(a);break;case 19:var b=(s.flags&128)!==0;if(p=(u&a.childLanes)!==0,p||(Kr(s,a,u,!1),p=(u&a.childLanes)!==0),b){if(p)return Zl(s,a,u);a.flags|=128}if(b=a.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),J(At,At.current),p)break;return null;case 22:return a.lanes=0,Kl(s,a,u,a.pendingProps);case 24:Ln(a,Bt,s.memoizedState.cache)}return Sn(s,a,u)}function Ql(s,a,u){if(s!==null)if(s.memoizedProps!==a.pendingProps)_t=!0;else{if(!La(s,u)&&(a.flags&128)===0)return _t=!1,wf(s,a,u);_t=(s.flags&131072)!==0}else _t=!1,Qe&&(a.flags&1048576)!==0&&F0(a,Cs,a.index);switch(a.lanes=0,a.tag){case 16:e:{var p=a.pendingProps;if(s=gr(a.elementType),a.type=s,typeof s=="function")qo(s)?(p=Ar(s,p),a.tag=1,a=Gl(null,a,s,p,u)):(a.tag=0,a=ja(null,a,s,p,u));else{if(s!=null){var b=s.$$typeof;if(b===L){a.tag=11,a=Hl(null,a,s,p,u);break e}else if(b===U){a.tag=14,a=Ml(null,a,s,p,u);break e}}throw a=M(s)||s,Error(r(306,a,""))}}return a;case 0:return ja(s,a,a.type,a.pendingProps,u);case 1:return p=a.type,b=Ar(p,a.pendingProps),Gl(s,a,p,b,u);case 3:e:{if(ue(a,a.stateNode.containerInfo),s===null)throw Error(r(387));p=a.pendingProps;var A=a.memoizedState;b=A.element,aa(s,a),Ns(a,p,null,u);var V=a.memoizedState;if(p=V.cache,Ln(a,Bt,p),p!==A.cache&&ta(a,[Bt],u,!0),Ts(),p=V.element,A.isDehydrated)if(A={element:p,isDehydrated:!1,cache:V.cache},a.updateQueue.baseState=A,a.memoizedState=A,a.flags&256){a=Wl(s,a,p,u);break e}else if(p!==b){b=tn(Error(r(424)),a),_s(b),a=Wl(s,a,p,u);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ht=an(s.firstChild),Tt=a,Qe=!0,Hn=null,sn=!0,u=K0(a,null,p,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(hr(),p===b){a=Sn(s,a,u);break e}$t(s,a,p,u)}a=a.child}return a;case 26:return Oi(s,a),s===null?(u=lx(a.type,null,a.pendingProps,null))?a.memoizedState=u:Qe||(u=a.type,s=a.pendingProps,p=to(ie.current).createElement(u),p[Rt]=a,p[Ot]=s,jt(p,u,s),kt(p),a.stateNode=p):a.memoizedState=lx(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return we(a),s===null&&Qe&&(p=a.stateNode=ox(a.type,a.pendingProps,ie.current),Tt=a,sn=!0,b=ht,tr(a.type)?(wc=b,ht=an(p.firstChild)):ht=b),$t(s,a,a.pendingProps.children,u),Oi(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Qe&&((b=p=ht)&&(p=Zf(p,a.type,a.pendingProps,sn),p!==null?(a.stateNode=p,Tt=a,ht=an(p.firstChild),sn=!1,b=!0):b=!1),b||Mn(a)),we(a),b=a.type,A=a.pendingProps,V=s!==null?s.memoizedProps:null,p=A.children,mc(b,A)?p=null:V!==null&&mc(b,V)&&(a.flags|=32),a.memoizedState!==null&&(b=ha(s,a,df,null,null,u),Js._currentValue=b),Oi(s,a),$t(s,a,p,u),a.child;case 6:return s===null&&Qe&&((s=u=ht)&&(u=Qf(u,a.pendingProps,sn),u!==null?(a.stateNode=u,Tt=a,ht=null,s=!0):s=!1),s||Mn(a)),null;case 13:return Xl(s,a,u);case 4:return ue(a,a.stateNode.containerInfo),p=a.pendingProps,s===null?a.child=br(a,null,p,u):$t(s,a,p,u),a.child;case 11:return Hl(s,a,a.type,a.pendingProps,u);case 7:return $t(s,a,a.pendingProps,u),a.child;case 8:return $t(s,a,a.pendingProps.children,u),a.child;case 12:return $t(s,a,a.pendingProps.children,u),a.child;case 10:return p=a.pendingProps,Ln(a,a.type,p.value),$t(s,a,p.children,u),a.child;case 9:return b=a.type._context,p=a.pendingProps.children,mr(a),b=Nt(b),p=p(b),a.flags|=1,$t(s,a,p,u),a.child;case 14:return Ml(s,a,a.type,a.pendingProps,u);case 15:return Ll(s,a,a.type,a.pendingProps,u);case 19:return Zl(s,a,u);case 31:return bf(s,a,u);case 22:return Kl(s,a,u,a.pendingProps);case 24:return mr(a),p=Nt(Bt),s===null?(b=sa(),b===null&&(b=ft,A=na(),b.pooledCache=A,A.refCount++,A!==null&&(b.pooledCacheLanes|=u),b=A),a.memoizedState={parent:p,cache:b},oa(a),Ln(a,Bt,b)):((s.lanes&u)!==0&&(aa(s,a),Ns(a,null,null,u),Ts()),b=s.memoizedState,A=a.memoizedState,b.parent!==p?(b={parent:p,cache:p},a.memoizedState=b,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=b),Ln(a,Bt,p)):(p=A.cache,Ln(a,Bt,p),p!==b.cache&&ta(a,[Bt],u,!0))),$t(s,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function Dn(s){s.flags|=4}function Ka(s,a,u,p,b){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(b&335544128)===b)if(s.stateNode.complete)s.flags|=8192;else if(Cu())s.flags|=8192;else throw yr=vi,ia}else s.flags&=-16777217}function Jl(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!hx(a))if(Cu())s.flags|=8192;else throw yr=vi,ia}function Hi(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Tc():536870912,s.lanes|=a,ts|=a)}function Ps(s,a){if(!Qe)switch(s.tailMode){case"hidden":a=s.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function pt(s){var a=s.alternate!==null&&s.alternate.child===s.child,u=0,p=0;if(a)for(var b=s.child;b!==null;)u|=b.lanes|b.childLanes,p|=b.subtreeFlags&65011712,p|=b.flags&65011712,b.return=s,b=b.sibling;else for(b=s.child;b!==null;)u|=b.lanes|b.childLanes,p|=b.subtreeFlags,p|=b.flags,b.return=s,b=b.sibling;return s.subtreeFlags|=p,s.childLanes=u,a}function Af(s,a,u){var p=a.pendingProps;switch(Yo(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(a),null;case 1:return pt(a),null;case 3:return u=a.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),a.memoizedState.cache!==p&&(a.flags|=2048),Bn(Bt),ae(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Lr(a)?Dn(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Qo())),pt(a),null;case 26:var b=a.type,A=a.memoizedState;return s===null?(Dn(a),A!==null?(pt(a),Jl(a,A)):(pt(a),Ka(a,b,null,p,u))):A?A!==s.memoizedState?(Dn(a),pt(a),Jl(a,A)):(pt(a),a.flags&=-16777217):(s=s.memoizedProps,s!==p&&Dn(a),pt(a),Ka(a,b,s,p,u)),null;case 27:if(ke(a),u=ie.current,b=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==p&&Dn(a);else{if(!p){if(a.stateNode===null)throw Error(r(166));return pt(a),null}s=ne.current,Lr(a)?T0(a):(s=ox(b,p,u),a.stateNode=s,Dn(a))}return pt(a),null;case 5:if(ke(a),b=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==p&&Dn(a);else{if(!p){if(a.stateNode===null)throw Error(r(166));return pt(a),null}if(A=ne.current,Lr(a))T0(a);else{var V=to(ie.current);switch(A){case 1:A=V.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:A=V.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":A=V.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":A=V.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":A=V.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof p.is=="string"?V.createElement("select",{is:p.is}):V.createElement("select"),p.multiple?A.multiple=!0:p.size&&(A.size=p.size);break;default:A=typeof p.is=="string"?V.createElement(b,{is:p.is}):V.createElement(b)}}A[Rt]=a,A[Ot]=p;e:for(V=a.child;V!==null;){if(V.tag===5||V.tag===6)A.appendChild(V.stateNode);else if(V.tag!==4&&V.tag!==27&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===a)break e;for(;V.sibling===null;){if(V.return===null||V.return===a)break e;V=V.return}V.sibling.return=V.return,V=V.sibling}a.stateNode=A;e:switch(jt(A,b,p),b){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Dn(a)}}return pt(a),Ka(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,u),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==p&&Dn(a);else{if(typeof p!="string"&&a.stateNode===null)throw Error(r(166));if(s=ie.current,Lr(a)){if(s=a.stateNode,u=a.memoizedProps,p=null,b=Tt,b!==null)switch(b.tag){case 27:case 5:p=b.memoizedProps}s[Rt]=a,s=!!(s.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||Xu(s.nodeValue,u)),s||Mn(a,!0)}else s=to(s).createTextNode(p),s[Rt]=a,a.stateNode=s}return pt(a),null;case 31:if(u=a.memoizedState,s===null||s.memoizedState!==null){if(p=Lr(a),u!==null){if(s===null){if(!p)throw Error(r(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Rt]=a}else hr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;pt(a),s=!1}else u=Qo(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=u),s=!0;if(!s)return a.flags&256?(Wt(a),a):(Wt(a),null);if((a.flags&128)!==0)throw Error(r(558))}return pt(a),null;case 13:if(p=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(b=Lr(a),p!==null&&p.dehydrated!==null){if(s===null){if(!b)throw Error(r(318));if(b=a.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));b[Rt]=a}else hr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;pt(a),b=!1}else b=Qo(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=b),b=!0;if(!b)return a.flags&256?(Wt(a),a):(Wt(a),null)}return Wt(a),(a.flags&128)!==0?(a.lanes=u,a):(u=p!==null,s=s!==null&&s.memoizedState!==null,u&&(p=a.child,b=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(b=p.alternate.memoizedState.cachePool.pool),A=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(A=p.memoizedState.cachePool.pool),A!==b&&(p.flags|=2048)),u!==s&&u&&(a.child.flags|=8192),Hi(a,a.updateQueue),pt(a),null);case 4:return ae(),s===null&&xc(a.stateNode.containerInfo),pt(a),null;case 10:return Bn(a.type),pt(a),null;case 19:if(K(At),p=a.memoizedState,p===null)return pt(a),null;if(b=(a.flags&128)!==0,A=p.rendering,A===null)if(b)Ps(p,!1);else{if(yt!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(A=Si(s),A!==null){for(a.flags|=128,Ps(p,!1),s=A.updateQueue,a.updateQueue=s,Hi(a,s),a.subtreeFlags=0,s=u,u=a.child;u!==null;)S0(u,s),u=u.sibling;return J(At,At.current&1|2),Qe&&An(a,p.treeForkCount),a.child}s=s.sibling}p.tail!==null&&De()>Vi&&(a.flags|=128,b=!0,Ps(p,!1),a.lanes=4194304)}else{if(!b)if(s=Si(A),s!==null){if(a.flags|=128,b=!0,s=s.updateQueue,a.updateQueue=s,Hi(a,s),Ps(p,!0),p.tail===null&&p.tailMode==="hidden"&&!A.alternate&&!Qe)return pt(a),null}else 2*De()-p.renderingStartTime>Vi&&u!==536870912&&(a.flags|=128,b=!0,Ps(p,!1),a.lanes=4194304);p.isBackwards?(A.sibling=a.child,a.child=A):(s=p.last,s!==null?s.sibling=A:a.child=A,p.last=A)}return p.tail!==null?(s=p.tail,p.rendering=s,p.tail=s.sibling,p.renderingStartTime=De(),s.sibling=null,u=At.current,J(At,b?u&1|2:u&1),Qe&&An(a,p.treeForkCount),s):(pt(a),null);case 22:case 23:return Wt(a),xa(),p=a.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(a.flags|=8192):p&&(a.flags|=8192),p?(u&536870912)!==0&&(a.flags&128)===0&&(pt(a),a.subtreeFlags&6&&(a.flags|=8192)):pt(a),u=a.updateQueue,u!==null&&Hi(a,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),p=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),p!==u&&(a.flags|=2048),s!==null&&K(Er),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Bn(Bt),pt(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function vf(s,a){switch(Yo(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Bn(Bt),ae(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return ke(a),null;case 31:if(a.memoizedState!==null){if(Wt(a),a.alternate===null)throw Error(r(340));hr()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Wt(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(r(340));hr()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return K(At),null;case 4:return ae(),null;case 10:return Bn(a.type),null;case 22:case 23:return Wt(a),xa(),s!==null&&K(Er),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Bn(Bt),null;case 25:return null;default:return null}}function eu(s,a){switch(Yo(a),a.tag){case 3:Bn(Bt),ae();break;case 26:case 27:case 5:ke(a);break;case 4:ae();break;case 31:a.memoizedState!==null&&Wt(a);break;case 13:Wt(a);break;case 19:K(At);break;case 10:Bn(a.type);break;case 22:case 23:Wt(a),xa(),s!==null&&K(Er);break;case 24:Bn(Bt)}}function Hs(s,a){try{var u=a.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var b=p.next;u=b;do{if((u.tag&s)===s){p=void 0;var A=u.create,V=u.inst;p=A(),V.destroy=p}u=u.next}while(u!==b)}}catch(se){ot(a,a.return,se)}}function Wn(s,a,u){try{var p=a.updateQueue,b=p!==null?p.lastEffect:null;if(b!==null){var A=b.next;p=A;do{if((p.tag&s)===s){var V=p.inst,se=V.destroy;if(se!==void 0){V.destroy=void 0,b=a;var le=u,Ee=se;try{Ee()}catch(ve){ot(b,le,ve)}}}p=p.next}while(p!==A)}}catch(ve){ot(a,a.return,ve)}}function tu(s){var a=s.updateQueue;if(a!==null){var u=s.stateNode;try{V0(a,u)}catch(p){ot(s,s.return,p)}}}function nu(s,a,u){u.props=Ar(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(p){ot(s,a,p)}}function Ms(s,a){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof u=="function"?s.refCleanup=u(p):u.current=p}}catch(b){ot(s,a,b)}}function pn(s,a){var u=s.ref,p=s.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(b){ot(s,a,b)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(b){ot(s,a,b)}else u.current=null}function ru(s){var a=s.type,u=s.memoizedProps,p=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(b){ot(s,s.return,b)}}function za(s,a,u){try{var p=s.stateNode;Vf(p,s.type,u,a),p[Ot]=a}catch(b){ot(s,s.return,b)}}function su(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&tr(s.type)||s.tag===4}function Va(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||su(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&tr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function qa(s,a,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(s),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=yn));else if(p!==4&&(p===27&&tr(s.type)&&(u=s.stateNode,a=null),s=s.child,s!==null))for(qa(s,a,u),s=s.sibling;s!==null;)qa(s,a,u),s=s.sibling}function Mi(s,a,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,a?u.insertBefore(s,a):u.appendChild(s);else if(p!==4&&(p===27&&tr(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(Mi(s,a,u),s=s.sibling;s!==null;)Mi(s,a,u),s=s.sibling}function iu(s){var a=s.stateNode,u=s.memoizedProps;try{for(var p=s.type,b=a.attributes;b.length;)a.removeAttributeNode(b[0]);jt(a,p,u),a[Rt]=s,a[Ot]=u}catch(A){ot(s,s.return,A)}}var kn=!1,St=!1,Ga=!1,ou=typeof WeakSet=="function"?WeakSet:Set,Ft=null;function Bf(s,a){if(s=s.containerInfo,hc=co,s=g0(s),Po(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var b=p.anchorOffset,A=p.focusNode;p=p.focusOffset;try{u.nodeType,A.nodeType}catch{u=null;break e}var V=0,se=-1,le=-1,Ee=0,ve=0,Ce=s,ye=null;t:for(;;){for(var Ae;Ce!==u||b!==0&&Ce.nodeType!==3||(se=V+b),Ce!==A||p!==0&&Ce.nodeType!==3||(le=V+p),Ce.nodeType===3&&(V+=Ce.nodeValue.length),(Ae=Ce.firstChild)!==null;)ye=Ce,Ce=Ae;for(;;){if(Ce===s)break t;if(ye===u&&++Ee===b&&(se=V),ye===A&&++ve===p&&(le=V),(Ae=Ce.nextSibling)!==null)break;Ce=ye,ye=Ce.parentNode}Ce=Ae}u=se===-1||le===-1?null:{start:se,end:le}}else u=null}u=u||{start:0,end:0}}else u=null;for(pc={focusedElem:s,selectionRange:u},co=!1,Ft=a;Ft!==null;)if(a=Ft,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Ft=s;else for(;Ft!==null;){switch(a=Ft,A=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(u=0;u<s.length;u++)b=s[u],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&A!==null){s=void 0,u=a,b=A.memoizedProps,A=A.memoizedState,p=u.stateNode;try{var Ue=Ar(u.type,b);s=p.getSnapshotBeforeUpdate(Ue,A),p.__reactInternalSnapshotBeforeUpdate=s}catch(He){ot(u,u.return,He)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,u=s.nodeType,u===9)gc(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":gc(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=a.sibling,s!==null){s.return=a.return,Ft=s;break}Ft=a.return}}function au(s,a,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Tn(s,u),p&4&&Hs(5,u);break;case 1:if(Tn(s,u),p&4)if(s=u.stateNode,a===null)try{s.componentDidMount()}catch(V){ot(u,u.return,V)}else{var b=Ar(u.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(b,a,s.__reactInternalSnapshotBeforeUpdate)}catch(V){ot(u,u.return,V)}}p&64&&tu(u),p&512&&Ms(u,u.return);break;case 3:if(Tn(s,u),p&64&&(s=u.updateQueue,s!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{V0(s,a)}catch(V){ot(u,u.return,V)}}break;case 27:a===null&&p&4&&iu(u);case 26:case 5:Tn(s,u),a===null&&p&4&&ru(u),p&512&&Ms(u,u.return);break;case 12:Tn(s,u);break;case 31:Tn(s,u),p&4&&uu(s,u);break;case 13:Tn(s,u),p&4&&xu(s,u),p&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=Nf.bind(null,u),Jf(s,u))));break;case 22:if(p=u.memoizedState!==null||kn,!p){a=a!==null&&a.memoizedState!==null||St,b=kn;var A=St;kn=p,(St=a)&&!A?Nn(s,u,(u.subtreeFlags&8772)!==0):Tn(s,u),kn=b,St=A}break;case 30:break;default:Tn(s,u)}}function cu(s){var a=s.alternate;a!==null&&(s.alternate=null,cu(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Ao(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Et=null,Ht=!1;function Rn(s,a,u){for(u=u.child;u!==null;)lu(s,a,u),u=u.sibling}function lu(s,a,u){if(Ne&&typeof Ne.onCommitFiberUnmount=="function")try{Ne.onCommitFiberUnmount(pe,u)}catch{}switch(u.tag){case 26:St||pn(u,a),Rn(s,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:St||pn(u,a);var p=Et,b=Ht;tr(u.type)&&(Et=u.stateNode,Ht=!1),Rn(s,a,u),Ys(u.stateNode),Et=p,Ht=b;break;case 5:St||pn(u,a);case 6:if(p=Et,b=Ht,Et=null,Rn(s,a,u),Et=p,Ht=b,Et!==null)if(Ht)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(u.stateNode)}catch(A){ot(u,a,A)}else try{Et.removeChild(u.stateNode)}catch(A){ot(u,a,A)}break;case 18:Et!==null&&(Ht?(s=Et,tx(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),us(s)):tx(Et,u.stateNode));break;case 4:p=Et,b=Ht,Et=u.stateNode.containerInfo,Ht=!0,Rn(s,a,u),Et=p,Ht=b;break;case 0:case 11:case 14:case 15:Wn(2,u,a),St||Wn(4,u,a),Rn(s,a,u);break;case 1:St||(pn(u,a),p=u.stateNode,typeof p.componentWillUnmount=="function"&&nu(u,a,p)),Rn(s,a,u);break;case 21:Rn(s,a,u);break;case 22:St=(p=St)||u.memoizedState!==null,Rn(s,a,u),St=p;break;default:Rn(s,a,u)}}function uu(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{us(s)}catch(u){ot(a,a.return,u)}}}function xu(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{us(s)}catch(u){ot(a,a.return,u)}}function Cf(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new ou),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new ou),a;default:throw Error(r(435,s.tag))}}function Li(s,a){var u=Cf(s);a.forEach(function(p){if(!u.has(p)){u.add(p);var b=$f.bind(null,s,p);p.then(b,b)}})}function Mt(s,a){var u=a.deletions;if(u!==null)for(var p=0;p<u.length;p++){var b=u[p],A=s,V=a,se=V;e:for(;se!==null;){switch(se.tag){case 27:if(tr(se.type)){Et=se.stateNode,Ht=!1;break e}break;case 5:Et=se.stateNode,Ht=!1;break e;case 3:case 4:Et=se.stateNode.containerInfo,Ht=!0;break e}se=se.return}if(Et===null)throw Error(r(160));lu(A,V,b),Et=null,Ht=!1,A=b.alternate,A!==null&&(A.return=null),b.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)du(a,s),a=a.sibling}var un=null;function du(s,a){var u=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Mt(a,s),Lt(s),p&4&&(Wn(3,s,s.return),Hs(3,s),Wn(5,s,s.return));break;case 1:Mt(a,s),Lt(s),p&512&&(St||u===null||pn(u,u.return)),p&64&&kn&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var b=un;if(Mt(a,s),Lt(s),p&512&&(St||u===null||pn(u,u.return)),p&4){var A=u!==null?u.memoizedState:null;if(p=s.memoizedState,u===null)if(p===null)if(s.stateNode===null){e:{p=s.type,u=s.memoizedProps,b=b.ownerDocument||b;t:switch(p){case"title":A=b.getElementsByTagName("title")[0],(!A||A[fs]||A[Rt]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=b.createElement(p),b.head.insertBefore(A,b.querySelector("head > title"))),jt(A,p,u),A[Rt]=s,kt(A),p=A;break e;case"link":var V=dx("link","href",b).get(p+(u.href||""));if(V){for(var se=0;se<V.length;se++)if(A=V[se],A.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&A.getAttribute("rel")===(u.rel==null?null:u.rel)&&A.getAttribute("title")===(u.title==null?null:u.title)&&A.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){V.splice(se,1);break t}}A=b.createElement(p),jt(A,p,u),b.head.appendChild(A);break;case"meta":if(V=dx("meta","content",b).get(p+(u.content||""))){for(se=0;se<V.length;se++)if(A=V[se],A.getAttribute("content")===(u.content==null?null:""+u.content)&&A.getAttribute("name")===(u.name==null?null:u.name)&&A.getAttribute("property")===(u.property==null?null:u.property)&&A.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&A.getAttribute("charset")===(u.charSet==null?null:u.charSet)){V.splice(se,1);break t}}A=b.createElement(p),jt(A,p,u),b.head.appendChild(A);break;default:throw Error(r(468,p))}A[Rt]=s,kt(A),p=A}s.stateNode=p}else fx(b,s.type,s.stateNode);else s.stateNode=xx(b,p,s.memoizedProps);else A!==p?(A===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):A.count--,p===null?fx(b,s.type,s.stateNode):xx(b,p,s.memoizedProps)):p===null&&s.stateNode!==null&&za(s,s.memoizedProps,u.memoizedProps)}break;case 27:Mt(a,s),Lt(s),p&512&&(St||u===null||pn(u,u.return)),u!==null&&p&4&&za(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Mt(a,s),Lt(s),p&512&&(St||u===null||pn(u,u.return)),s.flags&32){b=s.stateNode;try{Tr(b,"")}catch(Ue){ot(s,s.return,Ue)}}p&4&&s.stateNode!=null&&(b=s.memoizedProps,za(s,b,u!==null?u.memoizedProps:b)),p&1024&&(Ga=!0);break;case 6:if(Mt(a,s),Lt(s),p&4){if(s.stateNode===null)throw Error(r(162));p=s.memoizedProps,u=s.stateNode;try{u.nodeValue=p}catch(Ue){ot(s,s.return,Ue)}}break;case 3:if(so=null,b=un,un=no(a.containerInfo),Mt(a,s),un=b,Lt(s),p&4&&u!==null&&u.memoizedState.isDehydrated)try{us(a.containerInfo)}catch(Ue){ot(s,s.return,Ue)}Ga&&(Ga=!1,fu(s));break;case 4:p=un,un=no(s.stateNode.containerInfo),Mt(a,s),Lt(s),un=p;break;case 12:Mt(a,s),Lt(s);break;case 31:Mt(a,s),Lt(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,Li(s,p)));break;case 13:Mt(a,s),Lt(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(zi=De()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,Li(s,p)));break;case 22:b=s.memoizedState!==null;var le=u!==null&&u.memoizedState!==null,Ee=kn,ve=St;if(kn=Ee||b,St=ve||le,Mt(a,s),St=ve,kn=Ee,Lt(s),p&8192)e:for(a=s.stateNode,a._visibility=b?a._visibility&-2:a._visibility|1,b&&(u===null||le||kn||St||vr(s)),u=null,a=s;;){if(a.tag===5||a.tag===26){if(u===null){le=u=a;try{if(A=le.stateNode,b)V=A.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none";else{se=le.stateNode;var Ce=le.memoizedProps.style,ye=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null;se.style.display=ye==null||typeof ye=="boolean"?"":(""+ye).trim()}}catch(Ue){ot(le,le.return,Ue)}}}else if(a.tag===6){if(u===null){le=a;try{le.stateNode.nodeValue=b?"":le.memoizedProps}catch(Ue){ot(le,le.return,Ue)}}}else if(a.tag===18){if(u===null){le=a;try{var Ae=le.stateNode;b?nx(Ae,!0):nx(le.stateNode,!1)}catch(Ue){ot(le,le.return,Ue)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}p&4&&(p=s.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,Li(s,u))));break;case 19:Mt(a,s),Lt(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,Li(s,p)));break;case 30:break;case 21:break;default:Mt(a,s),Lt(s)}}function Lt(s){var a=s.flags;if(a&2){try{for(var u,p=s.return;p!==null;){if(su(p)){u=p;break}p=p.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var b=u.stateNode,A=Va(s);Mi(s,A,b);break;case 5:var V=u.stateNode;u.flags&32&&(Tr(V,""),u.flags&=-33);var se=Va(s);Mi(s,se,V);break;case 3:case 4:var le=u.stateNode.containerInfo,Ee=Va(s);qa(s,Ee,le);break;default:throw Error(r(161))}}catch(ve){ot(s,s.return,ve)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function fu(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;fu(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function Tn(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)au(s,a.alternate,a),a=a.sibling}function vr(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Wn(4,a,a.return),vr(a);break;case 1:pn(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&nu(a,a.return,u),vr(a);break;case 27:Ys(a.stateNode);case 26:case 5:pn(a,a.return),vr(a);break;case 22:a.memoizedState===null&&vr(a);break;case 30:vr(a);break;default:vr(a)}s=s.sibling}}function Nn(s,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var p=a.alternate,b=s,A=a,V=A.flags;switch(A.tag){case 0:case 11:case 15:Nn(b,A,u),Hs(4,A);break;case 1:if(Nn(b,A,u),p=A,b=p.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Ee){ot(p,p.return,Ee)}if(p=A,b=p.updateQueue,b!==null){var se=p.stateNode;try{var le=b.shared.hiddenCallbacks;if(le!==null)for(b.shared.hiddenCallbacks=null,b=0;b<le.length;b++)z0(le[b],se)}catch(Ee){ot(p,p.return,Ee)}}u&&V&64&&tu(A),Ms(A,A.return);break;case 27:iu(A);case 26:case 5:Nn(b,A,u),u&&p===null&&V&4&&ru(A),Ms(A,A.return);break;case 12:Nn(b,A,u);break;case 31:Nn(b,A,u),u&&V&4&&uu(b,A);break;case 13:Nn(b,A,u),u&&V&4&&xu(b,A);break;case 22:A.memoizedState===null&&Nn(b,A,u),Ms(A,A.return);break;case 30:break;default:Nn(b,A,u)}a=a.sibling}}function Wa(s,a){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Ss(u))}function Xa(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ss(s))}function xn(s,a,u,p){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)hu(s,a,u,p),a=a.sibling}function hu(s,a,u,p){var b=a.flags;switch(a.tag){case 0:case 11:case 15:xn(s,a,u,p),b&2048&&Hs(9,a);break;case 1:xn(s,a,u,p);break;case 3:xn(s,a,u,p),b&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ss(s)));break;case 12:if(b&2048){xn(s,a,u,p),s=a.stateNode;try{var A=a.memoizedProps,V=A.id,se=A.onPostCommit;typeof se=="function"&&se(V,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(le){ot(a,a.return,le)}}else xn(s,a,u,p);break;case 31:xn(s,a,u,p);break;case 13:xn(s,a,u,p);break;case 23:break;case 22:A=a.stateNode,V=a.alternate,a.memoizedState!==null?A._visibility&2?xn(s,a,u,p):Ls(s,a):A._visibility&2?xn(s,a,u,p):(A._visibility|=2,Qr(s,a,u,p,(a.subtreeFlags&10256)!==0||!1)),b&2048&&Wa(V,a);break;case 24:xn(s,a,u,p),b&2048&&Xa(a.alternate,a);break;default:xn(s,a,u,p)}}function Qr(s,a,u,p,b){for(b=b&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var A=s,V=a,se=u,le=p,Ee=V.flags;switch(V.tag){case 0:case 11:case 15:Qr(A,V,se,le,b),Hs(8,V);break;case 23:break;case 22:var ve=V.stateNode;V.memoizedState!==null?ve._visibility&2?Qr(A,V,se,le,b):Ls(A,V):(ve._visibility|=2,Qr(A,V,se,le,b)),b&&Ee&2048&&Wa(V.alternate,V);break;case 24:Qr(A,V,se,le,b),b&&Ee&2048&&Xa(V.alternate,V);break;default:Qr(A,V,se,le,b)}a=a.sibling}}function Ls(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=s,p=a,b=p.flags;switch(p.tag){case 22:Ls(u,p),b&2048&&Wa(p.alternate,p);break;case 24:Ls(u,p),b&2048&&Xa(p.alternate,p);break;default:Ls(u,p)}a=a.sibling}}var Ks=8192;function Jr(s,a,u){if(s.subtreeFlags&Ks)for(s=s.child;s!==null;)pu(s,a,u),s=s.sibling}function pu(s,a,u){switch(s.tag){case 26:Jr(s,a,u),s.flags&Ks&&s.memoizedState!==null&&xh(u,un,s.memoizedState,s.memoizedProps);break;case 5:Jr(s,a,u);break;case 3:case 4:var p=un;un=no(s.stateNode.containerInfo),Jr(s,a,u),un=p;break;case 22:s.memoizedState===null&&(p=s.alternate,p!==null&&p.memoizedState!==null?(p=Ks,Ks=16777216,Jr(s,a,u),Ks=p):Jr(s,a,u));break;default:Jr(s,a,u)}}function mu(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function zs(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var p=a[u];Ft=p,gu(p,s)}mu(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Eu(s),s=s.sibling}function Eu(s){switch(s.tag){case 0:case 11:case 15:zs(s),s.flags&2048&&Wn(9,s,s.return);break;case 3:zs(s);break;case 12:zs(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Ki(s)):zs(s);break;default:zs(s)}}function Ki(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var p=a[u];Ft=p,gu(p,s)}mu(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Wn(8,a,a.return),Ki(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,Ki(a));break;default:Ki(a)}s=s.sibling}}function gu(s,a){for(;Ft!==null;){var u=Ft;switch(u.tag){case 0:case 11:case 15:Wn(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Ss(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Ft=p;else e:for(u=s;Ft!==null;){p=Ft;var b=p.sibling,A=p.return;if(cu(p),p===u){Ft=null;break e}if(b!==null){b.return=A,Ft=b;break e}Ft=A}}}var _f={getCacheForType:function(s){var a=Nt(Bt),u=a.data.get(s);return u===void 0&&(u=s(),a.data.set(s,u)),u},cacheSignal:function(){return Nt(Bt).controller.signal}},Sf=typeof WeakMap=="function"?WeakMap:Map,nt=0,ft=null,Ge=null,Ye=0,it=0,Xt=null,Xn=!1,es=!1,Ya=!1,$n=0,yt=0,Yn=0,Br=0,Za=0,Yt=0,ts=0,Vs=null,Kt=null,Qa=!1,zi=0,yu=0,Vi=1/0,qi=null,Zn=null,Dt=0,Qn=null,ns=null,jn=0,Ja=0,ec=null,bu=null,qs=0,tc=null;function Zt(){return(nt&2)!==0&&Ye!==0?Ye&-Ye:R.T!==null?ac():Ic()}function wu(){if(Yt===0)if((Ye&536870912)===0||Qe){var s=wt;wt<<=1,(wt&3932160)===0&&(wt=262144),Yt=s}else Yt=536870912;return s=Gt.current,s!==null&&(s.flags|=32),Yt}function zt(s,a,u){(s===ft&&(it===2||it===9)||s.cancelPendingCommit!==null)&&(rs(s,0),Jn(s,Ye,Yt,!1)),ds(s,u),((nt&2)===0||s!==ft)&&(s===ft&&((nt&2)===0&&(Br|=u),yt===4&&Jn(s,Ye,Yt,!1)),mn(s))}function Au(s,a,u){if((nt&6)!==0)throw Error(r(327));var p=!u&&(a&127)===0&&(a&s.expiredLanes)===0||xs(s,a),b=p?Ff(s,a):rc(s,a,!0),A=p;do{if(b===0){es&&!p&&Jn(s,a,0,!1);break}else{if(u=s.current.alternate,A&&!Df(u)){b=rc(s,a,!1),A=!1;continue}if(b===2){if(A=a,s.errorRecoveryDisabledLanes&A)var V=0;else V=s.pendingLanes&-536870913,V=V!==0?V:V&536870912?536870912:0;if(V!==0){a=V;e:{var se=s;b=Vs;var le=se.current.memoizedState.isDehydrated;if(le&&(rs(se,V).flags|=256),V=rc(se,V,!1),V!==2){if(Ya&&!le){se.errorRecoveryDisabledLanes|=A,Br|=A,b=4;break e}A=Kt,Kt=b,A!==null&&(Kt===null?Kt=A:Kt.push.apply(Kt,A))}b=V}if(A=!1,b!==2)continue}}if(b===1){rs(s,0),Jn(s,a,0,!0);break}e:{switch(p=s,A=b,A){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:Jn(p,a,Yt,!Xn);break e;case 2:Kt=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(b=zi+300-De(),10<b)){if(Jn(p,a,Yt,!Xn),ar(p,0,!0)!==0)break e;jn=a,p.timeoutHandle=Ju(vu.bind(null,p,u,Kt,qi,Qa,a,Yt,Br,ts,Xn,A,"Throttled",-0,0),b);break e}vu(p,u,Kt,qi,Qa,a,Yt,Br,ts,Xn,A,null,-0,0)}}break}while(!0);mn(s)}function vu(s,a,u,p,b,A,V,se,le,Ee,ve,Ce,ye,Ae){if(s.timeoutHandle=-1,Ce=a.subtreeFlags,Ce&8192||(Ce&16785408)===16785408){Ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yn},pu(a,A,Ce);var Ue=(A&62914560)===A?zi-De():(A&4194048)===A?yu-De():0;if(Ue=dh(Ce,Ue),Ue!==null){jn=A,s.cancelPendingCommit=Ue(Ru.bind(null,s,a,A,u,p,b,V,se,le,ve,Ce,null,ye,Ae)),Jn(s,A,V,!Ee);return}}Ru(s,a,A,u,p,b,V,se,le)}function Df(s){for(var a=s;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var b=u[p],A=b.getSnapshot;b=b.value;try{if(!Vt(A(),b))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Jn(s,a,u,p){a&=~Za,a&=~Br,s.suspendedLanes|=a,s.pingedLanes&=~a,p&&(s.warmLanes|=a),p=s.expirationTimes;for(var b=a;0<b;){var A=31-$e(b),V=1<<A;p[A]=-1,b&=~V}u!==0&&Nc(s,u,a)}function Gi(){return(nt&6)===0?(Gs(0),!1):!0}function nc(){if(Ge!==null){if(it===0)var s=Ge.return;else s=Ge,vn=pr=null,Ea(s),Gr=null,ks=0,s=Ge;for(;s!==null;)eu(s.alternate,s),s=s.return;Ge=null}}function rs(s,a){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,Wf(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),jn=0,nc(),ft=s,Ge=u=wn(s.current,null),Ye=a,it=0,Xt=null,Xn=!1,es=xs(s,a),Ya=!1,ts=Yt=Za=Br=Yn=yt=0,Kt=Vs=null,Qa=!1,(a&8)!==0&&(a|=a&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=a;0<p;){var b=31-$e(p),A=1<<b;a|=s[b],p&=~A}return $n=a,hi(),u}function Bu(s,a){ze=null,R.H=Us,a===qr||a===Ai?(a=H0(),it=3):a===ia?(a=H0(),it=4):it=a===$a?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Xt=a,Ge===null&&(yt=1,Ii(s,tn(a,s.current)))}function Cu(){var s=Gt.current;return s===null?!0:(Ye&4194048)===Ye?on===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?s===on:!1}function _u(){var s=R.H;return R.H=Us,s===null?Us:s}function Su(){var s=R.A;return R.A=_f,s}function Wi(){yt=4,Xn||(Ye&4194048)!==Ye&&Gt.current!==null||(es=!0),(Yn&134217727)===0&&(Br&134217727)===0||ft===null||Jn(ft,Ye,Yt,!1)}function rc(s,a,u){var p=nt;nt|=2;var b=_u(),A=Su();(ft!==s||Ye!==a)&&(qi=null,rs(s,a)),a=!1;var V=yt;e:do try{if(it!==0&&Ge!==null){var se=Ge,le=Xt;switch(it){case 8:nc(),V=6;break e;case 3:case 2:case 9:case 6:Gt.current===null&&(a=!0);var Ee=it;if(it=0,Xt=null,ss(s,se,le,Ee),u&&es){V=0;break e}break;default:Ee=it,it=0,Xt=null,ss(s,se,le,Ee)}}kf(),V=yt;break}catch(ve){Bu(s,ve)}while(!0);return a&&s.shellSuspendCounter++,vn=pr=null,nt=p,R.H=b,R.A=A,Ge===null&&(ft=null,Ye=0,hi()),V}function kf(){for(;Ge!==null;)Du(Ge)}function Ff(s,a){var u=nt;nt|=2;var p=_u(),b=Su();ft!==s||Ye!==a?(qi=null,Vi=De()+500,rs(s,a)):es=xs(s,a);e:do try{if(it!==0&&Ge!==null){a=Ge;var A=Xt;t:switch(it){case 1:it=0,Xt=null,ss(s,a,A,1);break;case 2:case 9:if(O0(A)){it=0,Xt=null,ku(a);break}a=function(){it!==2&&it!==9||ft!==s||(it=7),mn(s)},A.then(a,a);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:O0(A)?(it=0,Xt=null,ku(a)):(it=0,Xt=null,ss(s,a,A,7));break;case 5:var V=null;switch(Ge.tag){case 26:V=Ge.memoizedState;case 5:case 27:var se=Ge;if(V?hx(V):se.stateNode.complete){it=0,Xt=null;var le=se.sibling;if(le!==null)Ge=le;else{var Ee=se.return;Ee!==null?(Ge=Ee,Xi(Ee)):Ge=null}break t}}it=0,Xt=null,ss(s,a,A,5);break;case 6:it=0,Xt=null,ss(s,a,A,6);break;case 8:nc(),yt=6;break e;default:throw Error(r(462))}}Rf();break}catch(ve){Bu(s,ve)}while(!0);return vn=pr=null,R.H=p,R.A=b,nt=u,Ge!==null?0:(ft=null,Ye=0,hi(),yt)}function Rf(){for(;Ge!==null&&!mt();)Du(Ge)}function Du(s){var a=Ql(s.alternate,s,$n);s.memoizedProps=s.pendingProps,a===null?Xi(s):Ge=a}function ku(s){var a=s,u=a.alternate;switch(a.tag){case 15:case 0:a=ql(u,a,a.pendingProps,a.type,void 0,Ye);break;case 11:a=ql(u,a,a.pendingProps,a.type.render,a.ref,Ye);break;case 5:Ea(a);default:eu(u,a),a=Ge=S0(a,$n),a=Ql(u,a,$n)}s.memoizedProps=s.pendingProps,a===null?Xi(s):Ge=a}function ss(s,a,u,p){vn=pr=null,Ea(a),Gr=null,ks=0;var b=a.return;try{if(yf(s,b,a,u,Ye)){yt=1,Ii(s,tn(u,s.current)),Ge=null;return}}catch(A){if(b!==null)throw Ge=b,A;yt=1,Ii(s,tn(u,s.current)),Ge=null;return}a.flags&32768?(Qe||p===1?s=!0:es||(Ye&536870912)!==0?s=!1:(Xn=s=!0,(p===2||p===9||p===3||p===6)&&(p=Gt.current,p!==null&&p.tag===13&&(p.flags|=16384))),Fu(a,s)):Xi(a)}function Xi(s){var a=s;do{if((a.flags&32768)!==0){Fu(a,Xn);return}s=a.return;var u=Af(a.alternate,a,$n);if(u!==null){Ge=u;return}if(a=a.sibling,a!==null){Ge=a;return}Ge=a=s}while(a!==null);yt===0&&(yt=5)}function Fu(s,a){do{var u=vf(s.alternate,s);if(u!==null){u.flags&=32767,Ge=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(s=s.sibling,s!==null)){Ge=s;return}Ge=s=u}while(s!==null);yt=6,Ge=null}function Ru(s,a,u,p,b,A,V,se,le){s.cancelPendingCommit=null;do Yi();while(Dt!==0);if((nt&6)!==0)throw Error(r(327));if(a!==null){if(a===s.current)throw Error(r(177));if(A=a.lanes|a.childLanes,A|=zo,ld(s,u,A,V,se,le),s===ft&&(Ge=ft=null,Ye=0),ns=a,Qn=s,jn=u,Ja=A,ec=b,bu=p,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,jf(B,function(){return Iu(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||p){p=R.T,R.T=null,b=D.p,D.p=2,V=nt,nt|=4;try{Bf(s,a,u)}finally{nt=V,D.p=b,R.T=p}}Dt=1,Tu(),Nu(),$u()}}function Tu(){if(Dt===1){Dt=0;var s=Qn,a=ns,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=R.T,R.T=null;var p=D.p;D.p=2;var b=nt;nt|=4;try{du(a,s);var A=pc,V=g0(s.containerInfo),se=A.focusedElem,le=A.selectionRange;if(V!==se&&se&&se.ownerDocument&&E0(se.ownerDocument.documentElement,se)){if(le!==null&&Po(se)){var Ee=le.start,ve=le.end;if(ve===void 0&&(ve=Ee),"selectionStart"in se)se.selectionStart=Ee,se.selectionEnd=Math.min(ve,se.value.length);else{var Ce=se.ownerDocument||document,ye=Ce&&Ce.defaultView||window;if(ye.getSelection){var Ae=ye.getSelection(),Ue=se.textContent.length,He=Math.min(le.start,Ue),xt=le.end===void 0?He:Math.min(le.end,Ue);!Ae.extend&&He>xt&&(V=xt,xt=He,He=V);var he=m0(se,He),de=m0(se,xt);if(he&&de&&(Ae.rangeCount!==1||Ae.anchorNode!==he.node||Ae.anchorOffset!==he.offset||Ae.focusNode!==de.node||Ae.focusOffset!==de.offset)){var me=Ce.createRange();me.setStart(he.node,he.offset),Ae.removeAllRanges(),He>xt?(Ae.addRange(me),Ae.extend(de.node,de.offset)):(me.setEnd(de.node,de.offset),Ae.addRange(me))}}}}for(Ce=[],Ae=se;Ae=Ae.parentNode;)Ae.nodeType===1&&Ce.push({element:Ae,left:Ae.scrollLeft,top:Ae.scrollTop});for(typeof se.focus=="function"&&se.focus(),se=0;se<Ce.length;se++){var Be=Ce[se];Be.element.scrollLeft=Be.left,Be.element.scrollTop=Be.top}}co=!!hc,pc=hc=null}finally{nt=b,D.p=p,R.T=u}}s.current=a,Dt=2}}function Nu(){if(Dt===2){Dt=0;var s=Qn,a=ns,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=R.T,R.T=null;var p=D.p;D.p=2;var b=nt;nt|=4;try{au(s,a.alternate,a)}finally{nt=b,D.p=p,R.T=u}}Dt=3}}function $u(){if(Dt===4||Dt===3){Dt=0,qe();var s=Qn,a=ns,u=jn,p=bu;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Dt=5:(Dt=0,ns=Qn=null,ju(s,s.pendingLanes));var b=s.pendingLanes;if(b===0&&(Zn=null),bo(u),a=a.stateNode,Ne&&typeof Ne.onCommitFiberRoot=="function")try{Ne.onCommitFiberRoot(pe,a,void 0,(a.current.flags&128)===128)}catch{}if(p!==null){a=R.T,b=D.p,D.p=2,R.T=null;try{for(var A=s.onRecoverableError,V=0;V<p.length;V++){var se=p[V];A(se.value,{componentStack:se.stack})}}finally{R.T=a,D.p=b}}(jn&3)!==0&&Yi(),mn(s),b=s.pendingLanes,(u&261930)!==0&&(b&42)!==0?s===tc?qs++:(qs=0,tc=s):qs=0,Gs(0)}}function ju(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Ss(a)))}function Yi(){return Tu(),Nu(),$u(),Iu()}function Iu(){if(Dt!==5)return!1;var s=Qn,a=Ja;Ja=0;var u=bo(jn),p=R.T,b=D.p;try{D.p=32>u?32:u,R.T=null,u=ec,ec=null;var A=Qn,V=jn;if(Dt=0,ns=Qn=null,jn=0,(nt&6)!==0)throw Error(r(331));var se=nt;if(nt|=4,Eu(A.current),hu(A,A.current,V,u),nt=se,Gs(0,!1),Ne&&typeof Ne.onPostCommitFiberRoot=="function")try{Ne.onPostCommitFiberRoot(pe,A)}catch{}return!0}finally{D.p=b,R.T=p,ju(s,a)}}function Uu(s,a,u){a=tn(u,a),a=Na(s.stateNode,a,2),s=Vn(s,a,2),s!==null&&(ds(s,2),mn(s))}function ot(s,a,u){if(s.tag===3)Uu(s,s,u);else for(;a!==null;){if(a.tag===3){Uu(a,s,u);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Zn===null||!Zn.has(p))){s=tn(u,s),u=Ol(2),p=Vn(a,u,2),p!==null&&(Pl(u,p,a,s),ds(p,2),mn(p));break}}a=a.return}}function sc(s,a,u){var p=s.pingCache;if(p===null){p=s.pingCache=new Sf;var b=new Set;p.set(a,b)}else b=p.get(a),b===void 0&&(b=new Set,p.set(a,b));b.has(u)||(Ya=!0,b.add(u),s=Tf.bind(null,s,a,u),a.then(s,s))}function Tf(s,a,u){var p=s.pingCache;p!==null&&p.delete(a),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,ft===s&&(Ye&u)===u&&(yt===4||yt===3&&(Ye&62914560)===Ye&&300>De()-zi?(nt&2)===0&&rs(s,0):Za|=u,ts===Ye&&(ts=0)),mn(s)}function Ou(s,a){a===0&&(a=Tc()),s=dr(s,a),s!==null&&(ds(s,a),mn(s))}function Nf(s){var a=s.memoizedState,u=0;a!==null&&(u=a.retryLane),Ou(s,u)}function $f(s,a){var u=0;switch(s.tag){case 31:case 13:var p=s.stateNode,b=s.memoizedState;b!==null&&(u=b.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(a),Ou(s,u)}function jf(s,a){return Ke(s,a)}var Zi=null,os=null,ic=!1,Qi=!1,oc=!1,er=0;function mn(s){s!==os&&s.next===null&&(os===null?Zi=os=s:os=os.next=s),Qi=!0,ic||(ic=!0,Uf())}function Gs(s,a){if(!oc&&Qi){oc=!0;do for(var u=!1,p=Zi;p!==null;){if(s!==0){var b=p.pendingLanes;if(b===0)var A=0;else{var V=p.suspendedLanes,se=p.pingedLanes;A=(1<<31-$e(42|s)+1)-1,A&=b&~(V&~se),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(u=!0,Lu(p,A))}else A=Ye,A=ar(p,p===ft?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(A&3)===0||xs(p,A)||(u=!0,Lu(p,A));p=p.next}while(u);oc=!1}}function If(){Pu()}function Pu(){Qi=ic=!1;var s=0;er!==0&&Gf()&&(s=er);for(var a=De(),u=null,p=Zi;p!==null;){var b=p.next,A=Hu(p,a);A===0?(p.next=null,u===null?Zi=b:u.next=b,b===null&&(os=u)):(u=p,(s!==0||(A&3)!==0)&&(Qi=!0)),p=b}Dt!==0&&Dt!==5||Gs(s),er!==0&&(er=0)}function Hu(s,a){for(var u=s.suspendedLanes,p=s.pingedLanes,b=s.expirationTimes,A=s.pendingLanes&-62914561;0<A;){var V=31-$e(A),se=1<<V,le=b[V];le===-1?((se&u)===0||(se&p)!==0)&&(b[V]=cd(se,a)):le<=a&&(s.expiredLanes|=se),A&=~se}if(a=ft,u=Ye,u=ar(s,s===a?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,u===0||s===a&&(it===2||it===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&at(p),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||xs(s,u)){if(a=u&-u,a===s.callbackPriority)return a;switch(p!==null&&at(p),bo(u)){case 2:case 8:u=G;break;case 32:u=B;break;case 268435456:u=te;break;default:u=B}return p=Mu.bind(null,s),u=Ke(u,p),s.callbackPriority=a,s.callbackNode=u,a}return p!==null&&p!==null&&at(p),s.callbackPriority=2,s.callbackNode=null,2}function Mu(s,a){if(Dt!==0&&Dt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(Yi()&&s.callbackNode!==u)return null;var p=Ye;return p=ar(s,s===ft?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(Au(s,p,a),Hu(s,De()),s.callbackNode!=null&&s.callbackNode===u?Mu.bind(null,s):null)}function Lu(s,a){if(Yi())return null;Au(s,a,!0)}function Uf(){Xf(function(){(nt&6)!==0?Ke(_e,If):Pu()})}function ac(){if(er===0){var s=zr;s===0&&(s=dt,dt<<=1,(dt&261888)===0&&(dt=256)),er=s}return er}function Ku(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:oi(""+s)}function zu(s,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,s.id&&u.setAttribute("form",s.id),a.parentNode.insertBefore(u,a),s=new FormData(s),u.parentNode.removeChild(u),s}function Of(s,a,u,p,b){if(a==="submit"&&u&&u.stateNode===b){var A=Ku((b[Ot]||null).action),V=p.submitter;V&&(a=(a=V[Ot]||null)?Ku(a.formAction):V.getAttribute("formAction"),a!==null&&(A=a,V=null));var se=new ui("action","action",null,p,b);s.push({event:se,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(er!==0){var le=V?zu(b,V):new FormData(b);Sa(u,{pending:!0,data:le,method:b.method,action:A},null,le)}}else typeof A=="function"&&(se.preventDefault(),le=V?zu(b,V):new FormData(b),Sa(u,{pending:!0,data:le,method:b.method,action:A},A,le))},currentTarget:b}]})}}for(var cc=0;cc<Ko.length;cc++){var lc=Ko[cc],Pf=lc.toLowerCase(),Hf=lc[0].toUpperCase()+lc.slice(1);ln(Pf,"on"+Hf)}ln(w0,"onAnimationEnd"),ln(A0,"onAnimationIteration"),ln(v0,"onAnimationStart"),ln("dblclick","onDoubleClick"),ln("focusin","onFocus"),ln("focusout","onBlur"),ln(tf,"onTransitionRun"),ln(nf,"onTransitionStart"),ln(rf,"onTransitionCancel"),ln(B0,"onTransitionEnd"),Fr("onMouseEnter",["mouseout","mouseover"]),Fr("onMouseLeave",["mouseout","mouseover"]),Fr("onPointerEnter",["pointerout","pointerover"]),Fr("onPointerLeave",["pointerout","pointerover"]),cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ws="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mf=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ws));function Vu(s,a){a=(a&4)!==0;for(var u=0;u<s.length;u++){var p=s[u],b=p.event;p=p.listeners;e:{var A=void 0;if(a)for(var V=p.length-1;0<=V;V--){var se=p[V],le=se.instance,Ee=se.currentTarget;if(se=se.listener,le!==A&&b.isPropagationStopped())break e;A=se,b.currentTarget=Ee;try{A(b)}catch(ve){fi(ve)}b.currentTarget=null,A=le}else for(V=0;V<p.length;V++){if(se=p[V],le=se.instance,Ee=se.currentTarget,se=se.listener,le!==A&&b.isPropagationStopped())break e;A=se,b.currentTarget=Ee;try{A(b)}catch(ve){fi(ve)}b.currentTarget=null,A=le}}}}function We(s,a){var u=a[wo];u===void 0&&(u=a[wo]=new Set);var p=s+"__bubble";u.has(p)||(qu(a,s,2,!1),u.add(p))}function uc(s,a,u){var p=0;a&&(p|=4),qu(u,s,p,a)}var Ji="_reactListening"+Math.random().toString(36).slice(2);function xc(s){if(!s[Ji]){s[Ji]=!0,Pc.forEach(function(u){u!=="selectionchange"&&(Mf.has(u)||uc(u,!1,s),uc(u,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Ji]||(a[Ji]=!0,uc("selectionchange",!1,a))}}function qu(s,a,u,p){switch(wx(a)){case 2:var b=ph;break;case 8:b=mh;break;default:b=_c}u=b.bind(null,a,u,s),b=void 0,!Fo||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(b=!0),p?b!==void 0?s.addEventListener(a,u,{capture:!0,passive:b}):s.addEventListener(a,u,!0):b!==void 0?s.addEventListener(a,u,{passive:b}):s.addEventListener(a,u,!1)}function dc(s,a,u,p,b){var A=p;if((a&1)===0&&(a&2)===0&&p!==null)e:for(;;){if(p===null)return;var V=p.tag;if(V===3||V===4){var se=p.stateNode.containerInfo;if(se===b)break;if(V===4)for(V=p.return;V!==null;){var le=V.tag;if((le===3||le===4)&&V.stateNode.containerInfo===b)return;V=V.return}for(;se!==null;){if(V=Sr(se),V===null)return;if(le=V.tag,le===5||le===6||le===26||le===27){p=A=V;continue e}se=se.parentNode}}p=p.return}Zc(function(){var Ee=A,ve=Do(u),Ce=[];e:{var ye=C0.get(s);if(ye!==void 0){var Ae=ui,Ue=s;switch(s){case"keypress":if(ci(u)===0)break e;case"keydown":case"keyup":Ae=Nd;break;case"focusin":Ue="focus",Ae=$o;break;case"focusout":Ue="blur",Ae=$o;break;case"beforeblur":case"afterblur":Ae=$o;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=e0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=wd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=Id;break;case w0:case A0:case v0:Ae=Bd;break;case B0:Ae=Od;break;case"scroll":case"scrollend":Ae=yd;break;case"wheel":Ae=Hd;break;case"copy":case"cut":case"paste":Ae=_d;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=n0;break;case"toggle":case"beforetoggle":Ae=Ld}var He=(a&4)!==0,xt=!He&&(s==="scroll"||s==="scrollend"),he=He?ye!==null?ye+"Capture":null:ye;He=[];for(var de=Ee,me;de!==null;){var Be=de;if(me=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||me===null||he===null||(Be=ps(de,he),Be!=null&&He.push(Xs(de,Be,me))),xt)break;de=de.return}0<He.length&&(ye=new Ae(ye,Ue,null,u,ve),Ce.push({event:ye,listeners:He}))}}if((a&7)===0){e:{if(ye=s==="mouseover"||s==="pointerover",Ae=s==="mouseout"||s==="pointerout",ye&&u!==So&&(Ue=u.relatedTarget||u.fromElement)&&(Sr(Ue)||Ue[_r]))break e;if((Ae||ye)&&(ye=ve.window===ve?ve:(ye=ve.ownerDocument)?ye.defaultView||ye.parentWindow:window,Ae?(Ue=u.relatedTarget||u.toElement,Ae=Ee,Ue=Ue?Sr(Ue):null,Ue!==null&&(xt=c(Ue),He=Ue.tag,Ue!==xt||He!==5&&He!==27&&He!==6)&&(Ue=null)):(Ae=null,Ue=Ee),Ae!==Ue)){if(He=e0,Be="onMouseLeave",he="onMouseEnter",de="mouse",(s==="pointerout"||s==="pointerover")&&(He=n0,Be="onPointerLeave",he="onPointerEnter",de="pointer"),xt=Ae==null?ye:hs(Ae),me=Ue==null?ye:hs(Ue),ye=new He(Be,de+"leave",Ae,u,ve),ye.target=xt,ye.relatedTarget=me,Be=null,Sr(ve)===Ee&&(He=new He(he,de+"enter",Ue,u,ve),He.target=me,He.relatedTarget=xt,Be=He),xt=Be,Ae&&Ue)t:{for(He=Lf,he=Ae,de=Ue,me=0,Be=he;Be;Be=He(Be))me++;Be=0;for(var Pe=de;Pe;Pe=He(Pe))Be++;for(;0<me-Be;)he=He(he),me--;for(;0<Be-me;)de=He(de),Be--;for(;me--;){if(he===de||de!==null&&he===de.alternate){He=he;break t}he=He(he),de=He(de)}He=null}else He=null;Ae!==null&&Gu(Ce,ye,Ae,He,!1),Ue!==null&&xt!==null&&Gu(Ce,xt,Ue,He,!0)}}e:{if(ye=Ee?hs(Ee):window,Ae=ye.nodeName&&ye.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&ye.type==="file")var et=u0;else if(c0(ye))if(x0)et=Qd;else{et=Yd;var Oe=Xd}else Ae=ye.nodeName,!Ae||Ae.toLowerCase()!=="input"||ye.type!=="checkbox"&&ye.type!=="radio"?Ee&&_o(Ee.elementType)&&(et=u0):et=Zd;if(et&&(et=et(s,Ee))){l0(Ce,et,u,ve);break e}Oe&&Oe(s,ye,Ee),s==="focusout"&&Ee&&ye.type==="number"&&Ee.memoizedProps.value!=null&&Co(ye,"number",ye.value)}switch(Oe=Ee?hs(Ee):window,s){case"focusin":(c0(Oe)||Oe.contentEditable==="true")&&(Ir=Oe,Ho=Ee,Bs=null);break;case"focusout":Bs=Ho=Ir=null;break;case"mousedown":Mo=!0;break;case"contextmenu":case"mouseup":case"dragend":Mo=!1,y0(Ce,u,ve);break;case"selectionchange":if(ef)break;case"keydown":case"keyup":y0(Ce,u,ve)}var Ve;if(Io)e:{switch(s){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else jr?o0(s,u)&&(Ze="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Ze="onCompositionStart");Ze&&(r0&&u.locale!=="ko"&&(jr||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&jr&&(Ve=Qc()):(On=ve,Ro="value"in On?On.value:On.textContent,jr=!0)),Oe=eo(Ee,Ze),0<Oe.length&&(Ze=new t0(Ze,s,null,u,ve),Ce.push({event:Ze,listeners:Oe}),Ve?Ze.data=Ve:(Ve=a0(u),Ve!==null&&(Ze.data=Ve)))),(Ve=zd?Vd(s,u):qd(s,u))&&(Ze=eo(Ee,"onBeforeInput"),0<Ze.length&&(Oe=new t0("onBeforeInput","beforeinput",null,u,ve),Ce.push({event:Oe,listeners:Ze}),Oe.data=Ve)),Of(Ce,s,Ee,u,ve)}Vu(Ce,a)})}function Xs(s,a,u){return{instance:s,listener:a,currentTarget:u}}function eo(s,a){for(var u=a+"Capture",p=[];s!==null;){var b=s,A=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||A===null||(b=ps(s,u),b!=null&&p.unshift(Xs(s,b,A)),b=ps(s,a),b!=null&&p.push(Xs(s,b,A))),s.tag===3)return p;s=s.return}return[]}function Lf(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Gu(s,a,u,p,b){for(var A=a._reactName,V=[];u!==null&&u!==p;){var se=u,le=se.alternate,Ee=se.stateNode;if(se=se.tag,le!==null&&le===p)break;se!==5&&se!==26&&se!==27||Ee===null||(le=Ee,b?(Ee=ps(u,A),Ee!=null&&V.unshift(Xs(u,Ee,le))):b||(Ee=ps(u,A),Ee!=null&&V.push(Xs(u,Ee,le)))),u=u.return}V.length!==0&&s.push({event:a,listeners:V})}var Kf=/\r\n?/g,zf=/\u0000|\uFFFD/g;function Wu(s){return(typeof s=="string"?s:""+s).replace(Kf,`
`).replace(zf,"")}function Xu(s,a){return a=Wu(a),Wu(s)===a}function lt(s,a,u,p,b,A){switch(u){case"children":typeof p=="string"?a==="body"||a==="textarea"&&p===""||Tr(s,p):(typeof p=="number"||typeof p=="bigint")&&a!=="body"&&Tr(s,""+p);break;case"className":si(s,"class",p);break;case"tabIndex":si(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":si(s,u,p);break;case"style":Xc(s,p,A);break;case"data":if(a!=="object"){si(s,"data",p);break}case"src":case"href":if(p===""&&(a!=="a"||u!=="href")){s.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=oi(""+p),s.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(u==="formAction"?(a!=="input"&&lt(s,a,"name",b.name,b,null),lt(s,a,"formEncType",b.formEncType,b,null),lt(s,a,"formMethod",b.formMethod,b,null),lt(s,a,"formTarget",b.formTarget,b,null)):(lt(s,a,"encType",b.encType,b,null),lt(s,a,"method",b.method,b,null),lt(s,a,"target",b.target,b,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=oi(""+p),s.setAttribute(u,p);break;case"onClick":p!=null&&(s.onclick=yn);break;case"onScroll":p!=null&&We("scroll",s);break;case"onScrollEnd":p!=null&&We("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(b.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}u=oi(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""+p):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":p===!0?s.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,p):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(u,p):s.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(u):s.setAttribute(u,p);break;case"popover":We("beforetoggle",s),We("toggle",s),ri(s,"popover",p);break;case"xlinkActuate":gn(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":gn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":gn(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":gn(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":gn(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":gn(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":gn(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":gn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":gn(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":ri(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Ed.get(u)||u,ri(s,u,p))}}function fc(s,a,u,p,b,A){switch(u){case"style":Xc(s,p,A);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(b.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"children":typeof p=="string"?Tr(s,p):(typeof p=="number"||typeof p=="bigint")&&Tr(s,""+p);break;case"onScroll":p!=null&&We("scroll",s);break;case"onScrollEnd":p!=null&&We("scrollend",s);break;case"onClick":p!=null&&(s.onclick=yn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Hc.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(b=u.endsWith("Capture"),a=u.slice(2,b?u.length-7:void 0),A=s[Ot]||null,A=A!=null?A[u]:null,typeof A=="function"&&s.removeEventListener(a,A,b),typeof p=="function")){typeof A!="function"&&A!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(a,p,b);break e}u in s?s[u]=p:p===!0?s.setAttribute(u,""):ri(s,u,p)}}}function jt(s,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":We("error",s),We("load",s);var p=!1,b=!1,A;for(A in u)if(u.hasOwnProperty(A)){var V=u[A];if(V!=null)switch(A){case"src":p=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:lt(s,a,A,V,u,null)}}b&&lt(s,a,"srcSet",u.srcSet,u,null),p&&lt(s,a,"src",u.src,u,null);return;case"input":We("invalid",s);var se=A=V=b=null,le=null,Ee=null;for(p in u)if(u.hasOwnProperty(p)){var ve=u[p];if(ve!=null)switch(p){case"name":b=ve;break;case"type":V=ve;break;case"checked":le=ve;break;case"defaultChecked":Ee=ve;break;case"value":A=ve;break;case"defaultValue":se=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,a));break;default:lt(s,a,p,ve,u,null)}}Vc(s,A,se,le,Ee,V,b,!1);return;case"select":We("invalid",s),p=V=A=null;for(b in u)if(u.hasOwnProperty(b)&&(se=u[b],se!=null))switch(b){case"value":A=se;break;case"defaultValue":V=se;break;case"multiple":p=se;default:lt(s,a,b,se,u,null)}a=A,u=V,s.multiple=!!p,a!=null?Rr(s,!!p,a,!1):u!=null&&Rr(s,!!p,u,!0);return;case"textarea":We("invalid",s),A=b=p=null;for(V in u)if(u.hasOwnProperty(V)&&(se=u[V],se!=null))switch(V){case"value":p=se;break;case"defaultValue":b=se;break;case"children":A=se;break;case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(91));break;default:lt(s,a,V,se,u,null)}Gc(s,p,b,A);return;case"option":for(le in u)if(u.hasOwnProperty(le)&&(p=u[le],p!=null))switch(le){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:lt(s,a,le,p,u,null)}return;case"dialog":We("beforetoggle",s),We("toggle",s),We("cancel",s),We("close",s);break;case"iframe":case"object":We("load",s);break;case"video":case"audio":for(p=0;p<Ws.length;p++)We(Ws[p],s);break;case"image":We("error",s),We("load",s);break;case"details":We("toggle",s);break;case"embed":case"source":case"link":We("error",s),We("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in u)if(u.hasOwnProperty(Ee)&&(p=u[Ee],p!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:lt(s,a,Ee,p,u,null)}return;default:if(_o(a)){for(ve in u)u.hasOwnProperty(ve)&&(p=u[ve],p!==void 0&&fc(s,a,ve,p,u,void 0));return}}for(se in u)u.hasOwnProperty(se)&&(p=u[se],p!=null&&lt(s,a,se,p,u,null))}function Vf(s,a,u,p){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,A=null,V=null,se=null,le=null,Ee=null,ve=null;for(Ae in u){var Ce=u[Ae];if(u.hasOwnProperty(Ae)&&Ce!=null)switch(Ae){case"checked":break;case"value":break;case"defaultValue":le=Ce;default:p.hasOwnProperty(Ae)||lt(s,a,Ae,null,p,Ce)}}for(var ye in p){var Ae=p[ye];if(Ce=u[ye],p.hasOwnProperty(ye)&&(Ae!=null||Ce!=null))switch(ye){case"type":A=Ae;break;case"name":b=Ae;break;case"checked":Ee=Ae;break;case"defaultChecked":ve=Ae;break;case"value":V=Ae;break;case"defaultValue":se=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(r(137,a));break;default:Ae!==Ce&&lt(s,a,ye,Ae,p,Ce)}}Bo(s,V,se,le,Ee,ve,A,b);return;case"select":Ae=V=se=ye=null;for(A in u)if(le=u[A],u.hasOwnProperty(A)&&le!=null)switch(A){case"value":break;case"multiple":Ae=le;default:p.hasOwnProperty(A)||lt(s,a,A,null,p,le)}for(b in p)if(A=p[b],le=u[b],p.hasOwnProperty(b)&&(A!=null||le!=null))switch(b){case"value":ye=A;break;case"defaultValue":se=A;break;case"multiple":V=A;default:A!==le&&lt(s,a,b,A,p,le)}a=se,u=V,p=Ae,ye!=null?Rr(s,!!u,ye,!1):!!p!=!!u&&(a!=null?Rr(s,!!u,a,!0):Rr(s,!!u,u?[]:"",!1));return;case"textarea":Ae=ye=null;for(se in u)if(b=u[se],u.hasOwnProperty(se)&&b!=null&&!p.hasOwnProperty(se))switch(se){case"value":break;case"children":break;default:lt(s,a,se,null,p,b)}for(V in p)if(b=p[V],A=u[V],p.hasOwnProperty(V)&&(b!=null||A!=null))switch(V){case"value":ye=b;break;case"defaultValue":Ae=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(r(91));break;default:b!==A&&lt(s,a,V,b,p,A)}qc(s,ye,Ae);return;case"option":for(var Ue in u)if(ye=u[Ue],u.hasOwnProperty(Ue)&&ye!=null&&!p.hasOwnProperty(Ue))switch(Ue){case"selected":s.selected=!1;break;default:lt(s,a,Ue,null,p,ye)}for(le in p)if(ye=p[le],Ae=u[le],p.hasOwnProperty(le)&&ye!==Ae&&(ye!=null||Ae!=null))switch(le){case"selected":s.selected=ye&&typeof ye!="function"&&typeof ye!="symbol";break;default:lt(s,a,le,ye,p,Ae)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var He in u)ye=u[He],u.hasOwnProperty(He)&&ye!=null&&!p.hasOwnProperty(He)&&lt(s,a,He,null,p,ye);for(Ee in p)if(ye=p[Ee],Ae=u[Ee],p.hasOwnProperty(Ee)&&ye!==Ae&&(ye!=null||Ae!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(r(137,a));break;default:lt(s,a,Ee,ye,p,Ae)}return;default:if(_o(a)){for(var xt in u)ye=u[xt],u.hasOwnProperty(xt)&&ye!==void 0&&!p.hasOwnProperty(xt)&&fc(s,a,xt,void 0,p,ye);for(ve in p)ye=p[ve],Ae=u[ve],!p.hasOwnProperty(ve)||ye===Ae||ye===void 0&&Ae===void 0||fc(s,a,ve,ye,p,Ae);return}}for(var he in u)ye=u[he],u.hasOwnProperty(he)&&ye!=null&&!p.hasOwnProperty(he)&&lt(s,a,he,null,p,ye);for(Ce in p)ye=p[Ce],Ae=u[Ce],!p.hasOwnProperty(Ce)||ye===Ae||ye==null&&Ae==null||lt(s,a,Ce,ye,p,Ae)}function Yu(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function qf(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,u=performance.getEntriesByType("resource"),p=0;p<u.length;p++){var b=u[p],A=b.transferSize,V=b.initiatorType,se=b.duration;if(A&&se&&Yu(V)){for(V=0,se=b.responseEnd,p+=1;p<u.length;p++){var le=u[p],Ee=le.startTime;if(Ee>se)break;var ve=le.transferSize,Ce=le.initiatorType;ve&&Yu(Ce)&&(le=le.responseEnd,V+=ve*(le<se?1:(se-Ee)/(le-Ee)))}if(--p,a+=8*(A+V)/(b.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var hc=null,pc=null;function to(s){return s.nodeType===9?s:s.ownerDocument}function Zu(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qu(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function mc(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Ec=null;function Gf(){var s=window.event;return s&&s.type==="popstate"?s===Ec?!1:(Ec=s,!0):(Ec=null,!1)}var Ju=typeof setTimeout=="function"?setTimeout:void 0,Wf=typeof clearTimeout=="function"?clearTimeout:void 0,ex=typeof Promise=="function"?Promise:void 0,Xf=typeof queueMicrotask=="function"?queueMicrotask:typeof ex<"u"?function(s){return ex.resolve(null).then(s).catch(Yf)}:Ju;function Yf(s){setTimeout(function(){throw s})}function tr(s){return s==="head"}function tx(s,a){var u=a,p=0;do{var b=u.nextSibling;if(s.removeChild(u),b&&b.nodeType===8)if(u=b.data,u==="/$"||u==="/&"){if(p===0){s.removeChild(b),us(a);return}p--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")p++;else if(u==="html")Ys(s.ownerDocument.documentElement);else if(u==="head"){u=s.ownerDocument.head,Ys(u);for(var A=u.firstChild;A;){var V=A.nextSibling,se=A.nodeName;A[fs]||se==="SCRIPT"||se==="STYLE"||se==="LINK"&&A.rel.toLowerCase()==="stylesheet"||u.removeChild(A),A=V}}else u==="body"&&Ys(s.ownerDocument.body);u=b}while(u);us(a)}function nx(s,a){var u=s;s=0;do{var p=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(s===0)break;s--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||s++;u=p}while(u)}function gc(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":gc(u),Ao(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function Zf(s,a,u,p){for(;s.nodeType===1;){var b=u;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[fs])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(A=s.getAttribute("rel"),A==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(A!==b.rel||s.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||s.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||s.getAttribute("title")!==(b.title==null?null:b.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(A=s.getAttribute("src"),(A!==(b.src==null?null:b.src)||s.getAttribute("type")!==(b.type==null?null:b.type)||s.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&A&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var A=b.name==null?null:""+b.name;if(b.type==="hidden"&&s.getAttribute("name")===A)return s}else return s;if(s=an(s.nextSibling),s===null)break}return null}function Qf(s,a,u){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=an(s.nextSibling),s===null))return null;return s}function rx(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=an(s.nextSibling),s===null))return null;return s}function yc(s){return s.data==="$?"||s.data==="$~"}function bc(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Jf(s,a){var u=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||u.readyState!=="loading")a();else{var p=function(){a(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function an(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var wc=null;function sx(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"||u==="/&"){if(a===0)return an(s.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}s=s.nextSibling}return null}function ix(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return s;a--}else u!=="/$"&&u!=="/&"||a++}s=s.previousSibling}return null}function ox(s,a,u){switch(a=to(u),s){case"html":if(s=a.documentElement,!s)throw Error(r(452));return s;case"head":if(s=a.head,!s)throw Error(r(453));return s;case"body":if(s=a.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Ys(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Ao(s)}var cn=new Map,ax=new Set;function no(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var In=D.d;D.d={f:eh,r:th,D:nh,C:rh,L:sh,m:ih,X:ah,S:oh,M:ch};function eh(){var s=In.f(),a=Gi();return s||a}function th(s){var a=Dr(s);a!==null&&a.tag===5&&a.type==="form"?Bl(a):In.r(s)}var as=typeof document>"u"?null:document;function cx(s,a,u){var p=as;if(p&&typeof a=="string"&&a){var b=Jt(a);b='link[rel="'+s+'"][href="'+b+'"]',typeof u=="string"&&(b+='[crossorigin="'+u+'"]'),ax.has(b)||(ax.add(b),s={rel:s,crossOrigin:u,href:a},p.querySelector(b)===null&&(a=p.createElement("link"),jt(a,"link",s),kt(a),p.head.appendChild(a)))}}function nh(s){In.D(s),cx("dns-prefetch",s,null)}function rh(s,a){In.C(s,a),cx("preconnect",s,a)}function sh(s,a,u){In.L(s,a,u);var p=as;if(p&&s&&a){var b='link[rel="preload"][as="'+Jt(a)+'"]';a==="image"&&u&&u.imageSrcSet?(b+='[imagesrcset="'+Jt(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(b+='[imagesizes="'+Jt(u.imageSizes)+'"]')):b+='[href="'+Jt(s)+'"]';var A=b;switch(a){case"style":A=cs(s);break;case"script":A=ls(s)}cn.has(A)||(s=g({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:s,as:a},u),cn.set(A,s),p.querySelector(b)!==null||a==="style"&&p.querySelector(Zs(A))||a==="script"&&p.querySelector(Qs(A))||(a=p.createElement("link"),jt(a,"link",s),kt(a),p.head.appendChild(a)))}}function ih(s,a){In.m(s,a);var u=as;if(u&&s){var p=a&&typeof a.as=="string"?a.as:"script",b='link[rel="modulepreload"][as="'+Jt(p)+'"][href="'+Jt(s)+'"]',A=b;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=ls(s)}if(!cn.has(A)&&(s=g({rel:"modulepreload",href:s},a),cn.set(A,s),u.querySelector(b)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Qs(A)))return}p=u.createElement("link"),jt(p,"link",s),kt(p),u.head.appendChild(p)}}}function oh(s,a,u){In.S(s,a,u);var p=as;if(p&&s){var b=kr(p).hoistableStyles,A=cs(s);a=a||"default";var V=b.get(A);if(!V){var se={loading:0,preload:null};if(V=p.querySelector(Zs(A)))se.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":a},u),(u=cn.get(A))&&Ac(s,u);var le=V=p.createElement("link");kt(le),jt(le,"link",s),le._p=new Promise(function(Ee,ve){le.onload=Ee,le.onerror=ve}),le.addEventListener("load",function(){se.loading|=1}),le.addEventListener("error",function(){se.loading|=2}),se.loading|=4,ro(V,a,p)}V={type:"stylesheet",instance:V,count:1,state:se},b.set(A,V)}}}function ah(s,a){In.X(s,a);var u=as;if(u&&s){var p=kr(u).hoistableScripts,b=ls(s),A=p.get(b);A||(A=u.querySelector(Qs(b)),A||(s=g({src:s,async:!0},a),(a=cn.get(b))&&vc(s,a),A=u.createElement("script"),kt(A),jt(A,"link",s),u.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(b,A))}}function ch(s,a){In.M(s,a);var u=as;if(u&&s){var p=kr(u).hoistableScripts,b=ls(s),A=p.get(b);A||(A=u.querySelector(Qs(b)),A||(s=g({src:s,async:!0,type:"module"},a),(a=cn.get(b))&&vc(s,a),A=u.createElement("script"),kt(A),jt(A,"link",s),u.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(b,A))}}function lx(s,a,u,p){var b=(b=ie.current)?no(b):null;if(!b)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=cs(u.href),u=kr(b).hoistableStyles,p=u.get(a),p||(p={type:"style",instance:null,count:0,state:null},u.set(a,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=cs(u.href);var A=kr(b).hoistableStyles,V=A.get(s);if(V||(b=b.ownerDocument||b,V={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(s,V),(A=b.querySelector(Zs(s)))&&!A._p&&(V.instance=A,V.state.loading=5),cn.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},cn.set(s,u),A||lh(b,s,u,V.state))),a&&p===null)throw Error(r(528,""));return V}if(a&&p!==null)throw Error(r(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ls(u),u=kr(b).hoistableScripts,p=u.get(a),p||(p={type:"script",instance:null,count:0,state:null},u.set(a,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function cs(s){return'href="'+Jt(s)+'"'}function Zs(s){return'link[rel="stylesheet"]['+s+"]"}function ux(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function lh(s,a,u,p){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?p.loading=1:(a=s.createElement("link"),p.preload=a,a.addEventListener("load",function(){return p.loading|=1}),a.addEventListener("error",function(){return p.loading|=2}),jt(a,"link",u),kt(a),s.head.appendChild(a))}function ls(s){return'[src="'+Jt(s)+'"]'}function Qs(s){return"script[async]"+s}function xx(s,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var p=s.querySelector('style[data-href~="'+Jt(u.href)+'"]');if(p)return a.instance=p,kt(p),p;var b=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),kt(p),jt(p,"style",b),ro(p,u.precedence,s),a.instance=p;case"stylesheet":b=cs(u.href);var A=s.querySelector(Zs(b));if(A)return a.state.loading|=4,a.instance=A,kt(A),A;p=ux(u),(b=cn.get(b))&&Ac(p,b),A=(s.ownerDocument||s).createElement("link"),kt(A);var V=A;return V._p=new Promise(function(se,le){V.onload=se,V.onerror=le}),jt(A,"link",p),a.state.loading|=4,ro(A,u.precedence,s),a.instance=A;case"script":return A=ls(u.src),(b=s.querySelector(Qs(A)))?(a.instance=b,kt(b),b):(p=u,(b=cn.get(A))&&(p=g({},u),vc(p,b)),s=s.ownerDocument||s,b=s.createElement("script"),kt(b),jt(b,"link",p),s.head.appendChild(b),a.instance=b);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(p=a.instance,a.state.loading|=4,ro(p,u.precedence,s));return a.instance}function ro(s,a,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=p.length?p[p.length-1]:null,A=b,V=0;V<p.length;V++){var se=p[V];if(se.dataset.precedence===a)A=se;else if(A!==b)break}A?A.parentNode.insertBefore(s,A.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(s,a.firstChild))}function Ac(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function vc(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var so=null;function dx(s,a,u){if(so===null){var p=new Map,b=so=new Map;b.set(u,p)}else b=so,p=b.get(u),p||(p=new Map,b.set(u,p));if(p.has(s))return p;for(p.set(s,null),u=u.getElementsByTagName(s),b=0;b<u.length;b++){var A=u[b];if(!(A[fs]||A[Rt]||s==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var V=A.getAttribute(a)||"";V=s+V;var se=p.get(V);se?se.push(A):p.set(V,[A])}}return p}function fx(s,a,u){s=s.ownerDocument||s,s.head.insertBefore(u,a==="title"?s.querySelector("head > title"):null)}function uh(s,a,u){if(u===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function hx(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function xh(s,a,u,p){if(u.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var b=cs(p.href),A=a.querySelector(Zs(b));if(A){a=A._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=io.bind(s),a.then(s,s)),u.state.loading|=4,u.instance=A,kt(A);return}A=a.ownerDocument||a,p=ux(p),(b=cn.get(b))&&Ac(p,b),A=A.createElement("link"),kt(A);var V=A;V._p=new Promise(function(se,le){V.onload=se,V.onerror=le}),jt(A,"link",p),u.instance=A}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(s.count++,u=io.bind(s),a.addEventListener("load",u),a.addEventListener("error",u))}}var Bc=0;function dh(s,a){return s.stylesheets&&s.count===0&&ao(s,s.stylesheets),0<s.count||0<s.imgCount?function(u){var p=setTimeout(function(){if(s.stylesheets&&ao(s,s.stylesheets),s.unsuspend){var A=s.unsuspend;s.unsuspend=null,A()}},6e4+a);0<s.imgBytes&&Bc===0&&(Bc=62500*qf());var b=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&ao(s,s.stylesheets),s.unsuspend)){var A=s.unsuspend;s.unsuspend=null,A()}},(s.imgBytes>Bc?50:800)+a);return s.unsuspend=u,function(){s.unsuspend=null,clearTimeout(p),clearTimeout(b)}}:null}function io(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ao(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var oo=null;function ao(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,oo=new Map,a.forEach(fh,s),oo=null,io.call(s))}function fh(s,a){if(!(a.state.loading&4)){var u=oo.get(s);if(u)var p=u.get(null);else{u=new Map,oo.set(s,u);for(var b=s.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<b.length;A++){var V=b[A];(V.nodeName==="LINK"||V.getAttribute("media")!=="not all")&&(u.set(V.dataset.precedence,V),p=V)}p&&u.set(null,p)}b=a.instance,V=b.getAttribute("data-precedence"),A=u.get(V)||p,A===p&&u.set(null,b),u.set(V,b),this.count++,p=io.bind(this),b.addEventListener("load",p),b.addEventListener("error",p),A?A.parentNode.insertBefore(b,A.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(b,s.firstChild)),a.state.loading|=4}}var Js={$$typeof:T,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function hh(s,a,u,p,b,A,V,se,le){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=go(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=go(0),this.hiddenUpdates=go(null),this.identifierPrefix=p,this.onUncaughtError=b,this.onCaughtError=A,this.onRecoverableError=V,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=le,this.incompleteTransitions=new Map}function px(s,a,u,p,b,A,V,se,le,Ee,ve,Ce){return s=new hh(s,a,u,V,le,Ee,ve,Ce,se),a=1,A===!0&&(a|=24),A=qt(3,null,null,a),s.current=A,A.stateNode=s,a=na(),a.refCount++,s.pooledCache=a,a.refCount++,A.memoizedState={element:p,isDehydrated:u,cache:a},oa(A),s}function mx(s){return s?(s=Pr,s):Pr}function Ex(s,a,u,p,b,A){b=mx(b),p.context===null?p.context=b:p.pendingContext=b,p=zn(a),p.payload={element:u},A=A===void 0?null:A,A!==null&&(p.callback=A),u=Vn(s,p,a),u!==null&&(zt(u,s,a),Rs(u,s,a))}function gx(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<a?u:a}}function Cc(s,a){gx(s,a),(s=s.alternate)&&gx(s,a)}function yx(s){if(s.tag===13||s.tag===31){var a=dr(s,67108864);a!==null&&zt(a,s,67108864),Cc(s,67108864)}}function bx(s){if(s.tag===13||s.tag===31){var a=Zt();a=yo(a);var u=dr(s,a);u!==null&&zt(u,s,a),Cc(s,a)}}var co=!0;function ph(s,a,u,p){var b=R.T;R.T=null;var A=D.p;try{D.p=2,_c(s,a,u,p)}finally{D.p=A,R.T=b}}function mh(s,a,u,p){var b=R.T;R.T=null;var A=D.p;try{D.p=8,_c(s,a,u,p)}finally{D.p=A,R.T=b}}function _c(s,a,u,p){if(co){var b=Sc(p);if(b===null)dc(s,a,p,lo,u),Ax(s,p);else if(gh(b,s,a,u,p))p.stopPropagation();else if(Ax(s,p),a&4&&-1<Eh.indexOf(s)){for(;b!==null;){var A=Dr(b);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var V=dn(A.pendingLanes);if(V!==0){var se=A;for(se.pendingLanes|=2,se.entangledLanes|=2;V;){var le=1<<31-$e(V);se.entanglements[1]|=le,V&=~le}mn(A),(nt&6)===0&&(Vi=De()+500,Gs(0))}}break;case 31:case 13:se=dr(A,2),se!==null&&zt(se,A,2),Gi(),Cc(A,2)}if(A=Sc(p),A===null&&dc(s,a,p,lo,u),A===b)break;b=A}b!==null&&p.stopPropagation()}else dc(s,a,p,null,u)}}function Sc(s){return s=Do(s),Dc(s)}var lo=null;function Dc(s){if(lo=null,s=Sr(s),s!==null){var a=c(s);if(a===null)s=null;else{var u=a.tag;if(u===13){if(s=l(a),s!==null)return s;s=null}else if(u===31){if(s=x(a),s!==null)return s;s=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return lo=s,null}function wx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Se()){case _e:return 2;case G:return 8;case B:case k:return 32;case te:return 268435456;default:return 32}default:return 32}}var kc=!1,nr=null,rr=null,sr=null,ei=new Map,ti=new Map,ir=[],Eh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ax(s,a){switch(s){case"focusin":case"focusout":nr=null;break;case"dragenter":case"dragleave":rr=null;break;case"mouseover":case"mouseout":sr=null;break;case"pointerover":case"pointerout":ei.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":ti.delete(a.pointerId)}}function ni(s,a,u,p,b,A){return s===null||s.nativeEvent!==A?(s={blockedOn:a,domEventName:u,eventSystemFlags:p,nativeEvent:A,targetContainers:[b]},a!==null&&(a=Dr(a),a!==null&&yx(a)),s):(s.eventSystemFlags|=p,a=s.targetContainers,b!==null&&a.indexOf(b)===-1&&a.push(b),s)}function gh(s,a,u,p,b){switch(a){case"focusin":return nr=ni(nr,s,a,u,p,b),!0;case"dragenter":return rr=ni(rr,s,a,u,p,b),!0;case"mouseover":return sr=ni(sr,s,a,u,p,b),!0;case"pointerover":var A=b.pointerId;return ei.set(A,ni(ei.get(A)||null,s,a,u,p,b)),!0;case"gotpointercapture":return A=b.pointerId,ti.set(A,ni(ti.get(A)||null,s,a,u,p,b)),!0}return!1}function vx(s){var a=Sr(s.target);if(a!==null){var u=c(a);if(u!==null){if(a=u.tag,a===13){if(a=l(u),a!==null){s.blockedOn=a,Uc(s.priority,function(){bx(u)});return}}else if(a===31){if(a=x(u),a!==null){s.blockedOn=a,Uc(s.priority,function(){bx(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function uo(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var u=Sc(s.nativeEvent);if(u===null){u=s.nativeEvent;var p=new u.constructor(u.type,u);So=p,u.target.dispatchEvent(p),So=null}else return a=Dr(u),a!==null&&yx(a),s.blockedOn=u,!1;a.shift()}return!0}function Bx(s,a,u){uo(s)&&u.delete(a)}function yh(){kc=!1,nr!==null&&uo(nr)&&(nr=null),rr!==null&&uo(rr)&&(rr=null),sr!==null&&uo(sr)&&(sr=null),ei.forEach(Bx),ti.forEach(Bx)}function xo(s,a){s.blockedOn===a&&(s.blockedOn=null,kc||(kc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yh)))}var fo=null;function Cx(s){fo!==s&&(fo=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){fo===s&&(fo=null);for(var a=0;a<s.length;a+=3){var u=s[a],p=s[a+1],b=s[a+2];if(typeof p!="function"){if(Dc(p||u)===null)continue;break}var A=Dr(u);A!==null&&(s.splice(a,3),a-=3,Sa(A,{pending:!0,data:b,method:u.method,action:p},p,b))}}))}function us(s){function a(le){return xo(le,s)}nr!==null&&xo(nr,s),rr!==null&&xo(rr,s),sr!==null&&xo(sr,s),ei.forEach(a),ti.forEach(a);for(var u=0;u<ir.length;u++){var p=ir[u];p.blockedOn===s&&(p.blockedOn=null)}for(;0<ir.length&&(u=ir[0],u.blockedOn===null);)vx(u),u.blockedOn===null&&ir.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var b=u[p],A=u[p+1],V=b[Ot]||null;if(typeof A=="function")V||Cx(u);else if(V){var se=null;if(A&&A.hasAttribute("formAction")){if(b=A,V=A[Ot]||null)se=V.formAction;else if(Dc(b)!==null)continue}else se=V.action;typeof se=="function"?u[p+1]=se:(u.splice(p,3),p-=3),Cx(u)}}}function _x(){function s(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(V){return b=V})},focusReset:"manual",scroll:"manual"})}function a(){b!==null&&(b(),b=null),p||setTimeout(u,20)}function u(){if(!p&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,b=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){p=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),b!==null&&(b(),b=null)}}}function Fc(s){this._internalRoot=s}ho.prototype.render=Fc.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(r(409));var u=a.current,p=Zt();Ex(u,p,s,a,null,null)},ho.prototype.unmount=Fc.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;Ex(s.current,2,null,s,null,null),Gi(),a[_r]=null}};function ho(s){this._internalRoot=s}ho.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ic();s={blockedOn:null,target:s,priority:a};for(var u=0;u<ir.length&&a!==0&&a<ir[u].priority;u++);ir.splice(u,0,s),u===0&&vx(s)}};var Sx=t.version;if(Sx!=="19.2.0")throw Error(r(527,Sx,"19.2.0"));D.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=m(a),s=s!==null?E(s):null,s=s===null?null:s.stateNode,s};var bh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var po=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!po.isDisabled&&po.supportsFiber)try{pe=po.inject(bh),Ne=po}catch{}}return reactDomClient_production.createRoot=function(s,a){if(!o(s))throw Error(r(299));var u=!1,p="",b=$l,A=jl,V=Il;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onUncaughtError!==void 0&&(b=a.onUncaughtError),a.onCaughtError!==void 0&&(A=a.onCaughtError),a.onRecoverableError!==void 0&&(V=a.onRecoverableError)),a=px(s,1,!1,null,null,u,p,null,b,A,V,_x),s[_r]=a.current,xc(s),new Fc(a)},reactDomClient_production.hydrateRoot=function(s,a,u){if(!o(s))throw Error(r(299));var p=!1,b="",A=$l,V=jl,se=Il,le=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onUncaughtError!==void 0&&(A=u.onUncaughtError),u.onCaughtError!==void 0&&(V=u.onCaughtError),u.onRecoverableError!==void 0&&(se=u.onRecoverableError),u.formState!==void 0&&(le=u.formState)),a=px(s,1,!0,a,u??null,p,b,le,A,V,se,_x),a.context=mx(null),u=a.current,p=Zt(),p=yo(p),b=zn(p),b.callback=null,Vn(u,b,p),u=p,a.current.lanes=u,ds(a,u),mn(a),s[_r]=a.current,xc(s),new ho(a)},reactDomClient_production.version="19.2.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();const createStoreImpl=e=>{let t;const n=new Set,r=(m,E)=>{const g=typeof m=="function"?m(t):m;if(!Object.is(g,t)){const y=t;t=E??(typeof g!="object"||g===null)?g:Object.assign({},t,g),n.forEach(w=>w(t,y))}},o=()=>t,x={setState:r,getState:o,getInitialState:()=>f,subscribe:m=>(n.add(m),()=>n.delete(m))},f=t=e(r,o,x);return x},createStore$1=(e=>e?createStoreImpl(e):createStoreImpl),identity=e=>e;function useStore(e,t=identity){const n=React.useSyncExternalStore(e.subscribe,React.useCallback(()=>t(e.getState()),[e,t]),React.useCallback(()=>t(e.getInitialState()),[e,t]));return React.useDebugValue(n),n}const createImpl=e=>{const t=createStore$1(e),n=r=>useStore(t,r);return Object.assign(n,t),n},create=(e=>e?createImpl(e):createImpl);function createJSONStorage(e,t){let n;try{n=e()}catch{return}return{getItem:o=>{var c;const l=f=>f===null?null:JSON.parse(f,void 0),x=(c=n.getItem(o))!=null?c:null;return x instanceof Promise?x.then(l):l(x)},setItem:(o,c)=>n.setItem(o,JSON.stringify(c,void 0)),removeItem:o=>n.removeItem(o)}}const toThenable=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return toThenable(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return toThenable(r)(n)}}}},persistImpl=(e,t)=>(n,r,o)=>{let c={storage:createJSONStorage(()=>localStorage),partialize:_=>_,version:0,merge:(_,F)=>({...F,..._}),...t},l=!1;const x=new Set,f=new Set;let m=c.storage;if(!m)return e((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${c.name}', the given storage is currently unavailable.`),n(..._)},r,o);const E=()=>{const _=c.partialize({...r()});return m.setItem(c.name,{state:_,version:c.version})},g=o.setState;o.setState=(_,F)=>(g(_,F),E());const y=e((..._)=>(n(..._),E()),r,o);o.getInitialState=()=>y;let w;const v=()=>{var _,F;if(!m)return;l=!1,x.forEach(Y=>{var T;return Y((T=r())!=null?T:y)});const H=((F=c.onRehydrateStorage)==null?void 0:F.call(c,(_=r())!=null?_:y))||void 0;return toThenable(m.getItem.bind(m))(c.name).then(Y=>{if(Y)if(typeof Y.version=="number"&&Y.version!==c.version){if(c.migrate){const T=c.migrate(Y.state,Y.version);return T instanceof Promise?T.then(L=>[!0,L]):[!0,T]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,Y.state];return[!1,void 0]}).then(Y=>{var T;const[L,N]=Y;if(w=c.merge(N,(T=r())!=null?T:y),n(w,!0),L)return E()}).then(()=>{H?.(w,void 0),w=r(),l=!0,f.forEach(Y=>Y(w))}).catch(Y=>{H?.(void 0,Y)})};return o.persist={setOptions:_=>{c={...c,..._},_.storage&&(m=_.storage)},clearStorage:()=>{m?.removeItem(c.name)},getOptions:()=>c,rehydrate:()=>v(),hasHydrated:()=>l,onHydrate:_=>(x.add(_),()=>{x.delete(_)}),onFinishHydration:_=>(f.add(_),()=>{f.delete(_)})},c.skipHydration||v(),w||y},persist=persistImpl,useAuthStore=create()(persist(e=>({encryptedKey:null,publicKey:null,isUnlocked:!1,decryptedKey:null,password:null,setEncryptedKey:(t,n)=>e({encryptedKey:t,publicKey:n}),unlock:(t,n)=>e({isUnlocked:!0,decryptedKey:t,password:n||null}),lock:()=>e({isUnlocked:!1,decryptedKey:null,password:null}),logout:()=>e({encryptedKey:null,publicKey:null,isUnlocked:!1,decryptedKey:null,password:null})}),{name:"amber-auth-storage",partialize:e=>({encryptedKey:e.encryptedKey,publicKey:e.publicKey})})),scriptRel="modulepreload",assetsURL=function(e,t){return new URL(e,t).href},seen={},__vitePreload=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){let m=function(E){return Promise.all(E.map(g=>Promise.resolve(g).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};const l=document.getElementsByTagName("link"),x=document.querySelector("meta[property=csp-nonce]"),f=x?.nonce||x?.getAttribute("nonce");o=m(n.map(E=>{if(E=assetsURL(E,r),E in seen)return;seen[E]=!0;const g=E.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(r)for(let v=l.length-1;v>=0;v--){const _=l[v];if(_.href===E&&(!g||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${E}"]${y}`))return;const w=document.createElement("link");if(w.rel=g?"stylesheet":scriptRel,g||(w.as="script"),w.crossOrigin="",w.href=E,f&&w.setAttribute("nonce",f),document.head.appendChild(w),g)return new Promise((v,_)=>{w.addEventListener("load",v),w.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${E}`)))})}))}function c(l){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=l,window.dispatchEvent(x),!x.defaultPrevented)throw l}return o.then(l=>{for(const x of l||[])x.status==="rejected"&&c(x.reason);return t().catch(c)})},useWalletStore=create()(persist((e,t)=>({wallets:[],currentWalletId:null,currentKeypairId:null,addWallet:n=>e(r=>({wallets:[...r.wallets,n]})),removeWallet:n=>e(r=>({wallets:r.wallets.filter(o=>o.id!==n),currentWalletId:r.currentWalletId===n?null:r.currentWalletId})),updateWallet:(n,r)=>e(o=>({wallets:o.wallets.map(c=>c.id===n?{...c,...r}:c)})),getWallet:n=>t().wallets.find(r=>r.id===n),setCurrentWallet:n=>e(r=>{const c=r.wallets.find(l=>l.id===n)?.keypairs[0]?.id||null;return{currentWalletId:n,currentKeypairId:c}}),setCurrentKeypair:n=>e({currentKeypairId:n}),addKeypair:(n,r)=>e(o=>({wallets:o.wallets.map(c=>c.id===n?{...c,keypairs:[...c.keypairs,r]}:c)})),removeKeypair:(n,r)=>e(o=>({wallets:o.wallets.map(c=>c.id===n?{...c,keypairs:c.keypairs.filter(l=>l.id!==r)}:c),currentKeypairId:o.currentKeypairId===r?null:o.currentKeypairId})),updateKeypair:(n,r,o)=>e(c=>({wallets:c.wallets.map(l=>l.id===n?{...l,keypairs:l.keypairs.map(x=>x.id===r?{...x,...o}:x)}:l)})),getKeypair:n=>{for(const r of t().wallets){const o=r.keypairs.find(c=>c.id===n);if(o)return o}},getCurrentKeypair:()=>{const{currentKeypairId:n}=t();if(n)return t().getKeypair(n)}}),{name:"wallet-storage",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-DZK393HN.js");return{storage:n}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:n}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-DZK393HN.js");return{storage:r}},[],import.meta.url);return n.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-DZK393HN.js");return{storage:n}},[],import.meta.url);return t.removeItem(e)}}))}));function isBytes$5(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber$4(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function abytes$2(e,t,n=""){const r=isBytes$5(e),o=e?.length,c=t!==void 0;if(!r||c&&o!==t){const l=n&&`"${n}" `,x=c?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+x+", got "+f)}return e}function ahash$2(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");anumber$4(e.outputLen),anumber$4(e.blockLen)}function aexists$2(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput$2(e,t){abytes$2(e,void 0,"digestInto() output");const n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function clean$2(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView$5(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr$4(e,t){return e<<32-t|e>>>t}function utf8ToBytes$5(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function kdfInputToBytes(e,t=""){return typeof e=="string"?utf8ToBytes$5(e):abytes$2(e,void 0,t)}function checkOpts$2(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}function createHasher$2(e,t={}){const n=(o,c)=>e(c).update(o).digest(),r=e(void 0);return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=o=>e(o),Object.assign(n,t),Object.freeze(n)}function randomBytes$4(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const oidNist$1=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});let _HMAC$1=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(ahash$2(t),abytes$2(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let c=0;c<o.length;c++)o[c]^=54;this.iHash.update(o),this.oHash=t.create();for(let c=0;c<o.length;c++)o[c]^=106;this.oHash.update(o),clean$2(o)}update(t){return aexists$2(this),this.iHash.update(t),this}digestInto(t){aexists$2(this),abytes$2(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:n,iHash:r,finished:o,destroyed:c,blockLen:l,outputLen:x}=this;return t=t,t.finished=o,t.destroyed=c,t.blockLen=l,t.outputLen=x,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$5=(e,t,n)=>new _HMAC$1(e,t).update(n).digest();hmac$5.create=(e,t)=>new _HMAC$1(e,t);function pbkdf2Init$1(e,t,n,r){ahash$2(e);const o=checkOpts$2({dkLen:32,asyncTick:10},r),{c,dkLen:l,asyncTick:x}=o;if(anumber$4(c,"c"),anumber$4(l,"dkLen"),anumber$4(x,"asyncTick"),c<1)throw new Error("iterations (c) must be >= 1");const f=kdfInputToBytes(t,"password"),m=kdfInputToBytes(n,"salt"),E=new Uint8Array(l),g=hmac$5.create(e,f),y=g._cloneInto().update(m);return{c,dkLen:l,asyncTick:x,DK:E,PRF:g,PRFSalt:y}}function pbkdf2Output$1(e,t,n,r,o){return e.destroy(),t.destroy(),r&&r.destroy(),clean$2(o),n}function pbkdf2$1(e,t,n,r){const{c:o,dkLen:c,DK:l,PRF:x,PRFSalt:f}=pbkdf2Init$1(e,t,n,r);let m;const E=new Uint8Array(4),g=createView$5(E),y=new Uint8Array(x.outputLen);for(let w=1,v=0;v<c;w++,v+=x.outputLen){const _=l.subarray(v,v+x.outputLen);g.setInt32(0,w,!1),(m=f._cloneInto(m)).update(E).digestInto(y),_.set(y.subarray(0,_.length));for(let F=1;F<o;F++){x._cloneInto(m).update(y).digestInto(y);for(let H=0;H<_.length;H++)_[H]^=y[H]}}return pbkdf2Output$1(x,f,l,m,y)}function Chi$4(e,t,n){return e&t^~e&n}function Maj$4(e,t,n){return e&t^e&n^t&n}let HashMD$2=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,n,r,o){this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=createView$5(this.buffer)}update(t){aexists$2(this),abytes$2(t);const{view:n,buffer:r,blockLen:o}=this,c=t.length;for(let l=0;l<c;){const x=Math.min(o-this.pos,c-l);if(x===o){const f=createView$5(t);for(;o<=c-l;l+=o)this.process(f,l);continue}r.set(t.subarray(l,l+x),this.pos),this.pos+=x,l+=x,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists$2(this),aoutput$2(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:c}=this;let{pos:l}=this;n[l++]=128,clean$2(this.buffer.subarray(l)),this.padOffset>o-l&&(this.process(r,0),l=0);for(let g=l;g<o;g++)n[g]=0;r.setBigUint64(o-8,BigInt(this.length*8),c),this.process(r,0);const x=createView$5(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const m=f/4,E=this.get();if(m>E.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<m;g++)x.setUint32(4*g,E[g],c)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:c,destroyed:l,pos:x}=this;return t.destroyed=l,t.finished=c,t.length=o,t.pos=x,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};const SHA256_IV$2=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA512_IV$1=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),U32_MASK64$1=BigInt(2**32-1),_32n$1=BigInt(32);function fromBig$1(e,t=!1){return t?{h:Number(e&U32_MASK64$1),l:Number(e>>_32n$1&U32_MASK64$1)}:{h:Number(e>>_32n$1&U32_MASK64$1)|0,l:Number(e&U32_MASK64$1)|0}}function split$1(e,t=!1){const n=e.length;let r=new Uint32Array(n),o=new Uint32Array(n);for(let c=0;c<n;c++){const{h:l,l:x}=fromBig$1(e[c],t);[r[c],o[c]]=[l,x]}return[r,o]}const shrSH$1=(e,t,n)=>e>>>n,shrSL$1=(e,t,n)=>e<<32-n|t>>>n,rotrSH$1=(e,t,n)=>e>>>n|t<<32-n,rotrSL$1=(e,t,n)=>e<<32-n|t>>>n,rotrBH$1=(e,t,n)=>e<<64-n|t>>>n-32,rotrBL$1=(e,t,n)=>e>>>n-32|t<<64-n;function add$1(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}const add3L$1=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H$1=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L$1=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H$1=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,add5L$1=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),add5H$1=(e,t,n,r,o,c)=>t+n+r+o+c+(e/2**32|0)|0,SHA256_K$4=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W$4=new Uint32Array(64);let SHA2_32B$1=class extends HashMD$2{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:n,C:r,D:o,E:c,F:l,G:x,H:f}=this;return[t,n,r,o,c,l,x,f]}set(t,n,r,o,c,l,x,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=c|0,this.F=l|0,this.G=x|0,this.H=f|0}process(t,n){for(let g=0;g<16;g++,n+=4)SHA256_W$4[g]=t.getUint32(n,!1);for(let g=16;g<64;g++){const y=SHA256_W$4[g-15],w=SHA256_W$4[g-2],v=rotr$4(y,7)^rotr$4(y,18)^y>>>3,_=rotr$4(w,17)^rotr$4(w,19)^w>>>10;SHA256_W$4[g]=_+SHA256_W$4[g-7]+v+SHA256_W$4[g-16]|0}let{A:r,B:o,C:c,D:l,E:x,F:f,G:m,H:E}=this;for(let g=0;g<64;g++){const y=rotr$4(x,6)^rotr$4(x,11)^rotr$4(x,25),w=E+y+Chi$4(x,f,m)+SHA256_K$4[g]+SHA256_W$4[g]|0,_=(rotr$4(r,2)^rotr$4(r,13)^rotr$4(r,22))+Maj$4(r,o,c)|0;E=m,m=f,f=x,x=l+w|0,l=c,c=o,o=r,r=w+_|0}r=r+this.A|0,o=o+this.B|0,c=c+this.C|0,l=l+this.D|0,x=x+this.E|0,f=f+this.F|0,m=m+this.G|0,E=E+this.H|0,this.set(r,o,c,l,x,f,m,E)}roundClean(){clean$2(SHA256_W$4)}destroy(){this.set(0,0,0,0,0,0,0,0),clean$2(this.buffer)}},_SHA256$1=class extends SHA2_32B$1{A=SHA256_IV$2[0]|0;B=SHA256_IV$2[1]|0;C=SHA256_IV$2[2]|0;D=SHA256_IV$2[3]|0;E=SHA256_IV$2[4]|0;F=SHA256_IV$2[5]|0;G=SHA256_IV$2[6]|0;H=SHA256_IV$2[7]|0;constructor(){super(32)}};const K512$1=split$1(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),SHA512_Kh$1=K512$1[0],SHA512_Kl$1=K512$1[1],SHA512_W_H$1=new Uint32Array(80),SHA512_W_L$1=new Uint32Array(80);let SHA2_64B$1=class extends HashMD$2{constructor(t){super(128,t,16,!1)}get(){const{Ah:t,Al:n,Bh:r,Bl:o,Ch:c,Cl:l,Dh:x,Dl:f,Eh:m,El:E,Fh:g,Fl:y,Gh:w,Gl:v,Hh:_,Hl:F}=this;return[t,n,r,o,c,l,x,f,m,E,g,y,w,v,_,F]}set(t,n,r,o,c,l,x,f,m,E,g,y,w,v,_,F){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=c|0,this.Cl=l|0,this.Dh=x|0,this.Dl=f|0,this.Eh=m|0,this.El=E|0,this.Fh=g|0,this.Fl=y|0,this.Gh=w|0,this.Gl=v|0,this.Hh=_|0,this.Hl=F|0}process(t,n){for(let T=0;T<16;T++,n+=4)SHA512_W_H$1[T]=t.getUint32(n),SHA512_W_L$1[T]=t.getUint32(n+=4);for(let T=16;T<80;T++){const L=SHA512_W_H$1[T-15]|0,N=SHA512_W_L$1[T-15]|0,I=rotrSH$1(L,N,1)^rotrSH$1(L,N,8)^shrSH$1(L,N,7),U=rotrSL$1(L,N,1)^rotrSL$1(L,N,8)^shrSL$1(L,N,7),W=SHA512_W_H$1[T-2]|0,O=SHA512_W_L$1[T-2]|0,Z=rotrSH$1(W,O,19)^rotrBH$1(W,O,61)^shrSH$1(W,O,6),z=rotrSL$1(W,O,19)^rotrBL$1(W,O,61)^shrSL$1(W,O,6),q=add4L$1(U,z,SHA512_W_L$1[T-7],SHA512_W_L$1[T-16]),$=add4H$1(q,I,Z,SHA512_W_H$1[T-7],SHA512_W_H$1[T-16]);SHA512_W_H$1[T]=$|0,SHA512_W_L$1[T]=q|0}let{Ah:r,Al:o,Bh:c,Bl:l,Ch:x,Cl:f,Dh:m,Dl:E,Eh:g,El:y,Fh:w,Fl:v,Gh:_,Gl:F,Hh:H,Hl:Y}=this;for(let T=0;T<80;T++){const L=rotrSH$1(g,y,14)^rotrSH$1(g,y,18)^rotrBH$1(g,y,41),N=rotrSL$1(g,y,14)^rotrSL$1(g,y,18)^rotrBL$1(g,y,41),I=g&w^~g&_,U=y&v^~y&F,W=add5L$1(Y,N,U,SHA512_Kl$1[T],SHA512_W_L$1[T]),O=add5H$1(W,H,L,I,SHA512_Kh$1[T],SHA512_W_H$1[T]),Z=W|0,z=rotrSH$1(r,o,28)^rotrBH$1(r,o,34)^rotrBH$1(r,o,39),q=rotrSL$1(r,o,28)^rotrBL$1(r,o,34)^rotrBL$1(r,o,39),$=r&c^r&x^c&x,M=o&l^o&f^l&f;H=_|0,Y=F|0,_=w|0,F=v|0,w=g|0,v=y|0,{h:g,l:y}=add$1(m|0,E|0,O|0,Z|0),m=x|0,E=f|0,x=c|0,f=l|0,c=r|0,l=o|0;const S=add3L$1(Z,q,M);r=add3H$1(S,O,z,$),o=S|0}({h:r,l:o}=add$1(this.Ah|0,this.Al|0,r|0,o|0)),{h:c,l}=add$1(this.Bh|0,this.Bl|0,c|0,l|0),{h:x,l:f}=add$1(this.Ch|0,this.Cl|0,x|0,f|0),{h:m,l:E}=add$1(this.Dh|0,this.Dl|0,m|0,E|0),{h:g,l:y}=add$1(this.Eh|0,this.El|0,g|0,y|0),{h:w,l:v}=add$1(this.Fh|0,this.Fl|0,w|0,v|0),{h:_,l:F}=add$1(this.Gh|0,this.Gl|0,_|0,F|0),{h:H,l:Y}=add$1(this.Hh|0,this.Hl|0,H|0,Y|0),this.set(r,o,c,l,x,f,m,E,g,y,w,v,_,F,H,Y)}roundClean(){clean$2(SHA512_W_H$1,SHA512_W_L$1)}destroy(){clean$2(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},_SHA512$1=class extends SHA2_64B$1{Ah=SHA512_IV$1[0]|0;Al=SHA512_IV$1[1]|0;Bh=SHA512_IV$1[2]|0;Bl=SHA512_IV$1[3]|0;Ch=SHA512_IV$1[4]|0;Cl=SHA512_IV$1[5]|0;Dh=SHA512_IV$1[6]|0;Dl=SHA512_IV$1[7]|0;Eh=SHA512_IV$1[8]|0;El=SHA512_IV$1[9]|0;Fh=SHA512_IV$1[10]|0;Fl=SHA512_IV$1[11]|0;Gh=SHA512_IV$1[12]|0;Gl=SHA512_IV$1[13]|0;Hh=SHA512_IV$1[14]|0;Hl=SHA512_IV$1[15]|0;constructor(){super(64)}};const sha256$5=createHasher$2(()=>new _SHA256$1,oidNist$1(1)),sha512$1=createHasher$2(()=>new _SHA512$1,oidNist$1(3));function isBytes$4(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function isArrayOf$1(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function afn$1(e){if(typeof e!="function")throw new Error("function expected");return!0}function astr$1(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function anumber$3(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function aArr$1(e){if(!Array.isArray(e))throw new Error("array expected")}function astrArr$1(e,t){if(!isArrayOf$1(!0,t))throw new Error(`${e}: array of strings expected`)}function anumArr$1(e,t){if(!isArrayOf$1(!1,t))throw new Error(`${e}: array of numbers expected`)}function chain$2(...e){const t=c=>c,n=(c,l)=>x=>c(l(x)),r=e.map(c=>c.encode).reduceRight(n,t),o=e.map(c=>c.decode).reduce(n,t);return{encode:r,decode:o}}function alphabet$2(e){const t=typeof e=="string"?e.split(""):e,n=t.length;astrArr$1("alphabet",t);const r=new Map(t.map((o,c)=>[o,c]));return{encode:o=>(aArr$1(o),o.map(c=>{if(!Number.isSafeInteger(c)||c<0||c>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${c}". Allowed: ${e}`);return t[c]})),decode:o=>(aArr$1(o),o.map(c=>{astr$1("alphabet.decode",c);const l=r.get(c);if(l===void 0)throw new Error(`Unknown letter: "${c}". Allowed: ${e}`);return l}))}}function join$2(e=""){return astr$1("join",e),{encode:t=>(astrArr$1("join.decode",t),t.join(e)),decode:t=>(astr$1("join.decode",t),t.split(e))}}function padding$1(e,t="="){return anumber$3(e),astr$1("padding",t),{encode(n){for(astrArr$1("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){astrArr$1("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function convertRadix$2(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(aArr$1(e),!e.length)return[];let r=0;const o=[],c=Array.from(e,x=>{if(anumber$3(x),x<0||x>=t)throw new Error(`invalid integer: ${x}`);return x}),l=c.length;for(;;){let x=0,f=!0;for(let m=r;m<l;m++){const E=c[m],g=t*x,y=g+E;if(!Number.isSafeInteger(y)||g/t!==x||y-E!==g)throw new Error("convertRadix: carry overflow");const w=y/n;x=y%n;const v=Math.floor(w);if(c[m]=v,!Number.isSafeInteger(v)||v*n+x!==y)throw new Error("convertRadix: carry overflow");if(f)v?f=!1:r=m;else continue}if(o.push(x),f)break}for(let x=0;x<e.length-1&&e[x]===0;x++)o.push(0);return o.reverse()}const gcd$1=(e,t)=>t===0?e:gcd$1(t,e%t),radix2carry$1=(e,t)=>e+(t-gcd$1(e,t)),powers=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function convertRadix2$1(e,t,n,r){if(aArr$1(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(radix2carry$1(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${radix2carry$1(t,n)}`);let o=0,c=0;const l=powers[t],x=powers[n]-1,f=[];for(const m of e){if(anumber$3(m),m>=l)throw new Error(`convertRadix2: invalid data word=${m} from=${t}`);if(o=o<<t|m,c+t>32)throw new Error(`convertRadix2: carry overflow pos=${c} from=${t}`);for(c+=t;c>=n;c-=n)f.push((o>>c-n&x)>>>0);const E=powers[c];if(E===void 0)throw new Error("invalid carry");o&=E-1}if(o=o<<n-c&x,!r&&c>=t)throw new Error("Excess padding");if(!r&&o>0)throw new Error(`Non-zero padding: ${o}`);return r&&c>0&&f.push(o>>>0),f}function radix$2(e){anumber$3(e);const t=2**8;return{encode:n=>{if(!isBytes$4(n))throw new Error("radix.encode input should be Uint8Array");return convertRadix$2(Array.from(n),t,e)},decode:n=>(anumArr$1("radix.decode",n),Uint8Array.from(convertRadix$2(n,e,t)))}}function radix2$1(e,t=!1){if(anumber$3(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry$1(8,e)>32||radix2carry$1(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!isBytes$4(n))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2$1(Array.from(n),8,e,!t)},decode:n=>(anumArr$1("radix2.decode",n),Uint8Array.from(convertRadix2$1(n,e,8,t)))}}function checksum$1(e,t){return anumber$3(e),afn$1(t),{encode(n){if(!isBytes$4(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),o=new Uint8Array(n.length+e);return o.set(n),o.set(r,n.length),o},decode(n){if(!isBytes$4(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),o=n.slice(-e),c=t(r).slice(0,e);for(let l=0;l<e;l++)if(c[l]!==o[l])throw new Error("Invalid checksum");return r}}}const utils$7={alphabet:alphabet$2,chain:chain$2,checksum:checksum$1,convertRadix:convertRadix$2,convertRadix2:convertRadix2$1,radix:radix$2,radix2:radix2$1,join:join$2,padding:padding$1};const isJapanese=e=>e[0]==="";function nfkd(e){if(typeof e!="string")throw new TypeError("invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function normalize$2(e){const t=nfkd(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}function aentropy(e){if(abytes$2(e),![16,20,24,28,32].includes(e.length))throw new Error("invalid entropy length")}function generateMnemonic(e,t=128){if(anumber$4(t),t%32!==0||t>256)throw new TypeError("Invalid entropy");return entropyToMnemonic(randomBytes$4(t/8),e)}const calcChecksum=e=>{const t=8-e.length/4;return new Uint8Array([sha256$5(e)[0]>>t<<t])};function getCoder(e){if(!Array.isArray(e)||e.length!==2048||typeof e[0]!="string")throw new Error("Wordlist: expected array of 2048 strings");return e.forEach(t=>{if(typeof t!="string")throw new Error("wordlist: non-string element: "+t)}),utils$7.chain(utils$7.checksum(1,calcChecksum),utils$7.radix2(11,!0),utils$7.alphabet(e))}function mnemonicToEntropy(e,t){const{words:n}=normalize$2(e),r=getCoder(t).decode(n);return aentropy(r),r}function entropyToMnemonic(e,t){return aentropy(e),getCoder(t).encode(e).join(isJapanese(t)?"":" ")}function validateMnemonic(e,t){try{mnemonicToEntropy(e,t)}catch{return!1}return!0}const psalt=e=>nfkd("mnemonic"+e);function mnemonicToSeedSync(e,t=""){return pbkdf2$1(sha512$1,normalize$2(e).nfkd,psalt(t),{c:2048,dkLen:64})}const wordlist=`abandon
ability
able
about
above
absent
absorb
abstract
absurd
abuse
access
accident
account
accuse
achieve
acid
acoustic
acquire
across
act
action
actor
actress
actual
adapt
add
addict
address
adjust
admit
adult
advance
advice
aerobic
affair
afford
afraid
again
age
agent
agree
ahead
aim
air
airport
aisle
alarm
album
alcohol
alert
alien
all
alley
allow
almost
alone
alpha
already
also
alter
always
amateur
amazing
among
amount
amused
analyst
anchor
ancient
anger
angle
angry
animal
ankle
announce
annual
another
answer
antenna
antique
anxiety
any
apart
apology
appear
apple
approve
april
arch
arctic
area
arena
argue
arm
armed
armor
army
around
arrange
arrest
arrive
arrow
art
artefact
artist
artwork
ask
aspect
assault
asset
assist
assume
asthma
athlete
atom
attack
attend
attitude
attract
auction
audit
august
aunt
author
auto
autumn
average
avocado
avoid
awake
aware
away
awesome
awful
awkward
axis
baby
bachelor
bacon
badge
bag
balance
balcony
ball
bamboo
banana
banner
bar
barely
bargain
barrel
base
basic
basket
battle
beach
bean
beauty
because
become
beef
before
begin
behave
behind
believe
below
belt
bench
benefit
best
betray
better
between
beyond
bicycle
bid
bike
bind
biology
bird
birth
bitter
black
blade
blame
blanket
blast
bleak
bless
blind
blood
blossom
blouse
blue
blur
blush
board
boat
body
boil
bomb
bone
bonus
book
boost
border
boring
borrow
boss
bottom
bounce
box
boy
bracket
brain
brand
brass
brave
bread
breeze
brick
bridge
brief
bright
bring
brisk
broccoli
broken
bronze
broom
brother
brown
brush
bubble
buddy
budget
buffalo
build
bulb
bulk
bullet
bundle
bunker
burden
burger
burst
bus
business
busy
butter
buyer
buzz
cabbage
cabin
cable
cactus
cage
cake
call
calm
camera
camp
can
canal
cancel
candy
cannon
canoe
canvas
canyon
capable
capital
captain
car
carbon
card
cargo
carpet
carry
cart
case
cash
casino
castle
casual
cat
catalog
catch
category
cattle
caught
cause
caution
cave
ceiling
celery
cement
census
century
cereal
certain
chair
chalk
champion
change
chaos
chapter
charge
chase
chat
cheap
check
cheese
chef
cherry
chest
chicken
chief
child
chimney
choice
choose
chronic
chuckle
chunk
churn
cigar
cinnamon
circle
citizen
city
civil
claim
clap
clarify
claw
clay
clean
clerk
clever
click
client
cliff
climb
clinic
clip
clock
clog
close
cloth
cloud
clown
club
clump
cluster
clutch
coach
coast
coconut
code
coffee
coil
coin
collect
color
column
combine
come
comfort
comic
common
company
concert
conduct
confirm
congress
connect
consider
control
convince
cook
cool
copper
copy
coral
core
corn
correct
cost
cotton
couch
country
couple
course
cousin
cover
coyote
crack
cradle
craft
cram
crane
crash
crater
crawl
crazy
cream
credit
creek
crew
cricket
crime
crisp
critic
crop
cross
crouch
crowd
crucial
cruel
cruise
crumble
crunch
crush
cry
crystal
cube
culture
cup
cupboard
curious
current
curtain
curve
cushion
custom
cute
cycle
dad
damage
damp
dance
danger
daring
dash
daughter
dawn
day
deal
debate
debris
decade
december
decide
decline
decorate
decrease
deer
defense
define
defy
degree
delay
deliver
demand
demise
denial
dentist
deny
depart
depend
deposit
depth
deputy
derive
describe
desert
design
desk
despair
destroy
detail
detect
develop
device
devote
diagram
dial
diamond
diary
dice
diesel
diet
differ
digital
dignity
dilemma
dinner
dinosaur
direct
dirt
disagree
discover
disease
dish
dismiss
disorder
display
distance
divert
divide
divorce
dizzy
doctor
document
dog
doll
dolphin
domain
donate
donkey
donor
door
dose
double
dove
draft
dragon
drama
drastic
draw
dream
dress
drift
drill
drink
drip
drive
drop
drum
dry
duck
dumb
dune
during
dust
dutch
duty
dwarf
dynamic
eager
eagle
early
earn
earth
easily
east
easy
echo
ecology
economy
edge
edit
educate
effort
egg
eight
either
elbow
elder
electric
elegant
element
elephant
elevator
elite
else
embark
embody
embrace
emerge
emotion
employ
empower
empty
enable
enact
end
endless
endorse
enemy
energy
enforce
engage
engine
enhance
enjoy
enlist
enough
enrich
enroll
ensure
enter
entire
entry
envelope
episode
equal
equip
era
erase
erode
erosion
error
erupt
escape
essay
essence
estate
eternal
ethics
evidence
evil
evoke
evolve
exact
example
excess
exchange
excite
exclude
excuse
execute
exercise
exhaust
exhibit
exile
exist
exit
exotic
expand
expect
expire
explain
expose
express
extend
extra
eye
eyebrow
fabric
face
faculty
fade
faint
faith
fall
false
fame
family
famous
fan
fancy
fantasy
farm
fashion
fat
fatal
father
fatigue
fault
favorite
feature
february
federal
fee
feed
feel
female
fence
festival
fetch
fever
few
fiber
fiction
field
figure
file
film
filter
final
find
fine
finger
finish
fire
firm
first
fiscal
fish
fit
fitness
fix
flag
flame
flash
flat
flavor
flee
flight
flip
float
flock
floor
flower
fluid
flush
fly
foam
focus
fog
foil
fold
follow
food
foot
force
forest
forget
fork
fortune
forum
forward
fossil
foster
found
fox
fragile
frame
frequent
fresh
friend
fringe
frog
front
frost
frown
frozen
fruit
fuel
fun
funny
furnace
fury
future
gadget
gain
galaxy
gallery
game
gap
garage
garbage
garden
garlic
garment
gas
gasp
gate
gather
gauge
gaze
general
genius
genre
gentle
genuine
gesture
ghost
giant
gift
giggle
ginger
giraffe
girl
give
glad
glance
glare
glass
glide
glimpse
globe
gloom
glory
glove
glow
glue
goat
goddess
gold
good
goose
gorilla
gospel
gossip
govern
gown
grab
grace
grain
grant
grape
grass
gravity
great
green
grid
grief
grit
grocery
group
grow
grunt
guard
guess
guide
guilt
guitar
gun
gym
habit
hair
half
hammer
hamster
hand
happy
harbor
hard
harsh
harvest
hat
have
hawk
hazard
head
health
heart
heavy
hedgehog
height
hello
helmet
help
hen
hero
hidden
high
hill
hint
hip
hire
history
hobby
hockey
hold
hole
holiday
hollow
home
honey
hood
hope
horn
horror
horse
hospital
host
hotel
hour
hover
hub
huge
human
humble
humor
hundred
hungry
hunt
hurdle
hurry
hurt
husband
hybrid
ice
icon
idea
identify
idle
ignore
ill
illegal
illness
image
imitate
immense
immune
impact
impose
improve
impulse
inch
include
income
increase
index
indicate
indoor
industry
infant
inflict
inform
inhale
inherit
initial
inject
injury
inmate
inner
innocent
input
inquiry
insane
insect
inside
inspire
install
intact
interest
into
invest
invite
involve
iron
island
isolate
issue
item
ivory
jacket
jaguar
jar
jazz
jealous
jeans
jelly
jewel
job
join
joke
journey
joy
judge
juice
jump
jungle
junior
junk
just
kangaroo
keen
keep
ketchup
key
kick
kid
kidney
kind
kingdom
kiss
kit
kitchen
kite
kitten
kiwi
knee
knife
knock
know
lab
label
labor
ladder
lady
lake
lamp
language
laptop
large
later
latin
laugh
laundry
lava
law
lawn
lawsuit
layer
lazy
leader
leaf
learn
leave
lecture
left
leg
legal
legend
leisure
lemon
lend
length
lens
leopard
lesson
letter
level
liar
liberty
library
license
life
lift
light
like
limb
limit
link
lion
liquid
list
little
live
lizard
load
loan
lobster
local
lock
logic
lonely
long
loop
lottery
loud
lounge
love
loyal
lucky
luggage
lumber
lunar
lunch
luxury
lyrics
machine
mad
magic
magnet
maid
mail
main
major
make
mammal
man
manage
mandate
mango
mansion
manual
maple
marble
march
margin
marine
market
marriage
mask
mass
master
match
material
math
matrix
matter
maximum
maze
meadow
mean
measure
meat
mechanic
medal
media
melody
melt
member
memory
mention
menu
mercy
merge
merit
merry
mesh
message
metal
method
middle
midnight
milk
million
mimic
mind
minimum
minor
minute
miracle
mirror
misery
miss
mistake
mix
mixed
mixture
mobile
model
modify
mom
moment
monitor
monkey
monster
month
moon
moral
more
morning
mosquito
mother
motion
motor
mountain
mouse
move
movie
much
muffin
mule
multiply
muscle
museum
mushroom
music
must
mutual
myself
mystery
myth
naive
name
napkin
narrow
nasty
nation
nature
near
neck
need
negative
neglect
neither
nephew
nerve
nest
net
network
neutral
never
news
next
nice
night
noble
noise
nominee
noodle
normal
north
nose
notable
note
nothing
notice
novel
now
nuclear
number
nurse
nut
oak
obey
object
oblige
obscure
observe
obtain
obvious
occur
ocean
october
odor
off
offer
office
often
oil
okay
old
olive
olympic
omit
once
one
onion
online
only
open
opera
opinion
oppose
option
orange
orbit
orchard
order
ordinary
organ
orient
original
orphan
ostrich
other
outdoor
outer
output
outside
oval
oven
over
own
owner
oxygen
oyster
ozone
pact
paddle
page
pair
palace
palm
panda
panel
panic
panther
paper
parade
parent
park
parrot
party
pass
patch
path
patient
patrol
pattern
pause
pave
payment
peace
peanut
pear
peasant
pelican
pen
penalty
pencil
people
pepper
perfect
permit
person
pet
phone
photo
phrase
physical
piano
picnic
picture
piece
pig
pigeon
pill
pilot
pink
pioneer
pipe
pistol
pitch
pizza
place
planet
plastic
plate
play
please
pledge
pluck
plug
plunge
poem
poet
point
polar
pole
police
pond
pony
pool
popular
portion
position
possible
post
potato
pottery
poverty
powder
power
practice
praise
predict
prefer
prepare
present
pretty
prevent
price
pride
primary
print
priority
prison
private
prize
problem
process
produce
profit
program
project
promote
proof
property
prosper
protect
proud
provide
public
pudding
pull
pulp
pulse
pumpkin
punch
pupil
puppy
purchase
purity
purpose
purse
push
put
puzzle
pyramid
quality
quantum
quarter
question
quick
quit
quiz
quote
rabbit
raccoon
race
rack
radar
radio
rail
rain
raise
rally
ramp
ranch
random
range
rapid
rare
rate
rather
raven
raw
razor
ready
real
reason
rebel
rebuild
recall
receive
recipe
record
recycle
reduce
reflect
reform
refuse
region
regret
regular
reject
relax
release
relief
rely
remain
remember
remind
remove
render
renew
rent
reopen
repair
repeat
replace
report
require
rescue
resemble
resist
resource
response
result
retire
retreat
return
reunion
reveal
review
reward
rhythm
rib
ribbon
rice
rich
ride
ridge
rifle
right
rigid
ring
riot
ripple
risk
ritual
rival
river
road
roast
robot
robust
rocket
romance
roof
rookie
room
rose
rotate
rough
round
route
royal
rubber
rude
rug
rule
run
runway
rural
sad
saddle
sadness
safe
sail
salad
salmon
salon
salt
salute
same
sample
sand
satisfy
satoshi
sauce
sausage
save
say
scale
scan
scare
scatter
scene
scheme
school
science
scissors
scorpion
scout
scrap
screen
script
scrub
sea
search
season
seat
second
secret
section
security
seed
seek
segment
select
sell
seminar
senior
sense
sentence
series
service
session
settle
setup
seven
shadow
shaft
shallow
share
shed
shell
sheriff
shield
shift
shine
ship
shiver
shock
shoe
shoot
shop
short
shoulder
shove
shrimp
shrug
shuffle
shy
sibling
sick
side
siege
sight
sign
silent
silk
silly
silver
similar
simple
since
sing
siren
sister
situate
six
size
skate
sketch
ski
skill
skin
skirt
skull
slab
slam
sleep
slender
slice
slide
slight
slim
slogan
slot
slow
slush
small
smart
smile
smoke
smooth
snack
snake
snap
sniff
snow
soap
soccer
social
sock
soda
soft
solar
soldier
solid
solution
solve
someone
song
soon
sorry
sort
soul
sound
soup
source
south
space
spare
spatial
spawn
speak
special
speed
spell
spend
sphere
spice
spider
spike
spin
spirit
split
spoil
sponsor
spoon
sport
spot
spray
spread
spring
spy
square
squeeze
squirrel
stable
stadium
staff
stage
stairs
stamp
stand
start
state
stay
steak
steel
stem
step
stereo
stick
still
sting
stock
stomach
stone
stool
story
stove
strategy
street
strike
strong
struggle
student
stuff
stumble
style
subject
submit
subway
success
such
sudden
suffer
sugar
suggest
suit
summer
sun
sunny
sunset
super
supply
supreme
sure
surface
surge
surprise
surround
survey
suspect
sustain
swallow
swamp
swap
swarm
swear
sweet
swift
swim
swing
switch
sword
symbol
symptom
syrup
system
table
tackle
tag
tail
talent
talk
tank
tape
target
task
taste
tattoo
taxi
teach
team
tell
ten
tenant
tennis
tent
term
test
text
thank
that
theme
then
theory
there
they
thing
this
thought
three
thrive
throw
thumb
thunder
ticket
tide
tiger
tilt
timber
time
tiny
tip
tired
tissue
title
toast
tobacco
today
toddler
toe
together
toilet
token
tomato
tomorrow
tone
tongue
tonight
tool
tooth
top
topic
topple
torch
tornado
tortoise
toss
total
tourist
toward
tower
town
toy
track
trade
traffic
tragic
train
transfer
trap
trash
travel
tray
treat
tree
trend
trial
tribe
trick
trigger
trim
trip
trophy
trouble
truck
true
truly
trumpet
trust
truth
try
tube
tuition
tumble
tuna
tunnel
turkey
turn
turtle
twelve
twenty
twice
twin
twist
two
type
typical
ugly
umbrella
unable
unaware
uncle
uncover
under
undo
unfair
unfold
unhappy
uniform
unique
unit
universe
unknown
unlock
until
unusual
unveil
update
upgrade
uphold
upon
upper
upset
urban
urge
usage
use
used
useful
useless
usual
utility
vacant
vacuum
vague
valid
valley
valve
van
vanish
vapor
various
vast
vault
vehicle
velvet
vendor
venture
venue
verb
verify
version
very
vessel
veteran
viable
vibrant
vicious
victory
video
view
village
vintage
violin
virtual
virus
visa
visit
visual
vital
vivid
vocal
voice
void
volcano
volume
vote
voyage
wage
wagon
wait
walk
wall
walnut
want
warfare
warm
warrior
wash
wasp
waste
water
wave
way
wealth
weapon
wear
weasel
weather
web
wedding
weekend
weird
welcome
west
wet
whale
what
wheat
wheel
when
where
whip
whisper
wide
width
wife
wild
will
win
window
wine
wing
wink
winner
winter
wire
wisdom
wise
wish
witness
wolf
woman
wonder
wood
wool
word
work
world
worry
worth
wrap
wreck
wrestle
wrist
write
wrong
yard
year
yellow
you
young
youth
zebra
zero
zone
zoo`.split(`
`);function isBytes$3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber$2(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function abytes$1(e,t,n=""){const r=isBytes$3(e),o=e?.length,c=t!==void 0;if(!r||c&&o!==t){const l=n&&`"${n}" `,x=c?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+x+", got "+f)}return e}function ahash$1(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");anumber$2(e.outputLen),anumber$2(e.blockLen)}function aexists$1(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput$1(e,t){abytes$1(e,void 0,"digestInto() output");const n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function clean$1(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView$4(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr$3(e,t){return e<<32-t|e>>>t}function rotl$3(e,t){return e<<t|e>>>32-t>>>0}const hasHexBuiltin$1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes$4=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$4(e){if(abytes$1(e),hasHexBuiltin$1)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=hexes$4[e[n]];return t}const asciis$2={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16$2(e){if(e>=asciis$2._0&&e<=asciis$2._9)return e-asciis$2._0;if(e>=asciis$2.A&&e<=asciis$2.F)return e-(asciis$2.A-10);if(e>=asciis$2.a&&e<=asciis$2.f)return e-(asciis$2.a-10)}function hexToBytes$6(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(hasHexBuiltin$1)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let o=0,c=0;o<n;o++,c+=2){const l=asciiToBase16$2(e.charCodeAt(c)),x=asciiToBase16$2(e.charCodeAt(c+1));if(l===void 0||x===void 0){const f=e[c]+e[c+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+c)}r[o]=l*16+x}return r}function concatBytes$4(...e){let t=0;for(let r=0;r<e.length;r++){const o=e[r];abytes$1(o),t+=o.length}const n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){const c=e[r];n.set(c,o),o+=c.length}return n}function createHasher$1(e,t={}){const n=(o,c)=>e(c).update(o).digest(),r=e(void 0);return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=o=>e(o),Object.assign(n,t),Object.freeze(n)}function randomBytes$3(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const oidNist=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function Chi$3(e,t,n){return e&t^~e&n}function Maj$3(e,t,n){return e&t^e&n^t&n}let HashMD$1=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,n,r,o){this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=createView$4(this.buffer)}update(t){aexists$1(this),abytes$1(t);const{view:n,buffer:r,blockLen:o}=this,c=t.length;for(let l=0;l<c;){const x=Math.min(o-this.pos,c-l);if(x===o){const f=createView$4(t);for(;o<=c-l;l+=o)this.process(f,l);continue}r.set(t.subarray(l,l+x),this.pos),this.pos+=x,l+=x,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists$1(this),aoutput$1(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:c}=this;let{pos:l}=this;n[l++]=128,clean$1(this.buffer.subarray(l)),this.padOffset>o-l&&(this.process(r,0),l=0);for(let g=l;g<o;g++)n[g]=0;r.setBigUint64(o-8,BigInt(this.length*8),c),this.process(r,0);const x=createView$4(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const m=f/4,E=this.get();if(m>E.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<m;g++)x.setUint32(4*g,E[g],c)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:c,destroyed:l,pos:x}=this;return t.destroyed=l,t.finished=c,t.length=o,t.pos=x,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};const SHA256_IV$1=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(e,t=!1){return t?{h:Number(e&U32_MASK64),l:Number(e>>_32n&U32_MASK64)}:{h:Number(e>>_32n&U32_MASK64)|0,l:Number(e&U32_MASK64)|0}}function split(e,t=!1){const n=e.length;let r=new Uint32Array(n),o=new Uint32Array(n);for(let c=0;c<n;c++){const{h:l,l:x}=fromBig(e[c],t);[r[c],o[c]]=[l,x]}return[r,o]}const shrSH=(e,t,n)=>e>>>n,shrSL=(e,t,n)=>e<<32-n|t>>>n,rotrSH=(e,t,n)=>e>>>n|t<<32-n,rotrSL=(e,t,n)=>e<<32-n|t>>>n,rotrBH=(e,t,n)=>e<<64-n|t>>>n-32,rotrBL=(e,t,n)=>e>>>n-32|t<<64-n;function add(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}const add3L=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,add5L=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),add5H=(e,t,n,r,o,c)=>t+n+r+o+c+(e/2**32|0)|0,SHA256_K$3=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W$3=new Uint32Array(64);class SHA2_32B extends HashMD$1{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:n,C:r,D:o,E:c,F:l,G:x,H:f}=this;return[t,n,r,o,c,l,x,f]}set(t,n,r,o,c,l,x,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=c|0,this.F=l|0,this.G=x|0,this.H=f|0}process(t,n){for(let g=0;g<16;g++,n+=4)SHA256_W$3[g]=t.getUint32(n,!1);for(let g=16;g<64;g++){const y=SHA256_W$3[g-15],w=SHA256_W$3[g-2],v=rotr$3(y,7)^rotr$3(y,18)^y>>>3,_=rotr$3(w,17)^rotr$3(w,19)^w>>>10;SHA256_W$3[g]=_+SHA256_W$3[g-7]+v+SHA256_W$3[g-16]|0}let{A:r,B:o,C:c,D:l,E:x,F:f,G:m,H:E}=this;for(let g=0;g<64;g++){const y=rotr$3(x,6)^rotr$3(x,11)^rotr$3(x,25),w=E+y+Chi$3(x,f,m)+SHA256_K$3[g]+SHA256_W$3[g]|0,_=(rotr$3(r,2)^rotr$3(r,13)^rotr$3(r,22))+Maj$3(r,o,c)|0;E=m,m=f,f=x,x=l+w|0,l=c,c=o,o=r,r=w+_|0}r=r+this.A|0,o=o+this.B|0,c=c+this.C|0,l=l+this.D|0,x=x+this.E|0,f=f+this.F|0,m=m+this.G|0,E=E+this.H|0,this.set(r,o,c,l,x,f,m,E)}roundClean(){clean$1(SHA256_W$3)}destroy(){this.set(0,0,0,0,0,0,0,0),clean$1(this.buffer)}}class _SHA256 extends SHA2_32B{A=SHA256_IV$1[0]|0;B=SHA256_IV$1[1]|0;C=SHA256_IV$1[2]|0;D=SHA256_IV$1[3]|0;E=SHA256_IV$1[4]|0;F=SHA256_IV$1[5]|0;G=SHA256_IV$1[6]|0;H=SHA256_IV$1[7]|0;constructor(){super(32)}}const K512=split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),SHA512_Kh=K512[0],SHA512_Kl=K512[1],SHA512_W_H=new Uint32Array(80),SHA512_W_L=new Uint32Array(80);class SHA2_64B extends HashMD$1{constructor(t){super(128,t,16,!1)}get(){const{Ah:t,Al:n,Bh:r,Bl:o,Ch:c,Cl:l,Dh:x,Dl:f,Eh:m,El:E,Fh:g,Fl:y,Gh:w,Gl:v,Hh:_,Hl:F}=this;return[t,n,r,o,c,l,x,f,m,E,g,y,w,v,_,F]}set(t,n,r,o,c,l,x,f,m,E,g,y,w,v,_,F){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=c|0,this.Cl=l|0,this.Dh=x|0,this.Dl=f|0,this.Eh=m|0,this.El=E|0,this.Fh=g|0,this.Fl=y|0,this.Gh=w|0,this.Gl=v|0,this.Hh=_|0,this.Hl=F|0}process(t,n){for(let T=0;T<16;T++,n+=4)SHA512_W_H[T]=t.getUint32(n),SHA512_W_L[T]=t.getUint32(n+=4);for(let T=16;T<80;T++){const L=SHA512_W_H[T-15]|0,N=SHA512_W_L[T-15]|0,I=rotrSH(L,N,1)^rotrSH(L,N,8)^shrSH(L,N,7),U=rotrSL(L,N,1)^rotrSL(L,N,8)^shrSL(L,N,7),W=SHA512_W_H[T-2]|0,O=SHA512_W_L[T-2]|0,Z=rotrSH(W,O,19)^rotrBH(W,O,61)^shrSH(W,O,6),z=rotrSL(W,O,19)^rotrBL(W,O,61)^shrSL(W,O,6),q=add4L(U,z,SHA512_W_L[T-7],SHA512_W_L[T-16]),$=add4H(q,I,Z,SHA512_W_H[T-7],SHA512_W_H[T-16]);SHA512_W_H[T]=$|0,SHA512_W_L[T]=q|0}let{Ah:r,Al:o,Bh:c,Bl:l,Ch:x,Cl:f,Dh:m,Dl:E,Eh:g,El:y,Fh:w,Fl:v,Gh:_,Gl:F,Hh:H,Hl:Y}=this;for(let T=0;T<80;T++){const L=rotrSH(g,y,14)^rotrSH(g,y,18)^rotrBH(g,y,41),N=rotrSL(g,y,14)^rotrSL(g,y,18)^rotrBL(g,y,41),I=g&w^~g&_,U=y&v^~y&F,W=add5L(Y,N,U,SHA512_Kl[T],SHA512_W_L[T]),O=add5H(W,H,L,I,SHA512_Kh[T],SHA512_W_H[T]),Z=W|0,z=rotrSH(r,o,28)^rotrBH(r,o,34)^rotrBH(r,o,39),q=rotrSL(r,o,28)^rotrBL(r,o,34)^rotrBL(r,o,39),$=r&c^r&x^c&x,M=o&l^o&f^l&f;H=_|0,Y=F|0,_=w|0,F=v|0,w=g|0,v=y|0,{h:g,l:y}=add(m|0,E|0,O|0,Z|0),m=x|0,E=f|0,x=c|0,f=l|0,c=r|0,l=o|0;const S=add3L(Z,q,M);r=add3H(S,O,z,$),o=S|0}({h:r,l:o}=add(this.Ah|0,this.Al|0,r|0,o|0)),{h:c,l}=add(this.Bh|0,this.Bl|0,c|0,l|0),{h:x,l:f}=add(this.Ch|0,this.Cl|0,x|0,f|0),{h:m,l:E}=add(this.Dh|0,this.Dl|0,m|0,E|0),{h:g,l:y}=add(this.Eh|0,this.El|0,g|0,y|0),{h:w,l:v}=add(this.Fh|0,this.Fl|0,w|0,v|0),{h:_,l:F}=add(this.Gh|0,this.Gl|0,_|0,F|0),{h:H,l:Y}=add(this.Hh|0,this.Hl|0,H|0,Y|0),this.set(r,o,c,l,x,f,m,E,g,y,w,v,_,F,H,Y)}roundClean(){clean$1(SHA512_W_H,SHA512_W_L)}destroy(){clean$1(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class _SHA512 extends SHA2_64B{Ah=SHA512_IV[0]|0;Al=SHA512_IV[1]|0;Bh=SHA512_IV[2]|0;Bl=SHA512_IV[3]|0;Ch=SHA512_IV[4]|0;Cl=SHA512_IV[5]|0;Dh=SHA512_IV[6]|0;Dl=SHA512_IV[7]|0;Eh=SHA512_IV[8]|0;El=SHA512_IV[9]|0;Fh=SHA512_IV[10]|0;Fl=SHA512_IV[11]|0;Gh=SHA512_IV[12]|0;Gl=SHA512_IV[13]|0;Hh=SHA512_IV[14]|0;Hl=SHA512_IV[15]|0;constructor(){super(64)}}const sha256$4=createHasher$1(()=>new _SHA256,oidNist(1)),sha512=createHasher$1(()=>new _SHA512,oidNist(3));const _0n$d=BigInt(0),_1n$d=BigInt(1);function abool(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}" `;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function abignumber(e){if(typeof e=="bigint"){if(!isPosBig$1(e))throw new Error("positive bigint expected, got "+e)}else anumber$2(e);return e}function numberToHexUnpadded$2(e){const t=abignumber(e).toString(16);return t.length&1?"0"+t:t}function hexToNumber$2(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?_0n$d:BigInt("0x"+e)}function bytesToNumberBE$2(e){return hexToNumber$2(bytesToHex$4(e))}function bytesToNumberLE$2(e){return hexToNumber$2(bytesToHex$4(copyBytes(abytes$1(e)).reverse()))}function numberToBytesBE$2(e,t){anumber$2(t),e=abignumber(e);const n=hexToBytes$6(e.toString(16).padStart(t*2,"0"));if(n.length!==t)throw new Error("number too large");return n}function numberToBytesLE$2(e,t){return numberToBytesBE$2(e,t).reverse()}function copyBytes(e){return Uint8Array.from(e)}const isPosBig$1=e=>typeof e=="bigint"&&_0n$d<=e;function inRange$1(e,t,n){return isPosBig$1(e)&&isPosBig$1(t)&&isPosBig$1(n)&&t<=e&&e<n}function aInRange$1(e,t,n,r){if(!inRange$1(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function bitLen$2(e){let t;for(t=0;e>_0n$d;e>>=_1n$d,t+=1);return t}const bitMask$2=e=>(_1n$d<<BigInt(e))-_1n$d;function createHmacDrbg$2(e,t,n){if(anumber$2(e,"hashLen"),anumber$2(t,"qByteLen"),typeof n!="function")throw new Error("hmacFn must be a function");const r=F=>new Uint8Array(F),o=Uint8Array.of(),c=Uint8Array.of(0),l=Uint8Array.of(1),x=1e3;let f=r(e),m=r(e),E=0;const g=()=>{f.fill(1),m.fill(0),E=0},y=(...F)=>n(m,concatBytes$4(f,...F)),w=(F=o)=>{m=y(c,F),f=y(),F.length!==0&&(m=y(l,F),f=y())},v=()=>{if(E++>=x)throw new Error("drbg: tried max amount of iterations");let F=0;const H=[];for(;F<t;){f=y();const Y=f.slice();H.push(Y),F+=f.length}return concatBytes$4(...H)};return(F,H)=>{g(),w(F);let Y;for(;!(Y=H(v()));)w();return g(),Y}}function validateObject$1(e,t={},n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(c,l,x){const f=e[c];if(x&&f===void 0)return;const m=typeof f;if(m!==l||f===null)throw new Error(`param "${c}" is invalid: expected ${l}, got ${m}`)}const o=(c,l)=>Object.entries(c).forEach(([x,f])=>r(x,f,l));o(t,!1),o(n,!0)}function memoized$1(e){const t=new WeakMap;return(n,...r)=>{const o=t.get(n);if(o!==void 0)return o;const c=e(n,...r);return t.set(n,c),c}}const _0n$c=BigInt(0),_1n$c=BigInt(1),_2n$8=BigInt(2),_3n$5=BigInt(3),_4n$4=BigInt(4),_5n$2=BigInt(5),_7n$1=BigInt(7),_8n$2=BigInt(8),_9n$1=BigInt(9),_16n$1=BigInt(16);function mod$2(e,t){const n=e%t;return n>=_0n$c?n:t+n}function pow2$2(e,t,n){let r=e;for(;t-- >_0n$c;)r*=r,r%=n;return r}function invert$2(e,t){if(e===_0n$c)throw new Error("invert: expected non-zero number");if(t<=_0n$c)throw new Error("invert: expected positive modulus, got "+t);let n=mod$2(e,t),r=t,o=_0n$c,c=_1n$c;for(;n!==_0n$c;){const x=r/n,f=r%n,m=o-c*x;r=n,n=f,o=c,c=m}if(r!==_1n$c)throw new Error("invert: does not exist");return mod$2(o,t)}function assertIsSquare$1(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function sqrt3mod4$1(e,t){const n=(e.ORDER+_1n$c)/_4n$4,r=e.pow(t,n);return assertIsSquare$1(e,r,t),r}function sqrt5mod8$1(e,t){const n=(e.ORDER-_5n$2)/_8n$2,r=e.mul(t,_2n$8),o=e.pow(r,n),c=e.mul(t,o),l=e.mul(e.mul(c,_2n$8),o),x=e.mul(c,e.sub(l,e.ONE));return assertIsSquare$1(e,x,t),x}function sqrt9mod16$1(e){const t=Field$2(e),n=tonelliShanks$2(e),r=n(t,t.neg(t.ONE)),o=n(t,r),c=n(t,t.neg(r)),l=(e+_7n$1)/_16n$1;return(x,f)=>{let m=x.pow(f,l),E=x.mul(m,r);const g=x.mul(m,o),y=x.mul(m,c),w=x.eql(x.sqr(E),f),v=x.eql(x.sqr(g),f);m=x.cmov(m,E,w),E=x.cmov(y,g,v);const _=x.eql(x.sqr(E),f),F=x.cmov(m,E,_);return assertIsSquare$1(x,F,f),F}}function tonelliShanks$2(e){if(e<_3n$5)throw new Error("sqrt is not defined for small field");let t=e-_1n$c,n=0;for(;t%_2n$8===_0n$c;)t/=_2n$8,n++;let r=_2n$8;const o=Field$2(e);for(;FpLegendre$1(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return sqrt3mod4$1;let c=o.pow(r,t);const l=(t+_1n$c)/_2n$8;return function(f,m){if(f.is0(m))return m;if(FpLegendre$1(f,m)!==1)throw new Error("Cannot find square root");let E=n,g=f.mul(f.ONE,c),y=f.pow(m,t),w=f.pow(m,l);for(;!f.eql(y,f.ONE);){if(f.is0(y))return f.ZERO;let v=1,_=f.sqr(y);for(;!f.eql(_,f.ONE);)if(v++,_=f.sqr(_),v===E)throw new Error("Cannot find square root");const F=_1n$c<<BigInt(E-v-1),H=f.pow(g,F);E=v,g=f.sqr(H),y=f.mul(y,g),w=f.mul(w,H)}return w}}function FpSqrt$2(e){return e%_4n$4===_3n$5?sqrt3mod4$1:e%_8n$2===_5n$2?sqrt5mod8$1:e%_16n$1===_9n$1?sqrt9mod16$1(e):tonelliShanks$2(e)}const FIELD_FIELDS$2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$2(e){const t={ORDER:"bigint",BYTES:"number",BITS:"number"},n=FIELD_FIELDS$2.reduce((r,o)=>(r[o]="function",r),t);return validateObject$1(e,n),e}function FpPow$2(e,t,n){if(n<_0n$c)throw new Error("invalid exponent, negatives unsupported");if(n===_0n$c)return e.ONE;if(n===_1n$c)return t;let r=e.ONE,o=t;for(;n>_0n$c;)n&_1n$c&&(r=e.mul(r,o)),o=e.sqr(o),n>>=_1n$c;return r}function FpInvertBatch$2(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((l,x,f)=>e.is0(x)?l:(r[f]=l,e.mul(l,x)),e.ONE),c=e.inv(o);return t.reduceRight((l,x,f)=>e.is0(x)?l:(r[f]=e.mul(l,r[f]),e.mul(l,x)),c),r}function FpLegendre$1(e,t){const n=(e.ORDER-_1n$c)/_2n$8,r=e.pow(t,n),o=e.eql(r,e.ONE),c=e.eql(r,e.ZERO),l=e.eql(r,e.neg(e.ONE));if(!o&&!c&&!l)throw new Error("invalid Legendre symbol result");return o?1:c?0:-1}function nLength$2(e,t){t!==void 0&&anumber$2(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}class _Field{ORDER;BITS;BYTES;isLE;ZERO=_0n$c;ONE=_1n$c;_lengths;_sqrt;_mod;constructor(t,n={}){if(t<=_0n$c)throw new Error("invalid field: expected ORDER > 0, got "+t);let r;this.isLE=!1,n!=null&&typeof n=="object"&&(typeof n.BITS=="number"&&(r=n.BITS),typeof n.sqrt=="function"&&(this.sqrt=n.sqrt),typeof n.isLE=="boolean"&&(this.isLE=n.isLE),n.allowedLengths&&(this._lengths=n.allowedLengths?.slice()),typeof n.modFromBytes=="boolean"&&(this._mod=n.modFromBytes));const{nBitLength:o,nByteLength:c}=nLength$2(t,r);if(c>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=c,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return mod$2(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return _0n$c<=t&&t<this.ORDER}is0(t){return t===_0n$c}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&_1n$c)===_1n$c}neg(t){return mod$2(-t,this.ORDER)}eql(t,n){return t===n}sqr(t){return mod$2(t*t,this.ORDER)}add(t,n){return mod$2(t+n,this.ORDER)}sub(t,n){return mod$2(t-n,this.ORDER)}mul(t,n){return mod$2(t*n,this.ORDER)}pow(t,n){return FpPow$2(this,t,n)}div(t,n){return mod$2(t*invert$2(n,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,n){return t+n}subN(t,n){return t-n}mulN(t,n){return t*n}inv(t){return invert$2(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=FpSqrt$2(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?numberToBytesLE$2(t,this.BYTES):numberToBytesBE$2(t,this.BYTES)}fromBytes(t,n=!1){abytes$1(t);const{_lengths:r,BYTES:o,isLE:c,ORDER:l,_mod:x}=this;if(r){if(!r.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+r+" bytes, got "+t.length);const m=new Uint8Array(o);m.set(t,c?0:m.length-t.length),t=m}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let f=c?bytesToNumberLE$2(t):bytesToNumberBE$2(t);if(x&&(f=mod$2(f,l)),!n&&!this.isValid(f))throw new Error("invalid field element: outside of range 0..ORDER");return f}invertBatch(t){return FpInvertBatch$2(this,t)}cmov(t,n,r){return r?n:t}}function Field$2(e,t={}){return new _Field(e,t)}function getFieldBytesLength$2(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength$2(e){const t=getFieldBytesLength$2(e);return t+Math.ceil(t/2)}function mapHashToField$2(e,t,n=!1){abytes$1(e);const r=e.length,o=getFieldBytesLength$2(t),c=getMinHashLength$2(t);if(r<16||r<c||r>1024)throw new Error("expected "+c+"-1024 bytes of input, got "+r);const l=n?bytesToNumberLE$2(e):bytesToNumberBE$2(e),x=mod$2(l,t-_1n$c)+_1n$c;return n?numberToBytesLE$2(x,o):numberToBytesBE$2(x,o)}const _0n$b=BigInt(0),_1n$b=BigInt(1);function negateCt$1(e,t){const n=t.negate();return e?n:t}function normalizeZ$1(e,t){const n=FpInvertBatch$2(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}function validateW$1(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function calcWOpts$1(e,t){validateW$1(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,c=bitMask$2(e),l=BigInt(e);return{windows:n,windowSize:r,mask:c,maxNumber:o,shiftBy:l}}function calcOffsets$1(e,t,n){const{windowSize:r,mask:o,maxNumber:c,shiftBy:l}=n;let x=Number(e&o),f=e>>l;x>r&&(x-=c,f+=_1n$b);const m=t*r,E=m+Math.abs(x)-1,g=x===0,y=x<0,w=t%2!==0;return{nextN:f,offset:E,isZero:g,isNeg:y,isNegF:w,offsetF:m}}const pointPrecomputes$1=new WeakMap,pointWindowSizes$1=new WeakMap;function getW$1(e){return pointWindowSizes$1.get(e)||1}function assert0$1(e){if(e!==_0n$b)throw new Error("invalid wNAF")}let wNAF$2=class{BASE;ZERO;Fn;bits;constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>_0n$b;)n&_1n$b&&(r=r.add(o)),o=o.double(),n>>=_1n$b;return r}precomputeWindow(t,n){const{windows:r,windowSize:o}=calcWOpts$1(n,this.bits),c=[];let l=t,x=l;for(let f=0;f<r;f++){x=l,c.push(x);for(let m=1;m<o;m++)x=x.add(l),c.push(x);l=x.double()}return c}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,c=this.BASE;const l=calcWOpts$1(t,this.bits);for(let x=0;x<l.windows;x++){const{nextN:f,offset:m,isZero:E,isNeg:g,isNegF:y,offsetF:w}=calcOffsets$1(r,x,l);r=f,E?c=c.add(negateCt$1(y,n[w])):o=o.add(negateCt$1(g,n[m]))}return assert0$1(r),{p:o,f:c}}wNAFUnsafe(t,n,r,o=this.ZERO){const c=calcWOpts$1(t,this.bits);for(let l=0;l<c.windows&&r!==_0n$b;l++){const{nextN:x,offset:f,isZero:m,isNeg:E}=calcOffsets$1(r,l,c);if(r=x,!m){const g=n[f];o=o.add(E?g.negate():g)}}return assert0$1(r),o}getPrecomputes(t,n,r){let o=pointPrecomputes$1.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),pointPrecomputes$1.set(n,o))),o}cached(t,n,r){const o=getW$1(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){const c=getW$1(t);return c===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(c,this.getPrecomputes(c,t,r),n,o)}createCache(t,n){validateW$1(n,this.bits),pointWindowSizes$1.set(t,n),pointPrecomputes$1.delete(t)}hasCache(t){return getW$1(t)!==1}};function mulEndoUnsafe$1(e,t,n,r){let o=t,c=e.ZERO,l=e.ZERO;for(;n>_0n$b||r>_0n$b;)n&_1n$b&&(c=c.add(o)),r&_1n$b&&(l=l.add(o)),o=o.double(),n>>=_1n$b,r>>=_1n$b;return{p1:c,p2:l}}function createField$1(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField$2(t),t}else return Field$2(e,{isLE:n})}function createCurveFields(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const f of["p","n","h"]){const m=t[f];if(!(typeof m=="bigint"&&m>_0n$b))throw new Error(`CURVE.${f} must be positive bigint`)}const o=createField$1(t.p,n.Fp,r),c=createField$1(t.n,n.Fn,r),x=["Gx","Gy","a","b"];for(const f of x)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:c}}function createKeygen(e,t){return function(r){const o=e(r);return{secretKey:o,publicKey:t(o)}}}class _HMAC{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(ahash$1(t),abytes$1(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let c=0;c<o.length;c++)o[c]^=54;this.iHash.update(o),this.oHash=t.create();for(let c=0;c<o.length;c++)o[c]^=106;this.oHash.update(o),clean$1(o)}update(t){return aexists$1(this),this.iHash.update(t),this}digestInto(t){aexists$1(this),abytes$1(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:n,iHash:r,finished:o,destroyed:c,blockLen:l,outputLen:x}=this;return t=t,t.finished=o,t.destroyed=c,t.blockLen=l,t.outputLen=x,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac$4=(e,t,n)=>new _HMAC(e,t).update(n).digest();hmac$4.create=(e,t)=>new _HMAC(e,t);const divNearest$2=(e,t)=>(e+(e>=0?t:-t)/_2n$7)/t;function _splitEndoScalar$1(e,t,n){const[[r,o],[c,l]]=t,x=divNearest$2(l*e,n),f=divNearest$2(-o*e,n);let m=e-x*r-f*c,E=-x*o-f*l;const g=m<_0n$a,y=E<_0n$a;g&&(m=-m),y&&(E=-E);const w=bitMask$2(Math.ceil(bitLen$2(n)/2))+_1n$a;if(m<_0n$a||m>=w||E<_0n$a||E>=w)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:g,k1:m,k2neg:y,k2:E}}function validateSigFormat$1(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function validateSigOpts$1(e,t){const n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return abool(n.lowS,"lowS"),abool(n.prehash,"prehash"),n.format!==void 0&&validateSigFormat$1(n.format),n}let DERErr$1=class extends Error{constructor(t=""){super(t)}};const DER$2={Err:DERErr$1,_tlv:{encode:(e,t)=>{const{Err:n}=DER$2;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,o=numberToHexUnpadded$2(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");const c=r>127?numberToHexUnpadded$2(o.length/2|128):"";return numberToHexUnpadded$2(e)+c+o+t},decode(e,t){const{Err:n}=DER$2;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const o=t[r++],c=!!(o&128);let l=0;if(!c)l=o;else{const f=o&127;if(!f)throw new n("tlv.decode(long): indefinite length not supported");if(f>4)throw new n("tlv.decode(long): byte length is too big");const m=t.subarray(r,r+f);if(m.length!==f)throw new n("tlv.decode: length bytes not complete");if(m[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const E of m)l=l<<8|E;if(r+=f,l<128)throw new n("tlv.decode(long): not minimal encoding")}const x=t.subarray(r,r+l);if(x.length!==l)throw new n("tlv.decode: wrong value length");return{v:x,l:t.subarray(r+l)}}},_int:{encode(e){const{Err:t}=DER$2;if(e<_0n$a)throw new t("integer: negative integers are not allowed");let n=numberToHexUnpadded$2(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=DER$2;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return bytesToNumberBE$2(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=DER$2,o=abytes$1(e,void 0,"signature"),{v:c,l}=r.decode(48,o);if(l.length)throw new t("invalid signature: left bytes after parsing");const{v:x,l:f}=r.decode(2,c),{v:m,l:E}=r.decode(2,f);if(E.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(x),s:n.decode(m)}},hexFromSig(e){const{_tlv:t,_int:n}=DER$2,r=t.encode(2,n.encode(e.r)),o=t.encode(2,n.encode(e.s)),c=r+o;return t.encode(48,c)}},_0n$a=BigInt(0),_1n$a=BigInt(1),_2n$7=BigInt(2),_3n$4=BigInt(3),_4n$3=BigInt(4);function weierstrass$3(e,t={}){const n=createCurveFields("weierstrass",e,t),{Fp:r,Fn:o}=n;let c=n.CURVE;const{h:l,n:x}=c;validateObject$1(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});const{endo:f}=t;if(f&&(!r.is0(c.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const m=getWLengths$1(r,o);function E(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function g(q,$,M){const{x:S,y:R}=$.toAffine(),D=r.toBytes(S);if(abool(M,"isCompressed"),M){E();const j=!r.isOdd(R);return concatBytes$4(pprefix$1(j),D)}else return concatBytes$4(Uint8Array.of(4),D,r.toBytes(R))}function y(q){abytes$1(q,void 0,"Point");const{publicKey:$,publicKeyUncompressed:M}=m,S=q.length,R=q[0],D=q.subarray(1);if(S===$&&(R===2||R===3)){const j=r.fromBytes(D);if(!r.isValid(j))throw new Error("bad point: is not on curve, wrong x");const P=_(j);let Q;try{Q=r.sqrt(P)}catch(J){const ne=J instanceof Error?": "+J.message:"";throw new Error("bad point: is not on curve, sqrt error"+ne)}E();const C=r.isOdd(Q);return(R&1)===1!==C&&(Q=r.neg(Q)),{x:j,y:Q}}else if(S===M&&R===4){const j=r.BYTES,P=r.fromBytes(D.subarray(0,j)),Q=r.fromBytes(D.subarray(j,j*2));if(!F(P,Q))throw new Error("bad point: is not on curve");return{x:P,y:Q}}else throw new Error(`bad point: got length ${S}, expected compressed=${$} or uncompressed=${M}`)}const w=t.toBytes||g,v=t.fromBytes||y;function _(q){const $=r.sqr(q),M=r.mul($,q);return r.add(r.add(M,r.mul(q,c.a)),c.b)}function F(q,$){const M=r.sqr($),S=_(q);return r.eql(M,S)}if(!F(c.Gx,c.Gy))throw new Error("bad curve params: generator point");const H=r.mul(r.pow(c.a,_3n$4),_4n$3),Y=r.mul(r.sqr(c.b),BigInt(27));if(r.is0(r.add(H,Y)))throw new Error("bad curve params: a or b");function T(q,$,M=!1){if(!r.isValid($)||M&&r.is0($))throw new Error(`bad point coordinate ${q}`);return $}function L(q){if(!(q instanceof O))throw new Error("Weierstrass Point expected")}function N(q){if(!f||!f.basises)throw new Error("no endo");return _splitEndoScalar$1(q,f.basises,o.ORDER)}const I=memoized$1((q,$)=>{const{X:M,Y:S,Z:R}=q;if(r.eql(R,r.ONE))return{x:M,y:S};const D=q.is0();$==null&&($=D?r.ONE:r.inv(R));const j=r.mul(M,$),P=r.mul(S,$),Q=r.mul(R,$);if(D)return{x:r.ZERO,y:r.ZERO};if(!r.eql(Q,r.ONE))throw new Error("invZ was invalid");return{x:j,y:P}}),U=memoized$1(q=>{if(q.is0()){if(t.allowInfinityPoint&&!r.is0(q.Y))return;throw new Error("bad point: ZERO")}const{x:$,y:M}=q.toAffine();if(!r.isValid($)||!r.isValid(M))throw new Error("bad point: x or y not field elements");if(!F($,M))throw new Error("bad point: equation left != right");if(!q.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function W(q,$,M,S,R){return M=new O(r.mul(M.X,q),M.Y,M.Z),$=negateCt$1(S,$),M=negateCt$1(R,M),$.add(M)}class O{static BASE=new O(c.Gx,c.Gy,r.ONE);static ZERO=new O(r.ZERO,r.ONE,r.ZERO);static Fp=r;static Fn=o;X;Y;Z;constructor($,M,S){this.X=T("x",$),this.Y=T("y",M,!0),this.Z=T("z",S),Object.freeze(this)}static CURVE(){return c}static fromAffine($){const{x:M,y:S}=$||{};if(!$||!r.isValid(M)||!r.isValid(S))throw new Error("invalid affine point");if($ instanceof O)throw new Error("projective point not allowed");return r.is0(M)&&r.is0(S)?O.ZERO:new O(M,S,r.ONE)}static fromBytes($){const M=O.fromAffine(v(abytes$1($,void 0,"point")));return M.assertValidity(),M}static fromHex($){return O.fromBytes(hexToBytes$6($))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute($=8,M=!0){return z.createCache(this,$),M||this.multiply(_3n$4),this}assertValidity(){U(this)}hasEvenY(){const{y:$}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd($)}equals($){L($);const{X:M,Y:S,Z:R}=this,{X:D,Y:j,Z:P}=$,Q=r.eql(r.mul(M,P),r.mul(D,R)),C=r.eql(r.mul(S,P),r.mul(j,R));return Q&&C}negate(){return new O(this.X,r.neg(this.Y),this.Z)}double(){const{a:$,b:M}=c,S=r.mul(M,_3n$4),{X:R,Y:D,Z:j}=this;let P=r.ZERO,Q=r.ZERO,C=r.ZERO,K=r.mul(R,R),J=r.mul(D,D),ne=r.mul(j,j),re=r.mul(R,D);return re=r.add(re,re),C=r.mul(R,j),C=r.add(C,C),P=r.mul($,C),Q=r.mul(S,ne),Q=r.add(P,Q),P=r.sub(J,Q),Q=r.add(J,Q),Q=r.mul(P,Q),P=r.mul(re,P),C=r.mul(S,C),ne=r.mul($,ne),re=r.sub(K,ne),re=r.mul($,re),re=r.add(re,C),C=r.add(K,K),K=r.add(C,K),K=r.add(K,ne),K=r.mul(K,re),Q=r.add(Q,K),ne=r.mul(D,j),ne=r.add(ne,ne),K=r.mul(ne,re),P=r.sub(P,K),C=r.mul(ne,J),C=r.add(C,C),C=r.add(C,C),new O(P,Q,C)}add($){L($);const{X:M,Y:S,Z:R}=this,{X:D,Y:j,Z:P}=$;let Q=r.ZERO,C=r.ZERO,K=r.ZERO;const J=c.a,ne=r.mul(c.b,_3n$4);let re=r.mul(M,D),ie=r.mul(S,j),ce=r.mul(R,P),ue=r.add(M,S),ae=r.add(D,j);ue=r.mul(ue,ae),ae=r.add(re,ie),ue=r.sub(ue,ae),ae=r.add(M,R);let we=r.add(D,P);return ae=r.mul(ae,we),we=r.add(re,ce),ae=r.sub(ae,we),we=r.add(S,R),Q=r.add(j,P),we=r.mul(we,Q),Q=r.add(ie,ce),we=r.sub(we,Q),K=r.mul(J,ae),Q=r.mul(ne,ce),K=r.add(Q,K),Q=r.sub(ie,K),K=r.add(ie,K),C=r.mul(Q,K),ie=r.add(re,re),ie=r.add(ie,re),ce=r.mul(J,ce),ae=r.mul(ne,ae),ie=r.add(ie,ce),ce=r.sub(re,ce),ce=r.mul(J,ce),ae=r.add(ae,ce),re=r.mul(ie,ae),C=r.add(C,re),re=r.mul(we,ae),Q=r.mul(ue,Q),Q=r.sub(Q,re),re=r.mul(ue,ie),K=r.mul(we,K),K=r.add(K,re),new O(Q,C,K)}subtract($){return this.add($.negate())}is0(){return this.equals(O.ZERO)}multiply($){const{endo:M}=t;if(!o.isValidNot0($))throw new Error("invalid scalar: out of range");let S,R;const D=j=>z.cached(this,j,P=>normalizeZ$1(O,P));if(M){const{k1neg:j,k1:P,k2neg:Q,k2:C}=N($),{p:K,f:J}=D(P),{p:ne,f:re}=D(C);R=J.add(re),S=W(M.beta,K,ne,j,Q)}else{const{p:j,f:P}=D($);S=j,R=P}return normalizeZ$1(O,[S,R])[0]}multiplyUnsafe($){const{endo:M}=t,S=this;if(!o.isValid($))throw new Error("invalid scalar: out of range");if($===_0n$a||S.is0())return O.ZERO;if($===_1n$a)return S;if(z.hasCache(this))return this.multiply($);if(M){const{k1neg:R,k1:D,k2neg:j,k2:P}=N($),{p1:Q,p2:C}=mulEndoUnsafe$1(O,S,D,P);return W(M.beta,Q,C,R,j)}else return z.unsafe(S,$)}toAffine($){return I(this,$)}isTorsionFree(){const{isTorsionFree:$}=t;return l===_1n$a?!0:$?$(O,this):z.unsafe(this,x).is0()}clearCofactor(){const{clearCofactor:$}=t;return l===_1n$a?this:$?$(O,this):this.multiplyUnsafe(l)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}toBytes($=!0){return abool($,"isCompressed"),this.assertValidity(),w(O,this,$)}toHex($=!0){return bytesToHex$4(this.toBytes($))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const Z=o.BITS,z=new wNAF$2(O,t.endo?Math.ceil(Z/2):Z);return O.BASE.precompute(8),O}function pprefix$1(e){return Uint8Array.of(e?2:3)}function getWLengths$1(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function ecdh$1(e,t={}){const{Fn:n}=e,r=t.randomBytes||randomBytes$3,o=Object.assign(getWLengths$1(e.Fp,n),{seed:getMinHashLength$2(n.ORDER)});function c(w){try{const v=n.fromBytes(w);return n.isValidNot0(v)}catch{return!1}}function l(w,v){const{publicKey:_,publicKeyUncompressed:F}=o;try{const H=w.length;return v===!0&&H!==_||v===!1&&H!==F?!1:!!e.fromBytes(w)}catch{return!1}}function x(w=r(o.seed)){return mapHashToField$2(abytes$1(w,o.seed,"seed"),n.ORDER)}function f(w,v=!0){return e.BASE.multiply(n.fromBytes(w)).toBytes(v)}function m(w){const{secretKey:v,publicKey:_,publicKeyUncompressed:F}=o;if(!isBytes$3(w)||"_lengths"in n&&n._lengths||v===_)return;const H=abytes$1(w,void 0,"key").length;return H===_||H===F}function E(w,v,_=!0){if(m(w)===!0)throw new Error("first arg must be private key");if(m(v)===!1)throw new Error("second arg must be public key");const F=n.fromBytes(w);return e.fromBytes(v).multiply(F).toBytes(_)}const g={isValidSecretKey:c,isValidPublicKey:l,randomSecretKey:x},y=createKeygen(x,f);return Object.freeze({getPublicKey:f,getSharedSecret:E,keygen:y,Point:e,utils:g,lengths:o})}function ecdsa$1(e,t,n={}){ahash$1(t),validateObject$1(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),n=Object.assign({},n);const r=n.randomBytes||randomBytes$3,o=n.hmac||((M,S)=>hmac$4(t,M,S)),{Fp:c,Fn:l}=e,{ORDER:x,BITS:f}=l,{keygen:m,getPublicKey:E,getSharedSecret:g,utils:y,lengths:w}=ecdh$1(e,n),v={prehash:!0,lowS:typeof n.lowS=="boolean"?n.lowS:!0,format:"compact",extraEntropy:!1},_=x*_2n$7<c.ORDER;function F(M){const S=x>>_1n$a;return M>S}function H(M,S){if(!l.isValidNot0(S))throw new Error(`invalid signature ${M}: out of range 1..Point.Fn.ORDER`);return S}function Y(){if(_)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function T(M,S){validateSigFormat$1(S);const R=w.signature,D=S==="compact"?R:S==="recovered"?R+1:void 0;return abytes$1(M,D)}class L{r;s;recovery;constructor(S,R,D){if(this.r=H("r",S),this.s=H("s",R),D!=null){if(Y(),![0,1,2,3].includes(D))throw new Error("invalid recovery id");this.recovery=D}Object.freeze(this)}static fromBytes(S,R=v.format){T(S,R);let D;if(R==="der"){const{r:C,s:K}=DER$2.toSig(abytes$1(S));return new L(C,K)}R==="recovered"&&(D=S[0],R="compact",S=S.subarray(1));const j=w.signature/2,P=S.subarray(0,j),Q=S.subarray(j,j*2);return new L(l.fromBytes(P),l.fromBytes(Q),D)}static fromHex(S,R){return this.fromBytes(hexToBytes$6(S),R)}assertRecovery(){const{recovery:S}=this;if(S==null)throw new Error("invalid recovery id: must be present");return S}addRecoveryBit(S){return new L(this.r,this.s,S)}recoverPublicKey(S){const{r:R,s:D}=this,j=this.assertRecovery(),P=j===2||j===3?R+x:R;if(!c.isValid(P))throw new Error("invalid recovery id: sig.r+curve.n != R.x");const Q=c.toBytes(P),C=e.fromBytes(concatBytes$4(pprefix$1((j&1)===0),Q)),K=l.inv(P),J=I(abytes$1(S,void 0,"msgHash")),ne=l.create(-J*K),re=l.create(D*K),ie=e.BASE.multiplyUnsafe(ne).add(C.multiplyUnsafe(re));if(ie.is0())throw new Error("invalid recovery: point at infinify");return ie.assertValidity(),ie}hasHighS(){return F(this.s)}toBytes(S=v.format){if(validateSigFormat$1(S),S==="der")return hexToBytes$6(DER$2.hexFromSig(this));const{r:R,s:D}=this,j=l.toBytes(R),P=l.toBytes(D);return S==="recovered"?(Y(),concatBytes$4(Uint8Array.of(this.assertRecovery()),j,P)):concatBytes$4(j,P)}toHex(S){return bytesToHex$4(this.toBytes(S))}}const N=n.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");const R=bytesToNumberBE$2(S),D=S.length*8-f;return D>0?R>>BigInt(D):R},I=n.bits2int_modN||function(S){return l.create(N(S))},U=bitMask$2(f);function W(M){return aInRange$1("num < 2^"+f,M,_0n$a,U),l.toBytes(M)}function O(M,S){return abytes$1(M,void 0,"message"),S?abytes$1(t(M),void 0,"prehashed message"):M}function Z(M,S,R){const{lowS:D,prehash:j,extraEntropy:P}=validateSigOpts$1(R,v);M=O(M,j);const Q=I(M),C=l.fromBytes(S);if(!l.isValidNot0(C))throw new Error("invalid private key");const K=[W(C),W(Q)];if(P!=null&&P!==!1){const ie=P===!0?r(w.secretKey):P;K.push(abytes$1(ie,void 0,"extraEntropy"))}const J=concatBytes$4(...K),ne=Q;function re(ie){const ce=N(ie);if(!l.isValidNot0(ce))return;const ue=l.inv(ce),ae=e.BASE.multiply(ce).toAffine(),we=l.create(ae.x);if(we===_0n$a)return;const ke=l.create(ue*l.create(ne+we*C));if(ke===_0n$a)return;let Re=(ae.x===we?0:2)|Number(ae.y&_1n$a),be=ke;return D&&F(ke)&&(be=l.neg(ke),Re^=1),new L(we,be,_?void 0:Re)}return{seed:J,k2sig:re}}function z(M,S,R={}){const{seed:D,k2sig:j}=Z(M,S,R);return createHmacDrbg$2(t.outputLen,l.BYTES,o)(D,j).toBytes(R.format)}function q(M,S,R,D={}){const{lowS:j,prehash:P,format:Q}=validateSigOpts$1(D,v);if(R=abytes$1(R,void 0,"publicKey"),S=O(S,P),!isBytes$3(M)){const C=M instanceof L?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+C)}T(M,Q);try{const C=L.fromBytes(M,Q),K=e.fromBytes(R);if(j&&C.hasHighS())return!1;const{r:J,s:ne}=C,re=I(S),ie=l.inv(ne),ce=l.create(re*ie),ue=l.create(J*ie),ae=e.BASE.multiplyUnsafe(ce).add(K.multiplyUnsafe(ue));return ae.is0()?!1:l.create(ae.x)===J}catch{return!1}}function $(M,S,R={}){const{prehash:D}=validateSigOpts$1(R,v);return S=O(S,D),L.fromBytes(M,"recovered").recoverPublicKey(S).toBytes()}return Object.freeze({keygen:m,getPublicKey:E,getSharedSecret:g,utils:y,lengths:w,Point:e,sign:z,verify:q,recoverPublicKey:$,Signature:L,hash:t})}const secp256k1_CURVE$1={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO$1={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_2n$6=BigInt(2);function sqrtMod$2(e){const t=secp256k1_CURVE$1.p,n=BigInt(3),r=BigInt(6),o=BigInt(11),c=BigInt(22),l=BigInt(23),x=BigInt(44),f=BigInt(88),m=e*e*e%t,E=m*m*e%t,g=pow2$2(E,n,t)*E%t,y=pow2$2(g,n,t)*E%t,w=pow2$2(y,_2n$6,t)*m%t,v=pow2$2(w,o,t)*w%t,_=pow2$2(v,c,t)*v%t,F=pow2$2(_,x,t)*_%t,H=pow2$2(F,f,t)*F%t,Y=pow2$2(H,x,t)*_%t,T=pow2$2(Y,n,t)*E%t,L=pow2$2(T,l,t)*v%t,N=pow2$2(L,r,t)*m%t,I=pow2$2(N,_2n$6,t);if(!Fpk1$1.eql(Fpk1$1.sqr(I),e))throw new Error("Cannot find square root");return I}const Fpk1$1=Field$2(secp256k1_CURVE$1.p,{sqrt:sqrtMod$2}),Pointk1$1=weierstrass$3(secp256k1_CURVE$1,{Fp:Fpk1$1,endo:secp256k1_ENDO$1}),secp256k1$3=ecdsa$1(Pointk1$1,sha256$4),Rho160$1=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Id160$1=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),Pi160$1=Id160$1.map(e=>(9*e+5)%16),idxLR$1=(()=>{const n=[[Id160$1],[Pi160$1]];for(let r=0;r<4;r++)for(let o of n)o.push(o[r].map(c=>Rho160$1[c]));return n})(),idxL$1=idxLR$1[0],idxR$1=idxLR$1[1],shifts160$1=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),shiftsL160$1=idxL$1.map((e,t)=>e.map(n=>shifts160$1[t][n])),shiftsR160$1=idxR$1.map((e,t)=>e.map(n=>shifts160$1[t][n])),Kl160$1=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Kr160$1=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ripemd_f$1(e,t,n,r){return e===0?t^n^r:e===1?t&n|~t&r:e===2?(t|~n)^r:e===3?t&r|n&~r:t^(n|~r)}const BUF_160$1=new Uint32Array(16);class _RIPEMD160 extends HashMD$1{h0=1732584193;h1=-271733879;h2=-1732584194;h3=271733878;h4=-1009589776;constructor(){super(64,20,8,!0)}get(){const{h0:t,h1:n,h2:r,h3:o,h4:c}=this;return[t,n,r,o,c]}set(t,n,r,o,c){this.h0=t|0,this.h1=n|0,this.h2=r|0,this.h3=o|0,this.h4=c|0}process(t,n){for(let w=0;w<16;w++,n+=4)BUF_160$1[w]=t.getUint32(n,!0);let r=this.h0|0,o=r,c=this.h1|0,l=c,x=this.h2|0,f=x,m=this.h3|0,E=m,g=this.h4|0,y=g;for(let w=0;w<5;w++){const v=4-w,_=Kl160$1[w],F=Kr160$1[w],H=idxL$1[w],Y=idxR$1[w],T=shiftsL160$1[w],L=shiftsR160$1[w];for(let N=0;N<16;N++){const I=rotl$3(r+ripemd_f$1(w,c,x,m)+BUF_160$1[H[N]]+_,T[N])+g|0;r=g,g=m,m=rotl$3(x,10)|0,x=c,c=I}for(let N=0;N<16;N++){const I=rotl$3(o+ripemd_f$1(v,l,f,E)+BUF_160$1[Y[N]]+F,L[N])+y|0;o=y,y=E,E=rotl$3(f,10)|0,f=l,l=I}}this.set(this.h1+x+E|0,this.h2+m+y|0,this.h3+g+o|0,this.h4+r+l|0,this.h0+c+f|0)}roundClean(){clean$1(BUF_160$1)}destroy(){this.destroyed=!0,clean$1(this.buffer),this.set(0,0,0,0,0)}}const ripemd160$2=createHasher$1(()=>new _RIPEMD160);function isBytes$2(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function isArrayOf(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function afn(e){if(typeof e!="function")throw new Error("function expected");return!0}function astr(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function anumber$1(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function aArr(e){if(!Array.isArray(e))throw new Error("array expected")}function astrArr(e,t){if(!isArrayOf(!0,t))throw new Error(`${e}: array of strings expected`)}function anumArr(e,t){if(!isArrayOf(!1,t))throw new Error(`${e}: array of numbers expected`)}function chain$1(...e){const t=c=>c,n=(c,l)=>x=>c(l(x)),r=e.map(c=>c.encode).reduceRight(n,t),o=e.map(c=>c.decode).reduce(n,t);return{encode:r,decode:o}}function alphabet$1(e){const t=typeof e=="string"?e.split(""):e,n=t.length;astrArr("alphabet",t);const r=new Map(t.map((o,c)=>[o,c]));return{encode:o=>(aArr(o),o.map(c=>{if(!Number.isSafeInteger(c)||c<0||c>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${c}". Allowed: ${e}`);return t[c]})),decode:o=>(aArr(o),o.map(c=>{astr("alphabet.decode",c);const l=r.get(c);if(l===void 0)throw new Error(`Unknown letter: "${c}". Allowed: ${e}`);return l}))}}function join$1(e=""){return astr("join",e),{encode:t=>(astrArr("join.decode",t),t.join(e)),decode:t=>(astr("join.decode",t),t.split(e))}}function convertRadix$1(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(aArr(e),!e.length)return[];let r=0;const o=[],c=Array.from(e,x=>{if(anumber$1(x),x<0||x>=t)throw new Error(`invalid integer: ${x}`);return x}),l=c.length;for(;;){let x=0,f=!0;for(let m=r;m<l;m++){const E=c[m],g=t*x,y=g+E;if(!Number.isSafeInteger(y)||g/t!==x||y-E!==g)throw new Error("convertRadix: carry overflow");const w=y/n;x=y%n;const v=Math.floor(w);if(c[m]=v,!Number.isSafeInteger(v)||v*n+x!==y)throw new Error("convertRadix: carry overflow");if(f)v?f=!1:r=m;else continue}if(o.push(x),f)break}for(let x=0;x<e.length-1&&e[x]===0;x++)o.push(0);return o.reverse()}function radix$1(e){anumber$1(e);const t=2**8;return{encode:n=>{if(!isBytes$2(n))throw new Error("radix.encode input should be Uint8Array");return convertRadix$1(Array.from(n),t,e)},decode:n=>(anumArr("radix.decode",n),Uint8Array.from(convertRadix$1(n,e,t)))}}function checksum(e,t){return anumber$1(e),afn(t),{encode(n){if(!isBytes$2(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),o=new Uint8Array(n.length+e);return o.set(n),o.set(r,n.length),o},decode(n){if(!isBytes$2(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),o=n.slice(-e),c=t(r).slice(0,e);for(let l=0;l<e;l++)if(c[l]!==o[l])throw new Error("Invalid checksum");return r}}}const genBase58$1=e=>chain$1(radix$1(58),alphabet$1(e),join$1("")),base58$2=genBase58$1("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),createBase58check=e=>chain$1(checksum(4,t=>e(e(t))),base58$2);const Point$1=secp256k1$3.Point,{Fn}=Point$1,base58check=createBase58check(sha256$4),MASTER_SECRET=Uint8Array.from("Bitcoin seed".split(""),e=>e.charCodeAt(0)),BITCOIN_VERSIONS={private:76066276,public:76067358},HARDENED_OFFSET=2147483648,hash160$1=e=>ripemd160$2(sha256$4(e)),fromU32=e=>createView$4(e).getUint32(0,!1),toU32=e=>{if(!Number.isSafeInteger(e)||e<0||e>2**32-1)throw new Error("invalid number, should be from 0 to 2**32-1, got "+e);const t=new Uint8Array(4);return createView$4(t).setUint32(0,e,!1),t};class HDKey{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return fromU32(this.pubHash)}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this._privateKey||null}get publicKey(){return this._publicKey||null}get privateExtendedKey(){const t=this._privateKey;if(!t)throw new Error("No private key");return base58check.encode(this.serialize(this.versions.private,concatBytes$4(Uint8Array.of(0),t)))}get publicExtendedKey(){if(!this._publicKey)throw new Error("No public key");return base58check.encode(this.serialize(this.versions.public,this._publicKey))}static fromMasterSeed(t,n=BITCOIN_VERSIONS){if(abytes$1(t),8*t.length<128||8*t.length>512)throw new Error("HDKey: seed length must be between 128 and 512 bits; 256 bits is advised, got "+t.length);const r=hmac$4(sha512,MASTER_SECRET,t),o=r.slice(0,32),c=r.slice(32);return new HDKey({versions:n,chainCode:c,privateKey:o})}static fromExtendedKey(t,n=BITCOIN_VERSIONS){const r=base58check.decode(t),o=createView$4(r),c=o.getUint32(0,!1),l={versions:n,depth:r[4],parentFingerprint:o.getUint32(5,!1),index:o.getUint32(9,!1),chainCode:r.slice(13,45)},x=r.slice(45),f=x[0]===0;if(c!==n[f?"private":"public"])throw new Error("Version mismatch");return f?new HDKey({...l,privateKey:x.slice(1)}):new HDKey({...l,publicKey:x})}static fromJSON(t){return HDKey.fromExtendedKey(t.xpriv)}versions;depth=0;index=0;chainCode=null;parentFingerprint=0;_privateKey;_publicKey;pubHash;constructor(t){if(!t||typeof t!="object")throw new Error("HDKey.constructor must not be called directly");if(this.versions=t.versions||BITCOIN_VERSIONS,this.depth=t.depth||0,this.chainCode=t.chainCode||null,this.index=t.index||0,this.parentFingerprint=t.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(this.depth>255)throw new Error("HDKey: depth exceeds the serializable value 255");if(t.publicKey&&t.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(t.privateKey){if(!secp256k1$3.utils.isValidSecretKey(t.privateKey))throw new Error("Invalid private key");this._privateKey=t.privateKey,this._publicKey=secp256k1$3.getPublicKey(t.privateKey,!0)}else if(t.publicKey)this._publicKey=Point$1.fromBytes(t.publicKey).toBytes(!0);else throw new Error("HDKey: no public or private key provided");this.pubHash=hash160$1(this._publicKey)}derive(t){if(!/^[mM]'?/.test(t))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(t))return this;const n=t.replace(/^[mM]'?\//,"").split("/");let r=this;for(const o of n){const c=/^(\d+)('?)$/.exec(o),l=c&&c[1];if(!c||c.length!==3||typeof l!="string")throw new Error("invalid child index: "+o);let x=+l;if(!Number.isSafeInteger(x)||x>=HARDENED_OFFSET)throw new Error("Invalid index");c[2]==="'"&&(x+=HARDENED_OFFSET),r=r.deriveChild(x)}return r}deriveChild(t){if(!this._publicKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let n=toU32(t);if(t>=HARDENED_OFFSET){const f=this._privateKey;if(!f)throw new Error("Could not derive hardened child key");n=concatBytes$4(Uint8Array.of(0),f,n)}else n=concatBytes$4(this._publicKey,n);const r=hmac$4(sha512,this.chainCode,n),o=r.slice(0,32),c=r.slice(32);if(!secp256k1$3.utils.isValidSecretKey(o))throw new Error("Tweak bigger than curve order");const l={versions:this.versions,chainCode:c,depth:this.depth+1,parentFingerprint:this.fingerprint,index:t},x=Fn.fromBytes(o);try{if(this._privateKey){const f=Fn.create(Fn.fromBytes(this._privateKey)+x);if(!Fn.isValidNot0(f))throw new Error("The tweak was out of range or the resulted private key is invalid");l.privateKey=Fn.toBytes(f)}else{const f=Point$1.fromBytes(this._publicKey).add(Point$1.BASE.multiply(x));if(f.equals(Point$1.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");l.publicKey=f.toBytes(!0)}return new HDKey(l)}catch{return this.deriveChild(t+1)}}sign(t){if(!this._privateKey)throw new Error("No privateKey set!");return abytes$1(t,32),secp256k1$3.sign(t,this._privateKey,{prehash:!1})}verify(t,n){if(abytes$1(t,32),abytes$1(n,64),!this._publicKey)throw new Error("No publicKey set!");return secp256k1$3.verify(n,t,this._publicKey,{prehash:!1})}wipePrivateData(){return this._privateKey&&(this._privateKey.fill(0),this._privateKey=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(t,n){if(!this.chainCode)throw new Error("No chainCode set");return abytes$1(n,33),concatBytes$4(toU32(t),new Uint8Array([this.depth]),toU32(this.parentFingerprint),toU32(this.index),this.chainCode,n)}}function number$4(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bytes$2(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$1(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$4(e.outputLen),number$4(e.blockLen)}function exists$2(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$2(e,t){bytes$2(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const crypto$5=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const u8a$2=e=>e instanceof Uint8Array,createView$3=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$2=(e,t)=>e<<32-t|e>>>t,isLE$2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$2)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$4(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$3(e){if(typeof e=="string"&&(e=utf8ToBytes$4(e)),!u8a$2(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function concatBytes$3(...e){const t=new Uint8Array(e.reduce((r,o)=>r+o.length,0));let n=0;return e.forEach(r=>{if(!u8a$2(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}let Hash$2=class{clone(){return this._cloneInto()}};function wrapConstructor$1(e){const t=r=>e().update(toBytes$3(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes$2(e=32){if(crypto$5&&typeof crypto$5.getRandomValues=="function")return crypto$5.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$3(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),c=BigInt(4294967295),l=Number(n>>o&c),x=Number(n&c),f=r?4:0,m=r?0:4;e.setUint32(t+f,l,r),e.setUint32(t+m,x,r)}let SHA2$1=class extends Hash$2{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=createView$3(this.buffer)}update(t){exists$2(this);const{view:n,buffer:r,blockLen:o}=this;t=toBytes$3(t);const c=t.length;for(let l=0;l<c;){const x=Math.min(o-this.pos,c-l);if(x===o){const f=createView$3(t);for(;o<=c-l;l+=o)this.process(f,l);continue}r.set(t.subarray(l,l+x),this.pos),this.pos+=x,l+=x,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){exists$2(this),output$2(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:c}=this;let{pos:l}=this;n[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>o-l&&(this.process(r,0),l=0);for(let g=l;g<o;g++)n[g]=0;setBigUint64$3(r,o-8,BigInt(this.length*8),c),this.process(r,0);const x=createView$3(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=f/4,E=this.get();if(m>E.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<m;g++)x.setUint32(4*g,E[g],c)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:c,destroyed:l,pos:x}=this;return t.length=o,t.pos=x,t.finished=c,t.destroyed=l,o%n&&t.buffer.set(r),t}};const Chi$2=(e,t,n)=>e&t^~e&n,Maj$2=(e,t,n)=>e&t^e&n^t&n,SHA256_K$2=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$2=new Uint32Array(64);let SHA256$2=class extends SHA2$1{constructor(){super(64,32,8,!1),this.A=IV$1[0]|0,this.B=IV$1[1]|0,this.C=IV$1[2]|0,this.D=IV$1[3]|0,this.E=IV$1[4]|0,this.F=IV$1[5]|0,this.G=IV$1[6]|0,this.H=IV$1[7]|0}get(){const{A:t,B:n,C:r,D:o,E:c,F:l,G:x,H:f}=this;return[t,n,r,o,c,l,x,f]}set(t,n,r,o,c,l,x,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=c|0,this.F=l|0,this.G=x|0,this.H=f|0}process(t,n){for(let g=0;g<16;g++,n+=4)SHA256_W$2[g]=t.getUint32(n,!1);for(let g=16;g<64;g++){const y=SHA256_W$2[g-15],w=SHA256_W$2[g-2],v=rotr$2(y,7)^rotr$2(y,18)^y>>>3,_=rotr$2(w,17)^rotr$2(w,19)^w>>>10;SHA256_W$2[g]=_+SHA256_W$2[g-7]+v+SHA256_W$2[g-16]|0}let{A:r,B:o,C:c,D:l,E:x,F:f,G:m,H:E}=this;for(let g=0;g<64;g++){const y=rotr$2(x,6)^rotr$2(x,11)^rotr$2(x,25),w=E+y+Chi$2(x,f,m)+SHA256_K$2[g]+SHA256_W$2[g]|0,_=(rotr$2(r,2)^rotr$2(r,13)^rotr$2(r,22))+Maj$2(r,o,c)|0;E=m,m=f,f=x,x=l+w|0,l=c,c=o,o=r,r=w+_|0}r=r+this.A|0,o=o+this.B|0,c=c+this.C|0,l=l+this.D|0,x=x+this.E|0,f=f+this.F|0,m=m+this.G|0,E=E+this.H|0,this.set(r,o,c,l,x,f,m,E)}roundClean(){SHA256_W$2.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$3=wrapConstructor$1(()=>new SHA256$2);const _0n$9=BigInt(0),_1n$9=BigInt(1),_2n$5=BigInt(2),u8a$1=e=>e instanceof Uint8Array,hexes$3=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$3(e){if(!u8a$1(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hexes$3[e[n]];return t}function numberToHexUnpadded$1(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function hexToNumber$1(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function hexToBytes$5(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const o=r*2,c=e.slice(o,o+2),l=Number.parseInt(c,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");n[r]=l}return n}function bytesToNumberBE$1(e){return hexToNumber$1(bytesToHex$3(e))}function bytesToNumberLE$1(e){if(!u8a$1(e))throw new Error("Uint8Array expected");return hexToNumber$1(bytesToHex$3(Uint8Array.from(e).reverse()))}function numberToBytesBE$1(e,t){return hexToBytes$5(e.toString(16).padStart(t*2,"0"))}function numberToBytesLE$1(e,t){return numberToBytesBE$1(e,t).reverse()}function numberToVarBytesBE(e){return hexToBytes$5(numberToHexUnpadded$1(e))}function ensureBytes$1(e,t,n){let r;if(typeof t=="string")try{r=hexToBytes$5(t)}catch(c){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${c}`)}else if(u8a$1(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function concatBytes$2(...e){const t=new Uint8Array(e.reduce((r,o)=>r+o.length,0));let n=0;return e.forEach(r=>{if(!u8a$1(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}function equalBytes$1(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function utf8ToBytes$3(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function bitLen$1(e){let t;for(t=0;e>_0n$9;e>>=_1n$9,t+=1);return t}function bitGet(e,t){return e>>BigInt(t)&_1n$9}const bitSet=(e,t,n)=>e|(n?_1n$9:_0n$9)<<BigInt(t),bitMask$1=e=>(_2n$5<<BigInt(e-1))-_1n$9,u8n=e=>new Uint8Array(e),u8fr=e=>Uint8Array.from(e);function createHmacDrbg$1(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=u8n(e),o=u8n(e),c=0;const l=()=>{r.fill(1),o.fill(0),c=0},x=(...g)=>n(o,r,...g),f=(g=u8n())=>{o=x(u8fr([0]),g),r=x(),g.length!==0&&(o=x(u8fr([1]),g),r=x())},m=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let g=0;const y=[];for(;g<t;){r=x();const w=r.slice();y.push(w),g+=r.length}return concatBytes$2(...y)};return(g,y)=>{l(),f(g);let w;for(;!(w=y(m()));)f();return l(),w}}const validatorFns={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function validateObject(e,t,n={}){const r=(o,c,l)=>{const x=validatorFns[c];if(typeof x!="function")throw new Error(`Invalid validator "${c}", expected function`);const f=e[o];if(!(l&&f===void 0)&&!x(f,e))throw new Error(`Invalid param ${String(o)}=${f} (${typeof f}), expected ${c}`)};for(const[o,c]of Object.entries(t))r(o,c,!1);for(const[o,c]of Object.entries(n))r(o,c,!0);return e}const ut=Object.freeze(Object.defineProperty({__proto__:null,bitGet,bitLen:bitLen$1,bitMask:bitMask$1,bitSet,bytesToHex:bytesToHex$3,bytesToNumberBE:bytesToNumberBE$1,bytesToNumberLE:bytesToNumberLE$1,concatBytes:concatBytes$2,createHmacDrbg:createHmacDrbg$1,ensureBytes:ensureBytes$1,equalBytes:equalBytes$1,hexToBytes:hexToBytes$5,hexToNumber:hexToNumber$1,numberToBytesBE:numberToBytesBE$1,numberToBytesLE:numberToBytesLE$1,numberToHexUnpadded:numberToHexUnpadded$1,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$3,validateObject},Symbol.toStringTag,{value:"Module"}));const _0n$8=BigInt(0),_1n$8=BigInt(1),_2n$4=BigInt(2),_3n$3=BigInt(3),_4n$2=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);BigInt(9);BigInt(16);function mod$1(e,t){const n=e%t;return n>=_0n$8?n:t+n}function pow(e,t,n){if(n<=_0n$8||t<_0n$8)throw new Error("Expected power/modulo > 0");if(n===_1n$8)return _0n$8;let r=_1n$8;for(;t>_0n$8;)t&_1n$8&&(r=r*e%n),e=e*e%n,t>>=_1n$8;return r}function pow2$1(e,t,n){let r=e;for(;t-- >_0n$8;)r*=r,r%=n;return r}function invert$1(e,t){if(e===_0n$8||t<=_0n$8)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=mod$1(e,t),r=t,o=_0n$8,c=_1n$8;for(;n!==_0n$8;){const x=r/n,f=r%n,m=o-c*x;r=n,n=f,o=c,c=m}if(r!==_1n$8)throw new Error("invert: does not exist");return mod$1(o,t)}function tonelliShanks$1(e){const t=(e-_1n$8)/_2n$4;let n,r,o;for(n=e-_1n$8,r=0;n%_2n$4===_0n$8;n/=_2n$4,r++);for(o=_2n$4;o<e&&pow(o,t,e)!==e-_1n$8;o++);if(r===1){const l=(e+_1n$8)/_4n$2;return function(f,m){const E=f.pow(m,l);if(!f.eql(f.sqr(E),m))throw new Error("Cannot find square root");return E}}const c=(n+_1n$8)/_2n$4;return function(x,f){if(x.pow(f,t)===x.neg(x.ONE))throw new Error("Cannot find square root");let m=r,E=x.pow(x.mul(x.ONE,o),n),g=x.pow(f,c),y=x.pow(f,n);for(;!x.eql(y,x.ONE);){if(x.eql(y,x.ZERO))return x.ZERO;let w=1;for(let _=x.sqr(y);w<m&&!x.eql(_,x.ONE);w++)_=x.sqr(_);const v=x.pow(E,_1n$8<<BigInt(m-w-1));E=x.sqr(v),g=x.mul(g,v),y=x.mul(y,E),m=w}return g}}function FpSqrt$1(e){if(e%_4n$2===_3n$3){const t=(e+_1n$8)/_4n$2;return function(r,o){const c=r.pow(o,t);if(!r.eql(r.sqr(c),o))throw new Error("Cannot find square root");return c}}if(e%_8n$1===_5n$1){const t=(e-_5n$1)/_8n$1;return function(r,o){const c=r.mul(o,_2n$4),l=r.pow(c,t),x=r.mul(o,l),f=r.mul(r.mul(x,_2n$4),l),m=r.mul(x,r.sub(f,r.ONE));if(!r.eql(r.sqr(m),o))throw new Error("Cannot find square root");return m}}return tonelliShanks$1(e)}const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=FIELD_FIELDS$1.reduce((r,o)=>(r[o]="function",r),t);return validateObject(e,n)}function FpPow$1(e,t,n){if(n<_0n$8)throw new Error("Expected power > 0");if(n===_0n$8)return e.ONE;if(n===_1n$8)return t;let r=e.ONE,o=t;for(;n>_0n$8;)n&_1n$8&&(r=e.mul(r,o)),o=e.sqr(o),n>>=_1n$8;return r}function FpInvertBatch$1(e,t){const n=new Array(t.length),r=t.reduce((c,l,x)=>e.is0(l)?c:(n[x]=c,e.mul(c,l)),e.ONE),o=e.inv(r);return t.reduceRight((c,l,x)=>e.is0(l)?c:(n[x]=e.mul(c,n[x]),e.mul(c,l)),o),n}function nLength$1(e,t){const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Field$1(e,t,n=!1,r={}){if(e<=_0n$8)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:c}=nLength$1(e,t);if(c>2048)throw new Error("Field lengths over 2048 bytes are not supported");const l=FpSqrt$1(e),x=Object.freeze({ORDER:e,BITS:o,BYTES:c,MASK:bitMask$1(o),ZERO:_0n$8,ONE:_1n$8,create:f=>mod$1(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return _0n$8<=f&&f<e},is0:f=>f===_0n$8,isOdd:f=>(f&_1n$8)===_1n$8,neg:f=>mod$1(-f,e),eql:(f,m)=>f===m,sqr:f=>mod$1(f*f,e),add:(f,m)=>mod$1(f+m,e),sub:(f,m)=>mod$1(f-m,e),mul:(f,m)=>mod$1(f*m,e),pow:(f,m)=>FpPow$1(x,f,m),div:(f,m)=>mod$1(f*invert$1(m,e),e),sqrN:f=>f*f,addN:(f,m)=>f+m,subN:(f,m)=>f-m,mulN:(f,m)=>f*m,inv:f=>invert$1(f,e),sqrt:r.sqrt||(f=>l(x,f)),invertBatch:f=>FpInvertBatch$1(x,f),cmov:(f,m,E)=>E?m:f,toBytes:f=>n?numberToBytesLE$1(f,c):numberToBytesBE$1(f,c),fromBytes:f=>{if(f.length!==c)throw new Error(`Fp.fromBytes: expected ${c}, got ${f.length}`);return n?bytesToNumberLE$1(f):bytesToNumberBE$1(f)}});return Object.freeze(x)}function getFieldBytesLength$1(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength$1(e){const t=getFieldBytesLength$1(e);return t+Math.ceil(t/2)}function mapHashToField$1(e,t,n=!1){const r=e.length,o=getFieldBytesLength$1(t),c=getMinHashLength$1(t);if(r<16||r<c||r>1024)throw new Error(`expected ${c}-1024 bytes of input, got ${r}`);const l=n?bytesToNumberBE$1(e):bytesToNumberLE$1(e),x=mod$1(l,t-_1n$8)+_1n$8;return n?numberToBytesLE$1(x,o):numberToBytesBE$1(x,o)}const _0n$7=BigInt(0),_1n$7=BigInt(1);function wNAF$1(e,t){const n=(o,c)=>{const l=c.negate();return o?l:c},r=o=>{const c=Math.ceil(t/o)+1,l=2**(o-1);return{windows:c,windowSize:l}};return{constTimeNegate:n,unsafeLadder(o,c){let l=e.ZERO,x=o;for(;c>_0n$7;)c&_1n$7&&(l=l.add(x)),x=x.double(),c>>=_1n$7;return l},precomputeWindow(o,c){const{windows:l,windowSize:x}=r(c),f=[];let m=o,E=m;for(let g=0;g<l;g++){E=m,f.push(E);for(let y=1;y<x;y++)E=E.add(m),f.push(E);m=E.double()}return f},wNAF(o,c,l){const{windows:x,windowSize:f}=r(o);let m=e.ZERO,E=e.BASE;const g=BigInt(2**o-1),y=2**o,w=BigInt(o);for(let v=0;v<x;v++){const _=v*f;let F=Number(l&g);l>>=w,F>f&&(F-=y,l+=_1n$7);const H=_,Y=_+Math.abs(F)-1,T=v%2!==0,L=F<0;F===0?E=E.add(n(T,c[H])):m=m.add(n(L,c[Y]))}return{p:m,f:E}},wNAFCached(o,c,l,x){const f=o._WINDOW_SIZE||1;let m=c.get(o);return m||(m=this.precomputeWindow(o,f),f!==1&&c.set(o,x(m))),this.wNAF(f,m,l)}}}function validateBasic(e){return validateField$1(e.Fp),validateObject(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$1(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function validatePointOpts(e){const t=validateBasic(e);validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut,DER$1={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){const{Err:t}=DER$1;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:b2n(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=DER$1,n=typeof e=="string"?h2b(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:o,l:c}=DER$1._parseInt(n.subarray(2)),{d:l,l:x}=DER$1._parseInt(c);if(x.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:l}},hexFromSig(e){const t=m=>Number.parseInt(m[0],16)&8?"00"+m:m,n=m=>{const E=m.toString(16);return E.length&1?`0${E}`:E},r=t(n(e.s)),o=t(n(e.r)),c=r.length/2,l=o.length/2,x=n(c),f=n(l);return`30${n(l+c+4)}02${f}${o}02${x}${r}`}},_0n$6=BigInt(0),_1n$6=BigInt(1);BigInt(2);const _3n$2=BigInt(3);BigInt(4);function weierstrassPoints(e){const t=validatePointOpts(e),{Fp:n}=t,r=t.toBytes||((v,_,F)=>{const H=_.toAffine();return concatBytes$2(Uint8Array.from([4]),n.toBytes(H.x),n.toBytes(H.y))}),o=t.fromBytes||(v=>{const _=v.subarray(1),F=n.fromBytes(_.subarray(0,n.BYTES)),H=n.fromBytes(_.subarray(n.BYTES,2*n.BYTES));return{x:F,y:H}});function c(v){const{a:_,b:F}=t,H=n.sqr(v),Y=n.mul(H,v);return n.add(n.add(Y,n.mul(v,_)),F)}if(!n.eql(n.sqr(t.Gy),c(t.Gx)))throw new Error("bad generator point: equation left != right");function l(v){return typeof v=="bigint"&&_0n$6<v&&v<t.n}function x(v){if(!l(v))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(v){const{allowedPrivateKeyLengths:_,nByteLength:F,wrapPrivateKey:H,n:Y}=t;if(_&&typeof v!="bigint"){if(v instanceof Uint8Array&&(v=bytesToHex$3(v)),typeof v!="string"||!_.includes(v.length))throw new Error("Invalid key");v=v.padStart(F*2,"0")}let T;try{T=typeof v=="bigint"?v:bytesToNumberBE$1(ensureBytes$1("private key",v,F))}catch{throw new Error(`private key must be ${F} bytes, hex or bigint, not ${typeof v}`)}return H&&(T=mod$1(T,Y)),x(T),T}const m=new Map;function E(v){if(!(v instanceof g))throw new Error("ProjectivePoint expected")}class g{constructor(_,F,H){if(this.px=_,this.py=F,this.pz=H,_==null||!n.isValid(_))throw new Error("x required");if(F==null||!n.isValid(F))throw new Error("y required");if(H==null||!n.isValid(H))throw new Error("z required")}static fromAffine(_){const{x:F,y:H}=_||{};if(!_||!n.isValid(F)||!n.isValid(H))throw new Error("invalid affine point");if(_ instanceof g)throw new Error("projective point not allowed");const Y=T=>n.eql(T,n.ZERO);return Y(F)&&Y(H)?g.ZERO:new g(F,H,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){const F=n.invertBatch(_.map(H=>H.pz));return _.map((H,Y)=>H.toAffine(F[Y])).map(g.fromAffine)}static fromHex(_){const F=g.fromAffine(o(ensureBytes$1("pointHex",_)));return F.assertValidity(),F}static fromPrivateKey(_){return g.BASE.multiply(f(_))}_setWindowSize(_){this._WINDOW_SIZE=_,m.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:_,y:F}=this.toAffine();if(!n.isValid(_)||!n.isValid(F))throw new Error("bad point: x or y not FE");const H=n.sqr(F),Y=c(_);if(!n.eql(H,Y))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:_}=this.toAffine();if(n.isOdd)return!n.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){E(_);const{px:F,py:H,pz:Y}=this,{px:T,py:L,pz:N}=_,I=n.eql(n.mul(F,N),n.mul(T,Y)),U=n.eql(n.mul(H,N),n.mul(L,Y));return I&&U}negate(){return new g(this.px,n.neg(this.py),this.pz)}double(){const{a:_,b:F}=t,H=n.mul(F,_3n$2),{px:Y,py:T,pz:L}=this;let N=n.ZERO,I=n.ZERO,U=n.ZERO,W=n.mul(Y,Y),O=n.mul(T,T),Z=n.mul(L,L),z=n.mul(Y,T);return z=n.add(z,z),U=n.mul(Y,L),U=n.add(U,U),N=n.mul(_,U),I=n.mul(H,Z),I=n.add(N,I),N=n.sub(O,I),I=n.add(O,I),I=n.mul(N,I),N=n.mul(z,N),U=n.mul(H,U),Z=n.mul(_,Z),z=n.sub(W,Z),z=n.mul(_,z),z=n.add(z,U),U=n.add(W,W),W=n.add(U,W),W=n.add(W,Z),W=n.mul(W,z),I=n.add(I,W),Z=n.mul(T,L),Z=n.add(Z,Z),W=n.mul(Z,z),N=n.sub(N,W),U=n.mul(Z,O),U=n.add(U,U),U=n.add(U,U),new g(N,I,U)}add(_){E(_);const{px:F,py:H,pz:Y}=this,{px:T,py:L,pz:N}=_;let I=n.ZERO,U=n.ZERO,W=n.ZERO;const O=t.a,Z=n.mul(t.b,_3n$2);let z=n.mul(F,T),q=n.mul(H,L),$=n.mul(Y,N),M=n.add(F,H),S=n.add(T,L);M=n.mul(M,S),S=n.add(z,q),M=n.sub(M,S),S=n.add(F,Y);let R=n.add(T,N);return S=n.mul(S,R),R=n.add(z,$),S=n.sub(S,R),R=n.add(H,Y),I=n.add(L,N),R=n.mul(R,I),I=n.add(q,$),R=n.sub(R,I),W=n.mul(O,S),I=n.mul(Z,$),W=n.add(I,W),I=n.sub(q,W),W=n.add(q,W),U=n.mul(I,W),q=n.add(z,z),q=n.add(q,z),$=n.mul(O,$),S=n.mul(Z,S),q=n.add(q,$),$=n.sub(z,$),$=n.mul(O,$),S=n.add(S,$),z=n.mul(q,S),U=n.add(U,z),z=n.mul(R,S),I=n.mul(M,I),I=n.sub(I,z),z=n.mul(M,q),W=n.mul(R,W),W=n.add(W,z),new g(I,U,W)}subtract(_){return this.add(_.negate())}is0(){return this.equals(g.ZERO)}wNAF(_){return w.wNAFCached(this,m,_,F=>{const H=n.invertBatch(F.map(Y=>Y.pz));return F.map((Y,T)=>Y.toAffine(H[T])).map(g.fromAffine)})}multiplyUnsafe(_){const F=g.ZERO;if(_===_0n$6)return F;if(x(_),_===_1n$6)return this;const{endo:H}=t;if(!H)return w.unsafeLadder(this,_);let{k1neg:Y,k1:T,k2neg:L,k2:N}=H.splitScalar(_),I=F,U=F,W=this;for(;T>_0n$6||N>_0n$6;)T&_1n$6&&(I=I.add(W)),N&_1n$6&&(U=U.add(W)),W=W.double(),T>>=_1n$6,N>>=_1n$6;return Y&&(I=I.negate()),L&&(U=U.negate()),U=new g(n.mul(U.px,H.beta),U.py,U.pz),I.add(U)}multiply(_){x(_);let F=_,H,Y;const{endo:T}=t;if(T){const{k1neg:L,k1:N,k2neg:I,k2:U}=T.splitScalar(F);let{p:W,f:O}=this.wNAF(N),{p:Z,f:z}=this.wNAF(U);W=w.constTimeNegate(L,W),Z=w.constTimeNegate(I,Z),Z=new g(n.mul(Z.px,T.beta),Z.py,Z.pz),H=W.add(Z),Y=O.add(z)}else{const{p:L,f:N}=this.wNAF(F);H=L,Y=N}return g.normalizeZ([H,Y])[0]}multiplyAndAddUnsafe(_,F,H){const Y=g.BASE,T=(N,I)=>I===_0n$6||I===_1n$6||!N.equals(Y)?N.multiplyUnsafe(I):N.multiply(I),L=T(this,F).add(T(_,H));return L.is0()?void 0:L}toAffine(_){const{px:F,py:H,pz:Y}=this,T=this.is0();_==null&&(_=T?n.ONE:n.inv(Y));const L=n.mul(F,_),N=n.mul(H,_),I=n.mul(Y,_);if(T)return{x:n.ZERO,y:n.ZERO};if(!n.eql(I,n.ONE))throw new Error("invZ was invalid");return{x:L,y:N}}isTorsionFree(){const{h:_,isTorsionFree:F}=t;if(_===_1n$6)return!0;if(F)return F(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:_,clearCofactor:F}=t;return _===_1n$6?this:F?F(g,this):this.multiplyUnsafe(t.h)}toRawBytes(_=!0){return this.assertValidity(),r(g,this,_)}toHex(_=!0){return bytesToHex$3(this.toRawBytes(_))}}g.BASE=new g(t.Gx,t.Gy,n.ONE),g.ZERO=new g(n.ZERO,n.ONE,n.ZERO);const y=t.nBitLength,w=wNAF$1(g,t.endo?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:g,normPrivateKeyToScalar:f,weierstrassEquation:c,isWithinCurveOrder:l}}function validateOpts(e){const t=validateBasic(e);return validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass$2(e){const t=validateOpts(e),{Fp:n,n:r}=t,o=n.BYTES+1,c=2*n.BYTES+1;function l(S){return _0n$6<S&&S<n.ORDER}function x(S){return mod$1(S,r)}function f(S){return invert$1(S,r)}const{ProjectivePoint:m,normPrivateKeyToScalar:E,weierstrassEquation:g,isWithinCurveOrder:y}=weierstrassPoints({...t,toBytes(S,R,D){const j=R.toAffine(),P=n.toBytes(j.x),Q=concatBytes$2;return D?Q(Uint8Array.from([R.hasEvenY()?2:3]),P):Q(Uint8Array.from([4]),P,n.toBytes(j.y))},fromBytes(S){const R=S.length,D=S[0],j=S.subarray(1);if(R===o&&(D===2||D===3)){const P=bytesToNumberBE$1(j);if(!l(P))throw new Error("Point is not on curve");const Q=g(P);let C=n.sqrt(Q);const K=(C&_1n$6)===_1n$6;return(D&1)===1!==K&&(C=n.neg(C)),{x:P,y:C}}else if(R===c&&D===4){const P=n.fromBytes(j.subarray(0,n.BYTES)),Q=n.fromBytes(j.subarray(n.BYTES,2*n.BYTES));return{x:P,y:Q}}else throw new Error(`Point of length ${R} was invalid. Expected ${o} compressed bytes or ${c} uncompressed bytes`)}}),w=S=>bytesToHex$3(numberToBytesBE$1(S,t.nByteLength));function v(S){const R=r>>_1n$6;return S>R}function _(S){return v(S)?x(-S):S}const F=(S,R,D)=>bytesToNumberBE$1(S.slice(R,D));class H{constructor(R,D,j){this.r=R,this.s=D,this.recovery=j,this.assertValidity()}static fromCompact(R){const D=t.nByteLength;return R=ensureBytes$1("compactSignature",R,D*2),new H(F(R,0,D),F(R,D,2*D))}static fromDER(R){const{r:D,s:j}=DER$1.toSig(ensureBytes$1("DER",R));return new H(D,j)}assertValidity(){if(!y(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!y(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(R){return new H(this.r,this.s,R)}recoverPublicKey(R){const{r:D,s:j,recovery:P}=this,Q=U(ensureBytes$1("msgHash",R));if(P==null||![0,1,2,3].includes(P))throw new Error("recovery id invalid");const C=P===2||P===3?D+t.n:D;if(C>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const K=(P&1)===0?"02":"03",J=m.fromHex(K+w(C)),ne=f(C),re=x(-Q*ne),ie=x(j*ne),ce=m.BASE.multiplyAndAddUnsafe(J,re,ie);if(!ce)throw new Error("point at infinify");return ce.assertValidity(),ce}hasHighS(){return v(this.s)}normalizeS(){return this.hasHighS()?new H(this.r,x(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$5(this.toDERHex())}toDERHex(){return DER$1.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$5(this.toCompactHex())}toCompactHex(){return w(this.r)+w(this.s)}}const Y={isValidPrivateKey(S){try{return E(S),!0}catch{return!1}},normPrivateKeyToScalar:E,randomPrivateKey:()=>{const S=getMinHashLength$1(t.n);return mapHashToField$1(t.randomBytes(S),t.n)},precompute(S=8,R=m.BASE){return R._setWindowSize(S),R.multiply(BigInt(3)),R}};function T(S,R=!0){return m.fromPrivateKey(S).toRawBytes(R)}function L(S){const R=S instanceof Uint8Array,D=typeof S=="string",j=(R||D)&&S.length;return R?j===o||j===c:D?j===2*o||j===2*c:S instanceof m}function N(S,R,D=!0){if(L(S))throw new Error("first arg must be private key");if(!L(R))throw new Error("second arg must be public key");return m.fromHex(R).multiply(E(S)).toRawBytes(D)}const I=t.bits2int||function(S){const R=bytesToNumberBE$1(S),D=S.length*8-t.nBitLength;return D>0?R>>BigInt(D):R},U=t.bits2int_modN||function(S){return x(I(S))},W=bitMask$1(t.nBitLength);function O(S){if(typeof S!="bigint")throw new Error("bigint expected");if(!(_0n$6<=S&&S<W))throw new Error(`bigint expected < 2^${t.nBitLength}`);return numberToBytesBE$1(S,t.nByteLength)}function Z(S,R,D=z){if(["recovered","canonical"].some(ae=>ae in D))throw new Error("sign() legacy options not supported");const{hash:j,randomBytes:P}=t;let{lowS:Q,prehash:C,extraEntropy:K}=D;Q==null&&(Q=!0),S=ensureBytes$1("msgHash",S),C&&(S=ensureBytes$1("prehashed msgHash",j(S)));const J=U(S),ne=E(R),re=[O(ne),O(J)];if(K!=null){const ae=K===!0?P(n.BYTES):K;re.push(ensureBytes$1("extraEntropy",ae))}const ie=concatBytes$2(...re),ce=J;function ue(ae){const we=I(ae);if(!y(we))return;const ke=f(we),Re=m.BASE.multiply(we).toAffine(),be=x(Re.x);if(be===_0n$6)return;const Fe=x(ke*x(ce+be*ne));if(Fe===_0n$6)return;let je=(Re.x===be?0:2)|Number(Re.y&_1n$6),Te=Fe;return Q&&v(Fe)&&(Te=_(Fe),je^=1),new H(be,Te,je)}return{seed:ie,k2sig:ue}}const z={lowS:t.lowS,prehash:!1},q={lowS:t.lowS,prehash:!1};function $(S,R,D=z){const{seed:j,k2sig:P}=Z(S,R,D),Q=t;return createHmacDrbg$1(Q.hash.outputLen,Q.nByteLength,Q.hmac)(j,P)}m.BASE._setWindowSize(8);function M(S,R,D,j=q){const P=S;if(R=ensureBytes$1("msgHash",R),D=ensureBytes$1("publicKey",D),"strict"in j)throw new Error("options.strict was renamed to lowS");const{lowS:Q,prehash:C}=j;let K,J;try{if(typeof P=="string"||P instanceof Uint8Array)try{K=H.fromDER(P)}catch(Re){if(!(Re instanceof DER$1.Err))throw Re;K=H.fromCompact(P)}else if(typeof P=="object"&&typeof P.r=="bigint"&&typeof P.s=="bigint"){const{r:Re,s:be}=P;K=new H(Re,be)}else throw new Error("PARSE");J=m.fromHex(D)}catch(Re){if(Re.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Q&&K.hasHighS())return!1;C&&(R=t.hash(R));const{r:ne,s:re}=K,ie=U(R),ce=f(re),ue=x(ie*ce),ae=x(ne*ce),we=m.BASE.multiplyAndAddUnsafe(J,ue,ae)?.toAffine();return we?x(we.x)===ne:!1}return{CURVE:t,getPublicKey:T,getSharedSecret:N,sign:$,verify:M,ProjectivePoint:m,Signature:H,utils:Y}}let HMAC$2=class extends Hash$2{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,hash$1(t);const r=toBytes$3(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,c=new Uint8Array(o);c.set(r.length>o?t.create().update(r).digest():r);for(let l=0;l<c.length;l++)c[l]^=54;this.iHash.update(c),this.oHash=t.create();for(let l=0;l<c.length;l++)c[l]^=106;this.oHash.update(c),c.fill(0)}update(t){return exists$2(this),this.iHash.update(t),this}digestInto(t){exists$2(this),bytes$2(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:c,blockLen:l,outputLen:x}=this;return t=t,t.finished=o,t.destroyed=c,t.blockLen=l,t.outputLen=x,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$3=(e,t,n)=>new HMAC$2(e,t).update(n).digest();hmac$3.create=(e,t)=>new HMAC$2(e,t);function getHash(e){return{hash:e,hmac:(t,...n)=>hmac$3(e,t,concatBytes$3(...n)),randomBytes:randomBytes$2}}function createCurve$1(e,t){const n=r=>weierstrass$2({...e,...getHash(r)});return Object.freeze({...n(t),create:n})}const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$5=BigInt(1),_2n$3=BigInt(2),divNearest$1=(e,t)=>(e+t/_2n$3)/t;function sqrtMod$1(e){const t=secp256k1P,n=BigInt(3),r=BigInt(6),o=BigInt(11),c=BigInt(22),l=BigInt(23),x=BigInt(44),f=BigInt(88),m=e*e*e%t,E=m*m*e%t,g=pow2$1(E,n,t)*E%t,y=pow2$1(g,n,t)*E%t,w=pow2$1(y,_2n$3,t)*m%t,v=pow2$1(w,o,t)*w%t,_=pow2$1(v,c,t)*v%t,F=pow2$1(_,x,t)*_%t,H=pow2$1(F,f,t)*F%t,Y=pow2$1(H,x,t)*_%t,T=pow2$1(Y,n,t)*E%t,L=pow2$1(T,l,t)*v%t,N=pow2$1(L,r,t)*m%t,I=pow2$1(N,_2n$3,t);if(!Fp.eql(Fp.sqr(I),e))throw new Error("Cannot find square root");return I}const Fp=Field$1(secp256k1P,void 0,void 0,{sqrt:sqrtMod$1}),secp256k1$2=createCurve$1({a:BigInt(0),b:BigInt(7),Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=secp256k1N,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-_1n$5*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),c=n,l=BigInt("0x100000000000000000000000000000000"),x=divNearest$1(c*e,t),f=divNearest$1(-r*e,t);let m=mod$1(e-x*n-f*o,t),E=mod$1(-x*r-f*c,t);const g=m>l,y=E>l;if(g&&(m=t-m),y&&(E=t-E),m>l||E>l)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:g,k1:m,k2neg:y,k2:E}}}},sha256$3),_0n$5=BigInt(0),fe=e=>typeof e=="bigint"&&_0n$5<e&&e<secp256k1P,ge=e=>typeof e=="bigint"&&_0n$5<e&&e<secp256k1N,TAGGED_HASH_PREFIXES$2={};function taggedHash$2(e,...t){let n=TAGGED_HASH_PREFIXES$2[e];if(n===void 0){const r=sha256$3(Uint8Array.from(e,o=>o.charCodeAt(0)));n=concatBytes$2(r,r),TAGGED_HASH_PREFIXES$2[e]=n}return sha256$3(concatBytes$2(n,...t))}const pointToBytes$1=e=>e.toRawBytes(!0).slice(1),numTo32b=e=>numberToBytesBE$1(e,32),modP=e=>mod$1(e,secp256k1P),modN=e=>mod$1(e,secp256k1N),Point=secp256k1$2.ProjectivePoint,GmulAdd=(e,t,n)=>Point.BASE.multiplyAndAddUnsafe(e,t,n);function schnorrGetExtPubKey$1(e){let t=secp256k1$2.utils.normPrivateKeyToScalar(e),n=Point.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:modN(-t),bytes:pointToBytes$1(n)}}function lift_x$1(e){if(!fe(e))throw new Error("bad x: need 0 < x < p");const t=modP(e*e),n=modP(t*e+BigInt(7));let r=sqrtMod$1(n);r%_2n$3!==_0n$5&&(r=modP(-r));const o=new Point(e,r,_1n$5);return o.assertValidity(),o}function challenge$1(...e){return modN(bytesToNumberBE$1(taggedHash$2("BIP0340/challenge",...e)))}function schnorrGetPublicKey$1(e){return schnorrGetExtPubKey$1(e).bytes}function schnorrSign$1(e,t,n=randomBytes$2(32)){const r=ensureBytes$1("message",e),{bytes:o,scalar:c}=schnorrGetExtPubKey$1(t),l=ensureBytes$1("auxRand",n,32),x=numTo32b(c^bytesToNumberBE$1(taggedHash$2("BIP0340/aux",l))),f=taggedHash$2("BIP0340/nonce",x,o,r),m=modN(bytesToNumberBE$1(f));if(m===_0n$5)throw new Error("sign failed: k is zero");const{bytes:E,scalar:g}=schnorrGetExtPubKey$1(m),y=challenge$1(E,o,r),w=new Uint8Array(64);if(w.set(E,0),w.set(numTo32b(modN(g+y*c)),32),!schnorrVerify$1(w,r,o))throw new Error("sign: Invalid signature produced");return w}function schnorrVerify$1(e,t,n){const r=ensureBytes$1("signature",e,64),o=ensureBytes$1("message",t),c=ensureBytes$1("publicKey",n,32);try{const l=lift_x$1(bytesToNumberBE$1(c)),x=bytesToNumberBE$1(r.subarray(0,32));if(!fe(x))return!1;const f=bytesToNumberBE$1(r.subarray(32,64));if(!ge(f))return!1;const m=challenge$1(numTo32b(x),pointToBytes$1(l),o),E=GmulAdd(l,f,modN(-m));return!(!E||!E.hasEvenY()||E.toAffine().x!==x)}catch{return!1}}const schnorr$1={getPublicKey:schnorrGetPublicKey$1,sign:schnorrSign$1,verify:schnorrVerify$1,utils:{randomPrivateKey:secp256k1$2.utils.randomPrivateKey,lift_x:lift_x$1,pointToBytes:pointToBytes$1,numberToBytesBE:numberToBytesBE$1,bytesToNumberBE:bytesToNumberBE$1,taggedHash:taggedHash$2,mod:mod$1}},crypto$4=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const u8a=e=>e instanceof Uint8Array,u32$1=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),createView$2=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$1=(e,t)=>e<<32-t|e>>>t,isLE$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$1)throw new Error("Non little-endian hardware is not supported");const hexes$2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$2(e){if(!u8a(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hexes$2[e[n]];return t}function hexToBytes$4(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){const o=r*2,c=e.slice(o,o+2),l=Number.parseInt(c,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");n[r]=l}return n}function utf8ToBytes$2(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$2(e){if(typeof e=="string"&&(e=utf8ToBytes$2(e)),!u8a(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function concatBytes$1(...e){const t=new Uint8Array(e.reduce((r,o)=>r+o.length,0));let n=0;return e.forEach(r=>{if(!u8a(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}let Hash$1=class{clone(){return this._cloneInto()}};const isPlainObject=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function checkOpts$1(e,t){if(t!==void 0&&(typeof t!="object"||!isPlainObject(t)))throw new Error("Options should be object or undefined");return Object.assign(e,t)}function wrapConstructor(e){const t=r=>e().update(toBytes$2(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes$1(e=32){if(crypto$4&&typeof crypto$4.getRandomValues=="function")return crypto$4.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function number$3(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bool$1(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function bytes$1(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$3(e.outputLen),number$3(e.blockLen)}function exists$1(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$1(e,t){bytes$1(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const assert$2={number:number$3,bool:bool$1,bytes:bytes$1,hash,exists:exists$1,output:output$1};function setBigUint64$2(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),c=BigInt(4294967295),l=Number(n>>o&c),x=Number(n&c),f=r?4:0,m=r?0:4;e.setUint32(t+f,l,r),e.setUint32(t+m,x,r)}class SHA2 extends Hash$1{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=createView$2(this.buffer)}update(t){assert$2.exists(this);const{view:n,buffer:r,blockLen:o}=this;t=toBytes$2(t);const c=t.length;for(let l=0;l<c;){const x=Math.min(o-this.pos,c-l);if(x===o){const f=createView$2(t);for(;o<=c-l;l+=o)this.process(f,l);continue}r.set(t.subarray(l,l+x),this.pos),this.pos+=x,l+=x,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){assert$2.exists(this),assert$2.output(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:c}=this;let{pos:l}=this;n[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>o-l&&(this.process(r,0),l=0);for(let g=l;g<o;g++)n[g]=0;setBigUint64$2(r,o-8,BigInt(this.length*8),c),this.process(r,0);const x=createView$2(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=f/4,E=this.get();if(m>E.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<m;g++)x.setUint32(4*g,E[g],c)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:c,destroyed:l,pos:x}=this;return t.length=o,t.pos=x,t.finished=c,t.destroyed=l,o%n&&t.buffer.set(r),t}}const Chi$1=(e,t,n)=>e&t^~e&n,Maj$1=(e,t,n)=>e&t^e&n^t&n,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends SHA2{constructor(){super(64,32,8,!1),this.A=IV[0]|0,this.B=IV[1]|0,this.C=IV[2]|0,this.D=IV[3]|0,this.E=IV[4]|0,this.F=IV[5]|0,this.G=IV[6]|0,this.H=IV[7]|0}get(){const{A:t,B:n,C:r,D:o,E:c,F:l,G:x,H:f}=this;return[t,n,r,o,c,l,x,f]}set(t,n,r,o,c,l,x,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=c|0,this.F=l|0,this.G=x|0,this.H=f|0}process(t,n){for(let g=0;g<16;g++,n+=4)SHA256_W$1[g]=t.getUint32(n,!1);for(let g=16;g<64;g++){const y=SHA256_W$1[g-15],w=SHA256_W$1[g-2],v=rotr$1(y,7)^rotr$1(y,18)^y>>>3,_=rotr$1(w,17)^rotr$1(w,19)^w>>>10;SHA256_W$1[g]=_+SHA256_W$1[g-7]+v+SHA256_W$1[g-16]|0}let{A:r,B:o,C:c,D:l,E:x,F:f,G:m,H:E}=this;for(let g=0;g<64;g++){const y=rotr$1(x,6)^rotr$1(x,11)^rotr$1(x,25),w=E+y+Chi$1(x,f,m)+SHA256_K$1[g]+SHA256_W$1[g]|0,_=(rotr$1(r,2)^rotr$1(r,13)^rotr$1(r,22))+Maj$1(r,o,c)|0;E=m,m=f,f=x,x=l+w|0,l=c,c=o,o=r,r=w+_|0}r=r+this.A|0,o=o+this.B|0,c=c+this.C|0,l=l+this.D|0,x=x+this.E|0,f=f+this.F|0,m=m+this.G|0,E=E+this.H|0,this.set(r,o,c,l,x,f,m,E)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class SHA224 extends SHA256$1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const sha256$2=wrapConstructor(()=>new SHA256$1);wrapConstructor(()=>new SHA224);function assertNumber(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function chain(...e){const t=(o,c)=>l=>o(c(l)),n=Array.from(e).reverse().reduce((o,c)=>o?t(o,c.encode):c.encode,void 0),r=e.reduce((o,c)=>o?t(o,c.decode):c.decode,void 0);return{encode:n,decode:r}}function alphabet(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(assertNumber(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function join(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function padding(e,t="="){if(assertNumber(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function normalize$1(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function convertRadix(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const o=[],c=Array.from(e);for(c.forEach(l=>{if(assertNumber(l),l<0||l>=t)throw new Error(`Wrong integer: ${l}`)});;){let l=0,x=!0;for(let f=r;f<c.length;f++){const m=c[f],E=t*l+m;if(!Number.isSafeInteger(E)||t*l/t!==l||E-m!==t*l)throw new Error("convertRadix: carry overflow");if(l=E%n,c[f]=Math.floor(E/n),!Number.isSafeInteger(c[f])||c[f]*n+l!==E)throw new Error("convertRadix: carry overflow");if(x)c[f]?x=!1:r=f;else continue}if(o.push(l),x)break}for(let l=0;l<e.length-1&&e[l]===0;l++)o.push(0);return o.reverse()}const gcd=(e,t)=>t?gcd(t,e%t):e,radix2carry=(e,t)=>e+(t-gcd(e,t));function convertRadix2(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(radix2carry(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${radix2carry(t,n)}`);let o=0,c=0;const l=2**n-1,x=[];for(const f of e){if(assertNumber(f),f>=2**t)throw new Error(`convertRadix2: invalid data word=${f} from=${t}`);if(o=o<<t|f,c+t>32)throw new Error(`convertRadix2: carry overflow pos=${c} from=${t}`);for(c+=t;c>=n;c-=n)x.push((o>>c-n&l)>>>0);o&=2**c-1}if(o=o<<n-c&l,!r&&c>=t)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&c>0&&x.push(o>>>0),x}function radix(e){return assertNumber(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(convertRadix(t,e,2**8))}}}function radix2(e,t=!1){if(assertNumber(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,e)>32||radix2carry(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(convertRadix2(n,e,8,t))}}}function unsafeWrapper(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}const base16=chain(radix2(4),alphabet("0123456789ABCDEF"),join("")),base32=chain(radix2(5),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHIJKLMNOPQRSTUV"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),join(""),normalize$1(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const base64=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),padding(6),join("")),base64url=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),padding(6),join("")),genBase58=e=>chain(radix(58),alphabet(e),join("")),base58$1=genBase58("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");genBase58("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");genBase58("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const XMR_BLOCK_LEN=[0,2,3,5,6,7,9,10,11],base58xmr={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=base58$1.encode(r).padStart(XMR_BLOCK_LEN[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),o=XMR_BLOCK_LEN.indexOf(r.length),c=base58$1.decode(r);for(let l=0;l<c.length-o;l++)if(c[l]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(c.slice(c.length-o)))}return Uint8Array.from(t)}},BECH_ALPHABET=chain(alphabet("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join("")),POLYMOD_GENERATORS=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod(e){const t=e>>25;let n=(e&33554431)<<5;for(let r=0;r<POLYMOD_GENERATORS.length;r++)(t>>r&1)===1&&(n^=POLYMOD_GENERATORS[r]);return n}function bechChecksum(e,t,n=1){const r=e.length;let o=1;for(let c=0;c<r;c++){const l=e.charCodeAt(c);if(l<33||l>126)throw new Error(`Invalid prefix (${e})`);o=bech32Polymod(o)^l>>5}o=bech32Polymod(o);for(let c=0;c<r;c++)o=bech32Polymod(o)^e.charCodeAt(c)&31;for(let c of t)o=bech32Polymod(o)^c;for(let c=0;c<6;c++)o=bech32Polymod(o);return o^=n,BECH_ALPHABET.encode(convertRadix2([o%2**30],30,5,!1))}function genBech32(e){const t=e==="bech32"?1:734539939,n=radix2(5),r=n.decode,o=n.encode,c=unsafeWrapper(r);function l(E,g,y=90){if(typeof E!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof E}`);if(!Array.isArray(g)||g.length&&typeof g[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof g}`);const w=E.length+7+g.length;if(y!==!1&&w>y)throw new TypeError(`Length ${w} exceeds limit ${y}`);return E=E.toLowerCase(),`${E}1${BECH_ALPHABET.encode(g)}${bechChecksum(E,g,t)}`}function x(E,g=90){if(typeof E!="string")throw new Error(`bech32.decode input should be string, not ${typeof E}`);if(E.length<8||g!==!1&&E.length>g)throw new TypeError(`Wrong string length: ${E.length} (${E}). Expected (8..${g})`);const y=E.toLowerCase();if(E!==y&&E!==E.toUpperCase())throw new Error("String must be lowercase or uppercase");E=y;const w=E.lastIndexOf("1");if(w===0||w===-1)throw new Error('Letter "1" must be present between prefix and data only');const v=E.slice(0,w),_=E.slice(w+1);if(_.length<6)throw new Error("Data must be at least 6 characters long");const F=BECH_ALPHABET.decode(_).slice(0,-6),H=bechChecksum(v,F,t);if(!_.endsWith(H))throw new Error(`Invalid checksum in ${E}: expected "${H}"`);return{prefix:v,words:F}}const f=unsafeWrapper(x);function m(E){const{prefix:g,words:y}=x(E,!1);return{prefix:g,words:y,bytes:r(y)}}return{encode:l,decode:x,decodeToBytes:m,decodeUnsafe:f,fromWords:r,fromWordsUnsafe:c,toWords:o}}const bech32=genBech32("bech32");genBech32("bech32m");const utf8={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},hex=chain(radix2(4),alphabet("0123456789abcdef"),join(""),normalize$1(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),CODERS={utf8,hex,base16,base32,base64,base64url,base58:base58$1,base58xmr};`${Object.keys(CODERS).join(", ")}`;function number$2(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function bool(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function isBytes$1(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function bytes(e,...t){if(!isBytes$1(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function exists(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output(e,t){bytes(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),createView$1=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");const hexes$1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$1(e){bytes(e);let t="";for(let n=0;n<e.length;n++)t+=hexes$1[e[n]];return t}const asciis$1={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16$1(e){if(e>=asciis$1._0&&e<=asciis$1._9)return e-asciis$1._0;if(e>=asciis$1._A&&e<=asciis$1._F)return e-(asciis$1._A-10);if(e>=asciis$1._a&&e<=asciis$1._f)return e-(asciis$1._a-10)}function hexToBytes$3(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let o=0,c=0;o<n;o++,c+=2){const l=asciiToBase16$1(e.charCodeAt(c)),x=asciiToBase16$1(e.charCodeAt(c+1));if(l===void 0||x===void 0){const f=e[c]+e[c+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+c)}r[o]=l*16+x}return r}function utf8ToBytes$1(e){if(typeof e!="string")throw new Error(`string expected, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$1(e){if(typeof e=="string")e=utf8ToBytes$1(e);else if(isBytes$1(e))e=e.slice();else throw new Error(`Uint8Array expected, got ${typeof e}`);return e}function checkOpts(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function equalBytes(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}const wrapCipher=(e,t)=>(Object.assign(t,e),t);function setBigUint64$1(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),c=BigInt(4294967295),l=Number(n>>o&c),x=Number(n&c),f=4,m=0;e.setUint32(t+f,l,r),e.setUint32(t+m,x,r)}const BLOCK_SIZE=16,POLY=283;function mul2(e){return e<<1^POLY&-(e>>7)}function mul(e,t){let n=0;for(;t>0;t>>=1)n^=e&-(t&1),e=mul2(e);return n}const sbox=(()=>{let e=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=mul2(r))e[n]=r;const t=new Uint8Array(256);t[0]=99;for(let n=0;n<255;n++){let r=e[255-n];r|=r<<8,t[e[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return t})(),invSbox=sbox.map((e,t)=>sbox.indexOf(t)),rotr32_8=e=>e<<24|e>>>8,rotl32_8=e=>e<<8|e>>>24;function genTtable(e,t){if(e.length!==256)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((m,E)=>t(e[E])),r=n.map(rotl32_8),o=r.map(rotl32_8),c=o.map(rotl32_8),l=new Uint32Array(256*256),x=new Uint32Array(256*256),f=new Uint16Array(256*256);for(let m=0;m<256;m++)for(let E=0;E<256;E++){const g=m*256+E;l[g]=n[m]^r[E],x[g]=o[m]^c[E],f[g]=e[m]<<8|e[E]}return{sbox:e,sbox2:f,T0:n,T1:r,T2:o,T3:c,T01:l,T23:x}}const tableEncoding=genTtable(sbox,e=>mul(e,3)<<24|e<<16|e<<8|mul(e,2)),tableDecoding=genTtable(invSbox,e=>mul(e,11)<<24|mul(e,13)<<16|mul(e,9)<<8|mul(e,14)),xPowers=(()=>{const e=new Uint8Array(16);for(let t=0,n=1;t<16;t++,n=mul2(n))e[t]=n;return e})();function expandKeyLE(e){bytes(e);const t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);const{sbox2:n}=tableEncoding,r=u32(e),o=r.length,c=x=>applySbox(n,x,x,x,x),l=new Uint32Array(t+28);l.set(r);for(let x=o;x<l.length;x++){let f=l[x-1];x%o===0?f=c(rotr32_8(f))^xPowers[x/o-1]:o>6&&x%o===4&&(f=c(f)),l[x]=l[x-o]^f}return l}function expandKeyDecLE(e){const t=expandKeyLE(e),n=t.slice(),r=t.length,{sbox2:o}=tableEncoding,{T0:c,T1:l,T2:x,T3:f}=tableDecoding;for(let m=0;m<r;m+=4)for(let E=0;E<4;E++)n[m+E]=t[r-m-4+E];t.fill(0);for(let m=4;m<r-4;m++){const E=n[m],g=applySbox(o,E,E,E,E);n[m]=c[g&255]^l[g>>>8&255]^x[g>>>16&255]^f[g>>>24]}return n}function apply0123(e,t,n,r,o,c){return e[n<<8&65280|r>>>8&255]^t[o>>>8&65280|c>>>24&255]}function applySbox(e,t,n,r,o){return e[t&255|n&65280]|e[r>>>16&255|o>>>16&65280]<<16}function encrypt$3(e,t,n,r,o){const{sbox2:c,T01:l,T23:x}=tableEncoding;let f=0;t^=e[f++],n^=e[f++],r^=e[f++],o^=e[f++];const m=e.length/4-2;for(let v=0;v<m;v++){const _=e[f++]^apply0123(l,x,t,n,r,o),F=e[f++]^apply0123(l,x,n,r,o,t),H=e[f++]^apply0123(l,x,r,o,t,n),Y=e[f++]^apply0123(l,x,o,t,n,r);t=_,n=F,r=H,o=Y}const E=e[f++]^applySbox(c,t,n,r,o),g=e[f++]^applySbox(c,n,r,o,t),y=e[f++]^applySbox(c,r,o,t,n),w=e[f++]^applySbox(c,o,t,n,r);return{s0:E,s1:g,s2:y,s3:w}}function decrypt$3(e,t,n,r,o){const{sbox2:c,T01:l,T23:x}=tableDecoding;let f=0;t^=e[f++],n^=e[f++],r^=e[f++],o^=e[f++];const m=e.length/4-2;for(let v=0;v<m;v++){const _=e[f++]^apply0123(l,x,t,o,r,n),F=e[f++]^apply0123(l,x,n,t,o,r),H=e[f++]^apply0123(l,x,r,n,t,o),Y=e[f++]^apply0123(l,x,o,r,n,t);t=_,n=F,r=H,o=Y}const E=e[f++]^applySbox(c,t,o,r,n),g=e[f++]^applySbox(c,n,t,o,r),y=e[f++]^applySbox(c,r,n,t,o),w=e[f++]^applySbox(c,o,r,n,t);return{s0:E,s1:g,s2:y,s3:w}}function getDst(e,t){if(!t)return new Uint8Array(e);if(bytes(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function validateBlockDecrypt(e){if(bytes(e),e.length%BLOCK_SIZE!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${BLOCK_SIZE}`)}function validateBlockEncrypt(e,t,n){let r=e.length;const o=r%BLOCK_SIZE;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const c=u32(e);if(t){let f=BLOCK_SIZE-o;f||(f=BLOCK_SIZE),r=r+f}const l=getDst(r,n),x=u32(l);return{b:c,o:x,out:l}}function validatePCKS(e,t){if(!t)return e;const n=e.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=e[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);const o=e.subarray(0,-r);for(let c=0;c<r;c++)if(e[n-c-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}function padPCKS(e){const t=new Uint8Array(16),n=u32(t);t.set(e);const r=BLOCK_SIZE-e.length;for(let o=BLOCK_SIZE-r;o<BLOCK_SIZE;o++)t[o]=r;return n}const cbc=wrapCipher({blockSize:16,nonceLength:16},function(t,n,r={}){bytes(t),bytes(n,16);const o=!r.disablePadding;return{encrypt:(c,l)=>{const x=expandKeyLE(t),{b:f,o:m,out:E}=validateBlockEncrypt(c,o,l),g=u32(n);let y=g[0],w=g[1],v=g[2],_=g[3],F=0;for(;F+4<=f.length;)y^=f[F+0],w^=f[F+1],v^=f[F+2],_^=f[F+3],{s0:y,s1:w,s2:v,s3:_}=encrypt$3(x,y,w,v,_),m[F++]=y,m[F++]=w,m[F++]=v,m[F++]=_;if(o){const H=padPCKS(c.subarray(F*4));y^=H[0],w^=H[1],v^=H[2],_^=H[3],{s0:y,s1:w,s2:v,s3:_}=encrypt$3(x,y,w,v,_),m[F++]=y,m[F++]=w,m[F++]=v,m[F++]=_}return x.fill(0),E},decrypt:(c,l)=>{validateBlockDecrypt(c);const x=expandKeyDecLE(t),f=u32(n),m=getDst(c.length,l),E=u32(c),g=u32(m);let y=f[0],w=f[1],v=f[2],_=f[3];for(let F=0;F+4<=E.length;){const H=y,Y=w,T=v,L=_;y=E[F+0],w=E[F+1],v=E[F+2],_=E[F+3];const{s0:N,s1:I,s2:U,s3:W}=decrypt$3(x,y,w,v,_);g[F++]=N^H,g[F++]=I^Y,g[F++]=U^T,g[F++]=W^L}return x.fill(0),validatePCKS(m,o)}}}),u8to16=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class Poly1305{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=toBytes$1(t),bytes(t,32);const n=u8to16(t,0),r=u8to16(t,2),o=u8to16(t,4),c=u8to16(t,6),l=u8to16(t,8),x=u8to16(t,10),f=u8to16(t,12),m=u8to16(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|c<<9)&8191,this.r[4]=(c>>>4|l<<12)&255,this.r[5]=l>>>1&8190,this.r[6]=(l>>>14|x<<2)&8191,this.r[7]=(x>>>11|f<<5)&8065,this.r[8]=(f>>>8|m<<8)&8191,this.r[9]=m>>>5&127;for(let E=0;E<8;E++)this.pad[E]=u8to16(t,16+2*E)}process(t,n,r=!1){const o=r?0:2048,{h:c,r:l}=this,x=l[0],f=l[1],m=l[2],E=l[3],g=l[4],y=l[5],w=l[6],v=l[7],_=l[8],F=l[9],H=u8to16(t,n+0),Y=u8to16(t,n+2),T=u8to16(t,n+4),L=u8to16(t,n+6),N=u8to16(t,n+8),I=u8to16(t,n+10),U=u8to16(t,n+12),W=u8to16(t,n+14);let O=c[0]+(H&8191),Z=c[1]+((H>>>13|Y<<3)&8191),z=c[2]+((Y>>>10|T<<6)&8191),q=c[3]+((T>>>7|L<<9)&8191),$=c[4]+((L>>>4|N<<12)&8191),M=c[5]+(N>>>1&8191),S=c[6]+((N>>>14|I<<2)&8191),R=c[7]+((I>>>11|U<<5)&8191),D=c[8]+((U>>>8|W<<8)&8191),j=c[9]+(W>>>5|o),P=0,Q=P+O*x+Z*(5*F)+z*(5*_)+q*(5*v)+$*(5*w);P=Q>>>13,Q&=8191,Q+=M*(5*y)+S*(5*g)+R*(5*E)+D*(5*m)+j*(5*f),P+=Q>>>13,Q&=8191;let C=P+O*f+Z*x+z*(5*F)+q*(5*_)+$*(5*v);P=C>>>13,C&=8191,C+=M*(5*w)+S*(5*y)+R*(5*g)+D*(5*E)+j*(5*m),P+=C>>>13,C&=8191;let K=P+O*m+Z*f+z*x+q*(5*F)+$*(5*_);P=K>>>13,K&=8191,K+=M*(5*v)+S*(5*w)+R*(5*y)+D*(5*g)+j*(5*E),P+=K>>>13,K&=8191;let J=P+O*E+Z*m+z*f+q*x+$*(5*F);P=J>>>13,J&=8191,J+=M*(5*_)+S*(5*v)+R*(5*w)+D*(5*y)+j*(5*g),P+=J>>>13,J&=8191;let ne=P+O*g+Z*E+z*m+q*f+$*x;P=ne>>>13,ne&=8191,ne+=M*(5*F)+S*(5*_)+R*(5*v)+D*(5*w)+j*(5*y),P+=ne>>>13,ne&=8191;let re=P+O*y+Z*g+z*E+q*m+$*f;P=re>>>13,re&=8191,re+=M*x+S*(5*F)+R*(5*_)+D*(5*v)+j*(5*w),P+=re>>>13,re&=8191;let ie=P+O*w+Z*y+z*g+q*E+$*m;P=ie>>>13,ie&=8191,ie+=M*f+S*x+R*(5*F)+D*(5*_)+j*(5*v),P+=ie>>>13,ie&=8191;let ce=P+O*v+Z*w+z*y+q*g+$*E;P=ce>>>13,ce&=8191,ce+=M*m+S*f+R*x+D*(5*F)+j*(5*_),P+=ce>>>13,ce&=8191;let ue=P+O*_+Z*v+z*w+q*y+$*g;P=ue>>>13,ue&=8191,ue+=M*E+S*m+R*f+D*x+j*(5*F),P+=ue>>>13,ue&=8191;let ae=P+O*F+Z*_+z*v+q*w+$*y;P=ae>>>13,ae&=8191,ae+=M*g+S*E+R*m+D*f+j*x,P+=ae>>>13,ae&=8191,P=(P<<2)+P|0,P=P+Q|0,Q=P&8191,P=P>>>13,C+=P,c[0]=Q,c[1]=C,c[2]=K,c[3]=J,c[4]=ne,c[5]=re,c[6]=ie,c[7]=ce,c[8]=ue,c[9]=ae}finalize(){const{h:t,pad:n}=this,r=new Uint16Array(10);let o=t[1]>>>13;t[1]&=8191;for(let x=2;x<10;x++)t[x]+=o,o=t[x]>>>13,t[x]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,r[0]=t[0]+5,o=r[0]>>>13,r[0]&=8191;for(let x=1;x<10;x++)r[x]=t[x]+o,o=r[x]>>>13,r[x]&=8191;r[9]-=8192;let c=(o^1)-1;for(let x=0;x<10;x++)r[x]&=c;c=~c;for(let x=0;x<10;x++)t[x]=t[x]&c|r[x];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let l=t[0]+n[0];t[0]=l&65535;for(let x=1;x<8;x++)l=(t[x]+n[x]|0)+(l>>>16)|0,t[x]=l&65535}update(t){exists(this);const{buffer:n,blockLen:r}=this;t=toBytes$1(t);const o=t.length;for(let c=0;c<o;){const l=Math.min(r-this.pos,o-c);if(l===r){for(;r<=o-c;c+=r)this.process(t,c);continue}n.set(t.subarray(c,c+l),this.pos),this.pos+=l,c+=l,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){exists(this),output(t,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let c=0;for(let l=0;l<8;l++)t[c++]=r[l]>>>0,t[c++]=r[l]>>>8;return t}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}}function wrapConstructorWithKey(e){const t=(r,o)=>e(o).update(toBytes$1(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const poly1305=wrapConstructorWithKey(e=>new Poly1305(e)),_utf8ToBytes=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),sigma16=_utf8ToBytes("expand 16-byte k"),sigma32=_utf8ToBytes("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32);sigma32_32.slice();function rotl$2(e,t){return e<<t|e>>>32-t}function isAligned32(e){return e.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(e,t,n,r,o,c,l,x){const f=o.length,m=new Uint8Array(BLOCK_LEN),E=u32(m),g=isAligned32(o)&&isAligned32(c),y=g?u32(o):U32_EMPTY,w=g?u32(c):U32_EMPTY;for(let v=0;v<f;l++){if(e(t,n,r,E,l,x),l>=MAX_COUNTER)throw new Error("arx: counter overflow");const _=Math.min(BLOCK_LEN,f-v);if(g&&_===BLOCK_LEN){const F=v/4;if(v%4!==0)throw new Error("arx: invalid block position");for(let H=0,Y;H<BLOCK_LEN32;H++)Y=F+H,w[Y]=y[Y]^E[H];v+=BLOCK_LEN;continue}for(let F=0,H;F<_;F++)H=v+F,c[H]=o[H]^m[F];v+=_}}function createCipher(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:c,rounds:l}=checkOpts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return number$2(o),number$2(l),bool(c),bool(n),(x,f,m,E,g=0)=>{bytes(x),bytes(f),bytes(m);const y=m.length;if(E||(E=new Uint8Array(y)),bytes(E),number$2(g),g<0||g>=MAX_COUNTER)throw new Error("arx: counter overflow");if(E.length<y)throw new Error(`arx: output (${E.length}) is shorter than data (${y})`);const w=[];let v=x.length,_,F;if(v===32)_=x.slice(),w.push(_),F=sigma32_32;else if(v===16&&n)_=new Uint8Array(32),_.set(x),_.set(x,16),F=sigma16_32,w.push(_);else throw new Error(`arx: invalid 32-byte key, got length=${v}`);isAligned32(f)||(f=f.slice(),w.push(f));const H=u32(_);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(F,H,u32(f.subarray(0,16)),H),f=f.subarray(16)}const Y=16-o;if(Y!==f.length)throw new Error(`arx: nonce must be ${Y} or 16 bytes`);if(Y!==12){const L=new Uint8Array(12);L.set(f,c?0:12-f.length),f=L,w.push(f)}const T=u32(f);for(runCipher(e,F,H,T,m,E,g,l);w.length>0;)w.pop().fill(0);return E}}function chachaCore(e,t,n,r,o,c=20){let l=e[0],x=e[1],f=e[2],m=e[3],E=t[0],g=t[1],y=t[2],w=t[3],v=t[4],_=t[5],F=t[6],H=t[7],Y=o,T=n[0],L=n[1],N=n[2],I=l,U=x,W=f,O=m,Z=E,z=g,q=y,$=w,M=v,S=_,R=F,D=H,j=Y,P=T,Q=L,C=N;for(let J=0;J<c;J+=2)I=I+Z|0,j=rotl$2(j^I,16),M=M+j|0,Z=rotl$2(Z^M,12),I=I+Z|0,j=rotl$2(j^I,8),M=M+j|0,Z=rotl$2(Z^M,7),U=U+z|0,P=rotl$2(P^U,16),S=S+P|0,z=rotl$2(z^S,12),U=U+z|0,P=rotl$2(P^U,8),S=S+P|0,z=rotl$2(z^S,7),W=W+q|0,Q=rotl$2(Q^W,16),R=R+Q|0,q=rotl$2(q^R,12),W=W+q|0,Q=rotl$2(Q^W,8),R=R+Q|0,q=rotl$2(q^R,7),O=O+$|0,C=rotl$2(C^O,16),D=D+C|0,$=rotl$2($^D,12),O=O+$|0,C=rotl$2(C^O,8),D=D+C|0,$=rotl$2($^D,7),I=I+z|0,C=rotl$2(C^I,16),R=R+C|0,z=rotl$2(z^R,12),I=I+z|0,C=rotl$2(C^I,8),R=R+C|0,z=rotl$2(z^R,7),U=U+q|0,j=rotl$2(j^U,16),D=D+j|0,q=rotl$2(q^D,12),U=U+q|0,j=rotl$2(j^U,8),D=D+j|0,q=rotl$2(q^D,7),W=W+$|0,P=rotl$2(P^W,16),M=M+P|0,$=rotl$2($^M,12),W=W+$|0,P=rotl$2(P^W,8),M=M+P|0,$=rotl$2($^M,7),O=O+Z|0,Q=rotl$2(Q^O,16),S=S+Q|0,Z=rotl$2(Z^S,12),O=O+Z|0,Q=rotl$2(Q^O,8),S=S+Q|0,Z=rotl$2(Z^S,7);let K=0;r[K++]=l+I|0,r[K++]=x+U|0,r[K++]=f+W|0,r[K++]=m+O|0,r[K++]=E+Z|0,r[K++]=g+z|0,r[K++]=y+q|0,r[K++]=w+$|0,r[K++]=v+M|0,r[K++]=_+S|0,r[K++]=F+R|0,r[K++]=H+D|0,r[K++]=Y+j|0,r[K++]=T+P|0,r[K++]=L+Q|0,r[K++]=N+C|0}function hchacha(e,t,n,r){let o=e[0],c=e[1],l=e[2],x=e[3],f=t[0],m=t[1],E=t[2],g=t[3],y=t[4],w=t[5],v=t[6],_=t[7],F=n[0],H=n[1],Y=n[2],T=n[3];for(let N=0;N<20;N+=2)o=o+f|0,F=rotl$2(F^o,16),y=y+F|0,f=rotl$2(f^y,12),o=o+f|0,F=rotl$2(F^o,8),y=y+F|0,f=rotl$2(f^y,7),c=c+m|0,H=rotl$2(H^c,16),w=w+H|0,m=rotl$2(m^w,12),c=c+m|0,H=rotl$2(H^c,8),w=w+H|0,m=rotl$2(m^w,7),l=l+E|0,Y=rotl$2(Y^l,16),v=v+Y|0,E=rotl$2(E^v,12),l=l+E|0,Y=rotl$2(Y^l,8),v=v+Y|0,E=rotl$2(E^v,7),x=x+g|0,T=rotl$2(T^x,16),_=_+T|0,g=rotl$2(g^_,12),x=x+g|0,T=rotl$2(T^x,8),_=_+T|0,g=rotl$2(g^_,7),o=o+m|0,T=rotl$2(T^o,16),v=v+T|0,m=rotl$2(m^v,12),o=o+m|0,T=rotl$2(T^o,8),v=v+T|0,m=rotl$2(m^v,7),c=c+E|0,F=rotl$2(F^c,16),_=_+F|0,E=rotl$2(E^_,12),c=c+E|0,F=rotl$2(F^c,8),_=_+F|0,E=rotl$2(E^_,7),l=l+g|0,H=rotl$2(H^l,16),y=y+H|0,g=rotl$2(g^y,12),l=l+g|0,H=rotl$2(H^l,8),y=y+H|0,g=rotl$2(g^y,7),x=x+f|0,Y=rotl$2(Y^x,16),w=w+Y|0,f=rotl$2(f^w,12),x=x+f|0,Y=rotl$2(Y^x,8),w=w+Y|0,f=rotl$2(f^w,7);let L=0;r[L++]=o,r[L++]=c,r[L++]=l,r[L++]=x,r[L++]=F,r[L++]=H,r[L++]=Y,r[L++]=T}const chacha20=createCipher(chachaCore,{counterRight:!1,counterLength:4,allowShortKeys:!1}),xchacha20=createCipher(chachaCore,{counterRight:!1,counterLength:8,extendNonceFn:hchacha,allowShortKeys:!1}),ZEROS16=new Uint8Array(16),updatePadded=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(ZEROS16.subarray(n))},ZEROS32=new Uint8Array(32);function computeTag(e,t,n,r,o){const c=e(t,n,ZEROS32),l=poly1305.create(c);o&&updatePadded(l,o),updatePadded(l,r);const x=new Uint8Array(16),f=createView$1(x);setBigUint64$1(f,0,BigInt(o?o.length:0),!0),setBigUint64$1(f,8,BigInt(r.length),!0),l.update(x);const m=l.digest();return c.fill(0),m}const _poly1305_aead=e=>(t,n,r)=>(bytes(t,32),bytes(n),{encrypt:(c,l)=>{const x=c.length,f=x+16;l?bytes(l,f):l=new Uint8Array(f),e(t,n,c,l,1);const m=computeTag(e,t,n,l.subarray(0,-16),r);return l.set(m,x),l},decrypt:(c,l)=>{const x=c.length,f=x-16;if(x<16)throw new Error("encrypted data must be at least 16 bytes");l?bytes(l,f):l=new Uint8Array(f);const m=c.subarray(0,-16),E=c.subarray(-16),g=computeTag(e,t,n,m,r);if(!equalBytes(E,g))throw new Error("invalid tag");return e(t,n,m,l,1),l}}),xchacha20poly1305=wrapCipher({blockSize:64,nonceLength:24,tagLength:16},_poly1305_aead(xchacha20));let HMAC$1=class extends Hash$1{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,assert$2.hash(t);const r=toBytes$2(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,c=new Uint8Array(o);c.set(r.length>o?t.create().update(r).digest():r);for(let l=0;l<c.length;l++)c[l]^=54;this.iHash.update(c),this.oHash=t.create();for(let l=0;l<c.length;l++)c[l]^=106;this.oHash.update(c),c.fill(0)}update(t){return assert$2.exists(this),this.iHash.update(t),this}digestInto(t){assert$2.exists(this),assert$2.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:c,blockLen:l,outputLen:x}=this;return t=t,t.finished=o,t.destroyed=c,t.blockLen=l,t.outputLen=x,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$2=(e,t,n)=>new HMAC$1(e,t).update(n).digest();hmac$2.create=(e,t)=>new HMAC$1(e,t);function extract(e,t,n){return assert$2.hash(e),hmac$2(e,toBytes$2(n),toBytes$2(t))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER$3=new Uint8Array;function expand(e,t,n,r=32){if(assert$2.hash(e),assert$2.number(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/e.outputLen);n===void 0&&(n=EMPTY_BUFFER$3);const c=new Uint8Array(o*e.outputLen),l=hmac$2.create(e,t),x=l._cloneInto(),f=new Uint8Array(l.outputLen);for(let m=0;m<o;m++)HKDF_COUNTER[0]=m+1,x.update(m===0?EMPTY_BUFFER$3:f).update(n).update(HKDF_COUNTER).digestInto(f),c.set(f,e.outputLen*m),l._cloneInto(x);return l.destroy(),x.destroy(),f.fill(0),HKDF_COUNTER.fill(0),c.slice(0,r)}var __defProp$2=Object.defineProperty,__export=(e,t)=>{for(var n in t)__defProp$2(e,n,{get:t[n],enumerable:!0})},verifiedSymbol=Symbol("verified"),isRecord=e=>e instanceof Object;function validateEvent(e){if(!isRecord(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]!="string")return!1}return!0}var utils_exports={};__export(utils_exports,{Queue:()=>Queue$1,QueueNode:()=>QueueNode,binarySearch:()=>binarySearch,bytesToHex:()=>bytesToHex$2,hexToBytes:()=>hexToBytes$4,insertEventIntoAscendingList:()=>insertEventIntoAscendingList,insertEventIntoDescendingList:()=>insertEventIntoDescendingList,normalizeURL:()=>normalizeURL,utf8Decoder:()=>utf8Decoder$1,utf8Encoder:()=>utf8Encoder$1});var utf8Decoder$1=new TextDecoder("utf-8"),utf8Encoder$1=new TextEncoder;function normalizeURL(e){try{e.indexOf("://")===-1&&(e="wss://"+e);let t=new URL(e);return t.protocol==="http:"?t.protocol="ws:":t.protocol==="https:"&&(t.protocol="wss:"),t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}catch{throw new Error(`Invalid URL: ${e}`)}}function insertEventIntoDescendingList(e,t){const[n,r]=binarySearch(e,o=>t.id===o.id?0:t.created_at===o.created_at?-1:o.created_at-t.created_at);return r||e.splice(n,0,t),e}function insertEventIntoAscendingList(e,t){const[n,r]=binarySearch(e,o=>t.id===o.id?0:t.created_at===o.created_at?-1:t.created_at-o.created_at);return r||e.splice(n,0,t),e}function binarySearch(e,t){let n=0,r=e.length-1;for(;n<=r;){const o=Math.floor((n+r)/2),c=t(e[o]);if(c===0)return[o,!0];c<0?r=o-1:n=o+1}return[n,!1]}var QueueNode=class{value;next=null;prev=null;constructor(e){this.value=e}},Queue$1=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const n=new QueueNode(t);return this.last?this.last===this.first?(this.last=n,this.last.prev=this.first,this.first.next=n):(n.prev=this.last,this.last.next=n,this.last=n):(this.first=n,this.last=n),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const n=this.first;return this.first=null,this.last=null,n.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}},JS=class{generateSecretKey(){return schnorr$1.utils.randomPrivateKey()}getPublicKey(e){return bytesToHex$2(schnorr$1.getPublicKey(e))}finalizeEvent(e,t){const n=e;return n.pubkey=bytesToHex$2(schnorr$1.getPublicKey(t)),n.id=getEventHash$1(n),n.sig=bytesToHex$2(schnorr$1.sign(getEventHash$1(n),t)),n[verifiedSymbol]=!0,n}verifyEvent(e){if(typeof e[verifiedSymbol]=="boolean")return e[verifiedSymbol];const t=getEventHash$1(e);if(t!==e.id)return e[verifiedSymbol]=!1,!1;try{const n=schnorr$1.verify(e.sig,t,e.pubkey);return e[verifiedSymbol]=n,n}catch{return e[verifiedSymbol]=!1,!1}}};function serializeEvent(e){if(!validateEvent(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function getEventHash$1(e){let t=sha256$2(utf8Encoder$1.encode(serializeEvent(e)));return bytesToHex$2(t)}var i=new JS,generateSecretKey=i.generateSecretKey,getPublicKey=i.getPublicKey,finalizeEvent=i.finalizeEvent,verifyEvent=i.verifyEvent,kinds_exports={};__export(kinds_exports,{Application:()=>Application,BadgeAward:()=>BadgeAward,BadgeDefinition:()=>BadgeDefinition,BlockedRelaysList:()=>BlockedRelaysList,BookmarkList:()=>BookmarkList,Bookmarksets:()=>Bookmarksets,Calendar:()=>Calendar,CalendarEventRSVP:()=>CalendarEventRSVP,ChannelCreation:()=>ChannelCreation,ChannelHideMessage:()=>ChannelHideMessage,ChannelMessage:()=>ChannelMessage,ChannelMetadata:()=>ChannelMetadata,ChannelMuteUser:()=>ChannelMuteUser,ClassifiedListing:()=>ClassifiedListing,ClientAuth:()=>ClientAuth,CommunitiesList:()=>CommunitiesList,CommunityDefinition:()=>CommunityDefinition,CommunityPostApproval:()=>CommunityPostApproval,Contacts:()=>Contacts,CreateOrUpdateProduct:()=>CreateOrUpdateProduct,CreateOrUpdateStall:()=>CreateOrUpdateStall,Curationsets:()=>Curationsets,Date:()=>Date2,DirectMessageRelaysList:()=>DirectMessageRelaysList,DraftClassifiedListing:()=>DraftClassifiedListing,DraftLong:()=>DraftLong,Emojisets:()=>Emojisets,EncryptedDirectMessage:()=>EncryptedDirectMessage,EventDeletion:()=>EventDeletion,FileMetadata:()=>FileMetadata,FileServerPreference:()=>FileServerPreference,Followsets:()=>Followsets,GenericRepost:()=>GenericRepost,Genericlists:()=>Genericlists,GiftWrap:()=>GiftWrap,HTTPAuth:()=>HTTPAuth,Handlerinformation:()=>Handlerinformation,Handlerrecommendation:()=>Handlerrecommendation,Highlights:()=>Highlights,InterestsList:()=>InterestsList,Interestsets:()=>Interestsets,JobFeedback:()=>JobFeedback,JobRequest:()=>JobRequest,JobResult:()=>JobResult,Label:()=>Label,LightningPubRPC:()=>LightningPubRPC,LiveChatMessage:()=>LiveChatMessage,LiveEvent:()=>LiveEvent,LongFormArticle:()=>LongFormArticle,Metadata:()=>Metadata,Mutelist:()=>Mutelist,NWCWalletInfo:()=>NWCWalletInfo,NWCWalletRequest:()=>NWCWalletRequest,NWCWalletResponse:()=>NWCWalletResponse,NostrConnect:()=>NostrConnect,OpenTimestamps:()=>OpenTimestamps,Pinlist:()=>Pinlist,PrivateDirectMessage:()=>PrivateDirectMessage,ProblemTracker:()=>ProblemTracker,ProfileBadges:()=>ProfileBadges,PublicChatsList:()=>PublicChatsList,Reaction:()=>Reaction,RecommendRelay:()=>RecommendRelay,RelayList:()=>RelayList,Relaysets:()=>Relaysets,Report:()=>Report,Reporting:()=>Reporting,Repost:()=>Repost,Seal:()=>Seal,SearchRelaysList:()=>SearchRelaysList,ShortTextNote:()=>ShortTextNote,Time:()=>Time,UserEmojiList:()=>UserEmojiList,UserStatuses:()=>UserStatuses,Zap:()=>Zap,ZapGoal:()=>ZapGoal,ZapRequest:()=>ZapRequest,classifyKind:()=>classifyKind,isAddressableKind:()=>isAddressableKind,isEphemeralKind:()=>isEphemeralKind,isKind:()=>isKind,isRegularKind:()=>isRegularKind,isReplaceableKind:()=>isReplaceableKind});function isRegularKind(e){return e<1e4&&e!==0&&e!==3}function isReplaceableKind(e){return e===0||e===3||1e4<=e&&e<2e4}function isEphemeralKind(e){return 2e4<=e&&e<3e4}function isAddressableKind(e){return 3e4<=e&&e<4e4}function classifyKind(e){return isRegularKind(e)?"regular":isReplaceableKind(e)?"replaceable":isEphemeralKind(e)?"ephemeral":isAddressableKind(e)?"parameterized":"unknown"}function isKind(e,t){const n=t instanceof Array?t:[t];return validateEvent(e)&&n.includes(e.kind)||!1}var Metadata=0,ShortTextNote=1,RecommendRelay=2,Contacts=3,EncryptedDirectMessage=4,EventDeletion=5,Repost=6,Reaction=7,BadgeAward=8,Seal=13,PrivateDirectMessage=14,GenericRepost=16,ChannelCreation=40,ChannelMetadata=41,ChannelMessage=42,ChannelHideMessage=43,ChannelMuteUser=44,OpenTimestamps=1040,GiftWrap=1059,FileMetadata=1063,LiveChatMessage=1311,ProblemTracker=1971,Report=1984,Reporting=1984,Label=1985,CommunityPostApproval=4550,JobRequest=5999,JobResult=6999,JobFeedback=7e3,ZapGoal=9041,ZapRequest=9734,Zap=9735,Highlights=9802,Mutelist=1e4,Pinlist=10001,RelayList=10002,BookmarkList=10003,CommunitiesList=10004,PublicChatsList=10005,BlockedRelaysList=10006,SearchRelaysList=10007,InterestsList=10015,UserEmojiList=10030,DirectMessageRelaysList=10050,FileServerPreference=10096,NWCWalletInfo=13194,LightningPubRPC=21e3,ClientAuth=22242,NWCWalletRequest=23194,NWCWalletResponse=23195,NostrConnect=24133,HTTPAuth=27235,Followsets=3e4,Genericlists=30001,Relaysets=30002,Bookmarksets=30003,Curationsets=30004,ProfileBadges=30008,BadgeDefinition=30009,Interestsets=30015,CreateOrUpdateStall=30017,CreateOrUpdateProduct=30018,LongFormArticle=30023,DraftLong=30024,Emojisets=30030,Application=30078,LiveEvent=30311,UserStatuses=30315,ClassifiedListing=30402,DraftClassifiedListing=30403,Date2=31922,Time=31923,Calendar=31924,CalendarEventRSVP=31925,Handlerrecommendation=31989,Handlerinformation=31990,CommunityDefinition=34550;function matchFilter(e,t){if(e.ids&&e.ids.indexOf(t.id)===-1||e.kinds&&e.kinds.indexOf(t.kind)===-1||e.authors&&e.authors.indexOf(t.pubkey)===-1)return!1;for(let n in e)if(n[0]==="#"){let r=n.slice(1),o=e[`#${r}`];if(o&&!t.tags.find(([c,l])=>c===n.slice(1)&&o.indexOf(l)!==-1))return!1}return!(e.since&&t.created_at<e.since||e.until&&t.created_at>e.until)}function matchFilters(e,t){for(let n=0;n<e.length;n++)if(matchFilter(e[n],t))return!0;return!1}var fakejson_exports={};__export(fakejson_exports,{getHex64:()=>getHex64,getInt:()=>getInt,getSubscriptionId:()=>getSubscriptionId,matchEventId:()=>matchEventId,matchEventKind:()=>matchEventKind,matchEventPubkey:()=>matchEventPubkey});function getHex64(e,t){let n=t.length+3,r=e.indexOf(`"${t}":`)+n,o=e.slice(r).indexOf('"')+r+1;return e.slice(o,o+64)}function getInt(e,t){let n=t.length,r=e.indexOf(`"${t}":`)+n+3,o=e.slice(r),c=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,c),10)}function getSubscriptionId(e){let t=e.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let n=e.slice(t+7+1).indexOf('"');if(n===-1)return null;let r=t+7+1+n,o=e.slice(r+1,80).indexOf('"');if(o===-1)return null;let c=r+1+o;return e.slice(r+1,c)}function matchEventId(e,t){return t===getHex64(e,"id")}function matchEventPubkey(e,t){return t===getHex64(e,"pubkey")}function matchEventKind(e,t){return t===getInt(e,"kind")}var nip42_exports={};__export(nip42_exports,{makeAuthEvent:()=>makeAuthEvent});function makeAuthEvent(e,t){return{kind:ClientAuth,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}var _WebSocket;try{_WebSocket=WebSocket}catch{}var _WebSocket2;try{_WebSocket2=WebSocket}catch{}var nip19_exports$1={};__export(nip19_exports$1,{BECH32_REGEX:()=>BECH32_REGEX$2,Bech32MaxSize:()=>Bech32MaxSize$2,NostrTypeGuard:()=>NostrTypeGuard$1,decode:()=>decode$j,decodeNostrURI:()=>decodeNostrURI$1,encodeBytes:()=>encodeBytes$2,naddrEncode:()=>naddrEncode$1,neventEncode:()=>neventEncode$1,noteEncode:()=>noteEncode$1,nprofileEncode:()=>nprofileEncode$1,npubEncode:()=>npubEncode$1,nsecEncode:()=>nsecEncode$1});var NostrTypeGuard$1={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},Bech32MaxSize$2=5e3,BECH32_REGEX$2=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array$1(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function decodeNostrURI$1(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),decode$j(e)}catch{return{type:"invalid",data:null}}}function decode$j(e){let{prefix:t,words:n}=bech32.decode(e,Bech32MaxSize$2),r=new Uint8Array(bech32.fromWords(n));switch(t){case"nprofile":{let o=parseTLV$1(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$2(o[0][0]),relays:o[1]?o[1].map(c=>utf8Decoder$1.decode(c)):[]}}}case"nevent":{let o=parseTLV$1(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$2(o[0][0]),relays:o[1]?o[1].map(c=>utf8Decoder$1.decode(c)):[],author:o[2]?.[0]?bytesToHex$2(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(bytesToHex$2(o[3][0]),16):void 0}}}case"naddr":{let o=parseTLV$1(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder$1.decode(o[0][0]),pubkey:bytesToHex$2(o[2][0]),kind:parseInt(bytesToHex$2(o[3][0]),16),relays:o[1]?o[1].map(c=>utf8Decoder$1.decode(c)):[]}}}case"nsec":return{type:t,data:r};case"npub":case"note":return{type:t,data:bytesToHex$2(r)};default:throw new Error(`unknown prefix ${t}`)}}function parseTLV$1(e){let t={},n=e;for(;n.length>0;){let r=n[0],o=n[1],c=n.slice(2,2+o);if(n=n.slice(2+o),c.length<o)throw new Error(`not enough data to read on TLV ${r}`);t[r]=t[r]||[],t[r].push(c)}return t}function nsecEncode$1(e){return encodeBytes$2("nsec",e)}function npubEncode$1(e){return encodeBytes$2("npub",hexToBytes$4(e))}function noteEncode$1(e){return encodeBytes$2("note",hexToBytes$4(e))}function encodeBech32$2(e,t){let n=bech32.toWords(t);return bech32.encode(e,n,Bech32MaxSize$2)}function encodeBytes$2(e,t){return encodeBech32$2(e,t)}function nprofileEncode$1(e){let t=encodeTLV$1({0:[hexToBytes$4(e.pubkey)],1:(e.relays||[]).map(n=>utf8Encoder$1.encode(n))});return encodeBech32$2("nprofile",t)}function neventEncode$1(e){let t;e.kind!==void 0&&(t=integerToUint8Array$1(e.kind));let n=encodeTLV$1({0:[hexToBytes$4(e.id)],1:(e.relays||[]).map(r=>utf8Encoder$1.encode(r)),2:e.author?[hexToBytes$4(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return encodeBech32$2("nevent",n)}function naddrEncode$1(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let n=encodeTLV$1({0:[utf8Encoder$1.encode(e.identifier)],1:(e.relays||[]).map(r=>utf8Encoder$1.encode(r)),2:[hexToBytes$4(e.pubkey)],3:[new Uint8Array(t)]});return encodeBech32$2("naddr",n)}function encodeTLV$1(e){let t=[];return Object.entries(e).reverse().forEach(([n,r])=>{r.forEach(o=>{let c=new Uint8Array(o.length+2);c.set([parseInt(n)],0),c.set([o.length],1),c.set(o,2),t.push(c)})}),concatBytes$1(...t)}var nip04_exports={};__export(nip04_exports,{decrypt:()=>decrypt$2,encrypt:()=>encrypt$2});function encrypt$2(e,t,n){const r=e instanceof Uint8Array?bytesToHex$2(e):e,o=secp256k1$2.getSharedSecret(r,"02"+t),c=getNormalizedX(o);let l=Uint8Array.from(randomBytes$1(16)),x=utf8Encoder$1.encode(n),f=cbc(c,l).encrypt(x),m=base64.encode(new Uint8Array(f)),E=base64.encode(new Uint8Array(l.buffer));return`${m}?iv=${E}`}function decrypt$2(e,t,n){const r=e instanceof Uint8Array?bytesToHex$2(e):e;let[o,c]=n.split("?iv="),l=secp256k1$2.getSharedSecret(r,"02"+t),x=getNormalizedX(l),f=base64.decode(c),m=base64.decode(o),E=cbc(x,f).decrypt(m);return utf8Decoder$1.decode(E)}function getNormalizedX(e){return e.slice(1,33)}var nip05_exports={};__export(nip05_exports,{NIP05_REGEX:()=>NIP05_REGEX$1,isNip05:()=>isNip05,isValid:()=>isValid,queryProfile:()=>queryProfile,searchDomain:()=>searchDomain,useFetchImplementation:()=>useFetchImplementation});var NIP05_REGEX$1=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,isNip05=e=>NIP05_REGEX$1.test(e||""),_fetch;try{_fetch=fetch}catch{}function useFetchImplementation(e){_fetch=e}async function searchDomain(e,t=""){try{const n=`https://${e}/.well-known/nostr.json?name=${t}`,r=await _fetch(n,{redirect:"manual"});if(r.status!==200)throw Error("Wrong response code");return(await r.json()).names}catch{return{}}}async function queryProfile(e){const t=e.match(NIP05_REGEX$1);if(!t)return null;const[,n="_",r]=t;try{const o=`https://${r}/.well-known/nostr.json?name=${n}`,c=await _fetch(o,{redirect:"manual"});if(c.status!==200)throw Error("Wrong response code");const l=await c.json(),x=l.names[n];return x?{pubkey:x,relays:l.relays?.[x]}:null}catch{return null}}async function isValid(e,t){const n=await queryProfile(t);return n?n.pubkey===e:!1}var nip10_exports={};__export(nip10_exports,{parse:()=>parse$2});function parse$2(e){const t={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let n,r;for(let o=e.tags.length-1;o>=0;o--){const c=e.tags[o];if(c[0]==="e"&&c[1]){const[l,x,f,m,E]=c,g={id:x,relays:f?[f]:[],author:E};if(m==="root"){t.root=g;continue}if(m==="reply"){t.reply=g;continue}if(m==="mention"){t.mentions.push(g);continue}n?r=g:n=g,t.mentions.push(g);continue}if(c[0]==="q"&&c[1]){const[l,x,f]=c;t.quotes.push({id:x,relays:f?[f]:[]})}if(c[0]==="p"&&c[1]){t.profiles.push({pubkey:c[1],relays:c[2]?[c[2]]:[]});continue}}return t.root||(t.root=r||n||t.reply),t.reply||(t.reply=n||t.root),[t.reply,t.root].forEach(o=>{if(!o)return;let c=t.mentions.indexOf(o);if(c!==-1&&t.mentions.splice(c,1),o.author){let l=t.profiles.find(x=>x.pubkey===o.author);l&&l.relays&&(o.relays||(o.relays=[]),l.relays.forEach(x=>{o.relays?.indexOf(x)===-1&&o.relays.push(x)}),l.relays=o.relays)}}),t.mentions.forEach(o=>{if(o.author){let c=t.profiles.find(l=>l.pubkey===o.author);c&&c.relays&&(o.relays||(o.relays=[]),c.relays.forEach(l=>{o.relays.indexOf(l)===-1&&o.relays.push(l)}),c.relays=o.relays)}}),t}var nip11_exports={};__export(nip11_exports,{fetchRelayInformation:()=>fetchRelayInformation$1,useFetchImplementation:()=>useFetchImplementation2});var _fetch2;try{_fetch2=fetch}catch{}function useFetchImplementation2(e){_fetch2=e}async function fetchRelayInformation$1(e){return await(await fetch(e.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var nip13_exports={};__export(nip13_exports,{fastEventHash:()=>fastEventHash,getPow:()=>getPow,minePow:()=>minePow});function getPow(e){let t=0;for(let n=0;n<64;n+=8){const r=parseInt(e.substring(n,n+8),16);if(r===0)t+=32;else{t+=Math.clz32(r);break}}return t}function minePow(e,t){let n=0;const r=e,o=["nonce",n.toString(),t.toString()];for(r.tags.push(o);;){const c=Math.floor(new Date().getTime()/1e3);if(c!==r.created_at&&(n=0,r.created_at=c),o[1]=(++n).toString(),r.id=fastEventHash(r),getPow(r.id)>=t)break}return r}function fastEventHash(e){return bytesToHex$2(sha256$2(utf8Encoder$1.encode(JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content]))))}var nip17_exports={};__export(nip17_exports,{unwrapEvent:()=>unwrapEvent2,unwrapManyEvents:()=>unwrapManyEvents2,wrapEvent:()=>wrapEvent2,wrapManyEvents:()=>wrapManyEvents2});var nip59_exports={};__export(nip59_exports,{createRumor:()=>createRumor,createSeal:()=>createSeal,createWrap:()=>createWrap,unwrapEvent:()=>unwrapEvent,unwrapManyEvents:()=>unwrapManyEvents,wrapEvent:()=>wrapEvent$1,wrapManyEvents:()=>wrapManyEvents});var nip44_exports={};__export(nip44_exports,{decrypt:()=>decrypt2,encrypt:()=>encrypt2,getConversationKey:()=>getConversationKey,v2:()=>v2});var minPlaintextSize=1,maxPlaintextSize=65535;function getConversationKey(e,t){const n=secp256k1$2.getSharedSecret(e,"02"+t).subarray(1,33);return extract(sha256$2,n,"nip44-v2")}function getMessageKeys(e,t){const n=expand(sha256$2,e,t,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function calcPaddedLen(e){if(!Number.isSafeInteger(e)||e<1)throw new Error("expected positive integer");if(e<=32)return 32;const t=1<<Math.floor(Math.log2(e-1))+1,n=t<=256?32:t/8;return n*(Math.floor((e-1)/n)+1)}function writeU16BE(e){if(!Number.isSafeInteger(e)||e<minPlaintextSize||e>maxPlaintextSize)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function pad(e){const t=utf8Encoder$1.encode(e),n=t.length,r=writeU16BE(n),o=new Uint8Array(calcPaddedLen(n)-n);return concatBytes$1(r,t,o)}function unpad(e){const t=new DataView(e.buffer).getUint16(0),n=e.subarray(2,2+t);if(t<minPlaintextSize||t>maxPlaintextSize||n.length!==t||e.length!==2+calcPaddedLen(t))throw new Error("invalid padding");return utf8Decoder$1.decode(n)}function hmacAad(e,t,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");const r=concatBytes$1(n,t);return hmac$2(sha256$2,e,r)}function decodePayload(e){if(typeof e!="string")throw new Error("payload must be a valid string");const t=e.length;if(t<132||t>87472)throw new Error("invalid payload length: "+t);if(e[0]==="#")throw new Error("unknown encryption version");let n;try{n=base64.decode(e)}catch(c){throw new Error("invalid base64: "+c.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function encrypt2(e,t,n=randomBytes$1(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:c}=getMessageKeys(t,n),l=pad(e),x=chacha20(r,o,l),f=hmacAad(c,x,n);return base64.encode(concatBytes$1(new Uint8Array([2]),n,x,f))}function decrypt2(e,t){const{nonce:n,ciphertext:r,mac:o}=decodePayload(e),{chacha_key:c,chacha_nonce:l,hmac_key:x}=getMessageKeys(t,n),f=hmacAad(x,r,n);if(!equalBytes(f,o))throw new Error("invalid MAC");const m=chacha20(c,l,r);return unpad(m)}var v2={utils:{getConversationKey,calcPaddedLen},encrypt:encrypt2,decrypt:decrypt2},TWO_DAYS=2880*60,now=()=>Math.round(Date.now()/1e3),randomNow=()=>Math.round(now()-Math.random()*TWO_DAYS),nip44ConversationKey=(e,t)=>getConversationKey(e,t),nip44Encrypt=(e,t,n)=>encrypt2(JSON.stringify(e),nip44ConversationKey(t,n)),nip44Decrypt=(e,t)=>JSON.parse(decrypt2(e.content,nip44ConversationKey(t,e.pubkey)));function createRumor(e,t){const n={created_at:now(),content:"",tags:[],...e,pubkey:getPublicKey(t)};return n.id=getEventHash$1(n),n}function createSeal(e,t,n){return finalizeEvent({kind:Seal,content:nip44Encrypt(e,t,n),created_at:randomNow(),tags:[]},t)}function createWrap(e,t){const n=generateSecretKey();return finalizeEvent({kind:GiftWrap,content:nip44Encrypt(e,n,t),created_at:randomNow(),tags:[["p",t]]},n)}function wrapEvent$1(e,t,n){const r=createRumor(e,t),o=createSeal(r,t,n);return createWrap(o,n)}function wrapManyEvents(e,t,n){if(!n||n.length===0)throw new Error("At least one recipient is required.");const r=getPublicKey(t),o=[wrapEvent$1(e,t,r)];return n.forEach(c=>{o.push(wrapEvent$1(e,t,c))}),o}function unwrapEvent(e,t){const n=nip44Decrypt(e,t);return nip44Decrypt(n,t)}function unwrapManyEvents(e,t){let n=[];return e.forEach(r=>{n.push(unwrapEvent(r,t))}),n.sort((r,o)=>r.created_at-o.created_at),n}function createEvent(e,t,n,r){const o={created_at:Math.ceil(Date.now()/1e3),kind:PrivateDirectMessage,tags:[],content:t};return(Array.isArray(e)?e:[e]).forEach(({publicKey:l,relayUrl:x})=>{o.tags.push(x?["p",l,x]:["p",l])}),r&&o.tags.push(["e",r.eventId,r.relayUrl||"","reply"]),n&&o.tags.push(["subject",n]),o}function wrapEvent2(e,t,n,r,o){const c=createEvent(t,n,r,o);return wrapEvent$1(c,e,t.publicKey)}function wrapManyEvents2(e,t,n,r,o){if(!t||t.length===0)throw new Error("At least one recipient is required.");return[{publicKey:getPublicKey(e)},...t].map(l=>wrapEvent2(e,l,n,r,o))}var unwrapEvent2=unwrapEvent,unwrapManyEvents2=unwrapManyEvents,nip18_exports={};__export(nip18_exports,{finishRepostEvent:()=>finishRepostEvent,getRepostedEvent:()=>getRepostedEvent,getRepostedEventPointer:()=>getRepostedEventPointer});function finishRepostEvent(e,t,n,r){let o;const c=[...e.tags??[],["e",t.id,n],["p",t.pubkey]];return t.kind===ShortTextNote?o=Repost:(o=GenericRepost,c.push(["k",String(t.kind)])),finalizeEvent({kind:o,tags:c,content:e.content===""||t.tags?.find(l=>l[0]==="-")?"":JSON.stringify(t),created_at:e.created_at},r)}function getRepostedEventPointer(e){if(![Repost,GenericRepost].includes(e.kind))return;let t,n;for(let r=e.tags.length-1;r>=0&&(t===void 0||n===void 0);r--){const o=e.tags[r];o.length>=2&&(o[0]==="e"&&t===void 0?t=o:o[0]==="p"&&n===void 0&&(n=o))}if(t!==void 0)return{id:t[1],relays:[t[2],n?.[2]].filter(r=>typeof r=="string"),author:n?.[1]}}function getRepostedEvent(e,{skipVerification:t}={}){const n=getRepostedEventPointer(e);if(n===void 0||e.content==="")return;let r;try{r=JSON.parse(e.content)}catch{return}if(r.id===n.id&&!(!t&&!verifyEvent(r)))return r}var nip21_exports={};__export(nip21_exports,{NOSTR_URI_REGEX:()=>NOSTR_URI_REGEX,parse:()=>parse2,test:()=>test});var NOSTR_URI_REGEX=new RegExp(`nostr:(${BECH32_REGEX$2.source})`);function test(e){return typeof e=="string"&&new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(e)}function parse2(e){const t=e.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));if(!t)throw new Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:decode$j(t[1])}}var nip25_exports={};__export(nip25_exports,{finishReactionEvent:()=>finishReactionEvent,getReactedEventPointer:()=>getReactedEventPointer});function finishReactionEvent(e,t,n){const r=t.tags.filter(o=>o.length>=2&&(o[0]==="e"||o[0]==="p"));return finalizeEvent({...e,kind:Reaction,tags:[...e.tags??[],...r,["e",t.id],["p",t.pubkey]],content:e.content??"+"},n)}function getReactedEventPointer(e){if(e.kind!==Reaction)return;let t,n;for(let r=e.tags.length-1;r>=0&&(t===void 0||n===void 0);r--){const o=e.tags[r];o.length>=2&&(o[0]==="e"&&t===void 0?t=o:o[0]==="p"&&n===void 0&&(n=o))}if(!(t===void 0||n===void 0))return{id:t[1],relays:[t[2],n[2]].filter(r=>r!==void 0),author:n[1]}}var nip27_exports={};__export(nip27_exports,{parse:()=>parse3});var noCharacter=/\W/m,noURLCharacter=/\W |\W$|$|,| /m,MAX_HASHTAG_LENGTH=42;function*parse3(e){let t=[];if(typeof e!="string"){for(let c=0;c<e.tags.length;c++){const l=e.tags[c];l[0]==="emoji"&&l.length>=3&&t.push({type:"emoji",shortcode:l[1],url:l[2]})}e=e.content}const n=e.length;let r=0,o=0;e:for(;o<n;){const c=e.indexOf(":",o),l=e.indexOf("#",o);if(c===-1&&l===-1)break e;if(c===-1||l>=0&&l<c){if(l===0||e[l-1]===" "){const x=e.slice(l+1,l+MAX_HASHTAG_LENGTH).match(noCharacter),f=x?l+1+x.index:n;yield{type:"text",text:e.slice(r,l)},yield{type:"hashtag",value:e.slice(l+1,f)},o=f,r=o;continue e}o=l+1;continue e}if(e.slice(c-5,c)==="nostr"){const x=e.slice(c+60).match(noCharacter),f=x?c+60+x.index:n;try{let m,{data:E,type:g}=decode$j(e.slice(c+1,f));switch(g){case"npub":m={pubkey:E};break;case"nsec":case"note":o=f+1;continue;default:m=E}r!==c-5&&(yield{type:"text",text:e.slice(r,c-5)}),yield{type:"reference",pointer:m},o=f,r=o;continue e}catch{o=c+1;continue e}}else if(e.slice(c-5,c)==="https"||e.slice(c-4,c)==="http"){const x=e.slice(c+4).match(noURLCharacter),f=x?c+4+x.index:n,m=e[c-1]==="s"?5:4;try{let E=new URL(e.slice(c-m,f));if(E.hostname.indexOf(".")===-1)throw new Error("invalid url");if(r!==c-m&&(yield{type:"text",text:e.slice(r,c-m)}),/\.(png|jpe?g|gif|webp|heic|svg)$/i.test(E.pathname)){yield{type:"image",url:E.toString()},o=f,r=o;continue e}if(/\.(mp4|avi|webm|mkv|mov)$/i.test(E.pathname)){yield{type:"video",url:E.toString()},o=f,r=o;continue e}if(/\.(mp3|aac|ogg|opus|wav|flac)$/i.test(E.pathname)){yield{type:"audio",url:E.toString()},o=f,r=o;continue e}yield{type:"url",url:E.toString()},o=f,r=o;continue e}catch{o=f+1;continue e}}else if(e.slice(c-3,c)==="wss"||e.slice(c-2,c)==="ws"){const x=e.slice(c+4).match(noURLCharacter),f=x?c+4+x.index:n,m=e[c-1]==="s"?3:2;try{let E=new URL(e.slice(c-m,f));if(E.hostname.indexOf(".")===-1)throw new Error("invalid ws url");r!==c-m&&(yield{type:"text",text:e.slice(r,c-m)}),yield{type:"relay",url:E.toString()},o=f,r=o;continue e}catch{o=f+1;continue e}}else{for(let x=0;x<t.length;x++){const f=t[x];if(e[c+f.shortcode.length+1]===":"&&e.slice(c+1,c+f.shortcode.length+1)===f.shortcode){r!==c&&(yield{type:"text",text:e.slice(r,c)}),yield f,o=c+f.shortcode.length+2,r=o;continue e}}o=c+1;continue e}}r!==n&&(yield{type:"text",text:e.slice(r)})}var nip28_exports={};__export(nip28_exports,{channelCreateEvent:()=>channelCreateEvent,channelHideMessageEvent:()=>channelHideMessageEvent,channelMessageEvent:()=>channelMessageEvent,channelMetadataEvent:()=>channelMetadataEvent,channelMuteUserEvent:()=>channelMuteUserEvent});var channelCreateEvent=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return finalizeEvent({kind:ChannelCreation,tags:[...e.tags??[]],content:n,created_at:e.created_at},t)},channelMetadataEvent=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return finalizeEvent({kind:ChannelMetadata,tags:[["e",e.channel_create_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},channelMessageEvent=(e,t)=>{const n=[["e",e.channel_create_event_id,e.relay_url,"root"]];return e.reply_to_channel_message_event_id&&n.push(["e",e.reply_to_channel_message_event_id,e.relay_url,"reply"]),finalizeEvent({kind:ChannelMessage,tags:[...n,...e.tags??[]],content:e.content,created_at:e.created_at},t)},channelHideMessageEvent=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return finalizeEvent({kind:ChannelHideMessage,tags:[["e",e.channel_message_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},channelMuteUserEvent=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return finalizeEvent({kind:ChannelMuteUser,tags:[["p",e.pubkey_to_mute],...e.tags??[]],content:n,created_at:e.created_at},t)},nip30_exports={};__export(nip30_exports,{EMOJI_SHORTCODE_REGEX:()=>EMOJI_SHORTCODE_REGEX,matchAll:()=>matchAll,regex:()=>regex$2,replaceAll:()=>replaceAll});var EMOJI_SHORTCODE_REGEX=/:(\w+):/,regex$2=()=>new RegExp(`\\B${EMOJI_SHORTCODE_REGEX.source}\\B`,"g");function*matchAll(e){const t=e.matchAll(regex$2());for(const n of t)try{const[r,o]=n;yield{shortcode:r,name:o,start:n.index,end:n.index+r.length}}catch{}}function replaceAll(e,t){return e.replaceAll(regex$2(),(n,r)=>t({shortcode:n,name:r}))}var nip39_exports={};__export(nip39_exports,{useFetchImplementation:()=>useFetchImplementation3,validateGithub:()=>validateGithub});var _fetch3;try{_fetch3=fetch}catch{}function useFetchImplementation3(e){_fetch3=e}async function validateGithub(e,t,n){try{return await(await _fetch3(`https://gist.github.com/${t}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${e}`}catch{return!1}}var nip47_exports={};__export(nip47_exports,{makeNwcRequestEvent:()=>makeNwcRequestEvent,parseConnectionString:()=>parseConnectionString});function parseConnectionString(e){const{host:t,pathname:n,searchParams:r}=new URL(e),o=n||t,c=r.get("relay"),l=r.get("secret");if(!o||!c||!l)throw new Error("invalid connection string");return{pubkey:o,relay:c,secret:l}}async function makeNwcRequestEvent(e,t,n){const o=encrypt$2(t,e,JSON.stringify({method:"pay_invoice",params:{invoice:n}})),c={kind:NWCWalletRequest,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e]]};return finalizeEvent(c,t)}var nip54_exports={};__export(nip54_exports,{normalizeIdentifier:()=>normalizeIdentifier});function normalizeIdentifier(e){return e=e.trim().toLowerCase(),e=e.normalize("NFKC"),Array.from(e).map(t=>new RegExp("\\p{Letter}","u").test(t)||new RegExp("\\p{Number}","u").test(t)?t:"-").join("")}var nip57_exports={};__export(nip57_exports,{getSatoshisAmountFromBolt11:()=>getSatoshisAmountFromBolt11,getZapEndpoint:()=>getZapEndpoint,makeZapReceipt:()=>makeZapReceipt,makeZapRequest:()=>makeZapRequest,useFetchImplementation:()=>useFetchImplementation4,validateZapRequest:()=>validateZapRequest});var _fetch4;try{_fetch4=fetch}catch{}function useFetchImplementation4(e){_fetch4=e}async function getZapEndpoint(e){try{let t="",{lud06:n,lud16:r}=JSON.parse(e.content);if(r){let[l,x]=r.split("@");t=new URL(`/.well-known/lnurlp/${l}`,`https://${x}`).toString()}else if(n){let{words:l}=bech32.decode(n,1e3),x=bech32.fromWords(l);t=utf8Decoder$1.decode(x)}else return null;let c=await(await _fetch4(t)).json();if(c.allowsNostr&&c.nostrPubkey)return c.callback}catch{}return null}function makeZapRequest(e){let t={kind:9734,created_at:Math.round(Date.now()/1e3),content:e.comment||"",tags:[["p","pubkey"in e?e.pubkey:e.event.pubkey],["amount",e.amount.toString()],["relays",...e.relays]]};if("event"in e){if(t.tags.push(["e",e.event.id]),isReplaceableKind(e.event.kind)){const n=["a",`${e.event.kind}:${e.event.pubkey}:`];t.tags.push(n)}else if(isAddressableKind(e.event.kind)){let n=e.event.tags.find(([o,c])=>o==="d"&&c);if(!n)throw new Error("d tag not found or is empty");const r=["a",`${e.event.kind}:${e.event.pubkey}:${n[1]}`];t.tags.push(r)}t.tags.push(["k",e.event.kind.toString()])}return t}function validateZapRequest(e){let t;try{t=JSON.parse(e)}catch{return"Invalid zap request JSON."}if(!validateEvent(t))return"Zap request is not a valid Nostr event.";if(!verifyEvent(t))return"Invalid signature on zap request.";let n=t.tags.find(([c,l])=>c==="p"&&l);if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=t.tags.find(([c,l])=>c==="e"&&l);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find(([c,l])=>c==="relays"&&l)?null:"Zap request doesn't have a 'relays' tag."}function makeZapReceipt({zapRequest:e,preimage:t,bolt11:n,paidAt:r}){let o=JSON.parse(e),c=o.tags.filter(([x])=>x==="e"||x==="p"||x==="a"),l={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...c,["P",o.pubkey],["bolt11",n],["description",e]]};return t&&l.tags.push(["preimage",t]),l}function getSatoshisAmountFromBolt11(e){if(e.length<50)return 0;e=e.substring(0,50);const t=e.lastIndexOf("1");if(t===-1)return 0;const n=e.substring(0,t);if(!n.startsWith("lnbc"))return 0;const r=n.substring(4);if(r.length<1)return 0;const o=r[r.length-1],c=o.charCodeAt(0)-48,l=c>=0&&c<=9;let x=r.length-1;if(l&&x++,x<1)return 0;const f=parseInt(r.substring(0,x));switch(o){case"m":return f*1e5;case"u":return f*100;case"n":return f/10;case"p":return f/1e4;default:return f*1e8}}var nip77_exports={};__export(nip77_exports,{Negentropy:()=>Negentropy,NegentropyStorageVector:()=>NegentropyStorageVector,NegentropySync:()=>NegentropySync});var PROTOCOL_VERSION=97,ID_SIZE=32,FINGERPRINT_SIZE=16,Mode={Skip:0,Fingerprint:1,IdList:2},WrappedBuffer=class{_raw;length;constructor(e){typeof e=="number"?(this._raw=new Uint8Array(e),this.length=0):e instanceof Uint8Array?(this._raw=new Uint8Array(e),this.length=e.length):(this._raw=new Uint8Array(512),this.length=0)}unwrap(){return this._raw.subarray(0,this.length)}get capacity(){return this._raw.byteLength}extend(e){if(e instanceof WrappedBuffer&&(e=e.unwrap()),typeof e.length!="number")throw Error("bad length");const t=e.length+this.length;if(this.capacity<t){const n=this._raw,r=Math.max(this.capacity*2,t);this._raw=new Uint8Array(r),this._raw.set(n)}this._raw.set(e,this.length),this.length+=e.length}shift(){const e=this._raw[0];return this._raw=this._raw.subarray(1),this.length--,e}shiftN(e=1){const t=this._raw.subarray(0,e);return this._raw=this._raw.subarray(e),this.length-=e,t}};function decodeVarInt(e){let t=0;for(;;){if(e.length===0)throw Error("parse ends prematurely");let n=e.shift();if(t=t<<7|n&127,(n&128)===0)break}return t}function encodeVarInt(e){if(e===0)return new WrappedBuffer(new Uint8Array([0]));let t=[];for(;e!==0;)t.push(e&127),e>>>=7;t.reverse();for(let n=0;n<t.length-1;n++)t[n]|=128;return new WrappedBuffer(new Uint8Array(t))}function getByte(e){return getBytes(e,1)[0]}function getBytes(e,t){if(e.length<t)throw Error("parse ends prematurely");return e.shiftN(t)}var Accumulator=class{buf;constructor(){this.setToZero()}setToZero(){this.buf=new Uint8Array(ID_SIZE)}add(e){let t=0,n=0,r=new DataView(this.buf.buffer),o=new DataView(e.buffer);for(let c=0;c<8;c++){let l=c*4,x=r.getUint32(l,!0),f=o.getUint32(l,!0),m=x;m+=t,m+=f,m>4294967295&&(n=1),r.setUint32(l,m&4294967295,!0),t=n,n=0}}negate(){let e=new DataView(this.buf.buffer);for(let n=0;n<8;n++){let r=n*4;e.setUint32(r,~e.getUint32(r,!0))}let t=new Uint8Array(ID_SIZE);t[0]=1,this.add(t)}getFingerprint(e){let t=new WrappedBuffer;return t.extend(this.buf),t.extend(encodeVarInt(e)),sha256$2(t.unwrap()).subarray(0,FINGERPRINT_SIZE)}},NegentropyStorageVector=class{items;sealed;constructor(){this.items=[],this.sealed=!1}insert(e,t){if(this.sealed)throw Error("already sealed");const n=hexToBytes$3(t);if(n.byteLength!==ID_SIZE)throw Error("bad id size for added item");this.items.push({timestamp:e,id:n})}seal(){if(this.sealed)throw Error("already sealed");this.sealed=!0,this.items.sort(itemCompare);for(let e=1;e<this.items.length;e++)if(itemCompare(this.items[e-1],this.items[e])===0)throw Error("duplicate item inserted")}unseal(){this.sealed=!1}size(){return this._checkSealed(),this.items.length}getItem(e){if(this._checkSealed(),e>=this.items.length)throw Error("out of range");return this.items[e]}iterate(e,t,n){this._checkSealed(),this._checkBounds(e,t);for(let r=e;r<t&&n(this.items[r],r);++r);}findLowerBound(e,t,n){return this._checkSealed(),this._checkBounds(e,t),this._binarySearch(this.items,e,t,r=>itemCompare(r,n)<0)}fingerprint(e,t){let n=new Accumulator;return n.setToZero(),this.iterate(e,t,r=>(n.add(r.id),!0)),n.getFingerprint(t-e)}_checkSealed(){if(!this.sealed)throw Error("not sealed")}_checkBounds(e,t){if(e>t||t>this.items.length)throw Error("bad range")}_binarySearch(e,t,n,r){let o=n-t;for(;o>0;){let c=t,l=Math.floor(o/2);c+=l,r(e[c])?(t=++c,o-=l+1):o=l}return t}},Negentropy=class{storage;frameSizeLimit;lastTimestampIn;lastTimestampOut;constructor(e,t=6e4){if(t<4096)throw Error("frameSizeLimit too small");this.storage=e,this.frameSizeLimit=t,this.lastTimestampIn=0,this.lastTimestampOut=0}_bound(e,t){return{timestamp:e,id:t||new Uint8Array(0)}}initiate(){let e=new WrappedBuffer;return e.extend(new Uint8Array([PROTOCOL_VERSION])),this.splitRange(0,this.storage.size(),this._bound(Number.MAX_VALUE),e),bytesToHex$1(e.unwrap())}reconcile(e,t,n){const r=new WrappedBuffer(hexToBytes$3(e));this.lastTimestampIn=this.lastTimestampOut=0;let o=new WrappedBuffer;o.extend(new Uint8Array([PROTOCOL_VERSION]));let c=getByte(r);if(c<96||c>111)throw Error("invalid negentropy protocol version byte");if(c!==PROTOCOL_VERSION)throw Error("unsupported negentropy protocol version requested: "+(c-96));let l=this.storage.size(),x=this._bound(0),f=0,m=!1;for(;r.length!==0;){let E=new WrappedBuffer,g=()=>{m&&(m=!1,E.extend(this.encodeBound(x)),E.extend(encodeVarInt(Mode.Skip)))},y=this.decodeBound(r),w=decodeVarInt(r),v=f,_=this.storage.findLowerBound(f,l,y);if(w===Mode.Skip)m=!0;else if(w===Mode.Fingerprint){let F=getBytes(r,FINGERPRINT_SIZE),H=this.storage.fingerprint(v,_);compareUint8Array(F,H)!==0?(g(),this.splitRange(v,_,y,E)):m=!0}else if(w===Mode.IdList){let F=decodeVarInt(r),H={};for(let Y=0;Y<F;Y++){let T=getBytes(r,ID_SIZE);H[bytesToHex$1(T)]=T}if(m=!0,this.storage.iterate(v,_,Y=>{let T=Y.id;const L=bytesToHex$1(T);return H[L]?delete H[bytesToHex$1(T)]:t?.(L),!0}),n)for(let Y of Object.values(H))n(bytesToHex$1(Y))}else throw Error("unexpected mode");if(this.exceededFrameSizeLimit(o.length+E.length)){let F=this.storage.fingerprint(_,l);o.extend(this.encodeBound(this._bound(Number.MAX_VALUE))),o.extend(encodeVarInt(Mode.Fingerprint)),o.extend(F);break}else o.extend(E);f=_,x=y}return o.length===1?null:bytesToHex$1(o.unwrap())}splitRange(e,t,n,r){let o=t-e,c=16;if(o<c*2)r.extend(this.encodeBound(n)),r.extend(encodeVarInt(Mode.IdList)),r.extend(encodeVarInt(o)),this.storage.iterate(e,t,l=>(r.extend(l.id),!0));else{let l=Math.floor(o/c),x=o%c,f=e;for(let m=0;m<c;m++){let E=l+(m<x?1:0),g=this.storage.fingerprint(f,f+E);f+=E;let y;if(f===t)y=n;else{let w,v;this.storage.iterate(f-1,f+1,(_,F)=>(F===f-1?w=_:v=_,!0)),y=this.getMinimalBound(w,v)}r.extend(this.encodeBound(y)),r.extend(encodeVarInt(Mode.Fingerprint)),r.extend(g)}}}exceededFrameSizeLimit(e){return e>this.frameSizeLimit-200}decodeTimestampIn(e){let t=decodeVarInt(e);return t=t===0?Number.MAX_VALUE:t-1,this.lastTimestampIn===Number.MAX_VALUE||t===Number.MAX_VALUE?(this.lastTimestampIn=Number.MAX_VALUE,Number.MAX_VALUE):(t+=this.lastTimestampIn,this.lastTimestampIn=t,t)}decodeBound(e){let t=this.decodeTimestampIn(e),n=decodeVarInt(e);if(n>ID_SIZE)throw Error("bound key too long");let r=getBytes(e,n);return{timestamp:t,id:r}}encodeTimestampOut(e){if(e===Number.MAX_VALUE)return this.lastTimestampOut=Number.MAX_VALUE,encodeVarInt(0);let t=e;return e-=this.lastTimestampOut,this.lastTimestampOut=t,encodeVarInt(e+1)}encodeBound(e){let t=new WrappedBuffer;return t.extend(this.encodeTimestampOut(e.timestamp)),t.extend(encodeVarInt(e.id.length)),t.extend(e.id),t}getMinimalBound(e,t){if(t.timestamp!==e.timestamp)return this._bound(t.timestamp);{let n=0,r=t.id,o=e.id;for(let c=0;c<ID_SIZE&&r[c]===o[c];c++)n++;return this._bound(t.timestamp,t.id.subarray(0,n+1))}}};function compareUint8Array(e,t){for(let n=0;n<e.byteLength;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function itemCompare(e,t){return e.timestamp===t.timestamp?compareUint8Array(e.id,t.id):e.timestamp-t.timestamp}var NegentropySync=class{relay;storage;neg;filter;subscription;onhave;onneed;constructor(e,t,n,r={}){this.relay=e,this.storage=t,this.neg=new Negentropy(t),this.onhave=r.onhave,this.onneed=r.onneed,this.filter=n,this.subscription=this.relay.prepareSubscription([{}],{label:r.label||"negentropy"}),this.subscription.oncustom=o=>{switch(o[0]){case"NEG-MSG":{o.length<3&&console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${o}`);try{const c=this.neg.reconcile(o[2],this.onhave,this.onneed);c?this.relay.send(`["NEG-MSG", "${this.subscription.id}", "${c}"]`):(this.close(),r.onclose?.())}catch(c){console.error("negentropy reconcile error:",c),r?.onclose?.(`reconcile error: ${c}`)}break}case"NEG-CLOSE":{const c=o[2];console.warn("negentropy error:",c),r.onclose?.(c);break}case"NEG-ERR":r.onclose?.()}}}async start(){const e=this.neg.initiate();this.relay.send(`["NEG-OPEN","${this.subscription.id}",${JSON.stringify(this.filter)},"${e}"]`)}close(){this.relay.send(`["NEG-CLOSE","${this.subscription.id}"]`),this.subscription.close()}},nip98_exports={};__export(nip98_exports,{getToken:()=>getToken,hashPayload:()=>hashPayload,unpackEventFromToken:()=>unpackEventFromToken,validateEvent:()=>validateEvent2,validateEventKind:()=>validateEventKind,validateEventMethodTag:()=>validateEventMethodTag,validateEventPayloadTag:()=>validateEventPayloadTag,validateEventTimestamp:()=>validateEventTimestamp,validateEventUrlTag:()=>validateEventUrlTag,validateToken:()=>validateToken});var _authorizationScheme="Nostr ";async function getToken(e,t,n,r=!1,o){const c={kind:HTTPAuth,tags:[["u",e],["method",t]],created_at:Math.round(new Date().getTime()/1e3),content:""};o&&c.tags.push(["payload",hashPayload(o)]);const l=await n(c);return(r?_authorizationScheme:"")+base64.encode(utf8Encoder$1.encode(JSON.stringify(l)))}async function validateToken(e,t,n){const r=await unpackEventFromToken(e).catch(c=>{throw c});return await validateEvent2(r,t,n).catch(c=>{throw c})}async function unpackEventFromToken(e){if(!e)throw new Error("Missing token");e=e.replace(_authorizationScheme,"");const t=utf8Decoder$1.decode(base64.decode(e));if(!t||t.length===0||!t.startsWith("{"))throw new Error("Invalid token");return JSON.parse(t)}function validateEventTimestamp(e){return e.created_at?Math.round(new Date().getTime()/1e3)-e.created_at<60:!1}function validateEventKind(e){return e.kind===HTTPAuth}function validateEventUrlTag(e,t){const n=e.tags.find(r=>r[0]==="u");return n?n.length>0&&n[1]===t:!1}function validateEventMethodTag(e,t){const n=e.tags.find(r=>r[0]==="method");return n?n.length>0&&n[1].toLowerCase()===t.toLowerCase():!1}function hashPayload(e){const t=sha256$2(utf8Encoder$1.encode(JSON.stringify(e)));return bytesToHex$2(t)}function validateEventPayloadTag(e,t){const n=e.tags.find(o=>o[0]==="payload");if(!n)return!1;const r=hashPayload(t);return n.length>0&&n[1]===r}async function validateEvent2(e,t,n,r){if(!verifyEvent(e))throw new Error("Invalid nostr event, signature invalid");if(!validateEventKind(e))throw new Error("Invalid nostr event, kind invalid");if(!validateEventTimestamp(e))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!validateEventUrlTag(e,t))throw new Error("Invalid nostr event, url tag invalid");if(!validateEventMethodTag(e,n))throw new Error("Invalid nostr event, method tag invalid");if(r&&typeof r=="object"&&Object.keys(r).length>0&&!validateEventPayloadTag(e,r))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}class CryptoService{static isWebCryptoAvailable(){return!!(window.crypto&&window.crypto.subtle)}static simpleFallbackEncrypt(t,n){const r=this.hashPassword(n),o=[];for(let c=0;c<t.length;c++)o.push(t.charCodeAt(c)^r.charCodeAt(c%r.length));return btoa(JSON.stringify(o))}static simpleFallbackDecrypt(t,n){const r=this.hashPassword(n),o=JSON.parse(atob(t));let c="";for(let l=0;l<o.length;l++)c+=String.fromCharCode(o[l]^r.charCodeAt(l%r.length));return c}static hashPassword(t){let n=0;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);n=(n<<5)-n+o,n=n&n}return n.toString(36)+t}static async getPasswordKey(t){const n=new TextEncoder;return window.crypto.subtle.importKey("raw",n.encode(t),"PBKDF2",!1,["deriveKey"])}static async deriveKey(t,n){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}static async encrypt(t,n){if(!this.isWebCryptoAvailable())return console.warn("[Crypto] Using fallback encryption"),"FALLBACK:"+this.simpleFallbackEncrypt(t,n);const r=window.crypto.getRandomValues(new Uint8Array(16)),o=window.crypto.getRandomValues(new Uint8Array(12)),c=await this.getPasswordKey(n),l=await this.deriveKey(c,r),x=new TextEncoder,f=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},l,x.encode(t)),m=new Uint8Array(f),E=new Uint8Array(r.length+o.length+m.length);return E.set(r,0),E.set(o,r.length),E.set(m,r.length+o.length),btoa(String.fromCharCode(...E))}static async decrypt(t,n){if(t.startsWith("FALLBACK:"))return this.simpleFallbackDecrypt(t.substring(9),n);const r=atob(t),o=new Uint8Array(r.length);for(let y=0;y<r.length;y++)o[y]=r.charCodeAt(y);const c=o.slice(0,16),l=o.slice(16,28),x=o.slice(28),f=await this.getPasswordKey(n),m=await this.deriveKey(f,c),E=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:l},m,x);return new TextDecoder().decode(E)}static generateMnemonic(t=12){return generateMnemonic(wordlist,t===12?128:256)}static validateMnemonic(t){return validateMnemonic(t,wordlist)}static deriveKeypair(t,n){const r=mnemonicToSeedSync(t),o=`m/44'/1237'/0'/0/${n}`,c=HDKey.fromMasterSeed(r).derive(o);if(!c.privateKey)throw new Error("Failed to derive private key");const l=Array.from(c.privateKey).map(f=>f.toString(16).padStart(2,"0")).join(""),x=getPublicKey(c.privateKey);return{nsec:nip19_exports$1.nsecEncode(c.privateKey),npub:nip19_exports$1.npubEncode(x),path:o,privateKeyHex:l}}static nsecToHex(t){const n=nip19_exports$1.decode(t);if(n.type!=="nsec")throw new Error("Invalid nsec format");const r=n.data;return Array.from(r).map(o=>o.toString(16).padStart(2,"0")).join("")}static nsecToNpub(t){const n=nip19_exports$1.decode(t);if(n.type!=="nsec")throw new Error("Invalid nsec format");const r=n.data,o=getPublicKey(r);return nip19_exports$1.npubEncode(o)}}const crypto$3=Object.freeze(Object.defineProperty({__proto__:null,CryptoService},Symbol.toStringTag,{value:"Module"}));const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),toPascalCase=e=>{const t=toCamelCase(e);return t.charAt(0).toUpperCase()+t.slice(1)},mergeClasses=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),hasA11yProp=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Icon=reactExports.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:c,iconNode:l,...x},f)=>reactExports.createElement("svg",{ref:f,...defaultAttributes,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:mergeClasses("lucide",o),...!c&&!hasA11yProp(x)&&{"aria-hidden":"true"},...x},[...l.map(([m,E])=>reactExports.createElement(m,E)),...Array.isArray(c)?c:[c]]));const createLucideIcon=(e,t)=>{const n=reactExports.forwardRef(({className:r,...o},c)=>reactExports.createElement(Icon,{ref:c,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(e))}`,`lucide-${e}`,r),...o}));return n.displayName=toPascalCase(e),n};const __iconNode$F=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],ArrowDownLeft=createLucideIcon("arrow-down-left",__iconNode$F);const __iconNode$E=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ArrowLeft=createLucideIcon("arrow-left",__iconNode$E);const __iconNode$D=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],ArrowRightLeft=createLucideIcon("arrow-right-left",__iconNode$D);const __iconNode$C=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ArrowRight=createLucideIcon("arrow-right",__iconNode$C);const __iconNode$B=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ArrowUpDown=createLucideIcon("arrow-up-down",__iconNode$B);const __iconNode$A=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],ArrowUpRight=createLucideIcon("arrow-up-right",__iconNode$A);const __iconNode$z=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Check=createLucideIcon("check",__iconNode$z);const __iconNode$y=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],CircleAlert=createLucideIcon("circle-alert",__iconNode$y);const __iconNode$x=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CircleCheckBig=createLucideIcon("circle-check-big",__iconNode$x);const __iconNode$w=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],CircleX=createLucideIcon("circle-x",__iconNode$w);const __iconNode$v=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Copy=createLucideIcon("copy",__iconNode$v);const __iconNode$u=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Download=createLucideIcon("download",__iconNode$u);const __iconNode$t=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ExternalLink=createLucideIcon("external-link",__iconNode$t);const __iconNode$s=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],EyeOff=createLucideIcon("eye-off",__iconNode$s);const __iconNode$r=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Eye=createLucideIcon("eye",__iconNode$r);const __iconNode$q=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],FileBraces=createLucideIcon("file-braces",__iconNode$q);const __iconNode$p=[["path",{d:"m18.226 5.226-2.52-2.52A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-.351",key:"1k2beg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]],FilePenLine=createLucideIcon("file-pen-line",__iconNode$p);const __iconNode$o=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Heart=createLucideIcon("heart",__iconNode$o);const __iconNode$n=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],KeyRound=createLucideIcon("key-round",__iconNode$n);const __iconNode$m=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Key=createLucideIcon("key",__iconNode$m);const __iconNode$l=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Link2=createLucideIcon("link-2",__iconNode$l);const __iconNode$k=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],LoaderCircle=createLucideIcon("loader-circle",__iconNode$k);const __iconNode$j=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Loader=createLucideIcon("loader",__iconNode$j);const __iconNode$i=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Lock=createLucideIcon("lock",__iconNode$i);const __iconNode$h=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],LogIn=createLucideIcon("log-in",__iconNode$h);const __iconNode$g=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],LogOut=createLucideIcon("log-out",__iconNode$g);const __iconNode$f=[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]],Notebook=createLucideIcon("notebook",__iconNode$f);const __iconNode$e=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Pen=createLucideIcon("pen",__iconNode$e);const __iconNode$d=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Plus=createLucideIcon("plus",__iconNode$d);const __iconNode$c=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],QrCode=createLucideIcon("qr-code",__iconNode$c);const __iconNode$b=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],RefreshCw=createLucideIcon("refresh-cw",__iconNode$b);const __iconNode$a=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Save=createLucideIcon("save",__iconNode$a);const __iconNode$9=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Settings=createLucideIcon("settings",__iconNode$9);const __iconNode$8=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],ShieldAlert=createLucideIcon("shield-alert",__iconNode$8);const __iconNode$7=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Shield=createLucideIcon("shield",__iconNode$7);const __iconNode$6=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Trash2=createLucideIcon("trash-2",__iconNode$6);const __iconNode$5=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],TriangleAlert=createLucideIcon("triangle-alert",__iconNode$5);const __iconNode$4=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],User=createLucideIcon("user",__iconNode$4);const __iconNode$3=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Wallet=createLucideIcon("wallet",__iconNode$3);const __iconNode$2=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],WifiOff=createLucideIcon("wifi-off",__iconNode$2);const __iconNode$1=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Wifi=createLucideIcon("wifi",__iconNode$1);const __iconNode=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X=createLucideIcon("x",__iconNode),Toast=({message:e,type:t,isOpen:n,onClose:r,duration:o=3e3})=>{if(reactExports.useEffect(()=>{if(n&&o>0){const x=setTimeout(r,o);return()=>clearTimeout(x)}},[n,o,r]),!n)return null;const c={success:jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5 text-green-500"}),error:jsxRuntimeExports.jsx(CircleX,{className:"w-5 h-5 text-red-500"}),info:jsxRuntimeExports.jsx(CircleAlert,{className:"w-5 h-5 text-blue-500"})},l={success:"bg-green-500/10 border-green-500/20 text-green-400",error:"bg-red-500/10 border-red-500/20 text-red-400",info:"bg-blue-500/10 border-blue-500/20 text-blue-400"};return jsxRuntimeExports.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-top-2",children:jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-3 p-4 rounded-lg border ${l[t]} shadow-lg max-w-md`,children:[c[t],jsxRuntimeExports.jsx("p",{className:"flex-1 text-sm font-medium",children:e}),jsxRuntimeExports.jsx("button",{onClick:r,className:"text-current opacity-70 hover:opacity-100 transition-opacity",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})]})})},CreateWallet=({onBack:e,onComplete:t})=>{const[n,r]=reactExports.useState("type"),[o,c]=reactExports.useState(""),[l,x]=reactExports.useState(""),[f,m]=reactExports.useState(""),[E,g]=reactExports.useState(""),[y,w]=reactExports.useState(!1),[v,_]=reactExports.useState(null),[F,H]=reactExports.useState(!1),[Y,T]=reactExports.useState(!1),[L,N]=reactExports.useState(null),{addWallet:I,setCurrentWallet:U,setCurrentKeypair:W}=useWalletStore(),{unlock:O}=useAuthStore(),Z=$=>{const M=CryptoService.generateMnemonic($);c(M),r("mnemonic")},z=()=>{navigator.clipboard.writeText(o),w(!0),setTimeout(()=>w(!1),2e3)},q=async $=>{if($.preventDefault(),_(null),f!==E){_("Passwords do not match");return}if(f.length<8){_("Password must be at least 8 characters");return}H(!0);try{const M=await CryptoService.encrypt(o,f),{nsec:S,npub:R,path:D,privateKeyHex:j}=CryptoService.deriveKeypair(o,0),P=await CryptoService.encrypt(S,f),Q=crypto.randomUUID(),C=crypto.randomUUID(),K={id:C,walletId:Q,name:"Main Account",derivationPath:D,encryptedNsec:P,npub:R,createdAt:Date.now(),connections:[]},J={id:Q,name:l||"My Address Book",type:"mnemonic",encryptedSeed:M,createdAt:Date.now(),keypairs:[K]};I(J),U(Q),W(C),O(j),t()}catch(M){console.error(M),_("Failed to create wallet")}finally{H(!1)}};return jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:e,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),n==="type"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Create New Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Choose the security level for your new address book."})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>Z(12),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"12 Words"}),jsxRuntimeExports.jsx(Shield,{className:"w-5 h-5 text-amber-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Standard security. Easier to write down and remember."})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Z(24),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"24 Words"}),jsxRuntimeExports.jsx(Shield,{className:"w-5 h-5 text-green-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Maximum security. Recommended for large amounts."})]})]})]}),n==="mnemonic"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Backup Your Seed"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm",children:"Write down these words in order. This is the ONLY way to recover your address book."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 relative group",children:[jsxRuntimeExports.jsx("div",{className:`grid grid-cols-3 gap-2 ${Y?"":"blur-sm select-none"}`,children:o.split(" ").map(($,M)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 p-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500 text-xs w-4",children:[M+1,"."]}),jsxRuntimeExports.jsx("span",{className:"font-mono font-medium text-amber-50",children:$})]},M))}),jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>T(!Y),className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:Y?"Hide seed phrase":"Show seed phrase",children:Y?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4 text-slate-400"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("button",{onClick:z,className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:"Copy to clipboard",children:y?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 flex items-start gap-3",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:"Do not share these words with anyone. Anyone with these words can steal your funds and identity."})]}),jsxRuntimeExports.jsx("button",{onClick:()=>r("encrypt"),className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors",children:"Continue "})]}),n==="encrypt"&&jsxRuntimeExports.jsxs("form",{onSubmit:q,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Secure Your Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Set a name and password for this device."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Address Book Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:l,onChange:$=>x($.target.value),placeholder:"e.g. Main Address Book",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:f,onChange:$=>m($.target.value),placeholder:"At least 8 characters",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0,minLength:8})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Confirm Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:E,onChange:$=>g($.target.value),placeholder:"Repeat password",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]})]}),v&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:v}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:async()=>{if(!f||f.length<8){N({message:"Please enter a valid password (at least 8 characters)",type:"error"});return}if(f!==E){N({message:"Passwords do not match",type:"error"});return}try{const $=await CryptoService.encrypt(o,f),M=JSON.stringify({wallet:l||"My Wallet",encrypted:$,timestamp:Date.now()},null,2),S=new Blob([M],{type:"application/json"}),R=URL.createObjectURL(S),D=document.createElement("a");D.href=R,D.download=`${(l||"wallet").toLowerCase().replace(/\s+/g,"-")}-backup-encrypted.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(R),N({message:"Encrypted backup downloaded successfully!",type:"success"})}catch($){console.error("Failed to create backup:",$),N({message:"Failed to create encrypted backup",type:"error"})}},className:"w-full py-3 px-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors border border-slate-700 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),"Download Encrypted Backup"]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:F,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:F?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Address Book..."]}):"Create Address Book"})]})]}),L&&jsxRuntimeExports.jsx(Toast,{message:L.message,type:L.type,isOpen:!!L,onClose:()=>N(null)})]})},ImportWallet=({onBack:e,onComplete:t})=>{const[n,r]=reactExports.useState("method"),[o,c]=reactExports.useState(""),[l,x]=reactExports.useState(null),[f,m]=reactExports.useState(null),[E,g]=reactExports.useState(""),[y,w]=reactExports.useState(""),[v,_]=reactExports.useState(""),[F,H]=reactExports.useState(null),[Y,T]=reactExports.useState(!1),{addWallet:L,setCurrentWallet:N,setCurrentKeypair:I,updateKeypair:U,wallets:W}=useWalletStore(),{unlock:O}=useAuthStore(),Z=()=>{const $=o.trim();if($.includes(" "))if(CryptoService.validateMnemonic($)){x("mnemonic"),r("encrypt"),H(null);return}else{H("Invalid mnemonic phrase");return}if($.startsWith("nsec"))try{const{type:M}=nip19_exports$1.decode($);if(M==="nsec"){x("nsec"),r("encrypt"),H(null);return}}catch{}H("Invalid input. Please enter a valid mnemonic phrase or nsec.")},z=async $=>{const M=$.target.files?.[0];if(M)try{const S=await M.text(),R=JSON.parse(S);if(!R.wallet||!R.encrypted||!R.timestamp){H("Invalid backup file format");return}m(R),g(R.wallet),x("encrypted"),r("encrypt"),H(null)}catch(S){console.error("Failed to read backup file:",S),H("Failed to read backup file. Make sure it's a valid encrypted backup.")}},q=async $=>{if($.preventDefault(),H(null),l!=="encrypted"){if(y!==v){H("Passwords do not match");return}if(y.length<8){H("Password must be at least 8 characters");return}}T(!0);try{const M=crypto.randomUUID(),S=crypto.randomUUID();let R,D;if(l==="encrypted"&&f){const j=await CryptoService.decrypt(f.encrypted,y);if(j.includes(" ")){const Q=j,{nsec:C,npub:K,path:J,privateKeyHex:ne}=CryptoService.deriveKeypair(Q,0);if(W.some(ce=>ce.keypairs.some(ue=>ue.npub===K))){H("Wallet already exists"),T(!1);return}const re=await CryptoService.encrypt(C,y);D=ne;const ie={id:S,walletId:M,name:"Main Account",derivationPath:J,encryptedNsec:re,npub:K,createdAt:Date.now(),connections:[]};R={id:M,name:E||f.wallet,type:"mnemonic",encryptedSeed:f.encrypted,createdAt:f.timestamp,keypairs:[ie]}}else{const Q=j,C=CryptoService.nsecToNpub(Q);if(W.some(ne=>ne.keypairs.some(re=>re.npub===C))){H("Wallet already exists"),T(!1);return}const K=await CryptoService.encrypt(Q,y);D=CryptoService.nsecToHex(Q);const J={id:S,walletId:M,name:"Main Account",encryptedNsec:K,npub:C,createdAt:Date.now(),connections:[]};R={id:M,name:E||f.wallet,type:"imported",createdAt:f.timestamp,keypairs:[J]}}}else if(l==="mnemonic"){const j=o.trim(),P=await CryptoService.encrypt(j,y),{nsec:Q,npub:C,path:K,privateKeyHex:J}=CryptoService.deriveKeypair(j,0);if(W.some(ie=>ie.keypairs.some(ce=>ce.npub===C))){H("Wallet already exists"),T(!1);return}const ne=await CryptoService.encrypt(Q,y);D=J;const re={id:S,walletId:M,name:"Main Account",derivationPath:K,encryptedNsec:ne,npub:C,createdAt:Date.now(),connections:[]};R={id:M,name:E||"Imported Wallet",type:"mnemonic",encryptedSeed:P,createdAt:Date.now(),keypairs:[re]}}else{const j=o.trim(),P=CryptoService.nsecToNpub(j);if(W.some(K=>K.keypairs.some(J=>J.npub===P))){H("Wallet already exists"),T(!1);return}const Q=await CryptoService.encrypt(j,y);D=CryptoService.nsecToHex(j);const C={id:S,walletId:M,name:"Main Account",encryptedNsec:Q,npub:P,createdAt:Date.now(),connections:[]};R={id:M,name:E||"Imported Wallet",type:"imported",createdAt:Date.now(),keypairs:[C]}}L(R),N(M),I(S),setTimeout(async()=>{try{const{ProfileService:j}=await __vitePreload(async()=>{const{ProfileService:Q}=await Promise.resolve().then(()=>profile);return{ProfileService:Q}},void 0,import.meta.url),P=await j.fetchProfile(R.keypairs[0].npub);P&&U(M,S,{profile:{...P,lastFetched:Date.now()}})}catch(j){console.error("Failed to fetch profile for imported wallet:",j)}},100),O(D),t()}catch(M){console.error(M),H(l==="encrypted"?"Incorrect password. Failed to decrypt backup.":"Failed to import wallet")}finally{T(!1)}};return jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{n==="method"?e():r(n==="encrypt"?l==="encrypted"?"method":"input":"method")},className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),n==="method"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Import Wallet"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Choose how you want to import your wallet."})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>r("input"),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"Recovery Phrase / Private Key"}),jsxRuntimeExports.jsx(KeyRound,{className:"w-5 h-5 text-amber-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Import using your 12/24 word seed phrase or nsec."})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{document.getElementById("backup-file-input")?.click()},className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group relative",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"Encrypted Backup File"}),jsxRuntimeExports.jsx(FileBraces,{className:"w-5 h-5 text-blue-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Import from a previously exported JSON backup file."}),jsxRuntimeExports.jsx("input",{id:"backup-file-input",type:"file",accept:".json",onChange:z,className:"hidden"})]})]}),F&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:F})]}),n==="input"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Enter Credentials"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Enter your recovery phrase or private key (nsec)."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("textarea",{value:o,onChange:$=>c($.target.value),placeholder:"word1 word2 word3... OR nsec1...",className:"w-full h-32 bg-slate-900 border border-slate-800 rounded-xl p-4 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm resize-none"}),F&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 p-3 rounded-lg border border-red-500/20",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),F]}),jsxRuntimeExports.jsx("button",{onClick:Z,disabled:!o.trim(),className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"})]})]}),n==="encrypt"&&jsxRuntimeExports.jsxs("form",{onSubmit:q,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:l==="encrypted"?"Decrypt Backup":"Secure Your Wallet"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:l==="encrypted"?"Enter the password used to encrypt this backup.":"Set a name and password for this device."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Wallet Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:E,onChange:$=>g($.target.value),placeholder:"e.g. Main Wallet",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:l==="encrypted"?"Backup Password":"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:y,onChange:$=>w($.target.value),placeholder:l==="encrypted"?"Enter backup password":"At least 8 characters",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0,minLength:l==="encrypted"?1:8})]}),l!=="encrypted"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Confirm Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:v,onChange:$=>_($.target.value),placeholder:"Repeat password",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]})]}),F&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:F}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:Y,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:Y?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),l==="encrypted"?"Decrypting...":"Importing..."]}):l==="encrypted"?"Decrypt & Import":"Import Wallet"})]})]})},Login=()=>{const{unlock:e}=useAuthStore(),{wallets:t,currentWalletId:n,setCurrentWallet:r}=useWalletStore(),[o,c]=reactExports.useState("login"),[l,x]=reactExports.useState(""),[f,m]=reactExports.useState(null),[E,g]=reactExports.useState(!1),[y,w]=reactExports.useState(""),[v,_]=reactExports.useState(!1);reactExports.useEffect(()=>{t.length===0||(n&&t.find(H=>H.id===n)?w(n):t.length>0&&w(t[0].id))},[t,n]);const F=async H=>{H.preventDefault(),m(null),g(!0);try{const Y=t.find(I=>I.id===y);if(!Y)throw new Error("Wallet not found");const T=Y.keypairs[0];if(!T)throw new Error("No keypairs in wallet");const L=await CryptoService.decrypt(T.encryptedNsec,l),N=CryptoService.nsecToHex(L);r(Y.id),e(N,l)}catch(Y){console.error(Y),m("Invalid password")}finally{g(!1)}};return o==="create"?jsxRuntimeExports.jsx(CreateWallet,{onBack:()=>c("login"),onComplete:()=>{}}):o==="import"?jsxRuntimeExports.jsx(ImportWallet,{onBack:()=>c("login"),onComplete:()=>{}}):t.length===0?jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 p-4",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md bg-slate-900 rounded-2xl p-8 shadow-xl border border-slate-800 text-center",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"PWANS Logo",className:"w-24 h-24 rounded-full"})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 mb-8",children:"Your secure Nostr signer. Create a new address book or import an existing one to get started."}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>c("create"),className:"w-full py-4 px-6 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-3",children:[jsxRuntimeExports.jsx(Plus,{className:"w-5 h-5"}),"Create New Address Book"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>c("import"),className:"w-full py-4 px-6 bg-slate-800 hover:bg-slate-700 text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-3",children:[jsxRuntimeExports.jsx(Download,{className:"w-5 h-5"}),"Import Address Book"]})]})]})}):jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 p-4",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md bg-slate-900 rounded-2xl p-8 shadow-xl border border-slate-800",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsx("div",{className:"p-4 bg-amber-500/10 rounded-full",children:jsxRuntimeExports.jsx(Lock,{className:"w-8 h-8 text-amber-500"})})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-center mb-2",children:"Unlock Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-center mb-8",children:"Enter your password to access your keys"}),jsxRuntimeExports.jsxs("form",{onSubmit:F,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Select Address Book"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>_(!v),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all text-left flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{children:t.find(H=>H.id===y)?.name||"Select..."}),jsxRuntimeExports.jsx("svg",{className:`w-5 h-5 transition-transform ${v?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),v&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 w-full mt-2 bg-slate-900 border border-slate-800 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:t.map(H=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{w(H.id),_(!1)},className:`w-full px-4 py-3 text-left hover:bg-slate-800 transition-colors ${y===H.id?"bg-amber-500/10 text-amber-500":"text-white"}`,children:H.name},H.id))})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:l,onChange:H=>x(H.target.value),inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"",required:!0})]}),f&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-400/10 p-3 rounded-lg",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"w-4 h-4"}),f]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:E,className:"w-full bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:E?"Unlocking...":jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LogIn,{className:"w-4 h-4"}),"Unlock"]})}),jsxRuntimeExports.jsxs("div",{className:"pt-4 border-t border-slate-800 flex justify-center gap-4 text-sm",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>c("create"),className:"text-slate-400 hover:text-amber-500 transition-colors",children:"Create New"}),jsxRuntimeExports.jsx("span",{className:"text-slate-600",children:"|"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>c("import"),className:"text-slate-400 hover:text-amber-500 transition-colors",children:"Import"})]})]})]})})},useRequestStore=create(e=>({requests:[],addRequest:t=>e(n=>({requests:[...n.requests,t]})),removeRequest:t=>e(n=>({requests:n.requests.filter(r=>r.id!==t)})),clearRequests:()=>e({requests:[]})})),useConnectionsStore=create()(persist((e,t)=>({connections:[],autoApprovalRules:[],addConnection:n=>e(r=>({connections:[...r.connections,n]})),updateConnectionStatus:(n,r)=>e(o=>({connections:o.connections.map(c=>c.id===n?{...c,status:r}:c)})),updateConnection:(n,r)=>e(o=>({connections:o.connections.map(c=>c.id===n?{...c,...r}:c)})),removeConnection:n=>e(r=>({connections:r.connections.filter(o=>o.id!==n),autoApprovalRules:r.autoApprovalRules.filter(o=>o.connectionId!==n)})),getConnection:n=>t().connections.find(r=>r.id===n),addRule:n=>e(r=>{console.log("[ConnectionsStore] addRule called with:",n),console.log("[ConnectionsStore] Current rules before add:",r.autoApprovalRules);const o=[...r.autoApprovalRules,n];return console.log("[ConnectionsStore] New rules after add:",o),{autoApprovalRules:o}}),removeRule:n=>e(r=>({autoApprovalRules:r.autoApprovalRules.filter(o=>o.id!==n)})),getRulesForConnection:n=>t().autoApprovalRules.filter(r=>r.connectionId===n)}),{name:"amber-connections",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-DZK393HN.js");return{storage:n}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:n}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-DZK393HN.js");return{storage:r}},[],import.meta.url);return n.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-DZK393HN.js");return{storage:n}},[],import.meta.url);return t.removeItem(e)}}))}));var lib$1={},types={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0})),types}var ee={},taskCollection$1={},taskCollection={},utils$6={},hasRequiredUtils$6;function requireUtils$6(){if(hasRequiredUtils$6)return utils$6;hasRequiredUtils$6=1,Object.defineProperty(utils$6,"__esModule",{value:!0}),utils$6._fast_remove_single=void 0;function e(t,n){n!==-1&&(n===0?t.shift():n===t.length-1?t.length=t.length-1:t.splice(n,1))}return utils$6._fast_remove_single=e,utils$6}var bakeCollection={},hasRequiredBakeCollection;function requireBakeCollection(){return hasRequiredBakeCollection||(hasRequiredBakeCollection=1,(function(exports$1){Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.bakeCollectionVariadic=exports$1.bakeCollectionAwait=exports$1.bakeCollection=exports$1.BAKED_EMPTY_FUNC=void 0,exports$1.BAKED_EMPTY_FUNC=(function(){});var FORLOOP_FALLBACK=1500;function generateArgsDefCode(e){var t="";if(e===0)return t;for(var n=0;n<e-1;++n)t+="arg"+String(n)+", ";return t+="arg"+String(e-1),t}function generateBodyPartsCode(e,t){for(var n="",r="",o=0;o<t;++o)n+="var f".concat(o," = collection[").concat(o,`];
`),r+="f".concat(o,"(").concat(e,`)
`);return{funcDefCode:n,funcCallCode:r}}function generateBodyPartsVariadicCode(e){for(var t="",n="",r=0;r<e;++r)t+="var f".concat(r," = collection[").concat(r,`];
`),n+="f".concat(r,`.apply(undefined, arguments)
`);return{funcDefCode:t,funcCallCode:n}}function bakeCollection(collection,fixedArgsNum){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                `).concat(funcCallCode,`
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);collection.length%10===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 10) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                        collection[i+4](`).concat(argsDefCode,`);
                        collection[i+5](`).concat(argsDefCode,`);
                        collection[i+6](`).concat(argsDefCode,`);
                        collection[i+7](`).concat(argsDefCode,`);
                        collection[i+8](`).concat(argsDefCode,`);
                        collection[i+9](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%4===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 4) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%3===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 3) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                    }
                });
            })`):funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; ++i) {
                        collection[i](`).concat(argsDefCode,`);
                    }
                });
            })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollection=bakeCollection;function bakeCollectionAwait(collection,fixedArgsNum){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                return Promise.all([ `).concat(funcCallCode,` ]);
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=`(function(collection) {
            return (function(`.concat(argsDefCode,`) {
                var promises = Array(collection.length);
                for (var i = 0; i < collection.length; ++i) {
                    promises[i] = collection[i](`).concat(argsDefCode,`);
                }
                return Promise.all(promises);
            });
        })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollectionAwait=bakeCollectionAwait;function bakeCollectionVariadic(collection){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function() {
                `).concat(funcCallCode,`
            });
        })`)}else funcFactoryCode=`(function(collection) {
            return (function() {
                for (var i = 0; i < collection.length; ++i) {
                    collection[i].apply(undefined, arguments);
                }
            });
        })`;{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollectionVariadic=bakeCollectionVariadic})(bakeCollection)),bakeCollection}var hasRequiredTaskCollection$1;function requireTaskCollection$1(){if(hasRequiredTaskCollection$1)return taskCollection;hasRequiredTaskCollection$1=1;var e=taskCollection&&taskCollection.__spreadArray||function(T,L,N){if(N||arguments.length===2)for(var I=0,U=L.length,W;I<U;I++)(W||!(I in L))&&(W||(W=Array.prototype.slice.call(L,0,I)),W[I]=L[I]);return T.concat(W||Array.prototype.slice.call(L))};Object.defineProperty(taskCollection,"__esModule",{value:!0}),taskCollection.TaskCollection=void 0;var t=requireUtils$6(),n=requireBakeCollection();function r(T,L){var N=this.length;if(N>1)if(L){var I;(I=this._tasks).push.apply(I,arguments),this.length+=arguments.length}else this._tasks.push(T),this.length++;else if(L){if(N===1){var U=Array(1+arguments.length);U.push(U),U.push.apply(U,arguments),this._tasks=U}else{var U=Array(arguments.length);U.push.apply(U,arguments),this._tasks=U}this.length+=arguments.length}else N===1?this._tasks=[this._tasks,T]:this._tasks=T,this.length++}function o(T,L){var N=this.length;if(N>1)if(L){var I;(I=this._tasks).push.apply(I,arguments),this.length+=arguments.length}else this._tasks.push(T),this.length++;else if(L){if(N===1){var U=Array(1+arguments.length);U.push(U),U.push.apply(U,arguments),this._tasks=U}else{var U=Array(arguments.length);U.push.apply(U,arguments),this._tasks=U}this.length+=arguments.length}else N===1?this._tasks=[this._tasks,T]:this._tasks=T,this.length++;this.firstEmitBuildStrategy?this.call=g:this.rebuild()}function c(T){this.length!==0&&(this.length===1?this._tasks===T&&(this.length=0):((0,t._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(T)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function l(T){if(this.length!==0){if(this.length===1)if(this._tasks===T&&(this.length=0),this.firstEmitBuildStrategy){this.call=n.BAKED_EMPTY_FUNC;return}else{this.rebuild();return}else(0,t._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(T)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length;this.firstEmitBuildStrategy?this.call=g:this.rebuild()}}function x(T){for(var L,N=[],I=1;I<arguments.length;I++)N[I-1]=arguments[I];this.length===0?(this._tasks=N,this.length=1):this.length===1?(N.unshift(this._tasks),this._tasks=N,this.length=this._tasks.length):((L=this._tasks).splice.apply(L,e([T,0],N,!1)),this.length=this._tasks.length)}function f(T){for(var L,N=[],I=1;I<arguments.length;I++)N[I-1]=arguments[I];this.length===0?(this._tasks=N,this.length=1):this.length===1?(N.unshift(this._tasks),this._tasks=N,this.length=this._tasks.length):((L=this._tasks).splice.apply(L,e([T,0],N,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=g:this.rebuild()}function m(){this.length===0?this.call=n.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,n.bakeCollection)(this._tasks,this.argsNum)}function E(){this.length===0?this.call=n.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,n.bakeCollectionAwait)(this._tasks,this.argsNum)}function g(){this.rebuild(),this.call.apply(void 0,arguments)}var y=(function(){function T(L,N,I,U){N===void 0&&(N=!0),I===void 0&&(I=null),U===void 0&&(U=!1),this.awaitTasks=U,this.call=n.BAKED_EMPTY_FUNC,this.argsNum=L,this.firstEmitBuildStrategy=!0,U?this.rebuild=E.bind(this):this.rebuild=m.bind(this),this.setAutoRebuild(N),I?typeof I=="function"?(this._tasks=I,this.length=1):(this._tasks=I,this.length=I.length):(this._tasks=null,this.length=0),N&&this.rebuild()}return T})();taskCollection.TaskCollection=y;function w(){this._tasks=null,this.length=0,this.call=n.BAKED_EMPTY_FUNC}function v(){this._tasks=null,this.length=0,this.call=n.BAKED_EMPTY_FUNC}function _(T){this.argsNum<T&&(this.argsNum=T,this.firstEmitBuildStrategy?this.call=g:this.rebuild())}function F(T){T?(this.push=o.bind(this),this.insert=f.bind(this),this.removeLast=l.bind(this)):(this.push=r.bind(this),this.insert=x.bind(this),this.removeLast=c.bind(this))}function H(){return this.length===0?[]:this.length===1?[this._tasks]:this._tasks}function Y(T){T.length===0?(this.length=0,this.call=n.BAKED_EMPTY_FUNC):T.length===1?(this.length=1,this.call=T[0],this._tasks=T[0]):(this.length=T.length,this._tasks=T,this.firstEmitBuildStrategy?this.call=g:this.rebuild())}return y.prototype.fastClear=w,y.prototype.clear=v,y.prototype.growArgsNum=_,y.prototype.setAutoRebuild=F,y.prototype.tasksAsArray=H,y.prototype.setTasks=Y,taskCollection}var hasRequiredTaskCollection;function requireTaskCollection(){return hasRequiredTaskCollection||(hasRequiredTaskCollection=1,(function(e){var t=taskCollection$1&&taskCollection$1.__createBinding||(Object.create?(function(r,o,c,l){l===void 0&&(l=c);var x=Object.getOwnPropertyDescriptor(o,c);(!x||("get"in x?!o.__esModule:x.writable||x.configurable))&&(x={enumerable:!0,get:function(){return o[c]}}),Object.defineProperty(r,l,x)}):(function(r,o,c,l){l===void 0&&(l=c),r[l]=o[c]})),n=taskCollection$1&&taskCollection$1.__exportStar||function(r,o){for(var c in r)c!=="default"&&!Object.prototype.hasOwnProperty.call(o,c)&&t(o,r,c)};Object.defineProperty(e,"__esModule",{value:!0}),n(requireTaskCollection$1(),e)})(taskCollection$1)),taskCollection$1}var utils$5={},hasRequiredUtils$5;function requireUtils$5(){if(hasRequiredUtils$5)return utils$5;hasRequiredUtils$5=1,Object.defineProperty(utils$5,"__esModule",{value:!0}),utils$5.nullObj=void 0;function e(){var t={};return t.__proto__=null,t}return utils$5.nullObj=e,utils$5}var hasRequiredEe;function requireEe(){if(hasRequiredEe)return ee;hasRequiredEe=1;var e=ee&&ee.__spreadArray||function(N,I,U){if(U||arguments.length===2)for(var W=0,O=I.length,Z;W<O;W++)(Z||!(W in I))&&(Z||(Z=Array.prototype.slice.call(I,0,W)),Z[W]=I[W]);return N.concat(Z||Array.prototype.slice.call(I))};Object.defineProperty(ee,"__esModule",{value:!0}),ee.EventEmitter=void 0;var t=requireTaskCollection(),n=requireUtils$6(),r=requireUtils$5();function o(N,I,U,W,O,Z){var z=this.events[N];if(z){if(z.length===0)return!1;if(z.argsNum<6)z.call(I,U,W,O,Z);else{for(var q=new Array(z.argsNum),$=0,M=q.length;$<M;++$)q[$]=arguments[$+1];z.call.apply(void 0,q)}return!0}return!1}function c(N,I,U,W,O,Z){var z=this.events[N],q;if(z!==void 0){if(z.length===0)return!1;if(z.argsNum<6)z.call(I,U,W,O,Z);else{q=new Array(z.argsNum);for(var $=0,M=q.length;$<M;++$)q[$]=arguments[$+1];z.call.apply(void 0,q)}}var S=this.onceEvents[N];if(S){if(typeof S=="function")if(this.onceEvents[N]=void 0,arguments.length<6)S(I,U,W,O,Z);else{if(q===void 0){q=new Array(arguments.length-1);for(var $=0,M=q.length;$<M;++$)q[$]=arguments[$+1]}S.apply(void 0,q)}else{var R=S;if(this.onceEvents[N]=void 0,arguments.length<6)for(var $=0;$<R.length;++$)R[$](I,U,W,O,Z);else{if(q===void 0){q=new Array(arguments.length-1);for(var $=0,M=q.length;$<M;++$)q[$]=arguments[$+1]}for(var $=0;$<R.length;++$)R[$].apply(void 0,q)}}return!0}return z!==void 0}var l=(function(){function N(){this.events=(0,r.nullObj)(),this.onceEvents=(0,r.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(N.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),N})();ee.EventEmitter=l;function x(N,I){switch(this.emit===o&&(this.emit=c),typeof this.onceEvents[N]){case"undefined":this.onceEvents[N]=I,typeof N=="symbol"&&this._symbolKeys.add(N);break;case"function":this.onceEvents[N]=[this.onceEvents[N],I];break;case"object":this.onceEvents[N].push(I)}return this}function f(N,I,U){if(U===void 0&&(U=I.length),typeof I!="function")throw new TypeError("The listener must be a function");var W=this.events[N];return W?(W.push(I),W.growArgsNum(U),this.maxListeners!==1/0&&this.maxListeners<=W.length&&console.warn('Maximum event listeners for "'.concat(String(N),'" event!'))):(this.events[N]=new t.TaskCollection(U,!0,I,!1),typeof N=="symbol"&&this._symbolKeys.add(N)),this}function m(N,I){var U=this.events[N];U&&U.removeLast(I);var W=this.onceEvents[N];return W&&(typeof W=="function"?this.onceEvents[N]=void 0:typeof W=="object"&&(W.length===1&&W[0]===I?this.onceEvents[N]=void 0:(0,n._fast_remove_single)(W,W.lastIndexOf(I)))),this}function E(N,I,U,W){U===void 0&&(U=this),W===void 0&&(W=I.length),this.boundFuncs||(this.boundFuncs=new Map);var O=I.bind(U);return this.boundFuncs.set(I,O),this.addListener(N,O,W)}function g(N,I){var U,W,O=(U=this.boundFuncs)===null||U===void 0?void 0:U.get(I);return(W=this.boundFuncs)===null||W===void 0||W.delete(I),this.removeListener(N,O)}function y(N){return this.events[N]&&!!this.events[N].length}function w(N,I,U){if(U===void 0&&(U=I.length),typeof I!="function")throw new TypeError("The listener must be a function");var W=this.events[N];return!W||!(W instanceof t.TaskCollection)?(W=this.events[N]=new t.TaskCollection(U,!0,I,!1),typeof N=="symbol"&&this._symbolKeys.add(N)):(W.insert(0,I),W.growArgsNum(U),this.maxListeners!==1/0&&this.maxListeners<=W.length&&console.warn('Maximum event listeners for "'.concat(String(N),'" event!'))),this}function v(N,I){this.emit===o&&(this.emit=c);var U=this.onceEvents[N];return U?typeof U!="object"?(this.onceEvents[N]=[I,U],typeof N=="symbol"&&this._symbolKeys.add(N)):(U.unshift(I),this.maxListeners!==1/0&&this.maxListeners<=U.length&&console.warn('Maximum event listeners for "'.concat(String(N),'" once event!'))):(this.onceEvents[N]=[I],typeof N=="symbol"&&this._symbolKeys.add(N)),this}function _(N){return N===void 0?(this.events=(0,r.nullObj)(),this.onceEvents=(0,r.nullObj)(),this._symbolKeys=new Set):(this.events[N]=void 0,this.onceEvents[N]=void 0,typeof N=="symbol"&&this._symbolKeys.delete(N)),this}function F(N){return this.maxListeners=N,this}function H(){return this.maxListeners}function Y(N){return this.emit===o?this.events[N]?this.events[N].tasksAsArray().slice():[]:this.events[N]&&this.onceEvents[N]?e(e([],this.events[N].tasksAsArray(),!0),typeof this.onceEvents[N]=="function"?[this.onceEvents[N]]:this.onceEvents[N],!0):this.events[N]?this.events[N].tasksAsArray():this.onceEvents[N]?typeof this.onceEvents[N]=="function"?[this.onceEvents[N]]:this.onceEvents[N]:[]}function T(){var N=this;if(this.emit===o){var I=Object.keys(this.events);return e(e([],I,!0),Array.from(this._symbolKeys),!0).filter(function(W){return W in N.events&&N.events[W]&&N.events[W].length})}else{var I=Object.keys(this.events).filter(function(O){return N.events[O]&&N.events[O].length}),U=Object.keys(this.onceEvents).filter(function(O){return N.onceEvents[O]&&N.onceEvents[O].length});return e(e(e([],I,!0),U,!0),Array.from(this._symbolKeys).filter(function(O){return O in N.events&&N.events[O]&&N.events[O].length||O in N.onceEvents&&N.onceEvents[O]&&N.onceEvents[O].length}),!0)}}function L(N){return this.emit===o?this.events[N]&&this.events[N].length||0:(this.events[N]&&this.events[N].length||0)+(this.onceEvents[N]&&this.onceEvents[N].length||0)}return l.prototype.emit=o,l.prototype.on=f,l.prototype.once=x,l.prototype.addListener=f,l.prototype.removeListener=m,l.prototype.addListenerBound=E,l.prototype.removeListenerBound=g,l.prototype.hasListeners=y,l.prototype.prependListener=w,l.prototype.prependOnceListener=v,l.prototype.off=m,l.prototype.removeAllListeners=_,l.prototype.setMaxListeners=F,l.prototype.getMaxListeners=H,l.prototype.listeners=Y,l.prototype.eventNames=T,l.prototype.listenerCount=L,ee}var hasRequiredLib$1;function requireLib$1(){return hasRequiredLib$1||(hasRequiredLib$1=1,(function(e){var t=lib$1&&lib$1.__createBinding||(Object.create?(function(r,o,c,l){l===void 0&&(l=c);var x=Object.getOwnPropertyDescriptor(o,c);(!x||("get"in x?!o.__esModule:x.writable||x.configurable))&&(x={enumerable:!0,get:function(){return o[c]}}),Object.defineProperty(r,l,x)}):(function(r,o,c,l){l===void 0&&(l=c),r[l]=o[c]})),n=lib$1&&lib$1.__exportStar||function(r,o){for(var c in r)c!=="default"&&!Object.prototype.hasOwnProperty.call(o,c)&&t(o,r,c)};Object.defineProperty(e,"__esModule",{value:!0}),n(requireTypes(),e),n(requireEe(),e)})(lib$1)),lib$1}var libExports=requireLib$1(),browser$1={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var e=1e3,t=e*60,n=t*60,r=n*24,o=r*7,c=r*365.25;ms=function(E,g){g=g||{};var y=typeof E;if(y==="string"&&E.length>0)return l(E);if(y==="number"&&isFinite(E))return g.long?f(E):x(E);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(E))};function l(E){if(E=String(E),!(E.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(E);if(g){var y=parseFloat(g[1]),w=(g[2]||"ms").toLowerCase();switch(w){case"years":case"year":case"yrs":case"yr":case"y":return y*c;case"weeks":case"week":case"w":return y*o;case"days":case"day":case"d":return y*r;case"hours":case"hour":case"hrs":case"hr":case"h":return y*n;case"minutes":case"minute":case"mins":case"min":case"m":return y*t;case"seconds":case"second":case"secs":case"sec":case"s":return y*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return y;default:return}}}}function x(E){var g=Math.abs(E);return g>=r?Math.round(E/r)+"d":g>=n?Math.round(E/n)+"h":g>=t?Math.round(E/t)+"m":g>=e?Math.round(E/e)+"s":E+"ms"}function f(E){var g=Math.abs(E);return g>=r?m(E,g,r,"day"):g>=n?m(E,g,n,"hour"):g>=t?m(E,g,t,"minute"):g>=e?m(E,g,e,"second"):E+" ms"}function m(E,g,y,w){var v=g>=y*1.5;return Math.round(E/y)+" "+w+(v?"s":"")}return ms}var common,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;function e(t){r.debug=r,r.default=r,r.coerce=m,r.disable=x,r.enable=c,r.enabled=f,r.humanize=requireMs(),r.destroy=E,Object.keys(t).forEach(g=>{r[g]=t[g]}),r.names=[],r.skips=[],r.formatters={};function n(g){let y=0;for(let w=0;w<g.length;w++)y=(y<<5)-y+g.charCodeAt(w),y|=0;return r.colors[Math.abs(y)%r.colors.length]}r.selectColor=n;function r(g){let y,w=null,v,_;function F(...H){if(!F.enabled)return;const Y=F,T=Number(new Date),L=T-(y||T);Y.diff=L,Y.prev=y,Y.curr=T,y=T,H[0]=r.coerce(H[0]),typeof H[0]!="string"&&H.unshift("%O");let N=0;H[0]=H[0].replace(/%([a-zA-Z%])/g,(U,W)=>{if(U==="%%")return"%";N++;const O=r.formatters[W];if(typeof O=="function"){const Z=H[N];U=O.call(Y,Z),H.splice(N,1),N--}return U}),r.formatArgs.call(Y,H),(Y.log||r.log).apply(Y,H)}return F.namespace=g,F.useColors=r.useColors(),F.color=r.selectColor(g),F.extend=o,F.destroy=r.destroy,Object.defineProperty(F,"enabled",{enumerable:!0,configurable:!1,get:()=>w!==null?w:(v!==r.namespaces&&(v=r.namespaces,_=r.enabled(g)),_),set:H=>{w=H}}),typeof r.init=="function"&&r.init(F),F}function o(g,y){const w=r(this.namespace+(typeof y>"u"?":":y)+g);return w.log=this.log,w}function c(g){r.save(g),r.namespaces=g,r.names=[],r.skips=[];const y=(typeof g=="string"?g:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const w of y)w[0]==="-"?r.skips.push(w.slice(1)):r.names.push(w)}function l(g,y){let w=0,v=0,_=-1,F=0;for(;w<g.length;)if(v<y.length&&(y[v]===g[w]||y[v]==="*"))y[v]==="*"?(_=v,F=w,v++):(w++,v++);else if(_!==-1)v=_+1,F++,w=F;else return!1;for(;v<y.length&&y[v]==="*";)v++;return v===y.length}function x(){const g=[...r.names,...r.skips.map(y=>"-"+y)].join(",");return r.enable(""),g}function f(g){for(const y of r.skips)if(l(g,y))return!1;for(const y of r.names)if(l(g,y))return!0;return!1}function m(g){return g instanceof Error?g.stack||g.message:g}function E(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return common=e,common}var hasRequiredBrowser$1;function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,(function(e,t){var n={};t.formatArgs=o,t.save=c,t.load=l,t.useColors=r,t.storage=x(),t.destroy=(()=>{let m=!1;return()=>{m||(m=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let m;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(m=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(m[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(m){if(m[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+m[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const E="color: "+this.color;m.splice(1,0,E,"color: inherit");let g=0,y=0;m[0].replace(/%[a-zA-Z%]/g,w=>{w!=="%%"&&(g++,w==="%c"&&(y=g))}),m.splice(y,0,E)}t.log=console.debug||console.log||(()=>{});function c(m){try{m?t.storage.setItem("debug",m):t.storage.removeItem("debug")}catch{}}function l(){let m;try{m=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch{}return!m&&typeof process<"u"&&"env"in process&&(m=n.DEBUG),m}function x(){try{return localStorage}catch{}}e.exports=requireCommon()(t);const{formatters:f}=e.exports;f.j=function(m){try{return JSON.stringify(m)}catch(E){return"[UnexpectedJSONParseError]: "+E.message}}})(browser$1,browser$1.exports)),browser$1.exports}var browserExports$1=requireBrowser$1();const createDebug5=getDefaultExportFromCjs(browserExports$1),crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function isBytes(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function abytes(e,...t){if(!isBytes(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ahash(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");anumber(e.outputLen),anumber(e.blockLen)}function aexists(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput(e,t){abytes(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function clean(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr(e,t){return e<<32-t|e>>>t}function rotl$1(e,t){return e<<t|e>>>32-t>>>0}const hasHexBuiltin=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex(e){if(abytes(e),hasHexBuiltin)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=hexes[e[n]];return t}const asciis={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(e){if(e>=asciis._0&&e<=asciis._9)return e-asciis._0;if(e>=asciis.A&&e<=asciis.F)return e-(asciis.A-10);if(e>=asciis.a&&e<=asciis.f)return e-(asciis.a-10)}function hexToBytes$2(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(hasHexBuiltin)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let o=0,c=0;o<n;o++,c+=2){const l=asciiToBase16(e.charCodeAt(c)),x=asciiToBase16(e.charCodeAt(c+1));if(l===void 0||x===void 0){const f=e[c]+e[c+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+c)}r[o]=l*16+x}return r}function utf8ToBytes(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function toBytes(e){return typeof e=="string"&&(e=utf8ToBytes(e)),abytes(e),e}function concatBytes(...e){let t=0;for(let r=0;r<e.length;r++){const o=e[r];abytes(o),t+=o.length}const n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){const c=e[r];n.set(c,o),o+=c.length}return n}class Hash{}function createHasher(e){const t=r=>e().update(toBytes(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes(e=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(e));if(crypto$2&&typeof crypto$2.randomBytes=="function")return Uint8Array.from(crypto$2.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),c=BigInt(4294967295),l=Number(n>>o&c),x=Number(n&c),f=r?4:0,m=r?0:4;e.setUint32(t+f,l,r),e.setUint32(t+m,x,r)}function Chi(e,t,n){return e&t^~e&n}function Maj(e,t,n){return e&t^e&n^t&n}class HashMD extends Hash{constructor(t,n,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=createView(this.buffer)}update(t){aexists(this),t=toBytes(t),abytes(t);const{view:n,buffer:r,blockLen:o}=this,c=t.length;for(let l=0;l<c;){const x=Math.min(o-this.pos,c-l);if(x===o){const f=createView(t);for(;o<=c-l;l+=o)this.process(f,l);continue}r.set(t.subarray(l,l+x),this.pos),this.pos+=x,l+=x,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists(this),aoutput(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:c}=this;let{pos:l}=this;n[l++]=128,clean(this.buffer.subarray(l)),this.padOffset>o-l&&(this.process(r,0),l=0);for(let g=l;g<o;g++)n[g]=0;setBigUint64(r,o-8,BigInt(this.length*8),c),this.process(r,0);const x=createView(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=f/4,E=this.get();if(m>E.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<m;g++)x.setUint32(4*g,E[g],c)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:c,destroyed:l,pos:x}=this;return t.destroyed=l,t.finished=c,t.length=o,t.pos=x,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_K=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(t=32){super(64,t,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:t,B:n,C:r,D:o,E:c,F:l,G:x,H:f}=this;return[t,n,r,o,c,l,x,f]}set(t,n,r,o,c,l,x,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=c|0,this.F=l|0,this.G=x|0,this.H=f|0}process(t,n){for(let g=0;g<16;g++,n+=4)SHA256_W[g]=t.getUint32(n,!1);for(let g=16;g<64;g++){const y=SHA256_W[g-15],w=SHA256_W[g-2],v=rotr(y,7)^rotr(y,18)^y>>>3,_=rotr(w,17)^rotr(w,19)^w>>>10;SHA256_W[g]=_+SHA256_W[g-7]+v+SHA256_W[g-16]|0}let{A:r,B:o,C:c,D:l,E:x,F:f,G:m,H:E}=this;for(let g=0;g<64;g++){const y=rotr(x,6)^rotr(x,11)^rotr(x,25),w=E+y+Chi(x,f,m)+SHA256_K[g]+SHA256_W[g]|0,_=(rotr(r,2)^rotr(r,13)^rotr(r,22))+Maj(r,o,c)|0;E=m,m=f,f=x,x=l+w|0,l=c,c=o,o=r,r=w+_|0}r=r+this.A|0,o=o+this.B|0,c=c+this.C|0,l=l+this.D|0,x=x+this.E|0,f=f+this.F|0,m=m+this.G|0,E=E+this.H|0,this.set(r,o,c,l,x,f,m,E)}roundClean(){clean(SHA256_W)}destroy(){this.set(0,0,0,0,0,0,0,0),clean(this.buffer)}}const sha256$1=createHasher(()=>new SHA256);class HMAC extends Hash{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,ahash(t);const r=toBytes(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,c=new Uint8Array(o);c.set(r.length>o?t.create().update(r).digest():r);for(let l=0;l<c.length;l++)c[l]^=54;this.iHash.update(c),this.oHash=t.create();for(let l=0;l<c.length;l++)c[l]^=106;this.oHash.update(c),clean(c)}update(t){return aexists(this),this.iHash.update(t),this}digestInto(t){aexists(this),abytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:c,blockLen:l,outputLen:x}=this;return t=t,t.finished=o,t.destroyed=c,t.blockLen=l,t.outputLen=x,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac$1=(e,t,n)=>new HMAC(e,t).update(n).digest();hmac$1.create=(e,t)=>new HMAC(e,t);const _0n$4=BigInt(0),_1n$4=BigInt(1);function _abool2(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function _abytes2(e,t,n=""){const r=isBytes(e),o=e?.length,c=t!==void 0;if(!r||c&&o!==t){const l=n&&`"${n}" `,x=c?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+x+", got "+f)}return e}function numberToHexUnpadded(e){const t=e.toString(16);return t.length&1?"0"+t:t}function hexToNumber(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?_0n$4:BigInt("0x"+e)}function bytesToNumberBE(e){return hexToNumber(bytesToHex(e))}function bytesToNumberLE(e){return abytes(e),hexToNumber(bytesToHex(Uint8Array.from(e).reverse()))}function numberToBytesBE(e,t){return hexToBytes$2(e.toString(16).padStart(t*2,"0"))}function numberToBytesLE(e,t){return numberToBytesBE(e,t).reverse()}function ensureBytes(e,t,n){let r;if(typeof t=="string")try{r=hexToBytes$2(t)}catch(c){throw new Error(e+" must be hex string or Uint8Array, cause: "+c)}else if(isBytes(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(e+" of length "+n+" expected, got "+o);return r}const isPosBig=e=>typeof e=="bigint"&&_0n$4<=e;function inRange(e,t,n){return isPosBig(e)&&isPosBig(t)&&isPosBig(n)&&t<=e&&e<n}function aInRange(e,t,n,r){if(!inRange(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function bitLen(e){let t;for(t=0;e>_0n$4;e>>=_1n$4,t+=1);return t}const bitMask=e=>(_1n$4<<BigInt(e))-_1n$4;function createHmacDrbg(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=w=>new Uint8Array(w),o=w=>Uint8Array.of(w);let c=r(e),l=r(e),x=0;const f=()=>{c.fill(1),l.fill(0),x=0},m=(...w)=>n(l,c,...w),E=(w=r(0))=>{l=m(o(0),w),c=m(),w.length!==0&&(l=m(o(1),w),c=m())},g=()=>{if(x++>=1e3)throw new Error("drbg: tried 1000 values");let w=0;const v=[];for(;w<t;){c=m();const _=c.slice();v.push(_),w+=c.length}return concatBytes(...v)};return(w,v)=>{f(),E(w);let _;for(;!(_=v(g()));)E();return f(),_}}function _validateObject(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(o,c,l){const x=e[o];if(l&&x===void 0)return;const f=typeof x;if(f!==c||x===null)throw new Error(`param "${o}" is invalid: expected ${c}, got ${f}`)}Object.entries(t).forEach(([o,c])=>r(o,c,!1)),Object.entries(n).forEach(([o,c])=>r(o,c,!0))}function memoized(e){const t=new WeakMap;return(n,...r)=>{const o=t.get(n);if(o!==void 0)return o;const c=e(n,...r);return t.set(n,c),c}}const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$2=BigInt(2),_3n$1=BigInt(3),_4n$1=BigInt(4),_5n=BigInt(5),_7n=BigInt(7),_8n=BigInt(8),_9n=BigInt(9),_16n=BigInt(16);function mod(e,t){const n=e%t;return n>=_0n$3?n:t+n}function pow2(e,t,n){let r=e;for(;t-- >_0n$3;)r*=r,r%=n;return r}function invert(e,t){if(e===_0n$3)throw new Error("invert: expected non-zero number");if(t<=_0n$3)throw new Error("invert: expected positive modulus, got "+t);let n=mod(e,t),r=t,o=_0n$3,c=_1n$3;for(;n!==_0n$3;){const x=r/n,f=r%n,m=o-c*x;r=n,n=f,o=c,c=m}if(r!==_1n$3)throw new Error("invert: does not exist");return mod(o,t)}function assertIsSquare(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function sqrt3mod4(e,t){const n=(e.ORDER+_1n$3)/_4n$1,r=e.pow(t,n);return assertIsSquare(e,r,t),r}function sqrt5mod8(e,t){const n=(e.ORDER-_5n)/_8n,r=e.mul(t,_2n$2),o=e.pow(r,n),c=e.mul(t,o),l=e.mul(e.mul(c,_2n$2),o),x=e.mul(c,e.sub(l,e.ONE));return assertIsSquare(e,x,t),x}function sqrt9mod16(e){const t=Field(e),n=tonelliShanks(e),r=n(t,t.neg(t.ONE)),o=n(t,r),c=n(t,t.neg(r)),l=(e+_7n)/_16n;return(x,f)=>{let m=x.pow(f,l),E=x.mul(m,r);const g=x.mul(m,o),y=x.mul(m,c),w=x.eql(x.sqr(E),f),v=x.eql(x.sqr(g),f);m=x.cmov(m,E,w),E=x.cmov(y,g,v);const _=x.eql(x.sqr(E),f),F=x.cmov(m,E,_);return assertIsSquare(x,F,f),F}}function tonelliShanks(e){if(e<_3n$1)throw new Error("sqrt is not defined for small field");let t=e-_1n$3,n=0;for(;t%_2n$2===_0n$3;)t/=_2n$2,n++;let r=_2n$2;const o=Field(e);for(;FpLegendre(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return sqrt3mod4;let c=o.pow(r,t);const l=(t+_1n$3)/_2n$2;return function(f,m){if(f.is0(m))return m;if(FpLegendre(f,m)!==1)throw new Error("Cannot find square root");let E=n,g=f.mul(f.ONE,c),y=f.pow(m,t),w=f.pow(m,l);for(;!f.eql(y,f.ONE);){if(f.is0(y))return f.ZERO;let v=1,_=f.sqr(y);for(;!f.eql(_,f.ONE);)if(v++,_=f.sqr(_),v===E)throw new Error("Cannot find square root");const F=_1n$3<<BigInt(E-v-1),H=f.pow(g,F);E=v,g=f.sqr(H),y=f.mul(y,g),w=f.mul(w,H)}return w}}function FpSqrt(e){return e%_4n$1===_3n$1?sqrt3mod4:e%_8n===_5n?sqrt5mod8:e%_16n===_9n?sqrt9mod16(e):tonelliShanks(e)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=FIELD_FIELDS.reduce((r,o)=>(r[o]="function",r),t);return _validateObject(e,n),e}function FpPow(e,t,n){if(n<_0n$3)throw new Error("invalid exponent, negatives unsupported");if(n===_0n$3)return e.ONE;if(n===_1n$3)return t;let r=e.ONE,o=t;for(;n>_0n$3;)n&_1n$3&&(r=e.mul(r,o)),o=e.sqr(o),n>>=_1n$3;return r}function FpInvertBatch(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((l,x,f)=>e.is0(x)?l:(r[f]=l,e.mul(l,x)),e.ONE),c=e.inv(o);return t.reduceRight((l,x,f)=>e.is0(x)?l:(r[f]=e.mul(l,r[f]),e.mul(l,x)),c),r}function FpLegendre(e,t){const n=(e.ORDER-_1n$3)/_2n$2,r=e.pow(t,n),o=e.eql(r,e.ONE),c=e.eql(r,e.ZERO),l=e.eql(r,e.neg(e.ONE));if(!o&&!c&&!l)throw new Error("invalid Legendre symbol result");return o?1:c?0:-1}function nLength(e,t){t!==void 0&&anumber(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Field(e,t,n=!1,r={}){if(e<=_0n$3)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,c,l=!1,x;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const y=t;y.BITS&&(o=y.BITS),y.sqrt&&(c=y.sqrt),typeof y.isLE=="boolean"&&(n=y.isLE),typeof y.modFromBytes=="boolean"&&(l=y.modFromBytes),x=y.allowedLengths}else typeof t=="number"&&(o=t),r.sqrt&&(c=r.sqrt);const{nBitLength:f,nByteLength:m}=nLength(e,o);if(m>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let E;const g=Object.freeze({ORDER:e,isLE:n,BITS:f,BYTES:m,MASK:bitMask(f),ZERO:_0n$3,ONE:_1n$3,allowedLengths:x,create:y=>mod(y,e),isValid:y=>{if(typeof y!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof y);return _0n$3<=y&&y<e},is0:y=>y===_0n$3,isValidNot0:y=>!g.is0(y)&&g.isValid(y),isOdd:y=>(y&_1n$3)===_1n$3,neg:y=>mod(-y,e),eql:(y,w)=>y===w,sqr:y=>mod(y*y,e),add:(y,w)=>mod(y+w,e),sub:(y,w)=>mod(y-w,e),mul:(y,w)=>mod(y*w,e),pow:(y,w)=>FpPow(g,y,w),div:(y,w)=>mod(y*invert(w,e),e),sqrN:y=>y*y,addN:(y,w)=>y+w,subN:(y,w)=>y-w,mulN:(y,w)=>y*w,inv:y=>invert(y,e),sqrt:c||(y=>(E||(E=FpSqrt(e)),E(g,y))),toBytes:y=>n?numberToBytesLE(y,m):numberToBytesBE(y,m),fromBytes:(y,w=!0)=>{if(x){if(!x.includes(y.length)||y.length>m)throw new Error("Field.fromBytes: expected "+x+" bytes, got "+y.length);const _=new Uint8Array(m);_.set(y,n?0:_.length-y.length),y=_}if(y.length!==m)throw new Error("Field.fromBytes: expected "+m+" bytes, got "+y.length);let v=n?bytesToNumberLE(y):bytesToNumberBE(y);if(l&&(v=mod(v,e)),!w&&!g.isValid(v))throw new Error("invalid field element: outside of range 0..ORDER");return v},invertBatch:y=>FpInvertBatch(g,y),cmov:(y,w,v)=>v?w:y});return Object.freeze(g)}function getFieldBytesLength(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength(e){const t=getFieldBytesLength(e);return t+Math.ceil(t/2)}function mapHashToField(e,t,n=!1){const r=e.length,o=getFieldBytesLength(t),c=getMinHashLength(t);if(r<16||r<c||r>1024)throw new Error("expected "+c+"-1024 bytes of input, got "+r);const l=n?bytesToNumberLE(e):bytesToNumberBE(e),x=mod(l,t-_1n$3)+_1n$3;return n?numberToBytesLE(x,o):numberToBytesBE(x,o)}const _0n$2=BigInt(0),_1n$2=BigInt(1);function negateCt(e,t){const n=t.negate();return e?n:t}function normalizeZ(e,t){const n=FpInvertBatch(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}function validateW(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function calcWOpts(e,t){validateW(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,c=bitMask(e),l=BigInt(e);return{windows:n,windowSize:r,mask:c,maxNumber:o,shiftBy:l}}function calcOffsets(e,t,n){const{windowSize:r,mask:o,maxNumber:c,shiftBy:l}=n;let x=Number(e&o),f=e>>l;x>r&&(x-=c,f+=_1n$2);const m=t*r,E=m+Math.abs(x)-1,g=x===0,y=x<0,w=t%2!==0;return{nextN:f,offset:E,isZero:g,isNeg:y,isNegF:w,offsetF:m}}function validateMSMPoints(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function validateMSMScalars(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(e){return pointWindowSizes.get(e)||1}function assert0(e){if(e!==_0n$2)throw new Error("invalid wNAF")}class wNAF{constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>_0n$2;)n&_1n$2&&(r=r.add(o)),o=o.double(),n>>=_1n$2;return r}precomputeWindow(t,n){const{windows:r,windowSize:o}=calcWOpts(n,this.bits),c=[];let l=t,x=l;for(let f=0;f<r;f++){x=l,c.push(x);for(let m=1;m<o;m++)x=x.add(l),c.push(x);l=x.double()}return c}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,c=this.BASE;const l=calcWOpts(t,this.bits);for(let x=0;x<l.windows;x++){const{nextN:f,offset:m,isZero:E,isNeg:g,isNegF:y,offsetF:w}=calcOffsets(r,x,l);r=f,E?c=c.add(negateCt(y,n[w])):o=o.add(negateCt(g,n[m]))}return assert0(r),{p:o,f:c}}wNAFUnsafe(t,n,r,o=this.ZERO){const c=calcWOpts(t,this.bits);for(let l=0;l<c.windows&&r!==_0n$2;l++){const{nextN:x,offset:f,isZero:m,isNeg:E}=calcOffsets(r,l,c);if(r=x,!m){const g=n[f];o=o.add(E?g.negate():g)}}return assert0(r),o}getPrecomputes(t,n,r){let o=pointPrecomputes.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),pointPrecomputes.set(n,o))),o}cached(t,n,r){const o=getW(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){const c=getW(t);return c===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(c,this.getPrecomputes(c,t,r),n,o)}createCache(t,n){validateW(n,this.bits),pointWindowSizes.set(t,n),pointPrecomputes.delete(t)}hasCache(t){return getW(t)!==1}}function mulEndoUnsafe(e,t,n,r){let o=t,c=e.ZERO,l=e.ZERO;for(;n>_0n$2||r>_0n$2;)n&_1n$2&&(c=c.add(o)),r&_1n$2&&(l=l.add(o)),o=o.double(),n>>=_1n$2,r>>=_1n$2;return{p1:c,p2:l}}function pippenger(e,t,n,r){validateMSMPoints(n,e),validateMSMScalars(r,t);const o=n.length,c=r.length;if(o!==c)throw new Error("arrays of points and scalars must have equal length");const l=e.ZERO,x=bitLen(BigInt(o));let f=1;x>12?f=x-3:x>4?f=x-2:x>0&&(f=2);const m=bitMask(f),E=new Array(Number(m)+1).fill(l),g=Math.floor((t.BITS-1)/f)*f;let y=l;for(let w=g;w>=0;w-=f){E.fill(l);for(let _=0;_<c;_++){const F=r[_],H=Number(F>>BigInt(w)&m);E[H]=E[H].add(n[_])}let v=l;for(let _=E.length-1,F=l;_>0;_--)F=F.add(E[_]),v=v.add(F);if(y=y.add(v),w!==0)for(let _=0;_<f;_++)y=y.double()}return y}function createField(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField(t),t}else return Field(e,{isLE:n})}function _createCurveFields(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const f of["p","n","h"]){const m=t[f];if(!(typeof m=="bigint"&&m>_0n$2))throw new Error(`CURVE.${f} must be positive bigint`)}const o=createField(t.p,n.Fp,r),c=createField(t.n,n.Fn,r),x=["Gx","Gy","a","b"];for(const f of x)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:c}}const divNearest=(e,t)=>(e+(e>=0?t:-t)/_2n$1)/t;function _splitEndoScalar(e,t,n){const[[r,o],[c,l]]=t,x=divNearest(l*e,n),f=divNearest(-o*e,n);let m=e-x*r-f*c,E=-x*o-f*l;const g=m<_0n$1,y=E<_0n$1;g&&(m=-m),y&&(E=-E);const w=bitMask(Math.ceil(bitLen(n)/2))+_1n$1;if(m<_0n$1||m>=w||E<_0n$1||E>=w)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:g,k1:m,k2neg:y,k2:E}}function validateSigFormat(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function validateSigOpts(e,t){const n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return _abool2(n.lowS,"lowS"),_abool2(n.prehash,"prehash"),n.format!==void 0&&validateSigFormat(n.format),n}class DERErr extends Error{constructor(t=""){super(t)}}const DER={Err:DERErr,_tlv:{encode:(e,t)=>{const{Err:n}=DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,o=numberToHexUnpadded(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");const c=r>127?numberToHexUnpadded(o.length/2|128):"";return numberToHexUnpadded(e)+c+o+t},decode(e,t){const{Err:n}=DER;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const o=t[r++],c=!!(o&128);let l=0;if(!c)l=o;else{const f=o&127;if(!f)throw new n("tlv.decode(long): indefinite length not supported");if(f>4)throw new n("tlv.decode(long): byte length is too big");const m=t.subarray(r,r+f);if(m.length!==f)throw new n("tlv.decode: length bytes not complete");if(m[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const E of m)l=l<<8|E;if(r+=f,l<128)throw new n("tlv.decode(long): not minimal encoding")}const x=t.subarray(r,r+l);if(x.length!==l)throw new n("tlv.decode: wrong value length");return{v:x,l:t.subarray(r+l)}}},_int:{encode(e){const{Err:t}=DER;if(e<_0n$1)throw new t("integer: negative integers are not allowed");let n=numberToHexUnpadded(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=DER;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return bytesToNumberBE(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=DER,o=ensureBytes("signature",e),{v:c,l}=r.decode(48,o);if(l.length)throw new t("invalid signature: left bytes after parsing");const{v:x,l:f}=r.decode(2,c),{v:m,l:E}=r.decode(2,f);if(E.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(x),s:n.decode(m)}},hexFromSig(e){const{_tlv:t,_int:n}=DER,r=t.encode(2,n.encode(e.r)),o=t.encode(2,n.encode(e.s)),c=r+o;return t.encode(48,c)}},_0n$1=BigInt(0),_1n$1=BigInt(1),_2n$1=BigInt(2),_3n=BigInt(3),_4n=BigInt(4);function _normFnElement(e,t){const{BYTES:n}=e;let r;if(typeof t=="bigint")r=t;else{let o=ensureBytes("private key",t);try{r=e.fromBytes(o)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function weierstrassN(e,t={}){const n=_createCurveFields("weierstrass",e,t),{Fp:r,Fn:o}=n;let c=n.CURVE;const{h:l,n:x}=c;_validateObject(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:f}=t;if(f&&(!r.is0(c.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const m=getWLengths(r,o);function E(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function g(q,$,M){const{x:S,y:R}=$.toAffine(),D=r.toBytes(S);if(_abool2(M,"isCompressed"),M){E();const j=!r.isOdd(R);return concatBytes(pprefix(j),D)}else return concatBytes(Uint8Array.of(4),D,r.toBytes(R))}function y(q){_abytes2(q,void 0,"Point");const{publicKey:$,publicKeyUncompressed:M}=m,S=q.length,R=q[0],D=q.subarray(1);if(S===$&&(R===2||R===3)){const j=r.fromBytes(D);if(!r.isValid(j))throw new Error("bad point: is not on curve, wrong x");const P=_(j);let Q;try{Q=r.sqrt(P)}catch(J){const ne=J instanceof Error?": "+J.message:"";throw new Error("bad point: is not on curve, sqrt error"+ne)}E();const C=r.isOdd(Q);return(R&1)===1!==C&&(Q=r.neg(Q)),{x:j,y:Q}}else if(S===M&&R===4){const j=r.BYTES,P=r.fromBytes(D.subarray(0,j)),Q=r.fromBytes(D.subarray(j,j*2));if(!F(P,Q))throw new Error("bad point: is not on curve");return{x:P,y:Q}}else throw new Error(`bad point: got length ${S}, expected compressed=${$} or uncompressed=${M}`)}const w=t.toBytes||g,v=t.fromBytes||y;function _(q){const $=r.sqr(q),M=r.mul($,q);return r.add(r.add(M,r.mul(q,c.a)),c.b)}function F(q,$){const M=r.sqr($),S=_(q);return r.eql(M,S)}if(!F(c.Gx,c.Gy))throw new Error("bad curve params: generator point");const H=r.mul(r.pow(c.a,_3n),_4n),Y=r.mul(r.sqr(c.b),BigInt(27));if(r.is0(r.add(H,Y)))throw new Error("bad curve params: a or b");function T(q,$,M=!1){if(!r.isValid($)||M&&r.is0($))throw new Error(`bad point coordinate ${q}`);return $}function L(q){if(!(q instanceof O))throw new Error("ProjectivePoint expected")}function N(q){if(!f||!f.basises)throw new Error("no endo");return _splitEndoScalar(q,f.basises,o.ORDER)}const I=memoized((q,$)=>{const{X:M,Y:S,Z:R}=q;if(r.eql(R,r.ONE))return{x:M,y:S};const D=q.is0();$==null&&($=D?r.ONE:r.inv(R));const j=r.mul(M,$),P=r.mul(S,$),Q=r.mul(R,$);if(D)return{x:r.ZERO,y:r.ZERO};if(!r.eql(Q,r.ONE))throw new Error("invZ was invalid");return{x:j,y:P}}),U=memoized(q=>{if(q.is0()){if(t.allowInfinityPoint&&!r.is0(q.Y))return;throw new Error("bad point: ZERO")}const{x:$,y:M}=q.toAffine();if(!r.isValid($)||!r.isValid(M))throw new Error("bad point: x or y not field elements");if(!F($,M))throw new Error("bad point: equation left != right");if(!q.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function W(q,$,M,S,R){return M=new O(r.mul(M.X,q),M.Y,M.Z),$=negateCt(S,$),M=negateCt(R,M),$.add(M)}class O{constructor($,M,S){this.X=T("x",$),this.Y=T("y",M,!0),this.Z=T("z",S),Object.freeze(this)}static CURVE(){return c}static fromAffine($){const{x:M,y:S}=$||{};if(!$||!r.isValid(M)||!r.isValid(S))throw new Error("invalid affine point");if($ instanceof O)throw new Error("projective point not allowed");return r.is0(M)&&r.is0(S)?O.ZERO:new O(M,S,r.ONE)}static fromBytes($){const M=O.fromAffine(v(_abytes2($,void 0,"point")));return M.assertValidity(),M}static fromHex($){return O.fromBytes(ensureBytes("pointHex",$))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute($=8,M=!0){return z.createCache(this,$),M||this.multiply(_3n),this}assertValidity(){U(this)}hasEvenY(){const{y:$}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd($)}equals($){L($);const{X:M,Y:S,Z:R}=this,{X:D,Y:j,Z:P}=$,Q=r.eql(r.mul(M,P),r.mul(D,R)),C=r.eql(r.mul(S,P),r.mul(j,R));return Q&&C}negate(){return new O(this.X,r.neg(this.Y),this.Z)}double(){const{a:$,b:M}=c,S=r.mul(M,_3n),{X:R,Y:D,Z:j}=this;let P=r.ZERO,Q=r.ZERO,C=r.ZERO,K=r.mul(R,R),J=r.mul(D,D),ne=r.mul(j,j),re=r.mul(R,D);return re=r.add(re,re),C=r.mul(R,j),C=r.add(C,C),P=r.mul($,C),Q=r.mul(S,ne),Q=r.add(P,Q),P=r.sub(J,Q),Q=r.add(J,Q),Q=r.mul(P,Q),P=r.mul(re,P),C=r.mul(S,C),ne=r.mul($,ne),re=r.sub(K,ne),re=r.mul($,re),re=r.add(re,C),C=r.add(K,K),K=r.add(C,K),K=r.add(K,ne),K=r.mul(K,re),Q=r.add(Q,K),ne=r.mul(D,j),ne=r.add(ne,ne),K=r.mul(ne,re),P=r.sub(P,K),C=r.mul(ne,J),C=r.add(C,C),C=r.add(C,C),new O(P,Q,C)}add($){L($);const{X:M,Y:S,Z:R}=this,{X:D,Y:j,Z:P}=$;let Q=r.ZERO,C=r.ZERO,K=r.ZERO;const J=c.a,ne=r.mul(c.b,_3n);let re=r.mul(M,D),ie=r.mul(S,j),ce=r.mul(R,P),ue=r.add(M,S),ae=r.add(D,j);ue=r.mul(ue,ae),ae=r.add(re,ie),ue=r.sub(ue,ae),ae=r.add(M,R);let we=r.add(D,P);return ae=r.mul(ae,we),we=r.add(re,ce),ae=r.sub(ae,we),we=r.add(S,R),Q=r.add(j,P),we=r.mul(we,Q),Q=r.add(ie,ce),we=r.sub(we,Q),K=r.mul(J,ae),Q=r.mul(ne,ce),K=r.add(Q,K),Q=r.sub(ie,K),K=r.add(ie,K),C=r.mul(Q,K),ie=r.add(re,re),ie=r.add(ie,re),ce=r.mul(J,ce),ae=r.mul(ne,ae),ie=r.add(ie,ce),ce=r.sub(re,ce),ce=r.mul(J,ce),ae=r.add(ae,ce),re=r.mul(ie,ae),C=r.add(C,re),re=r.mul(we,ae),Q=r.mul(ue,Q),Q=r.sub(Q,re),re=r.mul(ue,ie),K=r.mul(we,K),K=r.add(K,re),new O(Q,C,K)}subtract($){return this.add($.negate())}is0(){return this.equals(O.ZERO)}multiply($){const{endo:M}=t;if(!o.isValidNot0($))throw new Error("invalid scalar: out of range");let S,R;const D=j=>z.cached(this,j,P=>normalizeZ(O,P));if(M){const{k1neg:j,k1:P,k2neg:Q,k2:C}=N($),{p:K,f:J}=D(P),{p:ne,f:re}=D(C);R=J.add(re),S=W(M.beta,K,ne,j,Q)}else{const{p:j,f:P}=D($);S=j,R=P}return normalizeZ(O,[S,R])[0]}multiplyUnsafe($){const{endo:M}=t,S=this;if(!o.isValid($))throw new Error("invalid scalar: out of range");if($===_0n$1||S.is0())return O.ZERO;if($===_1n$1)return S;if(z.hasCache(this))return this.multiply($);if(M){const{k1neg:R,k1:D,k2neg:j,k2:P}=N($),{p1:Q,p2:C}=mulEndoUnsafe(O,S,D,P);return W(M.beta,Q,C,R,j)}else return z.unsafe(S,$)}multiplyAndAddUnsafe($,M,S){const R=this.multiplyUnsafe(M).add($.multiplyUnsafe(S));return R.is0()?void 0:R}toAffine($){return I(this,$)}isTorsionFree(){const{isTorsionFree:$}=t;return l===_1n$1?!0:$?$(O,this):z.unsafe(this,x).is0()}clearCofactor(){const{clearCofactor:$}=t;return l===_1n$1?this:$?$(O,this):this.multiplyUnsafe(l)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}toBytes($=!0){return _abool2($,"isCompressed"),this.assertValidity(),w(O,this,$)}toHex($=!0){return bytesToHex(this.toBytes($))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes($=!0){return this.toBytes($)}_setWindowSize($){this.precompute($)}static normalizeZ($){return normalizeZ(O,$)}static msm($,M){return pippenger(O,o,$,M)}static fromPrivateKey($){return O.BASE.multiply(_normFnElement(o,$))}}O.BASE=new O(c.Gx,c.Gy,r.ONE),O.ZERO=new O(r.ZERO,r.ONE,r.ZERO),O.Fp=r,O.Fn=o;const Z=o.BITS,z=new wNAF(O,t.endo?Math.ceil(Z/2):Z);return O.BASE.precompute(8),O}function pprefix(e){return Uint8Array.of(e?2:3)}function getWLengths(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function ecdh(e,t={}){const{Fn:n}=e,r=t.randomBytes||randomBytes,o=Object.assign(getWLengths(e.Fp,n),{seed:getMinHashLength(n.ORDER)});function c(w){try{return!!_normFnElement(n,w)}catch{return!1}}function l(w,v){const{publicKey:_,publicKeyUncompressed:F}=o;try{const H=w.length;return v===!0&&H!==_||v===!1&&H!==F?!1:!!e.fromBytes(w)}catch{return!1}}function x(w=r(o.seed)){return mapHashToField(_abytes2(w,o.seed,"seed"),n.ORDER)}function f(w,v=!0){return e.BASE.multiply(_normFnElement(n,w)).toBytes(v)}function m(w){const v=x(w);return{secretKey:v,publicKey:f(v)}}function E(w){if(typeof w=="bigint")return!1;if(w instanceof e)return!0;const{secretKey:v,publicKey:_,publicKeyUncompressed:F}=o;if(n.allowedLengths||v===_)return;const H=ensureBytes("key",w).length;return H===_||H===F}function g(w,v,_=!0){if(E(w)===!0)throw new Error("first arg must be private key");if(E(v)===!1)throw new Error("second arg must be public key");const F=_normFnElement(n,w);return e.fromHex(v).multiply(F).toBytes(_)}return Object.freeze({getPublicKey:f,getSharedSecret:g,keygen:m,Point:e,utils:{isValidSecretKey:c,isValidPublicKey:l,randomSecretKey:x,isValidPrivateKey:c,randomPrivateKey:x,normPrivateKeyToScalar:w=>_normFnElement(n,w),precompute(w=8,v=e.BASE){return v.precompute(w,!1)}},lengths:o})}function ecdsa(e,t,n={}){ahash(t),_validateObject(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||randomBytes,o=n.hmac||((M,...S)=>hmac$1(t,M,concatBytes(...S))),{Fp:c,Fn:l}=e,{ORDER:x,BITS:f}=l,{keygen:m,getPublicKey:E,getSharedSecret:g,utils:y,lengths:w}=ecdh(e,n),v={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},_="compact";function F(M){const S=x>>_1n$1;return M>S}function H(M,S){if(!l.isValidNot0(S))throw new Error(`invalid signature ${M}: out of range 1..Point.Fn.ORDER`);return S}function Y(M,S){validateSigFormat(S);const R=w.signature,D=S==="compact"?R:S==="recovered"?R+1:void 0;return _abytes2(M,D,`${S} signature`)}class T{constructor(S,R,D){this.r=H("r",S),this.s=H("s",R),D!=null&&(this.recovery=D),Object.freeze(this)}static fromBytes(S,R=_){Y(S,R);let D;if(R==="der"){const{r:C,s:K}=DER.toSig(_abytes2(S));return new T(C,K)}R==="recovered"&&(D=S[0],R="compact",S=S.subarray(1));const j=l.BYTES,P=S.subarray(0,j),Q=S.subarray(j,j*2);return new T(l.fromBytes(P),l.fromBytes(Q),D)}static fromHex(S,R){return this.fromBytes(hexToBytes$2(S),R)}addRecoveryBit(S){return new T(this.r,this.s,S)}recoverPublicKey(S){const R=c.ORDER,{r:D,s:j,recovery:P}=this;if(P==null||![0,1,2,3].includes(P))throw new Error("recovery id invalid");if(x*_2n$1<R&&P>1)throw new Error("recovery id is ambiguous for h>1 curve");const C=P===2||P===3?D+x:D;if(!c.isValid(C))throw new Error("recovery id 2 or 3 invalid");const K=c.toBytes(C),J=e.fromBytes(concatBytes(pprefix((P&1)===0),K)),ne=l.inv(C),re=N(ensureBytes("msgHash",S)),ie=l.create(-re*ne),ce=l.create(j*ne),ue=e.BASE.multiplyUnsafe(ie).add(J.multiplyUnsafe(ce));if(ue.is0())throw new Error("point at infinify");return ue.assertValidity(),ue}hasHighS(){return F(this.s)}toBytes(S=_){if(validateSigFormat(S),S==="der")return hexToBytes$2(DER.hexFromSig(this));const R=l.toBytes(this.r),D=l.toBytes(this.s);if(S==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return concatBytes(Uint8Array.of(this.recovery),R,D)}return concatBytes(R,D)}toHex(S){return bytesToHex(this.toBytes(S))}assertValidity(){}static fromCompact(S){return T.fromBytes(ensureBytes("sig",S),"compact")}static fromDER(S){return T.fromBytes(ensureBytes("sig",S),"der")}normalizeS(){return this.hasHighS()?new T(this.r,l.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return bytesToHex(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return bytesToHex(this.toBytes("compact"))}}const L=n.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");const R=bytesToNumberBE(S),D=S.length*8-f;return D>0?R>>BigInt(D):R},N=n.bits2int_modN||function(S){return l.create(L(S))},I=bitMask(f);function U(M){return aInRange("num < 2^"+f,M,_0n$1,I),l.toBytes(M)}function W(M,S){return _abytes2(M,void 0,"message"),S?_abytes2(t(M),void 0,"prehashed message"):M}function O(M,S,R){if(["recovered","canonical"].some(ie=>ie in R))throw new Error("sign() legacy options not supported");const{lowS:D,prehash:j,extraEntropy:P}=validateSigOpts(R,v);M=W(M,j);const Q=N(M),C=_normFnElement(l,S),K=[U(C),U(Q)];if(P!=null&&P!==!1){const ie=P===!0?r(w.secretKey):P;K.push(ensureBytes("extraEntropy",ie))}const J=concatBytes(...K),ne=Q;function re(ie){const ce=L(ie);if(!l.isValidNot0(ce))return;const ue=l.inv(ce),ae=e.BASE.multiply(ce).toAffine(),we=l.create(ae.x);if(we===_0n$1)return;const ke=l.create(ue*l.create(ne+we*C));if(ke===_0n$1)return;let Re=(ae.x===we?0:2)|Number(ae.y&_1n$1),be=ke;return D&&F(ke)&&(be=l.neg(ke),Re^=1),new T(we,be,Re)}return{seed:J,k2sig:re}}function Z(M,S,R={}){M=ensureBytes("message",M);const{seed:D,k2sig:j}=O(M,S,R);return createHmacDrbg(t.outputLen,l.BYTES,o)(D,j)}function z(M){let S;const R=typeof M=="string"||isBytes(M),D=!R&&M!==null&&typeof M=="object"&&typeof M.r=="bigint"&&typeof M.s=="bigint";if(!R&&!D)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(D)S=new T(M.r,M.s);else if(R){try{S=T.fromBytes(ensureBytes("sig",M),"der")}catch(j){if(!(j instanceof DER.Err))throw j}if(!S)try{S=T.fromBytes(ensureBytes("sig",M),"compact")}catch{return!1}}return S||!1}function q(M,S,R,D={}){const{lowS:j,prehash:P,format:Q}=validateSigOpts(D,v);if(R=ensureBytes("publicKey",R),S=W(ensureBytes("message",S),P),"strict"in D)throw new Error("options.strict was renamed to lowS");const C=Q===void 0?z(M):T.fromBytes(ensureBytes("sig",M),Q);if(C===!1)return!1;try{const K=e.fromBytes(R);if(j&&C.hasHighS())return!1;const{r:J,s:ne}=C,re=N(S),ie=l.inv(ne),ce=l.create(re*ie),ue=l.create(J*ie),ae=e.BASE.multiplyUnsafe(ce).add(K.multiplyUnsafe(ue));return ae.is0()?!1:l.create(ae.x)===J}catch{return!1}}function $(M,S,R={}){const{prehash:D}=validateSigOpts(R,v);return S=W(S,D),T.fromBytes(M,"recovered").recoverPublicKey(S).toBytes()}return Object.freeze({keygen:m,getPublicKey:E,getSharedSecret:g,utils:y,lengths:w,Point:e,sign:Z,verify:q,recoverPublicKey:$,Signature:T,hash:t})}function _weierstrass_legacy_opts_to_new(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp;let r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(l=>Math.ceil(l/2)))):void 0;const o=Field(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),c={Fp:n,Fn:o,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:c}}function _ecdsa_legacy_opts_to_new(e){const{CURVE:t,curveOpts:n}=_weierstrass_legacy_opts_to_new(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}function _ecdsa_new_output_to_legacy(e,t){const n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,nLength(n.Fn.ORDER,n.Fn.BITS))})}function weierstrass$1(e){const{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:o}=_ecdsa_legacy_opts_to_new(e),c=weierstrassN(t,n),l=ecdsa(c,r,o);return _ecdsa_new_output_to_legacy(e,l)}function createCurve(e,t){const n=r=>weierstrass$1({...e,hash:r});return{...n(t),create:n}}const secp256k1_CURVE={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2);function sqrtMod(e){const t=secp256k1_CURVE.p,n=BigInt(3),r=BigInt(6),o=BigInt(11),c=BigInt(22),l=BigInt(23),x=BigInt(44),f=BigInt(88),m=e*e*e%t,E=m*m*e%t,g=pow2(E,n,t)*E%t,y=pow2(g,n,t)*E%t,w=pow2(y,_2n,t)*m%t,v=pow2(w,o,t)*w%t,_=pow2(v,c,t)*v%t,F=pow2(_,x,t)*_%t,H=pow2(F,f,t)*F%t,Y=pow2(H,x,t)*_%t,T=pow2(Y,n,t)*E%t,L=pow2(T,l,t)*v%t,N=pow2(L,r,t)*m%t,I=pow2(N,_2n,t);if(!Fpk1.eql(Fpk1.sqr(I),e))throw new Error("Cannot find square root");return I}const Fpk1=Field(secp256k1_CURVE.p,{sqrt:sqrtMod}),secp256k1$1=createCurve({...secp256k1_CURVE,Fp:Fpk1,lowS:!0,endo:secp256k1_ENDO},sha256$1),TAGGED_HASH_PREFIXES$1={};function taggedHash$1(e,...t){let n=TAGGED_HASH_PREFIXES$1[e];if(n===void 0){const r=sha256$1(utf8ToBytes(e));n=concatBytes(r,r),TAGGED_HASH_PREFIXES$1[e]=n}return sha256$1(concatBytes(n,...t))}const pointToBytes=e=>e.toBytes(!0).slice(1),Pointk1=secp256k1$1.Point,hasEven=e=>e%_2n===_0n;function schnorrGetExtPubKey(e){const{Fn:t,BASE:n}=Pointk1,r=_normFnElement(t,e),o=n.multiply(r);return{scalar:hasEven(o.y)?r:t.neg(r),bytes:pointToBytes(o)}}function lift_x(e){const t=Fpk1;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x  p");const n=t.create(e*e),r=t.create(n*e+BigInt(7));let o=t.sqrt(r);hasEven(o)||(o=t.neg(o));const c=Pointk1.fromAffine({x:e,y:o});return c.assertValidity(),c}const num=bytesToNumberBE;function challenge(...e){return Pointk1.Fn.create(num(taggedHash$1("BIP0340/challenge",...e)))}function schnorrGetPublicKey(e){return schnorrGetExtPubKey(e).bytes}function schnorrSign(e,t,n=randomBytes(32)){const{Fn:r}=Pointk1,o=ensureBytes("message",e),{bytes:c,scalar:l}=schnorrGetExtPubKey(t),x=ensureBytes("auxRand",n,32),f=r.toBytes(l^num(taggedHash$1("BIP0340/aux",x))),m=taggedHash$1("BIP0340/nonce",f,c,o),{bytes:E,scalar:g}=schnorrGetExtPubKey(m),y=challenge(E,c,o),w=new Uint8Array(64);if(w.set(E,0),w.set(r.toBytes(r.create(g+y*l)),32),!schnorrVerify(w,o,c))throw new Error("sign: Invalid signature produced");return w}function schnorrVerify(e,t,n){const{Fn:r,BASE:o}=Pointk1,c=ensureBytes("signature",e,64),l=ensureBytes("message",t),x=ensureBytes("publicKey",n,32);try{const f=lift_x(num(x)),m=num(c.subarray(0,32));if(!inRange(m,_1n,secp256k1_CURVE.p))return!1;const E=num(c.subarray(32,64));if(!inRange(E,_1n,secp256k1_CURVE.n))return!1;const g=challenge(r.toBytes(m),pointToBytes(f),l),y=o.multiplyUnsafe(E).add(f.multiplyUnsafe(r.neg(g))),{x:w,y:v}=y.toAffine();return!(y.is0()||!hasEven(v)||w!==m)}catch{return!1}}const schnorr=(()=>{const n=(o=randomBytes(48))=>mapHashToField(o,secp256k1_CURVE.n);secp256k1$1.utils.randomSecretKey;function r(o){const c=n(o);return{secretKey:c,publicKey:schnorrGetPublicKey(c)}}return{keygen:r,getPublicKey:schnorrGetPublicKey,sign:schnorrSign,verify:schnorrVerify,Point:Pointk1,utils:{randomSecretKey:n,randomPrivateKey:n,taggedHash:taggedHash$1,lift_x,pointToBytes,numberToBytesBE,bytesToNumberBE,mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})(),sha256=sha256$1;var dist$2={},LRUCache={},LRUCacheNode={},hasRequiredLRUCacheNode;function requireLRUCacheNode(){if(hasRequiredLRUCacheNode)return LRUCacheNode;hasRequiredLRUCacheNode=1,Object.defineProperty(LRUCacheNode,"__esModule",{value:!0}),LRUCacheNode.LRUCacheNode=void 0;let e=class{constructor(n,r,o){const{entryExpirationTimeInMS:c=null,next:l=null,prev:x=null,onEntryEvicted:f,onEntryMarkedAsMostRecentlyUsed:m,clone:E,cloneFn:g}=o??{};if(typeof c=="number"&&(c<=0||Number.isNaN(c)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.clone=E??!1,this.cloneFn=g??this.defaultClone,this.key=n,this.internalValue=this.clone?this.cloneFn(r):r,this.created=Date.now(),this.entryExpirationTimeInMS=c,this.next=l,this.prev=x,this.onEntryEvicted=f,this.onEntryMarkedAsMostRecentlyUsed=m}get value(){return this.clone?this.cloneFn(this.internalValue):this.internalValue}get isExpired(){return typeof this.entryExpirationTimeInMS=="number"&&Date.now()-this.created>this.entryExpirationTimeInMS}invokeOnEvicted(){if(this.onEntryEvicted){const{key:n,value:r,isExpired:o}=this;this.onEntryEvicted({key:n,value:r,isExpired:o})}}invokeOnEntryMarkedAsMostRecentlyUsed(){if(this.onEntryMarkedAsMostRecentlyUsed){const{key:n,value:r}=this;this.onEntryMarkedAsMostRecentlyUsed({key:n,value:r})}}defaultClone(n){return typeof n=="boolean"||typeof n=="string"||typeof n=="number"?n:JSON.parse(JSON.stringify(n))}};return LRUCacheNode.LRUCacheNode=e,LRUCacheNode}var hasRequiredLRUCache;function requireLRUCache(){if(hasRequiredLRUCache)return LRUCache;hasRequiredLRUCache=1,Object.defineProperty(LRUCache,"__esModule",{value:!0}),LRUCache.LRUCache=void 0;const e=requireLRUCacheNode();let t=class{constructor(r){this.lookupTable=new Map,this.head=null,this.tail=null;const{maxSize:o=25,entryExpirationTimeInMS:c=null,onEntryEvicted:l,onEntryMarkedAsMostRecentlyUsed:x,cloneFn:f,clone:m}=r??{};if(Number.isNaN(o)||o<=0)throw new Error("maxSize must be greater than 0.");if(typeof c=="number"&&(c<=0||Number.isNaN(c)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.maxSizeInternal=o,this.entryExpirationTimeInMS=c,this.onEntryEvicted=l,this.onEntryMarkedAsMostRecentlyUsed=x,this.clone=m,this.cloneFn=f}get size(){return this.cleanCache(),this.lookupTable.size}get remainingSize(){return this.maxSizeInternal-this.size}get newest(){return this.head?this.head.isExpired?(this.removeNodeFromListAndLookupTable(this.head),this.newest):this.mapNodeToEntry(this.head):null}get oldest(){return this.tail?this.tail.isExpired?(this.removeNodeFromListAndLookupTable(this.tail),this.oldest):this.mapNodeToEntry(this.tail):null}get maxSize(){return this.maxSizeInternal}set maxSize(r){if(Number.isNaN(r)||r<=0)throw new Error("maxSize must be greater than 0.");this.maxSizeInternal=r,this.enforceSizeLimit()}set(r,o,c){const l=this.lookupTable.get(r);l&&this.removeNodeFromListAndLookupTable(l);const x=new e.LRUCacheNode(r,o,{entryExpirationTimeInMS:this.entryExpirationTimeInMS,onEntryEvicted:this.onEntryEvicted,onEntryMarkedAsMostRecentlyUsed:this.onEntryMarkedAsMostRecentlyUsed,clone:this.clone,cloneFn:this.cloneFn,...c});return this.setNodeAsHead(x),this.lookupTable.set(r,x),this.enforceSizeLimit(),this}get(r){const o=this.lookupTable.get(r);return o?o.isExpired?(this.removeNodeFromListAndLookupTable(o),null):(this.setNodeAsHead(o),o.value):null}peek(r){const o=this.lookupTable.get(r);return o?o.isExpired?(this.removeNodeFromListAndLookupTable(o),null):o.value:null}delete(r){const o=this.lookupTable.get(r);return o?this.removeNodeFromListAndLookupTable(o):!1}has(r){const o=this.lookupTable.get(r);return o?o.isExpired?(this.removeNodeFromListAndLookupTable(o),!1):!0:!1}clear(){this.head=null,this.tail=null,this.lookupTable.clear()}find(r){let o=this.head;for(;o;){if(o.isExpired){const l=o.next;this.removeNodeFromListAndLookupTable(o),o=l;continue}const c=this.mapNodeToEntry(o);if(r(c))return this.setNodeAsHead(o),c;o=o.next}return null}forEach(r){let o=this.head,c=0;for(;o;){if(o.isExpired){const l=o.next;this.removeNodeFromListAndLookupTable(o),o=l;continue}r(o.value,o.key,c),o=o.next,c++}}*values(){let r=this.head;for(;r;){if(r.isExpired){const o=r.next;this.removeNodeFromListAndLookupTable(r),r=o;continue}yield r.value,r=r.next}}*keys(){let r=this.head;for(;r;){if(r.isExpired){const o=r.next;this.removeNodeFromListAndLookupTable(r),r=o;continue}yield r.key,r=r.next}}*entries(){let r=this.head;for(;r;){if(r.isExpired){const o=r.next;this.removeNodeFromListAndLookupTable(r),r=o;continue}yield this.mapNodeToEntry(r),r=r.next}}*[Symbol.iterator](){let r=this.head;for(;r;){if(r.isExpired){const o=r.next;this.removeNodeFromListAndLookupTable(r),r=o;continue}yield this.mapNodeToEntry(r),r=r.next}}enforceSizeLimit(){let r=this.tail;for(;r!==null&&this.size>this.maxSizeInternal;){const o=r.prev;this.removeNodeFromListAndLookupTable(r),r=o}}mapNodeToEntry({key:r,value:o}){return{key:r,value:o}}setNodeAsHead(r){this.removeNodeFromList(r),this.head?(r.next=this.head,this.head.prev=r,this.head=r):(this.head=r,this.tail=r),r.invokeOnEntryMarkedAsMostRecentlyUsed()}removeNodeFromList(r){r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.head===r&&(this.head=r.next),this.tail===r&&(this.tail=r.prev),r.next=null,r.prev=null}removeNodeFromListAndLookupTable(r){return r.invokeOnEvicted(),this.removeNodeFromList(r),this.lookupTable.delete(r.key)}cleanCache(){if(!this.entryExpirationTimeInMS)return;const r=[];for(const o of this.lookupTable.values())o.isExpired&&r.push(o);r.forEach(o=>this.removeNodeFromListAndLookupTable(o))}};return LRUCache.LRUCache=t,LRUCache}var hasRequiredDist$2;function requireDist$2(){return hasRequiredDist$2||(hasRequiredDist$2=1,(function(e){var t=dist$2&&dist$2.__createBinding||(Object.create?(function(r,o,c,l){l===void 0&&(l=c);var x=Object.getOwnPropertyDescriptor(o,c);(!x||("get"in x?!o.__esModule:x.writable||x.configurable))&&(x={enumerable:!0,get:function(){return o[c]}}),Object.defineProperty(r,l,x)}):(function(r,o,c,l){l===void 0&&(l=c),r[l]=o[c]})),n=dist$2&&dist$2.__exportStar||function(r,o){for(var c in r)c!=="default"&&!Object.prototype.hasOwnProperty.call(o,c)&&t(o,r,c)};Object.defineProperty(e,"__esModule",{value:!0}),n(requireLRUCache(),e)})(dist$2)),dist$2}var distExports$2=requireDist$2();function pbkdf2Init(e,t,n,r){assert$2.hash(e);const o=checkOpts$1({dkLen:32,asyncTick:10},r),{c,dkLen:l,asyncTick:x}=o;if(assert$2.number(c),assert$2.number(l),assert$2.number(x),c<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const f=toBytes$2(t),m=toBytes$2(n),E=new Uint8Array(l),g=hmac$2.create(e,f),y=g._cloneInto().update(m);return{c,dkLen:l,asyncTick:x,DK:E,PRF:g,PRFSalt:y}}function pbkdf2Output(e,t,n,r,o){return e.destroy(),t.destroy(),r&&r.destroy(),o.fill(0),n}function pbkdf2(e,t,n,r){const{c:o,dkLen:c,DK:l,PRF:x,PRFSalt:f}=pbkdf2Init(e,t,n,r);let m;const E=new Uint8Array(4),g=createView$2(E),y=new Uint8Array(x.outputLen);for(let w=1,v=0;v<c;w++,v+=x.outputLen){const _=l.subarray(v,v+x.outputLen);g.setInt32(0,w,!1),(m=f._cloneInto(m)).update(E).digestInto(y),_.set(y.subarray(0,_.length));for(let F=1;F<o;F++){x._cloneInto(m).update(y).digestInto(y);for(let H=0;H<_.length;H++)_[H]^=y[H]}}return pbkdf2Output(x,f,l,m,y)}const rotl=(e,t)=>e<<t|e>>>32-t;function XorAndSalsa(e,t,n,r,o,c){let l=e[t++]^n[r++],x=e[t++]^n[r++],f=e[t++]^n[r++],m=e[t++]^n[r++],E=e[t++]^n[r++],g=e[t++]^n[r++],y=e[t++]^n[r++],w=e[t++]^n[r++],v=e[t++]^n[r++],_=e[t++]^n[r++],F=e[t++]^n[r++],H=e[t++]^n[r++],Y=e[t++]^n[r++],T=e[t++]^n[r++],L=e[t++]^n[r++],N=e[t++]^n[r++],I=l,U=x,W=f,O=m,Z=E,z=g,q=y,$=w,M=v,S=_,R=F,D=H,j=Y,P=T,Q=L,C=N;for(let K=0;K<8;K+=2)Z^=rotl(I+j|0,7),M^=rotl(Z+I|0,9),j^=rotl(M+Z|0,13),I^=rotl(j+M|0,18),S^=rotl(z+U|0,7),P^=rotl(S+z|0,9),U^=rotl(P+S|0,13),z^=rotl(U+P|0,18),Q^=rotl(R+q|0,7),W^=rotl(Q+R|0,9),q^=rotl(W+Q|0,13),R^=rotl(q+W|0,18),O^=rotl(C+D|0,7),$^=rotl(O+C|0,9),D^=rotl($+O|0,13),C^=rotl(D+$|0,18),U^=rotl(I+O|0,7),W^=rotl(U+I|0,9),O^=rotl(W+U|0,13),I^=rotl(O+W|0,18),q^=rotl(z+Z|0,7),$^=rotl(q+z|0,9),Z^=rotl($+q|0,13),z^=rotl(Z+$|0,18),D^=rotl(R+S|0,7),M^=rotl(D+R|0,9),S^=rotl(M+D|0,13),R^=rotl(S+M|0,18),j^=rotl(C+Q|0,7),P^=rotl(j+C|0,9),Q^=rotl(P+j|0,13),C^=rotl(Q+P|0,18);o[c++]=l+I|0,o[c++]=x+U|0,o[c++]=f+W|0,o[c++]=m+O|0,o[c++]=E+Z|0,o[c++]=g+z|0,o[c++]=y+q|0,o[c++]=w+$|0,o[c++]=v+M|0,o[c++]=_+S|0,o[c++]=F+R|0,o[c++]=H+D|0,o[c++]=Y+j|0,o[c++]=T+P|0,o[c++]=L+Q|0,o[c++]=N+C|0}function BlockMix(e,t,n,r,o){let c=r+0,l=r+16*o;for(let x=0;x<16;x++)n[l+x]=e[t+(2*o-1)*16+x];for(let x=0;x<o;x++,c+=16,t+=16)XorAndSalsa(n,l,e,t,n,c),x>0&&(l+=16),XorAndSalsa(n,c,e,t+=16,n,l)}function scryptInit(e,t,n){const r=checkOpts$1({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:o,r:c,p:l,dkLen:x,asyncTick:f,maxmem:m,onProgress:E}=r;if(assert$2.number(o),assert$2.number(c),assert$2.number(l),assert$2.number(x),assert$2.number(f),assert$2.number(m),E!==void 0&&typeof E!="function")throw new Error("progressCb should be function");const g=128*c,y=g/4;if(o<=1||(o&o-1)!==0||o>=2**(g/8)||o>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(l<0||l>(2**32-1)*32/g)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(x<0||x>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const w=g*(o+l);if(w>m)throw new Error(`Scrypt: parameters too large, ${w} (128 * r * (N + p)) > ${m} (maxmem)`);const v=pbkdf2(sha256$2,e,t,{c:1,dkLen:g*l}),_=u32$1(v),F=u32$1(new Uint8Array(g*o)),H=u32$1(new Uint8Array(g));let Y=()=>{};if(E){const T=2*o*l,L=Math.max(Math.floor(T/1e4),1);let N=0;Y=()=>{N++,E&&(!(N%L)||N===T)&&E(N/T)}}return{N:o,r:c,p:l,dkLen:x,blockSize32:y,V:F,B32:_,B:v,tmp:H,blockMixCb:Y,asyncTick:f}}function scryptOutput(e,t,n,r,o){const c=pbkdf2(sha256$2,e,n,{c:1,dkLen:t});return n.fill(0),r.fill(0),o.fill(0),c}function scrypt(e,t,n){const{N:r,r:o,p:c,dkLen:l,blockSize32:x,V:f,B32:m,B:E,tmp:g,blockMixCb:y}=scryptInit(e,t,n);for(let w=0;w<c;w++){const v=x*w;for(let _=0;_<x;_++)f[_]=m[v+_];for(let _=0,F=0;_<r-1;_++)BlockMix(f,F,f,F+=x,o),y();BlockMix(f,(r-1)*x,m,v,o),y();for(let _=0;_<r;_++){const F=m[v+x-16]%r;for(let H=0;H<x;H++)g[H]=m[v+H]^f[F*x+H];BlockMix(g,0,m,v,o),y()}}return scryptOutput(e,l,E,f,g)}var Bech32MaxSize$1=5e3;function encodeBech32$1(e,t){let n=bech32.toWords(t);return bech32.encode(e,n,Bech32MaxSize$1)}function encodeBytes$1(e,t){return encodeBech32$1(e,t)}function encrypt$1(e,t,n=16,r=2){let o=randomBytes$1(16),c=2**n,l=scrypt(t.normalize("NFKC"),o,{N:c,r:8,p:1,dkLen:32}),x=randomBytes$1(24),f=Uint8Array.from([r]),E=xchacha20poly1305(l,x,f).encrypt(e),g=concatBytes$1(Uint8Array.from([2]),Uint8Array.from([n]),o,x,f,E);return encodeBytes$1("ncryptsec",g)}function decrypt$1(e,t){let{prefix:n,words:r}=bech32.decode(e,Bech32MaxSize$1);if(n!=="ncryptsec")throw new Error(`invalid prefix ${n}, expected 'ncryptsec'`);let o=new Uint8Array(bech32.fromWords(r)),c=o[0];if(c!==2)throw new Error(`invalid version ${c}, expected 0x02`);let x=2**o[1],f=o.slice(2,18),m=o.slice(18,42),E=o[42],g=Uint8Array.from([E]),y=o.slice(43),w=scrypt(t.normalize("NFKC"),f,{N:x,r:8,p:1,dkLen:32});return xchacha20poly1305(w,m,g).decrypt(y)}const nip49_star=Object.freeze(Object.defineProperty({__proto__:null,decrypt:decrypt$1,encrypt:encrypt$1},Symbol.toStringTag,{value:"Module"}));var utf8Decoder=new TextDecoder("utf-8"),utf8Encoder=new TextEncoder,NostrTypeGuard={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},Bech32MaxSize=5e3,BECH32_REGEX$1=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function decodeNostrURI(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),decode$i(e)}catch{return{type:"invalid",data:null}}}function decode$i(e){let{prefix:t,words:n}=bech32.decode(e,Bech32MaxSize),r=new Uint8Array(bech32.fromWords(n));switch(t){case"nprofile":{let o=parseTLV(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$2(o[0][0]),relays:o[1]?o[1].map(c=>utf8Decoder.decode(c)):[]}}}case"nevent":{let o=parseTLV(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$2(o[0][0]),relays:o[1]?o[1].map(c=>utf8Decoder.decode(c)):[],author:o[2]?.[0]?bytesToHex$2(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(bytesToHex$2(o[3][0]),16):void 0}}}case"naddr":{let o=parseTLV(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder.decode(o[0][0]),pubkey:bytesToHex$2(o[2][0]),kind:parseInt(bytesToHex$2(o[3][0]),16),relays:o[1]?o[1].map(c=>utf8Decoder.decode(c)):[]}}}case"nsec":return{type:t,data:r};case"npub":case"note":return{type:t,data:bytesToHex$2(r)};default:throw new Error(`unknown prefix ${t}`)}}function parseTLV(e){let t={},n=e;for(;n.length>0;){let r=n[0],o=n[1],c=n.slice(2,2+o);if(n=n.slice(2+o),c.length<o)throw new Error(`not enough data to read on TLV ${r}`);t[r]=t[r]||[],t[r].push(c)}return t}function nsecEncode(e){return encodeBytes("nsec",e)}function npubEncode(e){return encodeBytes("npub",hexToBytes$4(e))}function noteEncode(e){return encodeBytes("note",hexToBytes$4(e))}function encodeBech32(e,t){let n=bech32.toWords(t);return bech32.encode(e,n,Bech32MaxSize)}function encodeBytes(e,t){return encodeBech32(e,t)}function nprofileEncode(e){let t=encodeTLV({0:[hexToBytes$4(e.pubkey)],1:(e.relays||[]).map(n=>utf8Encoder.encode(n))});return encodeBech32("nprofile",t)}function neventEncode(e){let t;e.kind!==void 0&&(t=integerToUint8Array(e.kind));let n=encodeTLV({0:[hexToBytes$4(e.id)],1:(e.relays||[]).map(r=>utf8Encoder.encode(r)),2:e.author?[hexToBytes$4(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return encodeBech32("nevent",n)}function naddrEncode(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let n=encodeTLV({0:[utf8Encoder.encode(e.identifier)],1:(e.relays||[]).map(r=>utf8Encoder.encode(r)),2:[hexToBytes$4(e.pubkey)],3:[new Uint8Array(t)]});return encodeBech32("naddr",n)}function encodeTLV(e){let t=[];return Object.entries(e).reverse().forEach(([n,r])=>{r.forEach(o=>{let c=new Uint8Array(o.length+2);c.set([parseInt(n)],0),c.set([o.length],1),c.set(o,2),t.push(c)})}),concatBytes$1(...t)}const nip19_star=Object.freeze(Object.defineProperty({__proto__:null,BECH32_REGEX:BECH32_REGEX$1,Bech32MaxSize,NostrTypeGuard,decode:decode$i,decodeNostrURI,encodeBytes,naddrEncode,neventEncode,noteEncode,nprofileEncode,npubEncode,nsecEncode},Symbol.toStringTag,{value:"Module"}));var lib={},hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0;function t(z){if(!Number.isSafeInteger(z))throw new Error(`Wrong integer: ${z}`)}e.assertNumber=t;function n(...z){const q=(S,R)=>D=>S(R(D)),$=Array.from(z).reverse().reduce((S,R)=>S?q(S,R.encode):R.encode,void 0),M=z.reduce((S,R)=>S?q(S,R.decode):R.decode,void 0);return{encode:$,decode:M}}function r(z){return{encode:q=>{if(!Array.isArray(q)||q.length&&typeof q[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return q.map($=>{if(t($),$<0||$>=z.length)throw new Error(`Digit index outside alphabet: ${$} (alphabet: ${z.length})`);return z[$]})},decode:q=>{if(!Array.isArray(q)||q.length&&typeof q[0]!="string")throw new Error("alphabet.decode input should be array of strings");return q.map($=>{if(typeof $!="string")throw new Error(`alphabet.decode: not string element=${$}`);const M=z.indexOf($);if(M===-1)throw new Error(`Unknown letter: "${$}". Allowed: ${z}`);return M})}}}function o(z=""){if(typeof z!="string")throw new Error("join separator should be string");return{encode:q=>{if(!Array.isArray(q)||q.length&&typeof q[0]!="string")throw new Error("join.encode input should be array of strings");for(let $ of q)if(typeof $!="string")throw new Error(`join.encode: non-string input=${$}`);return q.join(z)},decode:q=>{if(typeof q!="string")throw new Error("join.decode input should be string");return q.split(z)}}}function c(z,q="="){if(t(z),typeof q!="string")throw new Error("padding chr should be string");return{encode($){if(!Array.isArray($)||$.length&&typeof $[0]!="string")throw new Error("padding.encode input should be array of strings");for(let M of $)if(typeof M!="string")throw new Error(`padding.encode: non-string input=${M}`);for(;$.length*z%8;)$.push(q);return $},decode($){if(!Array.isArray($)||$.length&&typeof $[0]!="string")throw new Error("padding.encode input should be array of strings");for(let S of $)if(typeof S!="string")throw new Error(`padding.decode: non-string input=${S}`);let M=$.length;if(M*z%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;M>0&&$[M-1]===q;M--)if(!((M-1)*z%8))throw new Error("Invalid padding: string has too much padding");return $.slice(0,M)}}}function l(z){if(typeof z!="function")throw new Error("normalize fn should be function");return{encode:q=>q,decode:q=>z(q)}}function x(z,q,$){if(q<2)throw new Error(`convertRadix: wrong from=${q}, base cannot be less than 2`);if($<2)throw new Error(`convertRadix: wrong to=${$}, base cannot be less than 2`);if(!Array.isArray(z))throw new Error("convertRadix: data should be array");if(!z.length)return[];let M=0;const S=[],R=Array.from(z);for(R.forEach(D=>{if(t(D),D<0||D>=q)throw new Error(`Wrong integer: ${D}`)});;){let D=0,j=!0;for(let P=M;P<R.length;P++){const Q=R[P],C=q*D+Q;if(!Number.isSafeInteger(C)||q*D/q!==D||C-Q!==q*D)throw new Error("convertRadix: carry overflow");if(D=C%$,R[P]=Math.floor(C/$),!Number.isSafeInteger(R[P])||R[P]*$+D!==C)throw new Error("convertRadix: carry overflow");if(j)R[P]?j=!1:M=P;else continue}if(S.push(D),j)break}for(let D=0;D<z.length-1&&z[D]===0;D++)S.push(0);return S.reverse()}const f=(z,q)=>q?f(q,z%q):z,m=(z,q)=>z+(q-f(z,q));function E(z,q,$,M){if(!Array.isArray(z))throw new Error("convertRadix2: data should be array");if(q<=0||q>32)throw new Error(`convertRadix2: wrong from=${q}`);if($<=0||$>32)throw new Error(`convertRadix2: wrong to=${$}`);if(m(q,$)>32)throw new Error(`convertRadix2: carry overflow from=${q} to=${$} carryBits=${m(q,$)}`);let S=0,R=0;const D=2**$-1,j=[];for(const P of z){if(t(P),P>=2**q)throw new Error(`convertRadix2: invalid data word=${P} from=${q}`);if(S=S<<q|P,R+q>32)throw new Error(`convertRadix2: carry overflow pos=${R} from=${q}`);for(R+=q;R>=$;R-=$)j.push((S>>R-$&D)>>>0);S&=2**R-1}if(S=S<<$-R&D,!M&&R>=q)throw new Error("Excess padding");if(!M&&S)throw new Error(`Non-zero padding: ${S}`);return M&&R>0&&j.push(S>>>0),j}function g(z){return t(z),{encode:q=>{if(!(q instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return x(Array.from(q),2**8,z)},decode:q=>{if(!Array.isArray(q)||q.length&&typeof q[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(x(q,z,2**8))}}}function y(z,q=!1){if(t(z),z<=0||z>32)throw new Error("radix2: bits should be in (0..32]");if(m(8,z)>32||m(z,8)>32)throw new Error("radix2: carry overflow");return{encode:$=>{if(!($ instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return E(Array.from($),8,z,!q)},decode:$=>{if(!Array.isArray($)||$.length&&typeof $[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(E($,z,8,q))}}}function w(z){if(typeof z!="function")throw new Error("unsafeWrapper fn should be function");return function(...q){try{return z.apply(null,q)}catch{}}}function v(z,q){if(t(z),typeof q!="function")throw new Error("checksum fn should be function");return{encode($){if(!($ instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const M=q($).slice(0,z),S=new Uint8Array($.length+z);return S.set($),S.set(M,$.length),S},decode($){if(!($ instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const M=$.slice(0,-z),S=q(M).slice(0,z),R=$.slice(-z);for(let D=0;D<z;D++)if(S[D]!==R[D])throw new Error("Invalid checksum");return M}}}e.utils={alphabet:r,chain:n,checksum:v,radix:g,radix2:y,join:o,padding:c},e.base16=n(y(4),r("0123456789ABCDEF"),o("")),e.base32=n(y(5),r("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),c(5),o("")),e.base32hex=n(y(5),r("0123456789ABCDEFGHIJKLMNOPQRSTUV"),c(5),o("")),e.base32crockford=n(y(5),r("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),o(""),l(z=>z.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),e.base64=n(y(6),r("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),c(6),o("")),e.base64url=n(y(6),r("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),c(6),o(""));const _=z=>n(g(58),r(z),o(""));e.base58=_("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=_("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=_("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const F=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(z){let q="";for(let $=0;$<z.length;$+=8){const M=z.subarray($,$+8);q+=e.base58.encode(M).padStart(F[M.length],"1")}return q},decode(z){let q=[];for(let $=0;$<z.length;$+=11){const M=z.slice($,$+11),S=F.indexOf(M.length),R=e.base58.decode(M);for(let D=0;D<R.length-S;D++)if(R[D]!==0)throw new Error("base58xmr: wrong padding");q=q.concat(Array.from(R.slice(R.length-S)))}return Uint8Array.from(q)}};const H=z=>n(v(4,q=>z(z(q))),e.base58);e.base58check=H;const Y=n(r("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),o("")),T=[996825010,642813549,513874426,1027748829,705979059];function L(z){const q=z>>25;let $=(z&33554431)<<5;for(let M=0;M<T.length;M++)(q>>M&1)===1&&($^=T[M]);return $}function N(z,q,$=1){const M=z.length;let S=1;for(let R=0;R<M;R++){const D=z.charCodeAt(R);if(D<33||D>126)throw new Error(`Invalid prefix (${z})`);S=L(S)^D>>5}S=L(S);for(let R=0;R<M;R++)S=L(S)^z.charCodeAt(R)&31;for(let R of q)S=L(S)^R;for(let R=0;R<6;R++)S=L(S);return S^=$,Y.encode(E([S%2**30],30,5,!1))}function I(z){const q=z==="bech32"?1:734539939,$=y(5),M=$.decode,S=$.encode,R=w(M);function D(C,K,J=90){if(typeof C!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof C}`);if(!Array.isArray(K)||K.length&&typeof K[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof K}`);const ne=C.length+7+K.length;if(J!==!1&&ne>J)throw new TypeError(`Length ${ne} exceeds limit ${J}`);return C=C.toLowerCase(),`${C}1${Y.encode(K)}${N(C,K,q)}`}function j(C,K=90){if(typeof C!="string")throw new Error(`bech32.decode input should be string, not ${typeof C}`);if(C.length<8||K!==!1&&C.length>K)throw new TypeError(`Wrong string length: ${C.length} (${C}). Expected (8..${K})`);const J=C.toLowerCase();if(C!==J&&C!==C.toUpperCase())throw new Error("String must be lowercase or uppercase");C=J;const ne=C.lastIndexOf("1");if(ne===0||ne===-1)throw new Error('Letter "1" must be present between prefix and data only');const re=C.slice(0,ne),ie=C.slice(ne+1);if(ie.length<6)throw new Error("Data must be at least 6 characters long");const ce=Y.decode(ie).slice(0,-6),ue=N(re,ce,q);if(!ie.endsWith(ue))throw new Error(`Invalid checksum in ${C}: expected "${ue}"`);return{prefix:re,words:ce}}const P=w(j);function Q(C){const{prefix:K,words:J}=j(C,!1);return{prefix:K,words:J,bytes:M(J)}}return{encode:D,decode:j,decodeToBytes:Q,decodeUnsafe:P,fromWords:M,fromWordsUnsafe:R,toWords:S}}e.bech32=I("bech32"),e.bech32m=I("bech32m"),e.utf8={encode:z=>new TextDecoder().decode(z),decode:z=>new TextEncoder().encode(z)},e.hex=n(y(4),r("0123456789abcdef"),o(""),l(z=>{if(typeof z!="string"||z.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof z} with length ${z.length}`);return z.toLowerCase()}));const U={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},W=`Invalid encoding type. Available types: ${Object.keys(U).join(", ")}`,O=(z,q)=>{if(typeof z!="string"||!U.hasOwnProperty(z))throw new TypeError(W);if(!(q instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return U[z].encode(q)};e.bytesToString=O,e.str=e.bytesToString;const Z=(z,q)=>{if(!U.hasOwnProperty(z))throw new TypeError(W);if(typeof q!="string")throw new TypeError("stringToBytes() expects string");return U[z].decode(q)};e.stringToBytes=Z,e.bytes=e.stringToBytes})(lib)),lib}var bolt11,hasRequiredBolt11;function requireBolt11(){if(hasRequiredBolt11)return bolt11;hasRequiredBolt11=1;const{bech32:e,hex:t,utf8:n}=requireLib(),r={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},o={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},c={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},l={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},x={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},f=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],m={m:BigInt(1e3),u:BigInt(1e6),n:BigInt(1e9),p:BigInt(1e12)},E=BigInt("2100000000000000000"),g=BigInt(1e11),y={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},w={};for(let N=0,I=Object.keys(y);N<I.length;N++){const U=I[N],W=y[I[N]].toString();w[W]=U}const v={1:N=>t.encode(e.fromWordsUnsafe(N)),16:N=>t.encode(e.fromWordsUnsafe(N)),13:N=>n.encode(e.fromWordsUnsafe(N)),19:N=>t.encode(e.fromWordsUnsafe(N)),23:N=>t.encode(e.fromWordsUnsafe(N)),27:N=>t.encode(e.fromWordsUnsafe(N)),6:F,24:F,3:H,5:Y};function _(N){return I=>({tagCode:parseInt(N),words:e.encode("unknown",I,Number.MAX_SAFE_INTEGER)})}function F(N){return N.reverse().reduce((I,U,W)=>I+U*Math.pow(32,W),0)}function H(N){const I=[];let U,W,O,Z,z,q=e.fromWordsUnsafe(N);for(;q.length>0;)U=t.encode(q.slice(0,33)),W=t.encode(q.slice(33,41)),O=parseInt(t.encode(q.slice(41,45)),16),Z=parseInt(t.encode(q.slice(45,49)),16),z=parseInt(t.encode(q.slice(49,51)),16),q=q.slice(51),I.push({pubkey:U,short_channel_id:W,fee_base_msat:O,fee_proportional_millionths:Z,cltv_expiry_delta:z});return I}function Y(N){const I=N.slice().reverse().map(O=>[!!(O&1),!!(O&2),!!(O&4),!!(O&8),!!(O&16)]).reduce((O,Z)=>O.concat(Z),[]);for(;I.length<f.length*2;)I.push(!1);const U={};f.forEach((O,Z)=>{let z;I[Z*2]?z="required":I[Z*2+1]?z="supported":z="unsupported",U[O]=z});const W=I.slice(f.length*2);return U.extra_bits={start_bit:f.length*2,bits:W,has_required:W.reduce((O,Z,z)=>z%2!==0?O||!1:O||Z,!1)},U}function T(N,I){let U,W;if(N.slice(-1).match(/^[munp]$/))U=N.slice(-1),W=N.slice(0,-1);else{if(N.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");W=N}if(!W.match(/^\d+$/))throw new Error("Not a valid human readable amount");const O=BigInt(W),Z=U?O*g/m[U]:O*g;if(U==="p"&&O%BigInt(10)!==BigInt(0)||Z>E)throw new Error("Amount is outside of valid range");return I?Z.toString():Z}function L(N,I){if(typeof N!="string")throw new Error("Lightning Payment Request must be string");if(N.slice(0,2).toLowerCase()!=="ln")throw new Error("Not a proper lightning payment request");const U=[],W=e.decode(N,Number.MAX_SAFE_INTEGER);N=N.toLowerCase();const O=W.prefix;let Z=W.words,z=N.slice(O.length+1),q=Z.slice(-104);Z=Z.slice(0,-104);let $=O.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if($&&!$[2]&&($=O.match(/^ln(\S+)$/)),!$)throw new Error("Not a proper lightning payment request");U.push({name:"lightning_network",letters:"ln"});const M=$[1];let S;if(I){if(I.bech32===void 0||I.pubKeyHash===void 0||I.scriptHash===void 0||!Array.isArray(I.validWitnessVersions))throw new Error("Invalid network");S=I}else switch(M){case r.bech32:S=r;break;case o.bech32:S=o;break;case c.bech32:S=c;break;case l.bech32:S=l;break;case x.bech32:S=x;break}if(!S||S.bech32!==M)throw new Error("Unknown coin bech32 prefix");U.push({name:"coin_network",letters:M,value:S});const R=$[2];let D;if(R){const re=$[3];D=T(R+re,!0),U.push({name:"amount",letters:$[2]+$[3],value:D})}else D=null;U.push({name:"separator",letters:"1"});const j=F(Z.slice(0,7));Z=Z.slice(7),U.push({name:"timestamp",letters:z.slice(0,7),value:j}),z=z.slice(7);let P,Q,C,K;for(;Z.length>0;){const re=Z[0].toString();P=w[re]||"unknown_tag",Q=v[re]||_(re),Z=Z.slice(1),C=F(Z.slice(0,2)),Z=Z.slice(2),K=Z.slice(0,C),Z=Z.slice(C),U.push({name:P,tag:z[0],letters:z.slice(0,3+C),value:Q(K)}),z=z.slice(3+C)}U.push({name:"signature",letters:z.slice(0,104),value:t.encode(e.fromWordsUnsafe(q))}),z=z.slice(104),U.push({name:"checksum",letters:z});let J={paymentRequest:N,sections:U,get expiry(){let re=U.find(ie=>ie.name==="expiry");if(re)return ne("timestamp")+re.value},get route_hints(){return U.filter(re=>re.name==="route_hint").map(re=>re.value)}};for(let re in y)re!=="route_hint"&&Object.defineProperty(J,re,{get(){return ne(re)}});return J;function ne(re){let ie=U.find(ce=>ce.name===re);return ie?ie.value:void 0}}return bolt11={decode:L,hrpToMillisat:T},bolt11}requireBolt11();var __defProp$1=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp$1=Object.prototype.hasOwnProperty,__copyProps=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of __getOwnPropNames(t))!__hasOwnProp$1.call(e,o)&&o!==n&&__defProp$1(e,o,{get:()=>t[o],enumerable:!(r=__getOwnPropDesc(t,o))||r.enumerable});return e},__reExport=(e,t,n)=>(__copyProps(e,t,"default"),n);function getRelaysForSync(e,t,n="write"){if(!e.outboxTracker)return;const r=e.outboxTracker.data.get(t);if(r)return n==="write"?r.writeRelays:r.readRelays}async function getWriteRelaysFor(e,t,n="write"){if(e.outboxTracker)return e.outboxTracker.data.has(t)||await e.outboxTracker.trackUsers([t]),getRelaysForSync(e,t,n)}function getTopRelaysForAuthors(e,t){const n=new Map;return t.forEach(o=>{const c=getRelaysForSync(e,o);c&&c.forEach(l=>{const x=n.get(l)||0;n.set(l,x+1)})}),Array.from(n.entries()).sort((o,c)=>c[1]-o[1]).map(o=>o[0])}function getAllRelaysForAllPubkeys(e,t,n="read"){const r=new Map,o=new Set;return t.forEach(c=>{const l=getRelaysForSync(e,c,n);l&&l.size>0?(l.forEach(x=>{(r.get(x)||new Set).add(c)}),r.set(c,l)):o.add(c)}),{pubkeysToRelays:r,authorsMissingRelays:o}}function chooseRelayCombinationForPubkeys(e,t,n,{count:r,preferredRelays:o}={}){r??=2,o??=new Set;const c=e.pool,l=c.connectedRelays();l.forEach(y=>{o?.add(y.url)});const x=new Map,{pubkeysToRelays:f,authorsMissingRelays:m}=getAllRelaysForAllPubkeys(e,t,n),E=getTopRelaysForAuthors(e,t),g=(y,w)=>{const v=x.get(w)||[];v.push(y),x.set(w,v)};for(const[y,w]of f.entries()){let v=r;const _=new Set;for(const F of l)w.has(F.url)&&(g(y,F.url),_.add(F.url),v--);for(const F of w)_.has(F)||x.has(F)&&(g(y,F),_.add(F),v--);if(!(v<=0))for(const F of E){if(v<=0)break;_.has(F)||w.has(F)&&(g(y,F),_.add(F),v--)}}for(const y of m)c.permanentAndConnectedRelays().forEach(w=>{const v=x.get(w.url)||[];v.push(y),x.set(w.url,v)});return x}function getRelaysForFilterWithAuthors(e,t,n=2){return chooseRelayCombinationForPubkeys(e,t,"write",{count:n})}function tryNormalizeRelayUrl(e){try{return normalizeRelayUrl(e)}catch{return}}function normalizeRelayUrl(e){let t=normalizeUrl(e,{stripAuthentication:!1,stripWWW:!1,stripHash:!0});return t.endsWith("/")||(t+="/"),t}function normalize(e){const t=new Set;for(const n of e)try{t.add(normalizeRelayUrl(n))}catch{}return Array.from(t)}var DATA_URL_DEFAULT_MIME_TYPE="text/plain",DATA_URL_DEFAULT_CHARSET="us-ascii",testParameter=(e,t)=>t.some(n=>n instanceof RegExp?n.test(e):n===e),supportedProtocols=new Set(["https:","http:","file:"]),hasCustomProtocol=e=>{try{const{protocol:t}=new URL(e);return t.endsWith(":")&&!t.includes(".")&&!supportedProtocols.has(t)}catch{return!1}},normalizeDataURL=(e,{stripHash:t})=>{const n=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!n)throw new Error(`Invalid URL: ${e}`);const r=n.groups?.type??"",o=n.groups?.data??"";let c=n.groups?.hash??"";const l=r.split(";");c=t?"":c;let x=!1;l[l.length-1]==="base64"&&(l.pop(),x=!0);const f=l.shift()?.toLowerCase()??"",E=[...l.map(g=>{let[y,w=""]=g.split("=").map(v=>v.trim());return y==="charset"&&(w=w.toLowerCase(),w===DATA_URL_DEFAULT_CHARSET)?"":`${y}${w?`=${w}`:""}`}).filter(Boolean)];return x&&E.push("base64"),(E.length>0||f&&f!==DATA_URL_DEFAULT_MIME_TYPE)&&E.unshift(f),`data:${E.join(";")},${x?o.trim():o}${c?`#${c}`:""}`};function normalizeUrl(e,t={}){if(t={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...t},typeof t.defaultProtocol=="string"&&!t.defaultProtocol.endsWith(":")&&(t.defaultProtocol=`${t.defaultProtocol}:`),e=e.trim(),/^data:/i.test(e))return normalizeDataURL(e,t);if(hasCustomProtocol(e))return e;const n=e.startsWith("//");!n&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));const o=new URL(e);if(o.hostname=o.hostname.toLowerCase(),t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&o.protocol==="https:"&&(o.protocol="http:"),t.forceHttps&&o.protocol==="http:"&&(o.protocol="https:"),t.stripAuthentication&&(o.username="",o.password=""),t.stripHash?o.hash="":t.stripTextFragment&&(o.hash=o.hash.replace(/#?:~:text.*?$/i,"")),o.pathname){const l=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let x=0,f="";for(;;){const E=l.exec(o.pathname);if(!E)break;const g=E[0],y=E.index,w=o.pathname.slice(x,y);f+=w.replace(/\/{2,}/g,"/"),f+=g,x=y+g.length}const m=o.pathname.slice(x,o.pathname.length);f+=m.replace(/\/{2,}/g,"/"),o.pathname=f}if(o.pathname)try{o.pathname=decodeURI(o.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let l=o.pathname.split("/");const x=l[l.length-1];testParameter(x,t.removeDirectoryIndex)&&(l=l.slice(0,-1),o.pathname=`${l.slice(1).join("/")}/`)}if(o.hostname&&(o.hostname=o.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(o.hostname)&&(o.hostname=o.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(const l of[...o.searchParams.keys()])testParameter(l,t.removeQueryParameters)&&o.searchParams.delete(l);if(!Array.isArray(t.keepQueryParameters)&&t.removeQueryParameters===!0&&(o.search=""),Array.isArray(t.keepQueryParameters)&&t.keepQueryParameters.length>0)for(const l of[...o.searchParams.keys()])testParameter(l,t.keepQueryParameters)||o.searchParams.delete(l);if(t.sortQueryParameters){o.searchParams.sort();try{o.search=decodeURIComponent(o.search)}catch{}}t.removeTrailingSlash&&(o.pathname=o.pathname.replace(/\/$/,"")),t.removeExplicitPort&&o.port&&(o.port="");const c=e;return e=o.toString(),!t.removeSingleSlash&&o.pathname==="/"&&!c.endsWith("/")&&o.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||o.pathname==="/")&&o.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),n&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var NDKRelayKeepalive=class{constructor(e=3e4,t){this.onSilenceDetected=t,this.timeout=e}lastActivity=Date.now();timer;timeout;isRunning=!1;recordActivity(){this.lastActivity=Date.now(),this.isRunning&&this.resetTimer()}start(){this.isRunning||(this.isRunning=!0,this.lastActivity=Date.now(),this.resetTimer())}stop(){this.isRunning=!1,this.timer&&(clearTimeout(this.timer),this.timer=void 0)}resetTimer(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{const e=Date.now()-this.lastActivity;if(e>=this.timeout)this.onSilenceDetected();else{const t=this.timeout-e;this.timer=setTimeout(()=>{this.onSilenceDetected()},t)}},this.timeout)}};async function probeRelayConnection(e){const t=`probe-${Math.random().toString(36).substring(7)}`;return new Promise(n=>{let r=!1;const o=setTimeout(()=>{r||(r=!0,e.send(["CLOSE",t]),n(!1))},5e3),c=()=>{r||(r=!0,clearTimeout(o),e.send(["CLOSE",t]),n(!0))};e.once("message",c),e.send(["REQ",t,{kinds:[99999],limit:0}])})}var MAX_RECONNECT_ATTEMPTS=5,FLAPPING_THRESHOLD_MS=1e3,NDKRelayConnectivity=class{ndkRelay;ws;_status;timeoutMs;connectedAt;_connectionStats={attempts:0,success:0,durations:[]};debug;netDebug;connectTimeout;reconnectTimeout;ndk;openSubs=new Map;openCountRequests=new Map;openEventPublishes=new Map;pendingAuthPublishes=new Map;serial=0;baseEoseTimeout=4400;keepalive;wsStateMonitor;sleepDetector;lastSleepCheck=Date.now();lastMessageSent=Date.now();wasIdle=!1;constructor(e,t){this.ndkRelay=e,this._status=1;const n=Math.floor(Math.random()*1e3);this.debug=this.ndkRelay.debug.extend(`connectivity${n}`),this.ndk=t,this.setupMonitoring()}setupMonitoring(){this.keepalive=new NDKRelayKeepalive(12e4,async()=>{this.debug("Relay silence detected, probing connection"),await probeRelayConnection({send:t=>this.send(JSON.stringify(t)),once:(t,n)=>{const r=o=>{try{const c=JSON.parse(o.data);(c[0]==="EOSE"||c[0]==="EVENT"||c[0]==="NOTICE")&&(n(),this.ws?.removeEventListener("message",r))}catch{}};this.ws?.addEventListener("message",r)}})||(this.debug("Probe failed, connection is stale"),this.handleStaleConnection())}),this.wsStateMonitor=setInterval(()=>{this._status===5&&(!this.ws||this.ws.readyState!==WebSocket.OPEN)&&(this.debug("WebSocket died silently, reconnecting"),this.handleStaleConnection())},5e3),this.sleepDetector=setInterval(()=>{const e=Date.now(),t=e-this.lastSleepCheck;t>15e3&&(this.debug(`Detected possible sleep/wake (${t}ms gap)`),this.handlePossibleWake()),this.lastSleepCheck=e},1e4)}handleStaleConnection(){this._status=1,this.wasIdle=!0,this.onDisconnect()}handlePossibleWake(){this.debug("System wake detected, checking all connections"),this.wasIdle=!0,this._status>=5&&(!this.ws||this.ws.readyState!==WebSocket.OPEN?this.handleStaleConnection():probeRelayConnection({send:e=>this.send(JSON.stringify(e)),once:(e,t)=>{const n=r=>{try{const o=JSON.parse(r.data);(o[0]==="EOSE"||o[0]==="EVENT"||o[0]==="NOTICE")&&(t(),this.ws?.removeEventListener("message",n))}catch{}};this.ws?.addEventListener("message",n)}}).then(e=>{e||this.handleStaleConnection()}))}resetReconnectionState(){this.wasIdle=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}async connect(e,t=!0){if(this.ws&&this.ws.readyState!==WebSocket.OPEN&&this.ws.readyState!==WebSocket.CONNECTING){this.debug("Cleaning up stale WebSocket connection");try{this.ws.close()}catch{}this.ws=void 0,this._status=1}if(this._status!==2&&this._status!==1||this.reconnectTimeout){this.debug("Relay requested to be connected but was in state %s or it had a reconnect timeout",this._status);return}this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),e??=this.timeoutMs,!this.timeoutMs&&e&&(this.timeoutMs=e),this.timeoutMs&&(this.connectTimeout=setTimeout(()=>this.onConnectionError(t),this.timeoutMs));try{this.updateConnectionStats.attempt(),this._status===1?this._status=4:this._status=2,this.ws=new WebSocket(this.ndkRelay.url),this.ws.onopen=this.onConnect.bind(this),this.ws.onclose=this.onDisconnect.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onerror=this.onError.bind(this)}catch(n){throw this.debug(`Failed to connect to ${this.ndkRelay.url}`,n),this._status=1,t?this.handleReconnection():this.ndkRelay.emit("delayed-connect",2880*60*1e3),n}}disconnect(){this._status=0,this.keepalive?.stop(),this.wsStateMonitor&&(clearInterval(this.wsStateMonitor),this.wsStateMonitor=void 0),this.sleepDetector&&(clearInterval(this.sleepDetector),this.sleepDetector=void 0);try{this.ws?.close()}catch(e){this.debug("Failed to disconnect",e),this._status=1}}onConnectionError(e){this.debug(`Error connecting to ${this.ndkRelay.url}`,this.timeoutMs),e&&!this.reconnectTimeout&&this.handleReconnection()}onConnect(){this.netDebug?.("connected",this.ndkRelay),this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.updateConnectionStats.connected(),this._status=5,this.keepalive?.start(),this.wasIdle=!1,this.ndkRelay.emit("connect"),this.ndkRelay.emit("ready")}onDisconnect(){this.netDebug?.("disconnected",this.ndkRelay),this.updateConnectionStats.disconnected(),this.keepalive?.stop(),this.clearPendingPublishes(new Error(`Relay ${this.ndkRelay.url} disconnected`)),this._status===5&&this.handleReconnection(),this._status=1,this.ndkRelay.emit("disconnect")}onMessage(e){this.netDebug?.(e.data,this.ndkRelay,"recv"),this.keepalive?.recordActivity();try{const t=JSON.parse(e.data),[n,r,...o]=t,c=this.ndkRelay.getProtocolHandler(n);if(c){c(this.ndkRelay,t);return}switch(n){case"EVENT":{const l=this.openSubs.get(r),x=t[2];if(!l){this.debug(`Received event for unknown subscription ${r}`);return}l.onevent(x);return}case"COUNT":{const l=t[2],x=this.openCountRequests.get(r);x&&(x.resolve(l.count),this.openCountRequests.delete(r));return}case"EOSE":{const l=this.openSubs.get(r);if(!l)return;l.oneose(r);return}case"OK":{const l=t[2],x=t[3],f=this.openEventPublishes.get(r),m=f?.pop();if(!f||!m){this.debug("Received OK for unknown event publish",r);return}l?(m.resolve(x),this.pendingAuthPublishes.delete(r)):x&&(x.toLowerCase().includes("auth-required")||x.toLowerCase().includes("not authorized")||x.toLowerCase().includes("blocked: not authorized"))?this.pendingAuthPublishes.get(r)?(this.debug("Publish failed due to auth-required, will retry after auth",r),f.push(m),this.openEventPublishes.set(r,f)):m.reject(new Error(x)):(m.reject(new Error(x)),this.pendingAuthPublishes.delete(r)),f.length===0?this.openEventPublishes.delete(r):!l&&!(x?.toLowerCase().includes("auth-required")||x?.toLowerCase().includes("not authorized")||x?.toLowerCase().includes("blocked: not authorized"))&&this.openEventPublishes.set(r,f);return}case"CLOSED":{const l=this.openSubs.get(r);if(!l)return;l.onclosed(t[2]);return}case"NOTICE":this.onNotice(t[1]);return;case"AUTH":{this.onAuthRequested(t[1]);return}}}catch(t){this.debug(`Error parsing message from ${this.ndkRelay.url}: ${t.message}`,t?.stack);return}}async onAuthRequested(e){const t=this.ndkRelay.authPolicy??this.ndk?.relayAuthDefaultPolicy;if(this.debug("Relay requested authentication",{havePolicy:!!t}),this._status===7){this.debug("Already authenticating, ignoring");return}if(this._status=6,t){if(this._status>=5){this._status=7;let n;try{n=await t(this.ndkRelay,e)}catch(r){this.debug("Authentication policy threw an error",r),n=!1}if(this.debug("Authentication policy returned",!!n),n instanceof NDKEvent||n===!0){n instanceof NDKEvent&&await this.auth(n);const r=async()=>{if(this._status>=5&&this._status<8){const o=new NDKEvent(this.ndk);o.kind=22242,o.tags=[["relay",this.ndkRelay.url],["challenge",e]],await o.sign(),this.auth(o).then(()=>{this._status=8,this.ndkRelay.emit("authed"),this.debug("Authentication successful"),this.retryPendingAuthPublishes()}).catch(c=>{this._status=6,this.ndkRelay.emit("auth:failed",c),this.debug("Authentication failed",c),this.rejectPendingAuthPublishes(c)})}else this.debug("Authentication failed, it changed status, status is %d",this._status)};n===!0&&(this.ndk?.signer?r().catch(o=>{console.error("Error authenticating",o)}):(this.debug("No signer available for authentication localhost"),this.ndk?.once("signer:ready",r))),this._status=5,this.ndkRelay.emit("authed")}}}else this.ndkRelay.emit("auth",e)}onError(e){this.debug(`WebSocket error on ${this.ndkRelay.url}:`,e)}get status(){return this._status}isAvailable(){return this._status===5}isFlapping(){const e=this._connectionStats.durations;if(e.length%3!==0)return!1;const n=e.reduce((l,x)=>l+x,0)/e.length,r=e.map(l=>(l-n)**2).reduce((l,x)=>l+x,0)/e.length;return Math.sqrt(r)<FLAPPING_THRESHOLD_MS}async onNotice(e){this.ndkRelay.emit("notice",e)}handleReconnection(e=0){if(this.reconnectTimeout)return;if(this.isFlapping()){this.ndkRelay.emit("flapping",this._connectionStats),this._status=3;return}let t;if(this.wasIdle){const n=[0,1e3,2e3,5e3,1e4,3e4];t=n[Math.min(e,n.length-1)],this.debug(`Using aggressive reconnect after idle, attempt ${e}, delay ${t}ms`)}else this.connectedAt?t=Math.max(0,6e4-(Date.now()-this.connectedAt)):(t=Math.min(1e3*2**e,3e4),this.debug(`Using standard backoff, attempt ${e}, delay ${t}ms`));this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=void 0,this._status=2,this.connect().catch(n=>{e<MAX_RECONNECT_ATTEMPTS?this.handleReconnection(e+1):(this.debug("Max reconnect attempts reached"),this.wasIdle=!1)})},t),this.ndkRelay.emit("delayed-connect",t),this.debug("Reconnecting in",t),this._connectionStats.nextReconnectAt=Date.now()+t}async send(e){Date.now()-this.lastMessageSent>12e4&&(this.wasIdle=!0),this._status>=5&&this.ws?.readyState===WebSocket.OPEN?(this.ws?.send(e),this.netDebug?.(e,this.ndkRelay,"send"),this.lastMessageSent=Date.now()):(this.debug(`Not connected to ${this.ndkRelay.url} (%d), not sending message ${e}`,this._status),this._status>=5&&this.ws?.readyState!==WebSocket.OPEN&&(this.debug(`Stale connection detected, WebSocket state: ${this.ws?.readyState}`),this.handleStaleConnection()))}async auth(e){const t=new Promise((n,r)=>{const o=this.openEventPublishes.get(e.id)??[];o.push({resolve:n,reject:r}),this.openEventPublishes.set(e.id,o)});return this.send(`["AUTH",${JSON.stringify(e.rawEvent())}]`),t}clearPendingPublishes(e){this.rejectPendingAuthPublishes(e);for(const[t,n]of this.openEventPublishes.entries()){for(;n.length>0;){const r=n.shift();r&&r.reject(e)}this.openEventPublishes.delete(t)}}retryPendingAuthPublishes(){if(this.pendingAuthPublishes.size!==0){this.debug(`Retrying ${this.pendingAuthPublishes.size} pending publishes after auth`);for(const[e,t]of this.pendingAuthPublishes.entries())this.debug(`Retrying publish for event ${e}`),this.send(`["EVENT",${JSON.stringify(t)}]`);this.pendingAuthPublishes.clear()}}rejectPendingAuthPublishes(e){if(this.pendingAuthPublishes.size!==0){this.debug(`Rejecting ${this.pendingAuthPublishes.size} pending publishes due to auth failure`);for(const[t]of this.pendingAuthPublishes.entries()){const n=this.openEventPublishes.get(t);if(n&&n.length>0){const r=n.pop();r&&r.reject(new Error(`Authentication failed: ${e.message}`)),n.length===0&&this.openEventPublishes.delete(t)}}this.pendingAuthPublishes.clear()}}async publish(e){const t=new Promise((n,r)=>{const o=this.openEventPublishes.get(e.id)??[];o.length>0&&console.warn(`Duplicate event publishing detected, you are publishing event ${e.id} twice`),o.push({resolve:n,reject:r}),this.openEventPublishes.set(e.id,o)});return this.pendingAuthPublishes.set(e.id,e),this.send(`["EVENT",${JSON.stringify(e)}]`),t}async count(e,t){this.serial++;const n=t?.id||`count:${this.serial}`,r=new Promise((o,c)=>{this.openCountRequests.set(n,{resolve:o,reject:c})});return this.send(`["COUNT","${n}",${JSON.stringify(e).substring(1)}`),r}close(e,t){this.send(`["CLOSE","${e}"]`);const n=this.openSubs.get(e);this.openSubs.delete(e),n&&n.onclose(t)}req(e){`${this.send(`["REQ","${e.subId}",${JSON.stringify(e.executeFilters).substring(1)}`)}`,this.openSubs.set(e.subId,e)}updateConnectionStats={connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++,this._connectionStats.connectedAt=Date.now()}};get connectionStats(){return this._connectionStats}get url(){return this.ndkRelay.url}get connected(){return this._status>=5&&this.ws?.readyState===WebSocket.OPEN}};async function fetchRelayInformation(e){const t=e.replace(/^wss:\/\//,"https://").replace(/^ws:\/\//,"http://"),n=await fetch(t,{headers:{Accept:"application/nostr+json"}});if(!n.ok)throw new Error(`Failed to fetch relay information: ${n.status} ${n.statusText}`);return await n.json()}var NDKRelayPublisher=class{ndkRelay;debug;constructor(e){this.ndkRelay=e,this.debug=e.debug.extend("publisher")}async publish(e,t=2500){let n;const r=()=>new Promise((E,g)=>{try{this.publishEvent(e).then(y=>{this.ndkRelay.emit("published",e),e.emit("relay:published",this.ndkRelay),E(!0)}).catch(g)}catch(y){g(y)}}),o=new Promise((E,g)=>{n=setTimeout(()=>{n=void 0,g(new Error(`Timeout: ${t}ms`))},t)}),c=()=>{r().then(E=>l(E)).catch(E=>x(E))};let l,x;const f=E=>{throw this.ndkRelay.debug("Publish failed",E,e.id),this.ndkRelay.emit("publish:failed",e,E),e.emit("relay:publish:failed",this.ndkRelay,E),E},m=()=>{n&&clearTimeout(n),this.ndkRelay.removeListener("connect",c)};return this.ndkRelay.status>=5?Promise.race([r(),o]).catch(f).finally(m):(this.ndkRelay.status<=1?(console.warn("Relay is disconnected, trying to connect to publish an event",this.ndkRelay.url),this.ndkRelay.connect()):console.warn("Relay not connected, waiting for connection to publish an event",this.ndkRelay.url),Promise.race([new Promise((E,g)=>{l=E,x=g,this.ndkRelay.on("connect",c)}),o]).catch(f).finally(m))}async publishEvent(e){return this.ndkRelay.connectivity.publish(e.rawEvent())}};function filterFingerprint(e,t){const n=[];for(const o of e){const c=Object.entries(o||{}).map(([l,x])=>["since","until"].includes(l)?`${l}:${x}`:l).sort().join("-");n.push(c)}let r=t?"+":"";return r+=n.join("|"),r}function mergeFilters(e){const t=[],n={};return e.filter(r=>!!r.limit).forEach(r=>t.push(r)),e=e.filter(r=>!r.limit),e.length===0?t:(e.forEach(r=>{Object.entries(r).forEach(([o,c])=>{Array.isArray(c)?n[o]===void 0?n[o]=[...c]:n[o]=Array.from(new Set([...n[o],...c])):n[o]=c})}),[...t,n])}var MAX_ITEMS=3;function formatArray(e,t){const r=(t?e.slice(0,MAX_ITEMS).map(t):e.slice(0,MAX_ITEMS)).join(",");return e.length>MAX_ITEMS?`${r}+${e.length-MAX_ITEMS}`:r}function formatFilters(e){return e.map(t=>{const n=[];t.ids?.length&&n.push(`ids:[${formatArray(t.ids,r=>String(r).slice(0,8))}]`),t.kinds?.length&&n.push(`kinds:[${formatArray(t.kinds)}]`),t.authors?.length&&n.push(`authors:[${formatArray(t.authors,r=>String(r).slice(0,8))}]`),t.since&&n.push(`since:${t.since}`),t.until&&n.push(`until:${t.until}`),t.limit&&n.push(`limit:${t.limit}`),t.search&&n.push(`search:"${String(t.search).slice(0,20)}"`);for(const[r,o]of Object.entries(t))r.startsWith("#")&&Array.isArray(o)&&o.length>0&&n.push(`${r}:[${formatArray(o,c=>String(c).slice(0,8))}]`);return`{${n.join(" ")}}`}).join(", ")}var NDKRelaySubscription=class{fingerprint;items=new Map;topSubManager;debug;status=0;onClose;relay;eosed=!1;executionTimer;fireTime;delayType;executeFilters;id=Math.random().toString(36).substring(7);constructor(e,t,n){this.relay=e,this.topSubManager=n,this.debug=e.debug.extend(`sub[${this.id}]`),this.fingerprint=t||Math.random().toString(36).substring(7)}_subId;get subId(){return this._subId?this._subId:(this._subId=this.fingerprint.slice(0,15),this._subId)}subIdParts=new Set;addSubIdPart(e){this.subIdParts.add(e)}addItem(e,t){if(this.debug("Adding item",{filters:formatFilters(t),internalId:e.internalId,status:this.status,fingerprint:this.fingerprint,id:this.subId,itemsSize:this.items.size}),!this.items.has(e.internalId))switch(e.on("close",this.removeItem.bind(this,e)),this.items.set(e.internalId,{subscription:e,filters:t}),this.status!==3&&e.subId&&(!this._subId||this._subId.length<25)&&(this.status===0||this.status===1)&&this.addSubIdPart(e.subId),this.status){case 0:this.evaluateExecutionPlan(e);break;case 3:break;case 1:this.evaluateExecutionPlan(e);break;case 4:throw this.debug("Subscription is closed, cannot add new items",{filters:formatFilters(t),subId:e.subId,internalId:e.internalId}),new Error("Cannot add new items to a closed subscription")}}removeItem(e){if(this.items.delete(e.internalId),this.items.size===0){if(!this.eosed)return;this.close(),this.cleanup()}}close(){if(this.status===4)return;const e=this.status;if(this.status=4,e===3)try{this.relay.close(this.subId)}catch(t){this.debug("Error closing subscription",t,this)}else this.debug("Subscription wanted to close but it wasn't running, this is probably ok",{subId:this.subId,prevStatus:e,sub:this});this.cleanup()}cleanup(){this.executionTimer&&clearTimeout(this.executionTimer),this.relay.off("ready",this.executeOnRelayReady),this.relay.off("authed",this.reExecuteAfterAuth),this.onClose&&this.onClose(this)}evaluateExecutionPlan(e){if(!e.isGroupable()){this.status=1,this.execute();return}if(e.filters.find(r=>!!r.limit)&&(this.executeFilters=this.compileFilters(),this.executeFilters.length>=10)){this.status=1,this.execute();return}const t=e.groupableDelay,n=e.groupableDelayType;if(!t)throw new Error("Cannot group a subscription without a delay");if(this.status===0)this.schedule(t,n);else{const r=this.delayType,o=this.fireTime-Date.now();if(r==="at-least"&&n==="at-least")o<t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,n));else if(r==="at-least"&&n==="at-most")o>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,n));else if(r==="at-most"&&n==="at-most")o>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,n));else if(r==="at-most"&&n==="at-least")o>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,n));else throw new Error(`Unknown delay type combination ${r} ${n}`)}}schedule(e,t){this.status=1;const n=Date.now();this.fireTime=n+e,this.delayType=t;const r=setTimeout(this.execute.bind(this),e);t==="at-least"&&(this.executionTimer=r)}executeOnRelayReady=()=>{if(this.status===2){if(this.items.size===0){this.debug("No items to execute; this relay was probably too slow to respond and the caller gave up",{status:this.status,fingerprint:this.fingerprint,id:this.id,subId:this.subId}),this.cleanup();return}this.debug("Executing on relay ready",{status:this.status,fingerprint:this.fingerprint,itemsSize:this.items.size,filters:formatFilters(this.compileFilters())}),this.status=1,this.execute()}};finalizeSubId(){if(this.subIdParts.size>0){let t=Array.from(this.subIdParts).map(n=>n.substring(0,10)).join("-");t.length>20&&(t=t.substring(0,20)),this._subId=t}else this._subId=this.fingerprint.slice(0,15);this._subId+=`-${Math.random().toString(36).substring(2,7)}`}reExecuteAfterAuth=(()=>{const e=this.subId;this.debug("Re-executing after auth",this.items.size),this.eosed?this.relay.close(this.subId):this.debug("We are abandoning an opened subscription, once it EOSE's, the handler will close it",{oldSubId:e}),this._subId=void 0,this.status=1,this.execute(),this.debug("Re-executed after auth %s  %s",e,this.subId)}).bind(this);execute(){if(this.status===1){if(!this.relay.connected){this.status=2,this.debug("Waiting for relay to be ready",{status:this.status,id:this.subId,fingerprint:this.fingerprint,itemsSize:this.items.size}),this.relay.once("ready",this.executeOnRelayReady);return}this.relay.status<8&&this.relay.once("authed",this.reExecuteAfterAuth),this.status=3,this.finalizeSubId(),this.executeFilters=this.compileFilters(),this.relay.req(this)}}onstart(){}onevent(e){this.topSubManager.dispatchEvent(e,this.relay)}oneose(e){if(this.eosed=!0,e!==this.subId){this.debug("Received EOSE for an abandoned subscription",e,this.subId),this.relay.close(e);return}this.items.size===0&&this.close();for(const{subscription:t}of this.items.values())t.eoseReceived(this.relay),t.closeOnEose&&(this.debug("Removing item because of EOSE",{filters:formatFilters(t.filters),internalId:t.internalId,status:this.status,fingerprint:this.fingerprint,itemsSize:this.items.size}),this.removeItem(t))}onclose(e){this.status=4}onclosed(e){if(e)for(const{subscription:t}of this.items.values())t.closedReceived(this.relay,e)}compileFilters(){const e=[],t=Array.from(this.items.values()).map(r=>r.filters);if(!t[0])return this.debug(" No filters to merge",{itemsSize:this.items.size}),[];const n=t[0].length;for(let r=0;r<n;r++){const o=t.map(l=>l[r]),c=mergeFilters(o);e.push(...c)}return e}},NDKRelaySubscriptionManager=class{relay;subscriptions;generalSubManager;constructor(e,t){this.relay=e,this.subscriptions=new Map,this.generalSubManager=t}addSubscription(e,t){let n;if(!e.isGroupable())n=this.createSubscription(e,t);else{const r=filterFingerprint(t,e.closeOnEose);r&&(n=(this.subscriptions.get(r)||[]).find(c=>c.status<3)),n??=this.createSubscription(e,t,r)}n.addItem(e,t)}createSubscription(e,t,n){const r=new NDKRelaySubscription(this.relay,n||null,this.generalSubManager);r.onClose=this.onRelaySubscriptionClose.bind(this);const o=this.subscriptions.get(r.fingerprint)??[];return this.subscriptions.set(r.fingerprint,[...o,r]),r}onRelaySubscriptionClose(e){let t=this.subscriptions.get(e.fingerprint)??[];t?t.length===1?this.subscriptions.delete(e.fingerprint):(t=t.filter(n=>n.id!==e.id),this.subscriptions.set(e.fingerprint,t)):console.warn("Unexpectedly did not find a subscription with fingerprint",e.fingerprint)}},NDKRelay=class Dx extends libExports.EventEmitter{url;scores;connectivity;subs;publisher;authPolicy;protocolHandlers=new Map;_relayInfo;lowestValidationRatio;targetValidationRatio;validationRatioFn;validatedEventCount=0;nonValidatedEventCount=0;trusted=!1;complaining=!1;debug;static defaultValidationRatioUpdateFn=(t,n,r)=>{if(t.lowestValidationRatio===void 0||t.targetValidationRatio===void 0)return 1;let o=t.validationRatio;if(t.validationRatio>t.targetValidationRatio){const c=n/100;o=Math.max(t.lowestValidationRatio,t.validationRatio-c)}return o<t.validationRatio?o:t.validationRatio};constructor(t,n,r){super(),this.url=normalizeRelayUrl(t),this.scores=new Map,this.debug=createDebug5(`ndk:relay:${t}`),this.connectivity=new NDKRelayConnectivity(this,r),this.connectivity.netDebug=r?.netDebug,this.req=this.connectivity.req.bind(this.connectivity),this.close=this.connectivity.close.bind(this.connectivity),this.subs=new NDKRelaySubscriptionManager(this,r.subManager),this.publisher=new NDKRelayPublisher(this),this.authPolicy=n,this.targetValidationRatio=r?.initialValidationRatio,this.lowestValidationRatio=r?.lowestValidationRatio,this.validationRatioFn=(r?.validationRatioFn??Dx.defaultValidationRatioUpdateFn).bind(this),this.updateValidationRatio(),r||console.trace("relay created without ndk")}updateValidationRatio(){if(this.validationRatioFn&&this.validatedEventCount>0){const t=this.validationRatioFn(this,this.validatedEventCount,this.nonValidatedEventCount);this.targetValidationRatio=t}setTimeout(()=>{this.updateValidationRatio()},3e4)}get status(){return this.connectivity.status}get connectionStats(){return this.connectivity.connectionStats}async connect(t,n=!0){return this.connectivity.connect(t,n)}disconnect(){this.status!==1&&this.connectivity.disconnect()}subscribe(t,n){this.subs.addSubscription(t,n)}async publish(t,n=2500){return this.publisher.publish(t,n)}referenceTags(){return[["r",this.url]]}addValidatedEvent(){this.validatedEventCount++}addNonValidatedEvent(){this.nonValidatedEventCount++}get validationRatio(){return this.nonValidatedEventCount===0?1:this.validatedEventCount/(this.validatedEventCount+this.nonValidatedEventCount)}shouldValidateEvent(){return this.trusted?!1:this.targetValidationRatio===void 0||this.targetValidationRatio>=1?!0:Math.random()<this.targetValidationRatio}get connected(){return this.connectivity.connected}req;close;registerProtocolHandler(t,n){this.protocolHandlers.set(t,n)}unregisterProtocolHandler(t){this.protocolHandlers.delete(t)}getProtocolHandler(t){return this.protocolHandlers.get(t)}async fetchInfo(t=!1){const r=this.connectivity.ndk;if(!t&&r?.cacheAdapter?.getRelayStatus){const o=await r.cacheAdapter.getRelayStatus(this.url);if(o?.nip11&&Date.now()-o.nip11.fetchedAt<864e5)return this._relayInfo=o.nip11.data,o.nip11.data}return!t&&this._relayInfo?this._relayInfo:(this._relayInfo=await fetchRelayInformation(this.url),r?.cacheAdapter?.updateRelayStatus&&await r.cacheAdapter.updateRelayStatus(this.url,{nip11:{data:this._relayInfo,fetchedAt:Date.now()}}),this._relayInfo)}get info(){return this._relayInfo}},NDKPublishError=class extends Error{errors;publishedToRelays;intendedRelaySet;constructor(e,t,n,r){super(e),this.errors=t,this.publishedToRelays=n,this.intendedRelaySet=r}get relayErrors(){const e=[];for(const[t,n]of this.errors)e.push(`${t.url}: ${n}`);return e.join(`
`)}},NDKRelaySet=class kx{relays;debug;ndk;pool;constructor(t,n,r){this.relays=t,this.ndk=n,this.pool=r??n.pool,this.debug=n.debug.extend("relayset")}addRelay(t){this.relays.add(t)}get relayUrls(){return Array.from(this.relays).map(t=>t.url)}static fromRelayUrls(t,n,r=!0,o){if(o=o??n.pool,!o)throw new Error("No pool provided");const c=new Set;for(const l of t){const x=o.relays.get(normalizeRelayUrl(l));if(x)x.status<5&&r&&x.connect(),c.add(x);else{const f=new NDKRelay(normalizeRelayUrl(l),n?.relayAuthDefaultPolicy,n);o.useTemporaryRelay(f,void 0,`requested from fromRelayUrls ${t}`),c.add(f)}}return new kx(new Set(c),n,o)}async publish(t,n,r=1){const o=new Set,c=new Map,l=t.isEphemeral();t.publishStatus="pending";const x=f=>{o.add(f)};t.on("relay:published",x);try{const f=Array.from(this.relays).map(m=>new Promise(E=>{const g=n?setTimeout(()=>{o.has(m)||(c.set(m,new Error(`Publish timeout after ${n}ms`)),E(!1))},n):null;m.publish(t,n).then(y=>{g&&clearTimeout(g),y?(o.add(m),E(!0)):E(!1)}).catch(y=>{g&&clearTimeout(g),l||c.set(m,y),E(!1)})}));if(await Promise.all(f),o.size<r){if(!l){const m=new NDKPublishError("Not enough relays received the event ("+o.size+" published, "+r+" required)",c,o,this);throw t.publishStatus="error",t.publishError=m,this.ndk?.emit("event:publish-failed",t,m,this.relayUrls),m}}else t.publishStatus="success",t.emit("published",{relaySet:this,publishedToRelays:o});return o}finally{t.off("relay:published",x)}}get size(){return this.relays.size}},d=createDebug5("ndk:outbox:calculate");async function calculateRelaySetFromEvent(e,t,n){const r=new Set,o=await getWriteRelaysFor(e,t.pubkey);o&&o.forEach(x=>{const f=e.pool?.getRelay(x);f&&r.add(f)});let c=t.tags.filter(x=>["a","e"].includes(x[0])).map(x=>x[2]).filter(x=>x?.startsWith("wss://")).filter(x=>{try{return new URL(x),!0}catch{return!1}}).map(x=>normalizeRelayUrl(x));c=Array.from(new Set(c)).slice(0,5),c.forEach(x=>{const f=e.pool?.getRelay(x,!0,!0);f&&(d("Adding relay hint %s",x),r.add(f))});const l=t.getMatchingTags("p").map(x=>x[1]);return l.length<5?Array.from(chooseRelayCombinationForPubkeys(e,l,"read",{preferredRelays:new Set(o)}).keys()).forEach(f=>{const m=e.pool?.getRelay(f,!1,!0);m&&(d("Adding p-tagged relay %s",f),r.add(m))}):d("Too many p-tags to consider %d",l.length),e.pool?.permanentAndConnectedRelays().forEach(x=>r.add(x)),n&&r.size<n&&e.explicitRelayUrls?.filter(f=>!Array.from(r).some(m=>m.url===f)).slice(0,n-r.size)?.forEach(f=>{const m=e.pool?.getRelay(f,!1,!0);m&&(d("Adding explicit relay %s",f),r.add(m))}),new NDKRelaySet(r,e)}function calculateRelaySetsFromFilter(e,t,n,r){const o=new Map,c=new Set;if(t.forEach(l=>{l.authors&&l.authors.forEach(x=>c.add(x))}),c.size>0){const l=getRelaysForFilterWithAuthors(e,Array.from(c),r);for(const x of l.keys())o.set(x,[]);for(const x of t)if(x.authors)for(const[f,m]of l.entries()){const E=x.authors.filter(g=>m.includes(g));o.set(f,[...o.get(f),{...x,authors:E}])}else for(const f of l.keys())o.set(f,[...o.get(f),x])}else e.explicitRelayUrls&&e.explicitRelayUrls.forEach(l=>{o.set(l,t)});return o.size===0&&n.permanentAndConnectedRelays().slice(0,5).forEach(l=>{o.set(l.url,t)}),o}function calculateRelaySetsFromFilters(e,t,n,r){return calculateRelaySetsFromFilter(e,t,n,r)}function isValidHex64(e){if(typeof e!="string"||e.length!==64)return!1;for(let t=0;t<64;t++){const n=e.charCodeAt(t);if(!(n>=48&&n<=57||n>=97&&n<=102||n>=65&&n<=70))return!1}return!0}function isValidPubkey(e){return isValidHex64(e)}function isValidNip05(e){if(typeof e!="string")return!1;for(let t=0;t<e.length;t++)if(e.charCodeAt(t)===46)return!0;return!1}function mergeTags(e,t){const n=new Map,r=l=>l.join(","),o=(l,x)=>l.every((f,m)=>f===x[m]),c=l=>{for(const[x,f]of n)if(o(f,l)||o(l,f)){l.length>=f.length&&n.set(x,l);return}n.set(r(l),l)};return e.concat(t).forEach(c),Array.from(n.values())}var hashtagRegex=new RegExp(`(?<=\\s|^)(#[^\\s!@#$%^&*()=+./,[{\\]};:'"?><]+)`,"g");function generateHashtags(e){const t=e.match(hashtagRegex),n=new Set,r=new Set;if(t)for(const o of t)n.has(o.slice(1))||(r.add(o.slice(1)),n.add(o.slice(1)));return Array.from(r)}async function generateContentTags(e,t=[],n,r){if(n?.skipContentTagging)return{content:e,tags:t};const o=/(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g,c=[],l=x=>{t.find(f=>["q",x[0]].includes(f[0])&&f[1]===x[1])||t.push(x)};if(e=e.replace(o,x=>{try{const f=x.split(/(@|nostr:)/)[2],{type:m,data:E}=nip19_exports$1.decode(f);let g;if(n?.filters){const y=!n.filters.includeTypes||n.filters.includeTypes.includes(m),w=n.filters.excludeTypes?.includes(m);if(!y||w)return x}switch(m){case"npub":n?.pTags!==!1&&(g=["p",E]);break;case"nprofile":n?.pTags!==!1&&(g=["p",E.pubkey]);break;case"note":c.push(new Promise(async y=>{const w=await maybeGetEventRelayUrl(f);l(["q",E,w]),y()}));break;case"nevent":c.push(new Promise(async y=>{const{id:w,author:v}=E;let{relays:_}=E;(!_||_.length===0)&&(_=[await maybeGetEventRelayUrl(f)]),l(["q",w,_[0]]),v&&n?.pTags!==!1&&n?.pTagOnQTags!==!1&&l(["p",v]),y()}));break;case"naddr":c.push(new Promise(async y=>{const w=[E.kind,E.pubkey,E.identifier].join(":");let v=E.relays??[];v.length===0&&(v=[await maybeGetEventRelayUrl(f)]),l(["q",w,v[0]]),n?.pTags!==!1&&n?.pTagOnQTags!==!1&&n?.pTagOnATags!==!1&&l(["p",E.pubkey]),y()}));break;default:return x}return g&&l(g),`nostr:${f}`}catch{return x}}),await Promise.all(c),!n?.filters?.excludeTypes?.includes("hashtag")){const x=generateHashtags(e).map(f=>["t",f]);t=mergeTags(t,x)}if(n?.pTags!==!1&&n?.copyPTagsFromTarget&&r){const x=r.getMatchingTags("p");for(const f of x)!f[1]||!isValidPubkey(f[1])||t.find(m=>m[0]==="p"&&m[1]===f[1])||t.push(f)}return{content:e,tags:t}}async function maybeGetEventRelayUrl(e){return""}async function encrypt(e,t,n="nip44"){let r;if(!this.ndk)throw new Error("No NDK instance found!");let o=t;if(o||(this.ndk.assertSigner(),o=this.ndk.signer),!o)throw new Error("no NDK signer");const c=e||(()=>{const l=this.getMatchingTags("p");if(l.length!==1)throw new Error("No recipient could be determined and no explicit recipient was provided");return this.ndk.getUser({pubkey:l[0][1]})})();if(n==="nip44"&&await isEncryptionEnabled(o,"nip44")&&(r=await o.encrypt(c,this.content,"nip44")),(!r||n==="nip04")&&await isEncryptionEnabled(o,"nip04")&&(r=await o.encrypt(c,this.content,"nip04")),!r)throw new Error("Failed to encrypt event.");this.content=r}async function decrypt(e,t,n){if(this.ndk?.cacheAdapter?.getDecryptedEvent){const x=await this.ndk.cacheAdapter.getDecryptedEvent(this.id);if(x){this.content=x.content;return}}let r;if(!this.ndk)throw new Error("No NDK instance found!");let o=t;if(o||(this.ndk.assertSigner(),o=this.ndk.signer),!o)throw new Error("no NDK signer");const c=e||this.author;if(!c)throw new Error("No sender provided and no author available");const l=n||(this.content.match(/\\?iv=/)?"nip04":"nip44");if((l==="nip04"||this.kind===4)&&await isEncryptionEnabled(o,"nip04")&&this.content.search("\\?iv=")&&(r=await o.decrypt(c,this.content,"nip04")),!r&&l==="nip44"&&await isEncryptionEnabled(o,"nip44")&&(r=await o.decrypt(c,this.content,"nip44")),!r)throw new Error("Failed to decrypt event.");this.content=r,this.ndk?.cacheAdapter?.addDecryptedEvent&&this.ndk.cacheAdapter.addDecryptedEvent(this.id,this)}async function isEncryptionEnabled(e,t){return e.encryptionEnabled?t?!!await e.encryptionEnabled(t):!0:!1}function eventHasETagMarkers(e){for(const t of e.tags)if(t[0]==="e"&&(t[3]??"").length>0)return!0;return!1}function getRootTag(e,t){t??=e.tagType();const n=e.tags.find(isTagRootTag);if(!n){if(eventHasETagMarkers(e))return;const r=e.getMatchingTags(t);if(r.length<3)return r[0]}return n}var nip22RootTags=new Set(["A","E","I"]),nip22ReplyTags=new Set(["a","e","i"]);function getReplyTag(e,t){if(e.kind===1111){let o;for(const c of e.tags)if(nip22RootTags.has(c[0]))o=c;else if(nip22ReplyTags.has(c[0])){o=c;break}return o}t??=e.tagType();let n=!1,r;for(const o of e.tags)if(o[0]===t){if((o[3]??"").length>0&&(n=!0),n&&o[3]==="reply")return o;n&&o[3]==="root"&&(r=o),n||(r=o)}return r}function isTagRootTag(e){return e[0]==="E"||e[3]==="root"}async function fetchTaggedEvent(e,t){if(!this.ndk)throw new Error("NDK instance not found");const n=this.getMatchingTags(e,t);if(n.length===0)return;const[r,o,c]=n[0],l=c!==""?this.ndk.pool.getRelay(c):void 0;return await this.ndk.fetchEvent(o,{},l)}async function fetchRootEvent(e){if(!this.ndk)throw new Error("NDK instance not found");const t=getRootTag(this);if(t)return this.ndk.fetchEventFromTag(t,this,e)}async function fetchReplyEvent(e){if(!this.ndk)throw new Error("NDK instance not found");const t=getReplyTag(this);if(t)return this.ndk.fetchEventFromTag(t,this,e)}function isReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return[0,3].includes(this.kind)||this.kind>=1e4&&this.kind<2e4||this.kind>=3e4&&this.kind<4e4}function isEphemeral(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=2e4&&this.kind<3e4}function isParamReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}var DEFAULT_RELAY_COUNT=2;function encode$k(e=DEFAULT_RELAY_COUNT){let t=[];return this.onRelays.length>0?t=this.onRelays.map(n=>n.url):this.relay&&(t=[this.relay.url]),t.length>e&&(t=t.slice(0,e)),this.isParamReplaceable()?nip19_exports$1.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag(),relays:t}):t.length>0?nip19_exports$1.neventEncode({id:this.tagId(),relays:t,author:this.pubkey}):nip19_exports$1.noteEncode(this.tagId())}async function repost(e=!0,t){if(!t&&e){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),t=this.ndk.signer}const n=new NDKEvent(this.ndk,{kind:getKind(this)});return this.isProtected||(n.content=JSON.stringify(this.rawEvent())),n.tag(this),this.kind!==1&&n.tags.push(["k",`${this.kind}`]),t&&await n.sign(t),e&&await n.publish(),n}function getKind(e){return e.kind===1?6:16}function getEventDetails(e){return"inspect"in e&&typeof e.inspect=="string"?e.inspect:JSON.stringify(e)}function validateForSerialization(e){if(typeof e.kind!="number")throw new Error(`Can't serialize event with invalid properties: kind (must be number, got ${typeof e.kind}). Event: ${getEventDetails(e)}`);if(typeof e.content!="string")throw new Error(`Can't serialize event with invalid properties: content (must be string, got ${typeof e.content}). Event: ${getEventDetails(e)}`);if(typeof e.created_at!="number")throw new Error(`Can't serialize event with invalid properties: created_at (must be number, got ${typeof e.created_at}). Event: ${getEventDetails(e)}`);if(typeof e.pubkey!="string")throw new Error(`Can't serialize event with invalid properties: pubkey (must be string, got ${typeof e.pubkey}). Event: ${getEventDetails(e)}`);if(!Array.isArray(e.tags))throw new Error(`Can't serialize event with invalid properties: tags (must be array, got ${typeof e.tags}). Event: ${getEventDetails(e)}`);for(let t=0;t<e.tags.length;t++){const n=e.tags[t];if(!Array.isArray(n))throw new Error(`Can't serialize event with invalid properties: tags[${t}] (must be array, got ${typeof n}). Event: ${getEventDetails(e)}`);for(let r=0;r<n.length;r++)if(typeof n[r]!="string")throw new Error(`Can't serialize event with invalid properties: tags[${t}][${r}] (must be string, got ${typeof n[r]}). Event: ${getEventDetails(e)}`)}}function serialize(e=!1,t=!1){validateForSerialization(this);const n=[0,this.pubkey,this.created_at,this.kind,this.tags,this.content];return e&&n.push(this.sig),t&&n.push(this.id),JSON.stringify(n)}function deserialize(e){const t=JSON.parse(e),n={pubkey:t[1],created_at:t[2],kind:t[3],tags:t[4],content:t[5]};if(t.length>=7){const r=t[6],o=t[7];r&&r.length===128?(n.sig=r,o&&o.length===64&&(n.id=o)):r&&r.length===64&&(n.id=r,o&&o.length===128&&(n.sig=o))}return n}var worker,processingQueue={};function signatureVerificationInit(e){worker=e,worker.onmessage=t=>{if(!Array.isArray(t.data)||t.data.length!==2){console.error("[NDK]  Signature verification worker received incompatible message format.",`

 Expected format: [eventId, boolean]`,`
 Received:`,t.data,`

 This likely means:`,`
  1. You have a STALE worker.js file that needs updating`,`
  2. Version mismatch between @nostr-dev-kit/ndk and deployed worker`,`
  3. Wrong worker is being used for signature verification`,`

 Solution: Update your worker files:`,`
  cp node_modules/@nostr-dev-kit/ndk/dist/workers/sig-verification.js public/`,`
  cp node_modules/@nostr-dev-kit/cache-sqlite-wasm/dist/worker.js public/`,`

 Or use Vite/bundler imports instead of static files:`,`
  import SigWorker from "@nostr-dev-kit/ndk/workers/sig-verification?worker"`);return}const[n,r]=t.data,o=processingQueue[n];if(!o){console.error("No record found for event",n);return}delete processingQueue[n];for(const c of o.resolves)c(r)}}async function verifySignatureAsync(e,t,n){const r=e.ndk,o=Date.now();let c;return r.signatureVerificationFunction?c=await r.signatureVerificationFunction(e):c=await new Promise(l=>{const x=e.serialize();let f=!1;processingQueue[e.id]||(processingQueue[e.id]={event:e,resolves:[],relay:n},f=!0),processingQueue[e.id].resolves.push(l),f&&worker?.postMessage({serialized:x,id:e.id,sig:e.sig,pubkey:e.pubkey})}),r.signatureVerificationTimeMs+=Date.now()-o,c}var PUBKEY_REGEX=/^[a-f0-9]{64}$/;function validate(){if(typeof this.kind!="number"||typeof this.content!="string"||typeof this.created_at!="number"||typeof this.pubkey!="string"||!this.pubkey.match(PUBKEY_REGEX)||!Array.isArray(this.tags))return!1;for(let e=0;e<this.tags.length;e++){const t=this.tags[e];if(!Array.isArray(t))return!1;for(let n=0;n<t.length;n++)if(typeof t[n]=="object")return!1}return!0}var verifiedSignatures=new distExports$2.LRUCache({maxSize:1e3,entryExpirationTimeInMS:6e4});function verifySignature(e){if(typeof this.signatureVerified=="boolean")return this.signatureVerified;const t=verifiedSignatures.get(this.id);if(t!==null)return this.signatureVerified=!!t,this.signatureVerified;try{if(this.ndk?.asyncSigVerification){const n=this.relay;verifySignatureAsync(this,e,n).then(r=>{e&&(this.signatureVerified=r,r&&verifiedSignatures.set(this.id,this.sig)),r?n&&n.addValidatedEvent():(n?this.ndk?.reportInvalidSignature(this,n):this.ndk?.reportInvalidSignature(this),verifiedSignatures.set(this.id,!1))}).catch(r=>{console.error("signature verification error",this.id,r)})}else{const n=sha256(new TextEncoder().encode(this.serialize())),r=schnorr.verify(this.sig,n,this.pubkey);return r?verifiedSignatures.set(this.id,this.sig):verifiedSignatures.set(this.id,!1),this.signatureVerified=r,r}}catch{return this.signatureVerified=!1,!1}}function getEventHash(){return getEventHashFromSerializedEvent(this.serialize())}function getEventHashFromSerializedEvent(e){const t=sha256(new TextEncoder().encode(e));return bytesToHex(t)}var skipClientTagOnKinds=new Set([0,4,1059,13,3,9734,5]),NDKEvent=class Cr extends libExports.EventEmitter{ndk;created_at;content="";tags=[];kind;id="";sig;pubkey="";signatureVerified;_author=void 0;relay;get onRelays(){let t=[];return this.ndk?t=this.ndk.subManager.seenEvents.get(this.id)||[]:this.relay&&t.push(this.relay),t}publishStatus="success";publishError;constructor(t,n){super(),this.ndk=t,this.created_at=n?.created_at,this.content=n?.content||"",this.tags=n?.tags||[],this.id=n?.id||"",this.sig=n?.sig,this.pubkey=n?.pubkey||"",this.kind=n?.kind,n instanceof Cr&&(this.relay&&(this.relay=n.relay,this.ndk?.subManager.seenEvent(n.id,this.relay)),this.publishStatus=n.publishStatus,this.publishError=n.publishError)}static deserialize(t,n){return new Cr(t,deserialize(n))}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author(t){this.pubkey=t.pubkey,this._author=t,this._author.ndk??=this.ndk}get author(){if(this._author)return this._author;if(!this.ndk)throw new Error("No NDK instance found");const t=this.ndk.getUser({pubkey:this.pubkey});return this._author=t,t}tagExternal(t,n,r){const o=["i"],c=["k"];switch(n){case"url":{const l=new URL(t);l.hash="",o.push(l.toString()),c.push(`${l.protocol}//${l.host}`);break}case"hashtag":o.push(`#${t.toLowerCase()}`),c.push("#");break;case"geohash":o.push(`geo:${t.toLowerCase()}`),c.push("geo");break;case"isbn":o.push(`isbn:${t.replace(/-/g,"")}`),c.push("isbn");break;case"podcast:guid":o.push(`podcast:guid:${t}`),c.push("podcast:guid");break;case"podcast:item:guid":o.push(`podcast:item:guid:${t}`),c.push("podcast:item:guid");break;case"podcast:publisher:guid":o.push(`podcast:publisher:guid:${t}`),c.push("podcast:publisher:guid");break;case"isan":o.push(`isan:${t.split("-").slice(0,4).join("-")}`),c.push("isan");break;case"doi":o.push(`doi:${t.toLowerCase()}`),c.push("doi");break;default:throw new Error(`Unsupported NIP-73 entity type: ${n}`)}r&&o.push(r),this.tags.push(o),this.tags.push(c)}tag(t,n,r,o,c){let l=[];if(t.fetchProfile!==void 0){if(o??="p",o==="p"&&c?.pTags===!1)return;const f=[o,t.pubkey];n&&f.push("",n),l.push(f)}else if(t instanceof Cr){const f=t;if(r??=f?.pubkey===this.pubkey,l=f.referenceTags(n,r,o,c),c?.pTags!==!1)for(const m of f.getMatchingTags("p"))!m[1]||!isValidPubkey(m[1])||m[1]!==this.pubkey&&(this.tags.find(E=>E[0]==="p"&&E[1]===m[1])||this.tags.push(["p",m[1]]))}else if(Array.isArray(t))l=[t];else throw new Error("Invalid argument",t);this.tags=mergeTags(this.tags,l)}async toNostrEvent(t,n){if(!t&&this.pubkey===""){const c=await this.ndk?.signer?.user();this.pubkey=c?.pubkey||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const{content:r,tags:o}=await this.generateTags(n);this.content=r||"",this.tags=o;try{this.id=this.getEventHash()}catch{}return this.rawEvent()}serialize=serialize.bind(this);getEventHash=getEventHash.bind(this);validate=validate.bind(this);verifySignature=verifySignature.bind(this);isReplaceable=isReplaceable.bind(this);isEphemeral=isEphemeral.bind(this);isDvm=()=>this.kind&&this.kind>=5e3&&this.kind<=7e3;isParamReplaceable=isParamReplaceable.bind(this);encode=encode$k.bind(this);encrypt=encrypt.bind(this);decrypt=decrypt.bind(this);getMatchingTags(t,n){const r=this.tags.filter(o=>o[0]===t);return n===void 0?r:r.filter(o=>o[3]===n)}hasTag(t,n){return this.tags.some(r=>r[0]===t&&(!n||r[3]===n))}tagValue(t,n){const r=this.getMatchingTags(t,n);if(r.length!==0)return r[0][1]}get alt(){return this.tagValue("alt")}set alt(t){this.removeTag("alt"),t&&this.tags.push(["alt",t])}get dTag(){return this.tagValue("d")}set dTag(t){this.removeTag("d"),t&&this.tags.push(["d",t])}removeTag(t,n){const r=Array.isArray(t)?t:[t];this.tags=this.tags.filter(o=>{const c=r.includes(o[0]),l=n?o[3]===n:!0;return!(c&&l)})}replaceTag(t){this.removeTag(t[0]),this.tags.push(t)}async sign(t,n){this.ndk?.aiGuardrails?.event?.signing(this),t?this.author=await t.user():(this.ndk?.assertSigner(),t=this.ndk?.signer);const r=await this.toNostrEvent(void 0,n);return this.sig=await t.sign(r),this.sig}async publishReplaceable(t,n,r){return this.id="",this.created_at=Math.floor(Date.now()/1e3),this.sig="",this.publish(t,n,r)}async publish(t,n,r,o){if(r||(r=1),this.sig||await this.sign(void 0,o),!this.ndk)throw new Error("NDKEvent must be associated with an NDK instance to publish");if(this.ndk.aiGuardrails?.event?.publishing(this),(!t||t.size===0)&&(t=this.ndk.devWriteRelaySet||await calculateRelaySetFromEvent(this.ndk,this,r)),this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds){const x=this.getMatchingTags("e").map(f=>f[1]);this.ndk.cacheAdapter.deleteEventIds(x)}const c=this.rawEvent();if(this.ndk.cacheAdapter?.addUnpublishedEvent&&shouldTrackUnpublishedEvent(this))try{this.ndk.cacheAdapter.addUnpublishedEvent(this,t.relayUrls)}catch(x){console.error("Error adding unpublished event to cache",x)}this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds&&this.ndk.cacheAdapter.deleteEventIds(this.getMatchingTags("e").map(x=>x[1])),this.ndk.subManager.dispatchEvent(c,void 0,!0);const l=await t.publish(this,n,r);return l.forEach(x=>this.ndk?.subManager.seenEvent(this.id,x)),l}async generateTags(t){let n=[];const r=await generateContentTags(this.content,this.tags,t,this),o=r.content;if(n=r.tags,this.kind&&this.isParamReplaceable()&&!this.getMatchingTags("d")[0]){const l=this.tagValue("title");let f=[...Array(l?6:16)].map(()=>Math.random().toString(36)[2]).join("");l&&l.length>0&&(f=`${l.replace(/[^a-z0-9]+/gi,"-").replace(/^-|-$/g,"")}-${f}`),n.push(["d",f])}if(this.shouldAddClientTag){const c=["client",this.ndk?.clientName??""];this.ndk?.clientNip89&&c.push(this.ndk?.clientNip89),n.push(c)}else this.shouldStripClientTag&&(n=n.filter(c=>c[0]!=="client"));return{content:o||"",tags:n}}get shouldAddClientTag(){return!(!this.ndk?.clientName&&!this.ndk?.clientNip89||skipClientTagOnKinds.has(this.kind)||this.isEphemeral()||this.isReplaceable()&&!this.isParamReplaceable()||this.isDvm()||this.hasTag("client"))}get shouldStripClientTag(){return skipClientTagOnKinds.has(this.kind)}muted(){return this.ndk?.muteFilter&&this.ndk.muteFilter(this)?"muted":null}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const t=this.getMatchingTags("d")[0];return t?t[1]:""}throw new Error("Event is not a parameterized replaceable event")}deduplicationKey(){return this.kind===0||this.kind===3||this.kind&&this.kind>=1e4&&this.kind<2e4?`${this.kind}:${this.pubkey}`:this.tagId()}tagId(){return this.isParamReplaceable()?this.tagAddress():this.id}tagAddress(){if(this.isParamReplaceable()){const t=this.dTag??"";return`${this.kind}:${this.pubkey}:${t}`}if(this.isReplaceable())return`${this.kind}:${this.pubkey}:`;throw new Error("Event is not a replaceable event")}tagType(){return this.isParamReplaceable()?"a":"e"}tagReference(t){let n;return this.isParamReplaceable()?n=["a",this.tagAddress()]:n=["e",this.tagId()],this.relay?n.push(this.relay.url):n.push(""),n.push(t??""),this.isParamReplaceable()||n.push(this.pubkey),n}referenceTags(t,n,r,o){let c=[];return this.isParamReplaceable()?c=[[r??"a",this.tagAddress()],[r??"e",this.id]]:c=[[r??"e",this.id]],c=c.map(l=>(l[0]==="e"||t?l.push(this.relay?.url??""):this.relay?.url&&l.push(this.relay?.url),l)),c.forEach(l=>{l[0]==="e"?(l.push(t??""),l.push(this.pubkey)):t&&l.push(t)}),c=[...c,...this.getMatchingTags("h")],!n&&o?.pTags!==!1&&c.push(...this.author.referenceTags()),c}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}nip22Filter(){return this.isParamReplaceable()?{"#A":[this.tagId()]}:{"#E":[this.tagId()]}}async delete(t,n=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const r=new Cr(this.ndk,{kind:5,content:t||""});return r.tag(this,void 0,!0),r.tags.push(["k",this.kind?.toString()]),n&&(this.emit("deleted"),await r.publish()),r}set isProtected(t){this.removeTag("-"),t&&this.tags.push(["-"])}get isProtected(){return this.hasTag("-")}fetchTaggedEvent=fetchTaggedEvent.bind(this);fetchRootEvent=fetchRootEvent.bind(this);fetchReplyEvent=fetchReplyEvent.bind(this);repost=repost.bind(this);async react(t,n=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const r=new Cr(this.ndk,{kind:7,content:t});return r.tag(this),this.kind!==1&&r.tags.push(["k",`${this.kind}`]),n&&await r.publish(),r}get isValid(){return this.validate()}get inspect(){return JSON.stringify(this.rawEvent(),null,4)}dump(){console.debug(JSON.stringify(this.rawEvent(),null,4)),console.debug("Event on relays:",this.onRelays.map(t=>t.url).join(", "))}reply(t,n){const r=new Cr(this.ndk);if(this.ndk?.aiGuardrails?.event?.creatingReply(r),this.kind===1&&!t)r.kind=1,this.hasTag("e")?r.tags=[...r.tags,...this.getMatchingTags("e"),...this.getMatchingTags("p"),...this.getMatchingTags("a"),...this.referenceTags("reply",!1,void 0,n)]:r.tag(this,"root",!1,void 0,n);else{r.kind=1111;const o=["A","E","I","P"],c=this.tags.filter(l=>o.includes(l[0]));if(c.length>0){const l=this.tagValue("K");r.tags.push(...c),l&&r.tags.push(["K",l]);let x;if(this.isParamReplaceable()){x=["a",this.tagAddress()];const f=this.relay?.url??"";f&&x.push(f)}else{x=["e",this.tagId()];const f=this.relay?.url??"";x.push(f),x.push(this.pubkey)}r.tags.push(x)}else{let l,x;const f=this.relay?.url??"";this.isParamReplaceable()?(l=["a",this.tagAddress(),f],x=["A",this.tagAddress(),f]):(l=["e",this.tagId(),f,this.pubkey],x=["E",this.tagId(),f,this.pubkey]),r.tags.push(l),r.tags.push(x),r.tags.push(["K",this.kind?.toString()]),n?.pTags!==!1&&n?.pTagOnATags!==!1&&r.tags.push(["P",this.pubkey])}r.tags.push(["k",this.kind?.toString()]),n?.pTags!==!1&&(r.tags.push(...this.getMatchingTags("p")),r.tags.push(["p",this.pubkey]))}return r}},untrackedUnpublishedEvents=new Set([24133,13194,23194,23195]);function shouldTrackUnpublishedEvent(e){return!untrackedUnpublishedEvents.has(e.kind)}var NDKPool=class extends libExports.EventEmitter{_relays=new Map;status="idle";autoConnectRelays=new Set;debug;temporaryRelayTimers=new Map;flappingRelays=new Set;backoffTimes=new Map;ndk;disconnectionTimes=new Map;systemEventDetector;constructor(e,t,{debug:n,name:r}={}){super(),this.debug=n??t.debug.extend("pool"),r&&(this._name=r),this.ndk=t,this.relayUrls=e,this.ndk.pools&&this.ndk.pools.push(this)}get relays(){return this._relays}set relayUrls(e){this._relays.clear();for(const t of e){const n=new NDKRelay(t,void 0,this.ndk);n.connectivity.netDebug=this.ndk.netDebug,this.addRelay(n)}}_name="unnamed";get name(){return this._name}set name(e){this._name=e,this.debug=this.debug.extend(e)}useTemporaryRelay(e,t=3e4,n){const r=this.relays.has(e.url);r||(this.addRelay(e),this.debug("Adding temporary relay %s for filters %o",e.url,n));const o=this.temporaryRelayTimers.get(e.url);if(o&&clearTimeout(o),!r||o){const c=setTimeout(()=>{this.ndk.explicitRelayUrls?.includes(e.url)||this.removeRelay(e.url)},t);this.temporaryRelayTimers.set(e.url,c)}}addRelay(e,t=!0){const n=this.relays.has(e.url),r=e.url.includes("/npub1");let o=!0;const c=e.url;if(n)return;if(this.ndk.relayConnectionFilter&&!this.ndk.relayConnectionFilter(c)){this.debug(`Refusing to add relay ${c}: blocked by relayConnectionFilter`);return}if(r){this.debug(`Refusing to add relay ${c}: is a filter relay`);return}if(this.ndk.cacheAdapter?.getRelayStatus){const w=this.ndk.cacheAdapter.getRelayStatus(c),v=w instanceof Promise?void 0:w;if(v?.dontConnectBefore){if(v.dontConnectBefore>Date.now()){const _=v.dontConnectBefore-Date.now();this.debug(`Refusing to add relay ${c}: delayed connect for ${_}ms`),setTimeout(()=>{this.addRelay(e,t)},_);return}o=!1}}const l=w=>this.emit("notice",e,w),x=()=>this.handleRelayConnect(c),f=()=>this.handleRelayReady(e),m=()=>{this.recordDisconnection(e),this.emit("relay:disconnect",e)},E=()=>this.handleFlapping(e),g=w=>this.emit("relay:auth",e,w),y=()=>this.emit("relay:authed",e);e.off("notice",l),e.off("connect",x),e.off("ready",f),e.off("disconnect",m),e.off("flapping",E),e.off("auth",g),e.off("authed",y),e.on("notice",l),e.on("connect",x),e.on("ready",f),e.on("disconnect",m),e.on("flapping",E),e.on("auth",g),e.on("authed",y),e.on("delayed-connect",w=>{this.ndk.cacheAdapter?.updateRelayStatus&&this.ndk.cacheAdapter.updateRelayStatus(e.url,{dontConnectBefore:Date.now()+w})}),this._relays.set(c,e),t&&this.autoConnectRelays.add(c),t&&this.status==="active"&&(this.emit("relay:connecting",e),e.connect(void 0,o).catch(w=>{this.debug(`Failed to connect to relay ${c}`,w)}))}removeRelay(e){const t=this.relays.get(e);if(t)return t.disconnect(),this.relays.delete(e),this.autoConnectRelays.delete(e),this.emit("relay:disconnect",t),!0;const n=this.temporaryRelayTimers.get(e);return n&&(clearTimeout(n),this.temporaryRelayTimers.delete(e)),!1}isRelayConnected(e){const t=normalizeRelayUrl(e),n=this.relays.get(t);return n?n.status===5:!1}getRelay(e,t=!0,n=!1,r){let o=this.relays.get(normalizeRelayUrl(e));return o||(o=new NDKRelay(e,void 0,this.ndk),o.connectivity.netDebug=this.ndk.netDebug,n?this.useTemporaryRelay(o,3e4,r):this.addRelay(o,t)),o}handleRelayConnect(e){const t=this.relays.get(e);if(!t){console.error("NDK BUG: relay not found in pool",{relayUrl:e});return}this.emit("relay:connect",t),this.stats().connected===this.relays.size&&this.emit("connect")}handleRelayReady(e){this.emit("relay:ready",e)}async connect(e){this.status="active",this.debug(`Connecting to ${this.relays.size} relays${e?`, timeout ${e}ms`:""}...`);const t=Array.from(this.autoConnectRelays.keys()).map(c=>this.relays.get(c)).filter(c=>!!c);for(const c of t)c.status!==5&&c.status!==4&&(this.emit("relay:connecting",c),c.connect().catch(l=>{this.debug(`Failed to connect to relay ${c.url}: ${l??"No reason specified"}`)}));const n=()=>t.every(c=>c.status===5),r=new Promise(c=>{if(n()){c();return}const l=[];for(const x of t){const f=()=>{if(n()){for(let m=0;m<t.length;m++)t[m].off("connect",l[m]);c()}};l.push(f),x.on("connect",f)}}),o=typeof e=="number"?new Promise(c=>setTimeout(c,e)):new Promise(()=>{});await Promise.race([r,o])}checkOnFlappingRelays(){const e=this.flappingRelays.size,t=this.relays.size;if(e/t>=.8)for(const n of this.flappingRelays)this.backoffTimes.set(n,0)}recordDisconnection(e){const t=Date.now();this.disconnectionTimes.set(e.url,t);for(const[n,r]of this.disconnectionTimes.entries())t-r>1e4&&this.disconnectionTimes.delete(n);this.checkForSystemWideDisconnection()}checkForSystemWideDisconnection(){const e=Date.now(),t=[];for(const n of this.disconnectionTimes.values())e-n<5e3&&t.push(n);t.length>this.relays.size/2&&this.relays.size>1&&(this.debug(`System-wide disconnection detected: ${t.length}/${this.relays.size} relays disconnected`),this.handleSystemWideReconnection())}handleSystemWideReconnection(){if(this.systemEventDetector){this.debug("System-wide reconnection already in progress, skipping");return}this.debug("Initiating system-wide reconnection with reset backoff"),this.systemEventDetector=setTimeout(()=>{this.systemEventDetector=void 0},1e4);for(const e of this.relays.values())e.connectivity&&(e.connectivity.resetReconnectionState(),e.status!==5&&e.status!==4&&e.connect().catch(t=>{this.debug(`Failed to reconnect relay ${e.url} after system event: ${t}`)}));this.disconnectionTimes.clear()}handleFlapping(e){this.debug(`Relay ${e.url} is flapping`);let t=this.backoffTimes.get(e.url)||5e3;t=t*2,this.backoffTimes.set(e.url,t),this.debug(`Backoff time for ${e.url} is ${t}ms`),setTimeout(()=>{this.debug(`Attempting to reconnect to ${e.url}`),this.emit("relay:connecting",e),e.connect(),this.checkOnFlappingRelays()},t),e.disconnect(),this.emit("flapping",e)}size(){return this.relays.size}stats(){const e={total:0,connected:0,disconnected:0,connecting:0};for(const t of this.relays.values())e.total++,t.status===5?e.connected++:t.status===1?e.disconnected++:t.status===4&&e.connecting++;return e}connectedRelays(){return Array.from(this.relays.values()).filter(e=>e.status>=5)}permanentAndConnectedRelays(){return Array.from(this.relays.values()).filter(e=>e.status>=5&&!this.temporaryRelayTimers.has(e.url))}urls(){return Array.from(this.relays.keys())}},NDKDVMJobFeedback=class Fx extends NDKEvent{static kinds=[7e3];constructor(t,n){super(t,n),this.kind??=7e3}static async from(t){const n=new Fx(t.ndk,t.rawEvent());return n.encrypted&&await n.dvmDecrypt(),n}get status(){return this.tagValue("status")}set status(t){this.removeTag("status"),t!==void 0&&this.tags.push(["status",t])}get encrypted(){return!!this.getMatchingTags("encrypted")[0]}async dvmDecrypt(){await this.decrypt();const t=JSON.parse(this.content);this.tags.push(...t)}},NDKCashuMintList=class Rx extends NDKEvent{static kind=10019;static kinds=[10019];_p2pk;constructor(t,n){super(t,n),this.kind??=10019}static from(t){return new Rx(t.ndk,t)}set relays(t){this.tags=this.tags.filter(n=>n[0]!=="relay");for(const n of t)this.tags.push(["relay",n])}get relays(){const t=[];for(const n of this.tags)n[0]==="relay"&&t.push(n[1]);return t}set mints(t){this.tags=this.tags.filter(n=>n[0]!=="mint");for(const n of t)this.tags.push(["mint",n])}get mints(){const t=[];for(const n of this.tags)n[0]==="mint"&&t.push(n[1]);return Array.from(new Set(t))}get p2pk(){return this._p2pk?this._p2pk:(this._p2pk=this.tagValue("pubkey")??this.pubkey,this._p2pk)}set p2pk(t){this._p2pk=t,this.removeTag("pubkey"),t&&this.tags.push(["pubkey",t])}get relaySet(){return NDKRelaySet.fromRelayUrls(this.relays,this.ndk)}},NDKArticle=class Tx extends NDKEvent{static kind=30023;static kinds=[30023];constructor(t,n){super(t,n),this.kind??=30023}static from(t){return new Tx(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}get summary(){return this.tagValue("summary")}set summary(t){this.removeTag("summary"),t&&this.tags.push(["summary",t])}get published_at(){const t=this.tagValue("published_at");if(t){let n=Number.parseInt(t);return n>1e12&&(n=Math.floor(n/1e3)),n}}set published_at(t){this.removeTag("published_at"),t!==void 0&&this.tags.push(["published_at",t.toString()])}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}get url(){return this.tagValue("url")}set url(t){t?this.tags.push(["url",t]):this.removeTag("url")}},NDKBlossomList=class Nx extends NDKEvent{static kinds=[10063];constructor(t,n){super(t,n),this.kind??=10063}static from(t){return new Nx(t.ndk,t.rawEvent())}get servers(){return this.tags.filter(t=>t[0]==="server").map(t=>t[1])}set servers(t){this.tags=this.tags.filter(n=>n[0]!=="server");for(const n of t)this.tags.push(["server",n])}get default(){const t=this.servers;return t.length>0?t[0]:void 0}set default(t){if(!t)return;const r=this.servers.filter(o=>o!==t);this.servers=[t,...r]}addServer(t){if(!t)return;const n=this.servers;n.includes(t)||(this.servers=[...n,t])}removeServer(t){if(!t)return;const n=this.servers;this.servers=n.filter(r=>r!==t)}},NDKFedimintMint=class $x extends NDKEvent{static kind=38173;static kinds=[38173];constructor(t,n){super(t,n),this.kind??=38173}static async from(t){return new $x(t.ndk,t)}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get inviteCodes(){return this.getMatchingTags("u").map(t=>t[1])}set inviteCodes(t){this.removeTag("u");for(const n of t)this.tags.push(["u",n])}get modules(){return this.getMatchingTags("modules").map(t=>t[1])}set modules(t){this.removeTag("modules");for(const n of t)this.tags.push(["modules",n])}get network(){return this.tagValue("n")}set network(t){this.removeTag("n"),t&&this.tags.push(["n",t])}get metadata(){if(this.content)try{return JSON.parse(this.content)}catch{return}}set metadata(t){t?this.content=JSON.stringify(t):this.content=""}},NDKCashuMintAnnouncement=class jx extends NDKEvent{static kind=38172;static kinds=[38172];constructor(t,n){super(t,n),this.kind??=38172}static async from(t){return new jx(t.ndk,t)}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get url(){return this.tagValue("u")}set url(t){this.removeTag("u"),t&&this.tags.push(["u",t])}get nuts(){return this.getMatchingTags("nuts").map(t=>t[1])}set nuts(t){this.removeTag("nuts");for(const n of t)this.tags.push(["nuts",n])}get network(){return this.tagValue("n")}set network(t){this.removeTag("n"),t&&this.tags.push(["n",t])}get metadata(){if(this.content)try{return JSON.parse(this.content)}catch{return}}set metadata(t){t?this.content=JSON.stringify(t):this.content=""}},NDKMintRecommendation=class Ix extends NDKEvent{static kind=38e3;static kinds=[38e3];constructor(t,n){super(t,n),this.kind??=38e3}static async from(t){return new Ix(t.ndk,t)}get recommendedKind(){const t=this.tagValue("k");return t?Number(t):void 0}set recommendedKind(t){this.removeTag("k"),t&&this.tags.push(["k",t.toString()])}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get urls(){return this.getMatchingTags("u").map(t=>t[1])}set urls(t){this.removeTag("u");for(const n of t)this.tags.push(["u",n])}get mintEventPointers(){return this.getMatchingTags("a").map(t=>({kind:Number(t[1].split(":")[0]),identifier:t[1].split(":")[2],relay:t[2]}))}addMintEventPointer(t,n,r,o){const c=["a",`${t}:${n}:${r}`];o&&c.push(o),this.tags.push(c)}get review(){return this.content}set review(t){this.content=t}},NDKClassified=class Ux extends NDKEvent{static kinds=[30402];constructor(t,n){super(t,n),this.kind??=30402}static from(t){return new Ux(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get summary(){return this.tagValue("summary")}set summary(t){this.removeTag("summary"),t&&this.tags.push(["summary",t])}get published_at(){const t=this.tagValue("published_at");if(t)return Number.parseInt(t)}set published_at(t){this.removeTag("published_at"),t!==void 0&&this.tags.push(["published_at",t.toString()])}get location(){return this.tagValue("location")}set location(t){this.removeTag("location"),t&&this.tags.push(["location",t])}get price(){const t=this.tags.find(n=>n[0]==="price");if(t)return{amount:Number.parseFloat(t[1]),currency:t[2],frequency:t[3]}}set price(t){if(typeof t=="string"&&(t={amount:Number.parseFloat(t)}),t?.amount){const n=["price",t.amount.toString()];t.currency&&n.push(t.currency),t.frequency&&n.push(t.frequency),this.tags.push(n)}else this.removeTag("price")}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}},NDKDraft=class Ox extends NDKEvent{_event;static kind=31234;static kinds=[31234,1234];counterparty;constructor(t,n){super(t,n),this.kind??=31234}static from(t){return new Ox(t.ndk,t)}set identifier(t){this.removeTag("d"),this.tags.push(["d",t])}get identifier(){return this.dTag}set event(t){t instanceof NDKEvent?this._event=t:this._event=new NDKEvent(void 0,t),this.prepareEvent()}set checkpoint(t){t?(this.tags.push(t.tagReference()),this.kind=1234):(this.removeTag("a"),this.kind=31234)}get isCheckpoint(){return this.kind===1234}get isProposal(){const t=this.tagValue("p");return!!t&&t!==this.pubkey}async getEvent(t){if(this._event)return this._event;if(t??=this.ndk?.signer,!t)throw new Error("No signer available");if(this.content&&this.content.length>0)try{const n=t.pubkey,o=[this.tagValue("p"),this.pubkey].filter(Boolean).find(x=>x!==n);let c;c=new NDKUser({pubkey:o??n}),await this.decrypt(c,t);const l=JSON.parse(this.content);return this._event=await wrapEvent(new NDKEvent(this.ndk,l)),this._event}catch(n){console.error(n);return}else return null}prepareEvent(){if(!this._event)throw new Error("No event has been provided");this.removeTag("k"),this._event.kind&&this.tags.push(["k",this._event.kind.toString()]),this.content=JSON.stringify(this._event.rawEvent())}async save({signer:t,publish:n,relaySet:r}){if(t??=this.ndk?.signer,!t)throw new Error("No signer available");const o=this.counterparty||await t.user();if(await this.encrypt(o,t),this.counterparty){const c=this.counterparty.pubkey;this.removeTag("p"),this.tags.push(["p",c])}if(n!==!1)return this.publishReplaceable(r)}};function mapImetaTag(e){const t={};if(e.length===2){const r=e[1].split(" ");for(let o=0;o<r.length;o+=2){const c=r[o],l=r[o+1];c==="fallback"?(t.fallback||(t.fallback=[]),t.fallback.push(l)):t[c]=l}return t}const n=e.slice(1);for(const r of n){const o=r.split(" "),c=o[0],l=o.slice(1).join(" ");c==="fallback"?(t.fallback||(t.fallback=[]),t.fallback.push(l)):t[c]=l}return t}function imetaTagToTag(e){const t=["imeta"];for(const[n,r]of Object.entries(e))if(Array.isArray(r))for(const o of r)t.push(`${n} ${o}`);else r&&t.push(`${n} ${r}`);return t}var NDKFollowPack=class Px extends NDKEvent{static kind=39089;static kinds=[39089,39092];constructor(t,n){super(t,n),this.kind??=39089}static from(t){return new Px(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get image(){const t=this.tags.find(n=>n[0]==="imeta");if(t){const n=mapImetaTag(t);if(n.url)return n.url}return this.tagValue("image")}set image(t){this.tags=this.tags.filter(n=>n[0]!=="imeta"&&n[0]!=="image"),typeof t=="string"?t!==void 0&&this.tags.push(["image",t]):t&&typeof t=="object"&&(this.tags.push(imetaTagToTag(t)),t.url&&this.tags.push(["image",t.url]))}get pubkeys(){return Array.from(new Set(this.tags.filter(t=>t[0]==="p"&&t[1]&&isValidPubkey(t[1])).map(t=>t[1])))}set pubkeys(t){this.tags=this.tags.filter(n=>n[0]!=="p");for(const n of t)this.tags.push(["p",n])}get description(){return this.tagValue("description")}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}},NDKHighlight=class Hx extends NDKEvent{_article;static kind=9802;static kinds=[9802];constructor(t,n){super(t,n),this.kind??=9802}static from(t){return new Hx(t.ndk,t)}get url(){return this.tagValue("r")}set context(t){t===void 0?this.tags=this.tags.filter(([n,r])=>n!=="context"):(this.tags=this.tags.filter(([n,r])=>n!=="context"),this.tags.push(["context",t]))}get context(){return this.tags.find(([t,n])=>t==="context")?.[1]??void 0}get article(){return this._article}set article(t){this._article=t,typeof t=="string"?this.tags.push(["r",t]):this.tag(t)}getArticleTag(){return this.getMatchingTags("a")[0]||this.getMatchingTags("e")[0]||this.getMatchingTags("r")[0]}async getArticle(){if(this._article!==void 0)return this._article;let t;const n=this.getArticleTag();if(n){switch(n[0]){case"a":{const[r,o,c]=n[1].split(":");t=nip19_exports$1.naddrEncode({kind:Number.parseInt(r),pubkey:o,identifier:c});break}case"e":t=nip19_exports$1.noteEncode(n[1]);break;case"r":this._article=n[1];break}if(t){let r=await this.ndk?.fetchEvent(t);r&&(r.kind===30023&&(r=NDKArticle.from(r)),this._article=r)}return this._article}}},NDKImage=class Mx extends NDKEvent{static kind=20;static kinds=[20];_imetas;constructor(t,n){super(t,n),this.kind??=20}static from(t){return new Mx(t.ndk,t.rawEvent())}get isValid(){return this.imetas.length>0}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(t=>t[0]==="imeta").map(mapImetaTag).filter(t=>!!t.url),this._imetas)}set imetas(t){this._imetas=t,this.tags=this.tags.filter(n=>n[0]!=="imeta"),this.tags.push(...t.map(imetaTagToTag))}},NDKList=class Lx extends NDKEvent{_encryptedTags;static kinds=[30001,10004,10050,10030,10015,10001,10002,10007,10006,10003];encryptedTagsLength;constructor(t,n){super(t,n),this.kind??=30001}static from(t){return new Lx(t.ndk,t)}get title(){const t=this.tagValue("title")||this.tagValue("name");return t||(this.kind===3?"Contacts":this.kind===1e4?"Mute":this.kind===10001?"Pinned Notes":this.kind===10002?"Relay Metadata":this.kind===10003?"Bookmarks":this.kind===10004?"Communities":this.kind===10005?"Public Chats":this.kind===10006?"Blocked Relays":this.kind===10007?"Search Relays":this.kind===10050?"Direct Message Receive Relays":this.kind===10015?"Interests":this.kind===10030?"Emojis":this.tagValue("d"))}set title(t){this.removeTag(["title","name"]),t&&this.tags.push(["title",t])}get name(){return this.title}set name(t){this.title=t}get description(){return this.tagValue("description")}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}isEncryptedTagsCacheValid(){return!!(this._encryptedTags&&this.encryptedTagsLength===this.content.length)}async encryptedTags(t=!0){if(t&&this.isEncryptedTagsCacheValid())return this._encryptedTags;if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const n=await this.ndk.signer.user();try{if(this.content.length>0)try{const r=await this.ndk.signer.decrypt(n,this.content),o=JSON.parse(r);return o?.[0]?(this.encryptedTagsLength=this.content.length,this._encryptedTags=o):(this.encryptedTagsLength=this.content.length,this._encryptedTags=[])}catch{}}catch{}return[]}validateTag(t){return!0}getItems(t){return this.tags.filter(n=>n[0]===t)}get items(){return this.tags.filter(t=>!["d","L","l","title","name","description","published_at","summary","image","thumb","alt","expiration","subject","client"].includes(t[0]))}async addItem(t,n=void 0,r=!1,o="bottom"){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");let c;if(t instanceof NDKEvent)c=[t.tagReference(n)];else if(t instanceof NDKUser)c=t.referenceTags();else if(t instanceof NDKRelay)c=t.referenceTags();else if(Array.isArray(t))c=[t];else throw new Error("Invalid object type");if(n&&c[0].push(n),r){const l=await this.ndk.signer.user(),x=await this.encryptedTags();o==="top"?x.unshift(...c):x.push(...c),this._encryptedTags=x,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(x),await this.encrypt(l)}else o==="top"?this.tags.unshift(...c):this.tags.push(...c);this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItemByValue(t,n=!0){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const r=this.tags.findIndex(x=>x[1]===t);r>=0&&this.tags.splice(r,1);const o=await this.ndk.signer.user(),c=await this.encryptedTags(),l=c.findIndex(x=>x[1]===t);if(l>=0&&(c.splice(l,1),this._encryptedTags=c,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(c),await this.encrypt(o)),n)return this.publishReplaceable();this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItem(t,n){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");if(n){const r=await this.ndk.signer.user(),o=await this.encryptedTags();o.splice(t,1),this._encryptedTags=o,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(o),await this.encrypt(r)}else this.tags.splice(t,1);return this.created_at=Math.floor(Date.now()/1e3),this.emit("change"),this}has(t){return this.items.some(n=>n[1]===t)}filterForItems(){const t=new Set,n=new Map,r=[];for(const o of this.items)if(o[0]==="e"&&o[1])t.add(o[1]);else if(o[0]==="a"&&o[1]){const[c,l,x]=o[1].split(":");if(!c||!l)continue;const f=`${c}:${l}`,m=n.get(f)||[];m.push(x||""),n.set(f,m)}if(t.size>0&&r.push({ids:Array.from(t)}),n.size>0)for(const[o,c]of n.entries()){const[l,x]=o.split(":");r.push({kinds:[Number.parseInt(l)],authors:[x],"#d":c})}return r}},NDKAppHandlerEvent=class Kx extends NDKEvent{profile;static kinds=[31990];constructor(t,n){super(t,n),this.kind??=31990}static from(t){const n=new Kx(t.ndk,t.rawEvent());return n.isValid?n:null}get isValid(){const t=new Map,n=o=>[o[0],o[2]].join(":").toLowerCase(),r=["web","android","ios"];for(const o of this.tags)if(r.includes(o[0])){const c=n(o);if(t.has(c)&&t.get(c)!==o[1].toLowerCase())return!1;t.set(c,o[1].toLowerCase())}return!0}async fetchProfile(){if(this.profile===void 0&&this.content.length>0)try{const t=JSON.parse(this.content);if(t?.name)return t;this.profile=null}catch{this.profile=null}return new Promise((t,n)=>{const r=this.author;r.fetchProfile().then(()=>{t(r.profile)}).catch(n)})}},NDKNutzap=class Rc extends NDKEvent{debug;_proofs=[];static kind=9321;static kinds=[Rc.kind];constructor(t,n){super(t,n),this.kind??=9321,this.debug=t?.debug.extend("nutzap")??createDebug5("ndk:nutzap"),this.alt||(this.alt="This is a nutzap");try{const r=this.getMatchingTags("proof");r.length?this._proofs=r.map(o=>JSON.parse(o[1])):this._proofs=JSON.parse(this.content)}catch{return}}static from(t){const n=new Rc(t.ndk,t);if(!(!n._proofs||!n._proofs.length))return n}set comment(t){this.content=t??""}get comment(){const t=this.tagValue("comment");return t||this.content}set proofs(t){this._proofs=t,this.tags=this.tags.filter(n=>n[0]!=="proof");for(const n of t)this.tags.push(["proof",JSON.stringify(n)])}get proofs(){return this._proofs}get rawP2pk(){const t=this.proofs[0];try{const n=JSON.parse(t.secret);let r;if(typeof n=="string"?(r=JSON.parse(n),this.debug("stringified payload",t.secret)):typeof n=="object"&&(r=n),Array.isArray(r)&&r[0]==="P2PK"&&r.length>1&&typeof r[1]=="object"&&r[1]!==null||typeof r=="object"&&r!==null&&typeof r[1]?.data=="string")return r[1].data}catch(n){this.debug("error parsing p2pk pubkey",n,this.proofs[0])}}get p2pk(){const t=this.rawP2pk;if(t)return t.startsWith("02")?t.slice(2):t}get mint(){return this.tagValue("u")}set mint(t){this.replaceTag(["u",t])}get unit(){let t=this.tagValue("unit")??"sat";return t?.startsWith("msat")&&(t="sat"),t}set unit(t){if(this.removeTag("unit"),t?.startsWith("msat"))throw new Error("msat is not allowed, use sat denomination instead");t&&this.tag(["unit",t])}get amount(){return this.proofs.reduce((n,r)=>n+r.amount,0)}sender=this.author;set target(t){this.tags=this.tags.filter(n=>n[0]!=="p"),t instanceof NDKEvent&&this.tags.push(t.tagReference())}set recipientPubkey(t){this.removeTag("p"),this.tag(["p",t])}get recipientPubkey(){return this.tagValue("p")}get recipient(){const t=this.recipientPubkey;return this.ndk?this.ndk.getUser({pubkey:t}):new NDKUser({pubkey:t})}async toNostrEvent(){this.unit==="msat"&&(this.unit="sat"),this.removeTag("amount"),this.tags.push(["amount",this.amount.toString()]);const t=await super.toNostrEvent();return t.content=this.comment,t}get isValid(){let t=0,n=0,r=0;for(const o of this.tags)o[0]==="e"&&t++,o[0]==="p"&&n++,o[0]==="u"&&r++;return n===1&&r===1&&t<=1&&this.proofs.length>0}},NDKProject=class zx extends NDKEvent{static kind=31933;static kinds=[31933];_signer;constructor(t,n){super(t,n),this.kind=31933}static from(t){return new zx(t.ndk,t.rawEvent())}set repo(t){this.removeTag("repo"),t&&this.tags.push(["repo",t])}set hashtags(t){this.removeTag("hashtags"),t.filter(n=>n.length>0).length&&this.tags.push(["hashtags",...t])}get hashtags(){const t=this.tags.find(n=>n[0]==="hashtags");return t?t.slice(1):[]}get repo(){return this.tagValue("repo")}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get picture(){return this.tagValue("picture")}set picture(t){this.removeTag("picture"),t&&this.tags.push(["picture",t])}set description(t){this.content=t}get description(){return this.content}get slug(){return this.dTag??"empty-dtag"}async getSigner(){if(this._signer)return this._signer;const t=this.tagValue("key");if(!t)this._signer=NDKPrivateKeySigner.generate(),await this.encryptAndSaveNsec();else{const n=await this.ndk?.signer?.decrypt(this.ndk.activeUser,t);if(!n)throw new Error("Failed to decrypt project key or missing signer context.");this._signer=new NDKPrivateKeySigner(n)}return this._signer}async getNsec(){return(await this.getSigner()).privateKey}async setNsec(t){this._signer=new NDKPrivateKeySigner(t),await this.encryptAndSaveNsec()}async encryptAndSaveNsec(){if(!this._signer)throw new Error("Signer is not set.");const t=this._signer.privateKey,n=await this.ndk?.signer?.encrypt(this.ndk.activeUser,t);n&&(this.removeTag("key"),this.tags.push(["key",n]))}},NDKProjectTemplate=class Vx extends NDKEvent{static kind=30717;static kinds=[30717];constructor(t,n){super(t,n),this.kind=30717}static from(t){return new Vx(t.ndk,t.rawEvent())}get templateId(){return this.dTag??""}set templateId(t){this.dTag=t}get name(){return this.tagValue("title")??""}set name(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get description(){return this.tagValue("description")??""}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}get repoUrl(){return this.tagValue("uri")??""}set repoUrl(t){this.removeTag("uri"),t&&this.tags.push(["uri",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}get command(){return this.tagValue("command")}set command(t){this.removeTag("command"),t&&this.tags.push(["command",t])}get agentConfig(){const t=this.tagValue("agent");if(t)try{return JSON.parse(t)}catch{return}}set agentConfig(t){this.removeTag("agent"),t&&this.tags.push(["agent",JSON.stringify(t)])}get templateTags(){return this.getMatchingTags("t").map(t=>t[1]).filter(Boolean)}set templateTags(t){this.tags=this.tags.filter(n=>n[0]!=="t"),t.forEach(n=>{n&&this.tags.push(["t",n])})}},READ_MARKER="read",WRITE_MARKER="write",NDKRelayList=class qx extends NDKEvent{static kinds=[10002];constructor(t,n){super(t,n),this.kind??=10002}static from(t){return new qx(t.ndk,t.rawEvent())}get readRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]||t[2]&&t[2]===READ_MARKER).map(t=>tryNormalizeRelayUrl(t[1])).filter(t=>!!t)}set readRelayUrls(t){for(const n of t)this.tags.push(["r",n,READ_MARKER])}get writeRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]||t[2]&&t[2]===WRITE_MARKER).map(t=>tryNormalizeRelayUrl(t[1])).filter(t=>!!t)}set writeRelayUrls(t){for(const n of t)this.tags.push(["r",n,WRITE_MARKER])}get bothRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]).map(t=>t[1])}set bothRelayUrls(t){for(const n of t)this.tags.push(["r",n])}get relays(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").map(t=>t[1])}get relaySet(){if(!this.ndk)throw new Error("NDKRelayList has no NDK instance");return new NDKRelaySet(new Set(this.relays.map(t=>this.ndk?.pool.getRelay(t)).filter(t=>!!t)),this.ndk)}};function relayListFromKind3(e,t){try{const n=JSON.parse(t.content),r=new NDKRelayList(e),o=new Set,c=new Set;for(let[l,x]of Object.entries(n)){try{l=normalizeRelayUrl(l)}catch{continue}if(!x)o.add(l),c.add(l);else{const f=x;f.write&&c.add(l),f.read&&o.add(l)}}return r.readRelayUrls=Array.from(o),r.writeRelayUrls=Array.from(c),r}catch{}}var NDKRepost=class Gx extends NDKEvent{_repostedEvents;static kinds=[6,16];static from(t){return new Gx(t.ndk,t.rawEvent())}async repostedEvents(t,n){const r=[];if(!this.ndk)throw new Error("NDK instance not set");if(this._repostedEvents!==void 0)return this._repostedEvents;for(const o of this.repostedEventIds()){const c=filterForId(o),l=await this.ndk.fetchEvent(c,n);l&&r.push(t?t.from(l):l)}return r}repostedEventIds(){return this.tags.filter(t=>t[0]==="e"||t[0]==="a").map(t=>t[1])}};function filterForId(e){if(e.match(/:/)){const[t,n,r]=e.split(":");return{kinds:[Number.parseInt(t)],authors:[n],"#d":[r]}}return{ids:[e]}}var NDKSimpleGroupMemberList=class Wx extends NDKEvent{relaySet;memberSet=new Set;static kind=39002;static kinds=[39002];constructor(t,n){super(t,n),this.kind??=39002,this.memberSet=new Set(this.members)}static from(t){return new Wx(t.ndk,t)}get members(){return this.getMatchingTags("p").map(t=>t[1])}hasMember(t){return this.memberSet.has(t)}async publish(t,n,r){return t??=this.relaySet,super.publishReplaceable(t,n,r)}},NDKSimpleGroupMetadata=class Xx extends NDKEvent{static kind=39e3;static kinds=[39e3];constructor(t,n){super(t,n),this.kind??=39e3}static from(t){return new Xx(t.ndk,t)}get name(){return this.tagValue("name")}get picture(){return this.tagValue("picture")}get about(){return this.tagValue("about")}get scope(){if(this.getMatchingTags("public").length>0)return"public";if(this.getMatchingTags("public").length>0)return"private"}set scope(t){this.removeTag("public"),this.removeTag("private"),t==="public"?this.tags.push(["public",""]):t==="private"&&this.tags.push(["private",""])}get access(){if(this.getMatchingTags("open").length>0)return"open";if(this.getMatchingTags("closed").length>0)return"closed"}set access(t){this.removeTag("open"),this.removeTag("closed"),t==="open"?this.tags.push(["open",""]):t==="closed"&&this.tags.push(["closed",""])}};function strToPosition(e){const[t,n]=e.split(",").map(Number);return{x:t,y:n}}function strToDimension(e){const[t,n]=e.split("x").map(Number);return{width:t,height:n}}var NDKStorySticker=class Yx{static Text="text";static Pubkey="pubkey";static Event="event";static Prompt="prompt";static Countdown="countdown";type;value;position;dimension;properties;constructor(t){if(Array.isArray(t)){const n=t;if(n[0]!=="sticker"||n.length<5)throw new Error("Invalid sticker tag");this.type=n[1],this.value=n[2],this.position=strToPosition(n[3]),this.dimension=strToDimension(n[4]);const r={};for(let o=5;o<n.length;o++){const[c,...l]=n[o].split(" ");r[c]=l.join(" ")}Object.keys(r).length>0&&(this.properties=r)}else this.type=t,this.value=void 0,this.position={x:0,y:0},this.dimension={width:0,height:0}}static fromTag(t){try{return new Yx(t)}catch{return null}}get style(){return this.properties?.style}set style(t){t?this.properties={...this.properties,style:t}:delete this.properties?.style}get rotation(){return this.properties?.rot?Number.parseFloat(this.properties.rot):void 0}set rotation(t){t!==void 0?this.properties={...this.properties,rot:t.toString()}:delete this.properties?.rot}get isValid(){return this.hasValidDimensions()&&this.hasValidPosition()}hasValidDimensions=()=>typeof this.dimension.width=="number"&&typeof this.dimension.height=="number"&&!Number.isNaN(this.dimension.width)&&!Number.isNaN(this.dimension.height);hasValidPosition=()=>typeof this.position.x=="number"&&typeof this.position.y=="number"&&!Number.isNaN(this.position.x)&&!Number.isNaN(this.position.y);toTag(){if(!this.isValid){const r=[this.hasValidDimensions()?void 0:"dimensions is invalid",this.hasValidPosition()?void 0:"position is invalid"].filter(Boolean);throw new Error(`Invalid sticker: ${r.join(", ")}`)}let t;switch(this.type){case"event":t=this.value.tagId();break;case"pubkey":t=this.value.pubkey;break;default:t=this.value}const n=["sticker",this.type,t,coordinates(this.position),dimension(this.dimension)];if(this.properties)for(const[r,o]of Object.entries(this.properties))n.push(`${r} ${o}`);return n}},NDKStory=class Zx extends NDKEvent{static kind=23;static kinds=[23];_imeta;_dimensions;constructor(t,n){if(super(t,n),this.kind??=23,n)for(const r of n.tags)switch(r[0]){case"imeta":this._imeta=mapImetaTag(r);break;case"dim":this.dimensions=strToDimension(r[1]);break}}static from(t){return new Zx(t.ndk,t)}get isValid(){return!!this.imeta}get imeta(){return this._imeta}set imeta(t){this._imeta=t,this.tags=this.tags.filter(n=>n[0]!=="imeta"),t&&this.tags.push(imetaTagToTag(t))}get dimensions(){const t=this.tagValue("dim");if(t)return strToDimension(t)}set dimensions(t){this.removeTag("dim"),t&&this.tags.push(["dim",`${t.width}x${t.height}`])}get duration(){const t=this.tagValue("dur");if(t)return Number.parseInt(t)}set duration(t){this.removeTag("dur"),t!==void 0&&this.tags.push(["dur",t.toString()])}get stickers(){const t=[];for(const n of this.tags){if(n[0]!=="sticker"||n.length<5)continue;const r=NDKStorySticker.fromTag(n);r&&t.push(r)}return t}addSticker(t){let n;if(t instanceof NDKStorySticker)n=t;else{const r=["sticker",t.type,typeof t.value=="string"?t.value:"",coordinates(t.position),dimension(t.dimension)];if(t.properties)for(const[o,c]of Object.entries(t.properties))r.push(`${o} ${c}`);n=new NDKStorySticker(r),n.value=t.value}n.type==="pubkey"?this.tag(n.value):n.type==="event"&&this.tag(n.value),this.tags.push(n.toTag())}removeSticker(t){const n=this.stickers;if(t<0||t>=n.length)return;let r=0;for(let o=0;o<this.tags.length;o++)if(this.tags[o][0]==="sticker"){if(r===t){this.tags.splice(o,1);break}r++}}},coordinates=e=>`${e.x},${e.y}`,dimension=e=>`${e.width}x${e.height}`,NDKSubscriptionReceipt=class Qx extends NDKEvent{debug;static kinds=[7003];constructor(t,n){super(t,n),this.kind??=7003,this.debug=t?.debug.extend("subscription-start")??createDebug5("ndk:subscription-start")}static from(t){return new Qx(t.ndk,t.rawEvent())}get recipient(){const t=this.getMatchingTags("p")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set recipient(t){this.removeTag("p"),t&&this.tags.push(["p",t.pubkey])}get subscriber(){const t=this.getMatchingTags("P")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set subscriber(t){this.removeTag("P"),t&&this.tags.push(["P",t.pubkey])}set subscriptionStart(t){this.debug(`before setting subscription start: ${this.rawEvent}`),this.removeTag("e"),this.tag(t,"subscription",!0),this.debug(`after setting subscription start: ${this.rawEvent}`)}get tierName(){return this.getMatchingTags("tier")?.[0]?.[1]}get isValid(){const t=this.validPeriod;if(!t||t.start>t.end)return!1;const n=this.getMatchingTags("p"),r=this.getMatchingTags("P");return!(n.length!==1||r.length!==1)}get validPeriod(){const t=this.getMatchingTags("valid")?.[0];if(t)try{return{start:new Date(Number.parseInt(t[1])*1e3),end:new Date(Number.parseInt(t[2])*1e3)}}catch{return}}set validPeriod(t){this.removeTag("valid"),t&&this.tags.push(["valid",Math.floor(t.start.getTime()/1e3).toString(),Math.floor(t.end.getTime()/1e3).toString()])}get startPeriod(){return this.validPeriod?.start}get endPeriod(){return this.validPeriod?.end}isActive(t){t??=new Date;const n=this.validPeriod;return!(!n||t<n.start||t>n.end)}},possibleIntervalFrequencies=["daily","weekly","monthly","quarterly","yearly"];function newAmount(e,t,n){return["amount",e.toString(),t,n]}function parseTagToSubscriptionAmount(e){const t=Number.parseInt(e[1]);if(Number.isNaN(t)||t===void 0||t===null||t<=0)return;const n=e[2];if(n===void 0||n==="")return;const r=e[3];if(r!==void 0&&possibleIntervalFrequencies.includes(r))return{amount:t,currency:n,term:r}}var NDKSubscriptionTier=class Jx extends NDKArticle{static kind=37001;static kinds=[37001];constructor(t,n){const r=n?.kind??37001;super(t,n),this.kind=r}static from(t){return new Jx(t.ndk,t)}get perks(){return this.getMatchingTags("perk").map(t=>t[1]).filter(t=>t!==void 0)}addPerk(t){this.tags.push(["perk",t])}get amounts(){return this.getMatchingTags("amount").map(t=>parseTagToSubscriptionAmount(t)).filter(t=>t!==void 0)}addAmount(t,n,r){this.tags.push(newAmount(t,n,r))}set relayUrl(t){this.tags.push(["r",t])}get relayUrls(){return this.getMatchingTags("r").map(t=>t[1]).filter(t=>t!==void 0)}get verifierPubkey(){return this.tagValue("p")}set verifierPubkey(t){this.removeTag("p"),t&&this.tags.push(["p",t])}get isValid(){return this.title!==void 0&&this.amounts.length>0}},NDKSubscriptionStart=class ed extends NDKEvent{debug;static kinds=[7001];constructor(t,n){super(t,n),this.kind??=7001,this.debug=t?.debug.extend("subscription-start")??createDebug5("ndk:subscription-start")}static from(t){return new ed(t.ndk,t.rawEvent())}get recipient(){const t=this.getMatchingTags("p")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set recipient(t){this.removeTag("p"),t&&this.tags.push(["p",t.pubkey])}get amount(){const t=this.getMatchingTags("amount")?.[0];if(t)return parseTagToSubscriptionAmount(t)}set amount(t){this.removeTag("amount"),t&&this.tags.push(newAmount(t.amount,t.currency,t.term))}get tierId(){const t=this.getMatchingTags("e")?.[0],n=this.getMatchingTags("a")?.[0];if(!(!t||!n))return t[1]??n[1]}set tier(t){this.removeTag("e"),this.removeTag("a"),this.removeTag("event"),t&&(this.tag(t),this.removeTag("p"),this.tags.push(["p",t.pubkey]),this.tags.push(["event",JSON.stringify(t.rawEvent())]))}async fetchTier(){const t=this.tagValue("event");if(t)try{const o=JSON.parse(t);return new NDKSubscriptionTier(this.ndk,o)}catch{this.debug("Failed to parse event tag")}const n=this.tierId;if(!n)return;const r=await this.ndk?.fetchEvent(n);if(r)return NDKSubscriptionTier.from(r)}get isValid(){return this.getMatchingTags("amount").length!==1?(this.debug("Invalid # of amount tag"),!1):this.amount?this.getMatchingTags("p").length!==1?(this.debug("Invalid # of p tag"),!1):this.recipient?!0:(this.debug("Invalid p tag"),!1):(this.debug("Invalid amount tag"),!1)}},NDKTask=class td extends NDKEvent{static kind=1934;static kinds=[1934];constructor(t,n){super(t,n),this.kind=1934}static from(t){return new td(t.ndk,t.rawEvent())}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get title(){return this.tagValue("title")}set project(t){this.removeTag("a"),this.tags.push(t.tagReference())}get projectSlug(){const t=this.getMatchingTags("a")[0];return t?t[1].split(/:/)?.[2]:void 0}},NDKThread=class nd extends NDKEvent{static kind=11;static kinds=[11];constructor(t,n){super(t,n),this.kind??=11}static from(t){return new nd(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}},NDKVideo=class rd extends NDKEvent{static kind=21;static kinds=[34235,34236,22,21];_imetas;static from(t){return new rd(t.ndk,t.rawEvent())}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get thumbnail(){let t;return this.imetas&&this.imetas.length>0&&(t=this.imetas[0].image?.[0]),t??this.tagValue("thumb")}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(t=>t[0]==="imeta").map(mapImetaTag),this._imetas)}set imetas(t){this._imetas=t,this.tags=this.tags.filter(n=>n[0]!=="imeta"),this.tags.push(...t.map(imetaTagToTag))}get url(){return this.imetas&&this.imetas.length>0?this.imetas[0].url:this.tagValue("url")}get published_at(){const t=this.tagValue("published_at");if(t)return Number.parseInt(t)}async generateTags(){if(super.generateTags(),!this.kind&&this.imetas?.[0]?.dim){const[t,n]=this.imetas[0].dim.split("x"),r=t&&n&&Number.parseInt(t)<Number.parseInt(n);this.duration&&this.duration<120&&r?this.kind=22:this.kind=21}return super.generateTags()}get duration(){const t=this.tagValue("duration");if(t)return Number.parseInt(t)}set duration(t){this.removeTag("duration"),t!==void 0&&this.tags.push(["duration",Math.floor(t).toString()])}},NDKWiki=class sd extends NDKArticle{static kind=30818;static kinds=[30818];static from(t){return new sd(t.ndk,t.rawEvent())}get isDefered(){return this.hasTag("a","defer")}get deferedId(){return this.tagValue("a","defer")}set defer(t){this.removeTag("a","defer"),this.tag(t,"defer")}},NDKWikiMergeRequest=class id extends NDKEvent{static kinds=[818];static from(t){return new id(t.ndk,t.rawEvent())}get targetId(){return this.tagValue("a")}set target(t){this.tags=this.tags.filter(n=>{if(n[0]==="a"||n[0]==="e"&&n[3]!=="source")return!0}),this.tag(t)}get sourceId(){return this.tagValue("e","source")}set source(t){this.removeTag("e","source"),this.tag(t,"source",!1,"e")}},registeredEventClasses=new Set;function wrapEvent(e){const t=new Map,r=[...[NDKImage,NDKVideo,NDKCashuMintList,NDKArticle,NDKHighlight,NDKDraft,NDKWiki,NDKWikiMergeRequest,NDKNutzap,NDKProject,NDKTask,NDKProjectTemplate,NDKSimpleGroupMemberList,NDKSimpleGroupMetadata,NDKSubscriptionTier,NDKSubscriptionStart,NDKSubscriptionReceipt,NDKList,NDKRelayList,NDKStory,NDKBlossomList,NDKFollowPack,NDKThread,NDKRepost,NDKClassified,NDKAppHandlerEvent,NDKDVMJobFeedback,NDKCashuMintAnnouncement,NDKFedimintMint,NDKMintRecommendation],...registeredEventClasses];for(const c of r)for(const l of c.kinds)t.set(l,c);const o=t.get(e.kind);return o?o.from(e):e}function checkMissingKind(e,t){(e.kind===void 0||e.kind===null)&&t("event-missing-kind",`Cannot sign event without 'kind'.

 Event data:
    content: ${e.content?`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`:"(empty)"}
    tags: ${e.tags.length} tag${e.tags.length!==1?"s":""}
    kind: ${e.kind} 

Set event.kind before signing.`,"Example: event.kind = 1; // for text note",!1)}function checkContentIsObject(e,t){if(typeof e.content=="object"){const n=JSON.stringify(e.content,null,2).substring(0,200);t("event-content-is-object",`Event content is an object. Content must be a string.

 Your content (${typeof e.content}):
${n}${JSON.stringify(e.content).length>200?"...":""}

 event.content = { ... }  // WRONG
 event.content = JSON.stringify({ ... })  // CORRECT`,"Use JSON.stringify() for structured data: event.content = JSON.stringify(data)",!1)}}function checkCreatedAtMilliseconds(e,t){if(e.created_at&&e.created_at>1e10){const n=Math.floor(e.created_at/1e3),r=new Date(e.created_at).toISOString();t("event-created-at-milliseconds",`Event created_at is in milliseconds, not seconds.

 Your value:
    created_at: ${e.created_at} 
    Interpreted as: ${r}
    Should be: ${n} 

Nostr timestamps MUST be in seconds since Unix epoch.`,"Use Math.floor(Date.now() / 1000) instead of Date.now()",!1)}}function checkInvalidPTags(e,t){e.getMatchingTags("p").forEach((r,o)=>{if(r[1]&&!/^[0-9a-f]{64}$/i.test(r[1])){const c=JSON.stringify(r);t("tag-invalid-p-tag",`p-tag[${o}] has invalid pubkey.

 Your tag:
   ${c}

 Invalid value: "${r[1]}"
    Length: ${r[1].length} (expected 64)
    Format: ${r[1].startsWith("npub")?"bech32 (npub)":"unknown"}

p-tags MUST contain 64-character hex pubkeys.`,r[1].startsWith("npub")?`Use ndkUser.pubkey instead of npub:
    event.tags.push(['p', ndkUser.pubkey])
    event.tags.push(['p', 'npub1...'])`:"p-tags must contain valid hex pubkeys (64 characters, 0-9a-f)",!1)}})}function checkInvalidETags(e,t){e.getMatchingTags("e").forEach((r,o)=>{if(r[1]&&!/^[0-9a-f]{64}$/i.test(r[1])){const c=JSON.stringify(r),l=r[1].startsWith("note")||r[1].startsWith("nevent");t("tag-invalid-e-tag",`e-tag[${o}] has invalid event ID.

 Your tag:
   ${c}

 Invalid value: "${r[1]}"
    Length: ${r[1].length} (expected 64)
    Format: ${l?"bech32 (note/nevent)":"unknown"}

e-tags MUST contain 64-character hex event IDs.`,l?`Use event.id instead of bech32:
    event.tags.push(['e', referencedEvent.id])
    event.tags.push(['e', 'note1...'])`:"e-tags must contain valid hex event IDs (64 characters, 0-9a-f)",!1)}})}function checkManualReplyMarkers(e,t,n){if(e.kind!==1||n.has(e))return;const r=e.tags.filter(o=>o[0]==="e"&&(o[3]==="reply"||o[3]==="root"));if(r.length>0){const o=r.map((c,l)=>`   ${l+1}. ${JSON.stringify(c)}`).join(`
`);t("event-manual-reply-markers",`Event has ${r.length} e-tag(s) with manual reply/root markers.

 Your tags with markers:
${o}

  Manual reply markers detected! This will cause incorrect threading.`,`Reply events MUST be created using .reply():

    CORRECT:
   const replyEvent = originalEvent.reply();
   replyEvent.content = 'good point!';
   await replyEvent.publish();

    WRONG:
   event.tags.push(['e', eventId, '', 'reply']);

NDK handles all reply threading automatically - never add reply/root markers manually.`)}}function checkHashtagsWithPrefix(e,t){e.getMatchingTags("t").forEach((r,o)=>{if(r[1]&&r[1].startsWith("#")){const c=JSON.stringify(r);t("tag-hashtag-with-prefix",`t-tag[${o}] contains hashtag with # prefix.

 Your tag:
   ${c}

 Invalid value: "${r[1]}"

Hashtag tags should NOT include the # symbol.`,`Remove the # prefix from hashtag tags:
    event.tags.push(['t', 'nostr'])
    event.tags.push(['t', '#nostr'])`,!1)}})}function checkReplaceableWithOldTimestamp(e,t){if(e.kind===void 0||e.kind===null||!e.created_at||!e.isReplaceable())return;const n=Math.floor(Date.now()/1e3),r=n-e.created_at;if(r>10){const c=Math.floor(r/60),l=c>0?`${c} minute${c!==1?"s":""}`:`${r} seconds`;t("event-replaceable-old-timestamp",`Publishing a replaceable event with an old created_at timestamp.

 Event details:
    kind: ${e.kind} (replaceable)
    created_at: ${e.created_at}
    age: ${l} old
    current time: ${n}

  This is wrong and will be rejected by relays.`,`For replaceable events, use publishReplaceable():

    CORRECT:
   await event.publishReplaceable();
   // Automatically updates created_at to now

    WRONG:
   await event.publish();
   // Uses old created_at`)}}function signing(e,t,n,r){checkMissingKind(e,t),checkContentIsObject(e,t),checkCreatedAtMilliseconds(e,t),checkInvalidPTags(e,t),checkInvalidETags(e,t),checkHashtagsWithPrefix(e,t),checkManualReplyMarkers(e,n,r)}function publishing(e,t){checkReplaceableWithOldTimestamp(e,t)}function isNip33Pattern(e){const t=Array.isArray(e)?e:[e];if(t.length!==1)return!1;const n=t[0];return n.kinds&&Array.isArray(n.kinds)&&n.kinds.length===1&&n.authors&&Array.isArray(n.authors)&&n.authors.length===1&&n["#d"]&&Array.isArray(n["#d"])&&n["#d"].length===1}function isReplaceableEventFilter(e){const t=Array.isArray(e)?e:[e];return t.length===0?!1:t.every(n=>!n.kinds||!Array.isArray(n.kinds)||n.kinds.length===0||!n.authors||!Array.isArray(n.authors)||n.authors.length===0?!1:n.kinds.every(o=>o===0||o===3||o>=1e4&&o<=19999))}function formatFilter(e){return JSON.stringify(e,null,2).split(`
`).map((n,r)=>r===0?n:`   ${n}`).join(`
`)}function fetchingEvents(e,t,n,r,o){if(o(),t?.cacheUsage==="ONLY_CACHE")return;const c=Array.isArray(e)?e:[e],l=c.map(formatFilter).join(`

   ---

   `);if(isNip33Pattern(e))c[0],n("fetch-events-usage",`For fetching a NIP-33 addressable event, use fetchEvent() with the naddr directly.

 Your filter:
   `+l+`

   BAD:  const decoded = nip19.decode(naddr);
           const events = await ndk.fetchEvents({
             kinds: [decoded.data.kind],
             authors: [decoded.data.pubkey],
             "#d": [decoded.data.identifier]
           });
           const event = Array.from(events)[0];

   GOOD: const event = await ndk.fetchEvent(naddr);
   GOOD: const event = await ndk.fetchEvent('naddr1...');

fetchEvent() handles naddr decoding automatically and returns the event directly.`);else{if(isReplaceableEventFilter(e))return;{if(!r())return;let x="";const f=c.some(g=>g.limit!==void 0),m=new Set(c.flatMap(g=>g.kinds||[])).size,E=new Set(c.flatMap(g=>g.authors||[])).size;if(f){const g=Math.max(...c.map(y=>y.limit||0));x+=`
    Limit: ${g} event${g!==1?"s":""}`}m>0&&(x+=`
    Kinds: ${m} type${m!==1?"s":""}`),E>0&&(x+=`
    Authors: ${E} author${E!==1?"s":""}`),n("fetch-events-usage",`fetchEvents() is a BLOCKING operation that waits for EOSE.
In most cases, you should use subscribe() instead.

 Your filter`+(c.length>1?"s":"")+`:
   `+l+(x?`

 Filter analysis:`+x:"")+`

   BAD:  const events = await ndk.fetchEvents(filter);
   GOOD: ndk.subscribe(filter, { onEvent: (e) => ... });

Only use fetchEvents() when you MUST block until data arrives.`,"For one-time queries, use fetchEvent() instead of fetchEvents() when expecting a single result.")}}}var GuardrailCheckId={NDK_NO_CACHE:"ndk-no-cache",FILTER_BECH32_IN_ARRAY:"filter-bech32-in-array",FILTER_INVALID_HEX:"filter-invalid-hex",FILTER_ONLY_LIMIT:"filter-only-limit",FILTER_EMPTY:"filter-empty",FILTER_SINCE_AFTER_UNTIL:"filter-since-after-until",FILTER_INVALID_A_TAG:"filter-invalid-a-tag",FILTER_HASHTAG_WITH_PREFIX:"filter-hashtag-with-prefix"};function checkCachePresence(e,t){t(GuardrailCheckId.NDK_NO_CACHE)&&setTimeout(()=>{if(!e.cacheAdapter){const o=`
 AI_GUARDRAILS WARNING: NDK initialized without a cache adapter. Apps perform significantly better with caching.

 ${typeof window<"u"?"Consider using @nostr-dev-kit/ndk-cache-dexie or @nostr-dev-kit/ndk-cache-sqlite-wasm":"Consider using @nostr-dev-kit/ndk-cache-redis or @nostr-dev-kit/ndk-cache-sqlite"}

 To disable this check:
   ndk.aiGuardrails.skip('${GuardrailCheckId.NDK_NO_CACHE}')
   or set: ndk.aiGuardrails = { skip: new Set(['${GuardrailCheckId.NDK_NO_CACHE}']) }`;console.warn(o)}},2500)}var AIGuardrails=class{enabled=!1;skipSet=new Set;extensions=new Map;_nextCallDisabled=null;_replyEvents=new WeakSet;_fetchEventsCount=0;_subscribeCount=0;constructor(e=!1){this.setMode(e)}register(e,t){this.extensions.has(e)&&console.warn(`AIGuardrails: Extension '${e}' already registered, overwriting`);const n={};for(const[r,o]of Object.entries(t))typeof o=="function"&&(n[r]=(...c)=>{this.enabled&&o(...c,this.shouldCheck.bind(this),this.error.bind(this),this.warn.bind(this))});this.extensions.set(e,n),this[e]=n}setMode(e){typeof e=="boolean"?(this.enabled=e,this.skipSet.clear()):e&&typeof e=="object"&&(this.enabled=!0,this.skipSet=e.skip||new Set)}isEnabled(){return this.enabled}shouldCheck(e){return!(!this.enabled||this.skipSet.has(e)||this._nextCallDisabled==="all"||this._nextCallDisabled&&this._nextCallDisabled.has(e))}skip(e){this.skipSet.add(e)}enable(e){this.skipSet.delete(e)}getSkipped(){return Array.from(this.skipSet)}captureAndClearNextCallDisabled(){const e=this._nextCallDisabled;return this._nextCallDisabled=null,e}incrementFetchEventsCount(){this._fetchEventsCount++}incrementSubscribeCount(){this._subscribeCount++}shouldWarnAboutFetchEventsRatio(){const e=this._fetchEventsCount+this._subscribeCount;return e<=6?!1:this._fetchEventsCount/e>.5}error(e,t,n,r=!0){if(!this.shouldCheck(e))return;const o=this.formatMessage(e,"ERROR",t,n,r);throw console.error(o),new Error(o)}warn(e,t,n){if(!this.shouldCheck(e))return;const r=this.formatMessage(e,"WARNING",t,n,!0);throw console.error(r),new Error(r)}formatMessage(e,t,n,r,o=!0){let c=`
 AI_GUARDRAILS ${t}: ${n}`;return r&&(c+=`

 ${r}`),o&&(c+=`

 To disable this check:
   ndk.guardrailOff('${e}').yourMethod()  // For one call`,c+=`
   ndk.aiGuardrails.skip('${e}')  // Permanently`,c+=`
   or set: ndk.aiGuardrails = { skip: new Set(['${e}']) }`),c}ndkInstantiated(e){this.enabled&&checkCachePresence(e,this.shouldCheck.bind(this))}ndk={fetchingEvents:(e,t)=>{this.enabled&&fetchingEvents(e,t,this.warn.bind(this),this.shouldWarnAboutFetchEventsRatio.bind(this),this.incrementFetchEventsCount.bind(this))}};event={signing:e=>{this.enabled&&signing(e,this.error.bind(this),this.warn.bind(this),this._replyEvents)},publishing:e=>{this.enabled&&publishing(e,this.warn.bind(this))},received:(e,t)=>{this.enabled},creatingReply:e=>{this.enabled&&this._replyEvents.add(e)}};subscription={created:(e,t)=>{this.enabled&&this.incrementSubscribeCount()}};relay={connected:e=>{this.enabled}}};function processFilters(e,t="validate",n,r){if(t==="ignore")return e;const o=[],c=e.map((l,x)=>(r?.aiGuardrails.isEnabled()&&runAIGuardrailsForFilter(l,x,r),processFilter(l,t,x,o,n)));if(t==="validate"&&o.length>0)throw new Error(`Invalid filter(s) detected:
${o.join(`
`)}`);return c}function processFilter(e,t,n,r,o){const c=t==="validate",l=c?e:{...e};if(e.ids){const x=[];e.ids.forEach((f,m)=>{f===void 0?c?r.push(`Filter[${n}].ids[${m}] is undefined`):o?.(`Fixed: Removed undefined value at ids[${m}]`):typeof f!="string"?c?r.push(`Filter[${n}].ids[${m}] is not a string (got ${typeof f})`):o?.(`Fixed: Removed non-string value at ids[${m}] (was ${typeof f})`):isValidHex64(f)?x.push(f):c?r.push(`Filter[${n}].ids[${m}] is not a valid 64-char hex string: "${f}"`):o?.(`Fixed: Removed invalid hex string at ids[${m}]`)}),c||(l.ids=x.length>0?x:void 0)}if(e.authors){const x=[];e.authors.forEach((f,m)=>{f===void 0?c?r.push(`Filter[${n}].authors[${m}] is undefined`):o?.(`Fixed: Removed undefined value at authors[${m}]`):typeof f!="string"?c?r.push(`Filter[${n}].authors[${m}] is not a string (got ${typeof f})`):o?.(`Fixed: Removed non-string value at authors[${m}] (was ${typeof f})`):isValidHex64(f)?x.push(f):c?r.push(`Filter[${n}].authors[${m}] is not a valid 64-char hex pubkey: "${f}"`):o?.(`Fixed: Removed invalid hex pubkey at authors[${m}]`)}),c||(l.authors=x.length>0?x:void 0)}if(e.kinds){const x=[];e.kinds.forEach((f,m)=>{f===void 0?c?r.push(`Filter[${n}].kinds[${m}] is undefined`):o?.(`Fixed: Removed undefined value at kinds[${m}]`):typeof f!="number"?c?r.push(`Filter[${n}].kinds[${m}] is not a number (got ${typeof f})`):o?.(`Fixed: Removed non-number value at kinds[${m}] (was ${typeof f})`):Number.isInteger(f)?f<0||f>65535?c?r.push(`Filter[${n}].kinds[${m}] is out of valid range (0-65535): ${f}`):o?.(`Fixed: Removed out-of-range kind at kinds[${m}]: ${f}`):x.push(f):c?r.push(`Filter[${n}].kinds[${m}] is not an integer: ${f}`):o?.(`Fixed: Removed non-integer value at kinds[${m}]: ${f}`)}),c||(l.kinds=x.length>0?x:void 0)}for(const x in e)if(x.startsWith("#")&&x.length===2){const f=e[x];if(Array.isArray(f)){const m=[];f.forEach((E,g)=>{E===void 0?c?r.push(`Filter[${n}].${x}[${g}] is undefined`):o?.(`Fixed: Removed undefined value at ${x}[${g}]`):typeof E!="string"?c?r.push(`Filter[${n}].${x}[${g}] is not a string (got ${typeof E})`):o?.(`Fixed: Removed non-string value at ${x}[${g}] (was ${typeof E})`):(x==="#e"||x==="#p")&&!isValidHex64(E)?c?r.push(`Filter[${n}].${x}[${g}] is not a valid 64-char hex string: "${E}"`):o?.(`Fixed: Removed invalid hex string at ${x}[${g}]`):m.push(E)}),c||(l[x]=m.length>0?m:void 0)}}return c||Object.keys(l).forEach(x=>{l[x]===void 0&&delete l[x]}),l}function runAIGuardrailsForFilter(e,t,n){const r=n.aiGuardrails,o=JSON.stringify(e,null,2);if(Object.keys(e).length===1&&e.limit!==void 0&&r.error(GuardrailCheckId.FILTER_ONLY_LIMIT,`Filter[${t}] contains only 'limit' without any filtering criteria.

 Your filter:
${o}

  This will fetch random events from relays without any criteria.`,`Add filtering criteria:
    { kinds: [1], limit: 10 }
    { authors: [pubkey], limit: 10 }
    { limit: 10 }`),Object.keys(e).length===0&&r.error(GuardrailCheckId.FILTER_EMPTY,`Filter[${t}] is empty.

 Your filter:
${o}

  This will request ALL events from relays, which is never what you want.`,"Add filtering criteria like 'kinds', 'authors', or tags.",!1),e.since!==void 0&&e.until!==void 0&&e.since>e.until){const l=new Date(e.since*1e3).toISOString(),x=new Date(e.until*1e3).toISOString();r.error(GuardrailCheckId.FILTER_SINCE_AFTER_UNTIL,`Filter[${t}] has 'since' AFTER 'until'.

 Your filter:
${o}

 since: ${e.since} (${l})
 until: ${e.until} (${x})

No events can match this time range!`,"'since' must be BEFORE 'until'. Both are Unix timestamps in seconds.",!1)}const c=/^n(addr|event|ote|pub|profile)1/;e.ids&&e.ids.forEach((l,x)=>{typeof l=="string"&&(c.test(l)?r.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].ids[${x}] contains bech32: "${l}". IDs must be hex, not bech32.`,'Use filterFromId() to decode bech32 first: import { filterFromId } from "@nostr-dev-kit/ndk"',!1):isValidHex64(l)||r.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].ids[${x}] is not a valid 64-char hex string: "${l}"`,`Event IDs must be 64-character hexadecimal strings. Invalid IDs often come from corrupted data in user-generated lists. Always validate hex strings before using them in filters:

   const validIds = ids.filter(id => /^[0-9a-f]{64}$/i.test(id));`,!1))}),e.authors&&e.authors.forEach((l,x)=>{typeof l=="string"&&(c.test(l)?r.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].authors[${x}] contains bech32: "${l}". Authors must be hex pubkeys, not npub.`,"Use ndkUser.pubkey instead. Example: { authors: [ndkUser.pubkey] }",!1):isValidHex64(l)||r.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].authors[${x}] is not a valid 64-char hex pubkey: "${l}"`,`Kind:3 follow lists can contain invalid entries like labels ("Follow List"), partial strings ("highlig"), or other corrupted data. You MUST validate all pubkeys before using them in filters.

   Example:
   const validPubkeys = pubkeys.filter(p => /^[0-9a-f]{64}$/i.test(p));
   ndk.subscribe({ authors: validPubkeys, kinds: [1] });`,!1))});for(const l in e)if(l.startsWith("#")&&l.length===2){const x=e[l];Array.isArray(x)&&x.forEach((f,m)=>{typeof f=="string"&&(l==="#e"||l==="#p")&&(c.test(f)?r.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].${l}[${m}] contains bech32: "${f}". Tag values must be decoded.`,"Use filterFromId() or nip19.decode() to get the hex value first.",!1):isValidHex64(f)||r.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].${l}[${m}] is not a valid 64-char hex string: "${f}"`,`${l==="#e"?"Event IDs":"Public keys"} in tag filters must be 64-character hexadecimal strings. Kind:3 follow lists and other user-generated content can contain invalid data. Always filter before using:

   const validValues = values.filter(v => /^[0-9a-f]{64}$/i.test(v));`,!1))})}e["#a"]&&e["#a"]?.forEach((x,f)=>{if(typeof x=="string")if(!/^\d+:[0-9a-f]{64}:.*$/.test(x))r.error(GuardrailCheckId.FILTER_INVALID_A_TAG,`Filter[${t}].#a[${f}] has invalid format: "${x}". Must be "kind:pubkey:d-tag".`,'Example: "30023:fa984bd7dbb282f07e16e7ae87b26a2a7b9b90b7246a44771f0cf5ae58018f52:my-article"',!1);else{const m=Number.parseInt(x.split(":")[0],10);(m<3e4||m>39999)&&r.error(GuardrailCheckId.FILTER_INVALID_A_TAG,`Filter[${t}].#a[${f}] uses non-addressable kind ${m}: "${x}". #a filters are only for addressable events (kinds 30000-39999).`,`Addressable events include:
    30000-30039: Parameterized Replaceable Events (profiles, settings, etc.)
    30040-39999: Other addressable events

For regular events (kind ${m}), use:
    #e filter for specific event IDs
    kinds + authors filters for event queries`,!1)}}),e["#t"]&&e["#t"]?.forEach((x,f)=>{typeof x=="string"&&x.startsWith("#")&&r.error(GuardrailCheckId.FILTER_HASHTAG_WITH_PREFIX,`Filter[${t}].#t[${f}] contains hashtag with # prefix: "${x}". Hashtag values should NOT include the # symbol.`,`Remove the # prefix from hashtag filters:
    { "#t": ["nostr"] }
    { "#t": ["#nostr"] }`,!1)})}function queryFullyFilled(e){return!!(filterIncludesIds(e.filter)&&resultHasAllRequestedIds(e))}function filterIncludesIds(e){return!!e.ids}function resultHasAllRequestedIds(e){const t=e.filter.ids;return!!t&&t.length===e.eventFirstSeen.size}function filterFromId(e){let t;if(e.match(NIP33_A_REGEX)){const[n,r,o]=e.split(":"),c={authors:[r],kinds:[Number.parseInt(n)]};return o&&(c["#d"]=[o]),c}if(e.match(BECH32_REGEX))try{switch(t=nip19_exports$1.decode(e),t.type){case"nevent":{const n={ids:[t.data.id]};return t.data.author&&(n.authors=[t.data.author]),t.data.kind&&(n.kinds=[t.data.kind]),n}case"note":return{ids:[t.data]};case"naddr":{const n={authors:[t.data.pubkey],kinds:[t.data.kind]};return t.data.identifier&&(n["#d"]=[t.data.identifier]),n}}}catch(n){console.error("Error decoding",e,n)}return{ids:[e]}}function isNip33AValue(e){return e.match(NIP33_A_REGEX)!==null}var NIP33_A_REGEX=/^(\d+):([0-9A-Fa-f]+)(?::(.*))?$/,BECH32_REGEX=/^n(event|ote|profile|pub|addr)1[\d\w]+$/;function relaysFromBech32(e,t){try{const n=nip19_exports$1.decode(e);if(["naddr","nevent"].includes(n?.type)){const r=n.data;if(r?.relays)return r.relays.map(o=>new NDKRelay(o,t.relayAuthDefaultPolicy,t))}}catch{}return[]}var defaultOpts={closeOnEose:!1,cacheUsage:"CACHE_FIRST",dontSaveToCache:!1,groupable:!0,groupableDelay:100,groupableDelayType:"at-most",cacheUnconstrainFilter:["limit","since","until"],includeMuted:!1},NDKSubscription=class extends libExports.EventEmitter{subId;filters;opts;pool;skipVerification=!1;skipValidation=!1;exclusiveRelay=!1;relayFilters;relaySet;ndk;debug;eventFirstSeen=new Map;eosesSeen=new Set;lastEventReceivedAt;mostRecentCacheEventTimestamp;internalId;closeOnEose;poolMonitor;skipOptimisticPublishEvent=!1;cacheUnconstrainFilter;constructor(e,t,n,r){super(),this.ndk=e,this.opts={...defaultOpts,...n||{}},this.pool=this.opts.pool||e.pool;const o=Array.isArray(t)?t:[t],c=e.filterValidationMode==="validate"?"validate":e.filterValidationMode==="fix"?"fix":"ignore";if(this.filters=processFilters(o,c,e.debug,e),this.filters.length===0)throw new Error("Subscription must have at least one filter");this.subId=r||this.opts.subId,this.internalId=Math.random().toString(36).substring(7),this.debug=e.debug.extend(`subscription[${this.opts.subId??this.internalId}]`),this.opts.relaySet?this.relaySet=this.opts.relaySet:this.opts.relayUrls&&(this.relaySet=NDKRelaySet.fromRelayUrls(this.opts.relayUrls,this.ndk)),this.skipVerification=this.opts.skipVerification||!1,this.skipValidation=this.opts.skipValidation||!1,this.closeOnEose=this.opts.closeOnEose||!1,this.skipOptimisticPublishEvent=this.opts.skipOptimisticPublishEvent||!1,this.cacheUnconstrainFilter=this.opts.cacheUnconstrainFilter,this.exclusiveRelay=this.opts.exclusiveRelay||!1,this.opts.onEvent&&this.on("event",this.opts.onEvent),this.opts.onEose&&this.on("eose",this.opts.onEose),this.opts.onClose&&this.on("close",this.opts.onClose)}relaysMissingEose(){return this.relayFilters?Array.from(this.relayFilters?.keys()).filter(t=>!this.eosesSeen.has(this.pool.getRelay(t,!1,!1))):[]}get filter(){return this.filters[0]}get groupableDelay(){if(this.isGroupable())return this.opts?.groupableDelay}get groupableDelayType(){return this.opts?.groupableDelayType||"at-most"}isGroupable(){return this.opts?.groupable||!1}shouldQueryCache(){return this.opts.addSinceFromCache?!0:this.opts?.cacheUsage==="ONLY_RELAY"?!1:(this.filters.some(t=>t.kinds?.some(n=>kindIsEphemeral(n))),!0)}shouldQueryRelays(){return this.opts?.cacheUsage!=="ONLY_CACHE"}shouldWaitForCache(){return this.opts.addSinceFromCache?!0:!!this.opts.closeOnEose&&!!this.ndk.cacheAdapter?.locking&&this.opts.cacheUsage!=="PARALLEL"}start(e=!0){let t;const n=o=>{for(const c of o)c.created_at&&(!this.mostRecentCacheEventTimestamp||c.created_at>this.mostRecentCacheEventTimestamp)&&(this.mostRecentCacheEventTimestamp=c.created_at),this.eventReceived(c,void 0,!0,!1);e||(t=o)},r=()=>{this.shouldQueryRelays()?(this.startWithRelays(),this.startPoolMonitor()):this.emit("eose",this)};return this.shouldQueryCache()?(t=this.startWithCache(),t instanceof Promise?this.shouldWaitForCache()?(t.then(o=>{if(n(o),queryFullyFilled(this)){this.emit("eose",this);return}r()}),null):(t.then(o=>{n(o),this.shouldQueryRelays()||this.emit("eose",this)}),this.shouldQueryRelays()&&r(),null):(n(t),queryFullyFilled(this)?this.emit("eose",this):r(),t)):(r(),null)}startPoolMonitor(){this.debug.extend("pool-monitor"),this.poolMonitor=e=>{if(this.relayFilters?.has(e.url))return;calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool,this.opts.relayGoalPerAuthor).get(e.url)&&(this.relayFilters?.set(e.url,this.filters),e.subscribe(this,this.filters))},this.pool.on("relay:connect",this.poolMonitor)}onStopped;stop(){this.emit("close",this),this.poolMonitor&&this.pool.off("relay:connect",this.poolMonitor),this.onStopped?.()}hasAuthorsFilter(){return this.filters.some(e=>e.authors?.length)}startWithCache(){return this.ndk.cacheAdapter?.query?this.ndk.cacheAdapter.query(this):[]}startWithRelays(){let e=this.filters;if(this.opts.addSinceFromCache&&this.mostRecentCacheEventTimestamp){const t=this.mostRecentCacheEventTimestamp+1;e=e.map(n=>({...n,since:Math.max(n.since||0,t)}))}if(!this.relaySet||this.relaySet.relays.size===0)this.relayFilters=calculateRelaySetsFromFilters(this.ndk,e,this.pool,this.opts.relayGoalPerAuthor);else{this.relayFilters=new Map;for(const t of this.relaySet.relays)this.relayFilters.set(t.url,e)}for(const[t,n]of this.relayFilters)this.pool.getRelay(t,!0,!0,n).subscribe(this,n)}refreshRelayConnections(){if(this.relaySet&&this.relaySet.relays.size>0)return;const e=calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool,this.opts.relayGoalPerAuthor);for(const[t,n]of e)this.relayFilters?.has(t)||(this.relayFilters?.set(t,n),this.pool.getRelay(t,!0,!0,n).subscribe(this,n))}eventReceived(e,t,n=!1,r=!1){const o=e.id,c=this.eventFirstSeen.has(o);let l;if(e instanceof NDKEvent&&(l=e),c){const x=Date.now()-(this.eventFirstSeen.get(o)||0);if(this.emit("event:dup",e,t,x,this,n,r),this.opts?.onEventDup&&this.opts.onEventDup(e,t,x,this,n,r),!n&&!r&&t&&this.ndk.cacheAdapter?.setEventDup&&!this.opts.dontSaveToCache&&(l??=e instanceof NDKEvent?e:new NDKEvent(this.ndk,e),this.ndk.cacheAdapter.setEventDup(l,t)),t){const f=verifiedSignatures.get(o);if(f&&typeof f=="string")if(e.sig===f)t.addValidatedEvent();else{const m=e instanceof NDKEvent?e:new NDKEvent(this.ndk,e);this.ndk.reportInvalidSignature(m,t)}}}else{if(l??=new NDKEvent(this.ndk,e),l.ndk=this.ndk,l.relay=t,!n&&!r){if(!this.skipValidation&&!l.isValid){this.debug("Event failed validation %s from relay %s",o,t?.url);return}if(t)if(t.shouldValidateEvent()&&!this.skipVerification)if(l.relay=t,this.ndk.asyncSigVerification)l.verifySignature(!0);else{if(!l.verifySignature(!0)){this.debug("Event failed signature validation",e),this.ndk.reportInvalidSignature(l,t);return}t.addValidatedEvent()}else t.addNonValidatedEvent();this.ndk.cacheAdapter&&!this.opts.dontSaveToCache&&this.ndk.cacheAdapter.setEvent(l,this.filters,t)}if(!this.opts.includeMuted&&this.ndk.muteFilter&&this.ndk.muteFilter(l)){this.debug("Event muted, skipping");return}(!r||this.skipOptimisticPublishEvent!==!0)&&(this.emitEvent(this.opts?.wrap??!1,l,t,n,r),this.eventFirstSeen.set(o,Date.now()))}this.lastEventReceivedAt=Date.now()}emitEvent(e,t,n,r,o){const c=e?wrapEvent(t):t;c instanceof Promise?c.then(l=>this.emitEvent(!1,l,n,r,o)):c&&this.emit("event",c,n,this,r,o)}closedReceived(e,t){this.emit("closed",e,t)}eoseTimeout;eosed=!1;eoseReceived(e){this.debug("EOSE received from %s",e.url),this.eosesSeen.add(e);let t=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0;const n=this.eosesSeen.size===this.relayFilters?.size,r=queryFullyFilled(this),o=c=>{this.debug("Performing EOSE: %s %d",c,this.eosed),!this.eosed&&(this.eoseTimeout&&clearTimeout(this.eoseTimeout),this.emit("eose",this),this.eosed=!0,this.opts?.closeOnEose&&this.stop())};if(r||n)o("query filled or seen all");else if(this.relayFilters){let c=1e3;const l=new Set(this.pool.connectedRelays().map(m=>m.url)),x=Array.from(this.relayFilters.keys()).filter(m=>l.has(m));if(x.length===0){this.debug("No connected relays, waiting for all relays to connect",Array.from(this.relayFilters.keys()).join(", "));return}const f=this.eosesSeen.size/x.length;if(this.debug("Percentage of relays that have sent EOSE",{subId:this.subId,percentageOfRelaysThatHaveSentEose:f,seen:this.eosesSeen.size,total:x.length}),this.eosesSeen.size>=2&&f>=.5){if(c=c*(1-f),c===0){o("time to wait was 0");return}this.eoseTimeout&&clearTimeout(this.eoseTimeout);const m=()=>{t=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0,t!==void 0&&t<20?this.eoseTimeout=setTimeout(m,c):o(`send eose timeout: ${c}`)};this.eoseTimeout=setTimeout(m,c)}}}},kindIsEphemeral=e=>e>=2e4&&e<3e4;async function follows(e,t,n=3){if(!this.ndk)throw new Error("NDK not set");const r=await this.ndk.fetchEvent({kinds:[n],authors:[this.pubkey]},e||{groupable:!1});if(r){const o=new Set;return r.tags.forEach(c=>{c[0]==="p"&&c[1]&&isValidPubkey(c[1])&&o.add(c[1])}),t&&this.ndk?.outboxTracker?.trackUsers(Array.from(o)),[...o].reduce((c,l)=>{const x=new NDKUser({pubkey:l});return x.ndk=this.ndk,c.add(x),c},new Set)}return new Set}var NIP05_REGEX=/^(?:([\w.+-]+)@)?([\w.-]+)$/;async function getNip05For(e,t,n=fetch,r={}){return await e.queuesNip05.add({id:t,func:async()=>{if(e.cacheAdapter?.loadNip05){const f=await e.cacheAdapter.loadNip05(t);if(f!=="missing"){if(f){const m=new NDKUser({pubkey:f.pubkey,relayUrls:f.relays,nip46Urls:f.nip46});return m.ndk=e,m}if(r.cache!=="no-cache")return null}}const o=t.match(NIP05_REGEX);if(!o)return null;const[c,l="_",x]=o;try{const f=await n(`https://${x}/.well-known/nostr.json?name=${l}`,r),{names:m,relays:E,nip46:g}=parseNIP05Result(await f.json()),y=m[l.toLowerCase()];let w=null;return y&&(w={pubkey:y,relays:E?.[y],nip46:g?.[y]}),e?.cacheAdapter?.saveNip05&&e.cacheAdapter.saveNip05(t,w),w}catch(f){return e?.cacheAdapter?.saveNip05&&e?.cacheAdapter.saveNip05(t,null),console.error("Failed to fetch NIP05 for",t,f),null}}})}function parseNIP05Result(e){const t={names:{}};for(const[n,r]of Object.entries(e.names))typeof n=="string"&&typeof r=="string"&&(t.names[n.toLowerCase()]=r);if(e.relays){t.relays={};for(const[n,r]of Object.entries(e.relays))typeof n=="string"&&Array.isArray(r)&&(t.relays[n]=r.filter(o=>typeof o=="string"))}if(e.nip46){t.nip46={};for(const[n,r]of Object.entries(e.nip46))typeof n=="string"&&Array.isArray(r)&&(t.nip46[n]=r.filter(o=>typeof o=="string"))}return t}function profileFromEvent(e){const t={};let n;try{n=JSON.parse(e.content)}catch(r){throw new Error(`Failed to parse profile event: ${r}`)}t.profileEvent=JSON.stringify(e.rawEvent());for(const r of Object.keys(n))switch(r){case"name":t.name=n.name;break;case"display_name":t.displayName=n.display_name;break;case"image":case"picture":t.picture=n.picture||n.image,t.image=t.picture;break;case"banner":t.banner=n.banner;break;case"bio":t.bio=n.bio;break;case"nip05":t.nip05=n.nip05;break;case"lud06":t.lud06=n.lud06;break;case"lud16":t.lud16=n.lud16;break;case"about":t.about=n.about;break;case"website":t.website=n.website;break;default:t[r]=n[r];break}return t.created_at=e.created_at,t}function serializeProfile(e){const t={};for(const[n,r]of Object.entries(e))switch(n){case"username":case"name":t.name=r;break;case"displayName":t.display_name=r;break;case"image":case"picture":t.picture=r;break;case"bio":case"about":t.about=r;break;default:t[n]=r;break}return JSON.stringify(t)}var NDKUser=class od{ndk;profile;profileEvent;_npub;_pubkey;relayUrls=[];nip46Urls=[];constructor(t){if(t.npub&&(this._npub=t.npub),t.hexpubkey&&(this._pubkey=t.hexpubkey),t.pubkey&&(this._pubkey=t.pubkey),t.relayUrls&&(this.relayUrls=t.relayUrls),t.nip46Urls&&(this.nip46Urls=t.nip46Urls),t.nprofile)try{const n=nip19_exports$1.decode(t.nprofile);n.type==="nprofile"&&(this._pubkey=n.data.pubkey,n.data.relays&&n.data.relays.length>0&&this.relayUrls.push(...n.data.relays))}catch(n){console.error("Failed to decode nprofile",n)}}get npub(){if(!this._npub){if(!this._pubkey)throw new Error("pubkey not set");this._npub=nip19_exports$1.npubEncode(this.pubkey)}return this._npub}get nprofile(){const t=this.profileEvent?.onRelays?.map(n=>n.url);return nip19_exports$1.nprofileEncode({pubkey:this.pubkey,relays:t})}set npub(t){this._npub=t}get pubkey(){if(!this._pubkey){if(!this._npub)throw new Error("npub not set");this._pubkey=nip19_exports$1.decode(this.npub).data}return this._pubkey}set pubkey(t){this._pubkey=t}filter(){return{"#p":[this.pubkey]}}async getZapInfo(t){if(!this.ndk)throw new Error("No NDK instance found");const n=async l=>{if(!t)return l;let x;const f=new Promise((m,E)=>{x=setTimeout(()=>E(new Error("Timeout")),t)});try{const m=await Promise.race([l,f]);return x&&clearTimeout(x),m}catch(m){if(m instanceof Error&&m.message==="Timeout")try{return await l}catch{return}return}},[r,o]=await Promise.all([n(this.fetchProfile()),n(this.ndk.fetchEvent({kinds:[10019],authors:[this.pubkey]}))]),c=new Map;if(o){const l=NDKCashuMintList.from(o);l.mints.length>0&&c.set("nip61",{mints:l.mints,relays:l.relays,p2pk:l.p2pk})}if(r){const{lud06:l,lud16:x}=r;c.set("nip57",{lud06:l,lud16:x})}return c}static async fromNip05(t,n,r=!1){if(!n)throw new Error("No NDK instance found");const o={};r&&(o.cache="no-cache");const c=await getNip05For(n,t,n?.httpFetch,o);if(c){const l=new od({pubkey:c.pubkey,relayUrls:c.relays,nip46Urls:c.nip46});return l.ndk=n,l}}async fetchProfile(t,n=!1){if(!this.ndk)throw new Error("NDK not set");let r=null;if(this.ndk.cacheAdapter&&(this.ndk.cacheAdapter.fetchProfile||this.ndk.cacheAdapter.fetchProfileSync)&&t?.cacheUsage!=="ONLY_RELAY"){let o=null;if(this.ndk.cacheAdapter.fetchProfileSync?o=this.ndk.cacheAdapter.fetchProfileSync(this.pubkey):this.ndk.cacheAdapter.fetchProfile&&(o=await this.ndk.cacheAdapter.fetchProfile(this.pubkey)),o)return this.profile=o,o}return t??={},t.cacheUsage??="ONLY_RELAY",t.closeOnEose??=!0,t.groupable??=!0,t.groupableDelay??=250,r||(r=await this.ndk.fetchEvent({kinds:[0],authors:[this.pubkey]},t)),r?(this.profile=profileFromEvent(r),n&&this.profile&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.saveProfile&&this.ndk.cacheAdapter.saveProfile(this.pubkey,this.profile),this.profile):null}follows=follows.bind(this);async followSet(t,n,r=3){const o=await this.follows(t,n,r);return new Set(Array.from(o).map(c=>c.pubkey))}tagReference(){return["p",this.pubkey]}referenceTags(t){const n=[["p",this.pubkey]];return t&&n[0].push("",t),n}async publish(){if(!this.ndk)throw new Error("No NDK instance found");if(!this.profile)throw new Error("No profile available");this.ndk.assertSigner(),await new NDKEvent(this.ndk,{kind:0,content:serializeProfile(this.profile)}).publish()}async follow(t,n,r=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),n||(n=await this.follows(void 0,void 0,r));const o=typeof t=="string"?t:t.pubkey;if(Array.from(n).some(x=>typeof x=="string"?x===o:x.pubkey===o))return!1;n.add(t);const l=new NDKEvent(this.ndk,{kind:r});for(const x of n)typeof x=="string"?l.tags.push(["p",x]):l.tag(x);return await l.publish(),!0}async unfollow(t,n,r=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),n||(n=await this.follows(void 0,void 0,r));const o=typeof t=="string"?t:t.pubkey,c=new Set;let l=!1;for(const f of n)(typeof f=="string"?f:f.pubkey)!==o?c.add(f):l=!0;if(!l)return!1;const x=new NDKEvent(this.ndk,{kind:r});for(const f of c)typeof f=="string"?x.tags.push(["p",f]):x.tag(f);return await x.publish()}async validateNip05(t){if(!this.ndk)throw new Error("No NDK instance found");const n=await getNip05For(this.ndk,t);return n===null?null:n.pubkey===this.pubkey}},signerRegistry=new Map;function registerSigner(e,t){signerRegistry.set(e,t)}var NDKPrivateKeySigner=class mo{_user;_privateKey;_pubkey;constructor(t,n){if(typeof t=="string")if(t.startsWith("nsec1")){const{type:r,data:o}=nip19_exports$1.decode(t);if(r==="nsec")this._privateKey=o;else throw new Error("Invalid private key provided.")}else if(t.length===64)this._privateKey=hexToBytes$2(t);else throw new Error("Invalid private key provided.");else this._privateKey=t;this._pubkey=getPublicKey(this._privateKey),n&&(this._user=n.getUser({pubkey:this._pubkey})),this._user??=new NDKUser({pubkey:this._pubkey})}get privateKey(){if(!this._privateKey)throw new Error("Not ready");return bytesToHex(this._privateKey)}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}get nsec(){if(!this._privateKey)throw new Error("Not ready");return nip19_exports$1.nsecEncode(this._privateKey)}get npub(){if(!this._pubkey)throw new Error("Not ready");return nip19_exports$1.npubEncode(this._pubkey)}encryptToNcryptsec(t,n=16,r=2){if(!this._privateKey)throw new Error("Private key not available");return encrypt$1(this._privateKey,t,n,r)}static generate(){const t=generateSecretKey();return new mo(t)}static fromNcryptsec(t,n,r){const o=decrypt$1(t,n);return new mo(o,r)}async blockUntilReady(){return this._user}async user(){return this._user}get userSync(){return this._user}async sign(t){if(!this._privateKey)throw Error("Attempted to sign without a private key");return finalizeEvent(t,this._privateKey).sig}async encryptionEnabled(t){const n=[];return(!t||t==="nip04")&&n.push("nip04"),(!t||t==="nip44")&&n.push("nip44"),n}async encrypt(t,n,r){if(!this._privateKey||!this.privateKey)throw Error("Attempted to encrypt without a private key");const o=t.pubkey;if(r==="nip44"){const c=nip44_exports.v2.utils.getConversationKey(this._privateKey,o);return await nip44_exports.v2.encrypt(n,c)}return await nip04_exports.encrypt(this._privateKey,o,n)}async decrypt(t,n,r){if(!this._privateKey||!this.privateKey)throw Error("Attempted to decrypt without a private key");const o=t.pubkey;if(r==="nip44"){const c=nip44_exports.v2.utils.getConversationKey(this._privateKey,o);return await nip44_exports.v2.decrypt(n,c)}return await nip04_exports.decrypt(this._privateKey,o,n)}toPayload(){if(!this._privateKey)throw new Error("Private key not available");const t={type:"private-key",payload:this.privateKey};return JSON.stringify(t)}static async fromPayload(t,n){const r=JSON.parse(t);if(r.type!=="private-key")throw new Error(`Invalid payload type: expected 'private-key', got ${r.type}`);if(!r.payload||typeof r.payload!="string")throw new Error("Invalid payload content for private-key signer");return new mo(r.payload,n)}};registerSigner("private-key",NDKPrivateKeySigner);function dedup(e,t){return e.created_at>t.created_at?e:t}async function getRelayListForUser(e,t){return(await getRelayListForUsers([e],t)).get(e)}async function getRelayListForUsers(e,t,n=!1,r=1e3,o){const c=t.outboxPool||t.pool,l=new Set;for(const y of c.relays.values())l.add(y);if(o)for(const y of o.values())for(const w of y){const v=c.getRelay(w,!0,!0);v&&l.add(v)}const x=new Map,f=new Map,m=new NDKRelaySet(l,t);if(t.cacheAdapter?.locking&&!n){const y=await t.fetchEvents({kinds:[3,10002],authors:Array.from(new Set(e))},{cacheUsage:"ONLY_CACHE",subId:"ndk-relay-list-fetch"});for(const w of y)w.kind===10002&&x.set(w.pubkey,NDKRelayList.from(w));for(const w of y)if(w.kind===3){if(x.has(w.pubkey))continue;const v=relayListFromKind3(t,w);v&&f.set(w.pubkey,v)}e=e.filter(w=>!x.has(w)&&!f.has(w))}if(e.length===0)return x;const E=new Map,g=new Map;return new Promise(y=>{let w=!1;(async()=>{const _={closeOnEose:!0,pool:c,groupable:!0,subId:"ndk-relay-list-fetch",addSinceFromCache:!0,relaySet:m};m&&(_.relaySet=m),t.subscribe({kinds:[3,10002],authors:e},_,{onEvent:T=>{if(T.kind===10002){const L=E.get(T.pubkey);if(L&&L.created_at>T.created_at)return;E.set(T.pubkey,T)}else if(T.kind===3){const L=g.get(T.pubkey);if(L&&L.created_at>T.created_at)return;g.set(T.pubkey,T)}},onEose:()=>{if(!w){w=!0,t.debug(`[getRelayListForUsers] EOSE - relayListEvents: ${E.size}, contactListEvents: ${g.size}`);for(const T of E.values())x.set(T.pubkey,NDKRelayList.from(T));for(const T of e){if(x.has(T))continue;const L=g.get(T);if(!L)continue;const N=relayListFromKind3(t,L);N&&x.set(T,N)}t.debug(`[getRelayListForUsers] Returning ${x.size} relay lists for ${e.length} pubkeys`),y(x)}}});const F=Array.from(l).some(T=>T.status<=2),H=Array.from(l).some(T=>T.status===4);let Y=r;(F||H)&&(Y=r+3e3),t.debug(`[getRelayListForUsers] Setting fallback timeout to ${Y}ms (disconnected: ${F}, connecting: ${H})`,{pubkeys:e}),setTimeout(()=>{w||(w=!0,t.debug(`[getRelayListForUsers] Timeout reached, returning ${x.size} relay lists`),y(x))},Y)})()})}var OutboxItem=class{type;relayUrlScores;readRelays;writeRelays;constructor(e){this.type=e,this.relayUrlScores=new Map,this.readRelays=new Set,this.writeRelays=new Set}},OutboxTracker=class extends libExports.EventEmitter{data;ndk;debug;constructor(e){super(),this.ndk=e,this.debug=e.debug.extend("outbox-tracker"),this.data=new distExports$2.LRUCache({maxSize:1e5,entryExpirationTimeInMS:120*1e3})}async trackUsers(e,t=!1){const n=[];for(let r=0;r<e.length;r+=400){const o=e.slice(r,r+400),c=o.map(x=>getKeyFromItem(x)).filter(x=>!this.data.has(x));if(c.length===0)continue;for(const x of c)this.data.set(x,new OutboxItem("user"));const l=new Map;for(const x of o)x instanceof NDKUser&&x.relayUrls.length>0&&l.set(x.pubkey,x.relayUrls);n.push(new Promise(x=>{getRelayListForUsers(c,this.ndk,t,1e3,l).then(f=>{this.debug(`Received relay lists for ${f.size} pubkeys out of ${c.length} requested`);for(const[m,E]of f){let g=this.data.get(m);if(g??=new OutboxItem("user"),E){if(g.readRelays=new Set(normalize(E.readRelayUrls)),g.writeRelays=new Set(normalize(E.writeRelayUrls)),this.ndk.relayConnectionFilter){for(const y of g.readRelays)this.ndk.relayConnectionFilter(y)||g.readRelays.delete(y);for(const y of g.writeRelays)this.ndk.relayConnectionFilter(y)||g.writeRelays.delete(y)}this.data.set(m,g),this.emit("user:relay-list-updated",m,g),this.debug(`Adding ${g.readRelays.size} read relays and ${g.writeRelays.size} write relays for ${m}`,E?.rawEvent())}}}).finally(x)}))}return Promise.all(n)}track(e,t,n=!0){const r=getKeyFromItem(e);t??=getTypeFromItem(e);let o=this.data.get(r);return o||(o=new OutboxItem(t),e instanceof NDKUser&&this.trackUsers([e])),o}};function getKeyFromItem(e){return e instanceof NDKUser?e.pubkey:e}function getTypeFromItem(e){return e instanceof NDKUser?"user":"kind"}function correctRelaySet(e,t){const n=t.connectedRelays();if(!Array.from(e.relays).some(o=>n.map(c=>c.url).includes(o.url)))for(const o of n)e.addRelay(o);if(n.length===0)for(const o of t.relays.values())e.addRelay(o);return e}var NDKSubscriptionManager=class{subscriptions;seenEvents=new distExports$2.LRUCache({maxSize:1e4,entryExpirationTimeInMS:300*1e3});constructor(){this.subscriptions=new Map}add(e){this.subscriptions.set(e.internalId,e),e.onStopped,e.onStopped=()=>{this.subscriptions.delete(e.internalId)},e.on("close",()=>{this.subscriptions.delete(e.internalId)})}seenEvent(e,t){const n=this.seenEvents.get(e)||[];n.some(r=>r.url===t.url)||n.push(t),this.seenEvents.set(e,n)}dispatchEvent(e,t,n=!1){t&&this.seenEvent(e.id,t);const r=this.subscriptions.values(),o=[];for(const c of r)matchFilters(c.filters,e)&&o.push(c);for(const c of o){if(c.exclusiveRelay&&c.relaySet){let l=!1;if(n?l=!c.skipOptimisticPublishEvent:t?l=c.relaySet.relays.has(t):l=(this.seenEvents.get(e.id)||[]).some(f=>c.relaySet.relays.has(f)),!l){c.debug.extend("exclusive-relay")("Rejected event %s from %s (relay not in exclusive set)",e.id,t?.url||(n?"optimistic":"cache"));continue}}c.eventReceived(e,t,!1,n)}}},debug6=createDebug5("ndk:active-user");async function getUserRelayList(e){if(!this.autoConnectUserRelays)return;const t=await getRelayListForUser(e.pubkey,this);if(t){for(const n of t.relays){let r=this.pool.relays.get(n);r||(r=new NDKRelay(n,this.relayAuthDefaultPolicy,this),this.pool.addRelay(r))}return debug6("Connected to %d user relays",t.relays.length),t}}async function setActiveUser(e){if(!this.autoConnectUserRelays)return;const t=this.outboxPool||this.pool;t.connectedRelays.length>0?await getUserRelayList.call(this,e):t.once("connect",async()=>{await getUserRelayList.call(this,e)})}function getEntity(e){try{const t=nip19_exports$1.decode(e);return t.type==="npub"?npub(this,t.data):t.type==="nprofile"?nprofile(this,t.data):t}catch{return null}}function npub(e,t){return e.getUser({pubkey:t})}function nprofile(e,t){const n=e.getUser({pubkey:t.pubkey});return t.relays&&(n.relayUrls=t.relays),n}function isValidHint(e){if(!e||e==="")return!1;try{return new URL(e),!0}catch{return!1}}async function fetchEventFromTag(e,t,n,r={type:"timeout"}){const o=this.debug.extend("fetch-event-from-tag"),[c,l,x]=e;n={},o("fetching event from tag",e,n,r);const f=getRelaysForSync(this,t.pubkey);if(f&&f.size>0){o("fetching event from author relays %o",Array.from(f));const _=NDKRelaySet.fromRelayUrls(Array.from(f),this),F=await this.fetchEvent(l,n,_);if(F)return F}else o("no author relays found for %s",t.pubkey,t);const m=calculateRelaySetsFromFilters(this,[{ids:[l]}],this.pool);o("fetching event without relay hint",m);const E=await this.fetchEvent(l,n);if(E)return E;if(x&&x!==""){const _=await this.fetchEvent(l,n,this.pool.getRelay(x,!0,!0,[{ids:[l]}]));if(_)return _}let g;const y=isValidHint(x)?this.pool.getRelay(x,!1,!0,[{ids:[l]}]):void 0,w=new Promise(_=>{this.fetchEvent(l,n,y).then(_)});if(!isValidHint(x)||r.type==="none")return w;const v=new Promise(async _=>{const F=r.relaySet,H=r.timeout??1500,Y=new Promise(T=>setTimeout(T,H));if(r.type==="timeout"&&await Y,g)_(g);else{o("fallback fetch triggered");const T=await this.fetchEvent(l,n,F);_(T)}});switch(r.type){case"timeout":return Promise.race([w,v]);case"eose":return g=await w,g||v}}var Queue=class{queue=[];maxConcurrency;processing=new Set;promises=new Map;constructor(e,t){this.maxConcurrency=t}add(e){if(this.promises.has(e.id))return this.promises.get(e.id);const t=new Promise((n,r)=>{this.queue.push({...e,func:()=>e.func().then(o=>(n(o),o),o=>{throw r(o),o})}),this.process()});return this.promises.set(e.id,t),t.finally(()=>{this.promises.delete(e.id),this.processing.delete(e.id),this.process()}),t}process(){if(this.processing.size>=this.maxConcurrency||this.queue.length===0)return;const e=this.queue.shift();!e||this.processing.has(e.id)||(this.processing.add(e.id),e.func())}clear(){this.queue=[]}clearProcessing(){this.processing.clear()}clearAll(){this.clear(),this.clearProcessing()}length(){return this.queue.length}},DEFAULT_OUTBOX_RELAYS=["wss://purplepag.es/","wss://nos.lol/"],NDK=class extends libExports.EventEmitter{_explicitRelayUrls;pool;outboxPool;_signer;_activeUser;cacheAdapter;debug;devWriteRelaySet;outboxTracker;muteFilter;relayConnectionFilter;clientName;clientNip89;queuesZapConfig;queuesNip05;asyncSigVerification=!1;initialValidationRatio=1;lowestValidationRatio=.1;validationRatioFn;filterValidationMode="validate";subManager;aiGuardrails;_signatureVerificationFunction;_signatureVerificationWorker;signatureVerificationTimeMs=0;publishingFailureHandled=!1;pools=[];relayAuthDefaultPolicy;httpFetch;netDebug;autoConnectUserRelays=!0;_wallet;walletConfig;constructor(e={}){super(),this.debug=e.debug||createDebug5("ndk"),this.netDebug=e.netDebug,this._explicitRelayUrls=e.explicitRelayUrls||[],this.subManager=new NDKSubscriptionManager,this.pool=new NDKPool(e.explicitRelayUrls||[],this),this.pool.name="Main",this.pool.on("relay:auth",async(t,n)=>{this.relayAuthDefaultPolicy&&await this.relayAuthDefaultPolicy(t,n)}),this.autoConnectUserRelays=e.autoConnectUserRelays??!0,this.clientName=e.clientName,this.clientNip89=e.clientNip89,this.relayAuthDefaultPolicy=e.relayAuthDefaultPolicy,e.enableOutboxModel!==!1&&(this.outboxPool=new NDKPool(e.outboxRelayUrls||DEFAULT_OUTBOX_RELAYS,this,{debug:this.debug.extend("outbox-pool"),name:"Outbox Pool"}),this.outboxTracker=new OutboxTracker(this),this.outboxTracker.on("user:relay-list-updated",(t,n)=>{this.debug(`Outbox relay list updated for ${t}`);for(const r of this.subManager.subscriptions.values())r.filters.some(c=>c.authors?.includes(t))&&typeof r.refreshRelayConnections=="function"&&(this.debug(`Refreshing relay connections for subscription ${r.internalId}`),r.refreshRelayConnections())})),this.signer=e.signer,this.cacheAdapter=e.cacheAdapter,this.muteFilter=e.muteFilter,this.relayConnectionFilter=e.relayConnectionFilter,e.devWriteRelayUrls&&(this.devWriteRelaySet=NDKRelaySet.fromRelayUrls(e.devWriteRelayUrls,this)),this.queuesZapConfig=new Queue("zaps",3),this.queuesNip05=new Queue("nip05",10),e.signatureVerificationWorker&&(this.signatureVerificationWorker=e.signatureVerificationWorker),e.signatureVerificationFunction&&(this.signatureVerificationFunction=e.signatureVerificationFunction),this.initialValidationRatio=e.initialValidationRatio||1,this.lowestValidationRatio=e.lowestValidationRatio||.1,this.validationRatioFn=e.validationRatioFn||this.defaultValidationRatioFn,this.filterValidationMode=e.filterValidationMode||"validate",this.aiGuardrails=new AIGuardrails(e.aiGuardrails||!1),this.aiGuardrails.ndkInstantiated(this);try{this.httpFetch=fetch}catch{}}set explicitRelayUrls(e){this._explicitRelayUrls=e.map(normalizeRelayUrl),this.pool.relayUrls=e}get explicitRelayUrls(){return this._explicitRelayUrls||[]}set signatureVerificationWorker(e){this._signatureVerificationWorker=e,e?(signatureVerificationInit(e),this.asyncSigVerification=!0):this.asyncSigVerification=!1}set signatureVerificationFunction(e){this._signatureVerificationFunction=e,this.asyncSigVerification=!!e}get signatureVerificationFunction(){return this._signatureVerificationFunction}addExplicitRelay(e,t,n=!0){let r;return typeof e=="string"?r=new NDKRelay(e,t,this):r=e,this.pool.addRelay(r,n),this.explicitRelayUrls?.push(r.url),r}toJSON(){return{relayCount:this.pool.relays.size}.toString()}get activeUser(){return this._activeUser}set activeUser(e){const t=this._activeUser?.pubkey!==e?.pubkey;this._activeUser=e,t&&this.emit("activeUser:change",e),e&&t&&setActiveUser.call(this,e)}get signer(){return this._signer}set signer(e){this._signer=e,e&&this.emit("signer:ready",e),e?.user().then(t=>{t.ndk=this,this.activeUser=t})}async connect(e){this._signer&&this.autoConnectUserRelays&&(this.debug("Attempting to connect to user relays specified by signer %o",await this._signer.relays?.(this)),this._signer.relays&&(await this._signer.relays(this)).forEach(r=>this.pool.addRelay(r)));const t=[this.pool.connect(e)];return this.outboxPool&&t.push(this.outboxPool.connect(e)),this.cacheAdapter?.initializeAsync&&t.push(this.cacheAdapter.initializeAsync(this)),Promise.allSettled(t).then(()=>{})}reportInvalidSignature(e,t){this.debug(`Invalid signature detected for event ${e.id}${t?` from relay ${t.url}`:""}`),this.emit("event:invalid-sig",e,t)}defaultValidationRatioFn(e,t,n){if(t<10)return this.initialValidationRatio;const r=Math.min(t/100,1),o=this.initialValidationRatio*(1-r)+this.lowestValidationRatio*r;return Math.max(o,this.lowestValidationRatio)}getUser(e){if(typeof e=="string")if(e.startsWith("npub1")){const{type:n,data:r}=nip19_exports$1.decode(e);if(n!=="npub")throw new Error(`Invalid npub: ${e}`);return this.getUser({pubkey:r})}else if(e.startsWith("nprofile1")){const{type:n,data:r}=nip19_exports$1.decode(e);if(n!=="nprofile")throw new Error(`Invalid nprofile: ${e}`);return this.getUser({pubkey:r.pubkey,relayUrls:r.relays})}else return this.getUser({pubkey:e});const t=new NDKUser(e);return t.ndk=this,t}async getUserFromNip05(e,t=!1){return NDKUser.fromNip05(e,this,t)}async fetchUser(e,t=!1){if(isValidNip05(e))return NDKUser.fromNip05(e,this,t);if(e.startsWith("npub1")){const{type:n,data:r}=nip19_exports$1.decode(e);if(n!=="npub")throw new Error(`Invalid npub: ${e}`);const o=new NDKUser({pubkey:r});return o.ndk=this,o}else if(e.startsWith("nprofile1")){const{type:n,data:r}=nip19_exports$1.decode(e);if(n!=="nprofile")throw new Error(`Invalid nprofile: ${e}`);const o=new NDKUser({pubkey:r.pubkey,relayUrls:r.relays});return o.ndk=this,o}else{const n=new NDKUser({pubkey:e});return n.ndk=this,n}}subscribe(e,t,n=!0,r=!0){let o=t?.relaySet,c=r;n instanceof NDKRelaySet?(console.warn("relaySet is deprecated, use opts.relaySet instead. This will be removed in version v2.14.0"),o=n,c=r):(typeof n=="boolean"||typeof n=="object")&&(c=n);let l;const x={relaySet:o,...t};c&&typeof c=="object"&&(c.onEvent&&(x.onEvent=c.onEvent),c.onEose&&(x.onEose=c.onEose),c.onClose&&(x.onClose=c.onClose),c.onEvents&&(l=c.onEvents));const f=new NDKSubscription(this,e,x);this.subManager.add(f),this.aiGuardrails?.subscription?.created(Array.isArray(e)?e:[e],x);const m=f.pool;if(f.relaySet)for(const E of f.relaySet.relays)m.useTemporaryRelay(E,void 0,f.filters);if(this.outboxPool&&f.hasAuthorsFilter()){const E=f.filters.filter(g=>g.authors&&g.authors?.length>0).flatMap(g=>g.authors);this.outboxTracker?.trackUsers(E)}return c&&setTimeout(async()=>{this.cacheAdapter?.initializeAsync&&!this.cacheAdapter.ready&&await this.cacheAdapter.initializeAsync(this);const E=f.start(!l);E&&E.length>0&&l&&l(E)},0),f}fetchEventFromTag=fetchEventFromTag.bind(this);fetchEventSync(e){if(!this.cacheAdapter)throw new Error("Cache adapter not set");let t;typeof e=="string"?t=[filterFromId(e)]:t=e;const n=new NDKSubscription(this,t),r=this.cacheAdapter.query(n);if(r instanceof Promise)throw new Error("Cache adapter is async");return r.map(o=>(o.ndk=this,o))}async fetchEvent(e,t,n){let r,o;if(n instanceof NDKRelay?o=new NDKRelaySet(new Set([n]),this):n instanceof NDKRelaySet&&(o=n),!n&&typeof e=="string"&&!isNip33AValue(e)){const c=relaysFromBech32(e,this);c.length>0&&(o=new NDKRelaySet(new Set(c),this),o=correctRelaySet(o,this.pool))}if(typeof e=="string"?r=[filterFromId(e)]:Array.isArray(e)?r=e:r=[e],typeof e!="string"&&this.aiGuardrails?.ndk?.fetchingEvents(r),r.length===0)throw new Error(`Invalid filter: ${JSON.stringify(e)}`);return new Promise((c,l)=>{let x=null;const f={...t||{},closeOnEose:!0};o&&(f.relaySet=o);const m=setTimeout(()=>{E.stop(),this.aiGuardrails._nextCallDisabled=null,c(x)},1e4),E=this.subscribe(r,f,{onEvent:g=>{g.ndk=this,g.isReplaceable()?(!x||x.created_at<g.created_at)&&(x=g):(clearTimeout(m),this.aiGuardrails._nextCallDisabled=null,c(g))},onEose:()=>{clearTimeout(m),this.aiGuardrails._nextCallDisabled=null,c(x)}})})}async fetchEvents(e,t,n){return this.aiGuardrails?.ndk?.fetchingEvents(e,t),new Promise(r=>{const o=new Map,c={...t||{},closeOnEose:!0};n&&(c.relaySet=n);const l=x=>{let f;x instanceof NDKEvent?f=x:f=new NDKEvent(void 0,x);const m=f.deduplicationKey(),E=o.get(m);E&&(f=dedup(E,f)),f.ndk=this,o.set(m,f)};this.subscribe(e,{...c,onEvent:l,onEose:()=>{this.aiGuardrails._nextCallDisabled=null,r(new Set(o.values()))}})})}assertSigner(){if(!this.signer)throw this.emit("signer:required"),new Error("Signer required")}getEntity=getEntity.bind(this);guardrailOff(e){return e?typeof e=="string"?this.aiGuardrails._nextCallDisabled=new Set([e]):this.aiGuardrails._nextCallDisabled=new Set(e):this.aiGuardrails._nextCallDisabled="all",this}set wallet(e){if(!e){this._wallet=void 0,this.walletConfig=void 0;return}this._wallet=e,this.walletConfig??={},this.walletConfig.lnPay=e?.lnPay?.bind(e),this.walletConfig.cashuPay=e?.cashuPay?.bind(e)}get wallet(){return this._wallet}},nip19_exports={};__reExport(nip19_exports,nip19_star);var nip49_exports={};__reExport(nip49_exports,nip49_star);function disconnect(e,t){return t??=createDebug5("ndk:relay:auth-policies:disconnect"),async n=>{t?.(`Relay ${n.url} requested authentication, disconnecting`),e.removeRelay(n.url)}}async function signAndAuth(e,t,n,r,o,c){try{await e.sign(n),o(e)}catch(l){r?.(`Failed to publish auth event to relay ${t.url}`,l),c(e)}}function signIn({ndk:e,signer:t,debug:n}={}){return n??=createDebug5("ndk:auth-policies:signIn"),async(r,o)=>{n?.(`Relay ${r.url} requested authentication, signing in`);const c=new NDKEvent(e);return c.kind=22242,c.tags=[["relay",r.url],["challenge",o]],t??=e?.signer,new Promise(async(l,x)=>{t?await signAndAuth(c,r,t,n,l,x):e?.once("signer:ready",async f=>{await signAndAuth(c,r,f,n,l,x)})})}}var NDKRelayAuthPolicies={disconnect,signIn};async function ndkSignerFromPayload(e,t){let n;try{n=JSON.parse(e)}catch(o){console.error("Failed to parse signer payload string",e,o);return}if(!n||typeof n.type!="string"){console.error("Failed to parse signer payload string",e,new Error("Missing type field"));return}const r=signerRegistry.get(n.type);if(!r)throw new Error(`Unknown signer type: ${n.type}`);try{return await r.fromPayload(e,t)}catch(o){const c=o instanceof Error?o.message:String(o);throw new Error(`Failed to deserialize signer type ${n.type}: ${c}`)}}var NDKNip07Signer=class ad{_userPromise;encryptionQueue=[];encryptionProcessing=!1;debug;waitTimeout;_pubkey;ndk;_user;constructor(t=1e3,n){this.debug=createDebug5("ndk:nip07"),this.waitTimeout=t,this.ndk=n}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}async blockUntilReady(){await this.waitForExtension();const t=await window.nostr?.getPublicKey();if(!t)throw new Error("User rejected access");this._pubkey=t;let n;return this.ndk?n=this.ndk.getUser({pubkey:t}):n=new NDKUser({pubkey:t}),this._user=n,n}async user(){return this._userPromise||(this._userPromise=this.blockUntilReady()),this._userPromise}get userSync(){if(!this._user)throw new Error("User not ready");return this._user}async sign(t){await this.waitForExtension();const n=await window.nostr?.signEvent(t);if(!n)throw new Error("Failed to sign event");return n.sig}async relays(t){await this.waitForExtension();const n=await window.nostr?.getRelays?.()||{},r=[];for(const o of Object.keys(n))n[o].read&&n[o].write&&r.push(o);return r.map(o=>new NDKRelay(o,t?.relayAuthDefaultPolicy,t))}async encryptionEnabled(t){const n=[];return(!t||t==="nip04")&&window.nostr?.nip04&&n.push("nip04"),(!t||t==="nip44")&&window.nostr?.nip44&&n.push("nip44"),n}async encrypt(t,n,r="nip04"){if(!await this.encryptionEnabled(r))throw new Error(`${r}encryption is not available from your browser extension`);await this.waitForExtension();const o=t.pubkey;return this.queueEncryption(r,"encrypt",o,n)}async decrypt(t,n,r="nip04"){if(!await this.encryptionEnabled(r))throw new Error(`${r}encryption is not available from your browser extension`);await this.waitForExtension();const o=t.pubkey;return this.queueEncryption(r,"decrypt",o,n)}async queueEncryption(t,n,r,o){return new Promise((c,l)=>{this.encryptionQueue.push({scheme:t,method:n,counterpartyHexpubkey:r,value:o,resolve:c,reject:l}),this.encryptionProcessing||this.processEncryptionQueue()})}async processEncryptionQueue(t,n=0){if(!t&&this.encryptionQueue.length===0){this.encryptionProcessing=!1;return}this.encryptionProcessing=!0;const r=t||this.encryptionQueue.shift();if(!r){this.encryptionProcessing=!1;return}const{scheme:o,method:c,counterpartyHexpubkey:l,value:x,resolve:f,reject:m}=r;this.debug("Processing encryption queue item",{method:c,counterpartyHexpubkey:l,value:x});try{const E=await window.nostr?.[o]?.[c](l,x);if(!E)throw new Error("Failed to encrypt/decrypt");f(E)}catch(E){const g=E instanceof Error?E.message:String(E);if(g.includes("call already executing")&&n<5){this.debug("Retrying encryption queue item",{method:c,counterpartyHexpubkey:l,value:x,retries:n}),setTimeout(()=>{this.processEncryptionQueue(r,n+1)},50*n);return}m(E instanceof Error?E:new Error(g))}this.processEncryptionQueue()}waitForExtension(){return new Promise((t,n)=>{if(window.nostr){t();return}let r;const o=setInterval(()=>{window.nostr&&(clearTimeout(r),clearInterval(o),t())},100);r=setTimeout(()=>{clearInterval(o),n(new Error("NIP-07 extension not available"))},this.waitTimeout)})}toPayload(){return JSON.stringify({type:"nip07",payload:""})}static async fromPayload(t,n){const r=JSON.parse(t);if(r.type!=="nip07")throw new Error(`Invalid payload type: expected 'nip07', got ${r.type}`);return new ad(void 0,n)}};registerSigner("nip07",NDKNip07Signer);var NDKNostrRpc=class extends libExports.EventEmitter{ndk;signer;relaySet;debug;encryptionType="nip04";pool;constructor(e,t,n,r){if(super(),this.ndk=e,this.signer=t,r){this.pool=new NDKPool(r,e,{debug:n.extend("rpc-pool"),name:"Nostr RPC"}),this.relaySet=new NDKRelaySet(new Set,e,this.pool);for(const o of r){const c=this.pool.getRelay(o,!1,!1);c.authPolicy=NDKRelayAuthPolicies.signIn({ndk:e,signer:t,debug:n}),this.relaySet.addRelay(c),c.connect()}}this.debug=n.extend("rpc")}subscribe(e){return new Promise(t=>{const n=this.ndk.subscribe(e,{closeOnEose:!1,groupable:!1,cacheUsage:"ONLY_RELAY",pool:this.pool,relaySet:this.relaySet,onEvent:async r=>{try{const o=await this.parseEvent(r);o.method?this.emit("request",o):(this.emit(`response-${o.id}`,o),this.emit("response",o))}catch(o){this.debug("error parsing event",o,r.rawEvent())}},onEose:()=>{this.debug("eosed"),t(n)}})})}async parseEvent(e){this.encryptionType==="nip44"&&e.content.includes("?iv=")?this.encryptionType="nip04":this.encryptionType==="nip04"&&!e.content.includes("?iv=")&&(this.encryptionType="nip44");const t=this.ndk.getUser({pubkey:e.pubkey});t.ndk=this.ndk;let n;try{n=await this.signer.decrypt(t,e.content,this.encryptionType)}catch{const E=this.encryptionType==="nip04"?"nip44":"nip04";n=await this.signer.decrypt(t,e.content,E),this.encryptionType=E}const r=JSON.parse(n),{id:o,method:c,params:l,result:x,error:f}=r;return c?{id:o,pubkey:e.pubkey,method:c,params:l,event:e}:{id:o,result:x,error:f,event:e}}async sendResponse(e,t,n,r=24133,o){const c={id:e,result:n};o&&(c.error=o);const l=await this.signer.user(),x=this.ndk.getUser({pubkey:t}),f=new NDKEvent(this.ndk,{kind:r,content:JSON.stringify(c),tags:[["p",t]],pubkey:l.pubkey});f.content=await this.signer.encrypt(x,f.content,this.encryptionType),await f.sign(this.signer),await f.publish(this.relaySet)}async sendRequest(e,t,n=[],r=24133,o){const c=Math.random().toString(36).substring(7),l=await this.signer.user(),x=this.ndk.getUser({pubkey:e}),f={id:c,method:t,params:n},m=new Promise(()=>{const g=y=>{y.result==="auth_url"?(this.once(`response-${c}`,g),this.emit("authUrl",y.error)):o&&o(y)};this.once(`response-${c}`,g)}),E=new NDKEvent(this.ndk,{kind:r,content:JSON.stringify(f),tags:[["p",e]],pubkey:l.pubkey});return E.content=await this.signer.encrypt(x,E.content,this.encryptionType),await E.sign(this.signer),await E.publish(this.relaySet),m}};function nostrConnectGenerateSecret(){return Math.random().toString(36).substring(2,15)}function generateNostrConnectUri(e,t,n,r){const o={name:r?.name?encodeURIComponent(r.name):"",url:r?.url?encodeURIComponent(r.url):"",image:r?.image?encodeURIComponent(r.image):"",perms:r?.perms?encodeURIComponent(r.perms):""};let c=`nostrconnect://${e}?image=${o.image}&url=${o.url}&name=${o.name}&perms=${o.perms}&secret=${encodeURIComponent(t)}`;return n&&(c+=`&relay=${encodeURIComponent(n)}`),c}var NDKNip46Signer=class Eo extends libExports.EventEmitter{ndk;_user;bunkerPubkey;userPubkey;get pubkey(){if(!this.userPubkey)throw new Error("Not ready");return this.userPubkey}secret;localSigner;nip05;rpc;debug;relayUrls;subscription;nostrConnectUri;nostrConnectSecret;constructor(t,n,r,o,c){super(),this.ndk=t,this.debug=t.debug.extend("nip46:signer"),this.relayUrls=o,r?typeof r=="string"?this.localSigner=new NDKPrivateKeySigner(r):this.localSigner=r:this.localSigner=NDKPrivateKeySigner.generate(),n===!1||(n?n.startsWith("bunker://")?this.bunkerFlowInit(n):this.nip05Init(n):this.nostrconnectFlowInit(c)),this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls)}static bunker(t,n,r){return new Eo(t,n,r)}static nostrconnect(t,n,r,o){return new Eo(t,void 0,r,[n],o)}nostrconnectFlowInit(t){this.nostrConnectSecret=nostrConnectGenerateSecret();const n=this.localSigner.pubkey;this.nostrConnectUri=generateNostrConnectUri(n,this.nostrConnectSecret,this.relayUrls?.[0],t)}bunkerFlowInit(t){const n=new URL(t),r=n.hostname||n.pathname.replace(/^\/\//,""),o=n.searchParams.get("pubkey"),c=n.searchParams.getAll("relay"),l=n.searchParams.get("secret");this.bunkerPubkey=r,this.userPubkey=o,this.relayUrls=c,this.secret=l}nip05Init(t){this.nip05=t}async startListening(){if(this.subscription)return;const t=await this.localSigner.user();if(!t)throw new Error("Local signer not ready");this.subscription=await this.rpc.subscribe({kinds:[24133],"#p":[t.pubkey]})}async user(){return this._user?this._user:this.blockUntilReady()}get userSync(){if(!this._user)throw new Error("Remote user not ready synchronously");return this._user}async blockUntilReadyNostrConnect(){return new Promise((t,n)=>{const r=o=>{o.result===this.nostrConnectSecret&&(this._user=o.event.author,this.userPubkey=o.event.pubkey,this.bunkerPubkey=o.event.pubkey,this.rpc.off("response",r),t(this._user))};this.startListening(),this.rpc.on("response",r)})}async blockUntilReady(){if(!this.bunkerPubkey&&!this.nostrConnectSecret&&!this.nip05)throw new Error("Bunker pubkey not set");if(this.nostrConnectSecret)return this.blockUntilReadyNostrConnect();if(this.nip05&&!this.userPubkey){const t=await NDKUser.fromNip05(this.nip05,this.ndk);t&&(this._user=t,this.userPubkey=t.pubkey,this.relayUrls=t.nip46Urls,this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls))}if(!this.bunkerPubkey&&this.userPubkey)this.bunkerPubkey=this.userPubkey;else if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");return await this.startListening(),this.rpc.on("authUrl",(...t)=>{this.emit("authUrl",...t)}),new Promise((t,n)=>{const r=[this.userPubkey??""];if(this.secret&&r.push(this.secret),!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"connect",r,24133,o=>{o.result==="ack"?this.getPublicKey().then(c=>{this.userPubkey=c,this._user=this.ndk.getUser({pubkey:c}),t(this._user)}):n(o.error)})})}stop(){this.subscription?.stop(),this.subscription=void 0}async getPublicKey(){return this.userPubkey?this.userPubkey:new Promise((t,n)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"get_public_key",[],24133,r=>{t(r.result)})})}async encryptionEnabled(t){return t?[t]:Promise.resolve(["nip04","nip44"])}async encrypt(t,n,r="nip04"){return this.encryption(t,n,r,"encrypt")}async decrypt(t,n,r="nip04"){return this.encryption(t,n,r,"decrypt")}async encryption(t,n,r,o){return new Promise((l,x)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,`${r}_${o}`,[t.pubkey,n],24133,f=>{f.error?x(f.error):l(f.result)})})}async sign(t){return new Promise((r,o)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"sign_event",[JSON.stringify(t)],24133,c=>{if(c.error)o(c.error);else{const l=JSON.parse(c.result);r(l.sig)}})})}async createAccount(t,n,r){await this.startListening();const o=[];return t&&o.push(t),n&&o.push(n),r&&o.push(r),new Promise((c,l)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"create_account",o,24133,x=>{if(x.error)l(x.error);else{const f=x.result;c(f)}})})}toPayload(){if(!this.bunkerPubkey||!this.userPubkey)throw new Error("NIP-46 signer is not fully initialized for serialization");const t={type:"nip46",payload:{bunkerPubkey:this.bunkerPubkey,userPubkey:this.userPubkey,relayUrls:this.relayUrls,secret:this.secret,localSignerPayload:this.localSigner.toPayload(),nip05:this.nip05||null}};return JSON.stringify(t)}static async fromPayload(t,n){if(!n)throw new Error("NDK instance is required to deserialize NIP-46 signer");const r=JSON.parse(t);if(r.type!=="nip46")throw new Error(`Invalid payload type: expected 'nip46', got ${r.type}`);const o=r.payload;if(!o||typeof o!="object"||!o.localSignerPayload)throw new Error("Invalid payload content for nip46 signer");const c=await ndkSignerFromPayload(o.localSignerPayload,n);if(!c)throw new Error("Failed to deserialize local signer for NIP-46");if(!(c instanceof NDKPrivateKeySigner))throw new Error("Local signer must be an instance of NDKPrivateKeySigner");let l;return l=new Eo(n,!1,c,o.relayUrls),l.userPubkey=o.userPubkey,l.bunkerPubkey=o.bunkerPubkey,l.relayUrls=o.relayUrls,l.secret=o.secret,o.userPubkey&&(l._user=new NDKUser({pubkey:o.userPubkey}),l._user&&(l._user.ndk=n)),l}};registerSigner("nip46",NDKNip46Signer);createDebug5("ndk:zapper:ln");createDebug5("ndk:zapper");const DEFAULT_RELAYS=[{url:"wss://relay.primal.net",status:"disconnected",failedAttempts:0},{url:"wss://relay.damus.io",status:"disconnected",failedAttempts:0},{url:"wss://nos.lol",status:"disconnected",failedAttempts:0}],useRelayStore=create()(persist((e,t)=>({relays:DEFAULT_RELAYS,addRelay:n=>{const r=n.trim();if(!r.startsWith("wss://")&&!r.startsWith("ws://")){console.error("[RelayStore] Invalid relay URL:",n);return}if(t().relays.find(c=>c.url===r)){console.warn("[RelayStore] Relay already exists:",r);return}e(c=>({relays:[...c.relays,{url:r,status:"disconnected",failedAttempts:0}]}))},removeRelay:n=>{e(r=>({relays:r.relays.filter(o=>o.url!==n)}))},updateRelayStatus:(n,r)=>{e(o=>({relays:o.relays.map(c=>c.url===n?{...c,status:r,lastConnected:r==="connected"?Date.now():c.lastConnected}:c)}))},incrementFailedAttempts:n=>{e(r=>({relays:r.relays.map(o=>o.url===n?{...o,failedAttempts:o.failedAttempts+1}:o)}))},resetFailedAttempts:n=>{e(r=>({relays:r.relays.map(o=>o.url===n?{...o,failedAttempts:0}:o)}))},getRelay:n=>t().relays.find(r=>r.url===n),isOnline:()=>t().relays.some(n=>n.status==="connected")}),{name:"amber-relays",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-DZK393HN.js");return{storage:n}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:n}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-DZK393HN.js");return{storage:r}},[],import.meta.url);return n.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-DZK393HN.js");return{storage:n}},[],import.meta.url);return t.removeItem(e)}}))})),hexToBytes$1=e=>{const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.substr(n*2,2),16);return t};class SignerService{ndk;signer;privateKey;sub;constructor(t){this.privateKey=t,this.signer=new NDKPrivateKeySigner(t);const n=useRelayStore.getState().relays.map(r=>r.url);this.ndk=new NDK({explicitRelayUrls:n.length>0?n:["wss://relay.primal.net","wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band"]}),this.ndk.signer=this.signer}async connect(){console.log("[SignerService] Attempting to connect to relays...");const t=useRelayStore.getState().relays.map(n=>n.url);t.forEach(n=>{useRelayStore.getState().updateRelayStatus(n,"connecting")});try{await Promise.race([this.ndk.connect(),new Promise((r,o)=>setTimeout(()=>o(new Error("Connection timeout")),2e4))]),console.log("[SignerService] NDK connected successfully!"),t.forEach(r=>{useRelayStore.getState().updateRelayStatus(r,"connected"),useRelayStore.getState().resetFailedAttempts(r)});const n=await this.signer.user();console.log("[SignerService] Listening for NIP-46 requests to:",n.pubkey),this.sub=this.ndk.subscribe({kinds:[24133],"#p":[n.pubkey],since:Math.floor(Date.now()/1e3)},{closeOnEose:!1}),this.sub.on("event",async r=>{console.log("[SignerService] Received NIP-46 event:",r);try{let o;try{console.log("[SignerService] Trying NIP-44 decryption...");const m=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),r.pubkey);o=nip44_exports.v2.decrypt(r.content,m),console.log("[SignerService] NIP-44 decryption successful!")}catch(m){console.log("[SignerService] NIP-46 failed, trying NIP-04...",m),o=await nip04_exports.decrypt(this.privateKey,r.pubkey,r.content),console.log("[SignerService] NIP-04 decryption successful!")}console.log("[SignerService] Decrypted content:",o);const c=JSON.parse(o),{id:l,method:x,params:f}=c;if(console.log("[SignerService] Parsed request:",{id:l,method:x,params:f}),x!=="connect"){const E=useConnectionsStore.getState().connections.find(g=>g.signerPubkey===r.pubkey);if(!E){console.warn(`[SignerService]  Ignoring ${x} request from unknown app: ${r.pubkey}`);return}if(E.status==="connected"){console.log(`[SignerService]  Skipping ${x} - ClientService is handling this connection (status: ${E.status})`);return}}if(x==="sign_event")try{const m=f[0],g=JSON.parse(m).kind,y=useConnectionsStore.getState(),w=y.connections.find(v=>v.signerPubkey===r.pubkey);if(w&&y.getRulesForConnection(w.id).find(F=>F.kinds.includes(g))){console.log(`[SignerService] Auto-approving kind ${g} for ${w.name||"app"}`),await this.approveRequest(l,r.id,r.pubkey,x,f);return}}catch(m){console.error("[SignerService] Error checking auto-approval:",m)}useRequestStore.getState().addRequest({id:l,requestEventId:r.id,requestorPubkey:r.pubkey,method:x,params:f,timestamp:r.created_at||Date.now()/1e3})}catch(o){console.error("Failed to parse NIP-46 request",o)}})}catch(n){throw console.error("[SignerService] Connection failed:",n),t.forEach(r=>{useRelayStore.getState().updateRelayStatus(r,"error"),useRelayStore.getState().incrementFailedAttempts(r)}),n}}async approveRequest(t,n,r,o,c){try{let l=null;switch(o){case"connect":l="ack";break;case"get_public_key":l=(await this.signer.user()).pubkey;break;case"sign_event":const y=c[0],w=new NDKEvent(this.ndk,JSON.parse(y));await w.sign(this.signer),l=JSON.stringify(w.rawEvent());break;case"nip04_decrypt":const v=c[0],_=c[1];l=await nip04_exports.decrypt(this.privateKey,v,_);break;case"nip04_encrypt":const F=c[0],H=c[1];l=await nip04_exports.encrypt(this.privateKey,F,H);break;default:throw new Error(`Unknown method: ${o}`)}const x=JSON.stringify({id:t,result:l,error:null}),f=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),r),m=nip44_exports.v2.encrypt(x,f),E=new NDKEvent(this.ndk);E.kind=24133,E.tags=[["p",r],["e",n]],E.content=m,await E.sign(this.signer),console.log("[SignerService]  About to publish response for:",o),console.log("[SignerService]  Response triggered from:",new Error().stack?.split(`
`)[2]?.trim()),await E.publish(),console.log("[SignerService] Sent encrypted response for:",o),useRequestStore.getState().removeRequest(t)}catch(l){console.error("Error approving request:",l),this.rejectRequest(t,n,r,l.message)}}async rejectRequest(t,n,r,o="User rejected"){const c=JSON.stringify({id:t,result:null,error:o}),l=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),r),x=nip44_exports.v2.encrypt(c,l),f=new NDKEvent(this.ndk);f.kind=24133,f.tags=[["p",r],["e",n]],f.content=x,await f.sign(this.signer),await f.publish(),console.log("[SignerService] Sent encrypted rejection"),useRequestStore.getState().removeRequest(t)}async getBunkerURI(){return`bunker://${(await this.signer.user()).pubkey}?relay=wss://relay.damus.io`}disconnect(){this.sub&&this.sub.stop()}}const RequestModal=({request:e,onApprove:t,onReject:n})=>{const[r,o]=reactExports.useState(!1),[c,l]=reactExports.useState(!1);React.useEffect(()=>{o(!1),l(!1)},[e.id]),console.log("[RequestModal] Rendering with request:",e.method,"id:",e.id,"source:",e.source);const x=m=>{o(!0),t(m)},f=()=>{l(!0),n()};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-amber-500/10 rounded-full",children:jsxRuntimeExports.jsx(ShieldAlert,{className:"w-6 h-6 text-amber-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Signing Request"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-slate-400",children:["from ",e.requestorPubkey.slice(0,8),"..."]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 mb-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Method"}),jsxRuntimeExports.jsx("p",{className:"text-amber-400 font-mono",children:e.method})]}),e.method==="sign_event"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Content"}),jsxRuntimeExports.jsx("pre",{className:"text-xs text-slate-300 overflow-auto max-h-32 mt-1 p-2 bg-slate-900 rounded",children:JSON.stringify(JSON.parse(e.params[0]),null,2)})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:f,disabled:r||c,className:"w-full bg-slate-800 hover:bg-slate-700 disabled:bg-slate-700 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:c?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Rejecting..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(X,{className:"w-4 h-4"}),"Reject"]})}),e.method==="sign_event"&&jsxRuntimeExports.jsx("button",{onClick:()=>x(!0),disabled:r||c,className:"w-full bg-amber-600 hover:bg-amber-700 disabled:bg-amber-700 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:r?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Approving..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),"Auto-Approve Kind ",JSON.parse(e.params[0]).kind]})}),(e.method==="nip04_decrypt"||e.method==="nip04_encrypt")&&jsxRuntimeExports.jsx("button",{onClick:()=>x(!0),disabled:r||c,className:"w-full bg-amber-600 hover:bg-amber-700 disabled:bg-amber-700 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:r?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Approving..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),"Auto-Approve ",e.method==="nip04_decrypt"?"Decryption":"Encryption"]})}),jsxRuntimeExports.jsx("button",{onClick:()=>x(!1),disabled:r||c,className:"w-full bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:r?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Approving..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),"Approve Once"]})})]})]})})},hexToBytes=e=>{const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.substr(n*2,2),16);return t};class ClientService{ndk;signer;privateKey;sub;connectionId;signerPubkey;secret;constructor(t,n,r){this.privateKey=t,this.connectionId=n,this.signerPubkey=r.signerPubkey,this.secret=r.secret,this.signer=new NDKPrivateKeySigner(t),this.ndk=new NDK({explicitRelayUrls:r.relays}),this.ndk.signer=this.signer}static parseNostrConnectURI(t){try{const n=new URL(t),r=n.hostname||n.pathname.replace("//",""),o=n.searchParams.getAll("relay").map(decodeURIComponent),c=n.searchParams.get("secret")||void 0,l=n.searchParams.get("name")||void 0,x=n.searchParams.get("url")?decodeURIComponent(n.searchParams.get("url")):void 0;if(!r||o.length===0)throw new Error("Invalid nostrconnect URI: missing pubkey or relays");return{signerPubkey:r,relays:o,secret:c,name:l,appUrl:x}}catch(n){throw new Error(`Failed to parse nostrconnect URI: ${n}`)}}async connect(){console.log("[ClientService] Connecting as signer for app..."),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connecting");try{await Promise.race([this.ndk.connect(),new Promise((r,o)=>setTimeout(()=>o(new Error("Connection timeout")),2e4))]);const t=await this.signer.user();console.log("[ClientService] Connected! Our pubkey:",t.pubkey),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connected");const n={kinds:[24133],"#p":[t.pubkey],since:Math.floor(Date.now()/1e3)};if(console.log("[ClientService] Subscription filter:",JSON.stringify(n)),this.sub=this.ndk.subscribe(n,{closeOnEose:!1}),console.log("[ClientService] Listening for requests from:",this.signerPubkey),console.log("[ClientService] Our pubkey (receiving events tagged with):",t.pubkey),this.secret){console.log("[ClientService] Sending proactive connect RESPONSE with secret:",this.secret);try{const r=JSON.stringify({id:"connect_"+Math.random().toString(36).substring(7),result:this.secret,error:null}),o=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),this.signerPubkey),c=nip44_exports.v2.encrypt(r,o),l=new NDKEvent(this.ndk);l.kind=24133,l.tags=[["p",this.signerPubkey]],l.content=c,await l.sign(this.signer);const x=await l.publish();console.log("[ClientService]  Proactive connect RESPONSE sent to:",Array.from(x).map(f=>f.url))}catch(r){console.error("[ClientService] Failed to send proactive connect RESPONSE:",r)}}this.sub.on("event",async r=>{console.log("[ClientService]  EVENT RECEIVED!"),console.log("[ClientService] Event from:",r.pubkey),console.log("[ClientService] Event kind:",r.kind),console.log("[ClientService] Event tags:",r.tags),console.log("[ClientService] Event content (encrypted):",r.content.substring(0,50)+"..."),console.log("[ClientService] Event created_at:",r.created_at,"Current time:",Math.floor(Date.now()/1e3));const o=r.created_at||0,c=Math.floor(Date.now()/1e3);if(c-o>60){console.log(`[ClientService]  Ignoring stale event from ${c-o}s ago`);return}const l=r.pubkey===this.signerPubkey;l||console.warn(`[ClientService] Event from unknown pubkey: ${r.pubkey} (expected ${this.signerPubkey}). Attempting to decrypt and verify...`);try{let x,f="nip44";try{const w=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),r.pubkey);x=nip44_exports.v2.decrypt(r.content,w),console.log("[ClientService]  Decrypted with NIP-44")}catch{x=await nip04_exports.decrypt(this.privateKey,r.pubkey,r.content),f="nip04",console.log("[ClientService]  Decrypted with NIP-04")}const m=JSON.parse(x),{id:E,method:g,params:y}=m;if(!l)if(console.log(`[ClientService]  Request from different pubkey: method=${g}, params=${JSON.stringify(y?.slice(0,1))}`),g==="connect"&&y[0]===this.secret){console.log("[ClientService]  Key rotation detected! Updating signer pubkey to:",r.pubkey),this.signerPubkey=r.pubkey;const{updateConnection:w}=useConnectionsStore.getState();w(this.connectionId,{signerPubkey:r.pubkey})}else console.warn(`[ClientService]  Accepting request from alternate pubkey (method: ${g})`);if(console.log(`[ClientService]  Processing request: method=${g}, id=${E}, from=${l?"expected key":"alternate key"}`),g==="connect"||g==="get_public_key"||g==="ping"){console.log(`[ClientService] Auto-approving ${g} request`),await this.approveRequest(E,r.id,r.pubkey,g,y||[],f);return}if(g==="sign_event")try{const w=y[0],_=JSON.parse(w).kind;console.log("[ClientService] Checking auto-approval for kind:",_),console.log("[ClientService] Connection ID:",this.connectionId);const F=useConnectionsStore.getState(),H=F.connections.find(Y=>Y.id===this.connectionId);if(console.log("[ClientService] Found connection:",H?{id:H.id,name:H.name}:"NOT FOUND"),H){const Y=F.getRulesForConnection(H.id);console.log("[ClientService] Rules for this connection:",Y);const T=Y.find(L=>L.kinds.includes(_));if(console.log("[ClientService] Matching rule:",T),T){console.log(`[ClientService]  Auto-approving kind ${_} for ${H.name||"app"}`),await this.approveRequest(E,r.id,r.pubkey,g,y,f);return}else console.log("[ClientService]  No matching rule found, showing modal")}else console.log("[ClientService]  Connection not found in store")}catch(w){console.error("[ClientService] Error checking auto-approval:",w)}if(g==="nip04_decrypt"||g==="nip04_encrypt")try{const w=g==="nip04_decrypt"?-4:-5;console.log(`[ClientService] Checking auto-approval for ${g} (kind: ${w})`),console.log("[ClientService] Connection ID:",this.connectionId);const v=useConnectionsStore.getState(),_=v.connections.find(F=>F.id===this.connectionId);if(console.log("[ClientService] Found connection:",_?{id:_.id,name:_.name}:"NOT FOUND"),_){const F=v.getRulesForConnection(_.id);console.log("[ClientService] Rules for this connection:",F);const H=F.find(Y=>Y.kinds.includes(w));if(console.log("[ClientService] Matching rule:",H),H){console.log(`[ClientService]  Auto-approving ${g} for ${_.name||"app"}`),await this.approveRequest(E,r.id,r.pubkey,g,y,f);return}else console.log(`[ClientService]  No matching rule found for ${g}, showing modal`)}else console.log("[ClientService]  Connection not found in store")}catch(w){console.error("[ClientService] Error checking auto-approval:",w)}useRequestStore.getState().addRequest({id:E,requestEventId:r.id,requestorPubkey:r.pubkey,method:g,params:y,timestamp:r.created_at||Date.now()/1e3,source:"client",connectionId:this.connectionId,encryptionMethod:f}),console.log("[ClientService] Added request to queue:",g)}catch(x){console.error("[ClientService] Failed to process:",x)}}),console.log("[ClientService]  Subscription created and event handler attached"),console.log("[ClientService] Connected and listening for requests"),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connected")}catch(t){throw console.error("[ClientService] Connection failed:",t),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"error"),t}}async approveRequest(t,n,r,o,c,l="nip04"){console.log(`[ClientService]  approveRequest called for ${o} (id: ${t}) using ${l}`);try{if(o==="connect"){const y=this.secret||c[0];console.log(`[ClientService]  Sending connect RESPONSE. Stored secret: ${this.secret?"YES":"NO"}, Param secret: ${c[0]?"YES":"NO"}, Using: ${y||"ack"}`);const w=JSON.stringify({id:t,result:y||"ack",error:null});console.log("[ClientService] Connect Response content:",w);let v;if(l==="nip04")v=await nip04_exports.encrypt(this.privateKey,r,w);else{const H=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),r);v=nip44_exports.v2.encrypt(w,H)}const _=new NDKEvent(this.ndk);_.kind=24133,_.tags=[["p",r]],_.content=v,console.log("[ClientService] Sending connect response event:",{kind:_.kind,tags:_.tags,to:r}),await _.sign(this.signer);const F=await _.publish();console.log("[ClientService] Published connect response to relays:",Array.from(F).map(H=>H.url)),console.log("[ClientService]  Sent connect response"),useRequestStore.getState().removeRequest(t);return}let x;if(o==="get_public_key")x=(await this.signer.user()).pubkey;else if(o==="sign_event"){const y=typeof c[0]=="string"?JSON.parse(c[0]):c[0],w=new NDKEvent(this.ndk,y);await w.sign(this.signer),x=JSON.stringify(w.rawEvent())}else if(o==="nip04_decrypt"){const y=c[0],w=c[1];x=await nip04_exports.decrypt(this.privateKey,y,w)}else if(o==="nip04_encrypt"){const y=c[0],w=c[1];x=await nip04_exports.encrypt(this.privateKey,y,w)}else throw new Error(`Unknown method: ${o}`);const f=JSON.stringify({id:t,result:x,error:null});console.log("[ClientService] Response content:",f);let m;if(l==="nip04")m=await nip04_exports.encrypt(this.privateKey,r,f);else{const y=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),r);m=nip44_exports.v2.encrypt(f,y)}const E=new NDKEvent(this.ndk);E.kind=24133,E.tags=n?[["p",r],["e",n]]:[["p",r]],E.content=m,console.log("[ClientService] Sending response event:",{kind:E.kind,tags:E.tags,to:r}),console.log("[ClientService]  Response triggered from:",new Error().stack?.split(`
`)[2]?.trim()),await E.sign(this.signer);const g=await E.publish();console.log("[ClientService] Published response to relays:",Array.from(g).map(y=>y.url)),console.log("[ClientService]  Sent approval for:",o),useRequestStore.getState().removeRequest(t)}catch(x){console.error("[ClientService] Error approving:",x);try{const f=JSON.stringify({id:t,result:null,error:x.message||"Unknown error"});let m;if(l==="nip04")m=await nip04_exports.encrypt(this.privateKey,r,f);else{const g=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),r);m=nip44_exports.v2.encrypt(f,g)}const E=new NDKEvent(this.ndk);E.kind=24133,E.tags=[["p",r]],E.content=m,await E.sign(this.signer),await E.publish(),console.log("[ClientService] Error response published")}catch(f){console.error("[ClientService] Failed to send error response:",f)}}}async rejectRequest(t,n,r,o="User rejected"){console.log(`[ClientService]  rejectRequest called for (id: ${t})`);const c=JSON.stringify({id:t,result:null,error:o}),l=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),r),x=nip44_exports.v2.encrypt(c,l),f=new NDKEvent(this.ndk);f.kind=24133,f.tags=n?[["p",r],["e",n]]:[["p",r]],f.content=x,await f.sign(this.signer),await f.publish(),console.log("[ClientService] Sent rejection"),useRequestStore.getState().removeRequest(t)}disconnect(){this.sub&&this.sub.stop();try{this.ndk.pool&&this.ndk.pool.close()}catch(t){console.warn("[ClientService] Failed to close NDK pool:",t)}useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"disconnected"),console.log("[ClientService] Disconnected")}}var jsQR$2={exports:{}},jsQR$1=jsQR$2.exports,hasRequiredJsQR;function requireJsQR(){return hasRequiredJsQR||(hasRequiredJsQR=1,(function(e,t){(function(r,o){e.exports=o()})(typeof self<"u"?self:jsQR$1,function(){return(function(n){var r={};function o(c){if(r[c])return r[c].exports;var l=r[c]={i:c,l:!1,exports:{}};return n[c].call(l.exports,l,l.exports,o),l.l=!0,l.exports}return o.m=n,o.c=r,o.d=function(c,l,x){o.o(c,l)||Object.defineProperty(c,l,{configurable:!1,enumerable:!0,get:x})},o.n=function(c){var l=c&&c.__esModule?function(){return c.default}:function(){return c};return o.d(l,"a",l),l},o.o=function(c,l){return Object.prototype.hasOwnProperty.call(c,l)},o.p="",o(o.s=3)})([(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=(function(){function l(x,f){this.width=f,this.height=x.length/f,this.data=x}return l.createEmpty=function(x,f){return new l(new Uint8ClampedArray(x*f),x)},l.prototype.get=function(x,f){return x<0||x>=this.width||f<0||f>=this.height?!1:!!this.data[f*this.width+x]},l.prototype.set=function(x,f,m){this.data[f*this.width+x]=m?1:0},l.prototype.setRegion=function(x,f,m,E,g){for(var y=f;y<f+E;y++)for(var w=x;w<x+m;w++)this.set(w,y,!!g)},l})();r.BitMatrix=c}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=o(2);function l(f,m){return f^m}r.addOrSubtractGF=l;var x=(function(){function f(m,E,g){this.primitive=m,this.size=E,this.generatorBase=g,this.expTable=new Array(this.size),this.logTable=new Array(this.size);for(var y=1,w=0;w<this.size;w++)this.expTable[w]=y,y=y*2,y>=this.size&&(y=(y^this.primitive)&this.size-1);for(var w=0;w<this.size-1;w++)this.logTable[this.expTable[w]]=w;this.zero=new c.default(this,Uint8ClampedArray.from([0])),this.one=new c.default(this,Uint8ClampedArray.from([1]))}return f.prototype.multiply=function(m,E){return m===0||E===0?0:this.expTable[(this.logTable[m]+this.logTable[E])%(this.size-1)]},f.prototype.inverse=function(m){if(m===0)throw new Error("Can't invert 0");return this.expTable[this.size-this.logTable[m]-1]},f.prototype.buildMonomial=function(m,E){if(m<0)throw new Error("Invalid monomial degree less than 0");if(E===0)return this.zero;var g=new Uint8ClampedArray(m+1);return g[0]=E,new c.default(this,g)},f.prototype.log=function(m){if(m===0)throw new Error("Can't take log(0)");return this.logTable[m]},f.prototype.exp=function(m){return this.expTable[m]},f})();r.default=x}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=o(1),l=(function(){function x(f,m){if(m.length===0)throw new Error("No coefficients.");this.field=f;var E=m.length;if(E>1&&m[0]===0){for(var g=1;g<E&&m[g]===0;)g++;if(g===E)this.coefficients=f.zero.coefficients;else{this.coefficients=new Uint8ClampedArray(E-g);for(var y=0;y<this.coefficients.length;y++)this.coefficients[y]=m[g+y]}}else this.coefficients=m}return x.prototype.degree=function(){return this.coefficients.length-1},x.prototype.isZero=function(){return this.coefficients[0]===0},x.prototype.getCoefficient=function(f){return this.coefficients[this.coefficients.length-1-f]},x.prototype.addOrSubtract=function(f){var m;if(this.isZero())return f;if(f.isZero())return this;var E=this.coefficients,g=f.coefficients;E.length>g.length&&(m=[g,E],E=m[0],g=m[1]);for(var y=new Uint8ClampedArray(g.length),w=g.length-E.length,v=0;v<w;v++)y[v]=g[v];for(var v=w;v<g.length;v++)y[v]=c.addOrSubtractGF(E[v-w],g[v]);return new x(this.field,y)},x.prototype.multiply=function(f){if(f===0)return this.field.zero;if(f===1)return this;for(var m=this.coefficients.length,E=new Uint8ClampedArray(m),g=0;g<m;g++)E[g]=this.field.multiply(this.coefficients[g],f);return new x(this.field,E)},x.prototype.multiplyPoly=function(f){if(this.isZero()||f.isZero())return this.field.zero;for(var m=this.coefficients,E=m.length,g=f.coefficients,y=g.length,w=new Uint8ClampedArray(E+y-1),v=0;v<E;v++)for(var _=m[v],F=0;F<y;F++)w[v+F]=c.addOrSubtractGF(w[v+F],this.field.multiply(_,g[F]));return new x(this.field,w)},x.prototype.multiplyByMonomial=function(f,m){if(f<0)throw new Error("Invalid degree less than 0");if(m===0)return this.field.zero;for(var E=this.coefficients.length,g=new Uint8ClampedArray(E+f),y=0;y<E;y++)g[y]=this.field.multiply(this.coefficients[y],m);return new x(this.field,g)},x.prototype.evaluateAt=function(f){var m=0;if(f===0)return this.getCoefficient(0);var E=this.coefficients.length;if(f===1)return this.coefficients.forEach(function(y){m=c.addOrSubtractGF(m,y)}),m;m=this.coefficients[0];for(var g=1;g<E;g++)m=c.addOrSubtractGF(this.field.multiply(f,m),this.coefficients[g]);return m},x})();r.default=l}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=o(4),l=o(5),x=o(11),f=o(12);function m(y){var w=f.locate(y);if(!w)return null;for(var v=0,_=w;v<_.length;v++){var F=_[v],H=x.extract(y,F),Y=l.decode(H.matrix);if(Y)return{binaryData:Y.bytes,data:Y.text,chunks:Y.chunks,version:Y.version,location:{topRightCorner:H.mappingFunction(F.dimension,0),topLeftCorner:H.mappingFunction(0,0),bottomRightCorner:H.mappingFunction(F.dimension,F.dimension),bottomLeftCorner:H.mappingFunction(0,F.dimension),topRightFinderPattern:F.topRight,topLeftFinderPattern:F.topLeft,bottomLeftFinderPattern:F.bottomLeft,bottomRightAlignmentPattern:F.alignmentPattern}}}return null}var E={inversionAttempts:"attemptBoth"};function g(y,w,v,_){_===void 0&&(_={});var F=E;Object.keys(F||{}).forEach(function(U){F[U]=_[U]||F[U]});var H=F.inversionAttempts==="attemptBoth"||F.inversionAttempts==="invertFirst",Y=F.inversionAttempts==="onlyInvert"||F.inversionAttempts==="invertFirst",T=c.binarize(y,w,v,H),L=T.binarized,N=T.inverted,I=m(Y?N:L);return!I&&(F.inversionAttempts==="attemptBoth"||F.inversionAttempts==="invertFirst")&&(I=m(Y?L:N)),I}g.default=g,r.default=g}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=o(0),l=8,x=24;function f(g,y,w){return g<y?y:g>w?w:g}var m=(function(){function g(y,w){this.width=y,this.data=new Uint8ClampedArray(y*w)}return g.prototype.get=function(y,w){return this.data[w*this.width+y]},g.prototype.set=function(y,w,v){this.data[w*this.width+y]=v},g})();function E(g,y,w,v){if(g.length!==y*w*4)throw new Error("Malformed data passed to binarizer.");for(var _=new m(y,w),F=0;F<y;F++)for(var H=0;H<w;H++){var Y=g[(H*y+F)*4+0],T=g[(H*y+F)*4+1],L=g[(H*y+F)*4+2];_.set(F,H,.2126*Y+.7152*T+.0722*L)}for(var N=Math.ceil(y/l),I=Math.ceil(w/l),U=new m(N,I),W=0;W<I;W++)for(var O=0;O<N;O++){for(var Z=0,z=1/0,q=0,H=0;H<l;H++)for(var F=0;F<l;F++){var $=_.get(O*l+F,W*l+H);Z+=$,z=Math.min(z,$),q=Math.max(q,$)}var M=Z/Math.pow(l,2);if(q-z<=x&&(M=z/2,W>0&&O>0)){var S=(U.get(O,W-1)+2*U.get(O-1,W)+U.get(O-1,W-1))/4;z<S&&(M=S)}U.set(O,W,M)}var R=c.BitMatrix.createEmpty(y,w),D=null;v&&(D=c.BitMatrix.createEmpty(y,w));for(var W=0;W<I;W++)for(var O=0;O<N;O++){for(var j=f(O,2,N-3),P=f(W,2,I-3),Z=0,Q=-2;Q<=2;Q++)for(var C=-2;C<=2;C++)Z+=U.get(j+Q,P+C);for(var K=Z/25,Q=0;Q<l;Q++)for(var C=0;C<l;C++){var F=O*l+Q,H=W*l+C,J=_.get(F,H);R.set(F,H,J<=K),v&&D.set(F,H,!(J<=K))}}return v?{binarized:R,inverted:D}:{binarized:R}}r.binarize=E}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=o(0),l=o(6),x=o(9),f=o(10);function m(L,N){for(var I=L^N,U=0;I;)U++,I&=I-1;return U}function E(L,N){return N<<1|L}var g=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,dataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,formatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,dataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],y=[function(L){return(L.y+L.x)%2===0},function(L){return L.y%2===0},function(L){return L.x%3===0},function(L){return(L.y+L.x)%3===0},function(L){return(Math.floor(L.y/2)+Math.floor(L.x/3))%2===0},function(L){return L.x*L.y%2+L.x*L.y%3===0},function(L){return(L.y*L.x%2+L.y*L.x%3)%2===0},function(L){return((L.y+L.x)%2+L.y*L.x%3)%2===0}];function w(L){var N=17+4*L.versionNumber,I=c.BitMatrix.createEmpty(N,N);I.setRegion(0,0,9,9,!0),I.setRegion(N-8,0,8,9,!0),I.setRegion(0,N-8,9,8,!0);for(var U=0,W=L.alignmentPatternCenters;U<W.length;U++)for(var O=W[U],Z=0,z=L.alignmentPatternCenters;Z<z.length;Z++){var q=z[Z];O===6&&q===6||O===6&&q===N-7||O===N-7&&q===6||I.setRegion(O-2,q-2,5,5,!0)}return I.setRegion(6,9,1,N-17,!0),I.setRegion(9,6,N-17,1,!0),L.versionNumber>6&&(I.setRegion(N-11,0,3,6,!0),I.setRegion(0,N-11,6,3,!0)),I}function v(L,N,I){for(var U=y[I.dataMask],W=L.height,O=w(N),Z=[],z=0,q=0,$=!0,M=W-1;M>0;M-=2){M===6&&M--;for(var S=0;S<W;S++)for(var R=$?W-1-S:S,D=0;D<2;D++){var j=M-D;if(!O.get(j,R)){q++;var P=L.get(j,R);U({y:R,x:j})&&(P=!P),z=E(P,z),q===8&&(Z.push(z),q=0,z=0)}}$=!$}return Z}function _(L){var N=L.height,I=Math.floor((N-17)/4);if(I<=6)return f.VERSIONS[I-1];for(var U=0,W=5;W>=0;W--)for(var O=N-9;O>=N-11;O--)U=E(L.get(O,W),U);for(var Z=0,O=5;O>=0;O--)for(var W=N-9;W>=N-11;W--)Z=E(L.get(O,W),Z);for(var z=1/0,q,$=0,M=f.VERSIONS;$<M.length;$++){var S=M[$];if(S.infoBits===U||S.infoBits===Z)return S;var R=m(U,S.infoBits);R<z&&(q=S,z=R),R=m(Z,S.infoBits),R<z&&(q=S,z=R)}if(z<=3)return q}function F(L){for(var N=0,I=0;I<=8;I++)I!==6&&(N=E(L.get(I,8),N));for(var U=7;U>=0;U--)U!==6&&(N=E(L.get(8,U),N));for(var W=L.height,O=0,U=W-1;U>=W-7;U--)O=E(L.get(8,U),O);for(var I=W-8;I<W;I++)O=E(L.get(I,8),O);for(var Z=1/0,z=null,q=0,$=g;q<$.length;q++){var M=$[q],S=M.bits,R=M.formatInfo;if(S===N||S===O)return R;var D=m(N,S);D<Z&&(z=R,Z=D),N!==O&&(D=m(O,S),D<Z&&(z=R,Z=D))}return Z<=3?z:null}function H(L,N,I){var U=N.errorCorrectionLevels[I],W=[],O=0;if(U.ecBlocks.forEach(function(P){for(var Q=0;Q<P.numBlocks;Q++)W.push({numDataCodewords:P.dataCodewordsPerBlock,codewords:[]}),O+=P.dataCodewordsPerBlock+U.ecCodewordsPerBlock}),L.length<O)return null;L=L.slice(0,O);for(var Z=U.ecBlocks[0].dataCodewordsPerBlock,z=0;z<Z;z++)for(var q=0,$=W;q<$.length;q++){var M=$[q];M.codewords.push(L.shift())}if(U.ecBlocks.length>1)for(var S=U.ecBlocks[0].numBlocks,R=U.ecBlocks[1].numBlocks,z=0;z<R;z++)W[S+z].codewords.push(L.shift());for(;L.length>0;)for(var D=0,j=W;D<j.length;D++){var M=j[D];M.codewords.push(L.shift())}return W}function Y(L){var N=_(L);if(!N)return null;var I=F(L);if(!I)return null;var U=v(L,N,I),W=H(U,N,I.errorCorrectionLevel);if(!W)return null;for(var O=W.reduce(function(D,j){return D+j.numDataCodewords},0),Z=new Uint8ClampedArray(O),z=0,q=0,$=W;q<$.length;q++){var M=$[q],S=x.decode(M.codewords,M.codewords.length-M.numDataCodewords);if(!S)return null;for(var R=0;R<M.numDataCodewords;R++)Z[z++]=S[R]}try{return l.decode(Z,N.versionNumber)}catch{return null}}function T(L){if(L==null)return null;var N=Y(L);if(N)return N;for(var I=0;I<L.width;I++)for(var U=I+1;U<L.height;U++)L.get(I,U)!==L.get(U,I)&&(L.set(I,U,!L.get(I,U)),L.set(U,I,!L.get(U,I)));return Y(L)}r.decode=T}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=o(7),l=o(8),x;(function(_){_.Numeric="numeric",_.Alphanumeric="alphanumeric",_.Byte="byte",_.Kanji="kanji",_.ECI="eci"})(x=r.Mode||(r.Mode={}));var f;(function(_){_[_.Terminator=0]="Terminator",_[_.Numeric=1]="Numeric",_[_.Alphanumeric=2]="Alphanumeric",_[_.Byte=4]="Byte",_[_.Kanji=8]="Kanji",_[_.ECI=7]="ECI"})(f||(f={}));function m(_,F){for(var H=[],Y="",T=[10,12,14][F],L=_.readBits(T);L>=3;){var N=_.readBits(10);if(N>=1e3)throw new Error("Invalid numeric value above 999");var I=Math.floor(N/100),U=Math.floor(N/10)%10,W=N%10;H.push(48+I,48+U,48+W),Y+=I.toString()+U.toString()+W.toString(),L-=3}if(L===2){var N=_.readBits(7);if(N>=100)throw new Error("Invalid numeric value above 99");var I=Math.floor(N/10),U=N%10;H.push(48+I,48+U),Y+=I.toString()+U.toString()}else if(L===1){var N=_.readBits(4);if(N>=10)throw new Error("Invalid numeric value above 9");H.push(48+N),Y+=N.toString()}return{bytes:H,text:Y}}var E=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function g(_,F){for(var H=[],Y="",T=[9,11,13][F],L=_.readBits(T);L>=2;){var N=_.readBits(11),I=Math.floor(N/45),U=N%45;H.push(E[I].charCodeAt(0),E[U].charCodeAt(0)),Y+=E[I]+E[U],L-=2}if(L===1){var I=_.readBits(6);H.push(E[I].charCodeAt(0)),Y+=E[I]}return{bytes:H,text:Y}}function y(_,F){for(var H=[],Y="",T=[8,16,16][F],L=_.readBits(T),N=0;N<L;N++){var I=_.readBits(8);H.push(I)}try{Y+=decodeURIComponent(H.map(function(U){return"%"+("0"+U.toString(16)).substr(-2)}).join(""))}catch{}return{bytes:H,text:Y}}function w(_,F){for(var H=[],Y="",T=[8,10,12][F],L=_.readBits(T),N=0;N<L;N++){var I=_.readBits(13),U=Math.floor(I/192)<<8|I%192;U<7936?U+=33088:U+=49472,H.push(U>>8,U&255),Y+=String.fromCharCode(l.shiftJISTable[U])}return{bytes:H,text:Y}}function v(_,F){for(var H,Y,T,L,N=new c.BitStream(_),I=F<=9?0:F<=26?1:2,U={text:"",bytes:[],chunks:[],version:F};N.available()>=4;){var W=N.readBits(4);if(W===f.Terminator)return U;if(W===f.ECI)N.readBits(1)===0?U.chunks.push({type:x.ECI,assignmentNumber:N.readBits(7)}):N.readBits(1)===0?U.chunks.push({type:x.ECI,assignmentNumber:N.readBits(14)}):N.readBits(1)===0?U.chunks.push({type:x.ECI,assignmentNumber:N.readBits(21)}):U.chunks.push({type:x.ECI,assignmentNumber:-1});else if(W===f.Numeric){var O=m(N,I);U.text+=O.text,(H=U.bytes).push.apply(H,O.bytes),U.chunks.push({type:x.Numeric,text:O.text})}else if(W===f.Alphanumeric){var Z=g(N,I);U.text+=Z.text,(Y=U.bytes).push.apply(Y,Z.bytes),U.chunks.push({type:x.Alphanumeric,text:Z.text})}else if(W===f.Byte){var z=y(N,I);U.text+=z.text,(T=U.bytes).push.apply(T,z.bytes),U.chunks.push({type:x.Byte,bytes:z.bytes,text:z.text})}else if(W===f.Kanji){var q=w(N,I);U.text+=q.text,(L=U.bytes).push.apply(L,q.bytes),U.chunks.push({type:x.Kanji,bytes:q.bytes,text:q.text})}}if(N.available()===0||N.readBits(N.available())===0)return U}r.decode=v}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=(function(){function l(x){this.byteOffset=0,this.bitOffset=0,this.bytes=x}return l.prototype.readBits=function(x){if(x<1||x>32||x>this.available())throw new Error("Cannot read "+x.toString()+" bits");var f=0;if(this.bitOffset>0){var m=8-this.bitOffset,E=x<m?x:m,g=m-E,y=255>>8-E<<g;f=(this.bytes[this.byteOffset]&y)>>g,x-=E,this.bitOffset+=E,this.bitOffset===8&&(this.bitOffset=0,this.byteOffset++)}if(x>0){for(;x>=8;)f=f<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,x-=8;if(x>0){var g=8-x,y=255>>g<<g;f=f<<x|(this.bytes[this.byteOffset]&y)>>g,this.bitOffset+=x}}return f},l.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},l})();r.BitStream=c}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0}),r.shiftJISTable={32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:165,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:8254,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:92,33120:12316,33121:8214,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:8722,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:162,33170:163,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:172,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081}}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=o(1),l=o(2);function x(g,y,w,v){var _;y.degree()<w.degree()&&(_=[w,y],y=_[0],w=_[1]);for(var F=y,H=w,Y=g.zero,T=g.one;H.degree()>=v/2;){var L=F,N=Y;if(F=H,Y=T,F.isZero())return null;H=L;for(var I=g.zero,U=F.getCoefficient(F.degree()),W=g.inverse(U);H.degree()>=F.degree()&&!H.isZero();){var O=H.degree()-F.degree(),Z=g.multiply(H.getCoefficient(H.degree()),W);I=I.addOrSubtract(g.buildMonomial(O,Z)),H=H.addOrSubtract(F.multiplyByMonomial(O,Z))}if(T=I.multiplyPoly(Y).addOrSubtract(N),H.degree()>=F.degree())return null}var z=T.getCoefficient(0);if(z===0)return null;var q=g.inverse(z);return[T.multiply(q),H.multiply(q)]}function f(g,y){var w=y.degree();if(w===1)return[y.getCoefficient(1)];for(var v=new Array(w),_=0,F=1;F<g.size&&_<w;F++)y.evaluateAt(F)===0&&(v[_]=g.inverse(F),_++);return _!==w?null:v}function m(g,y,w){for(var v=w.length,_=new Array(v),F=0;F<v;F++){for(var H=g.inverse(w[F]),Y=1,T=0;T<v;T++)F!==T&&(Y=g.multiply(Y,c.addOrSubtractGF(1,g.multiply(w[T],H))));_[F]=g.multiply(y.evaluateAt(H),g.inverse(Y)),g.generatorBase!==0&&(_[F]=g.multiply(_[F],H))}return _}function E(g,y){var w=new Uint8ClampedArray(g.length);w.set(g);for(var v=new c.default(285,256,0),_=new l.default(v,w),F=new Uint8ClampedArray(y),H=!1,Y=0;Y<y;Y++){var T=_.evaluateAt(v.exp(Y+v.generatorBase));F[F.length-1-Y]=T,T!==0&&(H=!0)}if(!H)return w;var L=new l.default(v,F),N=x(v,v.buildMonomial(y,1),L,y);if(N===null)return null;var I=f(v,N[0]);if(I==null)return null;for(var U=m(v,N[1],I),W=0;W<I.length;W++){var O=w.length-1-v.log(I[W]);if(O<0)return null;w[O]=c.addOrSubtractGF(w[O],U[W])}return w}r.decode=E}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0}),r.VERSIONS=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,versionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,dataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,versionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},{numBlocks:61,dataCodewordsPerBlock:16}]}]}]}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=o(0);function l(E,g,y,w){var v=E.x-g.x+y.x-w.x,_=E.y-g.y+y.y-w.y;if(v===0&&_===0)return{a11:g.x-E.x,a12:g.y-E.y,a13:0,a21:y.x-g.x,a22:y.y-g.y,a23:0,a31:E.x,a32:E.y,a33:1};var F=g.x-y.x,H=w.x-y.x,Y=g.y-y.y,T=w.y-y.y,L=F*T-H*Y,N=(v*T-H*_)/L,I=(F*_-v*Y)/L;return{a11:g.x-E.x+N*g.x,a12:g.y-E.y+N*g.y,a13:N,a21:w.x-E.x+I*w.x,a22:w.y-E.y+I*w.y,a23:I,a31:E.x,a32:E.y,a33:1}}function x(E,g,y,w){var v=l(E,g,y,w);return{a11:v.a22*v.a33-v.a23*v.a32,a12:v.a13*v.a32-v.a12*v.a33,a13:v.a12*v.a23-v.a13*v.a22,a21:v.a23*v.a31-v.a21*v.a33,a22:v.a11*v.a33-v.a13*v.a31,a23:v.a13*v.a21-v.a11*v.a23,a31:v.a21*v.a32-v.a22*v.a31,a32:v.a12*v.a31-v.a11*v.a32,a33:v.a11*v.a22-v.a12*v.a21}}function f(E,g){return{a11:E.a11*g.a11+E.a21*g.a12+E.a31*g.a13,a12:E.a12*g.a11+E.a22*g.a12+E.a32*g.a13,a13:E.a13*g.a11+E.a23*g.a12+E.a33*g.a13,a21:E.a11*g.a21+E.a21*g.a22+E.a31*g.a23,a22:E.a12*g.a21+E.a22*g.a22+E.a32*g.a23,a23:E.a13*g.a21+E.a23*g.a22+E.a33*g.a23,a31:E.a11*g.a31+E.a21*g.a32+E.a31*g.a33,a32:E.a12*g.a31+E.a22*g.a32+E.a32*g.a33,a33:E.a13*g.a31+E.a23*g.a32+E.a33*g.a33}}function m(E,g){for(var y=x({x:3.5,y:3.5},{x:g.dimension-3.5,y:3.5},{x:g.dimension-6.5,y:g.dimension-6.5},{x:3.5,y:g.dimension-3.5}),w=l(g.topLeft,g.topRight,g.alignmentPattern,g.bottomLeft),v=f(w,y),_=c.BitMatrix.createEmpty(g.dimension,g.dimension),F=function(I,U){var W=v.a13*I+v.a23*U+v.a33;return{x:(v.a11*I+v.a21*U+v.a31)/W,y:(v.a12*I+v.a22*U+v.a32)/W}},H=0;H<g.dimension;H++)for(var Y=0;Y<g.dimension;Y++){var T=Y+.5,L=H+.5,N=F(T,L);_.set(Y,H,E.get(Math.floor(N.x),Math.floor(N.y)))}return{matrix:_,mappingFunction:F}}r.extract=m}),(function(n,r,o){Object.defineProperty(r,"__esModule",{value:!0});var c=4,l=.5,x=1.5,f=function(T,L){return Math.sqrt(Math.pow(L.x-T.x,2)+Math.pow(L.y-T.y,2))};function m(T){return T.reduce(function(L,N){return L+N})}function E(T,L,N){var I,U,W,O,Z=f(T,L),z=f(L,N),q=f(T,N),$,M,S;return z>=Z&&z>=q?(I=[L,T,N],$=I[0],M=I[1],S=I[2]):q>=z&&q>=Z?(U=[T,L,N],$=U[0],M=U[1],S=U[2]):(W=[T,N,L],$=W[0],M=W[1],S=W[2]),(S.x-M.x)*($.y-M.y)-(S.y-M.y)*($.x-M.x)<0&&(O=[S,$],$=O[0],S=O[1]),{bottomLeft:$,topLeft:M,topRight:S}}function g(T,L,N,I){var U=(m(w(T,N,I,5))/7+m(w(T,L,I,5))/7+m(w(N,T,I,5))/7+m(w(L,T,I,5))/7)/4;if(U<1)throw new Error("Invalid module size");var W=Math.round(f(T,L)/U),O=Math.round(f(T,N)/U),Z=Math.floor((W+O)/2)+7;switch(Z%4){case 0:Z++;break;case 2:Z--;break}return{dimension:Z,moduleSize:U}}function y(T,L,N,I){var U=[{x:Math.floor(T.x),y:Math.floor(T.y)}],W=Math.abs(L.y-T.y)>Math.abs(L.x-T.x),O,Z,z,q;W?(O=Math.floor(T.y),Z=Math.floor(T.x),z=Math.floor(L.y),q=Math.floor(L.x)):(O=Math.floor(T.x),Z=Math.floor(T.y),z=Math.floor(L.x),q=Math.floor(L.y));for(var $=Math.abs(z-O),M=Math.abs(q-Z),S=Math.floor(-$/2),R=O<z?1:-1,D=Z<q?1:-1,j=!0,P=O,Q=Z;P!==z+R;P+=R){var C=W?Q:P,K=W?P:Q;if(N.get(C,K)!==j&&(j=!j,U.push({x:C,y:K}),U.length===I+1))break;if(S+=M,S>0){if(Q===q)break;Q+=D,S-=$}}for(var J=[],ne=0;ne<I;ne++)U[ne]&&U[ne+1]?J.push(f(U[ne],U[ne+1])):J.push(0);return J}function w(T,L,N,I){var U,W=L.y-T.y,O=L.x-T.x,Z=y(T,L,N,Math.ceil(I/2)),z=y(T,{x:T.x-O,y:T.y-W},N,Math.ceil(I/2)),q=Z.shift()+z.shift()-1;return(U=z.concat(q)).concat.apply(U,Z)}function v(T,L){var N=m(T)/m(L),I=0;return L.forEach(function(U,W){I+=Math.pow(T[W]-U*N,2)}),{averageSize:N,error:I}}function _(T,L,N){try{var I=w(T,{x:-1,y:T.y},N,L.length),U=w(T,{x:T.x,y:-1},N,L.length),W={x:Math.max(0,T.x-T.y)-1,y:Math.max(0,T.y-T.x)-1},O=w(T,W,N,L.length),Z={x:Math.min(N.width,T.x+T.y)+1,y:Math.min(N.height,T.y+T.x)+1},z=w(T,Z,N,L.length),q=v(I,L),$=v(U,L),M=v(O,L),S=v(z,L),R=Math.sqrt(q.error*q.error+$.error*$.error+M.error*M.error+S.error*S.error),D=(q.averageSize+$.averageSize+M.averageSize+S.averageSize)/4,j=(Math.pow(q.averageSize-D,2)+Math.pow($.averageSize-D,2)+Math.pow(M.averageSize-D,2)+Math.pow(S.averageSize-D,2))/D;return R+j}catch{return 1/0}}function F(T,L){for(var N=Math.round(L.x);T.get(N,Math.round(L.y));)N--;for(var I=Math.round(L.x);T.get(I,Math.round(L.y));)I++;for(var U=(N+I)/2,W=Math.round(L.y);T.get(Math.round(U),W);)W--;for(var O=Math.round(L.y);T.get(Math.round(U),O);)O++;var Z=(W+O)/2;return{x:U,y:Z}}function H(T){for(var L=[],N=[],I=[],U=[],W=function(C){for(var K=0,J=!1,ne=[0,0,0,0,0],re=function(ce){var ue=T.get(ce,C);if(ue===J)K++;else{ne=[ne[1],ne[2],ne[3],ne[4],K],K=1,J=ue;var ae=m(ne)/7,we=Math.abs(ne[0]-ae)<ae&&Math.abs(ne[1]-ae)<ae&&Math.abs(ne[2]-3*ae)<3*ae&&Math.abs(ne[3]-ae)<ae&&Math.abs(ne[4]-ae)<ae&&!ue,ke=m(ne.slice(-3))/3,Re=Math.abs(ne[2]-ke)<ke&&Math.abs(ne[3]-ke)<ke&&Math.abs(ne[4]-ke)<ke&&ue;if(we){var be=ce-ne[3]-ne[4],Fe=be-ne[2],je={startX:Fe,endX:be,y:C},Te=N.filter(function(Je){return Fe>=Je.bottom.startX&&Fe<=Je.bottom.endX||be>=Je.bottom.startX&&Fe<=Je.bottom.endX||Fe<=Je.bottom.startX&&be>=Je.bottom.endX&&ne[2]/(Je.bottom.endX-Je.bottom.startX)<x&&ne[2]/(Je.bottom.endX-Je.bottom.startX)>l});Te.length>0?Te[0].bottom=je:N.push({top:je,bottom:je})}if(Re){var rt=ce-ne[4],st=rt-ne[3],je={startX:st,y:C,endX:rt},Te=U.filter(function(at){return st>=at.bottom.startX&&st<=at.bottom.endX||rt>=at.bottom.startX&&st<=at.bottom.endX||st<=at.bottom.startX&&rt>=at.bottom.endX&&ne[2]/(at.bottom.endX-at.bottom.startX)<x&&ne[2]/(at.bottom.endX-at.bottom.startX)>l});Te.length>0?Te[0].bottom=je:U.push({top:je,bottom:je})}}},ie=-1;ie<=T.width;ie++)re(ie);L.push.apply(L,N.filter(function(ce){return ce.bottom.y!==C&&ce.bottom.y-ce.top.y>=2})),N=N.filter(function(ce){return ce.bottom.y===C}),I.push.apply(I,U.filter(function(ce){return ce.bottom.y!==C})),U=U.filter(function(ce){return ce.bottom.y===C})},O=0;O<=T.height;O++)W(O);L.push.apply(L,N.filter(function(C){return C.bottom.y-C.top.y>=2})),I.push.apply(I,U);var Z=L.filter(function(C){return C.bottom.y-C.top.y>=2}).map(function(C){var K=(C.top.startX+C.top.endX+C.bottom.startX+C.bottom.endX)/4,J=(C.top.y+C.bottom.y+1)/2;if(T.get(Math.round(K),Math.round(J))){var ne=[C.top.endX-C.top.startX,C.bottom.endX-C.bottom.startX,C.bottom.y-C.top.y+1],re=m(ne)/ne.length,ie=_({x:Math.round(K),y:Math.round(J)},[1,1,3,1,1],T);return{score:ie,x:K,y:J,size:re}}}).filter(function(C){return!!C}).sort(function(C,K){return C.score-K.score}).map(function(C,K,J){if(K>c)return null;var ne=J.filter(function(ie,ce){return K!==ce}).map(function(ie){return{x:ie.x,y:ie.y,score:ie.score+Math.pow(ie.size-C.size,2)/C.size,size:ie.size}}).sort(function(ie,ce){return ie.score-ce.score});if(ne.length<2)return null;var re=C.score+ne[0].score+ne[1].score;return{points:[C].concat(ne.slice(0,2)),score:re}}).filter(function(C){return!!C}).sort(function(C,K){return C.score-K.score});if(Z.length===0)return null;var z=E(Z[0].points[0],Z[0].points[1],Z[0].points[2]),q=z.topRight,$=z.topLeft,M=z.bottomLeft,S=Y(T,I,q,$,M),R=[];S&&R.push({alignmentPattern:{x:S.alignmentPattern.x,y:S.alignmentPattern.y},bottomLeft:{x:M.x,y:M.y},dimension:S.dimension,topLeft:{x:$.x,y:$.y},topRight:{x:q.x,y:q.y}});var D=F(T,q),j=F(T,$),P=F(T,M),Q=Y(T,I,D,j,P);return Q&&R.push({alignmentPattern:{x:Q.alignmentPattern.x,y:Q.alignmentPattern.y},bottomLeft:{x:P.x,y:P.y},topLeft:{x:j.x,y:j.y},topRight:{x:D.x,y:D.y},dimension:Q.dimension}),R.length===0?null:R}r.locate=H;function Y(T,L,N,I,U){var W,O,Z;try{W=g(I,N,U,T),O=W.dimension,Z=W.moduleSize}catch{return null}var z={x:N.x-I.x+U.x,y:N.y-I.y+U.y},q=(f(I,U)+f(I,N))/2/Z,$=1-3/q,M={x:I.x+$*(z.x-I.x),y:I.y+$*(z.y-I.y)},S=L.map(function(D){var j=(D.top.startX+D.top.endX+D.bottom.startX+D.bottom.endX)/4,P=(D.top.y+D.bottom.y+1)/2;if(T.get(Math.floor(j),Math.floor(P))){var Q=[D.top.endX-D.top.startX,D.bottom.endX-D.bottom.startX,D.bottom.y-D.top.y+1];m(Q)/Q.length;var C=_({x:Math.floor(j),y:Math.floor(P)},[1,1,1],T),K=C+f({x:j,y:P},M);return{x:j,y:P,score:K}}}).filter(function(D){return!!D}).sort(function(D,j){return D.score-j.score}),R=q>=15&&S.length?S[0]:M;return{alignmentPattern:R,dimension:O}}})]).default})})(jsQR$2)),jsQR$2.exports}var jsQRExports=requireJsQR();const jsQR=getDefaultExportFromCjs(jsQRExports),ConnectSigner=()=>{const{decryptedKey:e}=useAuthStore(),{connections:t,addConnection:n,removeConnection:r,getRulesForConnection:o,removeRule:c}=useConnectionsStore(),{currentKeypairId:l}=useWalletStore(),[x,f]=reactExports.useState(""),[m,E]=reactExports.useState(null),[g,y]=reactExports.useState(!1),[w,v]=reactExports.useState(null),[_,F]=reactExports.useState(null),[H,Y]=reactExports.useState(!1),[T,L]=reactExports.useState(""),[N,I]=reactExports.useState(!1),[U,W]=reactExports.useState(null),O=reactExports.useRef(null),Z=reactExports.useRef(null),[z,q]=reactExports.useState(""),[$,M]=reactExports.useState(null),S=t.filter(ne=>ne.keypairId===l),R=async ne=>{if(!e){E("Please unlock your vault first");return}if(!l){E("No active address selected");return}E(null),y(!0);try{const re=ne||x,ie=ClientService.parseNostrConnectURI(re);console.log("Parsed URI:",ie);const ue=useConnectionsStore.getState().connections.find(ae=>ae.keypairId!==l?!1:!!(ae.appUrl&&ie.appUrl&&ae.appUrl===ie.appUrl||!ae.appUrl&&!ie.appUrl&&ae.name&&ie.name&&ae.name===ie.name));if(ue){y(!1),L(re),F({connectionId:ue.id,name:ue.name||ue.appUrl||"Unknown App"});return}y(!1),v({uri:re,name:ie.name||"Unknown App",pubkey:ie.signerPubkey,appUrl:ie.appUrl})}catch(re){y(!1),E(re.message)}},D=()=>{if(w)try{const ne=ClientService.parseNostrConnectURI(w.uri),ie={id:Math.random().toString(36).substring(7),keypairId:l,signerPubkey:ne.signerPubkey,relays:ne.relays,secret:ne.secret,name:ne.name,appUrl:ne.appUrl,status:"connecting",connectedAt:Date.now()};n(ie),f(""),v(null)}catch(ne){E(ne.message)}},j=async()=>{if(_){Y(!0);try{K(_.connectionId),await new Promise(re=>setTimeout(re,100));const ne=T||x;F(null),L(""),await R(ne)}finally{Y(!1)}}},P=async ne=>{const re=ne.target.files?.[0];if(!re){console.log("[QR Upload] No file selected"),q("No file selected");return}console.log("[QR Upload] File selected:",re.name,re.type),E(null),q(`File selected: ${re.name} (${(re.size/1024).toFixed(1)}KB)`);try{const ie=new Image,ce=new FileReader;ce.onload=ue=>{if(ue.target?.result){console.log("[QR Upload] File loaded, setting image source"),q("File loaded, processing image...");const ae=ue.target.result;ie.src=ae,M(ae)}},ce.onerror=()=>{console.error("[QR Upload] FileReader error"),E("Failed to read image file"),q("ERROR: Failed to read file")},ie.onload=async()=>{console.log("[QR Upload] Image loaded, dimensions:",ie.width,"x",ie.height),q(`Image loaded: ${ie.width}x${ie.height}px`);const ue=document.createElement("canvas"),ae=ue.getContext("2d",{willReadFrequently:!0});if(!ae){E("Canvas not supported"),q("ERROR: Canvas not supported");return}const we=(Re,be,Fe=!1)=>{ue.width=Re,ue.height=be,ae.drawImage(ie,0,0,Re,be);const je=ae.getImageData(0,0,Re,be),Te=jsQR(je.data,Re,be,{inversionAttempts:Fe?"invertFirst":"dontInvert"});return Te?Te.data:null};let ke=we(ie.width,ie.height);if(!ke&&(ie.width>800||ie.height>800)){const Re=800/Math.max(ie.width,ie.height);console.log("[QR Upload] Retrying with scale:",Re),ke=we(Math.floor(ie.width*Re),Math.floor(ie.height*Re))}ke||(console.log("[QR Upload] Retrying with inversion"),ke=we(ie.width,ie.height,!0)),ke?(console.log("[QR Upload] QR code found:",ke),q(`QR code found! Data: ${ke.substring(0,50)}...`),ke.startsWith("nostrconnect://")||ke.startsWith("bunker://")?(f(ke),I(!1),await R(ke)):(E("QR code found but not a valid nostrconnect:// or bunker:// URI"),q(`ERROR: Invalid URI format. Found: ${ke.substring(0,30)}...`),console.log("[QR Upload] Invalid format:",ke))):(E("No QR code detected. Try cropping the image to just the QR code."),q("ERROR: No QR code detected after multiple attempts"),console.log("[QR Upload] No QR code found"))},ie.onerror=()=>{console.error("[QR Upload] Image load error"),E("Failed to load image"),q("ERROR: Failed to load image")},ce.readAsDataURL(re)}catch(ie){console.error("[QR Upload] Error:",ie);const ce="Failed to process image: "+ie.message;E(ce),q("ERROR: "+ce)}},Q=async()=>{I(!0),E(null)};React.useEffect(()=>{let ne=null,re=!0;return N&&(async()=>{if(N){console.log("[Camera] Starting camera initialization..."),q("Requesting camera access...");try{const ce=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!re){ce.getTracks().forEach(ae=>ae.stop());return}ne=ce,console.log("[Camera] Stream obtained:",ce.id,ce.active),q("Camera access granted. Starting video...");const ue=Z.current;if(ue){console.log("[Camera] Video element found"),ue.srcObject=ce,ue.setAttribute("playsinline","true"),ue.onloadedmetadata=()=>{console.log("[Camera] Video metadata loaded:",ue.videoWidth,"x",ue.videoHeight),q(`Video ready: ${ue.videoWidth}x${ue.videoHeight}`)},ue.onplay=()=>{console.log("[Camera] Video playing")};try{await ue.play(),console.log("[Camera] Video play promise resolved"),C(ue,ce)}catch(ae){console.error("[Camera] Play failed:",ae),q("ERROR: Video play failed: "+ae.message)}}else console.error("[Camera] Video element NOT found in ref"),q("ERROR: Video element not found")}catch(ce){console.error("[Camera] Access failed:",ce),q("ERROR: Camera access failed: "+ce.message)}}})(),()=>{re=!1,ne&&(console.log("[Camera] Cleaning up stream"),ne.getTracks().forEach(ce=>ce.stop()))}},[N]);const C=(ne,re)=>{if(!N){console.log("[Camera] Stopping scan loop"),re.getTracks().forEach(ae=>ae.stop());return}const ie=document.createElement("canvas"),ce=ie.getContext("2d",{willReadFrequently:!0}),ue=async()=>{if(ne.readyState===ne.HAVE_ENOUGH_DATA&&ce){ie.height=ne.videoHeight,ie.width=ne.videoWidth,ce.drawImage(ne,0,0,ie.width,ie.height);const ae=ce.getImageData(0,0,ie.width,ie.height),we=jsQR(ae.data,ae.width,ae.height,{inversionAttempts:"dontInvert"});if(we){console.log("[Camera] QR Found:",we.data);const ke=we.data;if(ke.startsWith("nostrconnect://")||ke.startsWith("bunker://")){re.getTracks().forEach(Re=>Re.stop()),I(!1),f(ke),await R(ke);return}}}document.getElementById("qr-modal")?requestAnimationFrame(ue):(console.log("[Camera] Modal closed, stopping tracks"),re.getTracks().forEach(ae=>ae.stop()))};requestAnimationFrame(ue)},K=ne=>{r(ne)},J=ne=>{switch(ne){case"connected":return jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4 text-green-400"});case"connecting":return jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 text-yellow-400 animate-spin"});case"error":case"disconnected":return jsxRuntimeExports.jsx(CircleX,{className:"w-4 h-4 text-red-400"});default:return null}};return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Link2,{className:"w-5 h-5 text-amber-500"}),"Connect App"]}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Paste a nostrconnect:// URI from an app to act as its remote signer"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"nostrconnect:// URI"}),jsxRuntimeExports.jsx("input",{type:"text",value:x,onChange:ne=>f(ne.target.value),placeholder:"nostrconnect://...",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm"})]}),m&&jsxRuntimeExports.jsx("div",{className:"text-red-400 text-sm bg-red-400/10 p-3 rounded-lg",children:m}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>R(),disabled:g||!x,className:"flex-1 bg-amber-500 hover:bg-amber-600 disabled:bg-slate-700 disabled:text-slate-500 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors",children:g?"Connecting...":"Connect"}),jsxRuntimeExports.jsx("button",{onClick:Q,disabled:g,className:"bg-amber-500 hover:bg-amber-600 disabled:bg-slate-700 disabled:text-slate-500 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors",title:"Scan QR & Connect",children:jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5"})})]})]})]}),S.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Connected Apps"}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:S.map(ne=>jsxRuntimeExports.jsx("div",{className:"bg-slate-950 rounded-lg p-4 border border-slate-800",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[J(ne.status),jsxRuntimeExports.jsx("h4",{className:"font-semibold text-white",children:ne.name||"Unknown App"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-1 text-sm",children:[jsxRuntimeExports.jsxs("p",{className:"text-slate-400",children:["Status:"," ",jsxRuntimeExports.jsx("span",{className:"text-slate-300 capitalize",children:ne.status})]}),ne.appUrl&&jsxRuntimeExports.jsxs("p",{className:"text-slate-400",children:["URL:"," ",jsxRuntimeExports.jsx("a",{href:ne.appUrl,target:"_blank",rel:"noopener noreferrer",className:"text-amber-400 hover:underline",children:ne.appUrl})]}),jsxRuntimeExports.jsxs("p",{className:"text-slate-400 font-mono text-xs",children:["App: ",ne.signerPubkey.slice(0,16),"..."]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>W(ne.id),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",title:"Settings",children:jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("button",{onClick:()=>K(ne.id),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",title:"Disconnect",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4 text-red-400"})})]})]})},ne.id))})]}),U&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 max-w-md w-full border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Connection Settings"}),jsxRuntimeExports.jsx("button",{onClick:()=>W(null),className:"text-slate-400 hover:text-white",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Auto-Approval Rules"}),o(U).length===0?jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 italic",children:"No active rules"}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:o(U).map(ne=>jsxRuntimeExports.jsxs("div",{className:"bg-slate-800 rounded-lg p-3 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-bold text-white",children:ne.kinds.map(re=>re===-4?"Auto-Approve NIP-04 Decryption":re===-5?"Auto-Approve NIP-04 Encryption":`Auto-Approve Kind ${re}`).join(", ")}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-500",children:["Created ",new Date(ne.createdAt).toLocaleDateString()]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>c(ne.id),className:"p-1.5 hover:bg-red-500/20 rounded text-red-400 hover:text-red-300 transition-colors",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})]},ne.id))})]}),jsxRuntimeExports.jsx("div",{className:"pt-4 border-t border-slate-800",children:jsxRuntimeExports.jsxs("button",{onClick:()=>{K(U),W(null)},className:"w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"}),"Disconnect App"]})})]})]})}),w&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-amber-500/10 rounded-full",children:jsxRuntimeExports.jsx(Link2,{className:"w-6 h-6 text-amber-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Approve Connection"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Do you want to connect to this app?"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 mb-6 border border-slate-800 space-y-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"App Name"}),jsxRuntimeExports.jsx("p",{className:"text-white font-medium",children:w.name})]}),w.appUrl&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Website"}),jsxRuntimeExports.jsx("p",{className:"text-amber-400 truncate",children:w.appUrl})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"App Pubkey"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 font-mono text-xs break-all",children:w.pubkey})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>v(null),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsxs("button",{onClick:D,className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),"Connect"]})]})]})}),_&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Replace Existing Connection?"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-6",children:["You already have a connection to ",jsxRuntimeExports.jsx("span",{className:"text-amber-400 font-semibold",children:_.name}),". Do you want to replace it with this new connection?"]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>F(null),disabled:H,className:"flex-1 bg-slate-800 hover:bg-slate-700 disabled:bg-slate-700 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:j,disabled:H,className:"flex-1 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:H?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Replacing..."]}):"Replace"})]})]})}),N&&jsxRuntimeExports.jsx("div",{id:"qr-modal",className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-50 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 rounded-xl p-4 border border-slate-800 my-auto",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-4 text-center",children:"Scan QR Code"}),jsxRuntimeExports.jsxs("div",{className:"relative aspect-square bg-black rounded-lg overflow-hidden mb-4",children:[jsxRuntimeExports.jsx("video",{ref:Z,id:"qr-video",className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 border-2 border-amber-500/50 rounded-lg pointer-events-none"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("p",{className:"text-center text-slate-400 text-sm",children:"Camera not working? Upload an image instead."}),z&&jsxRuntimeExports.jsx("div",{className:`p-3 rounded-lg text-sm font-mono break-all ${z.startsWith("ERROR")?"bg-red-500/10 text-red-400":"bg-blue-500/10 text-blue-400"}`,children:z}),$&&jsxRuntimeExports.jsxs("div",{className:"relative max-h-48 overflow-hidden rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Uploaded Image:"}),jsxRuntimeExports.jsx("img",{src:$,alt:"Uploaded QR",className:"w-full object-contain bg-black/50"})]}),jsxRuntimeExports.jsx("input",{type:"file",ref:O,onChange:P,accept:"image/*",capture:"environment",className:"hidden"}),jsxRuntimeExports.jsxs("button",{onClick:()=>O.current?.click(),className:"w-full bg-slate-800 hover:bg-slate-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5"}),"Upload QR Image / Take Photo"]}),jsxRuntimeExports.jsx("button",{onClick:()=>I(!1),className:"w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 font-medium py-3 px-4 rounded-lg transition-colors",children:"Cancel"})]})]})})]})};class ProfileService{static ndk=null;static connecting=null;static getNDK(){return this.ndk||(this.ndk=new NDK({explicitRelayUrls:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io","wss://purplepag.es","wss://relay.snort.social","wss://eden.nostr.land"]})),this.ndk}static async ensureConnection(){const t=this.getNDK();if(this.connecting)console.log("[ProfileService] Waiting for existing connection...");else{if(t.pool.connectedRelays().length>0){console.log("[ProfileService] Already connected to",t.pool.connectedRelays().length,"relays");return}console.log("[ProfileService] Initiating new NDK connection..."),this.connecting=t.connect().then(()=>{console.log("[ProfileService] NDK connection established"),this.connecting=null}).catch(r=>{console.warn("[ProfileService] Connection promise failed:",r),this.connecting=null})}const n=new Promise((r,o)=>setTimeout(()=>o(new Error("Connection timeout")),5e3));try{this.connecting&&await Promise.race([this.connecting,n]),console.log("[ProfileService] NDK ready for use")}catch{console.warn("[ProfileService] Connection timed out or failed, attempting to fetch anyway...")}}static async fetchProfile(t){try{console.log("[ProfileService] Starting fetchProfile for",t);const n=this.getNDK();await this.ensureConnection();const o=new NDKUser({npub:t}).pubkey;console.log("[ProfileService] Pubkey:",o),console.log("[ProfileService] Fetching Kind 0 events...");const c=n.fetchEvents({kinds:[0],authors:[o],limit:1}),l=new Promise((w,v)=>setTimeout(()=>v(new Error("Fetch timeout after 10 seconds")),1e4)),x=await Promise.race([c,l]);if(console.log("[ProfileService] Received",x.size,"events"),x.size===0)return console.log("[ProfileService] No Kind 0 event found for",t),null;const f=Array.from(x)[0];console.log("[ProfileService] Raw event:",f),console.log("[ProfileService] Event content:",f.content);const m=JSON.parse(f.content);console.log("[ProfileService] Parsed content:",m);const E=m.display_name||m.displayName||m.name||void 0,g=m.picture||m.image||void 0,y={name:E,picture:g,about:m.about,banner:m.banner,lud16:m.lud16,nip05:m.nip05,website:m.website,npub:t};return console.log("[ProfileService] Returning profile:",y),y}catch(n){return console.error("[ProfileService] Failed to fetch profile:",n),console.error("[ProfileService] Error stack:",n instanceof Error?n.stack:"No stack"),this.connecting=null,null}}static async fetchContacts(t){try{console.log("[ProfileService] Fetching contacts for:",t);const n=this.getNDK();await this.ensureConnection(),console.log("[ProfileService] NDK connected");const o=await n.getUser({npub:t}).follows();if(console.log("[ProfileService] Found",o.size,"follows"),o.size===0)return[];const l=Array.from(o).map(E=>E.pubkey).slice(0,100);if(console.log("[ProfileService] Fetching profiles for",l.length,"contacts"),l.length===0)return[];const x=await n.fetchEvents({kinds:[0],authors:l});console.log("[ProfileService] Received",x.size,"profile events");const f=new Map;for(const E of x)try{const g=JSON.parse(E.content),y=new NDKUser({pubkey:E.pubkey}).npub;f.set(y,{name:g.name,picture:g.picture||g.image,about:g.about,nip05:g.nip05,lud16:g.lud16,banner:g.banner,website:g.website,npub:y})}catch{}const m=Array.from(f.values());return console.log("[ProfileService] Returning",m.length,"contacts"),m}catch(n){return console.error("[ProfileService] Error fetching contacts:",n),[]}}static async publishProfile(t,n){try{const r=new NDKPrivateKeySigner(t),o=new NDK({explicitRelayUrls:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io"],signer:r});await o.connect();const c=new NDKEvent(o);c.kind=0,c.content=JSON.stringify({name:n.name||"",picture:n.picture||"",about:n.about||"",banner:n.banner||"",lud16:n.lud16||"",nip05:n.nip05||"",website:n.website||""}),await c.sign(r),await c.publish(),console.log("Profile published successfully")}catch(r){throw console.error("Failed to publish profile:",r),r}}}const profile=Object.freeze(Object.defineProperty({__proto__:null,ProfileService},Symbol.toStringTag,{value:"Module"})),ViewPrivateKeyModal=({encryptedNsec:e,onClose:t})=>{const[n,r]=reactExports.useState(""),[o,c]=reactExports.useState(null),[l,x]=reactExports.useState(null),[f,m]=reactExports.useState(!1),[E,g]=reactExports.useState(!1),[y,w]=reactExports.useState(!1),v=async F=>{F.preventDefault(),x(null),m(!0);try{const H=await CryptoService.decrypt(e,n);c(H),r("")}catch{x("Incorrect password")}finally{m(!1)}},_=()=>{o&&(navigator.clipboard.writeText(o),g(!0),setTimeout(()=>g(!1),2e3))};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:t,children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",onClick:F=>F.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"View Private Key"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),o?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Private Key (nsec)"}),jsxRuntimeExports.jsx("button",{onClick:()=>w(!y),className:"text-slate-400 hover:text-white transition-colors",children:y?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("div",{className:"font-mono text-sm break-all text-white",children:y?o:"".repeat(63)})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:_,className:"flex-1 flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:E?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),"Copied!"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),"Copy"]})}),jsxRuntimeExports.jsx("button",{onClick:t,className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors",children:"Close"})]})]}):jsxRuntimeExports.jsxs("form",{onSubmit:v,className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:" Never share your private key with anyone. Anyone with this key can control this account."})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Enter your password to reveal the private key"}),jsxRuntimeExports.jsx("input",{type:"password",inputMode:"numeric",value:n,onChange:F=>r(F.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Password",required:!0,autoFocus:!0})]}),l&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:l}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:f,className:"flex-1 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors",children:f?"Decrypting...":"Reveal"})]})]})]})})},ProfileEditor=({keypair:e,walletId:t,onBack:n})=>{const{updateKeypair:r,getWallet:o}=useWalletStore(),[c,l]=reactExports.useState({name:e.profile?.name||"",picture:e.profile?.picture||"",about:e.profile?.about||"",banner:e.profile?.banner||"",lud16:e.profile?.lud16||"",nip05:e.profile?.nip05||"",website:e.profile?.website||""}),[x,f]=reactExports.useState(""),[m,E]=reactExports.useState(!1),[g,y]=reactExports.useState(!1),[w,v]=reactExports.useState(null),[_,F]=reactExports.useState(!1),H=o(t);reactExports.useEffect(()=>{(async()=>{y(!0);try{const L=await ProfileService.fetchProfile(e.npub);L&&l(L)}catch(L){console.error("Failed to fetch profile:",L)}finally{y(!1)}})()},[e.npub]);const Y=async T=>{T.preventDefault(),v(null),F(!1),E(!0);try{if(!H)throw new Error("Wallet not found");const L=await CryptoService.decrypt(e.encryptedNsec,x),N=CryptoService.nsecToHex(L);await ProfileService.publishProfile(N,c),r(t,e.id,{profile:{...c,lastFetched:Date.now()}}),F(!0),f(""),setTimeout(()=>{n()},1500)}catch(L){console.error("Failed to publish profile:",L),v("Failed to publish profile. Please check your password and try again.")}finally{E(!1)}};return jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:n,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold flex items-center gap-2 mb-2",children:"Edit Profile"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-400 text-sm",children:["Update your Nostr profile (kind:0) for ",e.npub.slice(0,12),"..."]})]}),g&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-4 bg-slate-900 rounded-xl border border-slate-800 flex items-center gap-3",children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-300",children:"Fetching latest profile from relays..."})]}),jsxRuntimeExports.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-900 rounded-xl border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"w-16 h-16 rounded-lg bg-slate-800 flex items-center justify-center overflow-hidden flex-shrink-0",children:[c.picture?jsxRuntimeExports.jsx("img",{src:c.picture,alt:"Profile",className:"w-full h-full object-cover",onError:T=>{T.currentTarget.style.display="none",T.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx(User,{className:`w-8 h-8 text-slate-600 ${c.picture?"hidden":""}`})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-slate-300",children:"Profile Preview"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 truncate",children:c.name||"No name set"})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Display Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:c.name||"",onChange:T=>l({...c,name:T.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Your name"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Bio"}),jsxRuntimeExports.jsx("textarea",{value:c.about||"",onChange:T=>l({...c,about:T.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all resize-none",placeholder:"Tell us about yourself",rows:3})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Profile Picture URL"}),jsxRuntimeExports.jsx("input",{type:"url",value:c.picture||"",onChange:T=>l({...c,picture:T.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://example.com/avatar.jpg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Banner Image URL"}),jsxRuntimeExports.jsx("input",{type:"url",value:c.banner||"",onChange:T=>l({...c,banner:T.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://example.com/banner.jpg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Lightning Address"}),jsxRuntimeExports.jsx("input",{type:"text",value:c.lud16||"",onChange:T=>l({...c,lud16:T.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"you@getalby.com"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"NIP-05 Identifier"}),jsxRuntimeExports.jsx("input",{type:"text",value:c.nip05||"",onChange:T=>l({...c,nip05:T.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"you@example.com"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Website"}),jsxRuntimeExports.jsx("input",{type:"url",value:c.website||"",onChange:T=>l({...c,website:T.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://yourwebsite.com"})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Wallet Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:x,onChange:T=>f(T.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Enter password to publish",required:!0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Your password is required to sign and publish the profile update."})]}),w&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:w}),_&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-green-400 text-sm",children:"Profile published successfully! Redirecting..."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:m||!x,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 rounded-lg transition-colors font-bold",children:m?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Publishing..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Save,{className:"w-4 h-4"}),"Save Profile"]})})]})]})]})},PasswordModal=({isOpen:e,onClose:t,onSubmit:n,title:r,description:o,submitLabel:c="Confirm",error:l})=>{const[x,f]=reactExports.useState("");reactExports.useEffect(()=>{e&&f("")},[e]);const m=E=>{E.preventDefault(),x&&n(x)};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-800 max-w-md w-full p-6 shadow-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Lock,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:r})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),o&&jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:o}),jsxRuntimeExports.jsxs("form",{onSubmit:m,children:[jsxRuntimeExports.jsx("input",{type:"password",value:x,onChange:E=>f(E.target.value),placeholder:"Enter password",inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 mb-3 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",autoFocus:!0,required:!0}),l&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm mb-3",children:l}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:c})]})]})]})}):null},InputModal=({isOpen:e,onClose:t,onSubmit:n,title:r,description:o,placeholder:c="Enter value",initialValue:l="",submitLabel:x="Save"})=>{const[f,m]=reactExports.useState(l);reactExports.useEffect(()=>{e&&m(l)},[e,l]);const E=g=>{g.preventDefault(),f.trim()&&n(f.trim())};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-800 max-w-md w-full p-6 shadow-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Pen,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:r})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),o&&jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:o}),jsxRuntimeExports.jsxs("form",{onSubmit:E,children:[jsxRuntimeExports.jsx("input",{type:"text",value:f,onChange:g=>m(g.target.value),placeholder:c,className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 mb-4 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",autoFocus:!0,required:!0}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:x})]})]})]})}):null},BackupModal=({isOpen:e,onClose:t,mnemonic:n,onDownload:r})=>{const[o,c]=reactExports.useState(!1),[l,x]=reactExports.useState(!1);if(!e)return null;const f=()=>{navigator.clipboard.writeText(n),c(!0),setTimeout(()=>c(!1),2e3)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Wallet Backup"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"These are your recovery words. Write them down and keep them safe."})}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 relative group",children:[jsxRuntimeExports.jsx("div",{className:`grid grid-cols-3 gap-2 ${l?"":"blur-sm select-none"}`,children:n.split(" ").map((m,E)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 p-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500 text-xs w-4",children:[E+1,"."]}),jsxRuntimeExports.jsx("span",{className:"font-mono font-medium text-amber-50",children:m})]},E))}),jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>x(!l),className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:l?"Hide seed phrase":"Show seed phrase",children:l?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4 text-slate-400"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("button",{onClick:f,className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:"Copy to clipboard",children:o?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 flex items-start gap-3",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:"Anyone with these words can access your funds. Never share them."})]}),jsxRuntimeExports.jsxs("button",{onClick:r,className:"w-full py-3 px-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors border border-slate-700 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),"Download Encrypted Backup"]})]})]})})},KeypairManager=({walletId:e,onBack:t})=>{const{getWallet:n,addKeypair:r,updateKeypair:o,removeKeypair:c,setCurrentKeypair:l,currentKeypairId:x,updateWallet:f,removeWallet:m,currentWalletId:E,setCurrentWallet:g,wallets:y}=useWalletStore(),{unlock:w}=useAuthStore(),[v,_]=reactExports.useState(""),[F,H]=reactExports.useState(!1),[Y,T]=reactExports.useState(null),[L,N]=reactExports.useState(null),[I,U]=reactExports.useState(null),[W,O]=reactExports.useState(null),[Z,z]=reactExports.useState(null),[q,$]=reactExports.useState(!1),[M,S]=reactExports.useState(null),[R,D]=reactExports.useState(!1),[j,P]=reactExports.useState(null),[Q,C]=reactExports.useState(!1),[K,J]=reactExports.useState(!1),[ne,re]=reactExports.useState(!1),[ie,ce]=reactExports.useState(""),[ue,ae]=reactExports.useState(null),[we,ke]=reactExports.useState(!1),[Re,be]=reactExports.useState(null),[Fe,je]=reactExports.useState(null),Te=n(e);if(!Te)return jsxRuntimeExports.jsx("div",{children:"Wallet not found"});reactExports.useEffect(()=>{(async()=>{for(const B of Te.keypairs){if(B.profile?.lastFetched&&Date.now()-B.profile.lastFetched<1e4){console.log("[KeypairManager] Skipping profile fetch for",B.npub,"- fetched recently");continue}try{console.log("[KeypairManager] Fetching profile for",B.npub);const k=await ProfileService.fetchProfile(B.npub);k&&o(Te.id,B.id,{profile:{...k,lastFetched:Date.now()}})}catch(k){console.error(`Failed to fetch profile for ${B.npub}:`,k)}}})()},[Te.id]);const rt=async G=>{G.preventDefault(),z(null),$(!0);try{if(Y==="add"){if(Te.type==="imported")throw new Error("Cannot derive new addresses for imported wallets");const B=await CryptoService.decrypt(Te.encryptedSeed,v);let k=0;Te.keypairs.forEach(Ie=>{if(Ie.derivationPath){const $e=Ie.derivationPath.match(/(\d+)$/);if($e){const Me=parseInt($e[1]);Me>=k&&(k=Me+1)}}});const{nsec:te,npub:oe,path:xe}=CryptoService.deriveKeypair(B,k),pe=await CryptoService.encrypt(te,v),Ne={id:crypto.randomUUID(),walletId:Te.id,name:`Address ${k+1}`,derivationPath:xe,encryptedNsec:pe,npub:oe,createdAt:Date.now(),connections:[]};r(Te.id,Ne),H(!1),_(""),T(null),setTimeout(async()=>{try{const Ie=await ProfileService.fetchProfile(oe);Ie&&o(Te.id,Ne.id,{profile:{...Ie,lastFetched:Date.now()}})}catch(Ie){console.error("Failed to fetch profile for new keypair:",Ie)}},100)}else if(Y==="switch"&&L){const B=await CryptoService.decrypt(L.encryptedNsec,v),k=CryptoService.nsecToHex(B);Te.id!==E&&g(Te.id),l(L.id),w(k,v),H(!1),_(""),T(null),N(null)}}catch{z("Incorrect password or operation failed")}finally{$(!1)}},st=()=>{T("add"),H(!0),z(null)},Je=async G=>{try{console.log("[KeypairManager] Manually refreshing profile for",G.npub);const B=await ProfileService.fetchProfile(G.npub);B?(o(Te.id,G.id,{profile:{...B,lastFetched:Date.now()}}),je({message:"Profile refreshed!",type:"success"})):je({message:"No profile found",type:"error"})}catch(B){console.error("Failed to refresh profile:",B),je({message:"Failed to refresh profile",type:"error"})}},Ke=async G=>{const{password:B}=useAuthStore.getState();if(B)try{const k=await CryptoService.decrypt(G.encryptedNsec,B),te=CryptoService.nsecToHex(k);l(G.id),w(te,B);return}catch{console.error("[KeypairManager] Cached password failed, prompting for password")}N(G),T("switch"),H(!0),z(null)},at=(G,B)=>{navigator.clipboard.writeText(G),S(B),setTimeout(()=>S(null),2e3)},mt=G=>{G&&G!==Te.name&&(f(Te.id,{name:G}),je({message:"Address Book renamed successfully!",type:"success"})),C(!1)},qe=G=>{G&&j&&(o(Te.id,j.id,{name:G}),je({message:"Address renamed successfully!",type:"success"})),D(!1),P(null)},De=async G=>{try{const{CryptoService:B}=await __vitePreload(async()=>{const{CryptoService:te}=await Promise.resolve().then(()=>crypto$3);return{CryptoService:te}},void 0,import.meta.url),k=await B.decrypt(Te.encryptedSeed,G);ce(k),_(G),J(!1),re(!0),ae(null)}catch(B){console.error("Failed to export backup:",B),ae("Failed to decrypt wallet. Incorrect password.")}},Se=async()=>{try{const{CryptoService:G}=await __vitePreload(async()=>{const{CryptoService:pe}=await Promise.resolve().then(()=>crypto$3);return{CryptoService:pe}},void 0,import.meta.url),B=await G.encrypt(ie,v),k=JSON.stringify({wallet:Te.name,encrypted:B,timestamp:Date.now()},null,2),te=new Blob([k],{type:"application/json"}),oe=URL.createObjectURL(te),xe=document.createElement("a");xe.href=oe,xe.download=`${Te.name.toLowerCase().replace(/\s+/g,"-")}-backup-encrypted.json`,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(oe),je({message:"Encrypted backup downloaded successfully!",type:"success"})}catch(G){console.error("Failed to download backup:",G),je({message:"Failed to generate backup file",type:"error"})}},_e=async G=>{try{const{CryptoService:B}=await __vitePreload(async()=>{const{CryptoService:oe}=await Promise.resolve().then(()=>crypto$3);return{CryptoService:oe}},void 0,import.meta.url);Te.type==="mnemonic"&&Te.encryptedSeed?await B.decrypt(Te.encryptedSeed,G):Te.keypairs.length>0&&await B.decrypt(Te.keypairs[0].encryptedNsec,G);const{lock:k}=useAuthStore.getState(),te=y.filter(oe=>oe.id!==Te.id);m(Te.id),te.length===0?k():t()}catch(B){console.error("Failed to delete wallet:",B),be("Incorrect password. Cannot delete wallet.")}};return W?jsxRuntimeExports.jsx(ProfileEditor,{keypair:W,walletId:e,onBack:()=>O(null)}):jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:t,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Address Books"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold",children:Te.name}),jsxRuntimeExports.jsx("button",{onClick:()=>C(!0),className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Rename address book",children:jsxRuntimeExports.jsx(Pen,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm",children:"Manage your addresses"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[Te.id!==E&&jsxRuntimeExports.jsxs("button",{onClick:()=>{H(!0),T("switch"),N(Te.keypairs[0])},className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Activate Wallet"})]}),Te.type==="mnemonic"&&Te.encryptedSeed&&jsxRuntimeExports.jsxs("button",{onClick:()=>{ae(null),J(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Export Backup"})]}),Te.type==="mnemonic"&&jsxRuntimeExports.jsxs("button",{onClick:st,className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Add Address"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{be(null),ke(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-red-500/10 hover:text-red-500 text-slate-400 rounded-lg transition-colors text-sm font-medium",title:"Delete Wallet",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]}),F&&jsxRuntimeExports.jsx("div",{className:"mb-6 p-4 bg-slate-900 rounded-xl border border-slate-800",children:jsxRuntimeExports.jsxs("form",{onSubmit:rt,children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:Y==="add"?"Enter wallet password to add new address":"Enter wallet password to switch address"}),jsxRuntimeExports.jsx("input",{type:"password",value:v,onChange:G=>_(G.target.value),inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 mb-3 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",placeholder:"Password",required:!0,autoFocus:!0}),Z&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm mb-3",children:Z}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{H(!1),_(""),z(null),T(null),N(null)},className:"flex-1 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:q,className:"flex-1 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold disabled:opacity-50",children:q?"Processing...":"Confirm"})]})]})}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:Te.keypairs.map(G=>{const B=G.npub.length>16?`${G.npub.slice(0,8)}...${G.npub.slice(-6)}`:G.npub;return jsxRuntimeExports.jsxs("div",{className:`p-4 rounded-xl border transition-all ${x===G.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[jsxRuntimeExports.jsxs("div",{className:`relative rounded-lg flex-shrink-0 cursor-pointer group ${x===G.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,onClick:k=>{k.stopPropagation();const te=k.currentTarget;te.classList.add("opacity-50"),Je(G).finally(()=>te.classList.remove("opacity-50"))},title:"Click to refresh profile",children:[G.profile?.picture?jsxRuntimeExports.jsx("img",{src:G.profile.picture,alt:G.profile.name||"Profile",className:"w-10 h-10 rounded-lg object-cover",onError:k=>{k.currentTarget.style.display="none",k.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx("div",{className:`w-10 h-10 flex items-center justify-center ${G.profile?.picture?"hidden":""}`,children:jsxRuntimeExports.jsx(User,{className:"w-6 h-6"})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100 rounded-lg",children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 text-white"})})]}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg truncate",children:G.profile?.name||G.name}),jsxRuntimeExports.jsx("button",{onClick:()=>{P(G),D(!0)},className:"p-1 text-slate-500 hover:text-white hover:bg-slate-800 rounded transition-colors",title:"Rename address",children:jsxRuntimeExports.jsx(Pen,{className:"w-3 h-3"})}),x===G.id&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex-shrink-0",children:"Active"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"font-mono bg-slate-950 px-2 py-0.5 rounded text-xs",children:B}),jsxRuntimeExports.jsx("button",{onClick:()=>at(G.npub,G.id),className:"text-slate-500 hover:text-white transition-colors flex-shrink-0 p-1 hover:bg-slate-800 rounded",title:"Copy npub",children:M===G.id?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:()=>U(G),className:"text-slate-500 hover:text-white transition-colors flex-shrink-0 p-1 hover:bg-slate-800 rounded",title:"View private key",children:jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"})})]}),G.derivationPath&&jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mt-1 font-mono truncate",children:G.derivationPath})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-slate-800",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>O(G),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors text-sm",children:[jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Edit Profile"})]}),x!==G.id&&Te.id===E&&jsxRuntimeExports.jsxs("button",{onClick:()=>Ke(G),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-slate-800 hover:bg-slate-700 text-slate-300 text-sm font-medium rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Switch"})]}),Te.keypairs.length>1&&jsxRuntimeExports.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this address?")&&c(Te.id,G.id)},className:"px-3 py-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete address",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]},G.id)})}),I&&jsxRuntimeExports.jsx(ViewPrivateKeyModal,{encryptedNsec:I.encryptedNsec,onClose:()=>U(null)}),jsxRuntimeExports.jsx(InputModal,{isOpen:R,onClose:()=>{D(!1),P(null)},onSubmit:qe,title:"Rename Address",description:"Enter a new name for this address",placeholder:"Address name",initialValue:j?.name||"",submitLabel:"Rename"}),jsxRuntimeExports.jsx(InputModal,{isOpen:Q,onClose:()=>C(!1),onSubmit:mt,title:"Rename Address Book",description:"Enter a new name for your address book",placeholder:"Address book name",initialValue:Te.name,submitLabel:"Rename"}),jsxRuntimeExports.jsx(PasswordModal,{isOpen:K,onClose:()=>{J(!1),ae(null)},onSubmit:De,title:"Export Encrypted Backup",description:"Enter your wallet password to export an encrypted backup file",submitLabel:"Export",error:ue}),jsxRuntimeExports.jsx(BackupModal,{isOpen:ne,onClose:()=>{re(!1),ce(""),_("")},mnemonic:ie,onDownload:Se}),jsxRuntimeExports.jsx(PasswordModal,{isOpen:we,onClose:()=>{ke(!1),be(null)},onSubmit:_e,title:"Delete Address Book",description:`Are you sure you want to delete "${Te.name}"? This action cannot be undone. Enter your password to confirm.`,submitLabel:"Delete Address Book",error:Re}),Fe&&jsxRuntimeExports.jsx(Toast,{message:Fe.message,type:Fe.type,isOpen:!!Fe,onClose:()=>je(null)})]})},WalletManager=({onBack:e})=>{const[t,n]=reactExports.useState("list"),[r,o]=reactExports.useState(null),{wallets:c,currentWalletId:l,setCurrentWallet:x}=useWalletStore(),{lock:f}=useAuthStore(),m=()=>{t==="list"&&e?e():(n("list"),o(null))},E=y=>{x(y),f()},g=y=>{o(y),n("keypairs")};return t==="create"?jsxRuntimeExports.jsx(CreateWallet,{onBack:m,onComplete:m}):t==="import"?jsxRuntimeExports.jsx(ImportWallet,{onBack:m,onComplete:m}):t==="keypairs"&&r?jsxRuntimeExports.jsx(KeypairManager,{walletId:r,onBack:m}):jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e&&t==="list"&&jsxRuntimeExports.jsxs("button",{onClick:e,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Connections"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-6 h-6 text-amber-500"}),"Address Books"]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>n("import"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"sm:inline",children:"Import"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>n("create"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"sm:inline",children:"Create"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:c.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12 bg-slate-900/50 rounded-xl border border-slate-800 border-dashed",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No Address Books Found"}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 max-w-xs mx-auto mb-6",children:"Create a new address book or import an existing one to get started."}),jsxRuntimeExports.jsxs("div",{className:"flex justify-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>n("create"),className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg font-bold transition-colors",children:"Create New"}),jsxRuntimeExports.jsx("button",{onClick:()=>n("import"),className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors",children:"Import"})]})]}):c.map(y=>jsxRuntimeExports.jsx("div",{className:`p-4 rounded-xl border transition-all ${l===y.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg ${l===y.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:y.type==="imported"?jsxRuntimeExports.jsx(Key,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(Notebook,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[y.name,l===y.id&&jsxRuntimeExports.jsxs("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex items-center gap-1",children:[jsxRuntimeExports.jsx(Check,{className:"w-3 h-3"})," Active"]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3 text-sm text-slate-400 mt-1",children:jsxRuntimeExports.jsxs("span",{children:[y.keypairs.length," address",y.keypairs.length!==1?"es":""]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>g(y.id),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Manage Keys",children:jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"})}),l!==y.id&&jsxRuntimeExports.jsx("button",{onClick:()=>E(y.id),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Switch to this wallet",children:jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"})})]})]})},y.id))})]})},RelayManager=({onClose:e})=>{const{relays:t,addRelay:n,removeRelay:r}=useRelayStore(),[o,c]=reactExports.useState(""),[l,x]=reactExports.useState(null),f=async()=>{if(x(null),!o.trim()){x("Please enter a relay URL");return}if(!o.startsWith("wss://")&&!o.startsWith("ws://")){x("Relay URL must start with wss:// or ws://");return}const w=o.trim();n(w),c(""),window.dispatchEvent(new CustomEvent("add-relay",{detail:{url:w}}))},m=w=>{if(t.length<=1){x("Cannot remove the last relay");return}r(w)},E=w=>{switch(w.status){case"connected":return jsxRuntimeExports.jsx(Wifi,{className:"w-4 h-4 text-green-500"});case"connecting":return jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 text-yellow-500 animate-spin"});case"disconnected":case"error":return jsxRuntimeExports.jsx(WifiOff,{className:"w-4 h-4 text-red-500"})}},g=w=>{switch(w.status){case"connected":return"Connected";case"connecting":return"Connecting...";case"disconnected":return"Disconnected";case"error":return"Error"}},y=w=>{switch(w.status){case"connected":return"text-green-500";case"connecting":return"text-yellow-500";case"disconnected":case"error":return"text-red-500"}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:e,children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-2xl w-full border border-slate-800 shadow-2xl max-h-[80vh] flex flex-col",onClick:w=>w.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white",children:"Relay Management"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Manage your Nostr relay connections"})]}),jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",title:"Close",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Add New Relay"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsx("input",{type:"text",value:o,onChange:w=>c(w.target.value),onKeyDown:w=>w.key==="Enter"&&f(),placeholder:"wss://relay.example.com",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none"}),jsxRuntimeExports.jsxs("button",{onClick:f,className:"w-full px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg font-bold transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),"Add Relay"]})]}),l&&jsxRuntimeExports.jsx("p",{className:"text-red-400 text-sm mt-2",children:l}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Note: You may need to refresh the page for new relays to connect."})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-slate-400 mb-3",children:["Active Relays (",t.length,")"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:t.map(w=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-950 rounded-xl border border-slate-800 hover:border-slate-700 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[E(w),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"font-mono text-sm text-white truncate",children:w.url}),jsxRuntimeExports.jsxs("div",{className:`text-xs ${y(w)} mt-0.5`,children:[g(w),w.lastConnected&&w.status==="connected"&&jsxRuntimeExports.jsxs("span",{className:"text-slate-500 ml-2",children:[" Last: ",new Date(w.lastConnected).toLocaleTimeString()]}),w.failedAttempts>0&&jsxRuntimeExports.jsxs("span",{className:"text-slate-500 ml-2",children:[" Failed attempts: ",w.failedAttempts]})]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>m(w.url),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors ml-2",title:"Remove relay",disabled:t.length<=1,children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]},w.url))})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 p-4 bg-slate-950 rounded-lg border border-slate-800",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-400",children:[jsxRuntimeExports.jsx("strong",{className:"text-slate-300",children:"Note:"})," Relays are used to communicate with Nostr apps. The PWA will automatically attempt to reconnect to disconnected relays every 5 seconds."]})})]})})},BottomNav=({currentView:e,onChange:t})=>jsxRuntimeExports.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-900 border-t border-slate-800 pb-safe",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-around items-center h-16 max-w-md mx-auto",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>t("connections"),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${e==="connections"?"text-amber-500":"text-slate-500 hover:text-slate-400"}`,children:[jsxRuntimeExports.jsx(FilePenLine,{className:"w-6 h-6 mb-1"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:"Connections"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>t("wallet"),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${e==="wallet"?"text-amber-500":"text-slate-500 hover:text-slate-400"}`,children:[jsxRuntimeExports.jsx(Wallet,{className:"w-6 h-6 mb-1"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:"Wallet"})]})]})}),bitcoin$1={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};function check$d(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;const t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return!1;const n=e[5+t];return!(n===0||6+t+n!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||n>1&&e[t+6]===0&&!(e[t+7]&128))}function decode$h(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");const t=e[3];if(t===0)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(e[4+t]!==2)throw new Error("Expected DER integer (2)");const n=e[5+t];if(n===0)throw new Error("S length is zero");if(6+t+n!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(t>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[t+6]&128)throw new Error("S value is negative");if(n>1&&e[t+6]===0&&!(e[t+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}function encode$j(e,t){const n=e.length,r=t.length;if(n===0)throw new Error("R length is zero");if(r===0)throw new Error("S length is zero");if(n>33)throw new Error("R length is too long");if(r>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(t[0]&128)throw new Error("S value is negative");if(n>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(r>1&&t[0]===0&&!(t[1]&128))throw new Error("S value excessively padded");const o=new Uint8Array(6+n+r);return o[0]=48,o[1]=o.length-2,o[2]=2,o[3]=e.length,o.set(e,4),o[4+n]=2,o[5+n]=t.length,o.set(t,6+n),o}var OPS$7;(function(e){e[e.OP_FALSE=0]="OP_FALSE",e[e.OP_0=0]="OP_0",e[e.OP_PUSHDATA1=76]="OP_PUSHDATA1",e[e.OP_PUSHDATA2=77]="OP_PUSHDATA2",e[e.OP_PUSHDATA4=78]="OP_PUSHDATA4",e[e.OP_1NEGATE=79]="OP_1NEGATE",e[e.OP_RESERVED=80]="OP_RESERVED",e[e.OP_TRUE=81]="OP_TRUE",e[e.OP_1=81]="OP_1",e[e.OP_2=82]="OP_2",e[e.OP_3=83]="OP_3",e[e.OP_4=84]="OP_4",e[e.OP_5=85]="OP_5",e[e.OP_6=86]="OP_6",e[e.OP_7=87]="OP_7",e[e.OP_8=88]="OP_8",e[e.OP_9=89]="OP_9",e[e.OP_10=90]="OP_10",e[e.OP_11=91]="OP_11",e[e.OP_12=92]="OP_12",e[e.OP_13=93]="OP_13",e[e.OP_14=94]="OP_14",e[e.OP_15=95]="OP_15",e[e.OP_16=96]="OP_16",e[e.OP_NOP=97]="OP_NOP",e[e.OP_VER=98]="OP_VER",e[e.OP_IF=99]="OP_IF",e[e.OP_NOTIF=100]="OP_NOTIF",e[e.OP_VERIF=101]="OP_VERIF",e[e.OP_VERNOTIF=102]="OP_VERNOTIF",e[e.OP_ELSE=103]="OP_ELSE",e[e.OP_ENDIF=104]="OP_ENDIF",e[e.OP_VERIFY=105]="OP_VERIFY",e[e.OP_RETURN=106]="OP_RETURN",e[e.OP_TOALTSTACK=107]="OP_TOALTSTACK",e[e.OP_FROMALTSTACK=108]="OP_FROMALTSTACK",e[e.OP_2DROP=109]="OP_2DROP",e[e.OP_2DUP=110]="OP_2DUP",e[e.OP_3DUP=111]="OP_3DUP",e[e.OP_2OVER=112]="OP_2OVER",e[e.OP_2ROT=113]="OP_2ROT",e[e.OP_2SWAP=114]="OP_2SWAP",e[e.OP_IFDUP=115]="OP_IFDUP",e[e.OP_DEPTH=116]="OP_DEPTH",e[e.OP_DROP=117]="OP_DROP",e[e.OP_DUP=118]="OP_DUP",e[e.OP_NIP=119]="OP_NIP",e[e.OP_OVER=120]="OP_OVER",e[e.OP_PICK=121]="OP_PICK",e[e.OP_ROLL=122]="OP_ROLL",e[e.OP_ROT=123]="OP_ROT",e[e.OP_SWAP=124]="OP_SWAP",e[e.OP_TUCK=125]="OP_TUCK",e[e.OP_CAT=126]="OP_CAT",e[e.OP_SUBSTR=127]="OP_SUBSTR",e[e.OP_LEFT=128]="OP_LEFT",e[e.OP_RIGHT=129]="OP_RIGHT",e[e.OP_SIZE=130]="OP_SIZE",e[e.OP_INVERT=131]="OP_INVERT",e[e.OP_AND=132]="OP_AND",e[e.OP_OR=133]="OP_OR",e[e.OP_XOR=134]="OP_XOR",e[e.OP_EQUAL=135]="OP_EQUAL",e[e.OP_EQUALVERIFY=136]="OP_EQUALVERIFY",e[e.OP_RESERVED1=137]="OP_RESERVED1",e[e.OP_RESERVED2=138]="OP_RESERVED2",e[e.OP_1ADD=139]="OP_1ADD",e[e.OP_1SUB=140]="OP_1SUB",e[e.OP_2MUL=141]="OP_2MUL",e[e.OP_2DIV=142]="OP_2DIV",e[e.OP_NEGATE=143]="OP_NEGATE",e[e.OP_ABS=144]="OP_ABS",e[e.OP_NOT=145]="OP_NOT",e[e.OP_0NOTEQUAL=146]="OP_0NOTEQUAL",e[e.OP_ADD=147]="OP_ADD",e[e.OP_SUB=148]="OP_SUB",e[e.OP_MUL=149]="OP_MUL",e[e.OP_DIV=150]="OP_DIV",e[e.OP_MOD=151]="OP_MOD",e[e.OP_LSHIFT=152]="OP_LSHIFT",e[e.OP_RSHIFT=153]="OP_RSHIFT",e[e.OP_BOOLAND=154]="OP_BOOLAND",e[e.OP_BOOLOR=155]="OP_BOOLOR",e[e.OP_NUMEQUAL=156]="OP_NUMEQUAL",e[e.OP_NUMEQUALVERIFY=157]="OP_NUMEQUALVERIFY",e[e.OP_NUMNOTEQUAL=158]="OP_NUMNOTEQUAL",e[e.OP_LESSTHAN=159]="OP_LESSTHAN",e[e.OP_GREATERTHAN=160]="OP_GREATERTHAN",e[e.OP_LESSTHANOREQUAL=161]="OP_LESSTHANOREQUAL",e[e.OP_GREATERTHANOREQUAL=162]="OP_GREATERTHANOREQUAL",e[e.OP_MIN=163]="OP_MIN",e[e.OP_MAX=164]="OP_MAX",e[e.OP_WITHIN=165]="OP_WITHIN",e[e.OP_RIPEMD160=166]="OP_RIPEMD160",e[e.OP_SHA1=167]="OP_SHA1",e[e.OP_SHA256=168]="OP_SHA256",e[e.OP_HASH160=169]="OP_HASH160",e[e.OP_HASH256=170]="OP_HASH256",e[e.OP_CODESEPARATOR=171]="OP_CODESEPARATOR",e[e.OP_CHECKSIG=172]="OP_CHECKSIG",e[e.OP_CHECKSIGVERIFY=173]="OP_CHECKSIGVERIFY",e[e.OP_CHECKMULTISIG=174]="OP_CHECKMULTISIG",e[e.OP_CHECKMULTISIGVERIFY=175]="OP_CHECKMULTISIGVERIFY",e[e.OP_NOP1=176]="OP_NOP1",e[e.OP_CHECKLOCKTIMEVERIFY=177]="OP_CHECKLOCKTIMEVERIFY",e[e.OP_NOP2=177]="OP_NOP2",e[e.OP_CHECKSEQUENCEVERIFY=178]="OP_CHECKSEQUENCEVERIFY",e[e.OP_NOP3=178]="OP_NOP3",e[e.OP_NOP4=179]="OP_NOP4",e[e.OP_NOP5=180]="OP_NOP5",e[e.OP_NOP6=181]="OP_NOP6",e[e.OP_NOP7=182]="OP_NOP7",e[e.OP_NOP8=183]="OP_NOP8",e[e.OP_NOP9=184]="OP_NOP9",e[e.OP_NOP10=185]="OP_NOP10",e[e.OP_CHECKSIGADD=186]="OP_CHECKSIGADD",e[e.OP_PUBKEYHASH=253]="OP_PUBKEYHASH",e[e.OP_PUBKEY=254]="OP_PUBKEY",e[e.OP_INVALIDOPCODE=255]="OP_INVALIDOPCODE"})(OPS$7||(OPS$7={}));const HEX_STRINGS$2="0123456789abcdefABCDEF",HEX_CODES=HEX_STRINGS$2.split("").map(e=>e.codePointAt(0)),HEX_CODEPOINTS=Array(256).fill(!0).map((e,t)=>{const n=String.fromCodePoint(t),r=HEX_STRINGS$2.indexOf(n);return r<0?void 0:r<16?r:r-6}),ENCODER=new TextEncoder,DECODER=new TextDecoder;function toUtf8(e){return DECODER.decode(e)}function fromUtf8(e){return ENCODER.encode(e)}function concat$1(e){const t=e.reduce((o,c)=>o+c.length,0),n=new Uint8Array(t);let r=0;for(const o of e)n.set(o,r),r+=o.length;return n}function toHex(e){const t=e||new Uint8Array;return t.length>512?_toHexLengthPerf(t):_toHexIterPerf(t)}function _toHexIterPerf(e){let t="";for(let n=0;n<e.length;++n)t+=HEX_STRINGS$2[HEX_CODEPOINTS[HEX_CODES[e[n]>>4]]],t+=HEX_STRINGS$2[HEX_CODEPOINTS[HEX_CODES[e[n]&15]]];return t}function _toHexLengthPerf(e){const t=new Uint8Array(e.length*2);for(let n=0;n<e.length;++n)t[n*2]=HEX_CODES[e[n]>>4],t[n*2+1]=HEX_CODES[e[n]&15];return DECODER.decode(t)}function fromHex(e){const t=ENCODER.encode(e||""),n=new Uint8Array(Math.floor(t.length/2));let r;for(r=0;r<n.length;r++){const o=HEX_CODEPOINTS[t[r*2]],c=HEX_CODEPOINTS[t[r*2+1]];if(o===void 0||c===void 0)break;n[r]=o<<4|c}return r===n.length?n:n.slice(0,r)}function toBase64(e){return btoa(String.fromCharCode(...e))}function fromBase64(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}function compare(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;++r)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return e.length===t.length?0:e.length>t.length?1:-1}function writeUInt8(e,t,n){if(t+1>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n>255)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 255. Received ${n}`);return e[t]=n,t+1}function writeUInt16$1(e,t,n,r){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>65535)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${n}`);return r==="LE"?(e[t]=n&255,e[t+1]=n>>8&255):(e[t]=n>>8&255,e[t+1]=n&255),t+2}function writeUInt32$2(e,t,n,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${n}`);return r==="LE"?(e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255):(e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=n&255),t+4}function writeUInt64$1(e,t,n,r){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>0xffffffffffffffffn)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${n}`);return r==="LE"?(e[t]=Number(n&0xffn),e[t+1]=Number(n>>8n&0xffn),e[t+2]=Number(n>>16n&0xffn),e[t+3]=Number(n>>24n&0xffn),e[t+4]=Number(n>>32n&0xffn),e[t+5]=Number(n>>40n&0xffn),e[t+6]=Number(n>>48n&0xffn),e[t+7]=Number(n>>56n&0xffn)):(e[t]=Number(n>>56n&0xffn),e[t+1]=Number(n>>48n&0xffn),e[t+2]=Number(n>>40n&0xffn),e[t+3]=Number(n>>32n&0xffn),e[t+4]=Number(n>>24n&0xffn),e[t+5]=Number(n>>16n&0xffn),e[t+6]=Number(n>>8n&0xffn),e[t+7]=Number(n&0xffn)),t+8}function readUInt8(e,t){if(t+1>e.length)throw new Error("Offset is outside the bounds of Uint8Array");return e[t]}function readUInt16$1(e,t,n){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),n==="LE"){let r=0;return r=(r<<8)+e[t+1],r=(r<<8)+e[t],r}else{let r=0;return r=(r<<8)+e[t],r=(r<<8)+e[t+1],r}}function readUInt32$1(e,t,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),n==="LE"){let r=0;return r=(r<<8)+e[t+3]>>>0,r=(r<<8)+e[t+2]>>>0,r=(r<<8)+e[t+1]>>>0,r=(r<<8)+e[t]>>>0,r}else{let r=0;return r=(r<<8)+e[t]>>>0,r=(r<<8)+e[t+1]>>>0,r=(r<<8)+e[t+2]>>>0,r=(r<<8)+e[t+3]>>>0,r}}function writeInt32(e,t,n,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n>2147483647||n<-2147483648)throw new Error(`The value of "value" is out of range. It must be >= -2147483648 and <= 2147483647. Received ${n}`);return r=r.toUpperCase(),r==="LE"?(e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255):(e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=n&255),t+4}function writeInt64(e,t,n,r){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n>0x7fffffffffffffffn||n<-0x8000000000000000n)throw new Error(`The value of "value" is out of range. It must be >= ${-0x8000000000000000n} and <= ${0x7fffffffffffffffn}. Received ${n}`);return r=r.toUpperCase(),r==="LE"?(e[t]=Number(n&0xffn),e[t+1]=Number(n>>8n&0xffn),e[t+2]=Number(n>>16n&0xffn),e[t+3]=Number(n>>24n&0xffn),e[t+4]=Number(n>>32n&0xffn),e[t+5]=Number(n>>40n&0xffn),e[t+6]=Number(n>>48n&0xffn),e[t+7]=Number(n>>56n&0xffn)):(e[t]=Number(n>>56n&0xffn),e[t+1]=Number(n>>48n&0xffn),e[t+2]=Number(n>>40n&0xffn),e[t+3]=Number(n>>32n&0xffn),e[t+4]=Number(n>>24n&0xffn),e[t+5]=Number(n>>16n&0xffn),e[t+6]=Number(n>>8n&0xffn),e[t+7]=Number(n&0xffn)),t+8}function readInt32(e,t,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),n==="LE"){const r=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24>>>0);return e[t+3]<=127?r:r-4294967296}else{const r=(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];return e[t]<=127?r:r-4294967296}}function readInt64(e,t,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");n=n.toUpperCase();let r=0n;if(n==="LE")return r=(r<<8n)+BigInt(e[t+7]),r=(r<<8n)+BigInt(e[t+6]),r=(r<<8n)+BigInt(e[t+5]),r=(r<<8n)+BigInt(e[t+4]),r=(r<<8n)+BigInt(e[t+3]),r=(r<<8n)+BigInt(e[t+2]),r=(r<<8n)+BigInt(e[t+1]),r=(r<<8n)+BigInt(e[t]),e[t+7]<=127?r:r-0x10000000000000000n;{let o=0n;return o=(o<<8n)+BigInt(e[t]),o=(o<<8n)+BigInt(e[t+1]),o=(o<<8n)+BigInt(e[t+2]),o=(o<<8n)+BigInt(e[t+3]),o=(o<<8n)+BigInt(e[t+4]),o=(o<<8n)+BigInt(e[t+5]),o=(o<<8n)+BigInt(e[t+6]),o=(o<<8n)+BigInt(e[t+7]),e[t]<=127?o:o-0x10000000000000000n}}function encodingLength$1(e){return e<OPS$7.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}function encode$i(e,t,n){const r=encodingLength$1(t);return r===1?writeUInt8(e,n,t):r===2?(writeUInt8(e,n,OPS$7.OP_PUSHDATA1),writeUInt8(e,n+1,t)):r===3?(writeUInt8(e,n,OPS$7.OP_PUSHDATA2),writeUInt16$1(e,n+1,t,"LE")):(writeUInt8(e,n,OPS$7.OP_PUSHDATA4),writeUInt32$2(e,n+1,t,"LE")),r}function decode$g(e,t){const n=readUInt8(e,t);let r,o;if(n<OPS$7.OP_PUSHDATA1)r=n,o=1;else if(n===OPS$7.OP_PUSHDATA1){if(t+2>e.length)return null;r=readUInt8(e,t+1),o=2}else if(n===OPS$7.OP_PUSHDATA2){if(t+3>e.length)return null;r=readUInt16$1(e,t+1,"LE"),o=3}else{if(t+5>e.length)return null;if(n!==OPS$7.OP_PUSHDATA4)throw new Error("Unexpected opcode");r=readUInt32$1(e,t+1,"LE"),o=5}return{opcode:n,number:r,size:o}}function scriptNumSize(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function encode$h(e){let t=Math.abs(e);const n=scriptNumSize(t),r=new Uint8Array(n),o=e<0;for(let c=0;c<n;++c)writeUInt8(r,c,t&255),t>>=8;return r[n-1]&128?writeUInt8(r,n-1,o?128:0):o&&(r[n-1]|=128),r}var store$1;function getGlobalConfig$1(e){return{lang:e?.lang??store$1?.lang,message:e?.message,abortEarly:e?.abortEarly??store$1?.abortEarly,abortPipeEarly:e?.abortPipeEarly??store$1?.abortPipeEarly}}var store2$1;function getGlobalMessage$1(e){return store2$1?.get(e)}var store3$1;function getSchemaMessage$1(e){return store3$1?.get(e)}var store4$1;function getSpecificMessage$1(e,t){return store4$1?.get(e)?.get(t)}function _stringify$1(e){const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function _addIssue$1(e,t,n,r,o){const c=o&&"input"in o?o.input:n.value,l=o?.expected??e.expects??null,x=o?.received??_stringify$1(c),f={kind:e.kind,type:e.type,input:c,expected:l,received:x,message:`Invalid ${t}: ${l?`Expected ${l} but r`:"R"}eceived ${x}`,requirement:e.requirement,path:o?.path,issues:o?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},m=e.kind==="schema",E=o?.message??e.message??getSpecificMessage$1(e.reference,f.lang)??(m?getSchemaMessage$1(f.lang):null)??r.message??getGlobalMessage$1(f.lang);E&&(f.message=typeof E=="function"?E(f):E),m&&(n.typed=!1),n.issues?n.issues.push(f):n.issues=[f]}function _joinExpects(e,t){const n=[...new Set(e)];return n.length>1?`(${n.join(` ${t} `)})`:n[0]??"never"}var ValiError$1=class extends Error{issues;constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function everyItem(e,t){return{kind:"validation",type:"every_item",reference:everyItem,async:!1,expects:null,requirement:e,message:t,_run(n,r){return n.typed&&!n.value.every(this.requirement)&&_addIssue$1(this,"item",n,r),n}}}function integer$1(e){return{kind:"validation",type:"integer",reference:integer$1,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(t,n){return t.typed&&!this.requirement(t.value)&&_addIssue$1(this,"integer",t,n),t}}}function length$1(e,t){return{kind:"validation",type:"length",reference:length$1,async:!1,expects:`${e}`,requirement:e,message:t,_run(n,r){return n.typed&&n.value.length!==this.requirement&&_addIssue$1(this,"length",n,r,{received:`${n.value.length}`}),n}}}function maxValue$1(e,t){return{kind:"validation",type:"max_value",reference:maxValue$1,async:!1,expects:`<=${e instanceof Date?e.toJSON():_stringify$1(e)}`,requirement:e,message:t,_run(n,r){return n.typed&&n.value>this.requirement&&_addIssue$1(this,"value",n,r,{received:n.value instanceof Date?n.value.toJSON():_stringify$1(n.value)}),n}}}function minValue$1(e,t){return{kind:"validation",type:"min_value",reference:minValue$1,async:!1,expects:`>=${e instanceof Date?e.toJSON():_stringify$1(e)}`,requirement:e,message:t,_run(n,r){return n.typed&&n.value<this.requirement&&_addIssue$1(this,"value",n,r,{received:n.value instanceof Date?n.value.toJSON():_stringify$1(n.value)}),n}}}function regex$1(e,t){return{kind:"validation",type:"regex",reference:regex$1,async:!1,expects:`${e}`,requirement:e,message:t,_run(n,r){return n.typed&&!this.requirement.test(n.value)&&_addIssue$1(this,"format",n,r),n}}}function getDefault$1(e,t,n){return typeof e.default=="function"?e.default(t,n):e.default}function is(e,t){return!e._run({typed:!1,value:t},{abortEarly:!0}).issues}function any(){return{kind:"schema",type:"any",reference:any,expects:"any",async:!1,_run(e){return e.typed=!0,e}}}function array(e,t){return{kind:"schema",type:"array",reference:array,expects:"Array",async:!1,item:e,message:t,_run(n,r){const o=n.value;if(Array.isArray(o)){n.typed=!0,n.value=[];for(let c=0;c<o.length;c++){const l=o[c],x=this.item._run({typed:!1,value:l},r);if(x.issues){const f={type:"array",origin:"value",input:o,key:c,value:l};for(const m of x.issues)m.path?m.path.unshift(f):m.path=[f],n.issues?.push(m);if(n.issues||(n.issues=x.issues),r.abortEarly){n.typed=!1;break}}x.typed||(n.typed=!1),n.value.push(x.value)}}else _addIssue$1(this,"type",n,r);return n}}}function bigint(e){return{kind:"schema",type:"bigint",reference:bigint,expects:"bigint",async:!1,message:e,_run(t,n){return typeof t.value=="bigint"?t.typed=!0:_addIssue$1(this,"type",t,n),t}}}function custom(e,t){return{kind:"schema",type:"custom",reference:custom,expects:"unknown",async:!1,check:e,message:t,_run(n,r){return this.check(n.value)?n.typed=!0:_addIssue$1(this,"type",n,r),n}}}function instance$1(e,t){return{kind:"schema",type:"instance",reference:instance$1,expects:e.name,async:!1,class:e,message:t,_run(n,r){return n.value instanceof this.class?n.typed=!0:_addIssue$1(this,"type",n,r),n}}}function nullable(e,...t){const n={kind:"schema",type:"nullable",reference:nullable,expects:`(${e.expects} | null)`,async:!1,wrapped:e,_run(r,o){return r.value===null&&("default"in this&&(r.value=getDefault$1(this,r,o)),r.value===null)?(r.typed=!0,r):this.wrapped._run(r,o)}};return 0 in t&&(n.default=t[0]),n}function nullish(e,...t){const n={kind:"schema",type:"nullish",reference:nullish,expects:`(${e.expects} | null | undefined)`,async:!1,wrapped:e,_run(r,o){return(r.value===null||r.value===void 0)&&("default"in this&&(r.value=getDefault$1(this,r,o)),r.value===null||r.value===void 0)?(r.typed=!0,r):this.wrapped._run(r,o)}};return 0 in t&&(n.default=t[0]),n}function number$1(e){return{kind:"schema",type:"number",reference:number$1,expects:"number",async:!1,message:e,_run(t,n){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:_addIssue$1(this,"type",t,n),t}}}function object$1(e,t){return{kind:"schema",type:"object",reference:object$1,expects:"Object",async:!1,entries:e,message:t,_run(n,r){const o=n.value;if(o&&typeof o=="object"){n.typed=!0,n.value={};for(const c in this.entries){const l=o[c],x=this.entries[c]._run({typed:!1,value:l},r);if(x.issues){const f={type:"object",origin:"value",input:o,key:c,value:l};for(const m of x.issues)m.path?m.path.unshift(f):m.path=[f],n.issues?.push(m);if(n.issues||(n.issues=x.issues),r.abortEarly){n.typed=!1;break}}x.typed||(n.typed=!1),(x.value!==void 0||c in o)&&(n.value[c]=x.value)}}else _addIssue$1(this,"type",n,r);return n}}}function optional$1(e,...t){const n={kind:"schema",type:"optional",reference:optional$1,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,_run(r,o){return r.value===void 0&&("default"in this&&(r.value=getDefault$1(this,r,o)),r.value===void 0)?(r.typed=!0,r):this.wrapped._run(r,o)}};return 0 in t&&(n.default=t[0]),n}function string$1(e){return{kind:"schema",type:"string",reference:string$1,expects:"string",async:!1,message:e,_run(t,n){return typeof t.value=="string"?t.typed=!0:_addIssue$1(this,"type",t,n),t}}}function tuple(e,t){return{kind:"schema",type:"tuple",reference:tuple,expects:"Array",async:!1,items:e,message:t,_run(n,r){const o=n.value;if(Array.isArray(o)){n.typed=!0,n.value=[];for(let c=0;c<this.items.length;c++){const l=o[c],x=this.items[c]._run({typed:!1,value:l},r);if(x.issues){const f={type:"array",origin:"value",input:o,key:c,value:l};for(const m of x.issues)m.path?m.path.unshift(f):m.path=[f],n.issues?.push(m);if(n.issues||(n.issues=x.issues),r.abortEarly){n.typed=!1;break}}x.typed||(n.typed=!1),n.value.push(x.value)}}else _addIssue$1(this,"type",n,r);return n}}}function _subIssues$1(e){let t;if(e)for(const n of e)t?t.push(...n.issues):t=n.issues;return t}function union$1(e,t){return{kind:"schema",type:"union",reference:union$1,expects:_joinExpects(e.map(n=>n.expects),"|"),async:!1,options:e,message:t,_run(n,r){let o,c,l;for(const x of this.options){const f=x._run({typed:!1,value:n.value},r);if(f.typed)if(f.issues)c?c.push(f):c=[f];else{o=f;break}else l?l.push(f):l=[f]}if(o)return o;if(c){if(c.length===1)return c[0];_addIssue$1(this,"type",n,r,{issues:_subIssues$1(c)}),n.typed=!0}else{if(l?.length===1)return l[0];_addIssue$1(this,"type",n,r,{issues:_subIssues$1(l)})}return n}}}function parse$1(e,t,n){const r=e._run({typed:!1,value:t},getGlobalConfig$1(n));if(r.issues)throw new ValiError$1(r.issues);return r.value}function partial(e,t){const n={};for(const r in e.entries)n[r]=optional$1(e.entries[r]);return{...e,entries:n}}function pipe$1(...e){return{...e[0],pipe:e,_run(t,n){for(const r of e)if(r.kind!=="metadata"){if(t.issues&&(r.kind==="schema"||r.kind==="transformation")){t.typed=!1;break}(!t.issues||!n.abortEarly&&!n.abortPipeEarly)&&(t=r._run(t,n))}return t}}}const ZERO32=new Uint8Array(32),EC_P=fromHex("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),NBufferSchemaFactory=e=>pipe$1(instance$1(Uint8Array),length$1(e));function stacksEqual(e,t){return e.length!==t.length?!1:e.every((n,r)=>compare(n,t[r])===0)}function isPoint(e){if(!(e instanceof Uint8Array)||e.length<33)return!1;const t=e[0],n=e.slice(1,33);if(compare(ZERO32,n)===0||compare(n,EC_P)>=0)return!1;if((t===2||t===3)&&e.length===33)return!0;const r=e.slice(33);return compare(ZERO32,r)===0||compare(r,EC_P)>=0?!1:t===4&&e.length===65}const TAPLEAF_VERSION_MASK=254;function isTapleaf(e){return!e||!("output"in e)||!(e.output instanceof Uint8Array)?!1:e.version!==void 0?(e.version&TAPLEAF_VERSION_MASK)===e.version:!0}function isTaptree(e){return Array.isArray(e)?e.length!==2?!1:e.every(t=>isTaptree(t)):isTapleaf(e)}const Buffer256bitSchema=NBufferSchemaFactory(32),Hash160bitSchema=NBufferSchemaFactory(20),Hash256bitSchema=NBufferSchemaFactory(32),BufferSchema=instance$1(Uint8Array);pipe$1(string$1(),regex$1(/^([0-9a-f]{2})+$/i));const UInt8Schema=pipe$1(number$1(),integer$1(),minValue$1(0),maxValue$1(255)),UInt32Schema=pipe$1(number$1(),integer$1(),minValue$1(0),maxValue$1(4294967295)),SatoshiSchema=pipe$1(bigint(),minValue$1(0n),maxValue$1(0x7fffffffffffffffn)),NullablePartial=e=>object$1(Object.entries(e).reduce((t,n)=>({...t,[n[0]]:nullish(n[1])}),{})),ZERO$1=new Uint8Array(1);function toDER(e){let t=0;for(;e[t]===0;)++t;return t===e.length?ZERO$1:(e=e.slice(t),e[0]&128?concat$1([ZERO$1,e]):e)}function fromDER(e){e[0]===0&&(e=e.slice(1));const t=new Uint8Array(32),n=Math.max(0,32-e.length);return t.set(e,n),t}function decode$f(e){const t=readUInt8(e,e.length-1);if(!isDefinedHashType(t))throw new Error("Invalid hashType "+t);const n=decode$h(e.subarray(0,-1)),r=fromDER(n.r),o=fromDER(n.s);return{signature:concat$1([r,o]),hashType:t}}function encode$g(e,t){if(parse$1(object$1({signature:NBufferSchemaFactory(64),hashType:UInt8Schema}),{signature:e,hashType:t}),!isDefinedHashType(t))throw new Error("Invalid hashType "+t);const n=new Uint8Array(1);writeUInt8(n,0,t);const r=toDER(e.slice(0,32)),o=toDER(e.slice(32,64));return concat$1([encode$j(r,o),n])}const scriptSignature=Object.freeze(Object.defineProperty({__proto__:null,decode:decode$f,encode:encode$g},Symbol.toStringTag,{value:"Module"})),OP_INT_BASE$1=OPS$7.OP_RESERVED,StackSchema=array(union$1([instance$1(Uint8Array),number$1()]));function isOPInt(e){return is(number$1(),e)&&(e===OPS$7.OP_0||e>=OPS$7.OP_1&&e<=OPS$7.OP_16||e===OPS$7.OP_1NEGATE)}function isPushOnlyChunk(e){return is(BufferSchema,e)||isOPInt(e)}function isPushOnly(e){return is(pipe$1(any(),everyItem(isPushOnlyChunk)),e)}function countNonPushOnlyOPs(e){return e.length-e.filter(isPushOnlyChunk).length}function asMinimalOP(e){if(e.length===0)return OPS$7.OP_0;if(e.length===1){if(e[0]>=1&&e[0]<=16)return OP_INT_BASE$1+e[0];if(e[0]===129)return OPS$7.OP_1NEGATE}}function chunksIsBuffer(e){return e instanceof Uint8Array}function chunksIsArray(e){return is(StackSchema,e)}function singleChunkIsBuffer(e){return e instanceof Uint8Array}function compile(e){if(chunksIsBuffer(e))return e;parse$1(StackSchema,e);const t=e.reduce((o,c)=>singleChunkIsBuffer(c)?c.length===1&&asMinimalOP(c)!==void 0?o+1:o+encodingLength$1(c.length)+c.length:o+1,0),n=new Uint8Array(t);let r=0;if(e.forEach(o=>{if(singleChunkIsBuffer(o)){const c=asMinimalOP(o);if(c!==void 0){writeUInt8(n,r,c),r+=1;return}r+=encode$i(n,o.length,r),n.set(o,r),r+=o.length}else writeUInt8(n,r,o),r+=1}),r!==n.length)throw new Error("Could not decode chunks");return n}function decompile(e){if(chunksIsArray(e))return e;parse$1(BufferSchema,e);const t=[];let n=0;for(;n<e.length;){const r=e[n];if(r>OPS$7.OP_0&&r<=OPS$7.OP_PUSHDATA4){const o=decode$g(e,n);if(o===null||(n+=o.size,n+o.number>e.length))return null;const c=e.slice(n,n+o.number);n+=o.number;const l=asMinimalOP(c);l!==void 0?t.push(l):t.push(c)}else t.push(r),n+=1}return t}function toASM(e){if(chunksIsBuffer(e)&&(e=decompile(e)),!e)throw new Error("Could not convert invalid chunks to ASM");return e.map(t=>{if(singleChunkIsBuffer(t)){const n=asMinimalOP(t);if(n===void 0)return toHex(t);t=n}return OPS$7[t]}).join(" ")}function toStack(e){return e=decompile(e),parse$1(custom(isPushOnly),e),e.map(t=>singleChunkIsBuffer(t)?t:t===OPS$7.OP_0?new Uint8Array(0):encode$h(t-OP_INT_BASE$1))}function isCanonicalPubKey(e){return isPoint(e)}function isDefinedHashType(e){const t=e&-129;return t>0&&t<4}function isCanonicalScriptSignature(e){return!(e instanceof Uint8Array)||!isDefinedHashType(e[e.length-1])?!1:check$d(e.slice(0,-1))}const signature=scriptSignature;function prop(e,t,n){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){const r=n.call(this);return this[t]=r,r},set(r){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:r,writable:!0})}})}function value(e){let t;return()=>(t!==void 0||(t=e()),t)}const OPS$6=OPS$7,OP_INT_BASE=OPS$6.OP_RESERVED;function p2ms(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&e.m!==void 0)&&!e.signatures)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{});function n(f){return isCanonicalScriptSignature(f)||(t.allowIncomplete&&f===OPS$6.OP_0)!==void 0}parse$1(partial(object$1({network:object$1({}),m:number$1(),n:number$1(),output:BufferSchema,pubkeys:array(custom(isPoint),"Received invalid pubkey"),signatures:array(custom(n),"Expected signature to be of type isAcceptableSignature"),input:BufferSchema})),e);const o={network:e.network||bitcoin$1};let c=[],l=!1;function x(f){l||(l=!0,c=decompile(f),o.m=c[0]-OP_INT_BASE,o.n=c[c.length-2]-OP_INT_BASE,o.pubkeys=c.slice(1,-2))}if(prop(o,"output",()=>{if(e.m&&o.n&&e.pubkeys)return compile([].concat(OP_INT_BASE+e.m,e.pubkeys,OP_INT_BASE+o.n,OPS$6.OP_CHECKMULTISIG))}),prop(o,"m",()=>{if(o.output)return x(o.output),o.m}),prop(o,"n",()=>{if(o.pubkeys)return o.pubkeys.length}),prop(o,"pubkeys",()=>{if(e.output)return x(e.output),o.pubkeys}),prop(o,"signatures",()=>{if(e.input)return decompile(e.input).slice(1)}),prop(o,"input",()=>{if(e.signatures)return compile([OPS$6.OP_0].concat(e.signatures))}),prop(o,"witness",()=>{if(o.input)return[]}),prop(o,"name",()=>{if(!(!o.m||!o.n))return`p2ms(${o.m} of ${o.n})`}),t.validate){if(e.output){if(x(e.output),parse$1(number$1(),c[0],{message:"Output is invalid"}),parse$1(number$1(),c[c.length-2],{message:"Output is invalid"}),c[c.length-1]!==OPS$6.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(o.m<=0||o.n>16||o.m>o.n||o.n!==c.length-3)throw new TypeError("Output is invalid");if(!o.pubkeys.every(f=>isPoint(f)))throw new TypeError("Output is invalid");if(e.m!==void 0&&e.m!==o.m)throw new TypeError("m mismatch");if(e.n!==void 0&&e.n!==o.n)throw new TypeError("n mismatch");if(e.pubkeys&&!stacksEqual(e.pubkeys,o.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(e.n!==void 0&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(o.n=e.pubkeys.length,o.n<o.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<o.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>o.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==OPS$6.OP_0)throw new TypeError("Input is invalid");if(o.signatures.length===0||!o.signatures.every(n))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!stacksEqual(e.signatures,o.signatures))throw new TypeError("Signature mismatch");if(e.m!==void 0&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(o,e)}const OPS$5=OPS$7;function p2pk(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),output:BufferSchema,pubkey:custom(isPoint,"invalid pubkey"),signature:custom(isCanonicalScriptSignature,"Expected signature to be of type isCanonicalScriptSignature"),input:BufferSchema})),e);const n=value(()=>decompile(e.input)),o={name:"p2pk",network:e.network||bitcoin$1};if(prop(o,"output",()=>{if(e.pubkey)return compile([e.pubkey,OPS$5.OP_CHECKSIG])}),prop(o,"pubkey",()=>{if(e.output)return e.output.slice(1,-1)}),prop(o,"signature",()=>{if(e.input)return n()[0]}),prop(o,"input",()=>{if(e.signature)return compile([e.signature])}),prop(o,"witness",()=>{if(o.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==OPS$5.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!isPoint(o.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&compare(e.pubkey,o.pubkey)!==0)throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&compare(e.input,o.input)!==0)throw new TypeError("Signature mismatch");if(e.input){if(n().length!==1)throw new TypeError("Input is invalid");if(!isCanonicalScriptSignature(o.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(o,e)}const Rho160=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Id160=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),Pi160=Id160.map(e=>(9*e+5)%16),idxLR=(()=>{const n=[[Id160],[Pi160]];for(let r=0;r<4;r++)for(let o of n)o.push(o[r].map(c=>Rho160[c]));return n})(),idxL=idxLR[0],idxR=idxLR[1],shifts160=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),shiftsL160=idxL.map((e,t)=>e.map(n=>shifts160[t][n])),shiftsR160=idxR.map((e,t)=>e.map(n=>shifts160[t][n])),Kl160=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Kr160=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ripemd_f(e,t,n,r){return e===0?t^n^r:e===1?t&n|~t&r:e===2?(t|~n)^r:e===3?t&r|n&~r:t^(n|~r)}const BUF_160=new Uint32Array(16);class RIPEMD160 extends HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:n,h2:r,h3:o,h4:c}=this;return[t,n,r,o,c]}set(t,n,r,o,c){this.h0=t|0,this.h1=n|0,this.h2=r|0,this.h3=o|0,this.h4=c|0}process(t,n){for(let w=0;w<16;w++,n+=4)BUF_160[w]=t.getUint32(n,!0);let r=this.h0|0,o=r,c=this.h1|0,l=c,x=this.h2|0,f=x,m=this.h3|0,E=m,g=this.h4|0,y=g;for(let w=0;w<5;w++){const v=4-w,_=Kl160[w],F=Kr160[w],H=idxL[w],Y=idxR[w],T=shiftsL160[w],L=shiftsR160[w];for(let N=0;N<16;N++){const I=rotl$1(r+ripemd_f(w,c,x,m)+BUF_160[H[N]]+_,T[N])+g|0;r=g,g=m,m=rotl$1(x,10)|0,x=c,c=I}for(let N=0;N<16;N++){const I=rotl$1(o+ripemd_f(v,l,f,E)+BUF_160[Y[N]]+F,L[N])+y|0;o=y,y=E,E=rotl$1(f,10)|0,f=l,l=I}}this.set(this.h1+x+E|0,this.h2+m+y|0,this.h3+g+o|0,this.h4+r+l|0,this.h0+c+f|0)}roundClean(){clean(BUF_160)}destroy(){this.destroyed=!0,clean(this.buffer),this.set(0,0,0,0,0)}}const ripemd160$1=createHasher(()=>new RIPEMD160),ripemd160=ripemd160$1;function hash160(e){return ripemd160(sha256(e))}function hash256(e){return sha256(sha256(e))}const TAGGED_HASH_PREFIXES={"BIP0340/challenge":Uint8Array.from([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":Uint8Array.from([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":Uint8Array.from([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:Uint8Array.from([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:Uint8Array.from([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:Uint8Array.from([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:Uint8Array.from([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":Uint8Array.from([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":Uint8Array.from([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])};function taggedHash(e,t){return sha256(concat$1([TAGGED_HASH_PREFIXES[e],t]))}function base(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let m=0;m<t.length;m++)t[m]=255;for(let m=0;m<e.length;m++){const E=e.charAt(m),g=E.charCodeAt(0);if(t[g]!==255)throw new TypeError(E+" is ambiguous");t[g]=m}const n=e.length,r=e.charAt(0),o=Math.log(n)/Math.log(256),c=Math.log(256)/Math.log(n);function l(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";let E=0,g=0,y=0;const w=m.length;for(;y!==w&&m[y]===0;)y++,E++;const v=(w-y)*c+1>>>0,_=new Uint8Array(v);for(;y!==w;){let Y=m[y],T=0;for(let L=v-1;(Y!==0||T<g)&&L!==-1;L--,T++)Y+=256*_[L]>>>0,_[L]=Y%n>>>0,Y=Y/n>>>0;if(Y!==0)throw new Error("Non-zero carry");g=T,y++}let F=v-g;for(;F!==v&&_[F]===0;)F++;let H=r.repeat(E);for(;F<v;++F)H+=e.charAt(_[F]);return H}function x(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;let E=0,g=0,y=0;for(;m[E]===r;)g++,E++;const w=(m.length-E)*o+1>>>0,v=new Uint8Array(w);for(;E<m.length;){const Y=m.charCodeAt(E);if(Y>255)return;let T=t[Y];if(T===255)return;let L=0;for(let N=w-1;(T!==0||L<y)&&N!==-1;N--,L++)T+=n*v[N]>>>0,v[N]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");y=L,E++}let _=w-y;for(;_!==w&&v[_]===0;)_++;const F=new Uint8Array(g+(w-_));let H=g;for(;_!==w;)F[H++]=v[_++];return F}function f(m){const E=x(m);if(E)return E;throw new Error("Non-base"+n+" character")}return{encode:l,decodeUnsafe:x,decode:f}}var ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const base58=base(ALPHABET);function bs58checkBase(e){function t(c){var l=Uint8Array.from(c),x=e(l),f=l.length+4,m=new Uint8Array(f);return m.set(l,0),m.set(x.subarray(0,4),l.length),base58.encode(m)}function n(c){var l=c.slice(0,-4),x=c.slice(-4),f=e(l);if(!(x[0]^f[0]|x[1]^f[1]|x[2]^f[2]|x[3]^f[3]))return l}function r(c){var l=base58.decodeUnsafe(c);if(l!=null)return n(l)}function o(c){var l=base58.decode(c),x=n(l);if(x==null)throw new Error("Invalid checksum");return x}return{encode:t,decode:o,decodeUnsafe:r}}function sha256x2(e){return sha256(sha256(e))}const bs58Check=bs58checkBase(sha256x2),OPS$4=OPS$7;function p2pkh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),address:string$1(),hash:Hash160bitSchema,output:NBufferSchemaFactory(25),pubkey:custom(isPoint),signature:custom(isCanonicalScriptSignature),input:BufferSchema})),e);const n=value(()=>{const l=bs58Check.decode(e.address),x=readUInt8(l,0),f=l.slice(1);return{version:x,hash:f}}),r=value(()=>decompile(e.input)),o=e.network||bitcoin$1,c={name:"p2pkh",network:o};if(prop(c,"address",()=>{if(!c.hash)return;const l=new Uint8Array(21);return writeUInt8(l,0,o.pubKeyHash),l.set(c.hash,1),bs58Check.encode(l)}),prop(c,"hash",()=>{if(e.output)return e.output.slice(3,23);if(e.address)return n().hash;if(e.pubkey||c.pubkey)return hash160(e.pubkey||c.pubkey)}),prop(c,"output",()=>{if(c.hash)return compile([OPS$4.OP_DUP,OPS$4.OP_HASH160,c.hash,OPS$4.OP_EQUALVERIFY,OPS$4.OP_CHECKSIG])}),prop(c,"pubkey",()=>{if(e.input)return r()[1]}),prop(c,"signature",()=>{if(e.input)return r()[0]}),prop(c,"input",()=>{if(e.pubkey&&e.signature)return compile([e.signature,e.pubkey])}),prop(c,"witness",()=>{if(c.input)return[]}),t.validate){let l=Uint8Array.from([]);if(e.address){if(n().version!==o.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(n().hash.length!==20)throw new TypeError("Invalid address");l=n().hash}if(e.hash){if(l.length>0&&compare(l,e.hash)!==0)throw new TypeError("Hash mismatch");l=e.hash}if(e.output){if(e.output.length!==25||e.output[0]!==OPS$4.OP_DUP||e.output[1]!==OPS$4.OP_HASH160||e.output[2]!==20||e.output[23]!==OPS$4.OP_EQUALVERIFY||e.output[24]!==OPS$4.OP_CHECKSIG)throw new TypeError("Output is invalid");const x=e.output.slice(3,23);if(l.length>0&&compare(l,x)!==0)throw new TypeError("Hash mismatch");l=x}if(e.pubkey){const x=hash160(e.pubkey);if(l.length>0&&compare(l,x)!==0)throw new TypeError("Hash mismatch");l=x}if(e.input){const x=r();if(x.length!==2)throw new TypeError("Input is invalid");if(!isCanonicalScriptSignature(x[0]))throw new TypeError("Input has invalid signature");if(!isPoint(x[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&compare(e.signature,x[0])!==0)throw new TypeError("Signature mismatch");if(e.pubkey&&compare(e.pubkey,x[1])!==0)throw new TypeError("Pubkey mismatch");const f=hash160(x[1]);if(l.length>0&&compare(l,f)!==0)throw new TypeError("Hash mismatch")}}return Object.assign(c,e)}const OPS$3=OPS$7;function p2sh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),address:string$1(),hash:NBufferSchemaFactory(20),output:NBufferSchemaFactory(23),redeem:partial(object$1({network:object$1({}),output:BufferSchema,input:BufferSchema,witness:array(BufferSchema)})),input:BufferSchema,witness:array(BufferSchema)})),e);let n=e.network;n||(n=e.redeem&&e.redeem.network||bitcoin$1);const r={network:n},o=value(()=>{const x=bs58Check.decode(e.address),f=readUInt8(x,0),m=x.slice(1);return{version:f,hash:m}}),c=value(()=>decompile(e.input)),l=value(()=>{const x=c(),f=x[x.length-1];return{network:n,output:f===OPS$3.OP_FALSE?Uint8Array.from([]):f,input:compile(x.slice(0,-1)),witness:e.witness||[]}});if(prop(r,"address",()=>{if(!r.hash)return;const x=new Uint8Array(21);return writeUInt8(x,0,r.network.scriptHash),x.set(r.hash,1),bs58Check.encode(x)}),prop(r,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return o().hash;if(r.redeem&&r.redeem.output)return hash160(r.redeem.output)}),prop(r,"output",()=>{if(r.hash)return compile([OPS$3.OP_HASH160,r.hash,OPS$3.OP_EQUAL])}),prop(r,"redeem",()=>{if(e.input)return l()}),prop(r,"input",()=>{if(!(!e.redeem||!e.redeem.input||!e.redeem.output))return compile([].concat(decompile(e.redeem.input),e.redeem.output))}),prop(r,"witness",()=>{if(r.redeem&&r.redeem.witness)return r.redeem.witness;if(r.input)return[]}),prop(r,"name",()=>{const x=["p2sh"];return r.redeem!==void 0&&r.redeem.name!==void 0&&x.push(r.redeem.name),x.join("-")}),t.validate){let x=Uint8Array.from([]);if(e.address){if(o().version!==n.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(o().hash.length!==20)throw new TypeError("Invalid address");x=o().hash}if(e.hash){if(x.length>0&&compare(x,e.hash)!==0)throw new TypeError("Hash mismatch");x=e.hash}if(e.output){if(e.output.length!==23||e.output[0]!==OPS$3.OP_HASH160||e.output[1]!==20||e.output[22]!==OPS$3.OP_EQUAL)throw new TypeError("Output is invalid");const m=e.output.slice(2,22);if(x.length>0&&compare(x,m)!==0)throw new TypeError("Hash mismatch");x=m}const f=m=>{if(m.output){const E=decompile(m.output);if(!E||E.length<1)throw new TypeError("Redeem.output too short");if(m.output.byteLength>520)throw new TypeError("Redeem.output unspendable if larger than 520 bytes");if(countNonPushOnlyOPs(E)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const g=hash160(m.output);if(x.length>0&&compare(x,g)!==0)throw new TypeError("Hash mismatch");x=g}if(m.input){const E=m.input.length>0,g=m.witness&&m.witness.length>0;if(!E&&!g)throw new TypeError("Empty input");if(E&&g)throw new TypeError("Input and witness provided");if(E){const y=decompile(m.input);if(!isPushOnly(y))throw new TypeError("Non push-only scriptSig")}}};if(e.input){const m=c();if(!m||m.length<1)throw new TypeError("Input too short");if(!(l().output instanceof Uint8Array))throw new TypeError("Input is invalid");f(l())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==n)throw new TypeError("Network mismatch");if(e.input){const m=l();if(e.redeem.output&&compare(e.redeem.output,m.output)!==0)throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&compare(e.redeem.input,m.input)!==0)throw new TypeError("Redeem.input mismatch")}f(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!stacksEqual(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(r,e)}var dist$1={},hasRequiredDist$1;function requireDist$1(){if(hasRequiredDist$1)return dist$1;hasRequiredDist$1=1,Object.defineProperty(dist$1,"__esModule",{value:!0}),dist$1.bech32m=dist$1.bech32=void 0;const e="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={};for(let m=0;m<e.length;m++){const E=e.charAt(m);t[E]=m}function n(m){const E=m>>25;return(m&33554431)<<5^-(E>>0&1)&996825010^-(E>>1&1)&642813549^-(E>>2&1)&513874426^-(E>>3&1)&1027748829^-(E>>4&1)&705979059}function r(m){let E=1;for(let g=0;g<m.length;++g){const y=m.charCodeAt(g);if(y<33||y>126)return"Invalid prefix ("+m+")";E=n(E)^y>>5}E=n(E);for(let g=0;g<m.length;++g){const y=m.charCodeAt(g);E=n(E)^y&31}return E}function o(m,E,g,y){let w=0,v=0;const _=(1<<g)-1,F=[];for(let H=0;H<m.length;++H)for(w=w<<E|m[H],v+=E;v>=g;)v-=g,F.push(w>>v&_);if(y)v>0&&F.push(w<<g-v&_);else{if(v>=E)return"Excess padding";if(w<<g-v&_)return"Non-zero padding"}return F}function c(m){return o(m,8,5,!0)}function l(m){const E=o(m,5,8,!1);if(Array.isArray(E))return E}function x(m){const E=o(m,5,8,!1);if(Array.isArray(E))return E;throw new Error(E)}function f(m){let E;m==="bech32"?E=1:E=734539939;function g(_,F,H){if(H=H||90,_.length+7+F.length>H)throw new TypeError("Exceeds length limit");_=_.toLowerCase();let Y=r(_);if(typeof Y=="string")throw new Error(Y);let T=_+"1";for(let L=0;L<F.length;++L){const N=F[L];if(N>>5!==0)throw new Error("Non 5-bit word");Y=n(Y)^N,T+=e.charAt(N)}for(let L=0;L<6;++L)Y=n(Y);Y^=E;for(let L=0;L<6;++L){const N=Y>>(5-L)*5&31;T+=e.charAt(N)}return T}function y(_,F){if(F=F||90,_.length<8)return _+" too short";if(_.length>F)return"Exceeds length limit";const H=_.toLowerCase(),Y=_.toUpperCase();if(_!==H&&_!==Y)return"Mixed-case string "+_;_=H;const T=_.lastIndexOf("1");if(T===-1)return"No separator character for "+_;if(T===0)return"Missing prefix for "+_;const L=_.slice(0,T),N=_.slice(T+1);if(N.length<6)return"Data too short";let I=r(L);if(typeof I=="string")return I;const U=[];for(let W=0;W<N.length;++W){const O=N.charAt(W),Z=t[O];if(Z===void 0)return"Unknown character "+O;I=n(I)^Z,!(W+6>=N.length)&&U.push(Z)}return I!==E?"Invalid checksum for "+_:{prefix:L,words:U}}function w(_,F){const H=y(_,F);if(typeof H=="object")return H}function v(_,F){const H=y(_,F);if(typeof H=="object")return H;throw new Error(H)}return{decodeUnsafe:w,decode:v,encode:g,toWords:c,fromWordsUnsafe:l,fromWords:x}}return dist$1.bech32=f("bech32"),dist$1.bech32m=f("bech32m"),dist$1}var distExports$1=requireDist$1();const OPS$2=OPS$7,EMPTY_BUFFER$2=new Uint8Array(0);function p2wpkh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({address:string$1(),hash:NBufferSchemaFactory(20),input:NBufferSchemaFactory(0),network:object$1({}),output:NBufferSchemaFactory(22),pubkey:custom(isPoint,"Not a valid pubkey"),signature:custom(isCanonicalScriptSignature),witness:array(BufferSchema)})),e);const n=value(()=>{const c=distExports$1.bech32.decode(e.address),l=c.words.shift(),x=distExports$1.bech32.fromWords(c.words);return{version:l,prefix:c.prefix,data:Uint8Array.from(x)}}),r=e.network||bitcoin$1,o={name:"p2wpkh",network:r};if(prop(o,"address",()=>{if(!o.hash)return;const c=distExports$1.bech32.toWords(o.hash);return c.unshift(0),distExports$1.bech32.encode(r.bech32,c)}),prop(o,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return n().data;if(e.pubkey||o.pubkey)return hash160(e.pubkey||o.pubkey)}),prop(o,"output",()=>{if(o.hash)return compile([OPS$2.OP_0,o.hash])}),prop(o,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.witness)return e.witness[1]}),prop(o,"signature",()=>{if(e.witness)return e.witness[0]}),prop(o,"input",()=>{if(o.witness)return EMPTY_BUFFER$2}),prop(o,"witness",()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]}),t.validate){let c=Uint8Array.from([]);if(e.address){if(r&&r.bech32!==n().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(n().version!==0)throw new TypeError("Invalid address version");if(n().data.length!==20)throw new TypeError("Invalid address data");c=n().data}if(e.hash){if(c.length>0&&compare(c,e.hash)!==0)throw new TypeError("Hash mismatch");c=e.hash}if(e.output){if(e.output.length!==22||e.output[0]!==OPS$2.OP_0||e.output[1]!==20)throw new TypeError("Output is invalid");if(c.length>0&&compare(c,e.output.slice(2))!==0)throw new TypeError("Hash mismatch");c=e.output.slice(2)}if(e.pubkey){const l=hash160(e.pubkey);if(c.length>0&&compare(c,l)!==0)throw new TypeError("Hash mismatch");if(c=l,!isPoint(e.pubkey)||e.pubkey.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(e.witness.length!==2)throw new TypeError("Witness is invalid");if(!isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!isPoint(e.witness[1])||e.witness[1].length!==33)throw new TypeError("Witness has invalid pubkey");if(e.signature&&compare(e.signature,e.witness[0])!==0)throw new TypeError("Signature mismatch");if(e.pubkey&&compare(e.pubkey,e.witness[1])!==0)throw new TypeError("Pubkey mismatch");const l=hash160(e.witness[1]);if(c.length>0&&compare(c,l)!==0)throw new TypeError("Hash mismatch")}}return Object.assign(o,e)}const OPS$1=OPS$7,EMPTY_BUFFER$1=new Uint8Array(0);function chunkHasUncompressedPubkey(e){return!!(e instanceof Uint8Array&&e.length===65&&e[0]===4&&isPoint(e))}function p2wsh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(NullablePartial({network:object$1({}),address:string$1(),hash:Buffer256bitSchema,output:NBufferSchemaFactory(34),redeem:NullablePartial({input:BufferSchema,network:object$1({}),output:BufferSchema,witness:array(BufferSchema)}),input:NBufferSchemaFactory(0),witness:array(BufferSchema)}),e);const n=value(()=>{const l=distExports$1.bech32.decode(e.address),x=l.words.shift(),f=distExports$1.bech32.fromWords(l.words);return{version:x,prefix:l.prefix,data:Uint8Array.from(f)}}),r=value(()=>decompile(e.redeem.input));let o=e.network;o||(o=e.redeem&&e.redeem.network||bitcoin$1);const c={network:o};if(prop(c,"address",()=>{if(!c.hash)return;const l=distExports$1.bech32.toWords(c.hash);return l.unshift(0),distExports$1.bech32.encode(o.bech32,l)}),prop(c,"hash",()=>{if(e.output)return e.output.slice(2);if(e.address)return n().data;if(c.redeem&&c.redeem.output)return sha256(c.redeem.output)}),prop(c,"output",()=>{if(c.hash)return compile([OPS$1.OP_0,c.hash])}),prop(c,"redeem",()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:EMPTY_BUFFER$1,witness:e.witness.slice(0,-1)}}),prop(c,"input",()=>{if(c.witness)return EMPTY_BUFFER$1}),prop(c,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){const l=toStack(r());return c.redeem=Object.assign({witness:l},e.redeem),c.redeem.input=EMPTY_BUFFER$1,[].concat(l,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),prop(c,"name",()=>{const l=["p2wsh"];return c.redeem!==void 0&&c.redeem.name!==void 0&&l.push(c.redeem.name),l.join("-")}),t.validate){let l=Uint8Array.from([]);if(e.address){if(n().prefix!==o.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(n().version!==0)throw new TypeError("Invalid address version");if(n().data.length!==32)throw new TypeError("Invalid address data");l=n().data}if(e.hash){if(l.length>0&&compare(l,e.hash)!==0)throw new TypeError("Hash mismatch");l=e.hash}if(e.output){if(e.output.length!==34||e.output[0]!==OPS$1.OP_0||e.output[1]!==32)throw new TypeError("Output is invalid");const x=e.output.slice(2);if(l.length>0&&compare(l,x)!==0)throw new TypeError("Hash mismatch");l=x}if(e.redeem){if(e.redeem.network&&e.redeem.network!==o)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){const x=decompile(e.redeem.output);if(!x||x.length<1)throw new TypeError("Redeem.output is invalid");if(e.redeem.output.byteLength>3600)throw new TypeError("Redeem.output unspendable if larger than 3600 bytes");if(countNonPushOnlyOPs(x)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const f=sha256(e.redeem.output);if(l.length>0&&compare(l,f)!==0)throw new TypeError("Hash mismatch");l=f}if(e.redeem.input&&!isPushOnly(r()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!stacksEqual(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&r().some(chunkHasUncompressedPubkey)||e.redeem.output&&(decompile(e.redeem.output)||[]).some(chunkHasUncompressedPubkey))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){const x=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&compare(e.redeem.output,x)!==0)throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(chunkHasUncompressedPubkey)||(decompile(x)||[]).some(chunkHasUncompressedPubkey))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(c,e)}const _ECCLIB_CACHE={};function initEccLib(e,t){e?e!==_ECCLIB_CACHE.eccLib&&(verifyEcc(e),_ECCLIB_CACHE.eccLib=e):_ECCLIB_CACHE.eccLib=e}function getEccLib(){if(!_ECCLIB_CACHE.eccLib)throw new Error("No ECC Library provided. You must call initEccLib() with a valid TinySecp256k1Interface instance");return _ECCLIB_CACHE.eccLib}const h$1=e=>fromHex(e);function verifyEcc(e){assert$1(typeof e.isXOnlyPoint=="function"),assert$1(e.isXOnlyPoint(h$1("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert$1(e.isXOnlyPoint(h$1("fffffffffffffffffffffffffffffffffffffffffffffffffffffffeeffffc2e"))),assert$1(e.isXOnlyPoint(h$1("f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9"))),assert$1(e.isXOnlyPoint(h$1("0000000000000000000000000000000000000000000000000000000000000001"))),assert$1(!e.isXOnlyPoint(h$1("0000000000000000000000000000000000000000000000000000000000000000"))),assert$1(!e.isXOnlyPoint(h$1("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"))),assert$1(typeof e.xOnlyPointAddTweak=="function"),tweakAddVectors.forEach(t=>{const n=e.xOnlyPointAddTweak(h$1(t.pubkey),h$1(t.tweak));t.result===null?assert$1(n===null):(assert$1(n!==null),assert$1(n.parity===t.parity),assert$1(compare(n.xOnlyPubkey,h$1(t.result))===0))})}function assert$1(e){if(!e)throw new Error("ecc library invalid")}const tweakAddVectors=[{pubkey:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",tweak:"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140",parity:-1,result:null},{pubkey:"1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b",tweak:"a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac",parity:1,result:"e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"},{pubkey:"2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",tweak:"823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47",parity:0,result:"9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"}],HEX_STRINGS$1="0123456789abcdefABCDEF";HEX_STRINGS$1.split("").map(e=>e.codePointAt(0));Array(256).fill(!0).map((e,t)=>{const n=String.fromCodePoint(t),r=HEX_STRINGS$1.indexOf(n);return r<0?void 0:r<16?r:r-6});new TextEncoder;new TextDecoder;function writeUInt16(e,t,n,r){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>65535)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${n}`);r==="LE"?(e[t]=n&255,e[t+1]=n>>8&255):(e[t]=n>>8&255,e[t+1]=n&255)}function writeUInt32$1(e,t,n,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${n}`);r==="LE"?(e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255):(e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=n&255)}function writeUInt64(e,t,n,r){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>0xffffffffffffffffn)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${n}`);r==="LE"?(e[t]=Number(n&0xffn),e[t+1]=Number(n>>8n&0xffn),e[t+2]=Number(n>>16n&0xffn),e[t+3]=Number(n>>24n&0xffn),e[t+4]=Number(n>>32n&0xffn),e[t+5]=Number(n>>40n&0xffn),e[t+6]=Number(n>>48n&0xffn),e[t+7]=Number(n>>56n&0xffn)):(e[t]=Number(n>>56n&0xffn),e[t+1]=Number(n>>48n&0xffn),e[t+2]=Number(n>>40n&0xffn),e[t+3]=Number(n>>32n&0xffn),e[t+4]=Number(n>>24n&0xffn),e[t+5]=Number(n>>16n&0xffn),e[t+6]=Number(n>>8n&0xffn),e[t+7]=Number(n&0xffn))}function readUInt16(e,t,n){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),n==="LE"){let r=0;return r=(r<<8)+e[t+1],r=(r<<8)+e[t],r}else{let r=0;return r=(r<<8)+e[t],r=(r<<8)+e[t+1],r}}function readUInt32(e,t,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),n==="LE"){let r=0;return r=(r<<8)+e[t+3]>>>0,r=(r<<8)+e[t+2]>>>0,r=(r<<8)+e[t+1]>>>0,r=(r<<8)+e[t]>>>0,r}else{let r=0;return r=(r<<8)+e[t]>>>0,r=(r<<8)+e[t+1]>>>0,r=(r<<8)+e[t+2]>>>0,r=(r<<8)+e[t+3]>>>0,r}}function readUInt64(e,t,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),n==="LE"){let r=0n;return r=(r<<8n)+BigInt(e[t+7]),r=(r<<8n)+BigInt(e[t+6]),r=(r<<8n)+BigInt(e[t+5]),r=(r<<8n)+BigInt(e[t+4]),r=(r<<8n)+BigInt(e[t+3]),r=(r<<8n)+BigInt(e[t+2]),r=(r<<8n)+BigInt(e[t+1]),r=(r<<8n)+BigInt(e[t]),r}else{let r=0n;return r=(r<<8n)+BigInt(e[t]),r=(r<<8n)+BigInt(e[t+1]),r=(r<<8n)+BigInt(e[t+2]),r=(r<<8n)+BigInt(e[t+3]),r=(r<<8n)+BigInt(e[t+4]),r=(r<<8n)+BigInt(e[t+5]),r=(r<<8n)+BigInt(e[t+6]),r=(r<<8n)+BigInt(e[t+7]),r}}const checkUInt64=e=>{if(e<0||e>0xffffffffffffffffn)throw new RangeError("value out of range")};function checkUInt53(e){if(e<0||e>Number.MAX_SAFE_INTEGER||e%1!==0)throw new RangeError("value out of range")}function checkUint53OrUint64(e){typeof e=="number"?checkUInt53(e):checkUInt64(e)}function encode$f(e,t,n){checkUint53OrUint64(e),n===void 0&&(n=0),t===void 0&&(t=new Uint8Array(encodingLength(e)));let r=0;return e<253?(t.set([Number(e)],n),r=1):e<=65535?(t.set([253],n),writeUInt16(t,n+1,Number(e),"LE"),r=3):e<=4294967295?(t.set([254],n),writeUInt32$1(t,n+1,Number(e),"LE"),r=5):(t.set([255],n),writeUInt64(t,n+1,BigInt(e),"LE"),r=9),{buffer:t,bytes:r}}function decode$e(e,t){t===void 0&&(t=0);const n=e.at(t);if(n===void 0)throw new Error("buffer too small");if(n<253)return{numberValue:n,bigintValue:BigInt(n),bytes:1};if(n===253){const r=readUInt16(e,t+1,"LE");return{numberValue:r,bigintValue:BigInt(r),bytes:3}}else if(n===254){const r=readUInt32(e,t+1,"LE");return{numberValue:r,bigintValue:BigInt(r),bytes:5}}else{const r=readUInt64(e,t+1,"LE");return{numberValue:r<=Number.MAX_SAFE_INTEGER?Number(r):null,bigintValue:r,bytes:9}}}function encodingLength(e){return checkUint53OrUint64(e),e<253?1:e<=65535?3:e<=4294967295?5:9}const MAX_JS_NUMBER=9007199254740991;function verifuint(e,t){if(typeof e!="number"&&typeof e!="bigint")throw new Error("cannot write a non-number as a number");if(e<0&&e<BigInt(0))throw new Error("specified a negative value for writing an unsigned value");if(e>t&&e>BigInt(t))throw new Error("RangeError: value out of range");if(Math.floor(Number(e))!==Number(e))throw new Error("value has a fractional component")}function reverseBuffer(e){if(e.length<1)return e;let t=e.length-1,n=0;for(let r=0;r<e.length/2;r++)n=e[r],e[r]=e[t],e[t]=n,t--;return e}function cloneBuffer(e){const t=new Uint8Array(e.length);return t.set(e),t}class BufferWriter{buffer;offset;static withCapacity(t){return new BufferWriter(new Uint8Array(t))}constructor(t,n=0){this.buffer=t,this.offset=n,parse$1(tuple([BufferSchema,UInt32Schema]),[t,n])}writeUInt8(t){this.offset=writeUInt8(this.buffer,this.offset,t)}writeInt32(t){this.offset=writeInt32(this.buffer,this.offset,t,"LE")}writeInt64(t){this.offset=writeInt64(this.buffer,this.offset,BigInt(t),"LE")}writeUInt32(t){this.offset=writeUInt32$2(this.buffer,this.offset,t,"LE")}writeUInt64(t){this.offset=writeUInt64$1(this.buffer,this.offset,BigInt(t),"LE")}writeVarInt(t){const{bytes:n}=encode$f(t,this.buffer,this.offset);this.offset+=n}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw new Error("Cannot write slice out of bounds");this.buffer.set(t,this.offset),this.offset+=t.length}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(n=>this.writeVarSlice(n))}end(){if(this.buffer.length===this.offset)return this.buffer;throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}}class BufferReader{buffer;offset;constructor(t,n=0){this.buffer=t,this.offset=n,parse$1(tuple([BufferSchema,UInt32Schema]),[t,n])}readUInt8(){const t=readUInt8(this.buffer,this.offset);return this.offset++,t}readInt32(){const t=readInt32(this.buffer,this.offset,"LE");return this.offset+=4,t}readUInt32(){const t=readUInt32$1(this.buffer,this.offset,"LE");return this.offset+=4,t}readInt64(){const t=readInt64(this.buffer,this.offset,"LE");return this.offset+=8,t}readVarInt(){const{bigintValue:t,bytes:n}=decode$e(this.buffer,this.offset);return this.offset+=n,t}readSlice(t){verifuint(t,MAX_JS_NUMBER);const n=Number(t);if(this.buffer.length<this.offset+n)throw new Error("Cannot read slice out of bounds");const r=this.buffer.slice(this.offset,this.offset+n);return this.offset+=n,r}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const t=this.readVarInt(),n=[];for(let r=0;r<t;r++)n.push(this.readVarSlice());return n}}const LEAF_VERSION_TAPSCRIPT=192,MAX_TAPTREE_DEPTH=128,isHashBranch=e=>"left"in e&&"right"in e;function rootHashFromPath(e,t){if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);const n=(e.length-33)/32;let r=t;for(let o=0;o<n;o++){const c=e.slice(33+32*o,65+32*o);compare(r,c)<0?r=tapBranchHash(r,c):r=tapBranchHash(c,r)}return r}function toHashTree(e){if(isTapleaf(e))return{hash:tapleafHash(e)};const t=[toHashTree(e[0]),toHashTree(e[1])];t.sort((o,c)=>compare(o.hash,c.hash));const[n,r]=t;return{hash:tapBranchHash(n.hash,r.hash),left:n,right:r}}function findScriptPath(e,t){if(isHashBranch(e)){const n=findScriptPath(e.left,t);if(n!==void 0)return[...n,e.right.hash];const r=findScriptPath(e.right,t);if(r!==void 0)return[...r,e.left.hash]}else if(compare(e.hash,t)===0)return[]}function tapleafHash(e){const t=e.version||LEAF_VERSION_TAPSCRIPT;return taggedHash("TapLeaf",concat$1([Uint8Array.from([t]),serializeScript(e.output)]))}function tapTweakHash(e,t){return taggedHash("TapTweak",concat$1(t?[e,t]:[e]))}function tweakKey(e,t){if(!(e instanceof Uint8Array)||e.length!==32||t&&t.length!==32)return null;const n=tapTweakHash(e,t),r=getEccLib().xOnlyPointAddTweak(e,n);return!r||r.xOnlyPubkey===null?null:{parity:r.parity,x:Uint8Array.from(r.xOnlyPubkey)}}function tapBranchHash(e,t){return taggedHash("TapBranch",concat$1([e,t]))}function serializeScript(e){const t=encodingLength(e.length),n=new Uint8Array(t);return encode$f(e.length,n),concat$1([n,e])}const OPS=OPS$7,TAPROOT_WITNESS_VERSION=1,ANNEX_PREFIX=80;function p2tr(e,t){if(!e.address&&!e.output&&!e.pubkey&&!e.internalPubkey&&!(e.witness&&e.witness.length>1))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({address:string$1(),input:NBufferSchemaFactory(0),network:object$1({}),output:NBufferSchemaFactory(34),internalPubkey:NBufferSchemaFactory(32),hash:NBufferSchemaFactory(32),pubkey:NBufferSchemaFactory(32),signature:union$1([NBufferSchemaFactory(64),NBufferSchemaFactory(65)]),witness:array(BufferSchema),scriptTree:custom(isTaptree,"Taptree is not of type isTaptree"),redeem:partial(object$1({output:BufferSchema,redeemVersion:number$1(),witness:array(BufferSchema)})),redeemVersion:number$1()})),e);const n=value(()=>fromBech32(e.address)),r=value(()=>{if(!(!e.witness||!e.witness.length))return e.witness.length>=2&&e.witness[e.witness.length-1][0]===ANNEX_PREFIX?e.witness.slice(0,-1):e.witness.slice()}),o=value(()=>{if(e.scriptTree)return toHashTree(e.scriptTree);if(e.hash)return{hash:e.hash}}),c=e.network||bitcoin$1,l={name:"p2tr",network:c};if(prop(l,"address",()=>{if(!l.pubkey)return;const x=distExports$1.bech32m.toWords(l.pubkey);return x.unshift(TAPROOT_WITNESS_VERSION),distExports$1.bech32m.encode(c.bech32,x)}),prop(l,"hash",()=>{const x=o();if(x)return x.hash;const f=r();if(f&&f.length>1){const m=f[f.length-1],E=m[0]&TAPLEAF_VERSION_MASK,g=f[f.length-2],y=tapleafHash({output:g,version:E});return rootHashFromPath(m,y)}return null}),prop(l,"output",()=>{if(l.pubkey)return compile([OPS.OP_1,l.pubkey])}),prop(l,"redeemVersion",()=>e.redeemVersion?e.redeemVersion:e.redeem&&e.redeem.redeemVersion!==void 0&&e.redeem.redeemVersion!==null?e.redeem.redeemVersion:LEAF_VERSION_TAPSCRIPT),prop(l,"redeem",()=>{const x=r();if(!(!x||x.length<2))return{output:x[x.length-2],witness:x.slice(0,-2),redeemVersion:x[x.length-1][0]&TAPLEAF_VERSION_MASK}}),prop(l,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.output)return e.output.slice(2);if(e.address)return n().data;if(l.internalPubkey){const x=tweakKey(l.internalPubkey,l.hash);if(x)return x.x}}),prop(l,"internalPubkey",()=>{if(e.internalPubkey)return e.internalPubkey;const x=r();if(x&&x.length>1)return x[x.length-1].slice(1,33)}),prop(l,"signature",()=>{if(e.signature)return e.signature;const x=r();if(!(!x||x.length!==1))return x[0]}),prop(l,"witness",()=>{if(e.witness)return e.witness;const x=o();if(x&&e.redeem&&e.redeem.output&&e.internalPubkey){const f=tapleafHash({output:e.redeem.output,version:l.redeemVersion}),m=findScriptPath(x,f);if(!m)return;const E=tweakKey(e.internalPubkey,x.hash);if(!E)return;const g=concat$1([Uint8Array.from([l.redeemVersion|E.parity]),e.internalPubkey].concat(m));return[e.redeem.output,g]}if(e.signature)return[e.signature]}),t.validate){let x=Uint8Array.from([]);if(e.address){if(c&&c.bech32!==n().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(n().version!==TAPROOT_WITNESS_VERSION)throw new TypeError("Invalid address version");if(n().data.length!==32)throw new TypeError("Invalid address data");x=n().data}if(e.pubkey){if(x.length>0&&compare(x,e.pubkey)!==0)throw new TypeError("Pubkey mismatch");x=e.pubkey}if(e.output){if(e.output.length!==34||e.output[0]!==OPS.OP_1||e.output[1]!==32)throw new TypeError("Output is invalid");if(x.length>0&&compare(x,e.output.slice(2))!==0)throw new TypeError("Pubkey mismatch");x=e.output.slice(2)}if(e.internalPubkey){const E=tweakKey(e.internalPubkey,l.hash);if(x.length>0&&compare(x,E.x)!==0)throw new TypeError("Pubkey mismatch");x=E.x}if(x&&x.length&&!getEccLib().isXOnlyPoint(x))throw new TypeError("Invalid pubkey for p2tr");const f=o();if(e.hash&&f&&compare(e.hash,f.hash)!==0)throw new TypeError("Hash mismatch");if(e.redeem&&e.redeem.output&&f){const E=tapleafHash({output:e.redeem.output,version:l.redeemVersion});if(!findScriptPath(f,E))throw new TypeError("Redeem script not in tree")}const m=r();if(e.redeem&&l.redeem){if(e.redeem.redeemVersion&&e.redeem.redeemVersion!==l.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(e.redeem.output){if(decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");if(l.redeem.output&&compare(e.redeem.output,l.redeem.output)!==0)throw new TypeError("Redeem.output and witness mismatch")}if(e.redeem.witness&&l.redeem.witness&&!stacksEqual(e.redeem.witness,l.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(m&&m.length)if(m.length===1){if(e.signature&&compare(e.signature,m[0])!==0)throw new TypeError("Signature mismatch")}else{const E=m[m.length-1];if(E.length<33)throw new TypeError(`The control-block length is too small. Got ${E.length}, expected min 33.`);if((E.length-33)%32!==0)throw new TypeError(`The control-block length of ${E.length} is incorrect!`);const g=(E.length-33)/32;if(g>128)throw new TypeError(`The script path is too long. Got ${g}, expected max 128.`);const y=E.slice(1,33);if(e.internalPubkey&&compare(e.internalPubkey,y)!==0)throw new TypeError("Internal pubkey mismatch");if(!getEccLib().isXOnlyPoint(y))throw new TypeError("Invalid internalPubkey for p2tr witness");const w=E[0]&TAPLEAF_VERSION_MASK,v=m[m.length-2],_=tapleafHash({output:v,version:w}),F=rootHashFromPath(E,_),H=tweakKey(y,F);if(!H)throw new TypeError("Invalid outputKey for p2tr witness");if(x.length&&compare(x,H.x)!==0)throw new TypeError("Pubkey mismatch for p2tr witness");if(H.parity!==(E[0]&1))throw new Error("Incorrect parity")}}return Object.assign(l,e)}const FUTURE_SEGWIT_MAX_SIZE=40,FUTURE_SEGWIT_MIN_SIZE=2,FUTURE_SEGWIT_MAX_VERSION=16,FUTURE_SEGWIT_MIN_VERSION=2,FUTURE_SEGWIT_VERSION_DIFF=80,FUTURE_SEGWIT_VERSION_WARNING="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.",WARNING_STATES=[!1,!1];function _toFutureSegwitAddress(e,t){const n=e.slice(2);if(n.length<FUTURE_SEGWIT_MIN_SIZE||n.length>FUTURE_SEGWIT_MAX_SIZE)throw new TypeError("Invalid program length for segwit address");const r=e[0]-FUTURE_SEGWIT_VERSION_DIFF;if(r<FUTURE_SEGWIT_MIN_VERSION||r>FUTURE_SEGWIT_MAX_VERSION)throw new TypeError("Invalid version for segwit address");if(e[1]!==n.length)throw new TypeError("Invalid script for segwit address");return WARNING_STATES[0]===!1&&(console.warn(FUTURE_SEGWIT_VERSION_WARNING),WARNING_STATES[0]=!0),toBech32(n,r,t.bech32)}function fromBase58Check(e){const t=bs58Check.decode(e);if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");const n=readUInt8(t,0),r=t.slice(1);return{version:n,hash:r}}function fromBech32(e){let t,n;try{t=distExports$1.bech32.decode(e)}catch{}if(t){if(n=t.words[0],n!==0)throw new TypeError(e+" uses wrong encoding")}else if(t=distExports$1.bech32m.decode(e),n=t.words[0],n===0)throw new TypeError(e+" uses wrong encoding");const r=distExports$1.bech32.fromWords(t.words.slice(1));return{version:n,prefix:t.prefix,data:Uint8Array.from(r)}}function toBech32(e,t,n){const r=distExports$1.bech32.toWords(e);return r.unshift(t),t===0?distExports$1.bech32.encode(n,r):distExports$1.bech32m.encode(n,r)}function fromOutputScript(e,t){t=t||bitcoin$1;try{return p2pkh({output:e,network:t}).address}catch{}try{return p2sh({output:e,network:t}).address}catch{}try{return p2wpkh({output:e,network:t}).address}catch{}try{return p2wsh({output:e,network:t}).address}catch{}try{return p2tr({output:e,network:t}).address}catch{}try{return _toFutureSegwitAddress(e,t)}catch{}throw new Error(toASM(e)+" has no matching Address")}function toOutputScript(e,t){t=t||bitcoin$1;let n,r;try{n=fromBase58Check(e)}catch{}if(n){if(n.version===t.pubKeyHash)return p2pkh({hash:n.hash}).output;if(n.version===t.scriptHash)return p2sh({hash:n.hash}).output}else{try{r=fromBech32(e)}catch{}if(r){if(r.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(r.version===0){if(r.data.length===20)return p2wpkh({hash:r.data}).output;if(r.data.length===32)return p2wsh({hash:r.data}).output}else if(r.version===1){if(r.data.length===32)return p2tr({pubkey:r.data}).output}else if(r.version>=FUTURE_SEGWIT_MIN_VERSION&&r.version<=FUTURE_SEGWIT_MAX_VERSION&&r.data.length>=FUTURE_SEGWIT_MIN_SIZE&&r.data.length<=FUTURE_SEGWIT_MAX_SIZE)return WARNING_STATES[1]===!1&&(console.warn(FUTURE_SEGWIT_VERSION_WARNING),WARNING_STATES[1]=!0),compile([r.version+FUTURE_SEGWIT_VERSION_DIFF,r.data])}}throw new Error(e+" has no matching Script")}function varSliceSize(e){const t=e.length;return encodingLength(t)+t}function vectorSize(e){const t=e.length;return encodingLength(t)+e.reduce((n,r)=>n+varSliceSize(r),0)}const EMPTY_BUFFER=new Uint8Array(0),EMPTY_WITNESS=[],ZERO=fromHex("0000000000000000000000000000000000000000000000000000000000000000"),ONE=fromHex("0000000000000000000000000000000000000000000000000000000000000001"),VALUE_UINT64_MAX=fromHex("ffffffffffffffff"),BLANK_OUTPUT={script:EMPTY_BUFFER,valueBuffer:VALUE_UINT64_MAX};function isOutput(e){return e.value!==void 0}class Transaction{static DEFAULT_SEQUENCE=4294967295;static SIGHASH_DEFAULT=0;static SIGHASH_ALL=1;static SIGHASH_NONE=2;static SIGHASH_SINGLE=3;static SIGHASH_ANYONECANPAY=128;static SIGHASH_OUTPUT_MASK=3;static SIGHASH_INPUT_MASK=128;static ADVANCED_TRANSACTION_MARKER=0;static ADVANCED_TRANSACTION_FLAG=1;static fromBuffer(t,n){const r=new BufferReader(t),o=new Transaction;o.version=r.readUInt32();const c=r.readUInt8(),l=r.readUInt8();let x=!1;c===Transaction.ADVANCED_TRANSACTION_MARKER&&l===Transaction.ADVANCED_TRANSACTION_FLAG?x=!0:r.offset-=2;const f=r.readVarInt();for(let E=0;E<f;++E)o.ins.push({hash:r.readSlice(32),index:r.readUInt32(),script:r.readVarSlice(),sequence:r.readUInt32(),witness:EMPTY_WITNESS});const m=r.readVarInt();for(let E=0;E<m;++E)o.outs.push({value:r.readInt64(),script:r.readVarSlice()});if(x){for(let E=0;E<f;++E)o.ins[E].witness=r.readVector();if(!o.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(o.locktime=r.readUInt32(),n)return o;if(r.offset!==t.length)throw new Error("Transaction has unexpected data");return o}static fromHex(t){return Transaction.fromBuffer(fromHex(t),!1)}static isCoinbaseHash(t){parse$1(Hash256bitSchema,t);for(let n=0;n<32;++n)if(t[n]!==0)return!1;return!0}version=1;locktime=0;ins=[];outs=[];isCoinbase(){return this.ins.length===1&&Transaction.isCoinbaseHash(this.ins[0].hash)}addInput(t,n,r,o){return parse$1(tuple([Hash256bitSchema,UInt32Schema,nullable(optional$1(UInt32Schema)),nullable(optional$1(BufferSchema))]),[t,n,r,o]),r==null&&(r=Transaction.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:n,script:o||EMPTY_BUFFER,sequence:r,witness:EMPTY_WITNESS})-1}addOutput(t,n){return parse$1(tuple([BufferSchema,SatoshiSchema]),[t,n]),this.outs.push({script:t,value:n})-1}hasWitnesses(){return this.ins.some(t=>t.witness.length!==0)}stripWitnesses(){this.ins.forEach(t=>{t.witness=EMPTY_WITNESS})}weight(){const t=this.byteLength(!1),n=this.byteLength(!0);return t*3+n}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(t=!0){const n=t&&this.hasWitnesses();return(n?10:8)+encodingLength(this.ins.length)+encodingLength(this.outs.length)+this.ins.reduce((r,o)=>r+40+varSliceSize(o.script),0)+this.outs.reduce((r,o)=>r+8+varSliceSize(o.script),0)+(n?this.ins.reduce((r,o)=>r+vectorSize(o.witness),0):0)}clone(){const t=new Transaction;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(n=>({hash:n.hash,index:n.index,script:n.script,sequence:n.sequence,witness:n.witness})),t.outs=this.outs.map(n=>({script:n.script,value:n.value})),t}hashForSignature(t,n,r){if(parse$1(tuple([UInt32Schema,BufferSchema,number$1()]),[t,n,r]),t>=this.ins.length)return ONE;const o=compile(decompile(n).filter(x=>x!==OPS$7.OP_CODESEPARATOR)),c=this.clone();if((r&31)===Transaction.SIGHASH_NONE)c.outs=[],c.ins.forEach((x,f)=>{f!==t&&(x.sequence=0)});else if((r&31)===Transaction.SIGHASH_SINGLE){if(t>=this.outs.length)return ONE;c.outs.length=t+1;for(let x=0;x<t;x++)c.outs[x]=BLANK_OUTPUT;c.ins.forEach((x,f)=>{f!==t&&(x.sequence=0)})}r&Transaction.SIGHASH_ANYONECANPAY?(c.ins=[c.ins[t]],c.ins[0].script=o):(c.ins.forEach(x=>{x.script=EMPTY_BUFFER}),c.ins[t].script=o);const l=new Uint8Array(c.byteLength(!1)+4);return writeInt32(l,l.length-4,r,"LE"),c.__toBuffer(l,0,!1),hash256(l)}hashForWitnessV1(t,n,r,o,c,l){if(parse$1(tuple([UInt32Schema,array(BufferSchema),array(SatoshiSchema),UInt32Schema]),[t,n,r,o]),r.length!==this.ins.length||n.length!==this.ins.length)throw new Error("Must supply prevout script and value for all inputs");const x=o===Transaction.SIGHASH_DEFAULT?Transaction.SIGHASH_ALL:o&Transaction.SIGHASH_OUTPUT_MASK,m=(o&Transaction.SIGHASH_INPUT_MASK)===Transaction.SIGHASH_ANYONECANPAY,E=x===Transaction.SIGHASH_NONE,g=x===Transaction.SIGHASH_SINGLE;let y=EMPTY_BUFFER,w=EMPTY_BUFFER,v=EMPTY_BUFFER,_=EMPTY_BUFFER,F=EMPTY_BUFFER;if(!m){let L=BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(N=>{L.writeSlice(N.hash),L.writeUInt32(N.index)}),y=sha256(L.end()),L=BufferWriter.withCapacity(8*this.ins.length),r.forEach(N=>L.writeInt64(N)),w=sha256(L.end()),L=BufferWriter.withCapacity(n.map(varSliceSize).reduce((N,I)=>N+I)),n.forEach(N=>L.writeVarSlice(N)),v=sha256(L.end()),L=BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(N=>L.writeUInt32(N.sequence)),_=sha256(L.end())}if(E||g){if(g&&t<this.outs.length){const L=this.outs[t],N=BufferWriter.withCapacity(8+varSliceSize(L.script));N.writeInt64(L.value),N.writeVarSlice(L.script),F=sha256(N.end())}}else{if(!this.outs.length)throw new Error("Add outputs to the transaction before signing.");const L=this.outs.map(I=>8+varSliceSize(I.script)).reduce((I,U)=>I+U),N=BufferWriter.withCapacity(L);this.outs.forEach(I=>{N.writeInt64(I.value),N.writeVarSlice(I.script)}),F=sha256(N.end())}const H=(c?2:0)+(l?1:0),Y=174-(m?49:0)-(E?32:0)+(l?32:0)+(c?37:0),T=BufferWriter.withCapacity(Y);if(T.writeUInt8(o),T.writeUInt32(this.version),T.writeUInt32(this.locktime),T.writeSlice(y),T.writeSlice(w),T.writeSlice(v),T.writeSlice(_),E||g||T.writeSlice(F),T.writeUInt8(H),m){const L=this.ins[t];T.writeSlice(L.hash),T.writeUInt32(L.index),T.writeInt64(r[t]),T.writeVarSlice(n[t]),T.writeUInt32(L.sequence)}else T.writeUInt32(t);if(l){const L=BufferWriter.withCapacity(varSliceSize(l));L.writeVarSlice(l),T.writeSlice(sha256(L.end()))}return g&&T.writeSlice(F),c&&(T.writeSlice(c),T.writeUInt8(0),T.writeUInt32(4294967295)),taggedHash("TapSighash",concat$1([Uint8Array.from([0]),T.end()]))}hashForWitnessV0(t,n,r,o){parse$1(tuple([UInt32Schema,BufferSchema,SatoshiSchema,UInt32Schema]),[t,n,r,o]);let c=Uint8Array.from([]),l,x=ZERO,f=ZERO,m=ZERO;if(o&Transaction.SIGHASH_ANYONECANPAY||(c=new Uint8Array(36*this.ins.length),l=new BufferWriter(c,0),this.ins.forEach(g=>{l.writeSlice(g.hash),l.writeUInt32(g.index)}),f=hash256(c)),!(o&Transaction.SIGHASH_ANYONECANPAY)&&(o&31)!==Transaction.SIGHASH_SINGLE&&(o&31)!==Transaction.SIGHASH_NONE&&(c=new Uint8Array(4*this.ins.length),l=new BufferWriter(c,0),this.ins.forEach(g=>{l.writeUInt32(g.sequence)}),m=hash256(c)),(o&31)!==Transaction.SIGHASH_SINGLE&&(o&31)!==Transaction.SIGHASH_NONE){const g=this.outs.reduce((y,w)=>y+8+varSliceSize(w.script),0);c=new Uint8Array(g),l=new BufferWriter(c,0),this.outs.forEach(y=>{l.writeInt64(y.value),l.writeVarSlice(y.script)}),x=hash256(c)}else if((o&31)===Transaction.SIGHASH_SINGLE&&t<this.outs.length){const g=this.outs[t];c=new Uint8Array(8+varSliceSize(g.script)),l=new BufferWriter(c,0),l.writeInt64(g.value),l.writeVarSlice(g.script),x=hash256(c)}c=new Uint8Array(156+varSliceSize(n)),l=new BufferWriter(c,0);const E=this.ins[t];return l.writeUInt32(this.version),l.writeSlice(f),l.writeSlice(m),l.writeSlice(E.hash),l.writeUInt32(E.index),l.writeVarSlice(n),l.writeInt64(r),l.writeUInt32(E.sequence),l.writeSlice(x),l.writeUInt32(this.locktime),l.writeUInt32(o),hash256(c)}getHash(t){return t&&this.isCoinbase()?new Uint8Array(32):hash256(this.__toBuffer(void 0,void 0,t))}getId(){return toHex(reverseBuffer(this.getHash(!1)))}toBuffer(t,n){return this.__toBuffer(t,n,!0)}toHex(){return toHex(this.toBuffer(void 0,void 0))}setInputScript(t,n){parse$1(tuple([number$1(),BufferSchema]),[t,n]),this.ins[t].script=n}setWitness(t,n){parse$1(tuple([number$1(),array(BufferSchema)]),[t,n]),this.ins[t].witness=n}__toBuffer(t,n,r=!1){t||(t=new Uint8Array(this.byteLength(r)));const o=new BufferWriter(t,n||0);o.writeUInt32(this.version);const c=r&&this.hasWitnesses();return c&&(o.writeUInt8(Transaction.ADVANCED_TRANSACTION_MARKER),o.writeUInt8(Transaction.ADVANCED_TRANSACTION_FLAG)),o.writeVarInt(this.ins.length),this.ins.forEach(l=>{o.writeSlice(l.hash),o.writeUInt32(l.index),o.writeVarSlice(l.script),o.writeUInt32(l.sequence)}),o.writeVarInt(this.outs.length),this.outs.forEach(l=>{isOutput(l)?o.writeInt64(l.value):o.writeSlice(l.valueBuffer),o.writeVarSlice(l.script)}),c&&this.ins.forEach(l=>{o.writeVector(l.witness)}),o.writeUInt32(this.locktime),n!==void 0?t.slice(n,o.offset):t}}var GlobalTypes;(function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"})(GlobalTypes||(GlobalTypes={}));var InputTypes;(function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT",e[e.TAP_KEY_SIG=19]="TAP_KEY_SIG",e[e.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",e[e.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",e[e.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",e[e.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"})(InputTypes||(InputTypes={}));var OutputTypes;(function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",e[e.TAP_TREE=6]="TAP_TREE",e[e.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"})(OutputTypes||(OutputTypes={}));const range$3=e=>[...Array(e).keys()];function decode$d(e){if(e.key[0]!==GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+toHex(e.key));if(e.key.length!==79||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+toHex(e.key));if(e.value.length/4%1!==0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");const t=e.key.slice(1),n={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(const r of range$3(e.value.length/4-1)){const o=readUInt32$1(e.value,r*4+4,"LE"),c=!!(o&2147483648),l=o&2147483647;n.path+="/"+l.toString(10)+(c?"'":"")}return n}function encode$e(e){const t=new Uint8Array([GlobalTypes.GLOBAL_XPUB]),n=concat$1([t,e.extendedPubkey]),r=e.path.split("/"),o=new Uint8Array(r.length*4);o.set(e.masterFingerprint,0);let c=4;return r.slice(1).forEach(l=>{const x=l.slice(-1)==="'";let f=2147483647&parseInt(x?l.slice(0,-1):l,10);x&&(f+=2147483648),writeUInt32$2(o,c,f,"LE"),c+=4}),{key:n,value:o}}const expected$c="{ masterFingerprint: Uint8Array; extendedPubkey: Uint8Array; path: string; }";function check$c(e){const t=e.extendedPubkey,n=e.masterFingerprint,r=e.path;return t instanceof Uint8Array&&t.length===78&&[2,3].indexOf(t[45])>-1&&n instanceof Uint8Array&&n.length===4&&typeof r=="string"&&!!r.match(/^m(\/\d+'?)*$/)}function canAddToArray$3(e,t,n){const r=toHex(t.extendedPubkey);return n.has(r)?!1:(n.add(r),e.filter(o=>compare(o.extendedPubkey,t.extendedPubkey)).length===0)}const globalXpub=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$3,check:check$c,decode:decode$d,encode:encode$e,expected:expected$c},Symbol.toStringTag,{value:"Module"}));function encode$d(e){return{key:new Uint8Array([GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}const unsignedTx=Object.freeze(Object.defineProperty({__proto__:null,encode:encode$d},Symbol.toStringTag,{value:"Module"}));function decode$c(e){if(e.key[0]!==InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+toHex(e.key));return e.value}function encode$c(e){return{key:new Uint8Array([InputTypes.FINAL_SCRIPTSIG]),value:e}}const expected$b="Uint8Array";function check$b(e){return e instanceof Uint8Array}function canAdd$8(e,t){return!!e&&!!t&&e.finalScriptSig===void 0}const finalScriptSig=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$8,check:check$b,decode:decode$c,encode:encode$c,expected:expected$b},Symbol.toStringTag,{value:"Module"}));function decode$b(e){if(e.key[0]!==InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+toHex(e.key));return e.value}function encode$b(e){return{key:new Uint8Array([InputTypes.FINAL_SCRIPTWITNESS]),value:e}}const expected$a="Uint8Array";function check$a(e){return e instanceof Uint8Array}function canAdd$7(e,t){return!!e&&!!t&&e.finalScriptWitness===void 0}const finalScriptWitness=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$7,check:check$a,decode:decode$b,encode:encode$b,expected:expected$a},Symbol.toStringTag,{value:"Module"}));function decode$a(e){if(e.key[0]!==InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+toHex(e.key));return e.value}function encode$a(e){return{key:new Uint8Array([InputTypes.NON_WITNESS_UTXO]),value:e}}const expected$9="Uint8Array";function check$9(e){return e instanceof Uint8Array}function canAdd$6(e,t){return!!e&&!!t&&e.nonWitnessUtxo===void 0}const nonWitnessUtxo=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$6,check:check$9,decode:decode$a,encode:encode$a,expected:expected$9},Symbol.toStringTag,{value:"Module"}));function decode$9(e){if(e.key[0]!==InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+toHex(e.key));if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+toHex(e.key));return{pubkey:e.key.slice(1),signature:e.value}}function encode$9(e){const t=new Uint8Array([InputTypes.PARTIAL_SIG]);return{key:concat$1([t,e.pubkey]),value:e.signature}}const expected$8="{ pubkey: Uint8Array; signature: Uint8Array; }";function check$8(e){return e.pubkey instanceof Uint8Array&&e.signature instanceof Uint8Array&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&isDerSigWithSighash(e.signature)}function isDerSigWithSighash(e){if(!(e instanceof Uint8Array)||e.length<9||e[0]!==48||e.length!==e[1]+3||e[2]!==2)return!1;const t=e[3];if(t>33||t<1||e[3+t+1]!==2)return!1;const n=e[3+t+2];return!(n>33||n<1||e.length!==3+t+2+n+2)}function canAddToArray$2(e,t,n){const r=toHex(t.pubkey);return n.has(r)?!1:(n.add(r),e.filter(o=>compare(o.pubkey,t.pubkey)===0).length===0)}const partialSig=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$2,check:check$8,decode:decode$9,encode:encode$9,expected:expected$8},Symbol.toStringTag,{value:"Module"}));function decode$8(e){if(e.key[0]!==InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+toHex(e.key));return toUtf8(e.value)}function encode$8(e){return{key:new Uint8Array([InputTypes.POR_COMMITMENT]),value:fromUtf8(e)}}const expected$7="string";function check$7(e){return typeof e=="string"}function canAdd$5(e,t){return!!e&&!!t&&e.porCommitment===void 0}const porCommitment=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$5,check:check$7,decode:decode$8,encode:encode$8,expected:expected$7},Symbol.toStringTag,{value:"Module"}));function decode$7(e){if(e.key[0]!==InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+toHex(e.key));return Number(readUInt32$1(e.value,0,"LE"))}function encode$7(e){const t=Uint8Array.from([InputTypes.SIGHASH_TYPE]),n=new Uint8Array(4);return writeUInt32$2(n,0,e,"LE"),{key:t,value:n}}const expected$6="number";function check$6(e){return typeof e=="number"}function canAdd$4(e,t){return!!e&&!!t&&e.sighashType===void 0}const sighashType=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$4,check:check$6,decode:decode$7,encode:encode$7,expected:expected$6},Symbol.toStringTag,{value:"Module"}));function decode$6(e){if(e.key[0]!==InputTypes.TAP_KEY_SIG||e.key.length!==1)throw new Error("Decode Error: could not decode tapKeySig with key 0x"+toHex(e.key));if(!check$5(e.value))throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value}function encode$6(e){return{key:Uint8Array.from([InputTypes.TAP_KEY_SIG]),value:e}}const expected$5="Uint8Array";function check$5(e){return e instanceof Uint8Array&&(e.length===64||e.length===65)}function canAdd$3(e,t){return!!e&&!!t&&e.tapKeySig===void 0}const tapKeySig=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$3,check:check$5,decode:decode$6,encode:encode$6,expected:expected$5},Symbol.toStringTag,{value:"Module"}));function decode$5(e){if(e.key[0]!==InputTypes.TAP_LEAF_SCRIPT)throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+toHex(e.key));if((e.key.length-2)%32!==0)throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+toHex(e.key));const t=e.value[e.value.length-1];if((e.key[1]&254)!==t)throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+toHex(e.key));const n=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:n,leafVersion:t}}function encode$5(e){const t=Uint8Array.from([InputTypes.TAP_LEAF_SCRIPT]),n=Uint8Array.from([e.leafVersion]);return{key:concat$1([t,e.controlBlock]),value:concat$1([e.script,n])}}const expected$4="{ controlBlock: Uint8Array; leafVersion: number, script: Uint8Array; }";function check$4(e){return e.controlBlock instanceof Uint8Array&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&e.script instanceof Uint8Array}function canAddToArray$1(e,t,n){const r=toHex(t.controlBlock);return n.has(r)?!1:(n.add(r),e.filter(o=>compare(o.controlBlock,t.controlBlock)===0).length===0)}const tapLeafScript=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$1,check:check$4,decode:decode$5,encode:encode$5,expected:expected$4},Symbol.toStringTag,{value:"Module"}));function decode$4(e){if(e.key[0]!==InputTypes.TAP_MERKLE_ROOT||e.key.length!==1)throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+toHex(e.key));if(!check$3(e.value))throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value}function encode$4(e){return{key:Uint8Array.from([InputTypes.TAP_MERKLE_ROOT]),value:e}}const expected$3="Uint8Array";function check$3(e){return e instanceof Uint8Array&&e.length===32}function canAdd$2(e,t){return!!e&&!!t&&e.tapMerkleRoot===void 0}const tapMerkleRoot=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$2,check:check$3,decode:decode$4,encode:encode$4,expected:expected$3},Symbol.toStringTag,{value:"Module"}));function decode$3(e){if(e.key[0]!==InputTypes.TAP_SCRIPT_SIG)throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+toHex(e.key));if(e.key.length!==65)throw new Error("Decode Error: tapScriptSig has invalid key 0x"+toHex(e.key));if(e.value.length!==64&&e.value.length!==65)throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+toHex(e.key));const t=e.key.slice(1,33),n=e.key.slice(33);return{pubkey:t,leafHash:n,signature:e.value}}function encode$3(e){const t=Uint8Array.from([InputTypes.TAP_SCRIPT_SIG]);return{key:concat$1([t,e.pubkey,e.leafHash]),value:e.signature}}const expected$2="{ pubkey: Uint8Array; leafHash: Uint8Array; signature: Uint8Array; }";function check$2(e){return e.pubkey instanceof Uint8Array&&e.leafHash instanceof Uint8Array&&e.signature instanceof Uint8Array&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}function canAddToArray(e,t,n){const r=toHex(t.pubkey)+toHex(t.leafHash);return n.has(r)?!1:(n.add(r),e.filter(o=>compare(o.pubkey,t.pubkey)===0&&compare(o.leafHash,t.leafHash)===0).length===0)}const tapScriptSig=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray,check:check$2,decode:decode$3,encode:encode$3,expected:expected$2},Symbol.toStringTag,{value:"Module"}));function decode$2(e){if(e.key[0]!==InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+toHex(e.key));const t=readInt64(e.value,0,"LE");let n=8;const{numberValue:r,bytes:o}=decode$e(e.value,n);n+=o;const c=e.value.slice(n);if(c.length!==r)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:c,value:t}}function encode$2(e){const{script:t,value:n}=e,r=encodingLength(t.length),o=new Uint8Array(8+r+t.length);return writeInt64(o,0,BigInt(n),"LE"),encode$f(t.length,o,8),o.set(t,8+r),{key:Uint8Array.from([InputTypes.WITNESS_UTXO]),value:o}}const expected$1="{ script: Uint8Array; value: bigint; }";function check$1(e){return e.script instanceof Uint8Array&&typeof e.value=="bigint"}function canAdd$1(e,t){return!!e&&!!t&&e.witnessUtxo===void 0}const witnessUtxo=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$1,check:check$1,decode:decode$2,encode:encode$2,expected:expected$1},Symbol.toStringTag,{value:"Module"}));function decode$1(e){if(e.key[0]!==OutputTypes.TAP_TREE||e.key.length!==1)throw new Error("Decode Error: could not decode tapTree with key 0x"+toHex(e.key));let t=0;const n=[];for(;t<e.value.length;){const r=e.value[t++],o=e.value[t++],{numberValue:c,bytes:l}=decode$e(e.value,t);t+=l,n.push({depth:r,leafVersion:o,script:e.value.slice(t,t+c)}),t+=c}return{leaves:n}}function encode$1(e){const t=Uint8Array.from([OutputTypes.TAP_TREE]),n=[].concat(...e.leaves.map(r=>[Uint8Array.of(r.depth,r.leafVersion),encode$f(BigInt(r.script.length)).buffer,r.script]));return{key:t,value:concat$1(n)}}const expected="{ leaves: [{ depth: number; leafVersion: number, script: Uint8Array; }] }";function check(e){return Array.isArray(e.leaves)&&e.leaves.every(t=>t.depth>=0&&t.depth<=128&&(t.leafVersion&254)===t.leafVersion&&t.script instanceof Uint8Array)}function canAdd(e,t){return!!e&&!!t&&e.tapTree===void 0}const tapTree=Object.freeze(Object.defineProperty({__proto__:null,canAdd,check,decode:decode$1,encode:encode$1,expected},Symbol.toStringTag,{value:"Module"})),range$2=e=>[...Array(e).keys()],isValidDERKey=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&e[0]===4;function makeConverter$4(e,t=isValidDERKey){function n(x){if(x.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+toHex(x.key));const f=x.key.slice(1);if(!t(f))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+toHex(x.key));if(x.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");const m={masterFingerprint:x.value.slice(0,4),pubkey:f,path:"m"};for(const E of range$2(x.value.length/4-1)){const g=readUInt32$1(x.value,E*4+4,"LE"),y=!!(g&2147483648),w=g&2147483647;m.path+="/"+w.toString(10)+(y?"'":"")}return m}function r(x){const f=Uint8Array.from([e]),m=concat$1([f,x.pubkey]),E=x.path.split("/"),g=new Uint8Array(E.length*4);g.set(x.masterFingerprint,0);let y=4;return E.slice(1).forEach(w=>{const v=w.slice(-1)==="'";let _=2147483647&parseInt(v?w.slice(0,-1):w,10);v&&(_+=2147483648),writeUInt32$2(g,y,_,"LE"),y+=4}),{key:m,value:g}}const o="{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; }";function c(x){return x.pubkey instanceof Uint8Array&&x.masterFingerprint instanceof Uint8Array&&typeof x.path=="string"&&t(x.pubkey)&&x.masterFingerprint.length===4}function l(x,f,m){const E=toHex(f.pubkey);return m.has(E)?!1:(m.add(E),x.filter(g=>compare(g.pubkey,f.pubkey)===0).length===0)}return{decode:n,encode:r,check:c,expected:o,canAddToArray:l}}function makeChecker(e){return t;function t(n){let r;if(e.includes(n.key[0])&&(r=n.key.slice(1),!(r.length===33||r.length===65)||![2,3,4].includes(r[0])))throw new Error("Format Error: invalid pubkey in key 0x"+toHex(n.key));return r}}function makeConverter$3(e){function t(l){if(l.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+toHex(l.key));return l.value}function n(l){return{key:Uint8Array.from([e]),value:l}}const r="Uint8Array";function o(l){return l instanceof Uint8Array}function c(l,x){return!!l&&!!x&&l.redeemScript===void 0}return{decode:t,encode:n,check:o,expected:r,canAdd:c}}const isValidBIP340Key=e=>e.length===32;function makeConverter$2(e){const t=makeConverter$4(e,isValidBIP340Key);function n(l){const{numberValue:x,bytes:f}=decode$e(l.value),m=t.decode({key:l.key,value:l.value.slice(f+Number(x)*32)}),E=new Array(Number(x));for(let g=0,y=f;g<x;g++,y+=32)E[g]=l.value.slice(y,y+32);return{...m,leafHashes:E}}function r(l){const x=t.encode(l),f=encodingLength(l.leafHashes.length),m=new Uint8Array(f);encode$f(l.leafHashes.length,m);const E=concat$1([m,...l.leafHashes,x.value]);return{...x,value:E}}const o="{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; leafHashes: Uint8Array[]; }";function c(l){return Array.isArray(l.leafHashes)&&l.leafHashes.every(x=>x instanceof Uint8Array&&x.length===32)&&t.check(l)}return{decode:n,encode:r,check:c,expected:o,canAddToArray:t.canAddToArray}}function makeConverter$1(e){function t(l){if(l.key[0]!==e||l.key.length!==1)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+toHex(l.key));if(l.value.length!==32)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return l.value}function n(l){return{key:Uint8Array.from([e]),value:l}}const r="Uint8Array";function o(l){return l instanceof Uint8Array&&l.length===32}function c(l,x){return!!l&&!!x&&l.tapInternalKey===void 0}return{decode:t,encode:n,check:o,expected:r,canAdd:c}}function makeConverter(e){function t(l){if(l.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+toHex(l.key));return l.value}function n(l){return{key:Uint8Array.from([e]),value:l}}const r="Uint8Array";function o(l){return l instanceof Uint8Array}function c(l,x){return!!l&&!!x&&l.witnessScript===void 0}return{decode:t,encode:n,check:o,expected:r,canAdd:c}}const globals={unsignedTx,globalXpub,checkPubkey:makeChecker([])},inputs={nonWitnessUtxo,partialSig,sighashType,finalScriptSig,finalScriptWitness,porCommitment,witnessUtxo,bip32Derivation:makeConverter$4(InputTypes.BIP32_DERIVATION),redeemScript:makeConverter$3(InputTypes.REDEEM_SCRIPT),witnessScript:makeConverter(InputTypes.WITNESS_SCRIPT),checkPubkey:makeChecker([InputTypes.PARTIAL_SIG,InputTypes.BIP32_DERIVATION]),tapKeySig,tapScriptSig,tapLeafScript,tapBip32Derivation:makeConverter$2(InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:makeConverter$1(InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot},outputs={bip32Derivation:makeConverter$4(OutputTypes.BIP32_DERIVATION),redeemScript:makeConverter$3(OutputTypes.REDEEM_SCRIPT),witnessScript:makeConverter(OutputTypes.WITNESS_SCRIPT),checkPubkey:makeChecker([OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:makeConverter$2(OutputTypes.TAP_BIP32_DERIVATION),tapTree,tapInternalKey:makeConverter$1(OutputTypes.TAP_INTERNAL_KEY)},converter=Object.freeze(Object.defineProperty({__proto__:null,globals,inputs,outputs},Symbol.toStringTag,{value:"Module"})),range$1=e=>[...Array(e).keys()];function keyValsToBuffer(e){const t=e.map(keyValToBuffer);return t.push(Uint8Array.from([0])),concat$1(t)}function keyValToBuffer(e){const t=e.key.length,n=e.value.length,r=encodingLength(t),o=encodingLength(n),c=new Uint8Array(r+t+o+n);return encode$f(t,c,0),c.set(e.key,r),encode$f(n,c,r+t),c.set(e.value,r+t+o),c}function psbtFromBuffer(e,t){let n=0;function r(){const{numberValue:F,bytes:H}=decode$e(e,n);n+=H;const Y=e.slice(n,n+Number(F));return n+=Number(F),Y}function o(){const F=readUInt32$1(e,n,"BE");return n+=4,F}function c(){const F=readUInt8(e,n);return n+=1,F}function l(){const F=r(),H=r();return{key:F,value:H}}function x(){if(n>=e.length)throw new Error("Format Error: Unexpected End of PSBT");const F=readUInt8(e,n)===0;return F&&n++,F}if(o()!==1886610036)throw new Error("Format Error: Invalid Magic Number");if(c()!==255)throw new Error("Format Error: Magic Number must be followed by 0xff separator");const f=[],m={};for(;!x();){const F=l(),H=toHex(F.key);if(m[H])throw new Error("Format Error: Keys must be unique for global keymap: key "+H);m[H]=1,f.push(F)}const E=f.filter(F=>F.key[0]===GlobalTypes.UNSIGNED_TX);if(E.length!==1)throw new Error("Format Error: Only one UNSIGNED_TX allowed");const g=t(E[0].value),{inputCount:y,outputCount:w}=g.getInputOutputCounts(),v=[],_=[];for(const F of range$1(y)){const H={},Y=[];for(;!x();){const T=l(),L=toHex(T.key);if(H[L])throw new Error("Format Error: Keys must be unique for each input: input index "+F+" key "+L);H[L]=1,Y.push(T)}v.push(Y)}for(const F of range$1(w)){const H={},Y=[];for(;!x();){const T=l(),L=toHex(T.key);if(H[L])throw new Error("Format Error: Keys must be unique for each output: output index "+F+" key "+L);H[L]=1,Y.push(T)}_.push(Y)}return psbtFromKeyVals(g,{globalMapKeyVals:f,inputKeyVals:v,outputKeyVals:_})}function checkKeyBuffer(e,t,n){if(compare(t,Uint8Array.from([n])))throw new Error(`Format Error: Invalid ${e} key: ${toHex(t)}`)}function psbtFromKeyVals(e,{globalMapKeyVals:t,inputKeyVals:n,outputKeyVals:r}){const o={unsignedTx:e};let c=0;for(const E of t)switch(E.key[0]){case GlobalTypes.UNSIGNED_TX:if(checkKeyBuffer("global",E.key,GlobalTypes.UNSIGNED_TX),c>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");c++;break;case GlobalTypes.GLOBAL_XPUB:o.globalXpub===void 0&&(o.globalXpub=[]),o.globalXpub.push(globals.globalXpub.decode(E));break;default:o.unknownKeyVals||(o.unknownKeyVals=[]),o.unknownKeyVals.push(E)}const l=n.length,x=r.length,f=[],m=[];for(const E of range$1(l)){const g={};for(const y of n[E])switch(inputs.checkPubkey(y),y.key[0]){case InputTypes.NON_WITNESS_UTXO:if(checkKeyBuffer("input",y.key,InputTypes.NON_WITNESS_UTXO),g.nonWitnessUtxo!==void 0)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");g.nonWitnessUtxo=inputs.nonWitnessUtxo.decode(y);break;case InputTypes.WITNESS_UTXO:if(checkKeyBuffer("input",y.key,InputTypes.WITNESS_UTXO),g.witnessUtxo!==void 0)throw new Error("Format Error: Input has multiple WITNESS_UTXO");g.witnessUtxo=inputs.witnessUtxo.decode(y);break;case InputTypes.PARTIAL_SIG:g.partialSig===void 0&&(g.partialSig=[]),g.partialSig.push(inputs.partialSig.decode(y));break;case InputTypes.SIGHASH_TYPE:if(checkKeyBuffer("input",y.key,InputTypes.SIGHASH_TYPE),g.sighashType!==void 0)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");g.sighashType=inputs.sighashType.decode(y);break;case InputTypes.REDEEM_SCRIPT:if(checkKeyBuffer("input",y.key,InputTypes.REDEEM_SCRIPT),g.redeemScript!==void 0)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");g.redeemScript=inputs.redeemScript.decode(y);break;case InputTypes.WITNESS_SCRIPT:if(checkKeyBuffer("input",y.key,InputTypes.WITNESS_SCRIPT),g.witnessScript!==void 0)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");g.witnessScript=inputs.witnessScript.decode(y);break;case InputTypes.BIP32_DERIVATION:g.bip32Derivation===void 0&&(g.bip32Derivation=[]),g.bip32Derivation.push(inputs.bip32Derivation.decode(y));break;case InputTypes.FINAL_SCRIPTSIG:checkKeyBuffer("input",y.key,InputTypes.FINAL_SCRIPTSIG),g.finalScriptSig=inputs.finalScriptSig.decode(y);break;case InputTypes.FINAL_SCRIPTWITNESS:checkKeyBuffer("input",y.key,InputTypes.FINAL_SCRIPTWITNESS),g.finalScriptWitness=inputs.finalScriptWitness.decode(y);break;case InputTypes.POR_COMMITMENT:checkKeyBuffer("input",y.key,InputTypes.POR_COMMITMENT),g.porCommitment=inputs.porCommitment.decode(y);break;case InputTypes.TAP_KEY_SIG:checkKeyBuffer("input",y.key,InputTypes.TAP_KEY_SIG),g.tapKeySig=inputs.tapKeySig.decode(y);break;case InputTypes.TAP_SCRIPT_SIG:g.tapScriptSig===void 0&&(g.tapScriptSig=[]),g.tapScriptSig.push(inputs.tapScriptSig.decode(y));break;case InputTypes.TAP_LEAF_SCRIPT:g.tapLeafScript===void 0&&(g.tapLeafScript=[]),g.tapLeafScript.push(inputs.tapLeafScript.decode(y));break;case InputTypes.TAP_BIP32_DERIVATION:g.tapBip32Derivation===void 0&&(g.tapBip32Derivation=[]),g.tapBip32Derivation.push(inputs.tapBip32Derivation.decode(y));break;case InputTypes.TAP_INTERNAL_KEY:checkKeyBuffer("input",y.key,InputTypes.TAP_INTERNAL_KEY),g.tapInternalKey=inputs.tapInternalKey.decode(y);break;case InputTypes.TAP_MERKLE_ROOT:checkKeyBuffer("input",y.key,InputTypes.TAP_MERKLE_ROOT),g.tapMerkleRoot=inputs.tapMerkleRoot.decode(y);break;default:g.unknownKeyVals||(g.unknownKeyVals=[]),g.unknownKeyVals.push(y)}f.push(g)}for(const E of range$1(x)){const g={};for(const y of r[E])switch(outputs.checkPubkey(y),y.key[0]){case OutputTypes.REDEEM_SCRIPT:if(checkKeyBuffer("output",y.key,OutputTypes.REDEEM_SCRIPT),g.redeemScript!==void 0)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");g.redeemScript=outputs.redeemScript.decode(y);break;case OutputTypes.WITNESS_SCRIPT:if(checkKeyBuffer("output",y.key,OutputTypes.WITNESS_SCRIPT),g.witnessScript!==void 0)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");g.witnessScript=outputs.witnessScript.decode(y);break;case OutputTypes.BIP32_DERIVATION:g.bip32Derivation===void 0&&(g.bip32Derivation=[]),g.bip32Derivation.push(outputs.bip32Derivation.decode(y));break;case OutputTypes.TAP_INTERNAL_KEY:checkKeyBuffer("output",y.key,OutputTypes.TAP_INTERNAL_KEY),g.tapInternalKey=outputs.tapInternalKey.decode(y);break;case OutputTypes.TAP_TREE:checkKeyBuffer("output",y.key,OutputTypes.TAP_TREE),g.tapTree=outputs.tapTree.decode(y);break;case OutputTypes.TAP_BIP32_DERIVATION:g.tapBip32Derivation===void 0&&(g.tapBip32Derivation=[]),g.tapBip32Derivation.push(outputs.tapBip32Derivation.decode(y));break;default:g.unknownKeyVals||(g.unknownKeyVals=[]),g.unknownKeyVals.push(y)}m.push(g)}return{globalMap:o,inputs:f,outputs:m}}function psbtToBuffer({globalMap:e,inputs:t,outputs:n}){const{globalKeyVals:r,inputKeyVals:o,outputKeyVals:c}=psbtToKeyVals({globalMap:e,inputs:t,outputs:n}),l=keyValsToBuffer(r),x=g=>g.length===0?[Uint8Array.from([0])]:g.map(keyValsToBuffer),f=x(o),m=x(c),E=new Uint8Array(5);return E.set([112,115,98,116,255],0),concat$1([E,l].concat(f,m))}const sortKeyVals=(e,t)=>compare(e.key,t.key);function keyValsFromMap(e,t){const n=new Set,r=Object.entries(e).reduce((c,[l,x])=>{if(l==="unknownKeyVals")return c;const f=t[l];if(f===void 0)return c;const m=(Array.isArray(x)?x:[x]).map(f.encode);return m.map(g=>toHex(g.key)).forEach(g=>{if(n.has(g))throw new Error("Serialize Error: Duplicate key: "+g);n.add(g)}),c.concat(m)},[]),o=e.unknownKeyVals?e.unknownKeyVals.filter(c=>!n.has(toHex(c.key))):[];return r.concat(o).sort(sortKeyVals)}function psbtToKeyVals({globalMap:e,inputs:t,outputs:n}){return{globalKeyVals:keyValsFromMap(e,globals),inputKeyVals:t.map(r=>keyValsFromMap(r,inputs)),outputKeyVals:n.map(r=>keyValsFromMap(r,outputs))}}function combine(e){const t=e[0],n=psbtToKeyVals(t),r=e.slice(1);if(r.length===0)throw new Error("Combine: Nothing to combine");const o=getTx(t);if(o===void 0)throw new Error("Combine: Self missing transaction");const c=getKeySet(n.globalKeyVals),l=n.inputKeyVals.map(getKeySet),x=n.outputKeyVals.map(getKeySet);for(const f of r){const m=getTx(f);if(m===void 0||compare(m.toBuffer(),o.toBuffer())!==0)throw new Error("Combine: One of the Psbts does not have the same transaction.");const E=psbtToKeyVals(f);getKeySet(E.globalKeyVals).forEach(keyPusher(c,n.globalKeyVals,E.globalKeyVals)),E.inputKeyVals.map(getKeySet).forEach((v,_)=>v.forEach(keyPusher(l[_],n.inputKeyVals[_],E.inputKeyVals[_]))),E.outputKeyVals.map(getKeySet).forEach((v,_)=>v.forEach(keyPusher(x[_],n.outputKeyVals[_],E.outputKeyVals[_])))}return psbtFromKeyVals(o,{globalMapKeyVals:n.globalKeyVals,inputKeyVals:n.inputKeyVals,outputKeyVals:n.outputKeyVals})}function keyPusher(e,t,n){return r=>{if(e.has(r))return;const o=n.filter(c=>toHex(c.key)===r)[0];t.push(o),e.add(r)}}function getTx(e){return e.globalMap.unsignedTx}function getKeySet(e){const t=new Set;return e.forEach(n=>{const r=toHex(n.key);if(t.has(r))throw new Error("Combine: KeyValue Map keys should be unique");t.add(r)}),t}function checkForInput(e,t){const n=e[t];if(n===void 0)throw new Error(`No input #${t}`);return n}function checkForOutput(e,t){const n=e[t];if(n===void 0)throw new Error(`No output #${t}`);return n}function checkHasKey(e,t,n){if(e.key[0]<n)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&t.filter(r=>compare(r.key,e.key)===0).length!==0)throw new Error(`Duplicate Key: ${toHex(e.key)}`)}function getEnumLength(e){let t=0;return Object.keys(e).forEach(n=>{Number(isNaN(Number(n)))&&t++}),t}function inputCheckUncleanFinalized(e,t){let n=!1;if(t.nonWitnessUtxo||t.witnessUtxo){const r=!!t.redeemScript,o=!!t.witnessScript,c=!r||!!t.finalScriptSig,l=!o||!!t.finalScriptWitness,x=!!t.finalScriptSig||!!t.finalScriptWitness;n=c&&l&&x}if(n===!1)throw new Error(`Input #${e} has too much or too little data to clean`)}function throwForUpdateMaker(e,t,n,r){throw new Error(`Data for ${e} key ${t} is incorrect: Expected ${n} and got ${JSON.stringify(r)}`)}function updateMaker(e){return(t,n)=>{for(const r of Object.keys(t)){const o=t[r],{canAdd:c,canAddToArray:l,check:x,expected:f}=converter[e+"s"][r]||{},m=!!l;if(x)if(m){if(!Array.isArray(o)||n[r]&&!Array.isArray(n[r]))throw new Error(`Key type ${r} must be an array`);o.every(x)||throwForUpdateMaker(e,r,f,o);const E=n[r]||[],g=new Set;if(!o.every(y=>l(E,y,g)))throw new Error("Can not add duplicate data to array");n[r]=E.concat(o)}else{if(x(o)||throwForUpdateMaker(e,r,f,o),!c(n,o))throw new Error(`Can not add duplicate data to ${e}`);n[r]=o}}}}const updateGlobal=updateMaker("global"),updateInput=updateMaker("input"),updateOutput=updateMaker("output");function addInputAttributes(e,t){const n=e.length-1,r=checkForInput(e,n);updateInput(t,r)}function addOutputAttributes(e,t){const n=e.length-1,r=checkForOutput(e,n);updateOutput(t,r)}let Psbt$1=class{constructor(t){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:t}}static fromBase64(t,n){const r=fromBase64(t);return this.fromBuffer(r,n)}static fromHex(t,n){const r=fromHex(t);return this.fromBuffer(r,n)}static fromBuffer(t,n){const r=psbtFromBuffer(t,n),o=new this(r.globalMap.unsignedTx);return Object.assign(o,r),o}toBase64(){const t=this.toBuffer();return toBase64(t)}toHex(){const t=this.toBuffer();return toHex(t)}toBuffer(){return psbtToBuffer(this)}updateGlobal(t){return updateGlobal(t,this.globalMap),this}updateInput(t,n){const r=checkForInput(this.inputs,t);return updateInput(n,r),this}updateOutput(t,n){const r=checkForOutput(this.outputs,t);return updateOutput(n,r),this}addUnknownKeyValToGlobal(t){return checkHasKey(t,this.globalMap.unknownKeyVals,getEnumLength(GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(t),this}addUnknownKeyValToInput(t,n){const r=checkForInput(this.inputs,t);return checkHasKey(n,r.unknownKeyVals,getEnumLength(InputTypes)),r.unknownKeyVals||(r.unknownKeyVals=[]),r.unknownKeyVals.push(n),this}addUnknownKeyValToOutput(t,n){const r=checkForOutput(this.outputs,t);return checkHasKey(n,r.unknownKeyVals,getEnumLength(OutputTypes)),r.unknownKeyVals||(r.unknownKeyVals=[]),r.unknownKeyVals.push(n),this}addInput(t){this.globalMap.unsignedTx.addInput(t),this.inputs.push({unknownKeyVals:[]});const n=t.unknownKeyVals||[],r=this.inputs.length-1;if(!Array.isArray(n))throw new Error("unknownKeyVals must be an Array");return n.forEach(o=>this.addUnknownKeyValToInput(r,o)),addInputAttributes(this.inputs,t),this}addOutput(t){this.globalMap.unsignedTx.addOutput(t),this.outputs.push({unknownKeyVals:[]});const n=t.unknownKeyVals||[],r=this.outputs.length-1;if(!Array.isArray(n))throw new Error("unknownKeyVals must be an Array");return n.forEach(o=>this.addUnknownKeyValToOutput(r,o)),addOutputAttributes(this.outputs,t),this}clearFinalizedInput(t){const n=checkForInput(this.inputs,t);inputCheckUncleanFinalized(t,n);for(const r of Object.keys(n))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(r)||delete n[r];return this}combine(...t){const n=combine([this].concat(t));return Object.assign(this,n),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}};function isPaymentFactory(e){return t=>{try{return e({output:t}),!0}catch{return!1}}}const isP2MS=isPaymentFactory(p2ms),isP2PK=isPaymentFactory(p2pk),isP2PKH=isPaymentFactory(p2pkh),isP2WPKH=isPaymentFactory(p2wpkh),isP2WSHScript=isPaymentFactory(p2wsh),isP2SHScript=isPaymentFactory(p2sh),isP2TR=isPaymentFactory(p2tr);function witnessStackToScriptWitness(e){let t=new Uint8Array(0);function n(l){t=concat$1([t,l])}function r(l){const x=t.length,f=encodingLength(l);t=concat$1([t,new Uint8Array(f)]),encode$f(l,t,x)}function o(l){r(l.length),n(l)}function c(l){r(l.length),l.forEach(o)}return c(e),t}function pubkeyPositionInScript(e,t){const n=hash160(e),r=e.slice(1,33),o=decompile(t);if(o===null)throw new Error("Unknown script error");return o.findIndex(c=>typeof c=="number"?!1:compare(e,c)===0||compare(n,c)===0||compare(r,c)===0)}function pubkeyInScript(e,t){return pubkeyPositionInScript(e,t)!==-1}function checkInputForSig(e,t){return extractPartialSigs(e).some(r=>signatureBlocksAction(r,signature.decode,t))}function signatureBlocksAction(e,t,n){const{hashType:r}=t(e),o=[];switch(r&Transaction.SIGHASH_ANYONECANPAY&&o.push("addInput"),r&31){case Transaction.SIGHASH_ALL:break;case Transaction.SIGHASH_SINGLE:case Transaction.SIGHASH_NONE:o.push("addOutput"),o.push("setInputSequence");break}return o.indexOf(n)===-1}function extractPartialSigs(e){let t=[];if((e.partialSig||[]).length===0){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=getPsigsFromInputFinalScripts(e)}else t=e.partialSig;return t.map(n=>n.signature)}function getPsigsFromInputFinalScripts(e){const t=e.finalScriptSig?decompile(e.finalScriptSig)||[]:[],n=e.finalScriptWitness?decompile(e.finalScriptWitness)||[]:[];return t.concat(n).filter(r=>r instanceof Uint8Array&&isCanonicalScriptSignature(r)).map(r=>({signature:r}))}const toXOnly$1=e=>e.length===32?e:e.slice(1,33);function tapScriptFinalizer(e,t,n){const r=findTapLeafToFinalize(t,e,n);try{const c=sortSignatures(t,r).concat(r.script).concat(r.controlBlock);return{finalScriptWitness:witnessStackToScriptWitness(c)}}catch(o){throw new Error(`Can not finalize taproot input #${e}: ${o}`)}}function serializeTaprootSignature(e,t){const n=Uint8Array.from(t?[t]:[]);return concat$1([e,n])}function isTaprootInput(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&isP2TR(e.witnessUtxo.script))}function isTaprootOutput(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t)}function checkTaprootInputFields(e,t,n){checkMixedTaprootAndNonTaprootInputFields(e,t,n),checkIfTapLeafInTree(e,t,n)}function checkTaprootOutputFields(e,t,n){checkMixedTaprootAndNonTaprootOutputFields(e,t,n),checkTaprootScriptPubkey(e,t)}function checkTaprootScriptPubkey(e,t){if(!t.tapTree&&!t.tapInternalKey)return;const n=t.tapInternalKey||e.tapInternalKey,r=t.tapTree||e.tapTree;if(n){const{script:o}=e,c=getTaprootScripPubkey(n,r);if(o&&compare(c,o)!==0)throw new Error("Error adding output. Script or address mismatch.")}}function getTaprootScripPubkey(e,t){const n=t&&tapTreeFromList(t.leaves),{output:r}=p2tr({internalPubkey:e,scriptTree:n});return r}function tapTreeFromList(e=[]){return e.length===1&&e[0].depth===0?{output:e[0].script,version:e[0].leafVersion}:instertLeavesInTree(e)}function checkTaprootInputForSigs(e,t){return extractTaprootSigs(e).some(r=>signatureBlocksAction(r,decodeSchnorrSignature,t))}function decodeSchnorrSignature(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||Transaction.SIGHASH_DEFAULT}}function extractTaprootSigs(e){const t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(n=>n.signature)),!t.length){const n=getTapKeySigFromWitness(e.finalScriptWitness);n&&t.push(n)}return t}function getTapKeySigFromWitness(e){if(!e)return;const t=e.slice(2);if(t.length===64||t.length===65)return t}function instertLeavesInTree(e){let t;for(const n of e)if(t=instertLeafInTree(n,t),!t)throw new Error("No room left to insert tapleaf in tree");return t}function instertLeafInTree(e,t,n=0){if(n>MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===n)return t?void 0:{output:e.script,version:e.leafVersion};if(isTapleaf(t))return;const r=instertLeafInTree(e,t&&t[0],n+1);if(r)return[r,t&&t[1]];const o=instertLeafInTree(e,t&&t[1],n+1);if(o)return[t&&t[0],o]}function checkMixedTaprootAndNonTaprootInputFields(e,t,n){const r=isTaprootInput(e)&&hasNonTaprootFields(t),o=hasNonTaprootFields(e)&&isTaprootInput(t),c=e===t&&isTaprootInput(t)&&hasNonTaprootFields(t);if(r||o||c)throw new Error(`Invalid arguments for Psbt.${n}. Cannot use both taproot and non-taproot fields.`)}function checkMixedTaprootAndNonTaprootOutputFields(e,t,n){const r=isTaprootOutput(e)&&hasNonTaprootFields(t),o=hasNonTaprootFields(e)&&isTaprootOutput(t),c=e===t&&isTaprootOutput(t)&&hasNonTaprootFields(t);if(r||o||c)throw new Error(`Invalid arguments for Psbt.${n}. Cannot use both taproot and non-taproot fields.`)}function checkIfTapLeafInTree(e,t,n){if(t.tapMerkleRoot){const r=(t.tapLeafScript||[]).every(c=>isTapLeafInTree(c,t.tapMerkleRoot)),o=(e.tapLeafScript||[]).every(c=>isTapLeafInTree(c,t.tapMerkleRoot));if(!r||!o)throw new Error(`Invalid arguments for Psbt.${n}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(o=>isTapLeafInTree(o,e.tapMerkleRoot)))throw new Error(`Invalid arguments for Psbt.${n}. Tapleaf not part of taptree.`)}function isTapLeafInTree(e,t){if(!t)return!0;const n=tapleafHash({output:e.script,version:e.leafVersion}),r=rootHashFromPath(e.controlBlock,n);return compare(r,t)===0}function sortSignatures(e,t){const n=tapleafHash({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(r=>compare(r.leafHash,n)===0).map(r=>addPubkeyPositionInScript(t.script,r)).sort((r,o)=>o.positionInScript-r.positionInScript).map(r=>r.signature)}function addPubkeyPositionInScript(e,t){return Object.assign({positionInScript:pubkeyPositionInScript(t.pubkey,e)},t)}function findTapLeafToFinalize(e,t,n){if(!e.tapScriptSig||!e.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);const r=(e.tapLeafScript||[]).sort((o,c)=>o.controlBlock.length-c.controlBlock.length).find(o=>canFinalizeLeaf(o,e.tapScriptSig,n));if(!r)throw new Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return r}function canFinalizeLeaf(e,t,n){const r=tapleafHash({output:e.script,version:e.leafVersion});return(!n||compare(r,n)===0)&&t.find(c=>compare(c.leafHash,r)===0)!==void 0}function hasNonTaprootFields(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}const DEFAULT_OPTS={network:bitcoin$1,maximumFeeRate:5e3};class Psbt{data;static fromBase64(t,n={}){const r=fromBase64(t);return this.fromBuffer(r,n)}static fromHex(t,n={}){const r=fromHex(t);return this.fromBuffer(r,n)}static fromBuffer(t,n={}){const r=Psbt$1.fromBuffer(t,transactionFromBuffer),o=new Psbt(n,r);return checkTxForDupeIns(o.__CACHE.__TX,o.__CACHE),o}__CACHE;opts;constructor(t={},n=new Psbt$1(new PsbtTransaction)){this.data=n,this.opts=Object.assign({},DEFAULT_OPTS,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},this.data.inputs.length===0&&this.setVersion(2);const r=(o,c,l,x)=>Object.defineProperty(o,c,{enumerable:l,writable:x});r(this,"__CACHE",!1,!0),r(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:cloneBuffer(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let n;try{n=fromOutputScript(t.script,this.opts.network)}catch{}return{script:cloneBuffer(t.script),value:t.value,address:n}})}combine(...t){return this.data.combine(...t.map(n=>n.data)),this}clone(){const t=Psbt.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){check32Bit(t),this.opts.maximumFeeRate=t}setVersion(t){check32Bit(t),checkInputsForPartialSig(this.data.inputs,"setVersion");const n=this.__CACHE;return n.__TX.version=t,n.__EXTRACTED_TX=void 0,this}setLocktime(t){check32Bit(t),checkInputsForPartialSig(this.data.inputs,"setLocktime");const n=this.__CACHE;return n.__TX.locktime=t,n.__EXTRACTED_TX=void 0,this}setInputSequence(t,n){check32Bit(n),checkInputsForPartialSig(this.data.inputs,"setInputSequence");const r=this.__CACHE;if(r.__TX.ins.length<=t)throw new Error("Input index too high");return r.__TX.ins[t].sequence=n,r.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(n=>this.addInput(n)),this}addInput(t){if(arguments.length>1||!t||t.hash===void 0||t.index===void 0)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");checkTaprootInputFields(t,t,"addInput"),checkInputsForPartialSig(this.data.inputs,"addInput"),t.witnessScript&&checkInvalidP2WSH(t.witnessScript);const n=this.__CACHE;this.data.addInput(t);const r=n.__TX.ins[n.__TX.ins.length-1];checkTxInputCache(n,r);const o=this.data.inputs.length-1,c=this.data.inputs[o];return c.nonWitnessUtxo&&addNonWitnessTxCache(this.__CACHE,c,o),n.__FEE=void 0,n.__FEE_RATE=void 0,n.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(n=>this.addOutput(n)),this}addOutput(t){if(arguments.length>1||!t||t.value===void 0||t.address===void 0&&t.script===void 0)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");checkInputsForPartialSig(this.data.inputs,"addOutput");const{address:n}=t;if(typeof n=="string"){const{network:o}=this.opts,c=toOutputScript(n,o);t=Object.assign({},t,{script:c})}checkTaprootOutputFields(t,t,"addOutput");const r=this.__CACHE;return this.data.addOutput(t),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(isFinalized))throw new Error("Not finalized");const n=this.__CACHE;if(t||checkFees(this,n,this.opts),n.__EXTRACTED_TX)return n.__EXTRACTED_TX;const r=n.__TX.clone();return inputFinalizeGetAmts(this.data.inputs,r,n,!0),r}getFeeRate(){return getTxCacheValue("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return getTxCacheValue("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return checkForInput(this.data.inputs,0),range(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,n){const r=checkForInput(this.data.inputs,t);return isTaprootInput(r)?this._finalizeTaprootInput(t,r,void 0,n):this._finalizeInput(t,r,n)}finalizeTaprootInput(t,n,r=tapScriptFinalizer){const o=checkForInput(this.data.inputs,t);if(isTaprootInput(o))return this._finalizeTaprootInput(t,o,n,r);throw new Error(`Cannot finalize input #${t}. Not Taproot.`)}_finalizeInput(t,n,r=getFinalScripts){const{script:o,isP2SH:c,isP2WSH:l,isSegwit:x}=getScriptFromInput(t,n,this.__CACHE);if(!o)throw new Error(`No script found for input #${t}`);checkPartialSigSighashes(n);const{finalScriptSig:f,finalScriptWitness:m}=r(t,n,o,x,c,l);if(f&&this.data.updateInput(t,{finalScriptSig:f}),m&&this.data.updateInput(t,{finalScriptWitness:m}),!f&&!m)throw new Error(`Unknown error finalizing input #${t}`);return this.data.clearFinalizedInput(t),this}_finalizeTaprootInput(t,n,r,o=tapScriptFinalizer){if(!n.witnessUtxo)throw new Error(`Cannot finalize input #${t}. Missing withness utxo.`);if(n.tapKeySig){const c=p2tr({output:n.witnessUtxo.script,signature:n.tapKeySig}),l=witnessStackToScriptWitness(c.witness);this.data.updateInput(t,{finalScriptWitness:l})}else{const{finalScriptWitness:c}=o(t,n,r);this.data.updateInput(t,{finalScriptWitness:c})}return this.data.clearFinalizedInput(t),this}getInputType(t){const n=checkForInput(this.data.inputs,t),r=getScriptFromUtxo(t,n,this.__CACHE),o=getMeaningfulScript(r,t,"input",n.redeemScript||redeemFromFinalScriptSig(n.finalScriptSig),n.witnessScript||redeemFromFinalWitnessScript(n.finalScriptWitness)),c=o.type==="raw"?"":o.type+"-",l=classifyScript(o.meaningfulScript);return c+l}inputHasPubkey(t,n){const r=checkForInput(this.data.inputs,t);return pubkeyInInput(n,r,t,this.__CACHE)}inputHasHDKey(t,n){const r=checkForInput(this.data.inputs,t),o=bip32DerivationIsMine(n);return!!r.bip32Derivation&&r.bip32Derivation.some(o)}outputHasPubkey(t,n){const r=checkForOutput(this.data.outputs,t);return pubkeyInOutput(n,r,t,this.__CACHE)}outputHasHDKey(t,n){const r=checkForOutput(this.data.outputs,t),o=bip32DerivationIsMine(n);return!!r.bip32Derivation&&r.bip32Derivation.some(o)}validateSignaturesOfAllInputs(t){return checkForInput(this.data.inputs,0),range(this.data.inputs.length).map(r=>this.validateSignaturesOfInput(r,t)).reduce((r,o)=>o===!0&&r,!0)}validateSignaturesOfInput(t,n,r){const o=this.data.inputs[t];return isTaprootInput(o)?this.validateSignaturesOfTaprootInput(t,n,r):this._validateSignaturesOfInput(t,n,r)}_validateSignaturesOfInput(t,n,r){const o=this.data.inputs[t],c=(o||{}).partialSig;if(!o||!c||c.length<1)throw new Error("No signatures to validate");if(typeof n!="function")throw new Error("Need validator function to validate signatures");const l=r?c.filter(g=>compare(g.pubkey,r)===0):c;if(l.length<1)throw new Error("No signatures for this pubkey");const x=[];let f,m,E;for(const g of l){const y=signature.decode(g.signature),{hash:w,script:v}=E!==y.hashType?getHashForSig(t,Object.assign({},o,{sighashType:y.hashType}),this.__CACHE,!0):{hash:f,script:m};E=y.hashType,f=w,m=v,checkScriptForPubkey(g.pubkey,v,"verify"),x.push(n(g.pubkey,w,y.signature))}return x.every(g=>g===!0)}validateSignaturesOfTaprootInput(t,n,r){const o=this.data.inputs[t],c=(o||{}).tapKeySig,l=(o||{}).tapScriptSig;if(!o&&!c&&!(l&&!l.length))throw new Error("No signatures to validate");if(typeof n!="function")throw new Error("Need validator function to validate signatures");r=r&&toXOnly$1(r);const x=r?getTaprootHashesForSig(t,o,this.data.inputs,r,this.__CACHE):getAllTaprootHashesForSig(t,o,this.data.inputs,this.__CACHE);if(!x.length)throw new Error("No signatures for this pubkey");const f=x.find(E=>!E.leafHash);let m=0;if(c&&f){if(!n(f.pubkey,f.hash,trimTaprootSig(c)))return!1;m++}if(l)for(const E of l){const g=x.find(y=>compare(y.pubkey,E.pubkey)===0);if(g){if(!n(E.pubkey,g.hash,trimTaprootSig(E.signature)))return!1;m++}}return m>0}signAllInputsHD(t,n=[Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");const r=[];for(const o of range(this.data.inputs.length))try{this.signInputHD(o,t,n),r.push(!0)}catch{r.push(!1)}if(r.every(o=>o===!1))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(t,n=[Transaction.SIGHASH_ALL]){return new Promise((r,o)=>{if(!t||!t.publicKey||!t.fingerprint)return o(new Error("Need HDSigner to sign input"));const c=[],l=[];for(const x of range(this.data.inputs.length))l.push(this.signInputHDAsync(x,t,n).then(()=>{c.push(!0)},()=>{c.push(!1)}));return Promise.all(l).then(()=>{if(c.every(x=>x===!1))return o(new Error("No inputs were signed"));r()})})}signInputHD(t,n,r=[Transaction.SIGHASH_ALL]){if(!n||!n.publicKey||!n.fingerprint)throw new Error("Need HDSigner to sign input");return getSignersFromHD(t,this.data.inputs,n).forEach(c=>this.signInput(t,c,r)),this}signInputHDAsync(t,n,r=[Transaction.SIGHASH_ALL]){return new Promise((o,c)=>{if(!n||!n.publicKey||!n.fingerprint)return c(new Error("Need HDSigner to sign input"));const x=getSignersFromHD(t,this.data.inputs,n).map(f=>this.signInputAsync(t,f,r));return Promise.all(x).then(()=>{o()}).catch(c)})}signAllInputs(t,n){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const r=[];for(const o of range(this.data.inputs.length))try{this.signInput(o,t,n),r.push(!0)}catch{r.push(!1)}if(r.every(o=>o===!1))throw new Error("No inputs were signed");return this}signAllInputsAsync(t,n){return new Promise((r,o)=>{if(!t||!t.publicKey)return o(new Error("Need Signer to sign input"));const c=[],l=[];for(const[x]of this.data.inputs.entries())l.push(this.signInputAsync(x,t,n).then(()=>{c.push(!0)},()=>{c.push(!1)}));return Promise.all(l).then(()=>{if(c.every(x=>x===!1))return o(new Error("No inputs were signed"));r()})})}signInput(t,n,r){if(!n||!n.publicKey)throw new Error("Need Signer to sign input");const o=checkForInput(this.data.inputs,t);return isTaprootInput(o)?this._signTaprootInput(t,o,n,void 0,r):this._signInput(t,n,r)}signTaprootInput(t,n,r,o){if(!n||!n.publicKey)throw new Error("Need Signer to sign input");const c=checkForInput(this.data.inputs,t);if(isTaprootInput(c))return this._signTaprootInput(t,c,n,r,o);throw new Error(`Input #${t} is not of type Taproot.`)}_signInput(t,n,r=[Transaction.SIGHASH_ALL]){const{hash:o,sighashType:c}=getHashAndSighashType(this.data.inputs,t,n.publicKey,this.__CACHE,r),l=[{pubkey:n.publicKey,signature:signature.encode(n.sign(o),c)}];return this.data.updateInput(t,{partialSig:l}),this}_signTaprootInput(t,n,r,o,c=[Transaction.SIGHASH_DEFAULT]){const l=this.checkTaprootHashesForSig(t,n,r,o,c),x=l.filter(m=>!m.leafHash).map(m=>serializeTaprootSignature(r.signSchnorr(m.hash),n.sighashType))[0],f=l.filter(m=>!!m.leafHash).map(m=>({pubkey:toXOnly$1(r.publicKey),signature:serializeTaprootSignature(r.signSchnorr(m.hash),n.sighashType),leafHash:m.leafHash}));return x&&this.data.updateInput(t,{tapKeySig:x}),f.length&&this.data.updateInput(t,{tapScriptSig:f}),this}signInputAsync(t,n,r){return Promise.resolve().then(()=>{if(!n||!n.publicKey)throw new Error("Need Signer to sign input");const o=checkForInput(this.data.inputs,t);return isTaprootInput(o)?this._signTaprootInputAsync(t,o,n,void 0,r):this._signInputAsync(t,n,r)})}signTaprootInputAsync(t,n,r,o){return Promise.resolve().then(()=>{if(!n||!n.publicKey)throw new Error("Need Signer to sign input");const c=checkForInput(this.data.inputs,t);if(isTaprootInput(c))return this._signTaprootInputAsync(t,c,n,r,o);throw new Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(t,n,r=[Transaction.SIGHASH_ALL]){const{hash:o,sighashType:c}=getHashAndSighashType(this.data.inputs,t,n.publicKey,this.__CACHE,r);return Promise.resolve(n.sign(o)).then(l=>{const x=[{pubkey:n.publicKey,signature:signature.encode(l,c)}];this.data.updateInput(t,{partialSig:x})})}async _signTaprootInputAsync(t,n,r,o,c=[Transaction.SIGHASH_DEFAULT]){const l=this.checkTaprootHashesForSig(t,n,r,o,c),x=[],f=l.filter(E=>!E.leafHash)[0];if(f){const E=Promise.resolve(r.signSchnorr(f.hash)).then(g=>({tapKeySig:serializeTaprootSignature(g,n.sighashType)}));x.push(E)}const m=l.filter(E=>!!E.leafHash);if(m.length){const E=m.map(g=>Promise.resolve(r.signSchnorr(g.hash)).then(y=>({tapScriptSig:[{pubkey:toXOnly$1(r.publicKey),signature:serializeTaprootSignature(y,n.sighashType),leafHash:g.leafHash}]})));x.push(...E)}return Promise.all(x).then(E=>{E.forEach(g=>this.data.updateInput(t,g))})}checkTaprootHashesForSig(t,n,r,o,c){if(typeof r.signSchnorr!="function")throw new Error(`Need Schnorr Signer to sign taproot input #${t}.`);const l=getTaprootHashesForSig(t,n,this.data.inputs,r.publicKey,this.__CACHE,o,c);if(!l||!l.length)throw new Error(`Can not sign for input #${t} with the key ${toHex(r.publicKey)}`);return l}toBuffer(){return checkCache(this.__CACHE),this.data.toBuffer()}toHex(){return checkCache(this.__CACHE),this.data.toHex()}toBase64(){return checkCache(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,n){return n.witnessScript&&checkInvalidP2WSH(n.witnessScript),checkTaprootInputFields(this.data.inputs[t],n,"updateInput"),this.data.updateInput(t,n),n.nonWitnessUtxo&&addNonWitnessTxCache(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,n){const r=this.data.outputs[t];return checkTaprootOutputFields(r,n,"updateOutput"),this.data.updateOutput(t,n),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,n){return this.data.addUnknownKeyValToInput(t,n),this}addUnknownKeyValToOutput(t,n){return this.data.addUnknownKeyValToOutput(t,n),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}}const transactionFromBuffer=e=>new PsbtTransaction(e);class PsbtTransaction{tx;constructor(t=Uint8Array.from([2,0,0,0,0,0,0,0,0,0])){this.tx=Transaction.fromBuffer(t),checkTxEmpty(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(t.hash===void 0||t.index===void 0||!(t.hash instanceof Uint8Array)&&typeof t.hash!="string"||typeof t.index!="number")throw new Error("Error adding input.");const n=typeof t.hash=="string"?reverseBuffer(fromHex(t.hash)):t.hash;this.tx.addInput(n,t.index,t.sequence)}addOutput(t){if(t.script===void 0||t.value===void 0||!(t.script instanceof Uint8Array)||typeof t.value!="bigint")throw new Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}}function canFinalize(e,t,n){switch(n){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return hasSigs(1,e.partialSig);case"multisig":const r=p2ms({output:t});return hasSigs(r.m,e.partialSig,r.pubkeys);default:return!1}}function checkCache(e){if(e.__UNSAFE_SIGN_NONSEGWIT!==!1)throw new Error("Not BIP174 compliant, can not export")}function hasSigs(e,t,n){if(!t)return!1;let r;if(n?r=n.map(o=>{const c=compressPubkey(o);return t.find(l=>compare(l.pubkey,c)===0)}).filter(o=>!!o):r=t,r.length>e)throw new Error("Too many signatures");return r.length===e}function isFinalized(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function bip32DerivationIsMine(e){return t=>!(compare(e.fingerprint,t.masterFingerprint)||compare(e.derivePath(t.path).publicKey,t.pubkey))}function check32Bit(e){if(typeof e!="number"||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function checkFees(e,t,n){const r=t.__FEE_RATE||e.getFeeRate(),o=t.__EXTRACTED_TX.virtualSize(),c=r*o;if(r>=n.maximumFeeRate)throw new Error(`Warning: You are paying around ${(c/1e8).toFixed(8)} in fees, which is ${r} satoshi per byte for a transaction with a VSize of ${o} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}function checkInputsForPartialSig(e,t){e.forEach(n=>{if(isTaprootInput(n)?checkTaprootInputForSigs(n,t):checkInputForSig(n,t))throw new Error("Can not modify transaction, signatures exist.")})}function checkPartialSigSighashes(e){if(!e.sighashType||!e.partialSig)return;const{partialSig:t,sighashType:n}=e;t.forEach(r=>{const{hashType:o}=signature.decode(r.signature);if(n!==o)throw new Error("Signature sighash does not match input sighash type")})}function checkScriptForPubkey(e,t,n){if(!pubkeyInScript(e,t))throw new Error(`Can not ${n} for this input with the key ${toHex(e)}`)}function checkTxEmpty(e){if(!e.ins.every(n=>n.script&&n.script.length===0&&n.witness&&n.witness.length===0))throw new Error("Format Error: Transaction ScriptSigs are not empty")}function checkTxForDupeIns(e,t){e.ins.forEach(n=>{checkTxInputCache(t,n)})}function checkTxInputCache(e,t){const n=toHex(reverseBuffer(Uint8Array.from(t.hash)))+":"+t.index;if(e.__TX_IN_CACHE[n])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[n]=1}function scriptCheckerFactory(e,t){return(n,r,o,c)=>{const l=e({redeem:{output:o}}).output;if(compare(r,l))throw new Error(`${t} for ${c} #${n} doesn't match the scriptPubKey in the prevout`)}}const checkRedeemScript=scriptCheckerFactory(p2sh,"Redeem script"),checkWitnessScript=scriptCheckerFactory(p2wsh,"Witness script");function getTxCacheValue(e,t,n,r){if(!n.every(isFinalized))throw new Error(`PSBT must be finalized to calculate ${t}`);if(e==="__FEE_RATE"&&r.__FEE_RATE)return r.__FEE_RATE;if(e==="__FEE"&&r.__FEE)return r.__FEE;let o,c=!0;if(r.__EXTRACTED_TX?(o=r.__EXTRACTED_TX,c=!1):o=r.__TX.clone(),inputFinalizeGetAmts(n,o,r,c),e==="__FEE_RATE")return r.__FEE_RATE;if(e==="__FEE")return r.__FEE}function getFinalScripts(e,t,n,r,o,c){const l=classifyScript(n);if(!canFinalize(t,n,l))throw new Error(`Can not finalize input #${e}`);return prepareFinalScripts(n,l,t.partialSig,r,o,c)}function prepareFinalScripts(e,t,n,r,o,c){let l,x;const f=getPayment(e,t,n),m=c?p2wsh({redeem:f}):null,E=o?p2sh({redeem:m||f}):null;return r?(m?x=witnessStackToScriptWitness(m.witness):x=witnessStackToScriptWitness(f.witness),E&&(l=E.input)):E?l=E.input:l=f.input,{finalScriptSig:l,finalScriptWitness:x}}function getHashAndSighashType(e,t,n,r,o){const c=checkForInput(e,t),{hash:l,sighashType:x,script:f}=getHashForSig(t,c,r,!1,o);return checkScriptForPubkey(n,f,"sign"),{hash:l,sighashType:x}}function getHashForSig(e,t,n,r,o){const c=n.__TX,l=t.sighashType||Transaction.SIGHASH_ALL;checkSighashTypeAllowed(l,o);let x,f;if(t.nonWitnessUtxo){const g=nonWitnessUtxoTxFromCache(n,t,e),y=c.ins[e].hash,w=g.getHash();if(compare(y,w)!==0)throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);const v=c.ins[e].index;f=g.outs[v]}else if(t.witnessUtxo)f=t.witnessUtxo;else throw new Error("Need a Utxo input item for signing");const{meaningfulScript:m,type:E}=getMeaningfulScript(f.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(E)>=0)x=c.hashForWitnessV0(e,m,f.value,l);else if(isP2WPKH(m)){const g=p2pkh({hash:m.slice(2)}).output;x=c.hashForWitnessV0(e,g,f.value,l)}else{if(t.nonWitnessUtxo===void 0&&n.__UNSAFE_SIGN_NONSEGWIT===!1)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${toHex(m)}`);!r&&n.__UNSAFE_SIGN_NONSEGWIT!==!1&&console.warn(`Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecessor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.
*********************
PROCEED WITH CAUTION!
*********************`),x=c.hashForSignature(e,m,l)}return{script:m,sighashType:l,hash:x}}function getAllTaprootHashesForSig(e,t,n,r){const o=[];if(t.tapInternalKey){const l=getPrevoutTaprootKey(e,t,r);l&&o.push(l)}if(t.tapScriptSig){const l=t.tapScriptSig.map(x=>x.pubkey);o.push(...l)}return o.map(l=>getTaprootHashesForSig(e,t,n,l,r)).flat()}function getPrevoutTaprootKey(e,t,n){const{script:r}=getScriptAndAmountFromUtxo(e,t,n);return isP2TR(r)?r.subarray(2,34):null}function trimTaprootSig(e){return e.length===64?e:e.subarray(0,64)}function getTaprootHashesForSig(e,t,n,r,o,c,l){const x=o.__TX,f=t.sighashType||Transaction.SIGHASH_DEFAULT;checkSighashTypeAllowed(f,l);const m=n.map((v,_)=>getScriptAndAmountFromUtxo(_,v,o)),E=m.map(v=>v.script),g=m.map(v=>v.value),y=[];if(t.tapInternalKey&&!c){const v=getPrevoutTaprootKey(e,t,o)||Uint8Array.from([]);if(compare(toXOnly$1(r),v)===0){const _=x.hashForWitnessV1(e,E,g,f);y.push({pubkey:r,hash:_})}}const w=(t.tapLeafScript||[]).filter(v=>pubkeyInScript(r,v.script)).map(v=>{const _=tapleafHash({output:v.script,version:v.leafVersion});return Object.assign({hash:_},v)}).filter(v=>!c||compare(c,v.hash)===0).map(v=>{const _=x.hashForWitnessV1(e,E,g,f,v.hash);return{pubkey:r,hash:_,leafHash:v.hash}});return y.concat(w)}function checkSighashTypeAllowed(e,t){if(t&&t.indexOf(e)<0){const n=sighashTypeToString(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${n}`)}}function getPayment(e,t,n){let r;switch(t){case"multisig":const o=getSortedSigs(e,n);r=p2ms({output:e,signatures:o});break;case"pubkey":r=p2pk({output:e,signature:n[0].signature});break;case"pubkeyhash":r=p2pkh({output:e,pubkey:n[0].pubkey,signature:n[0].signature});break;case"witnesspubkeyhash":r=p2wpkh({output:e,pubkey:n[0].pubkey,signature:n[0].signature});break}return r}function getScriptFromInput(e,t,n){const r=n.__TX,o={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(o.isP2SH=!!t.redeemScript,o.isP2WSH=!!t.witnessScript,t.witnessScript)o.script=t.witnessScript;else if(t.redeemScript)o.script=t.redeemScript;else if(t.nonWitnessUtxo){const c=nonWitnessUtxoTxFromCache(n,t,e),l=r.ins[e].index;o.script=c.outs[l].script}else t.witnessUtxo&&(o.script=t.witnessUtxo.script);return(t.witnessScript||isP2WPKH(o.script))&&(o.isSegwit=!0),o}function getSignersFromHD(e,t,n){const r=checkForInput(t,e);if(!r.bip32Derivation||r.bip32Derivation.length===0)throw new Error("Need bip32Derivation to sign with HD");const o=r.bip32Derivation.map(l=>{if(compare(l.masterFingerprint,n.fingerprint)===0)return l}).filter(l=>!!l);if(o.length===0)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return o.map(l=>{const x=n.derivePath(l.path);if(compare(l.pubkey,x.publicKey)!==0)throw new Error("pubkey did not match bip32Derivation");return x})}function getSortedSigs(e,t){return p2ms({output:e}).pubkeys.map(r=>(t.filter(o=>compare(o.pubkey,r)===0)[0]||{}).signature).filter(r=>!!r)}function scriptWitnessToWitnessStack(e){let t=0;function n(l){return t+=l,e.slice(t-l,t)}function r(){const l=decode$e(e,t);return t+=encodingLength(l.bigintValue),l.numberValue}function o(){return n(r())}function c(){const l=r(),x=[];for(let f=0;f<l;f++)x.push(o());return x}return c()}function sighashTypeToString(e){let t=e&Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(e&31){case Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case Transaction.SIGHASH_NONE:t+="SIGHASH_NONE";break}return t}function addNonWitnessTxCache(e,t,n){e.__NON_WITNESS_UTXO_BUF_CACHE[n]=t.nonWitnessUtxo;const r=Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[n]=r;const o=e,c=n;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){const l=o.__NON_WITNESS_UTXO_BUF_CACHE[c],x=o.__NON_WITNESS_UTXO_TX_CACHE[c];if(l!==void 0)return l;{const f=x.toBuffer();return o.__NON_WITNESS_UTXO_BUF_CACHE[c]=f,f}},set(l){o.__NON_WITNESS_UTXO_BUF_CACHE[c]=l}})}function inputFinalizeGetAmts(e,t,n,r){let o=0n;e.forEach((f,m)=>{if(r&&f.finalScriptSig&&(t.ins[m].script=f.finalScriptSig),r&&f.finalScriptWitness&&(t.ins[m].witness=scriptWitnessToWitnessStack(f.finalScriptWitness)),f.witnessUtxo)o+=f.witnessUtxo.value;else if(f.nonWitnessUtxo){const E=nonWitnessUtxoTxFromCache(n,f,m),g=t.ins[m].index,y=E.outs[g];o+=y.value}});const c=t.outs.reduce((f,m)=>f+m.value,0n),l=o-c;if(l<0)throw new Error("Outputs are spending more than Inputs");const x=t.virtualSize();n.__FEE=l,n.__EXTRACTED_TX=t,n.__FEE_RATE=Math.floor(Number(l/BigInt(x)))}function nonWitnessUtxoTxFromCache(e,t,n){const r=e.__NON_WITNESS_UTXO_TX_CACHE;return r[n]||addNonWitnessTxCache(e,t,n),r[n]}function getScriptFromUtxo(e,t,n){const{script:r}=getScriptAndAmountFromUtxo(e,t,n);return r}function getScriptAndAmountFromUtxo(e,t,n){if(t.witnessUtxo!==void 0)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(t.nonWitnessUtxo!==void 0){const o=nonWitnessUtxoTxFromCache(n,t,e).outs[n.__TX.ins[e].index];return{script:o.script,value:o.value}}else throw new Error("Can't find pubkey in input without Utxo data")}function pubkeyInInput(e,t,n,r){const o=getScriptFromUtxo(n,t,r),{meaningfulScript:c}=getMeaningfulScript(o,n,"input",t.redeemScript,t.witnessScript);return pubkeyInScript(e,c)}function pubkeyInOutput(e,t,n,r){const o=r.__TX.outs[n].script,{meaningfulScript:c}=getMeaningfulScript(o,n,"output",t.redeemScript,t.witnessScript);return pubkeyInScript(e,c)}function redeemFromFinalScriptSig(e){if(!e)return;const t=decompile(e);if(!t)return;const n=t[t.length-1];if(!(!(n instanceof Uint8Array)||isPubkeyLike(n)||isSigLike(n)||!decompile(n)))return n}function redeemFromFinalWitnessScript(e){if(!e)return;const t=scriptWitnessToWitnessStack(e),n=t[t.length-1];if(!(isPubkeyLike(n)||!decompile(n)))return n}function compressPubkey(e){if(e.length===65){const t=e[64]&1,n=e.slice(0,33);return n[0]=2|t,n}return e.slice()}function isPubkeyLike(e){return e.length===33&&isCanonicalPubKey(e)}function isSigLike(e){return isCanonicalScriptSignature(e)}function getMeaningfulScript(e,t,n,r,o){const c=isP2SHScript(e),l=c&&r&&isP2WSHScript(r),x=isP2WSHScript(e);if(c&&r===void 0)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((x||l)&&o===void 0)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let f;return l?(f=o,checkRedeemScript(t,e,r,n),checkWitnessScript(t,r,o,n),checkInvalidP2WSH(f)):x?(f=o,checkWitnessScript(t,e,o,n),checkInvalidP2WSH(f)):c?(f=r,checkRedeemScript(t,e,r,n)):f=e,{meaningfulScript:f,type:l?"p2sh-p2wsh":c?"p2sh":x?"p2wsh":"raw"}}function checkInvalidP2WSH(e){if(isP2WPKH(e)||isP2SHScript(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function classifyScript(e){return isP2WPKH(e)?"witnesspubkeyhash":isP2PKH(e)?"pubkeyhash":isP2MS(e)?"multisig":isP2PK(e)?"pubkey":"nonstandard"}function range(e){return[...Array(e).keys()]}var dist={},secp256k1={},sha2={},_md={},utils$4={},crypto$1={},hasRequiredCrypto;function requireCrypto(){return hasRequiredCrypto||(hasRequiredCrypto=1,Object.defineProperty(crypto$1,"__esModule",{value:!0}),crypto$1.crypto=void 0,crypto$1.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0),crypto$1}var hasRequiredUtils$4;function requireUtils$4(){return hasRequiredUtils$4||(hasRequiredUtils$4=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.Hash=e.nextTick=e.swap32IfBE=e.byteSwapIfBE=e.swap8IfBE=e.isLE=void 0,e.isBytes=n,e.anumber=r,e.abytes=o,e.ahash=c,e.aexists=l,e.aoutput=x,e.u8=f,e.u32=m,e.clean=E,e.createView=g,e.rotr=y,e.rotl=w,e.byteSwap=v,e.byteSwap32=_,e.bytesToHex=Y,e.hexToBytes=N,e.asyncLoop=U,e.utf8ToBytes=W,e.bytesToUtf8=O,e.toBytes=Z,e.kdfInputToBytes=z,e.concatBytes=q,e.checkOpts=$,e.createHasher=S,e.createOptHasher=R,e.createXOFer=D,e.randomBytes=j;const t=requireCrypto();function n(P){return P instanceof Uint8Array||ArrayBuffer.isView(P)&&P.constructor.name==="Uint8Array"}function r(P){if(!Number.isSafeInteger(P)||P<0)throw new Error("positive integer expected, got "+P)}function o(P,...Q){if(!n(P))throw new Error("Uint8Array expected");if(Q.length>0&&!Q.includes(P.length))throw new Error("Uint8Array expected of length "+Q+", got length="+P.length)}function c(P){if(typeof P!="function"||typeof P.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");r(P.outputLen),r(P.blockLen)}function l(P,Q=!0){if(P.destroyed)throw new Error("Hash instance has been destroyed");if(Q&&P.finished)throw new Error("Hash#digest() has already been called")}function x(P,Q){o(P);const C=Q.outputLen;if(P.length<C)throw new Error("digestInto() expects output buffer of length at least "+C)}function f(P){return new Uint8Array(P.buffer,P.byteOffset,P.byteLength)}function m(P){return new Uint32Array(P.buffer,P.byteOffset,Math.floor(P.byteLength/4))}function E(...P){for(let Q=0;Q<P.length;Q++)P[Q].fill(0)}function g(P){return new DataView(P.buffer,P.byteOffset,P.byteLength)}function y(P,Q){return P<<32-Q|P>>>Q}function w(P,Q){return P<<Q|P>>>32-Q>>>0}e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function v(P){return P<<24&4278190080|P<<8&16711680|P>>>8&65280|P>>>24&255}e.swap8IfBE=e.isLE?P=>P:P=>v(P),e.byteSwapIfBE=e.swap8IfBE;function _(P){for(let Q=0;Q<P.length;Q++)P[Q]=v(P[Q]);return P}e.swap32IfBE=e.isLE?P=>P:_;const F=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",H=Array.from({length:256},(P,Q)=>Q.toString(16).padStart(2,"0"));function Y(P){if(o(P),F)return P.toHex();let Q="";for(let C=0;C<P.length;C++)Q+=H[P[C]];return Q}const T={_0:48,_9:57,A:65,F:70,a:97,f:102};function L(P){if(P>=T._0&&P<=T._9)return P-T._0;if(P>=T.A&&P<=T.F)return P-(T.A-10);if(P>=T.a&&P<=T.f)return P-(T.a-10)}function N(P){if(typeof P!="string")throw new Error("hex string expected, got "+typeof P);if(F)return Uint8Array.fromHex(P);const Q=P.length,C=Q/2;if(Q%2)throw new Error("hex string expected, got unpadded hex of length "+Q);const K=new Uint8Array(C);for(let J=0,ne=0;J<C;J++,ne+=2){const re=L(P.charCodeAt(ne)),ie=L(P.charCodeAt(ne+1));if(re===void 0||ie===void 0){const ce=P[ne]+P[ne+1];throw new Error('hex string expected, got non-hex character "'+ce+'" at index '+ne)}K[J]=re*16+ie}return K}const I=async()=>{};e.nextTick=I;async function U(P,Q,C){let K=Date.now();for(let J=0;J<P;J++){C(J);const ne=Date.now()-K;ne>=0&&ne<Q||(await(0,e.nextTick)(),K+=ne)}}function W(P){if(typeof P!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(P))}function O(P){return new TextDecoder().decode(P)}function Z(P){return typeof P=="string"&&(P=W(P)),o(P),P}function z(P){return typeof P=="string"&&(P=W(P)),o(P),P}function q(...P){let Q=0;for(let K=0;K<P.length;K++){const J=P[K];o(J),Q+=J.length}const C=new Uint8Array(Q);for(let K=0,J=0;K<P.length;K++){const ne=P[K];C.set(ne,J),J+=ne.length}return C}function $(P,Q){if(Q!==void 0&&{}.toString.call(Q)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(P,Q)}class M{}e.Hash=M;function S(P){const Q=K=>P().update(Z(K)).digest(),C=P();return Q.outputLen=C.outputLen,Q.blockLen=C.blockLen,Q.create=()=>P(),Q}function R(P){const Q=(K,J)=>P(J).update(Z(K)).digest(),C=P({});return Q.outputLen=C.outputLen,Q.blockLen=C.blockLen,Q.create=K=>P(K),Q}function D(P){const Q=(K,J)=>P(J).update(Z(K)).digest(),C=P({});return Q.outputLen=C.outputLen,Q.blockLen=C.blockLen,Q.create=K=>P(K),Q}e.wrapConstructor=S,e.wrapConstructorWithOpts=R,e.wrapXOFConstructorWithOpts=D;function j(P=32){if(t.crypto&&typeof t.crypto.getRandomValues=="function")return t.crypto.getRandomValues(new Uint8Array(P));if(t.crypto&&typeof t.crypto.randomBytes=="function")return Uint8Array.from(t.crypto.randomBytes(P));throw new Error("crypto.getRandomValues must be defined")}})(utils$4)),utils$4}var hasRequired_md;function require_md(){if(hasRequired_md)return _md;hasRequired_md=1,Object.defineProperty(_md,"__esModule",{value:!0}),_md.SHA512_IV=_md.SHA384_IV=_md.SHA224_IV=_md.SHA256_IV=_md.HashMD=void 0,_md.setBigUint64=t,_md.Chi=n,_md.Maj=r;const e=requireUtils$4();function t(c,l,x,f){if(typeof c.setBigUint64=="function")return c.setBigUint64(l,x,f);const m=BigInt(32),E=BigInt(4294967295),g=Number(x>>m&E),y=Number(x&E),w=f?4:0,v=f?0:4;c.setUint32(l+w,g,f),c.setUint32(l+v,y,f)}function n(c,l,x){return c&l^~c&x}function r(c,l,x){return c&l^c&x^l&x}class o extends e.Hash{constructor(l,x,f,m){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=l,this.outputLen=x,this.padOffset=f,this.isLE=m,this.buffer=new Uint8Array(l),this.view=(0,e.createView)(this.buffer)}update(l){(0,e.aexists)(this),l=(0,e.toBytes)(l),(0,e.abytes)(l);const{view:x,buffer:f,blockLen:m}=this,E=l.length;for(let g=0;g<E;){const y=Math.min(m-this.pos,E-g);if(y===m){const w=(0,e.createView)(l);for(;m<=E-g;g+=m)this.process(w,g);continue}f.set(l.subarray(g,g+y),this.pos),this.pos+=y,g+=y,this.pos===m&&(this.process(x,0),this.pos=0)}return this.length+=l.length,this.roundClean(),this}digestInto(l){(0,e.aexists)(this),(0,e.aoutput)(l,this),this.finished=!0;const{buffer:x,view:f,blockLen:m,isLE:E}=this;let{pos:g}=this;x[g++]=128,(0,e.clean)(this.buffer.subarray(g)),this.padOffset>m-g&&(this.process(f,0),g=0);for(let F=g;F<m;F++)x[F]=0;t(f,m-8,BigInt(this.length*8),E),this.process(f,0);const y=(0,e.createView)(l),w=this.outputLen;if(w%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const v=w/4,_=this.get();if(v>_.length)throw new Error("_sha2: outputLen bigger than state");for(let F=0;F<v;F++)y.setUint32(4*F,_[F],E)}digest(){const{buffer:l,outputLen:x}=this;this.digestInto(l);const f=l.slice(0,x);return this.destroy(),f}_cloneInto(l){l||(l=new this.constructor),l.set(...this.get());const{blockLen:x,buffer:f,length:m,finished:E,destroyed:g,pos:y}=this;return l.destroyed=g,l.finished=E,l.length=m,l.pos=y,m%x&&l.buffer.set(f),l}clone(){return this._cloneInto()}}return _md.HashMD=o,_md.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),_md.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),_md.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),_md.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),_md}var _u64={},hasRequired_u64;function require_u64(){if(hasRequired_u64)return _u64;hasRequired_u64=1,Object.defineProperty(_u64,"__esModule",{value:!0}),_u64.toBig=_u64.shrSL=_u64.shrSH=_u64.rotrSL=_u64.rotrSH=_u64.rotrBL=_u64.rotrBH=_u64.rotr32L=_u64.rotr32H=_u64.rotlSL=_u64.rotlSH=_u64.rotlBL=_u64.rotlBH=_u64.add5L=_u64.add5H=_u64.add4L=_u64.add4H=_u64.add3L=_u64.add3H=void 0,_u64.add=H,_u64.fromBig=n,_u64.split=r;const e=BigInt(2**32-1),t=BigInt(32);function n(O,Z=!1){return Z?{h:Number(O&e),l:Number(O>>t&e)}:{h:Number(O>>t&e)|0,l:Number(O&e)|0}}function r(O,Z=!1){const z=O.length;let q=new Uint32Array(z),$=new Uint32Array(z);for(let M=0;M<z;M++){const{h:S,l:R}=n(O[M],Z);[q[M],$[M]]=[S,R]}return[q,$]}const o=(O,Z)=>BigInt(O>>>0)<<t|BigInt(Z>>>0);_u64.toBig=o;const c=(O,Z,z)=>O>>>z;_u64.shrSH=c;const l=(O,Z,z)=>O<<32-z|Z>>>z;_u64.shrSL=l;const x=(O,Z,z)=>O>>>z|Z<<32-z;_u64.rotrSH=x;const f=(O,Z,z)=>O<<32-z|Z>>>z;_u64.rotrSL=f;const m=(O,Z,z)=>O<<64-z|Z>>>z-32;_u64.rotrBH=m;const E=(O,Z,z)=>O>>>z-32|Z<<64-z;_u64.rotrBL=E;const g=(O,Z)=>Z;_u64.rotr32H=g;const y=(O,Z)=>O;_u64.rotr32L=y;const w=(O,Z,z)=>O<<z|Z>>>32-z;_u64.rotlSH=w;const v=(O,Z,z)=>Z<<z|O>>>32-z;_u64.rotlSL=v;const _=(O,Z,z)=>Z<<z-32|O>>>64-z;_u64.rotlBH=_;const F=(O,Z,z)=>O<<z-32|Z>>>64-z;_u64.rotlBL=F;function H(O,Z,z,q){const $=(Z>>>0)+(q>>>0);return{h:O+z+($/2**32|0)|0,l:$|0}}const Y=(O,Z,z)=>(O>>>0)+(Z>>>0)+(z>>>0);_u64.add3L=Y;const T=(O,Z,z,q)=>Z+z+q+(O/2**32|0)|0;_u64.add3H=T;const L=(O,Z,z,q)=>(O>>>0)+(Z>>>0)+(z>>>0)+(q>>>0);_u64.add4L=L;const N=(O,Z,z,q,$)=>Z+z+q+$+(O/2**32|0)|0;_u64.add4H=N;const I=(O,Z,z,q,$)=>(O>>>0)+(Z>>>0)+(z>>>0)+(q>>>0)+($>>>0);_u64.add5L=I;const U=(O,Z,z,q,$,M)=>Z+z+q+$+M+(O/2**32|0)|0;_u64.add5H=U;const W={fromBig:n,split:r,toBig:o,shrSH:c,shrSL:l,rotrSH:x,rotrSL:f,rotrBH:m,rotrBL:E,rotr32H:g,rotr32L:y,rotlSH:w,rotlSL:v,rotlBH:_,rotlBL:F,add:H,add3L:Y,add3H:T,add4L:L,add4H:N,add5H:U,add5L:I};return _u64.default=W,_u64}var hasRequiredSha2;function requireSha2(){if(hasRequiredSha2)return sha2;hasRequiredSha2=1,Object.defineProperty(sha2,"__esModule",{value:!0}),sha2.sha512_224=sha2.sha512_256=sha2.sha384=sha2.sha512=sha2.sha224=sha2.sha256=sha2.SHA512_256=sha2.SHA512_224=sha2.SHA384=sha2.SHA512=sha2.SHA224=sha2.SHA256=void 0;const e=require_md(),t=require_u64(),n=requireUtils$4(),r=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),o=new Uint32Array(64);class c extends e.HashMD{constructor(T=32){super(64,T,8,!1),this.A=e.SHA256_IV[0]|0,this.B=e.SHA256_IV[1]|0,this.C=e.SHA256_IV[2]|0,this.D=e.SHA256_IV[3]|0,this.E=e.SHA256_IV[4]|0,this.F=e.SHA256_IV[5]|0,this.G=e.SHA256_IV[6]|0,this.H=e.SHA256_IV[7]|0}get(){const{A:T,B:L,C:N,D:I,E:U,F:W,G:O,H:Z}=this;return[T,L,N,I,U,W,O,Z]}set(T,L,N,I,U,W,O,Z){this.A=T|0,this.B=L|0,this.C=N|0,this.D=I|0,this.E=U|0,this.F=W|0,this.G=O|0,this.H=Z|0}process(T,L){for(let $=0;$<16;$++,L+=4)o[$]=T.getUint32(L,!1);for(let $=16;$<64;$++){const M=o[$-15],S=o[$-2],R=(0,n.rotr)(M,7)^(0,n.rotr)(M,18)^M>>>3,D=(0,n.rotr)(S,17)^(0,n.rotr)(S,19)^S>>>10;o[$]=D+o[$-7]+R+o[$-16]|0}let{A:N,B:I,C:U,D:W,E:O,F:Z,G:z,H:q}=this;for(let $=0;$<64;$++){const M=(0,n.rotr)(O,6)^(0,n.rotr)(O,11)^(0,n.rotr)(O,25),S=q+M+(0,e.Chi)(O,Z,z)+r[$]+o[$]|0,D=((0,n.rotr)(N,2)^(0,n.rotr)(N,13)^(0,n.rotr)(N,22))+(0,e.Maj)(N,I,U)|0;q=z,z=Z,Z=O,O=W+S|0,W=U,U=I,I=N,N=S+D|0}N=N+this.A|0,I=I+this.B|0,U=U+this.C|0,W=W+this.D|0,O=O+this.E|0,Z=Z+this.F|0,z=z+this.G|0,q=q+this.H|0,this.set(N,I,U,W,O,Z,z,q)}roundClean(){(0,n.clean)(o)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,n.clean)(this.buffer)}}sha2.SHA256=c;class l extends c{constructor(){super(28),this.A=e.SHA224_IV[0]|0,this.B=e.SHA224_IV[1]|0,this.C=e.SHA224_IV[2]|0,this.D=e.SHA224_IV[3]|0,this.E=e.SHA224_IV[4]|0,this.F=e.SHA224_IV[5]|0,this.G=e.SHA224_IV[6]|0,this.H=e.SHA224_IV[7]|0}}sha2.SHA224=l;const x=t.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(Y=>BigInt(Y))),f=x[0],m=x[1],E=new Uint32Array(80),g=new Uint32Array(80);class y extends e.HashMD{constructor(T=64){super(128,T,16,!1),this.Ah=e.SHA512_IV[0]|0,this.Al=e.SHA512_IV[1]|0,this.Bh=e.SHA512_IV[2]|0,this.Bl=e.SHA512_IV[3]|0,this.Ch=e.SHA512_IV[4]|0,this.Cl=e.SHA512_IV[5]|0,this.Dh=e.SHA512_IV[6]|0,this.Dl=e.SHA512_IV[7]|0,this.Eh=e.SHA512_IV[8]|0,this.El=e.SHA512_IV[9]|0,this.Fh=e.SHA512_IV[10]|0,this.Fl=e.SHA512_IV[11]|0,this.Gh=e.SHA512_IV[12]|0,this.Gl=e.SHA512_IV[13]|0,this.Hh=e.SHA512_IV[14]|0,this.Hl=e.SHA512_IV[15]|0}get(){const{Ah:T,Al:L,Bh:N,Bl:I,Ch:U,Cl:W,Dh:O,Dl:Z,Eh:z,El:q,Fh:$,Fl:M,Gh:S,Gl:R,Hh:D,Hl:j}=this;return[T,L,N,I,U,W,O,Z,z,q,$,M,S,R,D,j]}set(T,L,N,I,U,W,O,Z,z,q,$,M,S,R,D,j){this.Ah=T|0,this.Al=L|0,this.Bh=N|0,this.Bl=I|0,this.Ch=U|0,this.Cl=W|0,this.Dh=O|0,this.Dl=Z|0,this.Eh=z|0,this.El=q|0,this.Fh=$|0,this.Fl=M|0,this.Gh=S|0,this.Gl=R|0,this.Hh=D|0,this.Hl=j|0}process(T,L){for(let C=0;C<16;C++,L+=4)E[C]=T.getUint32(L),g[C]=T.getUint32(L+=4);for(let C=16;C<80;C++){const K=E[C-15]|0,J=g[C-15]|0,ne=t.rotrSH(K,J,1)^t.rotrSH(K,J,8)^t.shrSH(K,J,7),re=t.rotrSL(K,J,1)^t.rotrSL(K,J,8)^t.shrSL(K,J,7),ie=E[C-2]|0,ce=g[C-2]|0,ue=t.rotrSH(ie,ce,19)^t.rotrBH(ie,ce,61)^t.shrSH(ie,ce,6),ae=t.rotrSL(ie,ce,19)^t.rotrBL(ie,ce,61)^t.shrSL(ie,ce,6),we=t.add4L(re,ae,g[C-7],g[C-16]),ke=t.add4H(we,ne,ue,E[C-7],E[C-16]);E[C]=ke|0,g[C]=we|0}let{Ah:N,Al:I,Bh:U,Bl:W,Ch:O,Cl:Z,Dh:z,Dl:q,Eh:$,El:M,Fh:S,Fl:R,Gh:D,Gl:j,Hh:P,Hl:Q}=this;for(let C=0;C<80;C++){const K=t.rotrSH($,M,14)^t.rotrSH($,M,18)^t.rotrBH($,M,41),J=t.rotrSL($,M,14)^t.rotrSL($,M,18)^t.rotrBL($,M,41),ne=$&S^~$&D,re=M&R^~M&j,ie=t.add5L(Q,J,re,m[C],g[C]),ce=t.add5H(ie,P,K,ne,f[C],E[C]),ue=ie|0,ae=t.rotrSH(N,I,28)^t.rotrBH(N,I,34)^t.rotrBH(N,I,39),we=t.rotrSL(N,I,28)^t.rotrBL(N,I,34)^t.rotrBL(N,I,39),ke=N&U^N&O^U&O,Re=I&W^I&Z^W&Z;P=D|0,Q=j|0,D=S|0,j=R|0,S=$|0,R=M|0,{h:$,l:M}=t.add(z|0,q|0,ce|0,ue|0),z=O|0,q=Z|0,O=U|0,Z=W|0,U=N|0,W=I|0;const be=t.add3L(ue,we,Re);N=t.add3H(be,ce,ae,ke),I=be|0}({h:N,l:I}=t.add(this.Ah|0,this.Al|0,N|0,I|0)),{h:U,l:W}=t.add(this.Bh|0,this.Bl|0,U|0,W|0),{h:O,l:Z}=t.add(this.Ch|0,this.Cl|0,O|0,Z|0),{h:z,l:q}=t.add(this.Dh|0,this.Dl|0,z|0,q|0),{h:$,l:M}=t.add(this.Eh|0,this.El|0,$|0,M|0),{h:S,l:R}=t.add(this.Fh|0,this.Fl|0,S|0,R|0),{h:D,l:j}=t.add(this.Gh|0,this.Gl|0,D|0,j|0),{h:P,l:Q}=t.add(this.Hh|0,this.Hl|0,P|0,Q|0),this.set(N,I,U,W,O,Z,z,q,$,M,S,R,D,j,P,Q)}roundClean(){(0,n.clean)(E,g)}destroy(){(0,n.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}sha2.SHA512=y;class w extends y{constructor(){super(48),this.Ah=e.SHA384_IV[0]|0,this.Al=e.SHA384_IV[1]|0,this.Bh=e.SHA384_IV[2]|0,this.Bl=e.SHA384_IV[3]|0,this.Ch=e.SHA384_IV[4]|0,this.Cl=e.SHA384_IV[5]|0,this.Dh=e.SHA384_IV[6]|0,this.Dl=e.SHA384_IV[7]|0,this.Eh=e.SHA384_IV[8]|0,this.El=e.SHA384_IV[9]|0,this.Fh=e.SHA384_IV[10]|0,this.Fl=e.SHA384_IV[11]|0,this.Gh=e.SHA384_IV[12]|0,this.Gl=e.SHA384_IV[13]|0,this.Hh=e.SHA384_IV[14]|0,this.Hl=e.SHA384_IV[15]|0}}sha2.SHA384=w;const v=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),_=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class F extends y{constructor(){super(28),this.Ah=v[0]|0,this.Al=v[1]|0,this.Bh=v[2]|0,this.Bl=v[3]|0,this.Ch=v[4]|0,this.Cl=v[5]|0,this.Dh=v[6]|0,this.Dl=v[7]|0,this.Eh=v[8]|0,this.El=v[9]|0,this.Fh=v[10]|0,this.Fl=v[11]|0,this.Gh=v[12]|0,this.Gl=v[13]|0,this.Hh=v[14]|0,this.Hl=v[15]|0}}sha2.SHA512_224=F;class H extends y{constructor(){super(32),this.Ah=_[0]|0,this.Al=_[1]|0,this.Bh=_[2]|0,this.Bl=_[3]|0,this.Ch=_[4]|0,this.Cl=_[5]|0,this.Dh=_[6]|0,this.Dl=_[7]|0,this.Eh=_[8]|0,this.El=_[9]|0,this.Fh=_[10]|0,this.Fl=_[11]|0,this.Gh=_[12]|0,this.Gl=_[13]|0,this.Hh=_[14]|0,this.Hl=_[15]|0}}return sha2.SHA512_256=H,sha2.sha256=(0,n.createHasher)(()=>new c),sha2.sha224=(0,n.createHasher)(()=>new l),sha2.sha512=(0,n.createHasher)(()=>new y),sha2.sha384=(0,n.createHasher)(()=>new w),sha2.sha512_256=(0,n.createHasher)(()=>new H),sha2.sha512_224=(0,n.createHasher)(()=>new F),sha2}var _shortw_utils={},weierstrass={},hmac={},hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;const t=requireUtils$4();class n extends t.Hash{constructor(c,l){super(),this.finished=!1,this.destroyed=!1,(0,t.ahash)(c);const x=(0,t.toBytes)(l);if(this.iHash=c.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const f=this.blockLen,m=new Uint8Array(f);m.set(x.length>f?c.create().update(x).digest():x);for(let E=0;E<m.length;E++)m[E]^=54;this.iHash.update(m),this.oHash=c.create();for(let E=0;E<m.length;E++)m[E]^=106;this.oHash.update(m),(0,t.clean)(m)}update(c){return(0,t.aexists)(this),this.iHash.update(c),this}digestInto(c){(0,t.aexists)(this),(0,t.abytes)(c,this.outputLen),this.finished=!0,this.iHash.digestInto(c),this.oHash.update(c),this.oHash.digestInto(c),this.destroy()}digest(){const c=new Uint8Array(this.oHash.outputLen);return this.digestInto(c),c}_cloneInto(c){c||(c=Object.create(Object.getPrototypeOf(this),{}));const{oHash:l,iHash:x,finished:f,destroyed:m,blockLen:E,outputLen:g}=this;return c=c,c.finished=f,c.destroyed=m,c.blockLen=E,c.outputLen=g,c.oHash=l._cloneInto(c.oHash),c.iHash=x._cloneInto(c.iHash),c}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.HMAC=n;const r=(o,c,l)=>new n(o,c).update(l).digest();e.hmac=r,e.hmac.create=(o,c)=>new n(o,c)})(hmac)),hmac}var utils$3={},hasRequiredUtils$3;function requireUtils$3(){return hasRequiredUtils$3||(hasRequiredUtils$3=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.notImplemented=e.bitMask=e.utf8ToBytes=e.randomBytes=e.isBytes=e.hexToBytes=e.concatBytes=e.bytesToUtf8=e.bytesToHex=e.anumber=e.abytes=void 0,e.abool=c,e._abool2=l,e._abytes2=x,e.numberToHexUnpadded=f,e.hexToNumber=m,e.bytesToNumberBE=E,e.bytesToNumberLE=g,e.numberToBytesBE=y,e.numberToBytesLE=w,e.numberToVarBytesBE=v,e.ensureBytes=_,e.equalBytes=F,e.copyBytes=H,e.asciiToBytes=Y,e.inRange=L,e.aInRange=N,e.bitLen=I,e.bitGet=U,e.bitSet=W,e.createHmacDrbg=Z,e.validateObject=q,e.isHash=$,e._validateObject=M,e.memoized=R;const t=requireUtils$4();var n=requireUtils$4();Object.defineProperty(e,"abytes",{enumerable:!0,get:function(){return n.abytes}}),Object.defineProperty(e,"anumber",{enumerable:!0,get:function(){return n.anumber}}),Object.defineProperty(e,"bytesToHex",{enumerable:!0,get:function(){return n.bytesToHex}}),Object.defineProperty(e,"bytesToUtf8",{enumerable:!0,get:function(){return n.bytesToUtf8}}),Object.defineProperty(e,"concatBytes",{enumerable:!0,get:function(){return n.concatBytes}}),Object.defineProperty(e,"hexToBytes",{enumerable:!0,get:function(){return n.hexToBytes}}),Object.defineProperty(e,"isBytes",{enumerable:!0,get:function(){return n.isBytes}}),Object.defineProperty(e,"randomBytes",{enumerable:!0,get:function(){return n.randomBytes}}),Object.defineProperty(e,"utf8ToBytes",{enumerable:!0,get:function(){return n.utf8ToBytes}});const r=BigInt(0),o=BigInt(1);function c(D,j){if(typeof j!="boolean")throw new Error(D+" boolean expected, got "+j)}function l(D,j=""){if(typeof D!="boolean"){const P=j&&`"${j}"`;throw new Error(P+"expected boolean, got type="+typeof D)}return D}function x(D,j,P=""){const Q=(0,t.isBytes)(D),C=D?.length,K=j!==void 0;if(!Q||K&&C!==j){const J=P&&`"${P}" `,ne=K?` of length ${j}`:"",re=Q?`length=${C}`:`type=${typeof D}`;throw new Error(J+"expected Uint8Array"+ne+", got "+re)}return D}function f(D){const j=D.toString(16);return j.length&1?"0"+j:j}function m(D){if(typeof D!="string")throw new Error("hex string expected, got "+typeof D);return D===""?r:BigInt("0x"+D)}function E(D){return m((0,t.bytesToHex)(D))}function g(D){return(0,t.abytes)(D),m((0,t.bytesToHex)(Uint8Array.from(D).reverse()))}function y(D,j){return(0,t.hexToBytes)(D.toString(16).padStart(j*2,"0"))}function w(D,j){return y(D,j).reverse()}function v(D){return(0,t.hexToBytes)(f(D))}function _(D,j,P){let Q;if(typeof j=="string")try{Q=(0,t.hexToBytes)(j)}catch(K){throw new Error(D+" must be hex string or Uint8Array, cause: "+K)}else if((0,t.isBytes)(j))Q=Uint8Array.from(j);else throw new Error(D+" must be hex string or Uint8Array");const C=Q.length;if(typeof P=="number"&&C!==P)throw new Error(D+" of length "+P+" expected, got "+C);return Q}function F(D,j){if(D.length!==j.length)return!1;let P=0;for(let Q=0;Q<D.length;Q++)P|=D[Q]^j[Q];return P===0}function H(D){return Uint8Array.from(D)}function Y(D){return Uint8Array.from(D,(j,P)=>{const Q=j.charCodeAt(0);if(j.length!==1||Q>127)throw new Error(`string contains non-ASCII character "${D[P]}" with code ${Q} at position ${P}`);return Q})}const T=D=>typeof D=="bigint"&&r<=D;function L(D,j,P){return T(D)&&T(j)&&T(P)&&j<=D&&D<P}function N(D,j,P,Q){if(!L(j,P,Q))throw new Error("expected valid "+D+": "+P+" <= n < "+Q+", got "+j)}function I(D){let j;for(j=0;D>r;D>>=o,j+=1);return j}function U(D,j){return D>>BigInt(j)&o}function W(D,j,P){return D|(P?o:r)<<BigInt(j)}const O=D=>(o<<BigInt(D))-o;e.bitMask=O;function Z(D,j,P){if(typeof D!="number"||D<2)throw new Error("hashLen must be a number");if(typeof j!="number"||j<2)throw new Error("qByteLen must be a number");if(typeof P!="function")throw new Error("hmacFn must be a function");const Q=we=>new Uint8Array(we),C=we=>Uint8Array.of(we);let K=Q(D),J=Q(D),ne=0;const re=()=>{K.fill(1),J.fill(0),ne=0},ie=(...we)=>P(J,K,...we),ce=(we=Q(0))=>{J=ie(C(0),we),K=ie(),we.length!==0&&(J=ie(C(1),we),K=ie())},ue=()=>{if(ne++>=1e3)throw new Error("drbg: tried 1000 values");let we=0;const ke=[];for(;we<j;){K=ie();const Re=K.slice();ke.push(Re),we+=K.length}return(0,t.concatBytes)(...ke)};return(we,ke)=>{re(),ce(we);let Re;for(;!(Re=ke(ue()));)ce();return re(),Re}}const z={bigint:D=>typeof D=="bigint",function:D=>typeof D=="function",boolean:D=>typeof D=="boolean",string:D=>typeof D=="string",stringOrUint8Array:D=>typeof D=="string"||(0,t.isBytes)(D),isSafeInteger:D=>Number.isSafeInteger(D),array:D=>Array.isArray(D),field:(D,j)=>j.Fp.isValid(D),hash:D=>typeof D=="function"&&Number.isSafeInteger(D.outputLen)};function q(D,j,P={}){const Q=(C,K,J)=>{const ne=z[K];if(typeof ne!="function")throw new Error("invalid validator function");const re=D[C];if(!(J&&re===void 0)&&!ne(re,D))throw new Error("param "+String(C)+" is invalid. Expected "+K+", got "+re)};for(const[C,K]of Object.entries(j))Q(C,K,!1);for(const[C,K]of Object.entries(P))Q(C,K,!0);return D}function $(D){return typeof D=="function"&&Number.isSafeInteger(D.outputLen)}function M(D,j,P={}){if(!D||typeof D!="object")throw new Error("expected valid options object");function Q(C,K,J){const ne=D[C];if(J&&ne===void 0)return;const re=typeof ne;if(re!==K||ne===null)throw new Error(`param "${C}" is invalid: expected ${K}, got ${re}`)}Object.entries(j).forEach(([C,K])=>Q(C,K,!1)),Object.entries(P).forEach(([C,K])=>Q(C,K,!0))}const S=()=>{throw new Error("not implemented")};e.notImplemented=S;function R(D){const j=new WeakMap;return(P,...Q)=>{const C=j.get(P);if(C!==void 0)return C;const K=D(P,...Q);return j.set(P,K),K}}})(utils$3)),utils$3}var curve={},modular={},hasRequiredModular;function requireModular(){if(hasRequiredModular)return modular;hasRequiredModular=1,Object.defineProperty(modular,"__esModule",{value:!0}),modular.isNegativeLE=void 0,modular.mod=g,modular.pow=y,modular.pow2=w,modular.invert=v,modular.tonelliShanks=T,modular.FpSqrt=L,modular.validateField=U,modular.FpPow=W,modular.FpInvertBatch=O,modular.FpDiv=Z,modular.FpLegendre=z,modular.FpIsSquare=q,modular.nLength=$,modular.Field=M,modular.FpSqrtOdd=S,modular.FpSqrtEven=R,modular.hashToPrivateScalar=D,modular.getFieldBytesLength=j,modular.getMinHashLength=P,modular.mapHashToField=Q;const e=requireUtils$3(),t=BigInt(0),n=BigInt(1),r=BigInt(2),o=BigInt(3),c=BigInt(4),l=BigInt(5),x=BigInt(7),f=BigInt(8),m=BigInt(9),E=BigInt(16);function g(C,K){const J=C%K;return J>=t?J:K+J}function y(C,K,J){return W(M(J),C,K)}function w(C,K,J){let ne=C;for(;K-- >t;)ne*=ne,ne%=J;return ne}function v(C,K){if(C===t)throw new Error("invert: expected non-zero number");if(K<=t)throw new Error("invert: expected positive modulus, got "+K);let J=g(C,K),ne=K,re=t,ie=n;for(;J!==t;){const ue=ne/J,ae=ne%J,we=re-ie*ue;ne=J,J=ae,re=ie,ie=we}if(ne!==n)throw new Error("invert: does not exist");return g(re,K)}function _(C,K,J){if(!C.eql(C.sqr(K),J))throw new Error("Cannot find square root")}function F(C,K){const J=(C.ORDER+n)/c,ne=C.pow(K,J);return _(C,ne,K),ne}function H(C,K){const J=(C.ORDER-l)/f,ne=C.mul(K,r),re=C.pow(ne,J),ie=C.mul(K,re),ce=C.mul(C.mul(ie,r),re),ue=C.mul(ie,C.sub(ce,C.ONE));return _(C,ue,K),ue}function Y(C){const K=M(C),J=T(C),ne=J(K,K.neg(K.ONE)),re=J(K,ne),ie=J(K,K.neg(ne)),ce=(C+x)/E;return(ue,ae)=>{let we=ue.pow(ae,ce),ke=ue.mul(we,ne);const Re=ue.mul(we,re),be=ue.mul(we,ie),Fe=ue.eql(ue.sqr(ke),ae),je=ue.eql(ue.sqr(Re),ae);we=ue.cmov(we,ke,Fe),ke=ue.cmov(be,Re,je);const Te=ue.eql(ue.sqr(ke),ae),rt=ue.cmov(we,ke,Te);return _(ue,rt,ae),rt}}function T(C){if(C<o)throw new Error("sqrt is not defined for small field");let K=C-n,J=0;for(;K%r===t;)K/=r,J++;let ne=r;const re=M(C);for(;z(re,ne)===1;)if(ne++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(J===1)return F;let ie=re.pow(ne,K);const ce=(K+n)/r;return function(ae,we){if(ae.is0(we))return we;if(z(ae,we)!==1)throw new Error("Cannot find square root");let ke=J,Re=ae.mul(ae.ONE,ie),be=ae.pow(we,K),Fe=ae.pow(we,ce);for(;!ae.eql(be,ae.ONE);){if(ae.is0(be))return ae.ZERO;let je=1,Te=ae.sqr(be);for(;!ae.eql(Te,ae.ONE);)if(je++,Te=ae.sqr(Te),je===ke)throw new Error("Cannot find square root");const rt=n<<BigInt(ke-je-1),st=ae.pow(Re,rt);ke=je,Re=ae.sqr(st),be=ae.mul(be,Re),Fe=ae.mul(Fe,st)}return Fe}}function L(C){return C%c===o?F:C%f===l?H:C%E===m?Y(C):T(C)}const N=(C,K)=>(g(C,K)&n)===n;modular.isNegativeLE=N;const I=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function U(C){const K={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},J=I.reduce((ne,re)=>(ne[re]="function",ne),K);return(0,e._validateObject)(C,J),C}function W(C,K,J){if(J<t)throw new Error("invalid exponent, negatives unsupported");if(J===t)return C.ONE;if(J===n)return K;let ne=C.ONE,re=K;for(;J>t;)J&n&&(ne=C.mul(ne,re)),re=C.sqr(re),J>>=n;return ne}function O(C,K,J=!1){const ne=new Array(K.length).fill(J?C.ZERO:void 0),re=K.reduce((ce,ue,ae)=>C.is0(ue)?ce:(ne[ae]=ce,C.mul(ce,ue)),C.ONE),ie=C.inv(re);return K.reduceRight((ce,ue,ae)=>C.is0(ue)?ce:(ne[ae]=C.mul(ce,ne[ae]),C.mul(ce,ue)),ie),ne}function Z(C,K,J){return C.mul(K,typeof J=="bigint"?v(J,C.ORDER):C.inv(J))}function z(C,K){const J=(C.ORDER-n)/r,ne=C.pow(K,J),re=C.eql(ne,C.ONE),ie=C.eql(ne,C.ZERO),ce=C.eql(ne,C.neg(C.ONE));if(!re&&!ie&&!ce)throw new Error("invalid Legendre symbol result");return re?1:ie?0:-1}function q(C,K){return z(C,K)===1}function $(C,K){K!==void 0&&(0,e.anumber)(K);const J=K!==void 0?K:C.toString(2).length,ne=Math.ceil(J/8);return{nBitLength:J,nByteLength:ne}}function M(C,K,J=!1,ne={}){if(C<=t)throw new Error("invalid field: expected ORDER > 0, got "+C);let re,ie,ce=!1,ue;if(typeof K=="object"&&K!=null){if(ne.sqrt||J)throw new Error("cannot specify opts in two arguments");const be=K;be.BITS&&(re=be.BITS),be.sqrt&&(ie=be.sqrt),typeof be.isLE=="boolean"&&(J=be.isLE),typeof be.modFromBytes=="boolean"&&(ce=be.modFromBytes),ue=be.allowedLengths}else typeof K=="number"&&(re=K),ne.sqrt&&(ie=ne.sqrt);const{nBitLength:ae,nByteLength:we}=$(C,re);if(we>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let ke;const Re=Object.freeze({ORDER:C,isLE:J,BITS:ae,BYTES:we,MASK:(0,e.bitMask)(ae),ZERO:t,ONE:n,allowedLengths:ue,create:be=>g(be,C),isValid:be=>{if(typeof be!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof be);return t<=be&&be<C},is0:be=>be===t,isValidNot0:be=>!Re.is0(be)&&Re.isValid(be),isOdd:be=>(be&n)===n,neg:be=>g(-be,C),eql:(be,Fe)=>be===Fe,sqr:be=>g(be*be,C),add:(be,Fe)=>g(be+Fe,C),sub:(be,Fe)=>g(be-Fe,C),mul:(be,Fe)=>g(be*Fe,C),pow:(be,Fe)=>W(Re,be,Fe),div:(be,Fe)=>g(be*v(Fe,C),C),sqrN:be=>be*be,addN:(be,Fe)=>be+Fe,subN:(be,Fe)=>be-Fe,mulN:(be,Fe)=>be*Fe,inv:be=>v(be,C),sqrt:ie||(be=>(ke||(ke=L(C)),ke(Re,be))),toBytes:be=>J?(0,e.numberToBytesLE)(be,we):(0,e.numberToBytesBE)(be,we),fromBytes:(be,Fe=!0)=>{if(ue){if(!ue.includes(be.length)||be.length>we)throw new Error("Field.fromBytes: expected "+ue+" bytes, got "+be.length);const Te=new Uint8Array(we);Te.set(be,J?0:Te.length-be.length),be=Te}if(be.length!==we)throw new Error("Field.fromBytes: expected "+we+" bytes, got "+be.length);let je=J?(0,e.bytesToNumberLE)(be):(0,e.bytesToNumberBE)(be);if(ce&&(je=g(je,C)),!Fe&&!Re.isValid(je))throw new Error("invalid field element: outside of range 0..ORDER");return je},invertBatch:be=>O(Re,be),cmov:(be,Fe,je)=>je?Fe:be});return Object.freeze(Re)}function S(C,K){if(!C.isOdd)throw new Error("Field doesn't have isOdd");const J=C.sqrt(K);return C.isOdd(J)?J:C.neg(J)}function R(C,K){if(!C.isOdd)throw new Error("Field doesn't have isOdd");const J=C.sqrt(K);return C.isOdd(J)?C.neg(J):J}function D(C,K,J=!1){C=(0,e.ensureBytes)("privateHash",C);const ne=C.length,re=$(K).nByteLength+8;if(re<24||ne<re||ne>1024)throw new Error("hashToPrivateScalar: expected "+re+"-1024 bytes of input, got "+ne);const ie=J?(0,e.bytesToNumberLE)(C):(0,e.bytesToNumberBE)(C);return g(ie,K-n)+n}function j(C){if(typeof C!="bigint")throw new Error("field order must be bigint");const K=C.toString(2).length;return Math.ceil(K/8)}function P(C){const K=j(C);return K+Math.ceil(K/2)}function Q(C,K,J=!1){const ne=C.length,re=j(K),ie=P(K);if(ne<16||ne<ie||ne>1024)throw new Error("expected "+ie+"-1024 bytes of input, got "+ne);const ce=J?(0,e.bytesToNumberLE)(C):(0,e.bytesToNumberBE)(C),ue=g(ce,K-n)+n;return J?(0,e.numberToBytesLE)(ue,re):(0,e.numberToBytesBE)(ue,re)}return modular}var hasRequiredCurve;function requireCurve(){if(hasRequiredCurve)return curve;hasRequiredCurve=1,Object.defineProperty(curve,"__esModule",{value:!0}),curve.wNAF=void 0,curve.negateCt=o,curve.normalizeZ=c,curve.mulEndoUnsafe=F,curve.pippenger=H,curve.precomputeMSMUnsafe=Y,curve.validateBasic=T,curve._createCurveFields=N;const e=requireUtils$3(),t=requireModular(),n=BigInt(0),r=BigInt(1);function o(I,U){const W=U.negate();return I?W:U}function c(I,U){const W=(0,t.FpInvertBatch)(I.Fp,U.map(O=>O.Z));return U.map((O,Z)=>I.fromAffine(O.toAffine(W[Z])))}function l(I,U){if(!Number.isSafeInteger(I)||I<=0||I>U)throw new Error("invalid window size, expected [1.."+U+"], got W="+I)}function x(I,U){l(I,U);const W=Math.ceil(U/I)+1,O=2**(I-1),Z=2**I,z=(0,e.bitMask)(I),q=BigInt(I);return{windows:W,windowSize:O,mask:z,maxNumber:Z,shiftBy:q}}function f(I,U,W){const{windowSize:O,mask:Z,maxNumber:z,shiftBy:q}=W;let $=Number(I&Z),M=I>>q;$>O&&($-=z,M+=r);const S=U*O,R=S+Math.abs($)-1,D=$===0,j=$<0,P=U%2!==0;return{nextN:M,offset:R,isZero:D,isNeg:j,isNegF:P,offsetF:S}}function m(I,U){if(!Array.isArray(I))throw new Error("array expected");I.forEach((W,O)=>{if(!(W instanceof U))throw new Error("invalid point at index "+O)})}function E(I,U){if(!Array.isArray(I))throw new Error("array of scalars expected");I.forEach((W,O)=>{if(!U.isValid(W))throw new Error("invalid scalar at index "+O)})}const g=new WeakMap,y=new WeakMap;function w(I){return y.get(I)||1}function v(I){if(I!==n)throw new Error("invalid wNAF")}class _{constructor(U,W){this.BASE=U.BASE,this.ZERO=U.ZERO,this.Fn=U.Fn,this.bits=W}_unsafeLadder(U,W,O=this.ZERO){let Z=U;for(;W>n;)W&r&&(O=O.add(Z)),Z=Z.double(),W>>=r;return O}precomputeWindow(U,W){const{windows:O,windowSize:Z}=x(W,this.bits),z=[];let q=U,$=q;for(let M=0;M<O;M++){$=q,z.push($);for(let S=1;S<Z;S++)$=$.add(q),z.push($);q=$.double()}return z}wNAF(U,W,O){if(!this.Fn.isValid(O))throw new Error("invalid scalar");let Z=this.ZERO,z=this.BASE;const q=x(U,this.bits);for(let $=0;$<q.windows;$++){const{nextN:M,offset:S,isZero:R,isNeg:D,isNegF:j,offsetF:P}=f(O,$,q);O=M,R?z=z.add(o(j,W[P])):Z=Z.add(o(D,W[S]))}return v(O),{p:Z,f:z}}wNAFUnsafe(U,W,O,Z=this.ZERO){const z=x(U,this.bits);for(let q=0;q<z.windows&&O!==n;q++){const{nextN:$,offset:M,isZero:S,isNeg:R}=f(O,q,z);if(O=$,!S){const D=W[M];Z=Z.add(R?D.negate():D)}}return v(O),Z}getPrecomputes(U,W,O){let Z=g.get(W);return Z||(Z=this.precomputeWindow(W,U),U!==1&&(typeof O=="function"&&(Z=O(Z)),g.set(W,Z))),Z}cached(U,W,O){const Z=w(U);return this.wNAF(Z,this.getPrecomputes(Z,U,O),W)}unsafe(U,W,O,Z){const z=w(U);return z===1?this._unsafeLadder(U,W,Z):this.wNAFUnsafe(z,this.getPrecomputes(z,U,O),W,Z)}createCache(U,W){l(W,this.bits),y.set(U,W),g.delete(U)}hasCache(U){return w(U)!==1}}curve.wNAF=_;function F(I,U,W,O){let Z=U,z=I.ZERO,q=I.ZERO;for(;W>n||O>n;)W&r&&(z=z.add(Z)),O&r&&(q=q.add(Z)),Z=Z.double(),W>>=r,O>>=r;return{p1:z,p2:q}}function H(I,U,W,O){m(W,I),E(O,U);const Z=W.length,z=O.length;if(Z!==z)throw new Error("arrays of points and scalars must have equal length");const q=I.ZERO,$=(0,e.bitLen)(BigInt(Z));let M=1;$>12?M=$-3:$>4?M=$-2:$>0&&(M=2);const S=(0,e.bitMask)(M),R=new Array(Number(S)+1).fill(q),D=Math.floor((U.BITS-1)/M)*M;let j=q;for(let P=D;P>=0;P-=M){R.fill(q);for(let C=0;C<z;C++){const K=O[C],J=Number(K>>BigInt(P)&S);R[J]=R[J].add(W[C])}let Q=q;for(let C=R.length-1,K=q;C>0;C--)K=K.add(R[C]),Q=Q.add(K);if(j=j.add(Q),P!==0)for(let C=0;C<M;C++)j=j.double()}return j}function Y(I,U,W,O){l(O,U.BITS),m(W,I);const Z=I.ZERO,z=2**O-1,q=Math.ceil(U.BITS/O),$=(0,e.bitMask)(O),M=W.map(S=>{const R=[];for(let D=0,j=S;D<z;D++)R.push(j),j=j.add(S);return R});return S=>{if(E(S,U),S.length>W.length)throw new Error("array of scalars must be smaller than array of points");let R=Z;for(let D=0;D<q;D++){if(R!==Z)for(let P=0;P<O;P++)R=R.double();const j=BigInt(q*O-(D+1)*O);for(let P=0;P<S.length;P++){const Q=S[P],C=Number(Q>>j&$);C&&(R=R.add(M[P][C-1]))}}return R}}function T(I){return(0,t.validateField)(I.Fp),(0,e.validateObject)(I,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,t.nLength)(I.n,I.nBitLength),...I,p:I.Fp.ORDER})}function L(I,U,W){if(U){if(U.ORDER!==I)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,t.validateField)(U),U}else return(0,t.Field)(I,{isLE:W})}function N(I,U,W={},O){if(O===void 0&&(O=I==="edwards"),!U||typeof U!="object")throw new Error(`expected valid ${I} CURVE object`);for(const M of["p","n","h"]){const S=U[M];if(!(typeof S=="bigint"&&S>n))throw new Error(`CURVE.${M} must be positive bigint`)}const Z=L(U.p,W.Fp,O),z=L(U.n,W.Fn,O),$=["Gx","Gy","a",I==="weierstrass"?"b":"d"];for(const M of $)if(!Z.isValid(U[M]))throw new Error(`CURVE.${M} must be valid field element of CURVE.Fp`);return U=Object.freeze(Object.assign({},U)),{CURVE:U,Fp:Z,Fn:z}}return curve}var hasRequiredWeierstrass;function requireWeierstrass(){return hasRequiredWeierstrass||(hasRequiredWeierstrass=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DER=e.DERErr=void 0,e._splitEndoScalar=x,e._normFnElement=F,e.weierstrassN=H,e.SWUFpSqrtRatio=T,e.mapToCurveSimpleSWU=L,e.ecdh=I,e.ecdsa=U,e.weierstrassPoints=W,e._legacyHelperEquat=z,e.weierstrass=M;const t=requireHmac(),n=requireUtils$4(),r=requireUtils$3(),o=requireCurve(),c=requireModular(),l=(S,R)=>(S+(S>=0?R:-R)/w)/R;function x(S,R,D){const[[j,P],[Q,C]]=R,K=l(C*S,D),J=l(-P*S,D);let ne=S-K*j-J*Q,re=-K*P-J*C;const ie=ne<g,ce=re<g;ie&&(ne=-ne),ce&&(re=-re);const ue=(0,r.bitMask)(Math.ceil((0,r.bitLen)(D)/2))+y;if(ne<g||ne>=ue||re<g||re>=ue)throw new Error("splitScalar (endomorphism): failed, k="+S);return{k1neg:ie,k1:ne,k2neg:ce,k2:re}}function f(S){if(!["compact","recovered","der"].includes(S))throw new Error('Signature format must be "compact", "recovered", or "der"');return S}function m(S,R){const D={};for(let j of Object.keys(R))D[j]=S[j]===void 0?R[j]:S[j];return(0,r._abool2)(D.lowS,"lowS"),(0,r._abool2)(D.prehash,"prehash"),D.format!==void 0&&f(D.format),D}class E extends Error{constructor(R=""){super(R)}}e.DERErr=E,e.DER={Err:E,_tlv:{encode:(S,R)=>{const{Err:D}=e.DER;if(S<0||S>256)throw new D("tlv.encode: wrong tag");if(R.length&1)throw new D("tlv.encode: unpadded data");const j=R.length/2,P=(0,r.numberToHexUnpadded)(j);if(P.length/2&128)throw new D("tlv.encode: long form length too big");const Q=j>127?(0,r.numberToHexUnpadded)(P.length/2|128):"";return(0,r.numberToHexUnpadded)(S)+Q+P+R},decode(S,R){const{Err:D}=e.DER;let j=0;if(S<0||S>256)throw new D("tlv.encode: wrong tag");if(R.length<2||R[j++]!==S)throw new D("tlv.decode: wrong tlv");const P=R[j++],Q=!!(P&128);let C=0;if(!Q)C=P;else{const J=P&127;if(!J)throw new D("tlv.decode(long): indefinite length not supported");if(J>4)throw new D("tlv.decode(long): byte length is too big");const ne=R.subarray(j,j+J);if(ne.length!==J)throw new D("tlv.decode: length bytes not complete");if(ne[0]===0)throw new D("tlv.decode(long): zero leftmost byte");for(const re of ne)C=C<<8|re;if(j+=J,C<128)throw new D("tlv.decode(long): not minimal encoding")}const K=R.subarray(j,j+C);if(K.length!==C)throw new D("tlv.decode: wrong value length");return{v:K,l:R.subarray(j+C)}}},_int:{encode(S){const{Err:R}=e.DER;if(S<g)throw new R("integer: negative integers are not allowed");let D=(0,r.numberToHexUnpadded)(S);if(Number.parseInt(D[0],16)&8&&(D="00"+D),D.length&1)throw new R("unexpected DER parsing assertion: unpadded hex");return D},decode(S){const{Err:R}=e.DER;if(S[0]&128)throw new R("invalid signature integer: negative");if(S[0]===0&&!(S[1]&128))throw new R("invalid signature integer: unnecessary leading zero");return(0,r.bytesToNumberBE)(S)}},toSig(S){const{Err:R,_int:D,_tlv:j}=e.DER,P=(0,r.ensureBytes)("signature",S),{v:Q,l:C}=j.decode(48,P);if(C.length)throw new R("invalid signature: left bytes after parsing");const{v:K,l:J}=j.decode(2,Q),{v:ne,l:re}=j.decode(2,J);if(re.length)throw new R("invalid signature: left bytes after parsing");return{r:D.decode(K),s:D.decode(ne)}},hexFromSig(S){const{_tlv:R,_int:D}=e.DER,j=R.encode(2,D.encode(S.r)),P=R.encode(2,D.encode(S.s)),Q=j+P;return R.encode(48,Q)}};const g=BigInt(0),y=BigInt(1),w=BigInt(2),v=BigInt(3),_=BigInt(4);function F(S,R){const{BYTES:D}=S;let j;if(typeof R=="bigint")j=R;else{let P=(0,r.ensureBytes)("private key",R);try{j=S.fromBytes(P)}catch{throw new Error(`invalid private key: expected ui8a of size ${D}, got ${typeof R}`)}}if(!S.isValidNot0(j))throw new Error("invalid private key: out of range [1..N-1]");return j}function H(S,R={}){const D=(0,o._createCurveFields)("weierstrass",S,R),{Fp:j,Fn:P}=D;let Q=D.CURVE;const{h:C,n:K}=Q;(0,r._validateObject)(R,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:J}=R;if(J&&(!j.is0(Q.a)||typeof J.beta!="bigint"||!Array.isArray(J.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const ne=N(j,P);function re(){if(!j.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function ie(qe,De,Se){const{x:_e,y:G}=De.toAffine(),B=j.toBytes(_e);if((0,r._abool2)(Se,"isCompressed"),Se){re();const k=!j.isOdd(G);return(0,r.concatBytes)(Y(k),B)}else return(0,r.concatBytes)(Uint8Array.of(4),B,j.toBytes(G))}function ce(qe){(0,r._abytes2)(qe,void 0,"Point");const{publicKey:De,publicKeyUncompressed:Se}=ne,_e=qe.length,G=qe[0],B=qe.subarray(1);if(_e===De&&(G===2||G===3)){const k=j.fromBytes(B);if(!j.isValid(k))throw new Error("bad point: is not on curve, wrong x");const te=we(k);let oe;try{oe=j.sqrt(te)}catch(Ne){const Ie=Ne instanceof Error?": "+Ne.message:"";throw new Error("bad point: is not on curve, sqrt error"+Ie)}re();const xe=j.isOdd(oe);return(G&1)===1!==xe&&(oe=j.neg(oe)),{x:k,y:oe}}else if(_e===Se&&G===4){const k=j.BYTES,te=j.fromBytes(B.subarray(0,k)),oe=j.fromBytes(B.subarray(k,k*2));if(!ke(te,oe))throw new Error("bad point: is not on curve");return{x:te,y:oe}}else throw new Error(`bad point: got length ${_e}, expected compressed=${De} or uncompressed=${Se}`)}const ue=R.toBytes||ie,ae=R.fromBytes||ce;function we(qe){const De=j.sqr(qe),Se=j.mul(De,qe);return j.add(j.add(Se,j.mul(qe,Q.a)),Q.b)}function ke(qe,De){const Se=j.sqr(De),_e=we(qe);return j.eql(Se,_e)}if(!ke(Q.Gx,Q.Gy))throw new Error("bad curve params: generator point");const Re=j.mul(j.pow(Q.a,v),_),be=j.mul(j.sqr(Q.b),BigInt(27));if(j.is0(j.add(Re,be)))throw new Error("bad curve params: a or b");function Fe(qe,De,Se=!1){if(!j.isValid(De)||Se&&j.is0(De))throw new Error(`bad point coordinate ${qe}`);return De}function je(qe){if(!(qe instanceof Ke))throw new Error("ProjectivePoint expected")}function Te(qe){if(!J||!J.basises)throw new Error("no endo");return x(qe,J.basises,P.ORDER)}const rt=(0,r.memoized)((qe,De)=>{const{X:Se,Y:_e,Z:G}=qe;if(j.eql(G,j.ONE))return{x:Se,y:_e};const B=qe.is0();De==null&&(De=B?j.ONE:j.inv(G));const k=j.mul(Se,De),te=j.mul(_e,De),oe=j.mul(G,De);if(B)return{x:j.ZERO,y:j.ZERO};if(!j.eql(oe,j.ONE))throw new Error("invZ was invalid");return{x:k,y:te}}),st=(0,r.memoized)(qe=>{if(qe.is0()){if(R.allowInfinityPoint&&!j.is0(qe.Y))return;throw new Error("bad point: ZERO")}const{x:De,y:Se}=qe.toAffine();if(!j.isValid(De)||!j.isValid(Se))throw new Error("bad point: x or y not field elements");if(!ke(De,Se))throw new Error("bad point: equation left != right");if(!qe.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function Je(qe,De,Se,_e,G){return Se=new Ke(j.mul(Se.X,qe),Se.Y,Se.Z),De=(0,o.negateCt)(_e,De),Se=(0,o.negateCt)(G,Se),De.add(Se)}class Ke{constructor(De,Se,_e){this.X=Fe("x",De),this.Y=Fe("y",Se,!0),this.Z=Fe("z",_e),Object.freeze(this)}static CURVE(){return Q}static fromAffine(De){const{x:Se,y:_e}=De||{};if(!De||!j.isValid(Se)||!j.isValid(_e))throw new Error("invalid affine point");if(De instanceof Ke)throw new Error("projective point not allowed");return j.is0(Se)&&j.is0(_e)?Ke.ZERO:new Ke(Se,_e,j.ONE)}static fromBytes(De){const Se=Ke.fromAffine(ae((0,r._abytes2)(De,void 0,"point")));return Se.assertValidity(),Se}static fromHex(De){return Ke.fromBytes((0,r.ensureBytes)("pointHex",De))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(De=8,Se=!0){return mt.createCache(this,De),Se||this.multiply(v),this}assertValidity(){st(this)}hasEvenY(){const{y:De}=this.toAffine();if(!j.isOdd)throw new Error("Field doesn't support isOdd");return!j.isOdd(De)}equals(De){je(De);const{X:Se,Y:_e,Z:G}=this,{X:B,Y:k,Z:te}=De,oe=j.eql(j.mul(Se,te),j.mul(B,G)),xe=j.eql(j.mul(_e,te),j.mul(k,G));return oe&&xe}negate(){return new Ke(this.X,j.neg(this.Y),this.Z)}double(){const{a:De,b:Se}=Q,_e=j.mul(Se,v),{X:G,Y:B,Z:k}=this;let te=j.ZERO,oe=j.ZERO,xe=j.ZERO,pe=j.mul(G,G),Ne=j.mul(B,B),Ie=j.mul(k,k),$e=j.mul(G,B);return $e=j.add($e,$e),xe=j.mul(G,k),xe=j.add(xe,xe),te=j.mul(De,xe),oe=j.mul(_e,Ie),oe=j.add(te,oe),te=j.sub(Ne,oe),oe=j.add(Ne,oe),oe=j.mul(te,oe),te=j.mul($e,te),xe=j.mul(_e,xe),Ie=j.mul(De,Ie),$e=j.sub(pe,Ie),$e=j.mul(De,$e),$e=j.add($e,xe),xe=j.add(pe,pe),pe=j.add(xe,pe),pe=j.add(pe,Ie),pe=j.mul(pe,$e),oe=j.add(oe,pe),Ie=j.mul(B,k),Ie=j.add(Ie,Ie),pe=j.mul(Ie,$e),te=j.sub(te,pe),xe=j.mul(Ie,Ne),xe=j.add(xe,xe),xe=j.add(xe,xe),new Ke(te,oe,xe)}add(De){je(De);const{X:Se,Y:_e,Z:G}=this,{X:B,Y:k,Z:te}=De;let oe=j.ZERO,xe=j.ZERO,pe=j.ZERO;const Ne=Q.a,Ie=j.mul(Q.b,v);let $e=j.mul(Se,B),Me=j.mul(_e,k),Le=j.mul(G,te),It=j.add(Se,_e),dt=j.add(B,k);It=j.mul(It,dt),dt=j.add($e,Me),It=j.sub(It,dt),dt=j.add(Se,G);let wt=j.add(B,te);return dt=j.mul(dt,wt),wt=j.add($e,Le),dt=j.sub(dt,wt),wt=j.add(_e,G),oe=j.add(k,te),wt=j.mul(wt,oe),oe=j.add(Me,Le),wt=j.sub(wt,oe),pe=j.mul(Ne,dt),oe=j.mul(Ie,Le),pe=j.add(oe,pe),oe=j.sub(Me,pe),pe=j.add(Me,pe),xe=j.mul(oe,pe),Me=j.add($e,$e),Me=j.add(Me,$e),Le=j.mul(Ne,Le),dt=j.mul(Ie,dt),Me=j.add(Me,Le),Le=j.sub($e,Le),Le=j.mul(Ne,Le),dt=j.add(dt,Le),$e=j.mul(Me,dt),xe=j.add(xe,$e),$e=j.mul(wt,dt),oe=j.mul(It,oe),oe=j.sub(oe,$e),$e=j.mul(It,Me),pe=j.mul(wt,pe),pe=j.add(pe,$e),new Ke(oe,xe,pe)}subtract(De){return this.add(De.negate())}is0(){return this.equals(Ke.ZERO)}multiply(De){const{endo:Se}=R;if(!P.isValidNot0(De))throw new Error("invalid scalar: out of range");let _e,G;const B=k=>mt.cached(this,k,te=>(0,o.normalizeZ)(Ke,te));if(Se){const{k1neg:k,k1:te,k2neg:oe,k2:xe}=Te(De),{p:pe,f:Ne}=B(te),{p:Ie,f:$e}=B(xe);G=Ne.add($e),_e=Je(Se.beta,pe,Ie,k,oe)}else{const{p:k,f:te}=B(De);_e=k,G=te}return(0,o.normalizeZ)(Ke,[_e,G])[0]}multiplyUnsafe(De){const{endo:Se}=R,_e=this;if(!P.isValid(De))throw new Error("invalid scalar: out of range");if(De===g||_e.is0())return Ke.ZERO;if(De===y)return _e;if(mt.hasCache(this))return this.multiply(De);if(Se){const{k1neg:G,k1:B,k2neg:k,k2:te}=Te(De),{p1:oe,p2:xe}=(0,o.mulEndoUnsafe)(Ke,_e,B,te);return Je(Se.beta,oe,xe,G,k)}else return mt.unsafe(_e,De)}multiplyAndAddUnsafe(De,Se,_e){const G=this.multiplyUnsafe(Se).add(De.multiplyUnsafe(_e));return G.is0()?void 0:G}toAffine(De){return rt(this,De)}isTorsionFree(){const{isTorsionFree:De}=R;return C===y?!0:De?De(Ke,this):mt.unsafe(this,K).is0()}clearCofactor(){const{clearCofactor:De}=R;return C===y?this:De?De(Ke,this):this.multiplyUnsafe(C)}isSmallOrder(){return this.multiplyUnsafe(C).is0()}toBytes(De=!0){return(0,r._abool2)(De,"isCompressed"),this.assertValidity(),ue(Ke,this,De)}toHex(De=!0){return(0,r.bytesToHex)(this.toBytes(De))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(De=!0){return this.toBytes(De)}_setWindowSize(De){this.precompute(De)}static normalizeZ(De){return(0,o.normalizeZ)(Ke,De)}static msm(De,Se){return(0,o.pippenger)(Ke,P,De,Se)}static fromPrivateKey(De){return Ke.BASE.multiply(F(P,De))}}Ke.BASE=new Ke(Q.Gx,Q.Gy,j.ONE),Ke.ZERO=new Ke(j.ZERO,j.ONE,j.ZERO),Ke.Fp=j,Ke.Fn=P;const at=P.BITS,mt=new o.wNAF(Ke,R.endo?Math.ceil(at/2):at);return Ke.BASE.precompute(8),Ke}function Y(S){return Uint8Array.of(S?2:3)}function T(S,R){const D=S.ORDER;let j=g;for(let ae=D-y;ae%w===g;ae/=w)j+=y;const P=j,Q=w<<P-y-y,C=Q*w,K=(D-y)/C,J=(K-y)/w,ne=C-y,re=Q,ie=S.pow(R,K),ce=S.pow(R,(K+y)/w);let ue=(ae,we)=>{let ke=ie,Re=S.pow(we,ne),be=S.sqr(Re);be=S.mul(be,we);let Fe=S.mul(ae,be);Fe=S.pow(Fe,J),Fe=S.mul(Fe,Re),Re=S.mul(Fe,we),be=S.mul(Fe,ae);let je=S.mul(be,Re);Fe=S.pow(je,re);let Te=S.eql(Fe,S.ONE);Re=S.mul(be,ce),Fe=S.mul(je,ke),be=S.cmov(Re,be,Te),je=S.cmov(Fe,je,Te);for(let rt=P;rt>y;rt--){let st=rt-w;st=w<<st-y;let Je=S.pow(je,st);const Ke=S.eql(Je,S.ONE);Re=S.mul(be,ke),ke=S.mul(ke,ke),Je=S.mul(je,ke),be=S.cmov(Re,be,Ke),je=S.cmov(Je,je,Ke)}return{isValid:Te,value:be}};if(S.ORDER%_===v){const ae=(S.ORDER-v)/_,we=S.sqrt(S.neg(R));ue=(ke,Re)=>{let be=S.sqr(Re);const Fe=S.mul(ke,Re);be=S.mul(be,Fe);let je=S.pow(be,ae);je=S.mul(je,Fe);const Te=S.mul(je,we),rt=S.mul(S.sqr(je),Re),st=S.eql(rt,ke);let Je=S.cmov(Te,je,st);return{isValid:st,value:Je}}}return ue}function L(S,R){(0,c.validateField)(S);const{A:D,B:j,Z:P}=R;if(!S.isValid(D)||!S.isValid(j)||!S.isValid(P))throw new Error("mapToCurveSimpleSWU: invalid opts");const Q=T(S,P);if(!S.isOdd)throw new Error("Field does not have .isOdd()");return C=>{let K,J,ne,re,ie,ce,ue,ae;K=S.sqr(C),K=S.mul(K,P),J=S.sqr(K),J=S.add(J,K),ne=S.add(J,S.ONE),ne=S.mul(ne,j),re=S.cmov(P,S.neg(J),!S.eql(J,S.ZERO)),re=S.mul(re,D),J=S.sqr(ne),ce=S.sqr(re),ie=S.mul(ce,D),J=S.add(J,ie),J=S.mul(J,ne),ce=S.mul(ce,re),ie=S.mul(ce,j),J=S.add(J,ie),ue=S.mul(K,ne);const{isValid:we,value:ke}=Q(J,ce);ae=S.mul(K,C),ae=S.mul(ae,ke),ue=S.cmov(ue,ne,we),ae=S.cmov(ae,ke,we);const Re=S.isOdd(C)===S.isOdd(ae);ae=S.cmov(S.neg(ae),ae,Re);const be=(0,c.FpInvertBatch)(S,[re],!0)[0];return ue=S.mul(ue,be),{x:ue,y:ae}}}function N(S,R){return{secretKey:R.BYTES,publicKey:1+S.BYTES,publicKeyUncompressed:1+2*S.BYTES,publicKeyHasPrefix:!0,signature:2*R.BYTES}}function I(S,R={}){const{Fn:D}=S,j=R.randomBytes||r.randomBytes,P=Object.assign(N(S.Fp,D),{seed:(0,c.getMinHashLength)(D.ORDER)});function Q(ue){try{return!!F(D,ue)}catch{return!1}}function C(ue,ae){const{publicKey:we,publicKeyUncompressed:ke}=P;try{const Re=ue.length;return ae===!0&&Re!==we||ae===!1&&Re!==ke?!1:!!S.fromBytes(ue)}catch{return!1}}function K(ue=j(P.seed)){return(0,c.mapHashToField)((0,r._abytes2)(ue,P.seed,"seed"),D.ORDER)}function J(ue,ae=!0){return S.BASE.multiply(F(D,ue)).toBytes(ae)}function ne(ue){const ae=K(ue);return{secretKey:ae,publicKey:J(ae)}}function re(ue){if(typeof ue=="bigint")return!1;if(ue instanceof S)return!0;const{secretKey:ae,publicKey:we,publicKeyUncompressed:ke}=P;if(D.allowedLengths||ae===we)return;const Re=(0,r.ensureBytes)("key",ue).length;return Re===we||Re===ke}function ie(ue,ae,we=!0){if(re(ue)===!0)throw new Error("first arg must be private key");if(re(ae)===!1)throw new Error("second arg must be public key");const ke=F(D,ue);return S.fromHex(ae).multiply(ke).toBytes(we)}return Object.freeze({getPublicKey:J,getSharedSecret:ie,keygen:ne,Point:S,utils:{isValidSecretKey:Q,isValidPublicKey:C,randomSecretKey:K,isValidPrivateKey:Q,randomPrivateKey:K,normPrivateKeyToScalar:ue=>F(D,ue),precompute(ue=8,ae=S.BASE){return ae.precompute(ue,!1)}},lengths:P})}function U(S,R,D={}){(0,n.ahash)(R),(0,r._validateObject)(D,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const j=D.randomBytes||r.randomBytes,P=D.hmac||((Se,..._e)=>(0,t.hmac)(R,Se,(0,r.concatBytes)(..._e))),{Fp:Q,Fn:C}=S,{ORDER:K,BITS:J}=C,{keygen:ne,getPublicKey:re,getSharedSecret:ie,utils:ce,lengths:ue}=I(S,D),ae={prehash:!1,lowS:typeof D.lowS=="boolean"?D.lowS:!1,format:void 0,extraEntropy:!1},we="compact";function ke(Se){const _e=K>>y;return Se>_e}function Re(Se,_e){if(!C.isValidNot0(_e))throw new Error(`invalid signature ${Se}: out of range 1..Point.Fn.ORDER`);return _e}function be(Se,_e){f(_e);const G=ue.signature,B=_e==="compact"?G:_e==="recovered"?G+1:void 0;return(0,r._abytes2)(Se,B,`${_e} signature`)}class Fe{constructor(_e,G,B){this.r=Re("r",_e),this.s=Re("s",G),B!=null&&(this.recovery=B),Object.freeze(this)}static fromBytes(_e,G=we){be(_e,G);let B;if(G==="der"){const{r:xe,s:pe}=e.DER.toSig((0,r._abytes2)(_e));return new Fe(xe,pe)}G==="recovered"&&(B=_e[0],G="compact",_e=_e.subarray(1));const k=C.BYTES,te=_e.subarray(0,k),oe=_e.subarray(k,k*2);return new Fe(C.fromBytes(te),C.fromBytes(oe),B)}static fromHex(_e,G){return this.fromBytes((0,r.hexToBytes)(_e),G)}addRecoveryBit(_e){return new Fe(this.r,this.s,_e)}recoverPublicKey(_e){const G=Q.ORDER,{r:B,s:k,recovery:te}=this;if(te==null||![0,1,2,3].includes(te))throw new Error("recovery id invalid");if(K*w<G&&te>1)throw new Error("recovery id is ambiguous for h>1 curve");const xe=te===2||te===3?B+K:B;if(!Q.isValid(xe))throw new Error("recovery id 2 or 3 invalid");const pe=Q.toBytes(xe),Ne=S.fromBytes((0,r.concatBytes)(Y((te&1)===0),pe)),Ie=C.inv(xe),$e=Te((0,r.ensureBytes)("msgHash",_e)),Me=C.create(-$e*Ie),Le=C.create(k*Ie),It=S.BASE.multiplyUnsafe(Me).add(Ne.multiplyUnsafe(Le));if(It.is0())throw new Error("point at infinify");return It.assertValidity(),It}hasHighS(){return ke(this.s)}toBytes(_e=we){if(f(_e),_e==="der")return(0,r.hexToBytes)(e.DER.hexFromSig(this));const G=C.toBytes(this.r),B=C.toBytes(this.s);if(_e==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return(0,r.concatBytes)(Uint8Array.of(this.recovery),G,B)}return(0,r.concatBytes)(G,B)}toHex(_e){return(0,r.bytesToHex)(this.toBytes(_e))}assertValidity(){}static fromCompact(_e){return Fe.fromBytes((0,r.ensureBytes)("sig",_e),"compact")}static fromDER(_e){return Fe.fromBytes((0,r.ensureBytes)("sig",_e),"der")}normalizeS(){return this.hasHighS()?new Fe(this.r,C.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,r.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,r.bytesToHex)(this.toBytes("compact"))}}const je=D.bits2int||function(_e){if(_e.length>8192)throw new Error("input is too large");const G=(0,r.bytesToNumberBE)(_e),B=_e.length*8-J;return B>0?G>>BigInt(B):G},Te=D.bits2int_modN||function(_e){return C.create(je(_e))},rt=(0,r.bitMask)(J);function st(Se){return(0,r.aInRange)("num < 2^"+J,Se,g,rt),C.toBytes(Se)}function Je(Se,_e){return(0,r._abytes2)(Se,void 0,"message"),_e?(0,r._abytes2)(R(Se),void 0,"prehashed message"):Se}function Ke(Se,_e,G){if(["recovered","canonical"].some(Me=>Me in G))throw new Error("sign() legacy options not supported");const{lowS:B,prehash:k,extraEntropy:te}=m(G,ae);Se=Je(Se,k);const oe=Te(Se),xe=F(C,_e),pe=[st(xe),st(oe)];if(te!=null&&te!==!1){const Me=te===!0?j(ue.secretKey):te;pe.push((0,r.ensureBytes)("extraEntropy",Me))}const Ne=(0,r.concatBytes)(...pe),Ie=oe;function $e(Me){const Le=je(Me);if(!C.isValidNot0(Le))return;const It=C.inv(Le),dt=S.BASE.multiply(Le).toAffine(),wt=C.create(dt.x);if(wt===g)return;const En=C.create(It*C.create(Ie+wt*xe));if(En===g)return;let dn=(dt.x===wt?0:2)|Number(dt.y&y),ar=En;return B&&ke(En)&&(ar=C.neg(En),dn^=1),new Fe(wt,ar,dn)}return{seed:Ne,k2sig:$e}}function at(Se,_e,G={}){Se=(0,r.ensureBytes)("message",Se);const{seed:B,k2sig:k}=Ke(Se,_e,G);return(0,r.createHmacDrbg)(R.outputLen,C.BYTES,P)(B,k)}function mt(Se){let _e;const G=typeof Se=="string"||(0,r.isBytes)(Se),B=!G&&Se!==null&&typeof Se=="object"&&typeof Se.r=="bigint"&&typeof Se.s=="bigint";if(!G&&!B)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(B)_e=new Fe(Se.r,Se.s);else if(G){try{_e=Fe.fromBytes((0,r.ensureBytes)("sig",Se),"der")}catch(k){if(!(k instanceof e.DER.Err))throw k}if(!_e)try{_e=Fe.fromBytes((0,r.ensureBytes)("sig",Se),"compact")}catch{return!1}}return _e||!1}function qe(Se,_e,G,B={}){const{lowS:k,prehash:te,format:oe}=m(B,ae);if(G=(0,r.ensureBytes)("publicKey",G),_e=Je((0,r.ensureBytes)("message",_e),te),"strict"in B)throw new Error("options.strict was renamed to lowS");const xe=oe===void 0?mt(Se):Fe.fromBytes((0,r.ensureBytes)("sig",Se),oe);if(xe===!1)return!1;try{const pe=S.fromBytes(G);if(k&&xe.hasHighS())return!1;const{r:Ne,s:Ie}=xe,$e=Te(_e),Me=C.inv(Ie),Le=C.create($e*Me),It=C.create(Ne*Me),dt=S.BASE.multiplyUnsafe(Le).add(pe.multiplyUnsafe(It));return dt.is0()?!1:C.create(dt.x)===Ne}catch{return!1}}function De(Se,_e,G={}){const{prehash:B}=m(G,ae);return _e=Je(_e,B),Fe.fromBytes(Se,"recovered").recoverPublicKey(_e).toBytes()}return Object.freeze({keygen:ne,getPublicKey:re,getSharedSecret:ie,utils:ce,lengths:ue,Point:S,sign:at,verify:qe,recoverPublicKey:De,Signature:Fe,hash:R})}function W(S){const{CURVE:R,curveOpts:D}=O(S),j=H(R,D);return q(S,j)}function O(S){const R={a:S.a,b:S.b,p:S.Fp.ORDER,n:S.n,h:S.h,Gx:S.Gx,Gy:S.Gy},D=S.Fp;let j=S.allowedPrivateKeyLengths?Array.from(new Set(S.allowedPrivateKeyLengths.map(C=>Math.ceil(C/2)))):void 0;const P=(0,c.Field)(R.n,{BITS:S.nBitLength,allowedLengths:j,modFromBytes:S.wrapPrivateKey}),Q={Fp:D,Fn:P,allowInfinityPoint:S.allowInfinityPoint,endo:S.endo,isTorsionFree:S.isTorsionFree,clearCofactor:S.clearCofactor,fromBytes:S.fromBytes,toBytes:S.toBytes};return{CURVE:R,curveOpts:Q}}function Z(S){const{CURVE:R,curveOpts:D}=O(S),j={hmac:S.hmac,randomBytes:S.randomBytes,lowS:S.lowS,bits2int:S.bits2int,bits2int_modN:S.bits2int_modN};return{CURVE:R,curveOpts:D,hash:S.hash,ecdsaOpts:j}}function z(S,R,D){function j(P){const Q=S.sqr(P),C=S.mul(Q,P);return S.add(S.add(C,S.mul(P,R)),D)}return j}function q(S,R){const{Fp:D,Fn:j}=R;function P(C){return(0,r.inRange)(C,y,j.ORDER)}const Q=z(D,S.a,S.b);return Object.assign({},{CURVE:S,Point:R,ProjectivePoint:R,normPrivateKeyToScalar:C=>F(j,C),weierstrassEquation:Q,isWithinCurveOrder:P})}function $(S,R){const D=R.Point;return Object.assign({},R,{ProjectivePoint:D,CURVE:Object.assign({},S,(0,c.nLength)(D.Fn.ORDER,D.Fn.BITS))})}function M(S){const{CURVE:R,curveOpts:D,hash:j,ecdsaOpts:P}=Z(S),Q=H(R,D),C=U(Q,j,P);return $(S,C)}})(weierstrass)),weierstrass}var hasRequired_shortw_utils;function require_shortw_utils(){if(hasRequired_shortw_utils)return _shortw_utils;hasRequired_shortw_utils=1,Object.defineProperty(_shortw_utils,"__esModule",{value:!0}),_shortw_utils.getHash=t,_shortw_utils.createCurve=n;const e=requireWeierstrass();function t(r){return{hash:r}}function n(r,o){const c=l=>(0,e.weierstrass)({...r,hash:l});return{...c(o),create:c}}return _shortw_utils}var hashToCurve={},hasRequiredHashToCurve;function requireHashToCurve(){return hasRequiredHashToCurve||(hasRequiredHashToCurve=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._DST_scalar=void 0,e.expand_message_xmd=f,e.expand_message_xof=m,e.hash_to_field=E,e.isogenyMap=g,e.createHasher=y;const t=requireUtils$3(),n=requireModular(),r=t.bytesToNumberBE;function o(w,v){if(l(w),l(v),w<0||w>=1<<8*v)throw new Error("invalid I2OSP input: "+w);const _=Array.from({length:v}).fill(0);for(let F=v-1;F>=0;F--)_[F]=w&255,w>>>=8;return new Uint8Array(_)}function c(w,v){const _=new Uint8Array(w.length);for(let F=0;F<w.length;F++)_[F]=w[F]^v[F];return _}function l(w){if(!Number.isSafeInteger(w))throw new Error("number expected")}function x(w){if(!(0,t.isBytes)(w)&&typeof w!="string")throw new Error("DST must be Uint8Array or string");return typeof w=="string"?(0,t.utf8ToBytes)(w):w}function f(w,v,_,F){(0,t.abytes)(w),l(_),v=x(v),v.length>255&&(v=F((0,t.concatBytes)((0,t.utf8ToBytes)("H2C-OVERSIZE-DST-"),v)));const{outputLen:H,blockLen:Y}=F,T=Math.ceil(_/H);if(_>65535||T>255)throw new Error("expand_message_xmd: invalid lenInBytes");const L=(0,t.concatBytes)(v,o(v.length,1)),N=o(0,Y),I=o(_,2),U=new Array(T),W=F((0,t.concatBytes)(N,w,I,o(0,1),L));U[0]=F((0,t.concatBytes)(W,o(1,1),L));for(let Z=1;Z<=T;Z++){const z=[c(W,U[Z-1]),o(Z+1,1),L];U[Z]=F((0,t.concatBytes)(...z))}return(0,t.concatBytes)(...U).slice(0,_)}function m(w,v,_,F,H){if((0,t.abytes)(w),l(_),v=x(v),v.length>255){const Y=Math.ceil(2*F/8);v=H.create({dkLen:Y}).update((0,t.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(v).digest()}if(_>65535||v.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return H.create({dkLen:_}).update(w).update(o(_,2)).update(v).update(o(v.length,1)).digest()}function E(w,v,_){(0,t._validateObject)(_,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:F,k:H,m:Y,hash:T,expand:L,DST:N}=_;if(!(0,t.isHash)(_.hash))throw new Error("expected valid hash");(0,t.abytes)(w),l(v);const I=F.toString(2).length,U=Math.ceil((I+H)/8),W=v*Y*U;let O;if(L==="xmd")O=f(w,N,W,T);else if(L==="xof")O=m(w,N,W,H,T);else if(L==="_internal_pass")O=w;else throw new Error('expand must be "xmd" or "xof"');const Z=new Array(v);for(let z=0;z<v;z++){const q=new Array(Y);for(let $=0;$<Y;$++){const M=U*($+z*Y),S=O.subarray(M,M+U);q[$]=(0,n.mod)(r(S),F)}Z[z]=q}return Z}function g(w,v){const _=v.map(F=>Array.from(F).reverse());return(F,H)=>{const[Y,T,L,N]=_.map(W=>W.reduce((O,Z)=>w.add(w.mul(O,F),Z))),[I,U]=(0,n.FpInvertBatch)(w,[T,N],!0);return F=w.mul(Y,I),H=w.mul(H,w.mul(L,U)),{x:F,y:H}}}e._DST_scalar=(0,t.utf8ToBytes)("HashToScalar-");function y(w,v,_){if(typeof v!="function")throw new Error("mapToCurve() must be defined");function F(Y){return w.fromAffine(v(Y))}function H(Y){const T=Y.clearCofactor();return T.equals(w.ZERO)?w.ZERO:(T.assertValidity(),T)}return{defaults:_,hashToCurve(Y,T){const L=Object.assign({},_,T),N=E(Y,2,L),I=F(N[0]),U=F(N[1]);return H(I.add(U))},encodeToCurve(Y,T){const L=_.encodeDST?{DST:_.encodeDST}:{},N=Object.assign({},_,L,T),I=E(Y,1,N),U=F(I[0]);return H(U)},mapToCurve(Y){if(!Array.isArray(Y))throw new Error("expected array of bigints");for(const T of Y)if(typeof T!="bigint")throw new Error("expected array of bigints");return H(F(Y))},hashToScalar(Y,T){const L=w.Fn.ORDER,N=Object.assign({},_,{p:L,m:1,DST:e._DST_scalar},T);return E(Y,1,N)[0][0]}}}})(hashToCurve)),hashToCurve}var hasRequiredSecp256k1;function requireSecp256k1(){return hasRequiredSecp256k1||(hasRequiredSecp256k1=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.encodeToCurve=e.hashToCurve=e.secp256k1_hasher=e.schnorr=e.secp256k1=void 0;const t=requireSha2(),n=requireUtils$4(),r=require_shortw_utils(),o=requireHashToCurve(),c=requireModular(),l=requireWeierstrass(),x=requireUtils$3(),f={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},m={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},E=BigInt(0),g=BigInt(1),y=BigInt(2);function w($){const M=f.p,S=BigInt(3),R=BigInt(6),D=BigInt(11),j=BigInt(22),P=BigInt(23),Q=BigInt(44),C=BigInt(88),K=$*$*$%M,J=K*K*$%M,ne=(0,c.pow2)(J,S,M)*J%M,re=(0,c.pow2)(ne,S,M)*J%M,ie=(0,c.pow2)(re,y,M)*K%M,ce=(0,c.pow2)(ie,D,M)*ie%M,ue=(0,c.pow2)(ce,j,M)*ce%M,ae=(0,c.pow2)(ue,Q,M)*ue%M,we=(0,c.pow2)(ae,C,M)*ae%M,ke=(0,c.pow2)(we,Q,M)*ue%M,Re=(0,c.pow2)(ke,S,M)*J%M,be=(0,c.pow2)(Re,P,M)*ce%M,Fe=(0,c.pow2)(be,R,M)*K%M,je=(0,c.pow2)(Fe,y,M);if(!v.eql(v.sqr(je),$))throw new Error("Cannot find square root");return je}const v=(0,c.Field)(f.p,{sqrt:w});e.secp256k1=(0,r.createCurve)({...f,Fp:v,lowS:!0,endo:m},t.sha256);const _={};function F($,...M){let S=_[$];if(S===void 0){const R=(0,t.sha256)((0,x.utf8ToBytes)($));S=(0,x.concatBytes)(R,R),_[$]=S}return(0,t.sha256)((0,x.concatBytes)(S,...M))}const H=$=>$.toBytes(!0).slice(1),Y=e.secp256k1.Point,T=$=>$%y===E;function L($){const{Fn:M,BASE:S}=Y,R=(0,l._normFnElement)(M,$),D=S.multiply(R);return{scalar:T(D.y)?R:M.neg(R),bytes:H(D)}}function N($){const M=v;if(!M.isValidNot0($))throw new Error("invalid x: Fail if x  p");const S=M.create($*$),R=M.create(S*$+BigInt(7));let D=M.sqrt(R);T(D)||(D=M.neg(D));const j=Y.fromAffine({x:$,y:D});return j.assertValidity(),j}const I=x.bytesToNumberBE;function U(...$){return Y.Fn.create(I(F("BIP0340/challenge",...$)))}function W($){return L($).bytes}function O($,M,S=(0,n.randomBytes)(32)){const{Fn:R}=Y,D=(0,x.ensureBytes)("message",$),{bytes:j,scalar:P}=L(M),Q=(0,x.ensureBytes)("auxRand",S,32),C=R.toBytes(P^I(F("BIP0340/aux",Q))),K=F("BIP0340/nonce",C,j,D),{bytes:J,scalar:ne}=L(K),re=U(J,j,D),ie=new Uint8Array(64);if(ie.set(J,0),ie.set(R.toBytes(R.create(ne+re*P)),32),!Z(ie,D,j))throw new Error("sign: Invalid signature produced");return ie}function Z($,M,S){const{Fn:R,BASE:D}=Y,j=(0,x.ensureBytes)("signature",$,64),P=(0,x.ensureBytes)("message",M),Q=(0,x.ensureBytes)("publicKey",S,32);try{const C=N(I(Q)),K=I(j.subarray(0,32));if(!(0,x.inRange)(K,g,f.p))return!1;const J=I(j.subarray(32,64));if(!(0,x.inRange)(J,g,f.n))return!1;const ne=U(R.toBytes(K),H(C),P),re=D.multiplyUnsafe(J).add(C.multiplyUnsafe(R.neg(ne))),{x:ie,y:ce}=re.toAffine();return!(re.is0()||!T(ce)||ie!==K)}catch{return!1}}e.schnorr=(()=>{const S=(D=(0,n.randomBytes)(48))=>(0,c.mapHashToField)(D,f.n);e.secp256k1.utils.randomSecretKey;function R(D){const j=S(D);return{secretKey:j,publicKey:W(j)}}return{keygen:R,getPublicKey:W,sign:O,verify:Z,Point:Y,utils:{randomSecretKey:S,randomPrivateKey:S,taggedHash:F,lift_x:N,pointToBytes:H,numberToBytesBE:x.numberToBytesBE,bytesToNumberBE:x.bytesToNumberBE,mod:c.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})();const z=(0,o.isogenyMap)(v,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map($=>$.map(M=>BigInt(M)))),q=(0,l.mapToCurveSimpleSWU)(v,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:v.create(BigInt("-11"))});e.secp256k1_hasher=(0,o.createHasher)(e.secp256k1.Point,$=>{const{x:M,y:S}=q(v.create($[0]));return z(M,S)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:v.ORDER,m:1,k:128,expand:"xmd",hash:t.sha256}),e.hashToCurve=e.secp256k1_hasher.hashToCurve,e.encodeToCurve=e.secp256k1_hasher.encodeToCurve})(secp256k1)),secp256k1}var utils$2={},hasRequiredUtils$2;function requireUtils$2(){if(hasRequiredUtils$2)return utils$2;hasRequiredUtils$2=1,Object.defineProperty(utils$2,"__esModule",{value:!0}),utils$2.isHash=utils$2.validateObject=utils$2.memoized=utils$2.notImplemented=utils$2.createHmacDrbg=utils$2.bitMask=utils$2.bitSet=utils$2.bitGet=utils$2.bitLen=utils$2.aInRange=utils$2.inRange=utils$2.asciiToBytes=utils$2.copyBytes=utils$2.equalBytes=utils$2.ensureBytes=utils$2.numberToVarBytesBE=utils$2.numberToBytesLE=utils$2.numberToBytesBE=utils$2.bytesToNumberLE=utils$2.bytesToNumberBE=utils$2.hexToNumber=utils$2.numberToHexUnpadded=utils$2.abool=utils$2.utf8ToBytes=utils$2.randomBytes=utils$2.isBytes=utils$2.hexToBytes=utils$2.concatBytes=utils$2.bytesToUtf8=utils$2.bytesToHex=utils$2.anumber=utils$2.abytes=void 0;const e=requireUtils$3();return utils$2.abytes=e.abytes,utils$2.anumber=e.anumber,utils$2.bytesToHex=e.bytesToHex,utils$2.bytesToUtf8=e.bytesToUtf8,utils$2.concatBytes=e.concatBytes,utils$2.hexToBytes=e.hexToBytes,utils$2.isBytes=e.isBytes,utils$2.randomBytes=e.randomBytes,utils$2.utf8ToBytes=e.utf8ToBytes,utils$2.abool=e.abool,utils$2.numberToHexUnpadded=e.numberToHexUnpadded,utils$2.hexToNumber=e.hexToNumber,utils$2.bytesToNumberBE=e.bytesToNumberBE,utils$2.bytesToNumberLE=e.bytesToNumberLE,utils$2.numberToBytesBE=e.numberToBytesBE,utils$2.numberToBytesLE=e.numberToBytesLE,utils$2.numberToVarBytesBE=e.numberToVarBytesBE,utils$2.ensureBytes=e.ensureBytes,utils$2.equalBytes=e.equalBytes,utils$2.copyBytes=e.copyBytes,utils$2.asciiToBytes=e.asciiToBytes,utils$2.inRange=e.inRange,utils$2.aInRange=e.aInRange,utils$2.bitLen=e.bitLen,utils$2.bitGet=e.bitGet,utils$2.bitSet=e.bitSet,utils$2.bitMask=e.bitMask,utils$2.createHmacDrbg=e.createHmacDrbg,utils$2.notImplemented=e.notImplemented,utils$2.memoized=e.memoized,utils$2.validateObject=e.validateObject,utils$2.isHash=e.isHash,utils$2}var hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1;var e=requireSecp256k1(),t=requireModular(),n=requireUtils$2();function r(B){var k=Object.create(null);return B&&Object.keys(B).forEach(function(te){if(te!=="default"){var oe=Object.getOwnPropertyDescriptor(B,te);Object.defineProperty(k,te,oe.get?oe:{enumerable:!0,get:function(){return B[te]}})}}),k.default=B,Object.freeze(k)}var o=r(t),c=r(n);const l=e.secp256k1.ProjectivePoint,x="Expected Private",f="Expected Point",m="Expected Tweak",E="Expected Hash",g="Expected Signature",y="Expected Extra Data (32 bytes)",w="Expected Scalar",v="Bad Recovery Id",_=32,F=32,H=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65]),Y=32,T=new Uint8Array(32),L=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,69,81,35,25,80,183,95,196,64,45,161,114,47,201,186,238]),N=BigInt(1);function I(B){return B instanceof Uint8Array}function U(B,k){for(let te=0;te<32;++te)if(B[te]!==k[te])return B[te]<k[te]?-1:1;return 0}function W(B){return U(B,T)===0}function O(B){return!(!(B instanceof Uint8Array)||B.length!==F||U(B,H)>=0)}function Z(B){return B instanceof Uint8Array&&B.length===64&&U(B.subarray(0,32),H)<0&&U(B.subarray(32,64),H)<0}function z(B){return I(B)&&B.length===64&&U(B.subarray(0,32),L)<0}function q(B){return!(W(B.subarray(0,32))||W(B.subarray(32,64)))}function $(B){return B instanceof Uint8Array&&B.length===_}function M(B){return B===void 0||B instanceof Uint8Array&&B.length===Y}function S(B){let k;if(typeof B=="bigint")k=B;else if(typeof B=="number"&&Number.isSafeInteger(B)&&B>=0)k=BigInt(B);else if(typeof B=="string"){if(B.length!==64)throw new Error("Expected 32 bytes of private scalar");k=c.hexToNumber(B)}else if(B instanceof Uint8Array){if(B.length!==32)throw new Error("Expected 32 bytes of private scalar");k=c.bytesToNumberBE(B)}else throw new TypeError("Expected valid private scalar");if(k<0)throw new Error("Expected private scalar >= 0");return k}function R(B){return e.secp256k1.utils.normPrivateKeyToScalar(B)}function D(B,k){const te=R(B),oe=S(k),xe=c.numberToBytesBE(o.mod(te+oe,e.secp256k1.CURVE.n),32);return e.secp256k1.utils.isValidPrivateKey(xe)?xe:null}function j(B,k){const te=R(B),oe=S(k),xe=c.numberToBytesBE(o.mod(te-oe,e.secp256k1.CURVE.n),32);return e.secp256k1.utils.isValidPrivateKey(xe)?xe:null}function P(B){const k=R(B),te=c.numberToBytesBE(e.secp256k1.CURVE.n-k,32);return e.secp256k1.utils.isValidPrivateKey(te)?te:null}function Q(B,k,te){const oe=re(B),xe=S(k),pe=l.BASE.multiplyAndAddUnsafe(oe,xe,N);if(!pe)throw new Error("Tweaked point at infinity");return pe.toRawBytes(te)}function C(B,k,te){const oe=re(B),xe=typeof k=="string"?k:c.bytesToHex(k),pe=c.hexToNumber(xe);return oe.multiply(pe).toRawBytes(te)}function K(B,k){return B===void 0?k!==void 0?ue(k):!0:!!B}function J(B){try{return B()}catch{return null}}function ne(B){return e.schnorr.utils.lift_x(c.bytesToNumberBE(B))}function re(B){return B.length===32?ne(B):l.fromHex(B)}function ie(B,k){if(B.length===32!==k)return!1;try{return k?!!ne(B):!!l.fromHex(B)}catch{return!1}}function ce(B){return ie(B,!1)}function ue(B){return ie(B,!1)&&B.length===33}function ae(B){return e.secp256k1.utils.isValidPrivateKey(B)}function we(B){return ie(B,!0)}function ke(B,k){if(!we(B))throw new Error(f);if(!O(k))throw new Error(m);return J(()=>{const te=Q(B,k,!0);return{parity:te[0]%2===1?1:0,xOnlyPubkey:te.slice(1)}})}function Re(B){if(!ce(B))throw new Error(f);return B.slice(1,33)}function be(B,k){if(!ae(B))throw new Error(x);return J(()=>e.secp256k1.getPublicKey(B,K(k)))}function Fe(B){if(!ae(B))throw new Error(x);return Re(be(B))}function je(B,k){if(!ce(B))throw new Error(f);return re(B).toRawBytes(K(k,B))}function Te(B,k,te){if(!ce(B))throw new Error(f);if(!O(k))throw new Error(m);return J(()=>C(B,k,K(te,B)))}function rt(B,k,te){if(!ce(B)||!ce(k))throw new Error(f);return J(()=>{const oe=re(B),xe=re(k);return oe.equals(xe.negate())?null:oe.add(xe).toRawBytes(K(te,B))})}function st(B,k,te){if(!ce(B))throw new Error(f);if(!O(k))throw new Error(m);return J(()=>Q(B,k,K(te,B)))}function Je(B,k){if(!ae(B))throw new Error(x);if(!O(k))throw new Error(m);return J(()=>D(B,k))}function Ke(B,k){if(!ae(B))throw new Error(x);if(!O(k))throw new Error(m);return J(()=>j(B,k))}function at(B){if(!ae(B))throw new Error(x);return P(B)}function mt(B,k,te){if(!ae(k))throw new Error(x);if(!$(B))throw new Error(w);if(!M(te))throw new Error(y);return e.secp256k1.sign(B,k,{extraEntropy:te}).toCompactRawBytes()}function qe(B,k,te){if(!ae(k))throw new Error(x);if(!$(B))throw new Error(w);if(!M(te))throw new Error(y);const oe=e.secp256k1.sign(B,k,{extraEntropy:te});return{signature:oe.toCompactRawBytes(),recoveryId:oe.recovery}}function De(B,k,te){if(!ae(k))throw new Error(x);if(!$(B))throw new Error(w);if(!M(te))throw new Error(y);return e.schnorr.sign(B,k,te)}function Se(B,k,te,oe){if(!$(B))throw new Error(E);if(!Z(k)||!q(k))throw new Error(g);if(te&2&&!z(k))throw new Error(v);if(!we(k.subarray(0,32)))throw new Error(g);const pe=e.secp256k1.Signature.fromCompact(k).addRecoveryBit(te).recoverPublicKey(B);if(!pe)throw new Error(g);return pe.toRawBytes(K(oe))}function _e(B,k,te,oe){if(!ce(k))throw new Error(f);if(!Z(te))throw new Error(g);if(!$(B))throw new Error(w);return e.secp256k1.verify(te,B,k,{lowS:oe})}function G(B,k,te){if(!we(k))throw new Error(f);if(!Z(te))throw new Error(g);if(!$(B))throw new Error(w);return e.schnorr.verify(te,B,k)}return dist.isPoint=ce,dist.isPointCompressed=ue,dist.isPrivate=ae,dist.isXOnlyPoint=we,dist.pointAdd=rt,dist.pointAddScalar=st,dist.pointCompress=je,dist.pointFromScalar=be,dist.pointMultiply=Te,dist.privateAdd=Je,dist.privateNegate=at,dist.privateSub=Ke,dist.recover=Se,dist.sign=mt,dist.signRecoverable=qe,dist.signSchnorr=De,dist.verify=_e,dist.verifySchnorr=G,dist.xOnlyPointAddTweak=ke,dist.xOnlyPointFromPoint=Re,dist.xOnlyPointFromScalar=Fe,dist}var distExports=requireDist();const index=getDefaultExportFromCjs(distExports),ecc=_mergeNamespaces({__proto__:null,default:index},[distExports]),bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};var store;function getGlobalConfig(e){return{lang:e?.lang??store?.lang,message:e?.message,abortEarly:e?.abortEarly??store?.abortEarly,abortPipeEarly:e?.abortPipeEarly??store?.abortPipeEarly}}var store2;function getGlobalMessage(e){return store2?.get(e)}var store3;function getSchemaMessage(e){return store3?.get(e)}var store4;function getSpecificMessage(e,t){return store4?.get(e)?.get(t)}function _stringify(e){const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function _addIssue(e,t,n,r,o){const c=o&&"input"in o?o.input:n.value,l=o?.expected??e.expects??null,x=o?.received??_stringify(c),f={kind:e.kind,type:e.type,input:c,expected:l,received:x,message:`Invalid ${t}: ${l?`Expected ${l} but r`:"R"}eceived ${x}`,requirement:e.requirement,path:o?.path,issues:o?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},m=e.kind==="schema",E=o?.message??e.message??getSpecificMessage(e.reference,f.lang)??(m?getSchemaMessage(f.lang):null)??r.message??getGlobalMessage(f.lang);E&&(f.message=typeof E=="function"?E(f):E),m&&(n.typed=!1),n.issues?n.issues.push(f):n.issues=[f]}var ValiError=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function integer(e){return{kind:"validation",type:"integer",reference:integer,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(t,n){return t.typed&&!this.requirement(t.value)&&_addIssue(this,"integer",t,n),t}}}function length(e,t){return{kind:"validation",type:"length",reference:length,async:!1,expects:`${e}`,requirement:e,message:t,_run(n,r){return n.typed&&n.value.length!==this.requirement&&_addIssue(this,"length",n,r,{received:`${n.value.length}`}),n}}}function maxValue(e,t){return{kind:"validation",type:"max_value",reference:maxValue,async:!1,expects:`<=${e instanceof Date?e.toJSON():_stringify(e)}`,requirement:e,message:t,_run(n,r){return n.typed&&n.value>this.requirement&&_addIssue(this,"value",n,r,{received:n.value instanceof Date?n.value.toJSON():_stringify(n.value)}),n}}}function minValue(e,t){return{kind:"validation",type:"min_value",reference:minValue,async:!1,expects:`>=${e instanceof Date?e.toJSON():_stringify(e)}`,requirement:e,message:t,_run(n,r){return n.typed&&n.value<this.requirement&&_addIssue(this,"value",n,r,{received:n.value instanceof Date?n.value.toJSON():_stringify(n.value)}),n}}}function transform(e){return{kind:"transformation",type:"transform",reference:transform,async:!1,operation:e,_run(t){return t.value=this.operation(t.value),t}}}function getDefault(e,t,n){return typeof e.default=="function"?e.default(t,n):e.default}function boolean(e){return{kind:"schema",type:"boolean",reference:boolean,expects:"boolean",async:!1,message:e,_run(t,n){return typeof t.value=="boolean"?t.typed=!0:_addIssue(this,"type",t,n),t}}}function instance(e,t){return{kind:"schema",type:"instance",reference:instance,expects:e.name,async:!1,class:e,message:t,_run(n,r){return n.value instanceof this.class?n.typed=!0:_addIssue(this,"type",n,r),n}}}function number(e){return{kind:"schema",type:"number",reference:number,expects:"number",async:!1,message:e,_run(t,n){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:_addIssue(this,"type",t,n),t}}}function object(e,t){return{kind:"schema",type:"object",reference:object,expects:"Object",async:!1,entries:e,message:t,_run(n,r){const o=n.value;if(o&&typeof o=="object"){n.typed=!0,n.value={};for(const c in this.entries){const l=o[c],x=this.entries[c]._run({typed:!1,value:l},r);if(x.issues){const f={type:"object",origin:"value",input:o,key:c,value:l};for(const m of x.issues)m.path?m.path.unshift(f):m.path=[f],n.issues?.push(m);if(n.issues||(n.issues=x.issues),r.abortEarly){n.typed=!1;break}}x.typed||(n.typed=!1),(x.value!==void 0||c in o)&&(n.value[c]=x.value)}}else _addIssue(this,"type",n,r);return n}}}function optional(e,...t){const n={kind:"schema",type:"optional",reference:optional,expects:`${e.expects} | undefined`,async:!1,wrapped:e,_run(r,o){return r.value===void 0&&("default"in this&&(r.value=getDefault(this,r,o)),r.value===void 0)?(r.typed=!0,r):this.wrapped._run(r,o)}};return 0 in t&&(n.default=t[0]),n}function string(e){return{kind:"schema",type:"string",reference:string,expects:"string",async:!1,message:e,_run(t,n){return typeof t.value=="string"?t.typed=!0:_addIssue(this,"type",t,n),t}}}function _subIssues(e){let t;if(e)for(const n of e)t?t.push(...n.issues):t=n.issues;return t}function union(e,t){return{kind:"schema",type:"union",reference:union,expects:[...new Set(e.map(n=>n.expects))].join(" | ")||"never",async:!1,options:e,message:t,_run(n,r){let o,c,l;for(const x of this.options){const f=x._run({typed:!1,value:n.value},r);if(f.typed)if(f.issues)c?c.push(f):c=[f];else{o=f;break}else l?l.push(f):l=[f]}if(o)return o;if(c){if(c.length===1)return c[0];_addIssue(this,"type",n,r,{issues:_subIssues(c)}),n.typed=!0}else{if(l?.length===1)return l[0];_addIssue(this,"type",n,r,{issues:_subIssues(l)})}return n}}}function parse(e,t,n){const r=e._run({typed:!1,value:t},getGlobalConfig(n));if(r.issues)throw new ValiError(r.issues);return r.value}function pipe(...e){return{...e[0],pipe:e,_run(t,n){for(const r of e)if(r.kind!=="metadata"){if(t.issues&&(r.kind==="schema"||r.kind==="transformation")){t.typed=!1;break}(!t.issues||!n.abortEarly&&!n.abortPipeEarly)&&(t=r._run(t,n))}return t}}}const Uint32Schema=pipe(number(),integer(),minValue(0),maxValue(4294967295)),Uint8Schema=pipe(number(),integer(),minValue(0),maxValue(255)),NetworkSchema=object({messagePrefix:union([string(),instance(Uint8Array)]),bech32:string(),bip32:object({public:Uint32Schema,private:Uint32Schema}),pubKeyHash:Uint8Schema,scriptHash:Uint8Schema,wif:Uint8Schema}),Buffer256Bit=pipe(instance(Uint8Array),length(32));function decodeRaw(e,t){if(e.length===33)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(e.length!==34)throw new Error("Invalid WIF length");if(e[33]!==1)throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function encodeRaw(e,t,n){if(t.length!==32)throw new TypeError("Invalid privateKey length");var r=new Uint8Array(n?34:33),o=new DataView(r.buffer);return o.setUint8(0,e),r.set(t,1),n&&(r[33]=1),r}function decode(e,t){return decodeRaw(bs58Check.decode(e))}function encode(e){return bs58Check.encode(encodeRaw(e.version,e.privateKey,e.compressed))}const h=e=>Buffer.from(e,"hex");function testEcc(e){assert(e.isPoint(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(!e.isPoint(h("030000000000000000000000000000000000000000000000000000000000000005"))),assert(e.isPrivate(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),assert(!e.isPrivate(h("0000000000000000000000000000000000000000000000000000000000000000"))),assert(!e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),assert(!e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),assert(Buffer.from(e.privateAdd(h("0000000000000000000000000000000000000000000000000000000000000001"),h("0000000000000000000000000000000000000000000000000000000000000000"))).equals(h("0000000000000000000000000000000000000000000000000000000000000001"))),assert(e.privateAdd(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),h("0000000000000000000000000000000000000000000000000000000000000003"))===null),assert(Buffer.from(e.privateAdd(h("e211078564db65c3ce7704f08262b1f38f1ef412ad15b5ac2d76657a63b2c500"),h("b51fbb69051255d1becbd683de5848242a89c229348dd72896a87ada94ae8665"))).equals(h("9730c2ee69edbb958d42db7460bafa18fef9d955325aec99044c81c8282b0a24"))),assert(Buffer.from(e.privateNegate(h("0000000000000000000000000000000000000000000000000000000000000001"))).equals(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),assert(Buffer.from(e.privateNegate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(h("0000000000000000000000000000000000000000000000000000000000000003"))),assert(Buffer.from(e.privateNegate(h("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(h("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792"))),assert(Buffer.from(e.pointCompress(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(Buffer.from(e.pointCompress(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),assert(Buffer.from(e.pointCompress(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(Buffer.from(e.pointCompress(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),assert(Buffer.from(e.pointFromScalar(h("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(h("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),assert(e.xOnlyPointAddTweak(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))===null);let t=e.xOnlyPointAddTweak(h("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),h("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));assert(Buffer.from(t.xOnlyPubkey).equals(h("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&t.parity===1),t=e.xOnlyPointAddTweak(h("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),h("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47")),assert(Buffer.from(t.xOnlyPubkey).equals(h("9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"))&&t.parity===0),assert(Buffer.from(e.sign(h("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(h("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),assert(e.verify(h("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),h("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),e.signSchnorr&&assert(Buffer.from(e.signSchnorr(h("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),h("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),h("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(h("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),e.verifySchnorr&&assert(e.verifySchnorr(h("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),h("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),h("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}function assert(e){if(!e)throw new Error("ecc library invalid")}const HEX_STRINGS="0123456789abcdefABCDEF";HEX_STRINGS.split("").map(e=>e.codePointAt(0));Array(256).fill(!0).map((e,t)=>{const n=String.fromCodePoint(t),r=HEX_STRINGS.indexOf(n);return r<0?void 0:r<16?r:r-6});new TextEncoder;new TextDecoder;function concat(e){const t=e.reduce((o,c)=>o+c.length,0),n=new Uint8Array(t);let r=0;for(const o of e)n.set(o,r),r+=o.length;return n}function writeUInt32(e,t,n,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${n}`);r==="LE"?(e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255):(e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=n&255)}const ECPairOptionsSchema=optional(object({compressed:optional(boolean()),network:optional(NetworkSchema),rng:optional(pipe(instance(Function),transform(e=>t=>{const n=parse(optional(number()),t),r=e(n);return parse(instance(Uint8Array),r)})))})),toXOnly=e=>e.length===32?e:e.subarray(1,33);function ECPairFactory(e){testEcc(e);function t(x){return e.isPoint(x)}function n(x,f){if(parse(Buffer256Bit,x),!e.isPrivate(x))throw new TypeError("Private key not in range [1, n)");return parse(ECPairOptionsSchema,f),new l(x,void 0,f)}function r(x,f){if(!e.isPoint(x))throw new Error("Point not on the curve");return parse(ECPairOptionsSchema,f),new l(void 0,x,f)}function o(x,f){const m=decode(x),E=m.version;if(Array.isArray(f)){if(f=f.filter(g=>E===g.wif).pop(),!f)throw new Error("Unknown network version")}else if(f=f||bitcoin,E!==f.wif)throw new Error("Invalid network version");return n(m.privateKey,{compressed:m.compressed,network:f})}function c(x){parse(ECPairOptionsSchema,x),x===void 0&&(x={});const f=x.rng||(E=>crypto.getRandomValues(new Uint8Array(E)));let m;do m=f(32),parse(Buffer256Bit,m);while(!e.isPrivate(m));return n(m,x)}class l{__D;__Q;compressed;network;lowR;constructor(f,m,E){this.__D=f,this.__Q=m,this.lowR=!1,E===void 0&&(E={}),this.compressed=E.compressed===void 0?!0:E.compressed,this.network=E.network||bitcoin,m!==void 0&&(this.__Q=e.pointCompress(m,this.compressed))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){const f=e.pointFromScalar(this.__D,this.compressed);this.__Q=f}return this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return encode({compressed:this.compressed,privateKey:this.__D,version:this.network.wif})}tweak(f){return this.privateKey?this.tweakFromPrivateKey(f):this.tweakFromPublicKey(f)}sign(f,m){if(!this.__D)throw new Error("Missing private key");if(m===void 0&&(m=this.lowR),m===!1)return e.sign(f,this.__D);{let E=e.sign(f,this.__D);const g=new Uint8Array(32);let y=0;for(;E[0]>127;)y++,writeUInt32(g,0,y,"LE"),E=e.sign(f,this.__D,g);return E}}signSchnorr(f){if(!this.privateKey)throw new Error("Missing private key");if(!e.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return e.signSchnorr(f,this.privateKey)}verify(f,m){return e.verify(f,this.publicKey,m)}verifySchnorr(f,m){if(!e.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return e.verifySchnorr(f,this.publicKey.subarray(1,33),m)}tweakFromPublicKey(f){const m=toXOnly(this.publicKey),E=e.xOnlyPointAddTweak(m,f);if(!E||E.xOnlyPubkey===null)throw new Error("Cannot tweak public key!");const g=Uint8Array.from([E.parity===0?2:3]);return r(concat([g,E.xOnlyPubkey]),{network:this.network,compressed:this.compressed})}tweakFromPrivateKey(f){const E=this.publicKey[0]===3||this.publicKey[0]===4&&(this.publicKey[64]&1)===1?e.privateNegate(this.privateKey):this.privateKey,g=e.privateAdd(E,f);if(!g)throw new Error("Invalid tweaked private key!");return n(g,{network:this.network,compressed:this.compressed})}}return{isPoint:t,fromPrivateKey:n,fromPublicKey:r,fromWIF:o,makeRandom:c}}let ECPair=null;function getECPair(){return ECPair||(initEccLib(ecc),ECPair=ECPairFactory(ecc)),ECPair}function nostrPubkeyToBitcoinAddress(e){try{getECPair();const t=Buffer.from(e,"hex"),{address:n}=p2tr({internalPubkey:t,network:bitcoin$1});return n||""}catch(t){return console.error("Error generating Bitcoin address:",t),""}}function npubToBitcoinAddress(e){try{const t=nip19_exports$1.decode(e);if(t.type!=="npub")throw new Error("Invalid npub format");const n=t.data;return nostrPubkeyToBitcoinAddress(n)}catch(t){throw console.error("Error converting npub to Bitcoin address:",t),t}}async function fetchUTXOs(e){const t=await fetch(`https://blockstream.info/api/address/${e}/utxo`);if(!t.ok)throw new Error("Failed to fetch UTXOs");return t.json()}async function getFeeRates(){const e=await fetch("https://blockstream.info/api/fee-estimates");if(!e.ok)throw new Error("Failed to fetch fee estimates");const t=await e.json();return{fastestFee:Math.ceil(t[1]||1),halfHourFee:Math.ceil(t[3]||1),hourFee:Math.ceil(t[6]||1),economyFee:Math.ceil(t[144]||1),minimumFee:Math.ceil(t[504]||1)}}async function broadcastTransaction(e){const t=await fetch("https://blockstream.info/api/tx",{method:"POST",body:e});if(!t.ok){const n=await t.text();throw new Error(`Failed to broadcast transaction: ${n}`)}return t.text()}async function createBitcoinTransaction(e,t,n,r,o){const c=Buffer.from(e,"hex"),l=getECPair().fromPrivateKey(c),x=l.publicKey.slice(1,33),{address:f}=p2tr({internalPubkey:x,network:bitcoin$1});if(!f)throw new Error("Failed to generate change address");const m=new Psbt({network:bitcoin$1});let E=0;for(const H of r)m.addInput({hash:H.txid,index:H.vout,witnessUtxo:{script:p2tr({internalPubkey:x,network:bitcoin$1}).output,value:BigInt(H.value)},tapInternalKey:x}),E+=H.value;const g=r.length*57.5+86+10.5,y=Math.ceil(g*o),w=E-n-y;if(w<0)throw new Error(`Insufficient funds. Need ${n+y} sats, have ${E} sats`);m.addOutput({address:t,value:BigInt(n)}),w>546&&m.addOutput({address:f,value:BigInt(w)});const _=l.tweak(taggedHash("TapTweak",x));for(let H=0;H<r.length;H++)m.signInput(H,_);return m.finalizeAllInputs(),{txHex:m.extractTransaction().toHex(),fee:y}}function satsToBTC(e){return(e/1e8).toFixed(8)}function btcToSats(e){return Math.round(e*1e8)}async function fetchTxHistory(e){const t=await fetch(`https://blockstream.info/api/address/${e}/txs`);if(!t.ok)throw new Error("Failed to fetch transaction history");return t.json()}var browser={},canPromise,hasRequiredCanPromise;function requireCanPromise(){return hasRequiredCanPromise||(hasRequiredCanPromise=1,canPromise=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),canPromise}var qrcode={},utils$1={},hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;hasRequiredUtils$1=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return utils$1.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},utils$1.getSymbolTotalCodewords=function(r){return t[r]},utils$1.getBCHDigit=function(n){let r=0;for(;n!==0;)r++,n>>>=1;return r},utils$1.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');e=r},utils$1.isKanjiModeEnabled=function(){return typeof e<"u"},utils$1.toSJIS=function(r){return e(r)},utils$1}var errorCorrectionLevel={},hasRequiredErrorCorrectionLevel;function requireErrorCorrectionLevel(){return hasRequiredErrorCorrectionLevel||(hasRequiredErrorCorrectionLevel=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},e.from=function(r,o){if(e.isValid(r))return r;try{return t(r)}catch{return o}}})(errorCorrectionLevel)),errorCorrectionLevel}var bitBuffer,hasRequiredBitBuffer;function requireBitBuffer(){if(hasRequiredBitBuffer)return bitBuffer;hasRequiredBitBuffer=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const n=Math.floor(t/8);return(this.buffer[n]>>>7-t%8&1)===1},put:function(t,n){for(let r=0;r<n;r++)this.putBit((t>>>n-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),t&&(this.buffer[n]|=128>>>this.length%8),this.length++}},bitBuffer=e,bitBuffer}var bitMatrix,hasRequiredBitMatrix;function requireBitMatrix(){if(hasRequiredBitMatrix)return bitMatrix;hasRequiredBitMatrix=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,n,r,o){const c=t*this.size+n;this.data[c]=r,o&&(this.reservedBit[c]=!0)},e.prototype.get=function(t,n){return this.data[t*this.size+n]},e.prototype.xor=function(t,n,r){this.data[t*this.size+n]^=r},e.prototype.isReserved=function(t,n){return this.reservedBit[t*this.size+n]},bitMatrix=e,bitMatrix}var alignmentPattern={},hasRequiredAlignmentPattern;function requireAlignmentPattern(){return hasRequiredAlignmentPattern||(hasRequiredAlignmentPattern=1,(function(e){const t=requireUtils$1().getSymbolSize;e.getRowColCoords=function(r){if(r===1)return[];const o=Math.floor(r/7)+2,c=t(r),l=c===145?26:Math.ceil((c-13)/(2*o-2))*2,x=[c-7];for(let f=1;f<o-1;f++)x[f]=x[f-1]-l;return x.push(6),x.reverse()},e.getPositions=function(r){const o=[],c=e.getRowColCoords(r),l=c.length;for(let x=0;x<l;x++)for(let f=0;f<l;f++)x===0&&f===0||x===0&&f===l-1||x===l-1&&f===0||o.push([c[x],c[f]]);return o}})(alignmentPattern)),alignmentPattern}var finderPattern={},hasRequiredFinderPattern;function requireFinderPattern(){if(hasRequiredFinderPattern)return finderPattern;hasRequiredFinderPattern=1;const e=requireUtils$1().getSymbolSize,t=7;return finderPattern.getPositions=function(r){const o=e(r);return[[0,0],[o-t,0],[0,o-t]]},finderPattern}var maskPattern={},hasRequiredMaskPattern;function requireMaskPattern(){return hasRequiredMaskPattern||(hasRequiredMaskPattern=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const c=o.size;let l=0,x=0,f=0,m=null,E=null;for(let g=0;g<c;g++){x=f=0,m=E=null;for(let y=0;y<c;y++){let w=o.get(g,y);w===m?x++:(x>=5&&(l+=t.N1+(x-5)),m=w,x=1),w=o.get(y,g),w===E?f++:(f>=5&&(l+=t.N1+(f-5)),E=w,f=1)}x>=5&&(l+=t.N1+(x-5)),f>=5&&(l+=t.N1+(f-5))}return l},e.getPenaltyN2=function(o){const c=o.size;let l=0;for(let x=0;x<c-1;x++)for(let f=0;f<c-1;f++){const m=o.get(x,f)+o.get(x,f+1)+o.get(x+1,f)+o.get(x+1,f+1);(m===4||m===0)&&l++}return l*t.N2},e.getPenaltyN3=function(o){const c=o.size;let l=0,x=0,f=0;for(let m=0;m<c;m++){x=f=0;for(let E=0;E<c;E++)x=x<<1&2047|o.get(m,E),E>=10&&(x===1488||x===93)&&l++,f=f<<1&2047|o.get(E,m),E>=10&&(f===1488||f===93)&&l++}return l*t.N3},e.getPenaltyN4=function(o){let c=0;const l=o.data.length;for(let f=0;f<l;f++)c+=o.data[f];return Math.abs(Math.ceil(c*100/l/5)-10)*t.N4};function n(r,o,c){switch(r){case e.Patterns.PATTERN000:return(o+c)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return c%3===0;case e.Patterns.PATTERN011:return(o+c)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(c/3))%2===0;case e.Patterns.PATTERN101:return o*c%2+o*c%3===0;case e.Patterns.PATTERN110:return(o*c%2+o*c%3)%2===0;case e.Patterns.PATTERN111:return(o*c%3+(o+c)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}e.applyMask=function(o,c){const l=c.size;for(let x=0;x<l;x++)for(let f=0;f<l;f++)c.isReserved(f,x)||c.xor(f,x,n(o,f,x))},e.getBestMask=function(o,c){const l=Object.keys(e.Patterns).length;let x=0,f=1/0;for(let m=0;m<l;m++){c(m),e.applyMask(m,o);const E=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(m,o),E<f&&(f=E,x=m)}return x}})(maskPattern)),maskPattern}var errorCorrectionCode={},hasRequiredErrorCorrectionCode;function requireErrorCorrectionCode(){if(hasRequiredErrorCorrectionCode)return errorCorrectionCode;hasRequiredErrorCorrectionCode=1;const e=requireErrorCorrectionLevel(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return errorCorrectionCode.getBlocksCount=function(o,c){switch(c){case e.L:return t[(o-1)*4+0];case e.M:return t[(o-1)*4+1];case e.Q:return t[(o-1)*4+2];case e.H:return t[(o-1)*4+3];default:return}},errorCorrectionCode.getTotalCodewordsCount=function(o,c){switch(c){case e.L:return n[(o-1)*4+0];case e.M:return n[(o-1)*4+1];case e.Q:return n[(o-1)*4+2];case e.H:return n[(o-1)*4+3];default:return}},errorCorrectionCode}var polynomial={},galoisField={},hasRequiredGaloisField;function requireGaloisField(){if(hasRequiredGaloisField)return galoisField;hasRequiredGaloisField=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let r=1;for(let o=0;o<255;o++)e[o]=r,t[r]=o,r<<=1,r&256&&(r^=285);for(let o=255;o<512;o++)e[o]=e[o-255]})(),galoisField.log=function(r){if(r<1)throw new Error("log("+r+")");return t[r]},galoisField.exp=function(r){return e[r]},galoisField.mul=function(r,o){return r===0||o===0?0:e[t[r]+t[o]]},galoisField}var hasRequiredPolynomial;function requirePolynomial(){return hasRequiredPolynomial||(hasRequiredPolynomial=1,(function(e){const t=requireGaloisField();e.mul=function(r,o){const c=new Uint8Array(r.length+o.length-1);for(let l=0;l<r.length;l++)for(let x=0;x<o.length;x++)c[l+x]^=t.mul(r[l],o[x]);return c},e.mod=function(r,o){let c=new Uint8Array(r);for(;c.length-o.length>=0;){const l=c[0];for(let f=0;f<o.length;f++)c[f]^=t.mul(o[f],l);let x=0;for(;x<c.length&&c[x]===0;)x++;c=c.slice(x)}return c},e.generateECPolynomial=function(r){let o=new Uint8Array([1]);for(let c=0;c<r;c++)o=e.mul(o,new Uint8Array([1,t.exp(c)]));return o}})(polynomial)),polynomial}var reedSolomonEncoder,hasRequiredReedSolomonEncoder;function requireReedSolomonEncoder(){if(hasRequiredReedSolomonEncoder)return reedSolomonEncoder;hasRequiredReedSolomonEncoder=1;const e=requirePolynomial();function t(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(r){this.degree=r,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(r.length+this.degree);o.set(r);const c=e.mod(o,this.genPoly),l=this.degree-c.length;if(l>0){const x=new Uint8Array(this.degree);return x.set(c,l),x}return c},reedSolomonEncoder=t,reedSolomonEncoder}var version={},mode={},versionCheck={},hasRequiredVersionCheck;function requireVersionCheck(){return hasRequiredVersionCheck||(hasRequiredVersionCheck=1,versionCheck.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),versionCheck}var regex={},hasRequiredRegex;function requireRegex(){if(hasRequiredRegex)return regex;hasRequiredRegex=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;regex.KANJI=new RegExp(n,"g"),regex.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),regex.BYTE=new RegExp(r,"g"),regex.NUMERIC=new RegExp(e,"g"),regex.ALPHANUMERIC=new RegExp(t,"g");const o=new RegExp("^"+n+"$"),c=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return regex.testKanji=function(f){return o.test(f)},regex.testNumeric=function(f){return c.test(f)},regex.testAlphanumeric=function(f){return l.test(f)},regex}var hasRequiredMode;function requireMode(){return hasRequiredMode||(hasRequiredMode=1,(function(e){const t=requireVersionCheck(),n=requireRegex();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(c,l){if(!c.ccBits)throw new Error("Invalid mode: "+c);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?c.ccBits[0]:l<27?c.ccBits[1]:c.ccBits[2]},e.getBestModeForData=function(c){return n.testNumeric(c)?e.NUMERIC:n.testAlphanumeric(c)?e.ALPHANUMERIC:n.testKanji(c)?e.KANJI:e.BYTE},e.toString=function(c){if(c&&c.id)return c.id;throw new Error("Invalid mode")},e.isValid=function(c){return c&&c.bit&&c.ccBits};function r(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(c,l){if(e.isValid(c))return c;try{return r(c)}catch{return l}}})(mode)),mode}var hasRequiredVersion;function requireVersion(){return hasRequiredVersion||(hasRequiredVersion=1,(function(e){const t=requireUtils$1(),n=requireErrorCorrectionCode(),r=requireErrorCorrectionLevel(),o=requireMode(),c=requireVersionCheck(),l=7973,x=t.getBCHDigit(l);function f(y,w,v){for(let _=1;_<=40;_++)if(w<=e.getCapacity(_,v,y))return _}function m(y,w){return o.getCharCountIndicator(y,w)+4}function E(y,w){let v=0;return y.forEach(function(_){const F=m(_.mode,w);v+=F+_.getBitsLength()}),v}function g(y,w){for(let v=1;v<=40;v++)if(E(y,v)<=e.getCapacity(v,w,o.MIXED))return v}e.from=function(w,v){return c.isValid(w)?parseInt(w,10):v},e.getCapacity=function(w,v,_){if(!c.isValid(w))throw new Error("Invalid QR Code version");typeof _>"u"&&(_=o.BYTE);const F=t.getSymbolTotalCodewords(w),H=n.getTotalCodewordsCount(w,v),Y=(F-H)*8;if(_===o.MIXED)return Y;const T=Y-m(_,w);switch(_){case o.NUMERIC:return Math.floor(T/10*3);case o.ALPHANUMERIC:return Math.floor(T/11*2);case o.KANJI:return Math.floor(T/13);case o.BYTE:default:return Math.floor(T/8)}},e.getBestVersionForData=function(w,v){let _;const F=r.from(v,r.M);if(Array.isArray(w)){if(w.length>1)return g(w,F);if(w.length===0)return 1;_=w[0]}else _=w;return f(_.mode,_.getLength(),F)},e.getEncodedBits=function(w){if(!c.isValid(w)||w<7)throw new Error("Invalid QR Code version");let v=w<<12;for(;t.getBCHDigit(v)-x>=0;)v^=l<<t.getBCHDigit(v)-x;return w<<12|v}})(version)),version}var formatInfo={},hasRequiredFormatInfo;function requireFormatInfo(){if(hasRequiredFormatInfo)return formatInfo;hasRequiredFormatInfo=1;const e=requireUtils$1(),t=1335,n=21522,r=e.getBCHDigit(t);return formatInfo.getEncodedBits=function(c,l){const x=c.bit<<3|l;let f=x<<10;for(;e.getBCHDigit(f)-r>=0;)f^=t<<e.getBCHDigit(f)-r;return(x<<10|f)^n},formatInfo}var segments={},numericData,hasRequiredNumericData;function requireNumericData(){if(hasRequiredNumericData)return numericData;hasRequiredNumericData=1;const e=requireMode();function t(n){this.mode=e.NUMERIC,this.data=n.toString()}return t.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){let o,c,l;for(o=0;o+3<=this.data.length;o+=3)c=this.data.substr(o,3),l=parseInt(c,10),r.put(l,10);const x=this.data.length-o;x>0&&(c=this.data.substr(o),l=parseInt(c,10),r.put(l,x*3+1))},numericData=t,numericData}var alphanumericData,hasRequiredAlphanumericData;function requireAlphanumericData(){if(hasRequiredAlphanumericData)return alphanumericData;hasRequiredAlphanumericData=1;const e=requireMode(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(r){this.mode=e.ALPHANUMERIC,this.data=r}return n.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let c;for(c=0;c+2<=this.data.length;c+=2){let l=t.indexOf(this.data[c])*45;l+=t.indexOf(this.data[c+1]),o.put(l,11)}this.data.length%2&&o.put(t.indexOf(this.data[c]),6)},alphanumericData=n,alphanumericData}var byteData,hasRequiredByteData;function requireByteData(){if(hasRequiredByteData)return byteData;hasRequiredByteData=1;const e=requireMode();function t(n){this.mode=e.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return t.getBitsLength=function(r){return r*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){for(let r=0,o=this.data.length;r<o;r++)n.put(this.data[r],8)},byteData=t,byteData}var kanjiData,hasRequiredKanjiData;function requireKanjiData(){if(hasRequiredKanjiData)return kanjiData;hasRequiredKanjiData=1;const e=requireMode(),t=requireUtils$1();function n(r){this.mode=e.KANJI,this.data=r}return n.getBitsLength=function(o){return o*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let o;for(o=0;o<this.data.length;o++){let c=t.toSJIS(this.data[o]);if(c>=33088&&c<=40956)c-=33088;else if(c>=57408&&c<=60351)c-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);c=(c>>>8&255)*192+(c&255),r.put(c,13)}},kanjiData=n,kanjiData}var dijkstra={exports:{}},hasRequiredDijkstra;function requireDijkstra(){return hasRequiredDijkstra||(hasRequiredDijkstra=1,(function(e){var t={single_source_shortest_paths:function(n,r,o){var c={},l={};l[r]=0;var x=t.PriorityQueue.make();x.push(r,0);for(var f,m,E,g,y,w,v,_,F;!x.empty();){f=x.pop(),m=f.value,g=f.cost,y=n[m]||{};for(E in y)y.hasOwnProperty(E)&&(w=y[E],v=g+w,_=l[E],F=typeof l[E]>"u",(F||_>v)&&(l[E]=v,x.push(E,v),c[E]=m))}if(typeof o<"u"&&typeof l[o]>"u"){var H=["Could not find a path from ",r," to ",o,"."].join("");throw new Error(H)}return c},extract_shortest_path_from_predecessor_list:function(n,r){for(var o=[],c=r;c;)o.push(c),n[c],c=n[c];return o.reverse(),o},find_path:function(n,r,o){var c=t.single_source_shortest_paths(n,r,o);return t.extract_shortest_path_from_predecessor_list(c,o)},PriorityQueue:{make:function(n){var r=t.PriorityQueue,o={},c;n=n||{};for(c in r)r.hasOwnProperty(c)&&(o[c]=r[c]);return o.queue=[],o.sorter=n.sorter||r.default_sorter,o},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var o={value:n,cost:r};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(dijkstra)),dijkstra.exports}var hasRequiredSegments;function requireSegments(){return hasRequiredSegments||(hasRequiredSegments=1,(function(e){const t=requireMode(),n=requireNumericData(),r=requireAlphanumericData(),o=requireByteData(),c=requireKanjiData(),l=requireRegex(),x=requireUtils$1(),f=requireDijkstra();function m(H){return unescape(encodeURIComponent(H)).length}function E(H,Y,T){const L=[];let N;for(;(N=H.exec(T))!==null;)L.push({data:N[0],index:N.index,mode:Y,length:N[0].length});return L}function g(H){const Y=E(l.NUMERIC,t.NUMERIC,H),T=E(l.ALPHANUMERIC,t.ALPHANUMERIC,H);let L,N;return x.isKanjiModeEnabled()?(L=E(l.BYTE,t.BYTE,H),N=E(l.KANJI,t.KANJI,H)):(L=E(l.BYTE_KANJI,t.BYTE,H),N=[]),Y.concat(T,L,N).sort(function(U,W){return U.index-W.index}).map(function(U){return{data:U.data,mode:U.mode,length:U.length}})}function y(H,Y){switch(Y){case t.NUMERIC:return n.getBitsLength(H);case t.ALPHANUMERIC:return r.getBitsLength(H);case t.KANJI:return c.getBitsLength(H);case t.BYTE:return o.getBitsLength(H)}}function w(H){return H.reduce(function(Y,T){const L=Y.length-1>=0?Y[Y.length-1]:null;return L&&L.mode===T.mode?(Y[Y.length-1].data+=T.data,Y):(Y.push(T),Y)},[])}function v(H){const Y=[];for(let T=0;T<H.length;T++){const L=H[T];switch(L.mode){case t.NUMERIC:Y.push([L,{data:L.data,mode:t.ALPHANUMERIC,length:L.length},{data:L.data,mode:t.BYTE,length:L.length}]);break;case t.ALPHANUMERIC:Y.push([L,{data:L.data,mode:t.BYTE,length:L.length}]);break;case t.KANJI:Y.push([L,{data:L.data,mode:t.BYTE,length:m(L.data)}]);break;case t.BYTE:Y.push([{data:L.data,mode:t.BYTE,length:m(L.data)}])}}return Y}function _(H,Y){const T={},L={start:{}};let N=["start"];for(let I=0;I<H.length;I++){const U=H[I],W=[];for(let O=0;O<U.length;O++){const Z=U[O],z=""+I+O;W.push(z),T[z]={node:Z,lastCount:0},L[z]={};for(let q=0;q<N.length;q++){const $=N[q];T[$]&&T[$].node.mode===Z.mode?(L[$][z]=y(T[$].lastCount+Z.length,Z.mode)-y(T[$].lastCount,Z.mode),T[$].lastCount+=Z.length):(T[$]&&(T[$].lastCount=Z.length),L[$][z]=y(Z.length,Z.mode)+4+t.getCharCountIndicator(Z.mode,Y))}}N=W}for(let I=0;I<N.length;I++)L[N[I]].end=0;return{map:L,table:T}}function F(H,Y){let T;const L=t.getBestModeForData(H);if(T=t.from(Y,L),T!==t.BYTE&&T.bit<L.bit)throw new Error('"'+H+'" cannot be encoded with mode '+t.toString(T)+`.
 Suggested mode is: `+t.toString(L));switch(T===t.KANJI&&!x.isKanjiModeEnabled()&&(T=t.BYTE),T){case t.NUMERIC:return new n(H);case t.ALPHANUMERIC:return new r(H);case t.KANJI:return new c(H);case t.BYTE:return new o(H)}}e.fromArray=function(Y){return Y.reduce(function(T,L){return typeof L=="string"?T.push(F(L,null)):L.data&&T.push(F(L.data,L.mode)),T},[])},e.fromString=function(Y,T){const L=g(Y,x.isKanjiModeEnabled()),N=v(L),I=_(N,T),U=f.find_path(I.map,"start","end"),W=[];for(let O=1;O<U.length-1;O++)W.push(I.table[U[O]].node);return e.fromArray(w(W))},e.rawSplit=function(Y){return e.fromArray(g(Y,x.isKanjiModeEnabled()))}})(segments)),segments}var hasRequiredQrcode;function requireQrcode(){if(hasRequiredQrcode)return qrcode;hasRequiredQrcode=1;const e=requireUtils$1(),t=requireErrorCorrectionLevel(),n=requireBitBuffer(),r=requireBitMatrix(),o=requireAlignmentPattern(),c=requireFinderPattern(),l=requireMaskPattern(),x=requireErrorCorrectionCode(),f=requireReedSolomonEncoder(),m=requireVersion(),E=requireFormatInfo(),g=requireMode(),y=requireSegments();function w(I,U){const W=I.size,O=c.getPositions(U);for(let Z=0;Z<O.length;Z++){const z=O[Z][0],q=O[Z][1];for(let $=-1;$<=7;$++)if(!(z+$<=-1||W<=z+$))for(let M=-1;M<=7;M++)q+M<=-1||W<=q+M||($>=0&&$<=6&&(M===0||M===6)||M>=0&&M<=6&&($===0||$===6)||$>=2&&$<=4&&M>=2&&M<=4?I.set(z+$,q+M,!0,!0):I.set(z+$,q+M,!1,!0))}}function v(I){const U=I.size;for(let W=8;W<U-8;W++){const O=W%2===0;I.set(W,6,O,!0),I.set(6,W,O,!0)}}function _(I,U){const W=o.getPositions(U);for(let O=0;O<W.length;O++){const Z=W[O][0],z=W[O][1];for(let q=-2;q<=2;q++)for(let $=-2;$<=2;$++)q===-2||q===2||$===-2||$===2||q===0&&$===0?I.set(Z+q,z+$,!0,!0):I.set(Z+q,z+$,!1,!0)}}function F(I,U){const W=I.size,O=m.getEncodedBits(U);let Z,z,q;for(let $=0;$<18;$++)Z=Math.floor($/3),z=$%3+W-8-3,q=(O>>$&1)===1,I.set(Z,z,q,!0),I.set(z,Z,q,!0)}function H(I,U,W){const O=I.size,Z=E.getEncodedBits(U,W);let z,q;for(z=0;z<15;z++)q=(Z>>z&1)===1,z<6?I.set(z,8,q,!0):z<8?I.set(z+1,8,q,!0):I.set(O-15+z,8,q,!0),z<8?I.set(8,O-z-1,q,!0):z<9?I.set(8,15-z-1+1,q,!0):I.set(8,15-z-1,q,!0);I.set(O-8,8,1,!0)}function Y(I,U){const W=I.size;let O=-1,Z=W-1,z=7,q=0;for(let $=W-1;$>0;$-=2)for($===6&&$--;;){for(let M=0;M<2;M++)if(!I.isReserved(Z,$-M)){let S=!1;q<U.length&&(S=(U[q]>>>z&1)===1),I.set(Z,$-M,S),z--,z===-1&&(q++,z=7)}if(Z+=O,Z<0||W<=Z){Z-=O,O=-O;break}}}function T(I,U,W){const O=new n;W.forEach(function(M){O.put(M.mode.bit,4),O.put(M.getLength(),g.getCharCountIndicator(M.mode,I)),M.write(O)});const Z=e.getSymbolTotalCodewords(I),z=x.getTotalCodewordsCount(I,U),q=(Z-z)*8;for(O.getLengthInBits()+4<=q&&O.put(0,4);O.getLengthInBits()%8!==0;)O.putBit(0);const $=(q-O.getLengthInBits())/8;for(let M=0;M<$;M++)O.put(M%2?17:236,8);return L(O,I,U)}function L(I,U,W){const O=e.getSymbolTotalCodewords(U),Z=x.getTotalCodewordsCount(U,W),z=O-Z,q=x.getBlocksCount(U,W),$=O%q,M=q-$,S=Math.floor(O/q),R=Math.floor(z/q),D=R+1,j=S-R,P=new f(j);let Q=0;const C=new Array(q),K=new Array(q);let J=0;const ne=new Uint8Array(I.buffer);for(let ae=0;ae<q;ae++){const we=ae<M?R:D;C[ae]=ne.slice(Q,Q+we),K[ae]=P.encode(C[ae]),Q+=we,J=Math.max(J,we)}const re=new Uint8Array(O);let ie=0,ce,ue;for(ce=0;ce<J;ce++)for(ue=0;ue<q;ue++)ce<C[ue].length&&(re[ie++]=C[ue][ce]);for(ce=0;ce<j;ce++)for(ue=0;ue<q;ue++)re[ie++]=K[ue][ce];return re}function N(I,U,W,O){let Z;if(Array.isArray(I))Z=y.fromArray(I);else if(typeof I=="string"){let S=U;if(!S){const R=y.rawSplit(I);S=m.getBestVersionForData(R,W)}Z=y.fromString(I,S||40)}else throw new Error("Invalid data");const z=m.getBestVersionForData(Z,W);if(!z)throw new Error("The amount of data is too big to be stored in a QR Code");if(!U)U=z;else if(U<z)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+z+`.
`);const q=T(U,W,Z),$=e.getSymbolSize(U),M=new r($);return w(M,U),v(M),_(M,U),H(M,W,0),U>=7&&F(M,U),Y(M,q),isNaN(O)&&(O=l.getBestMask(M,H.bind(null,M,W))),l.applyMask(O,M),H(M,W,O),{modules:M,version:U,errorCorrectionLevel:W,maskPattern:O,segments:Z}}return qrcode.create=function(U,W){if(typeof U>"u"||U==="")throw new Error("No input text");let O=t.M,Z,z;return typeof W<"u"&&(O=t.from(W.errorCorrectionLevel,t.M),Z=m.from(W.version),z=l.from(W.maskPattern),W.toSJISFunc&&e.setToSJISFunction(W.toSJISFunc)),N(U,Z,O,z)},qrcode}var canvas={},utils={},hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(c){return[c,c]}))),r.length===6&&r.push("F","F");const o=parseInt(r.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+r.slice(0,6).join("")}}e.getOptions=function(r){r||(r={}),r.color||(r.color={});const o=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,c=r.width&&r.width>=21?r.width:void 0,l=r.scale||4;return{width:c,scale:c?4:l,margin:o,color:{dark:t(r.color.dark||"#000000ff"),light:t(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},e.getScale=function(r,o){return o.width&&o.width>=r+o.margin*2?o.width/(r+o.margin*2):o.scale},e.getImageWidth=function(r,o){const c=e.getScale(r,o);return Math.floor((r+o.margin*2)*c)},e.qrToImageData=function(r,o,c){const l=o.modules.size,x=o.modules.data,f=e.getScale(l,c),m=Math.floor((l+c.margin*2)*f),E=c.margin*f,g=[c.color.light,c.color.dark];for(let y=0;y<m;y++)for(let w=0;w<m;w++){let v=(y*m+w)*4,_=c.color.light;if(y>=E&&w>=E&&y<m-E&&w<m-E){const F=Math.floor((y-E)/f),H=Math.floor((w-E)/f);_=g[x[F*l+H]?1:0]}r[v++]=_.r,r[v++]=_.g,r[v++]=_.b,r[v]=_.a}}})(utils)),utils}var hasRequiredCanvas;function requireCanvas(){return hasRequiredCanvas||(hasRequiredCanvas=1,(function(e){const t=requireUtils();function n(o,c,l){o.clearRect(0,0,c.width,c.height),c.style||(c.style={}),c.height=l,c.width=l,c.style.height=l+"px",c.style.width=l+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(c,l,x){let f=x,m=l;typeof f>"u"&&(!l||!l.getContext)&&(f=l,l=void 0),l||(m=r()),f=t.getOptions(f);const E=t.getImageWidth(c.modules.size,f),g=m.getContext("2d"),y=g.createImageData(E,E);return t.qrToImageData(y.data,c,f),n(g,m,E),g.putImageData(y,0,0),m},e.renderToDataURL=function(c,l,x){let f=x;typeof f>"u"&&(!l||!l.getContext)&&(f=l,l=void 0),f||(f={});const m=e.render(c,l,f),E=f.type||"image/png",g=f.rendererOpts||{};return m.toDataURL(E,g.quality)}})(canvas)),canvas}var svgTag={},hasRequiredSvgTag;function requireSvgTag(){if(hasRequiredSvgTag)return svgTag;hasRequiredSvgTag=1;const e=requireUtils();function t(o,c){const l=o.a/255,x=c+'="'+o.hex+'"';return l<1?x+" "+c+'-opacity="'+l.toFixed(2).slice(1)+'"':x}function n(o,c,l){let x=o+c;return typeof l<"u"&&(x+=" "+l),x}function r(o,c,l){let x="",f=0,m=!1,E=0;for(let g=0;g<o.length;g++){const y=Math.floor(g%c),w=Math.floor(g/c);!y&&!m&&(m=!0),o[g]?(E++,g>0&&y>0&&o[g-1]||(x+=m?n("M",y+l,.5+w+l):n("m",f,0),f=0,m=!1),y+1<c&&o[g+1]||(x+=n("h",E),E=0)):f++}return x}return svgTag.render=function(c,l,x){const f=e.getOptions(l),m=c.modules.size,E=c.modules.data,g=m+f.margin*2,y=f.color.light.a?"<path "+t(f.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",w="<path "+t(f.color.dark,"stroke")+' d="'+r(E,m,f.margin)+'"/>',v='viewBox="0 0 '+g+" "+g+'"',F='<svg xmlns="http://www.w3.org/2000/svg" '+(f.width?'width="'+f.width+'" height="'+f.width+'" ':"")+v+' shape-rendering="crispEdges">'+y+w+`</svg>
`;return typeof x=="function"&&x(null,F),F},svgTag}var hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser;hasRequiredBrowser=1;const e=requireCanPromise(),t=requireQrcode(),n=requireCanvas(),r=requireSvgTag();function o(c,l,x,f,m){const E=[].slice.call(arguments,1),g=E.length,y=typeof E[g-1]=="function";if(!y&&!e())throw new Error("Callback required as last argument");if(y){if(g<2)throw new Error("Too few arguments provided");g===2?(m=x,x=l,l=f=void 0):g===3&&(l.getContext&&typeof m>"u"?(m=f,f=void 0):(m=f,f=x,x=l,l=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(x=l,l=f=void 0):g===2&&!l.getContext&&(f=x,x=l,l=void 0),new Promise(function(w,v){try{const _=t.create(x,f);w(c(_,l,f))}catch(_){v(_)}})}try{const w=t.create(x,f);m(null,c(w,l,f))}catch(w){m(w)}}return browser.create=t.create,browser.toCanvas=o.bind(null,n.render),browser.toDataURL=o.bind(null,n.renderToDataURL),browser.toString=o.bind(null,function(c,l,x){return r.render(c,x)}),browser}var browserExports=requireBrowser();const QRCode=getDefaultExportFromCjs(browserExports),ReceiveModal=({isOpen:e,onClose:t,address:n})=>{const[r,o]=reactExports.useState(""),[c,l]=reactExports.useState(!1);if(reactExports.useEffect(()=>{e&&n&&QRCode.toDataURL(n,{width:300,margin:2,color:{dark:"#000000",light:"#ffffff"}}).then(f=>o(f)).catch(f=>console.error("Error generating QR code:",f))},[e,n]),!e)return null;const x=()=>{navigator.clipboard.writeText(n),l(!0),setTimeout(()=>l(!1),2e3)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-sm overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Receive Bitcoin"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 flex flex-col items-center",children:[r&&jsxRuntimeExports.jsx("div",{className:"bg-white p-4 rounded-xl mb-6",children:jsxRuntimeExports.jsx("img",{src:r,alt:"Bitcoin Address QR Code",className:"w-48 h-48"})}),jsxRuntimeExports.jsx("div",{className:"w-full bg-slate-950 p-4 rounded-xl border border-slate-800 flex items-center justify-between gap-3 mb-2",children:jsxRuntimeExports.jsx("p",{className:"font-mono text-sm text-slate-300 break-all text-center",children:n})}),jsxRuntimeExports.jsxs("button",{onClick:x,className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors text-sm",children:[c?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),c?"Copied!":"Copy Address"]})]})]})})},SatoshiIcon=({className:e=""})=>jsxRuntimeExports.jsx("i",{className:`fak fa-satoshisymbol-solid ${e}`}),SendModal=({isOpen:e,onClose:t,utxos:n,onSuccess:r,initialRecipient:o=""})=>{const{decryptedKey:c}=useAuthStore(),[l,x]=reactExports.useState("details"),[f,m]=reactExports.useState(o),[E,g]=reactExports.useState(""),[y,w]=reactExports.useState(""),[v,_]=reactExports.useState("sats"),[F,H]=reactExports.useState(1),[Y,T]=reactExports.useState(null),[L,N]=reactExports.useState(null),[I,U]=reactExports.useState(""),[W,O]=reactExports.useState(0),{currentKeypairId:Z,wallets:z,currentWalletId:q}=useWalletStore(),M=z.find(re=>re.id===q)?.keypairs.find(re=>re.id===Z),[S,R]=reactExports.useState([]),[D,j]=reactExports.useState(!1),[P,Q]=reactExports.useState(!1),[C,K]=reactExports.useState(null);reactExports.useEffect(()=>{e&&M&&(console.log("[SendModal] Fetching contacts for keypair:",M.npub),j(!0),K(null),ProfileService.fetchContacts(M.npub).then(re=>{console.log("[SendModal] Received contacts:",re.length),R(re)}).catch(re=>{console.error("[SendModal] Error fetching contacts:",re),K("Failed to fetch user follows")}).finally(()=>j(!1)))},[e,M]),reactExports.useEffect(()=>{e&&(getFeeRates().then(T).catch(console.error),x("details"),m(o),g(""),w(""),N(null))},[e]),reactExports.useEffect(()=>{const re=f.trim();if(re.startsWith("npub"))try{const ie=npubToBitcoinAddress(re);g(ie)}catch{g("")}else re.startsWith("bc1")||re.startsWith("1")||re.startsWith("3")?g(re):g("")},[f]);const J=async()=>{if(N(null),!E){N("Invalid Bitcoin address or npub");return}const re=v==="btc"?btcToSats(parseFloat(y)):parseInt(y);if(isNaN(re)||re<=0){N("Invalid amount");return}if(!c){N("Wallet locked");return}try{const{txHex:ie,fee:ce}=await createBitcoinTransaction(c,E,re,n,F);U(ie),O(ce),x("confirm")}catch(ie){console.error(ie),N(ie.message||"Failed to create transaction")}},ne=async()=>{x("broadcasting");try{await broadcastTransaction(I),x("success"),setTimeout(()=>{r(),t()},2e3)}catch(re){console.error(re),N(re.message||"Failed to broadcast transaction"),x("confirm")}};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Send Bitcoin"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[l==="details"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Recipient"}),jsxRuntimeExports.jsx("input",{type:"text",value:f,onChange:re=>m(re.target.value),placeholder:"Bitcoin address or npub...",className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm"}),f.startsWith("npub")&&E&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-green-500 mt-1 break-all",children:["Resolved: ",E]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[M&&jsxRuntimeExports.jsxs("button",{onClick:()=>m(M.npub),className:"px-3 py-2 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 text-xs font-medium rounded-lg transition-colors flex items-center gap-2",children:[jsxRuntimeExports.jsx(ArrowRight,{className:"w-3.5 h-3.5"}),"Send to Myself"]}),M&&jsxRuntimeExports.jsxs("button",{onClick:()=>Q(!P),className:`px-3 py-2 text-xs font-medium rounded-lg transition-colors flex items-center gap-2 ${P?"bg-amber-500/20 text-amber-400":"bg-amber-500/10 hover:bg-amber-500/20 text-amber-500"}`,children:[jsxRuntimeExports.jsx(User,{className:"w-3.5 h-3.5"}),P?"Hide Follows":"Select from Follows"]})]}),P&&jsxRuntimeExports.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto bg-slate-950 border border-slate-800 rounded-xl p-2 space-y-2 custom-scrollbar",children:D?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-slate-400 gap-2",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-5 h-5 animate-spin text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:"Currently fetching user follows..."})]}):C?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-red-400 gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:C})]}):S.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-slate-400 gap-2",children:[jsxRuntimeExports.jsx(User,{className:"w-5 h-5 opacity-50"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:"User not following anyone"})]}):S.map(re=>{let ie="";try{ie=re.npub?npubToBitcoinAddress(re.npub):""}catch{return null}if(!ie)return null;const ce=re.npub===f;return jsxRuntimeExports.jsxs("div",{onClick:()=>{m(re.npub)},className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors group border ${ce?"bg-amber-500/10 border-amber-500/30":"hover:bg-slate-900 border-transparent"}`,children:[re.picture?jsxRuntimeExports.jsx("img",{src:re.picture,alt:re.name,className:"w-8 h-8 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-slate-500"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"font-bold text-sm text-white truncate",children:re.name||"Unknown"}),re.nip05&&jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 truncate",children:re.nip05})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[jsxRuntimeExports.jsxs("span",{className:"font-mono truncate",children:[re.npub.slice(0,8),"...",re.npub.slice(-8)]}),jsxRuntimeExports.jsx("button",{onClick:ue=>{ue.stopPropagation(),navigator.clipboard.writeText(re.npub)},className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",title:"Copy npub",children:jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[jsxRuntimeExports.jsx("span",{className:"font-mono truncate text-amber-500/70",children:ie.length>16?`${ie.slice(0,8)}...${ie.slice(-8)}`:ie}),jsxRuntimeExports.jsx("button",{onClick:ue=>{ue.stopPropagation(),navigator.clipboard.writeText(ie)},className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",title:"Copy Bitcoin Address",children:jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]})]})]},re.npub)})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-1",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"Amount"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-slate-500",children:["Available: ",n.reduce((re,ie)=>re+ie.value,0).toLocaleString()," sats"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 border border-slate-800 rounded-xl p-3 focus-within:ring-2 focus-within:ring-amber-500 focus-within:border-transparent transition-all",children:[v==="sats"?jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-xl text-amber-500 flex-shrink-0"}):jsxRuntimeExports.jsx("span",{className:"text-xl text-amber-500 flex-shrink-0",children:""}),jsxRuntimeExports.jsx("input",{type:"number",value:y,onChange:re=>w(re.target.value),placeholder:"0.00",className:"flex-1 bg-transparent text-white outline-none font-mono text-lg min-w-0"}),jsxRuntimeExports.jsx("button",{onClick:()=>{const re=n.reduce((ie,ce)=>ie+ce.value,0);w(v==="sats"?re.toString():satsToBTC(re).toString())},className:"px-2 py-1 bg-amber-500/10 hover:bg-amber-500/20 text-amber-500 text-xs font-bold rounded transition-colors",children:"MAX"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>_(v==="sats"?"btc":"sats"),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Toggle unit",children:jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("span",{className:"text-slate-400 font-medium text-sm flex-shrink-0",children:v==="sats"?"sats":"BTC"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Fee Rate (sat/vB)"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>Y&&H(Y.hourFee),className:`p-2 rounded-lg border text-xs transition-all ${F===Y?.hourFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Slow"}),jsxRuntimeExports.jsxs("div",{children:[Y?.hourFee||"-"," sat/vB"]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Y&&H(Y.halfHourFee),className:`p-2 rounded-lg border text-xs transition-all ${F===Y?.halfHourFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Normal"}),jsxRuntimeExports.jsxs("div",{children:[Y?.halfHourFee||"-"," sat/vB"]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Y&&H(Y.fastestFee),className:`p-2 rounded-lg border text-xs transition-all ${F===Y?.fastestFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Fast"}),jsxRuntimeExports.jsxs("div",{children:[Y?.fastestFee||"-"," sat/vB"]})]})]}),jsxRuntimeExports.jsx("input",{type:"number",value:F,onChange:re=>H(parseInt(re.target.value)||1),className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm"})]}),L&&jsxRuntimeExports.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),L]}),jsxRuntimeExports.jsxs("button",{onClick:J,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:["Review Transaction",jsxRuntimeExports.jsx(ArrowRight,{className:"w-4 h-4"})]})]}),l==="confirm"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:"Amount"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("span",{className:"text-lg text-amber-500",children:""}),jsxRuntimeExports.jsxs("span",{className:"font-mono font-bold text-white",children:[v==="btc"?y:satsToBTC(parseInt(y))," BTC"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:"Fee"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"w-3.5 h-3.5 text-slate-400"}),jsxRuntimeExports.jsxs("span",{className:"font-mono text-slate-300",children:[W," sats"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-slate-800 pt-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400 block mb-1",children:"To"}),jsxRuntimeExports.jsx("span",{className:"font-mono text-xs text-slate-300 break-all",children:E})]})]}),L&&jsxRuntimeExports.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),L]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>x("details"),className:"flex-1 py-3 px-4 bg-slate-800 hover:bg-slate-700 text-slate-300 font-medium rounded-xl transition-colors",children:"Back"}),jsxRuntimeExports.jsx("button",{onClick:ne,className:"flex-1 py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors",children:"Confirm Send"})]})]}),l==="broadcasting"&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-12 h-12 text-amber-500 animate-spin mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-slate-300 font-medium",children:"Broadcasting transaction..."})]}),l==="success"&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(Check,{className:"w-8 h-8 text-green-500"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Sent!"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-center",children:"Your transaction has been broadcast successfully."})]})]})]})}):null},TransactionDetailsModal=({isOpen:e,onClose:t,txid:n})=>{const[r,o]=reactExports.useState(!1);if(!e)return null;const c=()=>{navigator.clipboard.writeText(n),o(!0),setTimeout(()=>o(!1),2e3)},l=[{name:"Mempool.space",url:`https://mempool.space/tx/${n}`},{name:"Blockstream",url:`https://blockstream.info/tx/${n}`},{name:"Blockchain.com",url:`https://www.blockchain.com/explorer/transactions/btc/${n}`}];return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-800 w-full max-w-md overflow-hidden shadow-xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-800 flex items-center justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg text-white",children:"Transaction Details"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Transaction ID"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 rounded-lg p-3 border border-slate-800",children:[jsxRuntimeExports.jsx("code",{className:"text-sm text-slate-300 break-all font-mono flex-1",children:n}),jsxRuntimeExports.jsx("button",{onClick:c,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Copy TXID",children:r?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"View on Explorer"}),jsxRuntimeExports.jsx("div",{className:"grid gap-2",children:l.map(x=>jsxRuntimeExports.jsxs("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 bg-slate-800 hover:bg-slate-700 rounded-xl transition-colors group",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-slate-200",children:x.name}),jsxRuntimeExports.jsx(ExternalLink,{className:"w-4 h-4 text-slate-500 group-hover:text-white transition-colors"})]},x.name))})]})]})]})})},BitcoinWallet=()=>{const{currentKeypairId:e,wallets:t,currentWalletId:n}=useWalletStore(),[r,o]=reactExports.useState(""),[c,l]=reactExports.useState(0),[x,f]=reactExports.useState([]),[m,E]=reactExports.useState([]),[g,y]=reactExports.useState(!1),[w,v]=reactExports.useState(!1),[_,F]=reactExports.useState(!1),[H,Y]=reactExports.useState(!1),[T,L]=reactExports.useState(null),I=t.find(O=>O.id===n)?.keypairs.find(O=>O.id===e),U=async()=>{if(r){y(!0);try{const[O,Z]=await Promise.all([fetchUTXOs(r),fetchTxHistory(r)]);f(O),E(Z);const z=O.reduce((q,$)=>q+$.value,0);l(z),z>=1e6&&Y(!0)}catch(O){console.error("Error fetching Bitcoin data:",O)}finally{y(!1)}}};reactExports.useEffect(()=>{if(I)try{const O=npubToBitcoinAddress(I.npub);o(O)}catch(O){console.error("Error deriving Bitcoin address:",O)}},[I]),reactExports.useEffect(()=>{U()},[r]);const W=O=>{let Z=0;return O.vin.forEach(z=>{z.prevout&&z.prevout.scriptpubkey_address===r&&(Z-=z.prevout.value)}),O.vout.forEach(z=>{z.scriptpubkey_address===r&&(Z+=z.value)}),{netChange:Z,isReceive:Z>0,absAmount:Math.abs(Z)}};return I?jsxRuntimeExports.jsxs("div",{className:"pb-24",children:[jsxRuntimeExports.jsx("div",{className:"pb-4",children:jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-br from-amber-500/20 to-orange-600/20 border border-amber-500/20 rounded-2xl p-6 relative overflow-hidden",children:jsxRuntimeExports.jsxs("div",{className:"relative z-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("h2",{className:"text-slate-400 text-sm font-medium",children:"Total Balance"}),jsxRuntimeExports.jsx("button",{onClick:()=>Y(!H),className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors",title:"Toggle display format",children:jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4 text-slate-400"})})]}),H?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-3xl text-amber-500",children:""}),jsxRuntimeExports.jsx("span",{className:"text-4xl font-bold text-white",children:satsToBTC(c)}),jsxRuntimeExports.jsx("span",{className:"text-amber-500 font-bold",children:"BTC"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-sm mt-1",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"w-3.5 h-3.5"}),jsxRuntimeExports.jsxs("span",{children:[c.toLocaleString()," sats"]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-2",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-3xl text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-4xl font-bold text-white",children:c.toLocaleString()}),jsxRuntimeExports.jsx("span",{className:"text-amber-500 font-bold",children:"sats"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-sm mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-base",children:""}),jsxRuntimeExports.jsxs("span",{children:[" ",satsToBTC(c)," BTC"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>v(!0),className:"flex-1 bg-slate-900/50 hover:bg-slate-900/70 text-white py-2 px-4 rounded-xl font-medium transition-colors flex items-center justify-center gap-2 border border-white/10",children:[jsxRuntimeExports.jsx(ArrowDownLeft,{className:"w-4 h-4 text-green-400"}),"Receive"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>F(!0),className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 py-2 px-4 rounded-xl font-bold transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4"}),"Send"]})]})]})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"History"}),jsxRuntimeExports.jsx("button",{onClick:U,disabled:g,className:`p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors ${g?"animate-spin":""}`,children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:m.length===0?jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-slate-500",children:"No transactions found"}):m.map(O=>{const{isReceive:Z,absAmount:z}=W(O);return jsxRuntimeExports.jsx("button",{onClick:()=>L(O.txid),className:"w-full text-left bg-slate-900 border border-slate-800 rounded-xl p-4 hover:border-slate-700 transition-colors",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-full ${Z?"bg-green-500/10 text-green-500":"bg-amber-500/10 text-amber-500"}`,children:Z?jsxRuntimeExports.jsx(ArrowDownLeft,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-white",children:Z?"Received":"Sent"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400",children:new Date((O.status.block_time||Date.now()/1e3)*1e3).toLocaleDateString()})]})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsxs("div",{className:`font-bold ${Z?"text-green-500":"text-white"}`,children:[Z?"+":"-",z.toLocaleString()," sats"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-end gap-1 text-xs text-slate-500",children:[jsxRuntimeExports.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${O.status.confirmed?"bg-green-500":"bg-amber-500"}`}),jsxRuntimeExports.jsx("span",{children:O.status.confirmed?"Confirmed":"Pending"})]})]})]})},O.txid)})})]}),jsxRuntimeExports.jsx(ReceiveModal,{isOpen:w,onClose:()=>v(!1),address:r}),jsxRuntimeExports.jsx(SendModal,{isOpen:_,onClose:()=>F(!1),utxos:x,onSuccess:U}),jsxRuntimeExports.jsx(TransactionDetailsModal,{isOpen:!!T,onClose:()=>L(null),txid:T||""})]}):jsxRuntimeExports.jsx("div",{className:"p-4 text-center text-slate-400",children:"No active keypair"})};var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))__hasOwnProp.call(t,n)&&__defNormalProp(e,n,t[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(t))__propIsEnum.call(t,n)&&__defNormalProp(e,n,t[n]);return e},__objRest=(e,t)=>{var n={};for(var r in e)__hasOwnProp.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&__getOwnPropSymbols)for(var r of __getOwnPropSymbols(e))t.indexOf(r)<0&&__propIsEnum.call(e,r)&&(n[r]=e[r]);return n};var qrcodegen;(e=>{const t=class Xe{constructor(f,m,E,g){if(this.version=f,this.errorCorrectionLevel=m,this.modules=[],this.isFunction=[],f<Xe.MIN_VERSION||f>Xe.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let y=[];for(let v=0;v<this.size;v++)y.push(!1);for(let v=0;v<this.size;v++)this.modules.push(y.slice()),this.isFunction.push(y.slice());this.drawFunctionPatterns();const w=this.addEccAndInterleave(E);if(this.drawCodewords(w),g==-1){let v=1e9;for(let _=0;_<8;_++){this.applyMask(_),this.drawFormatBits(_);const F=this.getPenaltyScore();F<v&&(g=_,v=F),this.applyMask(_)}}o(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,m){const E=e.QrSegment.makeSegments(f);return Xe.encodeSegments(E,m)}static encodeBinary(f,m){const E=e.QrSegment.makeBytes(f);return Xe.encodeSegments([E],m)}static encodeSegments(f,m,E=1,g=40,y=-1,w=!0){if(!(Xe.MIN_VERSION<=E&&E<=g&&g<=Xe.MAX_VERSION)||y<-1||y>7)throw new RangeError("Invalid value");let v,_;for(v=E;;v++){const T=Xe.getNumDataCodewords(v,m)*8,L=l.getTotalBits(f,v);if(L<=T){_=L;break}if(v>=g)throw new RangeError("Data too long")}for(const T of[Xe.Ecc.MEDIUM,Xe.Ecc.QUARTILE,Xe.Ecc.HIGH])w&&_<=Xe.getNumDataCodewords(v,T)*8&&(m=T);let F=[];for(const T of f){n(T.mode.modeBits,4,F),n(T.numChars,T.mode.numCharCountBits(v),F);for(const L of T.getData())F.push(L)}o(F.length==_);const H=Xe.getNumDataCodewords(v,m)*8;o(F.length<=H),n(0,Math.min(4,H-F.length),F),n(0,(8-F.length%8)%8,F),o(F.length%8==0);for(let T=236;F.length<H;T^=253)n(T,8,F);let Y=[];for(;Y.length*8<F.length;)Y.push(0);return F.forEach((T,L)=>Y[L>>>3]|=T<<7-(L&7)),new Xe(v,m,Y,y)}getModule(f,m){return 0<=f&&f<this.size&&0<=m&&m<this.size&&this.modules[m][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let E=0;E<this.size;E++)this.setFunctionModule(6,E,E%2==0),this.setFunctionModule(E,6,E%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),m=f.length;for(let E=0;E<m;E++)for(let g=0;g<m;g++)E==0&&g==0||E==0&&g==m-1||E==m-1&&g==0||this.drawAlignmentPattern(f[E],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const m=this.errorCorrectionLevel.formatBits<<3|f;let E=m;for(let y=0;y<10;y++)E=E<<1^(E>>>9)*1335;const g=(m<<10|E)^21522;o(g>>>15==0);for(let y=0;y<=5;y++)this.setFunctionModule(8,y,r(g,y));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let y=9;y<15;y++)this.setFunctionModule(14-y,8,r(g,y));for(let y=0;y<8;y++)this.setFunctionModule(this.size-1-y,8,r(g,y));for(let y=8;y<15;y++)this.setFunctionModule(8,this.size-15+y,r(g,y));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let E=0;E<12;E++)f=f<<1^(f>>>11)*7973;const m=this.version<<12|f;o(m>>>18==0);for(let E=0;E<18;E++){const g=r(m,E),y=this.size-11+E%3,w=Math.floor(E/3);this.setFunctionModule(y,w,g),this.setFunctionModule(w,y,g)}}drawFinderPattern(f,m){for(let E=-4;E<=4;E++)for(let g=-4;g<=4;g++){const y=Math.max(Math.abs(g),Math.abs(E)),w=f+g,v=m+E;0<=w&&w<this.size&&0<=v&&v<this.size&&this.setFunctionModule(w,v,y!=2&&y!=4)}}drawAlignmentPattern(f,m){for(let E=-2;E<=2;E++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,m+E,Math.max(Math.abs(g),Math.abs(E))!=1)}setFunctionModule(f,m,E){this.modules[m][f]=E,this.isFunction[m][f]=!0}addEccAndInterleave(f){const m=this.version,E=this.errorCorrectionLevel;if(f.length!=Xe.getNumDataCodewords(m,E))throw new RangeError("Invalid argument");const g=Xe.NUM_ERROR_CORRECTION_BLOCKS[E.ordinal][m],y=Xe.ECC_CODEWORDS_PER_BLOCK[E.ordinal][m],w=Math.floor(Xe.getNumRawDataModules(m)/8),v=g-w%g,_=Math.floor(w/g);let F=[];const H=Xe.reedSolomonComputeDivisor(y);for(let T=0,L=0;T<g;T++){let N=f.slice(L,L+_-y+(T<v?0:1));L+=N.length;const I=Xe.reedSolomonComputeRemainder(N,H);T<v&&N.push(0),F.push(N.concat(I))}let Y=[];for(let T=0;T<F[0].length;T++)F.forEach((L,N)=>{(T!=_-y||N>=v)&&Y.push(L[T])});return o(Y.length==w),Y}drawCodewords(f){if(f.length!=Math.floor(Xe.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let m=0;for(let E=this.size-1;E>=1;E-=2){E==6&&(E=5);for(let g=0;g<this.size;g++)for(let y=0;y<2;y++){const w=E-y,_=(E+1&2)==0?this.size-1-g:g;!this.isFunction[_][w]&&m<f.length*8&&(this.modules[_][w]=r(f[m>>>3],7-(m&7)),m++)}}o(m==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let m=0;m<this.size;m++)for(let E=0;E<this.size;E++){let g;switch(f){case 0:g=(E+m)%2==0;break;case 1:g=m%2==0;break;case 2:g=E%3==0;break;case 3:g=(E+m)%3==0;break;case 4:g=(Math.floor(E/3)+Math.floor(m/2))%2==0;break;case 5:g=E*m%2+E*m%3==0;break;case 6:g=(E*m%2+E*m%3)%2==0;break;case 7:g=((E+m)%2+E*m%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[m][E]&&g&&(this.modules[m][E]=!this.modules[m][E])}}getPenaltyScore(){let f=0;for(let y=0;y<this.size;y++){let w=!1,v=0,_=[0,0,0,0,0,0,0];for(let F=0;F<this.size;F++)this.modules[y][F]==w?(v++,v==5?f+=Xe.PENALTY_N1:v>5&&f++):(this.finderPenaltyAddHistory(v,_),w||(f+=this.finderPenaltyCountPatterns(_)*Xe.PENALTY_N3),w=this.modules[y][F],v=1);f+=this.finderPenaltyTerminateAndCount(w,v,_)*Xe.PENALTY_N3}for(let y=0;y<this.size;y++){let w=!1,v=0,_=[0,0,0,0,0,0,0];for(let F=0;F<this.size;F++)this.modules[F][y]==w?(v++,v==5?f+=Xe.PENALTY_N1:v>5&&f++):(this.finderPenaltyAddHistory(v,_),w||(f+=this.finderPenaltyCountPatterns(_)*Xe.PENALTY_N3),w=this.modules[F][y],v=1);f+=this.finderPenaltyTerminateAndCount(w,v,_)*Xe.PENALTY_N3}for(let y=0;y<this.size-1;y++)for(let w=0;w<this.size-1;w++){const v=this.modules[y][w];v==this.modules[y][w+1]&&v==this.modules[y+1][w]&&v==this.modules[y+1][w+1]&&(f+=Xe.PENALTY_N2)}let m=0;for(const y of this.modules)m=y.reduce((w,v)=>w+(v?1:0),m);const E=this.size*this.size,g=Math.ceil(Math.abs(m*20-E*10)/E)-1;return o(0<=g&&g<=9),f+=g*Xe.PENALTY_N4,o(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,m=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let E=[6];for(let g=this.size-7;E.length<f;g-=m)E.splice(1,0,g);return E}}static getNumRawDataModules(f){if(f<Xe.MIN_VERSION||f>Xe.MAX_VERSION)throw new RangeError("Version number out of range");let m=(16*f+128)*f+64;if(f>=2){const E=Math.floor(f/7)+2;m-=(25*E-10)*E-55,f>=7&&(m-=36)}return o(208<=m&&m<=29648),m}static getNumDataCodewords(f,m){return Math.floor(Xe.getNumRawDataModules(f)/8)-Xe.ECC_CODEWORDS_PER_BLOCK[m.ordinal][f]*Xe.NUM_ERROR_CORRECTION_BLOCKS[m.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let m=[];for(let g=0;g<f-1;g++)m.push(0);m.push(1);let E=1;for(let g=0;g<f;g++){for(let y=0;y<m.length;y++)m[y]=Xe.reedSolomonMultiply(m[y],E),y+1<m.length&&(m[y]^=m[y+1]);E=Xe.reedSolomonMultiply(E,2)}return m}static reedSolomonComputeRemainder(f,m){let E=m.map(g=>0);for(const g of f){const y=g^E.shift();E.push(0),m.forEach((w,v)=>E[v]^=Xe.reedSolomonMultiply(w,y))}return E}static reedSolomonMultiply(f,m){if(f>>>8||m>>>8)throw new RangeError("Byte out of range");let E=0;for(let g=7;g>=0;g--)E=E<<1^(E>>>7)*285,E^=(m>>>g&1)*f;return o(E>>>8==0),E}finderPenaltyCountPatterns(f){const m=f[1];o(m<=this.size*3);const E=m>0&&f[2]==m&&f[3]==m*3&&f[4]==m&&f[5]==m;return(E&&f[0]>=m*4&&f[6]>=m?1:0)+(E&&f[6]>=m*4&&f[0]>=m?1:0)}finderPenaltyTerminateAndCount(f,m,E){return f&&(this.finderPenaltyAddHistory(m,E),m=0),m+=this.size,this.finderPenaltyAddHistory(m,E),this.finderPenaltyCountPatterns(E)}finderPenaltyAddHistory(f,m){m[0]==0&&(f+=this.size),m.pop(),m.unshift(f)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;function n(x,f,m){if(f<0||f>31||x>>>f)throw new RangeError("Value out of range");for(let E=f-1;E>=0;E--)m.push(x>>>E&1)}function r(x,f){return(x>>>f&1)!=0}function o(x){if(!x)throw new Error("Assertion error")}const c=class bt{constructor(f,m,E){if(this.mode=f,this.numChars=m,this.bitData=E,m<0)throw new RangeError("Invalid argument");this.bitData=E.slice()}static makeBytes(f){let m=[];for(const E of f)n(E,8,m);return new bt(bt.Mode.BYTE,f.length,m)}static makeNumeric(f){if(!bt.isNumeric(f))throw new RangeError("String contains non-numeric characters");let m=[];for(let E=0;E<f.length;){const g=Math.min(f.length-E,3);n(parseInt(f.substring(E,E+g),10),g*3+1,m),E+=g}return new bt(bt.Mode.NUMERIC,f.length,m)}static makeAlphanumeric(f){if(!bt.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let m=[],E;for(E=0;E+2<=f.length;E+=2){let g=bt.ALPHANUMERIC_CHARSET.indexOf(f.charAt(E))*45;g+=bt.ALPHANUMERIC_CHARSET.indexOf(f.charAt(E+1)),n(g,11,m)}return E<f.length&&n(bt.ALPHANUMERIC_CHARSET.indexOf(f.charAt(E)),6,m),new bt(bt.Mode.ALPHANUMERIC,f.length,m)}static makeSegments(f){return f==""?[]:bt.isNumeric(f)?[bt.makeNumeric(f)]:bt.isAlphanumeric(f)?[bt.makeAlphanumeric(f)]:[bt.makeBytes(bt.toUtf8ByteArray(f))]}static makeEci(f){let m=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)n(f,8,m);else if(f<16384)n(2,2,m),n(f,14,m);else if(f<1e6)n(6,3,m),n(f,21,m);else throw new RangeError("ECI assignment value out of range");return new bt(bt.Mode.ECI,0,m)}static isNumeric(f){return bt.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return bt.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,m){let E=0;for(const g of f){const y=g.mode.numCharCountBits(m);if(g.numChars>=1<<y)return 1/0;E+=4+y+g.bitData.length}return E}static toUtf8ByteArray(f){f=encodeURI(f);let m=[];for(let E=0;E<f.length;E++)f.charAt(E)!="%"?m.push(f.charCodeAt(E)):(m.push(parseInt(f.substring(E+1,E+3),16)),E+=2);return m}};c.NUMERIC_REGEX=/^[0-9]*$/,c.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,c.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=c;e.QrSegment=c})(qrcodegen||(qrcodegen={}));(e=>{(t=>{const n=class{constructor(o,c){this.ordinal=o,this.formatBits=c}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),t.Ecc=n})(e.QrCode||(e.QrCode={}))})(qrcodegen||(qrcodegen={}));(e=>{(t=>{const n=class{constructor(o,c){this.modeBits=o,this.numBitsCharCount=c}numCharCountBits(o){return this.numBitsCharCount[Math.floor((o+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),t.Mode=n})(e.QrSegment||(e.QrSegment={}))})(qrcodegen||(qrcodegen={}));var qrcodegen_default=qrcodegen;var ERROR_LEVEL_MAP={L:qrcodegen_default.QrCode.Ecc.LOW,M:qrcodegen_default.QrCode.Ecc.MEDIUM,Q:qrcodegen_default.QrCode.Ecc.QUARTILE,H:qrcodegen_default.QrCode.Ecc.HIGH},DEFAULT_SIZE=128,DEFAULT_LEVEL="L",DEFAULT_BGCOLOR="#FFFFFF",DEFAULT_FGCOLOR="#000000",DEFAULT_INCLUDEMARGIN=!1,DEFAULT_MINVERSION=1,SPEC_MARGIN_SIZE=4,DEFAULT_MARGIN_SIZE=0,DEFAULT_IMG_SCALE=.1;function generatePath(e,t=0){const n=[];return e.forEach(function(r,o){let c=null;r.forEach(function(l,x){if(!l&&c!==null){n.push(`M${c+t} ${o+t}h${x-c}v1H${c+t}z`),c=null;return}if(x===r.length-1){if(!l)return;c===null?n.push(`M${x+t},${o+t} h1v1H${x+t}z`):n.push(`M${c+t},${o+t} h${x+1-c}v1H${c+t}z`);return}l&&c===null&&(c=x)})}),n.join("")}function excavateModules(e,t){return e.slice().map((n,r)=>r<t.y||r>=t.y+t.h?n:n.map((o,c)=>c<t.x||c>=t.x+t.w?o:!1))}function getImageSettings(e,t,n,r){if(r==null)return null;const o=e.length+n*2,c=Math.floor(t*DEFAULT_IMG_SCALE),l=o/t,x=(r.width||c)*l,f=(r.height||c)*l,m=r.x==null?e.length/2-x/2:r.x*l,E=r.y==null?e.length/2-f/2:r.y*l,g=r.opacity==null?1:r.opacity;let y=null;if(r.excavate){let v=Math.floor(m),_=Math.floor(E),F=Math.ceil(x+m-v),H=Math.ceil(f+E-_);y={x:v,y:_,w:F,h:H}}const w=r.crossOrigin;return{x:m,y:E,h:f,w:x,excavation:y,opacity:g,crossOrigin:w}}function getMarginSize(e,t){return t!=null?Math.max(Math.floor(t),0):e?SPEC_MARGIN_SIZE:DEFAULT_MARGIN_SIZE}function useQRCode({value:e,level:t,minVersion:n,includeMargin:r,marginSize:o,imageSettings:c,size:l,boostLevel:x}){let f=React.useMemo(()=>{const v=(Array.isArray(e)?e:[e]).reduce((_,F)=>(_.push(...qrcodegen_default.QrSegment.makeSegments(F)),_),[]);return qrcodegen_default.QrCode.encodeSegments(v,ERROR_LEVEL_MAP[t],n,void 0,void 0,x)},[e,t,n,x]);const{cells:m,margin:E,numCells:g,calculatedImageSettings:y}=React.useMemo(()=>{let w=f.getModules();const v=getMarginSize(r,o),_=w.length+v*2,F=getImageSettings(w,l,v,c);return{cells:w,margin:v,numCells:_,calculatedImageSettings:F}},[f,l,c,r,o]);return{qrcode:f,margin:E,cells:m,numCells:g,calculatedImageSettings:y}}var SUPPORTS_PATH2D=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),QRCodeCanvas=React.forwardRef(function e(t,n){const r=t,{value:o,size:c=DEFAULT_SIZE,level:l=DEFAULT_LEVEL,bgColor:x=DEFAULT_BGCOLOR,fgColor:f=DEFAULT_FGCOLOR,includeMargin:m=DEFAULT_INCLUDEMARGIN,minVersion:E=DEFAULT_MINVERSION,boostLevel:g,marginSize:y,imageSettings:w}=r,_=__objRest(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:F}=_,H=__objRest(_,["style"]),Y=w?.src,T=React.useRef(null),L=React.useRef(null),N=React.useCallback(M=>{T.current=M,typeof n=="function"?n(M):n&&(n.current=M)},[n]),[I,U]=React.useState(!1),{margin:W,cells:O,numCells:Z,calculatedImageSettings:z}=useQRCode({value:o,level:l,minVersion:E,boostLevel:g,includeMargin:m,marginSize:y,imageSettings:w,size:c});React.useEffect(()=>{if(T.current!=null){const M=T.current,S=M.getContext("2d");if(!S)return;let R=O;const D=L.current,j=z!=null&&D!==null&&D.complete&&D.naturalHeight!==0&&D.naturalWidth!==0;j&&z.excavation!=null&&(R=excavateModules(O,z.excavation));const P=window.devicePixelRatio||1;M.height=M.width=c*P;const Q=c/Z*P;S.scale(Q,Q),S.fillStyle=x,S.fillRect(0,0,Z,Z),S.fillStyle=f,SUPPORTS_PATH2D?S.fill(new Path2D(generatePath(R,W))):O.forEach(function(C,K){C.forEach(function(J,ne){J&&S.fillRect(ne+W,K+W,1,1)})}),z&&(S.globalAlpha=z.opacity),j&&S.drawImage(D,z.x+W,z.y+W,z.w,z.h)}}),React.useEffect(()=>{U(!1)},[Y]);const q=__spreadValues({height:c,width:c},F);let $=null;return Y!=null&&($=React.createElement("img",{src:Y,key:Y,style:{display:"none"},onLoad:()=>{U(!0)},ref:L,crossOrigin:z?.crossOrigin})),React.createElement(React.Fragment,null,React.createElement("canvas",__spreadValues({style:q,height:c,width:c,ref:N,role:"img"},H)),$)});QRCodeCanvas.displayName="QRCodeCanvas";var QRCodeSVG=React.forwardRef(function e(t,n){const r=t,{value:o,size:c=DEFAULT_SIZE,level:l=DEFAULT_LEVEL,bgColor:x=DEFAULT_BGCOLOR,fgColor:f=DEFAULT_FGCOLOR,includeMargin:m=DEFAULT_INCLUDEMARGIN,minVersion:E=DEFAULT_MINVERSION,boostLevel:g,title:y,marginSize:w,imageSettings:v}=r,_=__objRest(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:F,cells:H,numCells:Y,calculatedImageSettings:T}=useQRCode({value:o,level:l,minVersion:E,boostLevel:g,includeMargin:m,marginSize:w,imageSettings:v,size:c});let L=H,N=null;v!=null&&T!=null&&(T.excavation!=null&&(L=excavateModules(H,T.excavation)),N=React.createElement("image",{href:v.src,height:T.h,width:T.w,x:T.x+F,y:T.y+F,preserveAspectRatio:"none",opacity:T.opacity,crossOrigin:T.crossOrigin}));const I=generatePath(L,F);return React.createElement("svg",__spreadValues({height:c,width:c,viewBox:`0 0 ${Y} ${Y}`,ref:n,role:"img"},_),!!y&&React.createElement("title",null,y),React.createElement("path",{fill:x,d:`M0,0 h${Y}v${Y}H0z`,shapeRendering:"crispEdges"}),React.createElement("path",{fill:f,d:I,shapeRendering:"crispEdges"}),N)});QRCodeSVG.displayName="QRCodeSVG";const About=({onBack:e})=>{const[t,n]=reactExports.useState(null),[r,o]=reactExports.useState(!1),[c,l]=reactExports.useState(""),[x,f]=reactExports.useState(!1),[m,E]=reactExports.useState(!1),[g,y]=reactExports.useState(!1),[w,v]=reactExports.useState(!1),[_,F]=reactExports.useState([]),H="npub18n4ysp43ux5c98fs6h9c57qpr4p8r3j8f6e32v0vj8egzy878aqqyzzk9r",{currentKeypairId:Y,wallets:T,currentWalletId:L}=useWalletStore(),I=T.find(O=>O.id===L)?.keypairs.find(O=>O.id===Y);reactExports.useEffect(()=>{ProfileService.fetchProfile(H).then(n);try{const O=npubToBitcoinAddress(H);l(O)}catch{console.error("Failed to derive dev BTC address")}},[]),reactExports.useEffect(()=>{if(r&&I)try{const O=npubToBitcoinAddress(I.npub);fetchUTXOs(O).then(F)}catch(O){console.error(O)}},[r,I]);const U=(O,Z)=>{navigator.clipboard.writeText(O),Z(!0),setTimeout(()=>Z(!1),2e3)},W=(O,Z=8)=>O.length<=Z*2?O:`${O.slice(0,Z)}...${O.slice(-Z)}`;return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-md mx-auto space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-900 rounded-full transition-colors",children:jsxRuntimeExports.jsx(ArrowLeft,{className:"w-6 h-6 text-slate-400"})}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold",children:"About"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto bg-slate-900 rounded-2xl flex items-center justify-center border border-slate-800 shadow-xl overflow-hidden",children:jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"PWANS Logo",className:"w-full h-full object-cover"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-amber-500",children:"PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Progressive Web App Nostr Signer"})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-300 text-sm leading-relaxed max-w-xs mx-auto",children:"A secure, non-custodial Nostr signer and Bitcoin wallet that lives in your browser. Manage your keys, connect to apps, and transact with Bitcoin seamlessly."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 text-center",children:"Vibe Coded By"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-full bg-slate-800 overflow-hidden border-2 border-amber-500/20",children:t?.picture?jsxRuntimeExports.jsx("img",{src:t.picture,alt:"Dev",className:"w-full h-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-2xl font-bold",children:"?"})}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h4",{className:"font-bold text-lg text-white",children:t?.name||"Unknown Developer"}),t?.nip05&&jsxRuntimeExports.jsxs("div",{className:"text-amber-500 text-sm flex items-center justify-center gap-1",children:[jsxRuntimeExports.jsx("span",{children:t.nip05}),jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3 h-3"})]})]}),jsxRuntimeExports.jsxs("div",{className:"w-full space-y-3 mt-2",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-3 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 font-bold",children:"Nostr Public Key"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>y(!g),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(QrCode,{className:"w-3.5 h-3.5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>U(H,f),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:x?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-3.5 h-3.5"})})]})]}),g?jsxRuntimeExports.jsx("div",{className:"flex justify-center py-2 bg-white rounded-lg mb-2",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:H,size:150})}):jsxRuntimeExports.jsx("div",{className:"font-mono text-xs text-slate-300 text-center break-all",children:W(H,12)})]}),c&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-3 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 font-bold",children:"Bitcoin Address"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>v(!w),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(QrCode,{className:"w-3.5 h-3.5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>U(c,E),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:m?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-3.5 h-3.5"})})]})]}),w?jsxRuntimeExports.jsx("div",{className:"flex justify-center py-2 bg-white rounded-lg mb-2",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:c,size:150})}):jsxRuntimeExports.jsx("div",{className:"font-mono text-xs text-amber-500/80 text-center break-all",children:W(c,12)})]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>o(!0),className:"w-full py-3 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white font-bold rounded-xl shadow-lg shadow-amber-500/20 transition-all flex items-center justify-center gap-2 mt-2",children:[jsxRuntimeExports.jsx(Heart,{className:"w-5 h-5 fill-white"}),"Tip Developer"]})]})]}),jsxRuntimeExports.jsx("div",{className:"text-center pb-8",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-500 text-xs max-w-xs mx-auto leading-relaxed",children:[jsxRuntimeExports.jsx("strong",{children:"Disclaimer:"})," PWANS and its creator(s) hold no responsibility for any lost or compromised accounts or funds. The user holds full responsibility for how they use this PWA."]})})]}),r&&jsxRuntimeExports.jsx(SendModal,{isOpen:r,onClose:()=>o(!1),utxos:_,onSuccess:()=>o(!1),initialRecipient:c})]})},useClientConnections=(e,t)=>{const[n,r]=reactExports.useState(new Map),o=useConnectionsStore(f=>f.connections),c=reactExports.useRef(new Map),l=reactExports.useRef(new Set),x=reactExports.useRef(new Map);return reactExports.useEffect(()=>{if(!e||!t)return;(async()=>{const m=new Map(c.current);let E=!1;const g=o.filter(y=>y.keypairId===e.id);for(const y of g){const w=x.current.get(y.id)||0;if(!m.has(y.id)&&!l.current.has(y.id)&&y.status!=="disconnected"&&w<3){l.current.add(y.id);try{console.log(`[useClientConnections] Initializing client for: ${y.name} (Attempt ${w+1}/3)`);const v=new ClientService(t,y.id,{signerPubkey:y.signerPubkey,relays:y.relays,secret:y.secret,name:y.name,appUrl:y.appUrl});await v.connect(),useConnectionsStore.getState().connections.find(F=>F.id===y.id)?(m.set(y.id,v),E=!0,x.current.delete(y.id)):v.disconnect()}catch(v){console.error("Failed to init client:",v),x.current.set(y.id,w+1)}finally{l.current.delete(y.id)}}}for(const[y]of m.entries())o.find(w=>w.id===y)||(console.log("[useClientConnections] Removing client for:",y),m.get(y)?.disconnect(),m.delete(y),E=!0,x.current.delete(y));E&&(c.current=m,r(new Map(m)))})()},[o,e,t]),{clients:n}},useRelayMonitor=e=>{const{relays:t,updateRelayStatus:n,incrementFailedAttempts:r}=useRelayStore(),o=reactExports.useRef(null);reactExports.useEffect(()=>{if(e)return o.current=setInterval(()=>{const c=t.filter(l=>l.status==="disconnected"||l.status==="error");c.length>0&&(console.log("[RelayMonitor] Attempting to reconnect",c.length,"relays"),c.forEach(l=>{if(l.failedAttempts>=10){console.log(`[RelayMonitor] Skipping ${l.url} - too many failed attempts`);return}n(l.url,"connecting");try{e.ndk?.pool?.relays?.get(l.url)?.connect()}catch(f){console.error(`[RelayMonitor] Failed to reconnect to ${l.url}:`,f),n(l.url,"error"),r(l.url)}}))},5e3),()=>{o.current&&clearInterval(o.current)}},[e,t,n,r])},Dashboard=()=>{const{logout:e,publicKey:t,decryptedKey:n}=useAuthStore(),{currentWalletId:r,wallets:o,currentKeypairId:c}=useWalletStore(),{requests:l}=useRequestStore(),[x,f]=reactExports.useState(""),[m,E]=reactExports.useState(!1),[g,y]=reactExports.useState("client"),[w,v]=reactExports.useState("connections"),[_,F]=reactExports.useState(!1),[H,Y]=reactExports.useState(!1),[T,L]=reactExports.useState(!1),N=reactExports.useRef(null),{isOnline:I,relays:U}=useRelayStore(),W=o.find(D=>D.id===r),O=W?.keypairs.find(D=>D.id===c);useRelayMonitor(N.current),reactExports.useEffect(()=>{if(O)try{const{data:D}=nip19_exports$1.decode(O.npub);f(`bunker://${D}?relay=wss://relay.primal.net&relay=wss://relay.damus.io&relay=wss://nos.lol&relay=wss://relay.nostr.band`)}catch(D){console.error("Invalid npub:",D)}if(n&&!N.current){const D=new SignerService(n);return N.current=D,D.connect().catch(console.error),()=>{D.disconnect(),N.current=null}}else!n&&N.current&&(N.current.disconnect(),N.current=null,f(""))},[n,O]);const Z=()=>{navigator.clipboard.writeText(x),E(!0),setTimeout(()=>E(!1),2e3)},z=(D,j)=>{window.history.pushState({view:D},""),j(!0)},q=()=>{window.history.pushState({view:"wallet"},""),v("wallet")},{clients:$}=useClientConnections(O,n),M=async(D,j,P,Q,C,K=!1)=>{if(console.log("[Dashboard] handleApprove called with remember:",K),K){if(Q==="sign_event")try{const J=C[0],re=JSON.parse(J).kind;console.log("[Dashboard] Attempting to save auto-approval rule for kind:",re),console.log("[Dashboard] Requestor pubkey:",P);let ie;if(R?.connectionId&&(ie=useConnectionsStore.getState().connections.find(ce=>ce.id===R.connectionId)),ie||(ie=useConnectionsStore.getState().connections.find(ce=>ce.signerPubkey===P)),ie){console.log("[Dashboard] Found connection:",ie.id,ie.name);const{addRule:ce}=useConnectionsStore.getState(),ue={id:Math.random().toString(36).substring(7),connectionId:ie.id,kinds:[re],createdAt:Date.now()};console.log("[Dashboard] Calling addRule with:",ue),ce(ue),console.log(`[Dashboard]  Rule saved for kind ${re}`)}else console.error("[Dashboard]  Connection not found for requestor:",P)}catch(J){console.error("[Dashboard] Failed to save auto-approval rule:",J)}else if(Q==="nip04_decrypt"||Q==="nip04_encrypt")try{console.log(`[Dashboard] Attempting to save auto-approval rule for ${Q}`),console.log("[Dashboard] Requestor pubkey:",P);let J;if(R?.connectionId&&(J=useConnectionsStore.getState().connections.find(ne=>ne.id===R.connectionId)),J||(J=useConnectionsStore.getState().connections.find(ne=>ne.signerPubkey===P)),J){console.log("[Dashboard] Found connection:",J.id,J.name);const{addRule:ne}=useConnectionsStore.getState(),re=Q==="nip04_decrypt"?-4:-5,ie={id:Math.random().toString(36).substring(7),connectionId:J.id,kinds:[re],createdAt:Date.now()};console.log("[Dashboard] Calling addRule with:",ie),ne(ie),console.log(`[Dashboard]  Rule saved for ${Q}`);const ce=useRequestStore.getState().requests;console.log("[Dashboard] Checking pending requests for auto-approval:",ce.length);const ue=ce.filter(ae=>ae.id!==D&&ae.method===Q&&(ae.connectionId===J.id||ae.requestorPubkey===P));ue.length>0&&(console.log(`[Dashboard] Found ${ue.length} pending requests to auto-approve`),setTimeout(async()=>{for(const ae of ue)if(console.log(`[Dashboard] Auto-approving pending request: ${ae.id}`),ae.connectionId){const we=$.get(ae.connectionId);we&&await we.approveRequest(ae.id,ae.requestEventId,ae.requestorPubkey,ae.method,ae.params)}else N.current?.approveRequest(ae.id,ae.requestEventId,ae.requestorPubkey,ae.method,ae.params),useRequestStore.getState().removeRequest(ae.id)},100))}else console.error("[Dashboard]  Connection not found for requestor:",P)}catch(J){console.error("[Dashboard] Failed to save auto-approval rule:",J)}}if(Q==="connect")try{const J=useConnectionsStore.getState();J.connections.find(re=>re.signerPubkey===P)||(console.log("[Dashboard] Saving new connection from connect request"),J.addConnection({id:Math.random().toString(36).substring(7),keypairId:c,signerPubkey:P,name:"App "+P.slice(0,4),relays:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io"],secret:C[0]||"",status:"connected",connectedAt:Date.now()}))}catch(J){console.error("[Dashboard] Failed to save connection:",J)}if(R?.connectionId){const J=$.get(R.connectionId);if(J){console.log("[Dashboard] Approving via ClientService for connection:",R.connectionId),J.approveRequest(D,j,P,Q,C,R.encryptionMethod);return}else console.warn("[ClientService] ClientService not found for connection:",R.connectionId)}console.log("[Dashboard] Approving via SignerService"),N.current?.approveRequest(D,j,P,Q,C),useRequestStore.getState().removeRequest(D)},S=(D,j,P)=>{if(R?.connectionId){const Q=$.get(R.connectionId);if(Q){console.log("[Dashboard] Rejecting via ClientService for connection:",R.connectionId),Q.rejectRequest(D,j,P);return}}N.current?.rejectRequest(D,j,P),useRequestStore.getState().removeRequest(D)},R=l.find(D=>D.source==="client")||l[0];return reactExports.useEffect(()=>{if(!R)return;const{method:D,params:j,connectionId:P,requestorPubkey:Q,id:C}=R;if(D!=="nip04_decrypt"&&D!=="nip04_encrypt"&&D!=="sign_event")return;const K=useConnectionsStore.getState();let J;if(P?J=K.connections.find(ne=>ne.id===P):J=K.connections.find(ne=>ne.signerPubkey===Q),J){const ne=K.getRulesForConnection(J.id);let re;if(D==="sign_event")try{re=JSON.parse(j[0]).kind}catch{return}else D==="nip04_decrypt"?re=-4:D==="nip04_encrypt"&&(re=-5);re!==void 0&&ne.find(ce=>ce.kinds.includes(re))&&(console.log(`[Dashboard]  Safety Net: Auto-approving ${D} request ${C} due to existing rule`),M(C,R.requestEventId,Q,D,j,!1))}},[R]),_?jsxRuntimeExports.jsx(WalletManager,{onBack:()=>F(!1)}):w==="about"?jsxRuntimeExports.jsx(About,{onBack:()=>v("connections")}):jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center mb-8 border-b border-slate-800 pb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>v("about"),className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"Logo",className:"w-8 h-8 rounded-lg"}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold text-amber-500",children:"PWANS"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>z("relay-manager",L),className:`flex items-center gap-1 text-xs px-2 py-1 rounded-full transition-colors cursor-pointer hover:opacity-80 ${I()?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,title:`${U.filter(D=>D.status==="connected").length}/${U.length} relays connected - Click to manage`,children:[I()?jsxRuntimeExports.jsx(Wifi,{className:"w-3 h-3"}):jsxRuntimeExports.jsx(WifiOff,{className:"w-3 h-3"}),I()?"Online":"Offline"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[W&&jsxRuntimeExports.jsxs("button",{onClick:()=>z("wallet-manager",F),className:"flex items-center gap-2 px-3 py-2 bg-slate-900 hover:bg-slate-800 rounded-lg transition-colors border border-slate-800",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-4 h-4 text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:W.name})]}),jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-900 rounded-lg transition-colors",title:"Lock Wallet",children:jsxRuntimeExports.jsx(LogOut,{className:"w-5 h-5 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("main",{className:"max-w-2xl mx-auto space-y-6 pb-24",children:[O&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-4 border border-slate-800 flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative rounded-lg bg-amber-500 text-slate-950 flex-shrink-0 overflow-hidden cursor-pointer group w-10 h-10",onClick:async D=>{if(D.stopPropagation(),!O||!W)return;const j=D.currentTarget;j.classList.add("opacity-50");try{const{ProfileService:P}=await __vitePreload(async()=>{const{ProfileService:K}=await Promise.resolve().then(()=>profile);return{ProfileService:K}},void 0,import.meta.url),{updateKeypair:Q}=useWalletStore.getState(),C=await P.fetchProfile(O.npub);C&&Q(W.id,O.id,{profile:{...C,lastFetched:Date.now()}})}catch(P){console.error("[Dashboard] Failed to refresh profile:",P)}finally{j.classList.remove("opacity-50")}},title:"Click to refresh profile",children:[O.profile?.picture?jsxRuntimeExports.jsx("img",{src:O.profile.picture,alt:O.profile.name||"Profile",className:"w-full h-full object-cover",onError:D=>{D.currentTarget.style.display="none",D.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx("div",{className:`w-full h-full flex items-center justify-center bg-amber-500 ${O.profile?.picture?"hidden":""}`,children:jsxRuntimeExports.jsx(User,{className:"w-6 h-6 text-slate-950"})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 text-white"})})]}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg truncate",children:O.profile?.name||O.name}),jsxRuntimeExports.jsx("button",{onClick:()=>Y(!0),className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Switch Address",children:jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex-shrink-0",children:"Active"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400 font-mono truncate",children:O.npub.length>16?`${O.npub.slice(0,8)}...${O.npub.slice(-6)}`:O.npub})]})]}),H&&W&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:()=>Y(!1),children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",onClick:D=>D.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Switch Address"}),jsxRuntimeExports.jsx("button",{onClick:()=>Y(!1),className:"p-1 hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:W.keypairs.map(D=>jsxRuntimeExports.jsxs("button",{onClick:async()=>{const{password:j}=useAuthStore.getState();if(!j){console.error("[Dashboard] No cached password for keypair switch");return}try{const{CryptoService:P}=await __vitePreload(async()=>{const{CryptoService:K}=await Promise.resolve().then(()=>crypto$3);return{CryptoService:K}},void 0,import.meta.url),Q=await P.decrypt(D.encryptedNsec,j),C=P.nsecToHex(Q);useWalletStore.getState().setCurrentKeypair(D.id),useAuthStore.getState().unlock(C,j),Y(!1)}catch(P){console.error("[Dashboard] Failed to switch keypair:",P)}},className:`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${c===D.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-950 border-slate-800 hover:border-slate-700 hover:bg-slate-900"}`,children:[jsxRuntimeExports.jsxs("div",{className:`p-1 rounded-lg flex-shrink-0 ${c===D.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:[D.profile?.picture?jsxRuntimeExports.jsx("img",{src:D.profile.picture,alt:D.profile.name||"Profile",className:"w-8 h-8 rounded-lg object-cover",onError:j=>{j.currentTarget.style.display="none",j.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx(User,{className:`w-8 h-8 ${D.profile?.picture?"hidden":""}`})]}),jsxRuntimeExports.jsxs("div",{className:"text-left flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-white truncate",children:D.profile?.name||D.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400 font-mono truncate",children:D.npub})]}),c===D.id&&jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5 text-amber-500"})]},D.id))})]})}),w==="connections"&&jsxRuntimeExports.jsxs("div",{className:"flex gap-2 bg-slate-900 p-1 rounded-lg border border-slate-800",children:[jsxRuntimeExports.jsx("button",{onClick:()=>y("client"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${g==="client"?"bg-amber-500 text-slate-950":"text-slate-400 hover:text-white"}`,children:"Connect to Signer"}),jsxRuntimeExports.jsx("button",{onClick:()=>y("bunker"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${g==="bunker"?"bg-amber-500 text-slate-950":"text-slate-400 hover:text-white"}`,children:"Bunker Mode"})]}),g==="bunker"&&w==="connections"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Connect App"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Copy this connection string (Bunker URI) and paste it into a NIP-46 compatible Nostr client (like Snort or Amethyst)."}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:"text",readOnly:!0,value:x,className:"w-full bg-slate-950 border border-slate-800 rounded-lg pl-4 pr-12 py-3 text-sm text-slate-300 font-mono focus:outline-none"}),jsxRuntimeExports.jsx("button",{onClick:Z,className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 hover:bg-slate-800 rounded-md transition-colors",children:m?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4 text-green-400"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Vault Info"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Public Key"}),jsxRuntimeExports.jsx("p",{className:"text-slate-300 font-mono text-sm break-all",children:t})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Active Relay"}),jsxRuntimeExports.jsx("p",{className:"text-slate-300 font-mono text-sm",children:"wss://relay.primal.net"})]})]})]})]}),g==="client"&&w==="connections"&&jsxRuntimeExports.jsx(ConnectSigner,{}),w==="wallet"&&jsxRuntimeExports.jsx(BitcoinWallet,{})]}),jsxRuntimeExports.jsx(BottomNav,{currentView:w,onChange:D=>{D==="wallet"?q():v("connections")}}),R&&jsxRuntimeExports.jsx(RequestModal,{request:R,onApprove:D=>M(R.id,R.requestEventId,R.requestorPubkey,R.method,R.params,D),onReject:()=>S(R.id,R.requestEventId,R.requestorPubkey)}),T&&jsxRuntimeExports.jsx(RelayManager,{onClose:()=>L(!1)})]})},DisclaimerModal=({onAgree:e})=>jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-[100]",children:jsxRuntimeExports.jsx("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center text-center space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-amber-500/10 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(TriangleAlert,{className:"w-8 h-8 text-amber-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Please read this important disclaimer before continuing."})]}),jsxRuntimeExports.jsx("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800 text-left",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm leading-relaxed",children:["PWANS and its creator(s) hold ",jsxRuntimeExports.jsx("strong",{children:"no responsibility"})," for any lost or compromised accounts or funds.",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),"This is a self-custodial application. ",jsxRuntimeExports.jsx("strong",{children:"You"})," hold full responsibility for how you use this PWA and for securing your own keys."]})}),jsxRuntimeExports.jsxs("button",{onClick:e,className:"w-full py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5"}),"I Understand and Agree"]})]})})});function promisifyRequest(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function createStore(e,t){let n;const r=()=>{if(n)return n;const o=indexedDB.open(e);return o.onupgradeneeded=()=>o.result.createObjectStore(t),n=promisifyRequest(o),n.then(c=>{c.onclose=()=>n=void 0},()=>{}),n};return(o,c)=>r().then(l=>c(l.transaction(t,o).objectStore(t)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get(e,t=defaultGetStore()){return t("readonly",n=>promisifyRequest(n.get(e)))}function set(e,t,n=defaultGetStore()){return n("readwrite",r=>(r.put(t,e),promisifyRequest(r.transaction)))}function del(e,t=defaultGetStore()){return t("readwrite",n=>(n.delete(e),promisifyRequest(n.transaction)))}function App(){const{isUnlocked:e}=useAuthStore(),[t,n]=reactExports.useState(!1),[r,o]=reactExports.useState(!0);reactExports.useEffect(()=>{(async()=>{try{if(await get("disclaimer_accepted")){o(!1);return}const f=await get("wallet-storage");if(f)try{const m=JSON.parse(f);if(m.state&&m.state.wallets&&m.state.wallets.length>0){await set("disclaimer_accepted","true"),o(!1);return}}catch(m){console.error("Failed to parse wallet storage:",m)}n(!0)}catch(x){console.error("Error checking disclaimer status:",x)}finally{o(!1)}})()},[]);const c=async()=>{await set("disclaimer_accepted","true"),n(!1)};return r?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-8 h-8 text-amber-500 animate-spin"})}):t?jsxRuntimeExports.jsx(DisclaimerModal,{onAgree:c}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e?jsxRuntimeExports.jsx(Dashboard,{}):jsxRuntimeExports.jsx(Login,{})})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));export{del as d,get as g,set as s};
