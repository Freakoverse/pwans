function _mergeNamespaces(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in e)){const a=Object.getOwnPropertyDescriptor(n,o);a&&Object.defineProperty(e,o,a.get?a:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){var o=!1;try{o=this instanceof n}catch{}return o?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var jsxRuntime={exports:{}},reactJsxRuntime_production={};var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,o,a){var l=null;if(a!==void 0&&(l=""+a),o.key!==void 0&&(l=""+o.key),"key"in o){a={};for(var u in o)u!=="key"&&(a[u]=o[u])}else a=o;return o=a.ref,{$$typeof:e,type:n,key:l,ref:o!==void 0?o:null,props:a}}return reactJsxRuntime_production.Fragment=t,reactJsxRuntime_production.jsx=r,reactJsxRuntime_production.jsxs=r,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),buffer={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$1=0,len=code.length;i$1<len;++i$1)lookup[i$1]=code[i$1],revLookup[code.charCodeAt(i$1)]=i$1;revLookup[45]=62;revLookup[95]=63;function getLens(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function byteLength(e){var t=getLens(e),r=t[0],n=t[1];return(r+n)*3/4-n}function _byteLength(e,t,r){return(t+r)*3/4-r}function toByteArray(e){var t,r=getLens(e),n=r[0],o=r[1],a=new Arr(_byteLength(e,n,o)),l=0,u=o>0?n-4:n,f;for(f=0;f<u;f+=4)t=revLookup[e.charCodeAt(f)]<<18|revLookup[e.charCodeAt(f+1)]<<12|revLookup[e.charCodeAt(f+2)]<<6|revLookup[e.charCodeAt(f+3)],a[l++]=t>>16&255,a[l++]=t>>8&255,a[l++]=t&255;return o===2&&(t=revLookup[e.charCodeAt(f)]<<2|revLookup[e.charCodeAt(f+1)]>>4,a[l++]=t&255),o===1&&(t=revLookup[e.charCodeAt(f)]<<10|revLookup[e.charCodeAt(f+1)]<<4|revLookup[e.charCodeAt(f+2)]>>2,a[l++]=t>>8&255,a[l++]=t&255),a}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[e&63]}function encodeChunk(e,t,r){for(var n,o=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(e[a+2]&255),o.push(tripletToBase64(n));return o.join("")}function fromByteArray(e){for(var t,r=e.length,n=r%3,o=[],a=16383,l=0,u=r-n;l<u;l+=a)o.push(encodeChunk(e,l,l+a>u?u:l+a));return n===1?(t=e[r-1],o.push(lookup[t>>2]+lookup[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],o.push(lookup[t>>10]+lookup[t>>4&63]+lookup[t<<2&63]+"=")),o.join("")}var ieee754={};ieee754.read=function(e,t,r,n,o){var a,l,u=o*8-n-1,f=(1<<u)-1,x=f>>1,p=-7,g=r?o-1:0,y=r?-1:1,b=e[t+g];for(g+=y,a=b&(1<<-p)-1,b>>=-p,p+=u;p>0;a=a*256+e[t+g],g+=y,p-=8);for(l=a&(1<<-p)-1,a>>=-p,p+=n;p>0;l=l*256+e[t+g],g+=y,p-=8);if(a===0)a=1-x;else{if(a===f)return l?NaN:(b?-1:1)*(1/0);l=l+Math.pow(2,n),a=a-x}return(b?-1:1)*l*Math.pow(2,a-n)};ieee754.write=function(e,t,r,n,o,a){var l,u,f,x=a*8-o-1,p=(1<<x)-1,g=p>>1,y=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:a-1,w=n?1:-1,v=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,l=p):(l=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-l))<1&&(l--,f*=2),l+g>=1?t+=y/f:t+=y*Math.pow(2,1-g),t*f>=2&&(l++,f/=2),l+g>=p?(u=0,l=p):l+g>=1?(u=(t*f-1)*Math.pow(2,o),l=l+g):(u=t*Math.pow(2,g-1)*Math.pow(2,o),l=0));o>=8;e[r+b]=u&255,b+=w,u/=256,o-=8);for(l=l<<o|u,x+=o;x>0;e[r+b]=l&255,b+=w,l/=256,x-=8);e[r+b-w]|=v*128};(function(e){const t=base64Js,r=ieee754,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=p,e.SlowBuffer=T,e.INSPECT_MAX_BYTES=50;const o=2147483647;e.kMaxLength=o;const{Uint8Array:a,ArrayBuffer:l,SharedArrayBuffer:u}=globalThis;p.TYPED_ARRAY_SUPPORT=f(),!p.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{const ie=new a(1),P={foo:function(){return 42}};return Object.setPrototypeOf(P,a.prototype),Object.setPrototypeOf(ie,P),ie.foo()===42}catch{return!1}}Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.byteOffset}});function x(ie){if(ie>o)throw new RangeError('The value "'+ie+'" is invalid for option "size"');const P=new a(ie);return Object.setPrototypeOf(P,p.prototype),P}function p(ie,P,V){if(typeof ie=="number"){if(typeof P=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(ie)}return g(ie,P,V)}p.poolSize=8192;function g(ie,P,V){if(typeof ie=="string")return v(ie,P);if(l.isView(ie))return j(ie);if(ie==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ie);if(ve(ie,l)||ie&&ve(ie.buffer,l)||typeof u<"u"&&(ve(ie,u)||ie&&ve(ie.buffer,u)))return F(ie,P,V);if(typeof ie=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const he=ie.valueOf&&ie.valueOf();if(he!=null&&he!==ie)return p.from(he,P,V);const _e=C(ie);if(_e)return _e;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ie[Symbol.toPrimitive]=="function")return p.from(ie[Symbol.toPrimitive]("string"),P,V);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ie)}p.from=function(ie,P,V){return g(ie,P,V)},Object.setPrototypeOf(p.prototype,a.prototype),Object.setPrototypeOf(p,a);function y(ie){if(typeof ie!="number")throw new TypeError('"size" argument must be of type number');if(ie<0)throw new RangeError('The value "'+ie+'" is invalid for option "size"')}function b(ie,P,V){return y(ie),ie<=0?x(ie):P!==void 0?typeof V=="string"?x(ie).fill(P,V):x(ie).fill(P):x(ie)}p.alloc=function(ie,P,V){return b(ie,P,V)};function w(ie){return y(ie),x(ie<0?0:N(ie)|0)}p.allocUnsafe=function(ie){return w(ie)},p.allocUnsafeSlow=function(ie){return w(ie)};function v(ie,P){if((typeof P!="string"||P==="")&&(P="utf8"),!p.isEncoding(P))throw new TypeError("Unknown encoding: "+P);const V=_(ie,P)|0;let he=x(V);const _e=he.write(ie,P);return _e!==V&&(he=he.slice(0,_e)),he}function B(ie){const P=ie.length<0?0:N(ie.length)|0,V=x(P);for(let he=0;he<P;he+=1)V[he]=ie[he]&255;return V}function j(ie){if(ve(ie,a)){const P=new a(ie);return F(P.buffer,P.byteOffset,P.byteLength)}return B(ie)}function F(ie,P,V){if(P<0||ie.byteLength<P)throw new RangeError('"offset" is outside of buffer bounds');if(ie.byteLength<P+(V||0))throw new RangeError('"length" is outside of buffer bounds');let he;return P===void 0&&V===void 0?he=new a(ie):V===void 0?he=new a(ie,P):he=new a(ie,P,V),Object.setPrototypeOf(he,p.prototype),he}function C(ie){if(p.isBuffer(ie)){const P=N(ie.length)|0,V=x(P);return V.length===0||ie.copy(V,0,0,P),V}if(ie.length!==void 0)return typeof ie.length!="number"||Te(ie.length)?x(0):B(ie);if(ie.type==="Buffer"&&Array.isArray(ie.data))return B(ie.data)}function N(ie){if(ie>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return ie|0}function T(ie){return+ie!=ie&&(ie=0),p.alloc(+ie)}p.isBuffer=function(P){return P!=null&&P._isBuffer===!0&&P!==p.prototype},p.compare=function(P,V){if(ve(P,a)&&(P=p.from(P,P.offset,P.byteLength)),ve(V,a)&&(V=p.from(V,V.offset,V.byteLength)),!p.isBuffer(P)||!p.isBuffer(V))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(P===V)return 0;let he=P.length,_e=V.length;for(let je=0,Ie=Math.min(he,_e);je<Ie;++je)if(P[je]!==V[je]){he=P[je],_e=V[je];break}return he<_e?-1:_e<he?1:0},p.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(P,V){if(!Array.isArray(P))throw new TypeError('"list" argument must be an Array of Buffers');if(P.length===0)return p.alloc(0);let he;if(V===void 0)for(V=0,he=0;he<P.length;++he)V+=P[he].length;const _e=p.allocUnsafe(V);let je=0;for(he=0;he<P.length;++he){let Ie=P[he];if(ve(Ie,a))je+Ie.length>_e.length?(p.isBuffer(Ie)||(Ie=p.from(Ie)),Ie.copy(_e,je)):a.prototype.set.call(_e,Ie,je);else if(p.isBuffer(Ie))Ie.copy(_e,je);else throw new TypeError('"list" argument must be an Array of Buffers');je+=Ie.length}return _e};function _(ie,P){if(p.isBuffer(ie))return ie.length;if(l.isView(ie)||ve(ie,l))return ie.byteLength;if(typeof ie!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ie);const V=ie.length,he=arguments.length>2&&arguments[2]===!0;if(!he&&V===0)return 0;let _e=!1;for(;;)switch(P){case"ascii":case"latin1":case"binary":return V;case"utf8":case"utf-8":return Fe(ie).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V*2;case"hex":return V>>>1;case"base64":return Ve(ie).length;default:if(_e)return he?-1:Fe(ie).length;P=(""+P).toLowerCase(),_e=!0}}p.byteLength=_;function S(ie,P,V){let he=!1;if((P===void 0||P<0)&&(P=0),P>this.length||((V===void 0||V>this.length)&&(V=this.length),V<=0)||(V>>>=0,P>>>=0,V<=P))return"";for(ie||(ie="utf8");;)switch(ie){case"hex":return Y(this,P,V);case"utf8":case"utf-8":return q(this,P,V);case"ascii":return Q(this,P,V);case"latin1":case"binary":return D(this,P,V);case"base64":return M(this,P,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,P,V);default:if(he)throw new TypeError("Unknown encoding: "+ie);ie=(ie+"").toLowerCase(),he=!0}}p.prototype._isBuffer=!0;function O(ie,P,V){const he=ie[P];ie[P]=ie[V],ie[V]=he}p.prototype.swap16=function(){const P=this.length;if(P%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let V=0;V<P;V+=2)O(this,V,V+1);return this},p.prototype.swap32=function(){const P=this.length;if(P%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let V=0;V<P;V+=4)O(this,V,V+3),O(this,V+1,V+2);return this},p.prototype.swap64=function(){const P=this.length;if(P%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let V=0;V<P;V+=8)O(this,V,V+7),O(this,V+1,V+6),O(this,V+2,V+5),O(this,V+3,V+4);return this},p.prototype.toString=function(){const P=this.length;return P===0?"":arguments.length===0?q(this,0,P):S.apply(this,arguments)},p.prototype.toLocaleString=p.prototype.toString,p.prototype.equals=function(P){if(!p.isBuffer(P))throw new TypeError("Argument must be a Buffer");return this===P?!0:p.compare(this,P)===0},p.prototype.inspect=function(){let P="";const V=e.INSPECT_MAX_BYTES;return P=this.toString("hex",0,V).replace(/(.{2})/g,"$1 ").trim(),this.length>V&&(P+=" ... "),"<Buffer "+P+">"},n&&(p.prototype[n]=p.prototype.inspect),p.prototype.compare=function(P,V,he,_e,je){if(ve(P,a)&&(P=p.from(P,P.offset,P.byteLength)),!p.isBuffer(P))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof P);if(V===void 0&&(V=0),he===void 0&&(he=P?P.length:0),_e===void 0&&(_e=0),je===void 0&&(je=this.length),V<0||he>P.length||_e<0||je>this.length)throw new RangeError("out of range index");if(_e>=je&&V>=he)return 0;if(_e>=je)return-1;if(V>=he)return 1;if(V>>>=0,he>>>=0,_e>>>=0,je>>>=0,this===P)return 0;let Ie=je-_e,Ze=he-V;const et=Math.min(Ie,Ze),st=this.slice(_e,je),rt=P.slice(V,he);for(let nt=0;nt<et;++nt)if(st[nt]!==rt[nt]){Ie=st[nt],Ze=rt[nt];break}return Ie<Ze?-1:Ze<Ie?1:0};function $(ie,P,V,he,_e){if(ie.length===0)return-1;if(typeof V=="string"?(he=V,V=0):V>2147483647?V=2147483647:V<-2147483648&&(V=-2147483648),V=+V,Te(V)&&(V=_e?0:ie.length-1),V<0&&(V=ie.length+V),V>=ie.length){if(_e)return-1;V=ie.length-1}else if(V<0)if(_e)V=0;else return-1;if(typeof P=="string"&&(P=p.from(P,he)),p.isBuffer(P))return P.length===0?-1:z(ie,P,V,he,_e);if(typeof P=="number")return P=P&255,typeof a.prototype.indexOf=="function"?_e?a.prototype.indexOf.call(ie,P,V):a.prototype.lastIndexOf.call(ie,P,V):z(ie,[P],V,he,_e);throw new TypeError("val must be string, number or Buffer")}function z(ie,P,V,he,_e){let je=1,Ie=ie.length,Ze=P.length;if(he!==void 0&&(he=String(he).toLowerCase(),he==="ucs2"||he==="ucs-2"||he==="utf16le"||he==="utf-16le")){if(ie.length<2||P.length<2)return-1;je=2,Ie/=2,Ze/=2,V/=2}function et(rt,nt){return je===1?rt[nt]:rt.readUInt16BE(nt*je)}let st;if(_e){let rt=-1;for(st=V;st<Ie;st++)if(et(ie,st)===et(P,rt===-1?0:st-rt)){if(rt===-1&&(rt=st),st-rt+1===Ze)return rt*je}else rt!==-1&&(st-=st-rt),rt=-1}else for(V+Ze>Ie&&(V=Ie-Ze),st=V;st>=0;st--){let rt=!0;for(let nt=0;nt<Ze;nt++)if(et(ie,st+nt)!==et(P,nt)){rt=!1;break}if(rt)return st}return-1}p.prototype.includes=function(P,V,he){return this.indexOf(P,V,he)!==-1},p.prototype.indexOf=function(P,V,he){return $(this,P,V,he,!0)},p.prototype.lastIndexOf=function(P,V,he){return $(this,P,V,he,!1)};function W(ie,P,V,he){V=Number(V)||0;const _e=ie.length-V;he?(he=Number(he),he>_e&&(he=_e)):he=_e;const je=P.length;he>je/2&&(he=je/2);let Ie;for(Ie=0;Ie<he;++Ie){const Ze=parseInt(P.substr(Ie*2,2),16);if(Te(Ze))return Ie;ie[V+Ie]=Ze}return Ie}function U(ie,P,V,he){return Ee(Fe(P,ie.length-V),ie,V,he)}function I(ie,P,V,he){return Ee(Pe(P),ie,V,he)}function G(ie,P,V,he){return Ee(Ve(P),ie,V,he)}function k(ie,P,V,he){return Ee(Ye(P,ie.length-V),ie,V,he)}p.prototype.write=function(P,V,he,_e){if(V===void 0)_e="utf8",he=this.length,V=0;else if(he===void 0&&typeof V=="string")_e=V,he=this.length,V=0;else if(isFinite(V))V=V>>>0,isFinite(he)?(he=he>>>0,_e===void 0&&(_e="utf8")):(_e=he,he=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const je=this.length-V;if((he===void 0||he>je)&&(he=je),P.length>0&&(he<0||V<0)||V>this.length)throw new RangeError("Attempt to write outside buffer bounds");_e||(_e="utf8");let Ie=!1;for(;;)switch(_e){case"hex":return W(this,P,V,he);case"utf8":case"utf-8":return U(this,P,V,he);case"ascii":case"latin1":case"binary":return I(this,P,V,he);case"base64":return G(this,P,V,he);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,P,V,he);default:if(Ie)throw new TypeError("Unknown encoding: "+_e);_e=(""+_e).toLowerCase(),Ie=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(ie,P,V){return P===0&&V===ie.length?t.fromByteArray(ie):t.fromByteArray(ie.slice(P,V))}function q(ie,P,V){V=Math.min(ie.length,V);const he=[];let _e=P;for(;_e<V;){const je=ie[_e];let Ie=null,Ze=je>239?4:je>223?3:je>191?2:1;if(_e+Ze<=V){let et,st,rt,nt;switch(Ze){case 1:je<128&&(Ie=je);break;case 2:et=ie[_e+1],(et&192)===128&&(nt=(je&31)<<6|et&63,nt>127&&(Ie=nt));break;case 3:et=ie[_e+1],st=ie[_e+2],(et&192)===128&&(st&192)===128&&(nt=(je&15)<<12|(et&63)<<6|st&63,nt>2047&&(nt<55296||nt>57343)&&(Ie=nt));break;case 4:et=ie[_e+1],st=ie[_e+2],rt=ie[_e+3],(et&192)===128&&(st&192)===128&&(rt&192)===128&&(nt=(je&15)<<18|(et&63)<<12|(st&63)<<6|rt&63,nt>65535&&nt<1114112&&(Ie=nt))}}Ie===null?(Ie=65533,Ze=1):Ie>65535&&(Ie-=65536,he.push(Ie>>>10&1023|55296),Ie=56320|Ie&1023),he.push(Ie),_e+=Ze}return H(he)}const K=4096;function H(ie){const P=ie.length;if(P<=K)return String.fromCharCode.apply(String,ie);let V="",he=0;for(;he<P;)V+=String.fromCharCode.apply(String,ie.slice(he,he+=K));return V}function Q(ie,P,V){let he="";V=Math.min(ie.length,V);for(let _e=P;_e<V;++_e)he+=String.fromCharCode(ie[_e]&127);return he}function D(ie,P,V){let he="";V=Math.min(ie.length,V);for(let _e=P;_e<V;++_e)he+=String.fromCharCode(ie[_e]);return he}function Y(ie,P,V){const he=ie.length;(!P||P<0)&&(P=0),(!V||V<0||V>he)&&(V=he);let _e="";for(let je=P;je<V;++je)_e+=Re[ie[je]];return _e}function J(ie,P,V){const he=ie.slice(P,V);let _e="";for(let je=0;je<he.length-1;je+=2)_e+=String.fromCharCode(he[je]+he[je+1]*256);return _e}p.prototype.slice=function(P,V){const he=this.length;P=~~P,V=V===void 0?he:~~V,P<0?(P+=he,P<0&&(P=0)):P>he&&(P=he),V<0?(V+=he,V<0&&(V=0)):V>he&&(V=he),V<P&&(V=P);const _e=this.subarray(P,V);return Object.setPrototypeOf(_e,p.prototype),_e};function L(ie,P,V){if(ie%1!==0||ie<0)throw new RangeError("offset is not uint");if(ie+P>V)throw new RangeError("Trying to access beyond buffer length")}p.prototype.readUintLE=p.prototype.readUIntLE=function(P,V,he){P=P>>>0,V=V>>>0,he||L(P,V,this.length);let _e=this[P],je=1,Ie=0;for(;++Ie<V&&(je*=256);)_e+=this[P+Ie]*je;return _e},p.prototype.readUintBE=p.prototype.readUIntBE=function(P,V,he){P=P>>>0,V=V>>>0,he||L(P,V,this.length);let _e=this[P+--V],je=1;for(;V>0&&(je*=256);)_e+=this[P+--V]*je;return _e},p.prototype.readUint8=p.prototype.readUInt8=function(P,V){return P=P>>>0,V||L(P,1,this.length),this[P]},p.prototype.readUint16LE=p.prototype.readUInt16LE=function(P,V){return P=P>>>0,V||L(P,2,this.length),this[P]|this[P+1]<<8},p.prototype.readUint16BE=p.prototype.readUInt16BE=function(P,V){return P=P>>>0,V||L(P,2,this.length),this[P]<<8|this[P+1]},p.prototype.readUint32LE=p.prototype.readUInt32LE=function(P,V){return P=P>>>0,V||L(P,4,this.length),(this[P]|this[P+1]<<8|this[P+2]<<16)+this[P+3]*16777216},p.prototype.readUint32BE=p.prototype.readUInt32BE=function(P,V){return P=P>>>0,V||L(P,4,this.length),this[P]*16777216+(this[P+1]<<16|this[P+2]<<8|this[P+3])},p.prototype.readBigUInt64LE=ye(function(P){P=P>>>0,Ce(P,"offset");const V=this[P],he=this[P+7];(V===void 0||he===void 0)&&Se(P,this.length-8);const _e=V+this[++P]*2**8+this[++P]*2**16+this[++P]*2**24,je=this[++P]+this[++P]*2**8+this[++P]*2**16+he*2**24;return BigInt(_e)+(BigInt(je)<<BigInt(32))}),p.prototype.readBigUInt64BE=ye(function(P){P=P>>>0,Ce(P,"offset");const V=this[P],he=this[P+7];(V===void 0||he===void 0)&&Se(P,this.length-8);const _e=V*2**24+this[++P]*2**16+this[++P]*2**8+this[++P],je=this[++P]*2**24+this[++P]*2**16+this[++P]*2**8+he;return(BigInt(_e)<<BigInt(32))+BigInt(je)}),p.prototype.readIntLE=function(P,V,he){P=P>>>0,V=V>>>0,he||L(P,V,this.length);let _e=this[P],je=1,Ie=0;for(;++Ie<V&&(je*=256);)_e+=this[P+Ie]*je;return je*=128,_e>=je&&(_e-=Math.pow(2,8*V)),_e},p.prototype.readIntBE=function(P,V,he){P=P>>>0,V=V>>>0,he||L(P,V,this.length);let _e=V,je=1,Ie=this[P+--_e];for(;_e>0&&(je*=256);)Ie+=this[P+--_e]*je;return je*=128,Ie>=je&&(Ie-=Math.pow(2,8*V)),Ie},p.prototype.readInt8=function(P,V){return P=P>>>0,V||L(P,1,this.length),this[P]&128?(255-this[P]+1)*-1:this[P]},p.prototype.readInt16LE=function(P,V){P=P>>>0,V||L(P,2,this.length);const he=this[P]|this[P+1]<<8;return he&32768?he|4294901760:he},p.prototype.readInt16BE=function(P,V){P=P>>>0,V||L(P,2,this.length);const he=this[P+1]|this[P]<<8;return he&32768?he|4294901760:he},p.prototype.readInt32LE=function(P,V){return P=P>>>0,V||L(P,4,this.length),this[P]|this[P+1]<<8|this[P+2]<<16|this[P+3]<<24},p.prototype.readInt32BE=function(P,V){return P=P>>>0,V||L(P,4,this.length),this[P]<<24|this[P+1]<<16|this[P+2]<<8|this[P+3]},p.prototype.readBigInt64LE=ye(function(P){P=P>>>0,Ce(P,"offset");const V=this[P],he=this[P+7];(V===void 0||he===void 0)&&Se(P,this.length-8);const _e=this[P+4]+this[P+5]*2**8+this[P+6]*2**16+(he<<24);return(BigInt(_e)<<BigInt(32))+BigInt(V+this[++P]*2**8+this[++P]*2**16+this[++P]*2**24)}),p.prototype.readBigInt64BE=ye(function(P){P=P>>>0,Ce(P,"offset");const V=this[P],he=this[P+7];(V===void 0||he===void 0)&&Se(P,this.length-8);const _e=(V<<24)+this[++P]*2**16+this[++P]*2**8+this[++P];return(BigInt(_e)<<BigInt(32))+BigInt(this[++P]*2**24+this[++P]*2**16+this[++P]*2**8+he)}),p.prototype.readFloatLE=function(P,V){return P=P>>>0,V||L(P,4,this.length),r.read(this,P,!0,23,4)},p.prototype.readFloatBE=function(P,V){return P=P>>>0,V||L(P,4,this.length),r.read(this,P,!1,23,4)},p.prototype.readDoubleLE=function(P,V){return P=P>>>0,V||L(P,8,this.length),r.read(this,P,!0,52,8)},p.prototype.readDoubleBE=function(P,V){return P=P>>>0,V||L(P,8,this.length),r.read(this,P,!1,52,8)};function Z(ie,P,V,he,_e,je){if(!p.isBuffer(ie))throw new TypeError('"buffer" argument must be a Buffer instance');if(P>_e||P<je)throw new RangeError('"value" argument is out of bounds');if(V+he>ie.length)throw new RangeError("Index out of range")}p.prototype.writeUintLE=p.prototype.writeUIntLE=function(P,V,he,_e){if(P=+P,V=V>>>0,he=he>>>0,!_e){const Ze=Math.pow(2,8*he)-1;Z(this,P,V,he,Ze,0)}let je=1,Ie=0;for(this[V]=P&255;++Ie<he&&(je*=256);)this[V+Ie]=P/je&255;return V+he},p.prototype.writeUintBE=p.prototype.writeUIntBE=function(P,V,he,_e){if(P=+P,V=V>>>0,he=he>>>0,!_e){const Ze=Math.pow(2,8*he)-1;Z(this,P,V,he,Ze,0)}let je=he-1,Ie=1;for(this[V+je]=P&255;--je>=0&&(Ie*=256);)this[V+je]=P/Ie&255;return V+he},p.prototype.writeUint8=p.prototype.writeUInt8=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,1,255,0),this[V]=P&255,V+1},p.prototype.writeUint16LE=p.prototype.writeUInt16LE=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,2,65535,0),this[V]=P&255,this[V+1]=P>>>8,V+2},p.prototype.writeUint16BE=p.prototype.writeUInt16BE=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,2,65535,0),this[V]=P>>>8,this[V+1]=P&255,V+2},p.prototype.writeUint32LE=p.prototype.writeUInt32LE=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,4,4294967295,0),this[V+3]=P>>>24,this[V+2]=P>>>16,this[V+1]=P>>>8,this[V]=P&255,V+4},p.prototype.writeUint32BE=p.prototype.writeUInt32BE=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,4,4294967295,0),this[V]=P>>>24,this[V+1]=P>>>16,this[V+2]=P>>>8,this[V+3]=P&255,V+4};function oe(ie,P,V,he,_e){Be(P,he,_e,ie,V,7);let je=Number(P&BigInt(4294967295));ie[V++]=je,je=je>>8,ie[V++]=je,je=je>>8,ie[V++]=je,je=je>>8,ie[V++]=je;let Ie=Number(P>>BigInt(32)&BigInt(4294967295));return ie[V++]=Ie,Ie=Ie>>8,ie[V++]=Ie,Ie=Ie>>8,ie[V++]=Ie,Ie=Ie>>8,ie[V++]=Ie,V}function ce(ie,P,V,he,_e){Be(P,he,_e,ie,V,7);let je=Number(P&BigInt(4294967295));ie[V+7]=je,je=je>>8,ie[V+6]=je,je=je>>8,ie[V+5]=je,je=je>>8,ie[V+4]=je;let Ie=Number(P>>BigInt(32)&BigInt(4294967295));return ie[V+3]=Ie,Ie=Ie>>8,ie[V+2]=Ie,Ie=Ie>>8,ie[V+1]=Ie,Ie=Ie>>8,ie[V]=Ie,V+8}p.prototype.writeBigUInt64LE=ye(function(P,V=0){return oe(this,P,V,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeBigUInt64BE=ye(function(P,V=0){return ce(this,P,V,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeIntLE=function(P,V,he,_e){if(P=+P,V=V>>>0,!_e){const et=Math.pow(2,8*he-1);Z(this,P,V,he,et-1,-et)}let je=0,Ie=1,Ze=0;for(this[V]=P&255;++je<he&&(Ie*=256);)P<0&&Ze===0&&this[V+je-1]!==0&&(Ze=1),this[V+je]=(P/Ie>>0)-Ze&255;return V+he},p.prototype.writeIntBE=function(P,V,he,_e){if(P=+P,V=V>>>0,!_e){const et=Math.pow(2,8*he-1);Z(this,P,V,he,et-1,-et)}let je=he-1,Ie=1,Ze=0;for(this[V+je]=P&255;--je>=0&&(Ie*=256);)P<0&&Ze===0&&this[V+je+1]!==0&&(Ze=1),this[V+je]=(P/Ie>>0)-Ze&255;return V+he},p.prototype.writeInt8=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,1,127,-128),P<0&&(P=255+P+1),this[V]=P&255,V+1},p.prototype.writeInt16LE=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,2,32767,-32768),this[V]=P&255,this[V+1]=P>>>8,V+2},p.prototype.writeInt16BE=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,2,32767,-32768),this[V]=P>>>8,this[V+1]=P&255,V+2},p.prototype.writeInt32LE=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,4,2147483647,-2147483648),this[V]=P&255,this[V+1]=P>>>8,this[V+2]=P>>>16,this[V+3]=P>>>24,V+4},p.prototype.writeInt32BE=function(P,V,he){return P=+P,V=V>>>0,he||Z(this,P,V,4,2147483647,-2147483648),P<0&&(P=4294967295+P+1),this[V]=P>>>24,this[V+1]=P>>>16,this[V+2]=P>>>8,this[V+3]=P&255,V+4},p.prototype.writeBigInt64LE=ye(function(P,V=0){return oe(this,P,V,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),p.prototype.writeBigInt64BE=ye(function(P,V=0){return ce(this,P,V,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function de(ie,P,V,he,_e,je){if(V+he>ie.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("Index out of range")}function xe(ie,P,V,he,_e){return P=+P,V=V>>>0,_e||de(ie,P,V,4),r.write(ie,P,V,he,23,4),V+4}p.prototype.writeFloatLE=function(P,V,he){return xe(this,P,V,!0,he)},p.prototype.writeFloatBE=function(P,V,he){return xe(this,P,V,!1,he)};function te(ie,P,V,he,_e){return P=+P,V=V>>>0,_e||de(ie,P,V,8),r.write(ie,P,V,he,52,8),V+8}p.prototype.writeDoubleLE=function(P,V,he){return te(this,P,V,!0,he)},p.prototype.writeDoubleBE=function(P,V,he){return te(this,P,V,!1,he)},p.prototype.copy=function(P,V,he,_e){if(!p.isBuffer(P))throw new TypeError("argument should be a Buffer");if(he||(he=0),!_e&&_e!==0&&(_e=this.length),V>=P.length&&(V=P.length),V||(V=0),_e>0&&_e<he&&(_e=he),_e===he||P.length===0||this.length===0)return 0;if(V<0)throw new RangeError("targetStart out of bounds");if(he<0||he>=this.length)throw new RangeError("Index out of range");if(_e<0)throw new RangeError("sourceEnd out of bounds");_e>this.length&&(_e=this.length),P.length-V<_e-he&&(_e=P.length-V+he);const je=_e-he;return this===P&&typeof a.prototype.copyWithin=="function"?this.copyWithin(V,he,_e):a.prototype.set.call(P,this.subarray(he,_e),V),je},p.prototype.fill=function(P,V,he,_e){if(typeof P=="string"){if(typeof V=="string"?(_e=V,V=0,he=this.length):typeof he=="string"&&(_e=he,he=this.length),_e!==void 0&&typeof _e!="string")throw new TypeError("encoding must be a string");if(typeof _e=="string"&&!p.isEncoding(_e))throw new TypeError("Unknown encoding: "+_e);if(P.length===1){const Ie=P.charCodeAt(0);(_e==="utf8"&&Ie<128||_e==="latin1")&&(P=Ie)}}else typeof P=="number"?P=P&255:typeof P=="boolean"&&(P=Number(P));if(V<0||this.length<V||this.length<he)throw new RangeError("Out of range index");if(he<=V)return this;V=V>>>0,he=he===void 0?this.length:he>>>0,P||(P=0);let je;if(typeof P=="number")for(je=V;je<he;++je)this[je]=P;else{const Ie=p.isBuffer(P)?P:p.from(P,_e),Ze=Ie.length;if(Ze===0)throw new TypeError('The value "'+P+'" is invalid for argument "value"');for(je=0;je<he-V;++je)this[je+V]=Ie[je%Ze]}return this};const ae={};function le(ie,P,V){ae[ie]=class extends V{constructor(){super(),Object.defineProperty(this,"message",{value:P.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ie}]`,this.stack,delete this.name}get code(){return ie}set code(_e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:_e,writable:!0})}toString(){return`${this.name} [${ie}]: ${this.message}`}}}le("ERR_BUFFER_OUT_OF_BOUNDS",function(ie){return ie?`${ie} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),le("ERR_INVALID_ARG_TYPE",function(ie,P){return`The "${ie}" argument must be of type number. Received type ${typeof P}`},TypeError),le("ERR_OUT_OF_RANGE",function(ie,P,V){let he=`The value of "${ie}" is out of range.`,_e=V;return Number.isInteger(V)&&Math.abs(V)>2**32?_e=ue(String(V)):typeof V=="bigint"&&(_e=String(V),(V>BigInt(2)**BigInt(32)||V<-(BigInt(2)**BigInt(32)))&&(_e=ue(_e)),_e+="n"),he+=` It must be ${P}. Received ${_e}`,he},RangeError);function ue(ie){let P="",V=ie.length;const he=ie[0]==="-"?1:0;for(;V>=he+4;V-=3)P=`_${ie.slice(V-3,V)}${P}`;return`${ie.slice(0,V)}${P}`}function be(ie,P,V){Ce(P,"offset"),(ie[P]===void 0||ie[P+V]===void 0)&&Se(P,ie.length-(V+1))}function Be(ie,P,V,he,_e,je){if(ie>V||ie<P){const Ie=typeof P=="bigint"?"n":"";let Ze;throw P===0||P===BigInt(0)?Ze=`>= 0${Ie} and < 2${Ie} ** ${(je+1)*8}${Ie}`:Ze=`>= -(2${Ie} ** ${(je+1)*8-1}${Ie}) and < 2 ** ${(je+1)*8-1}${Ie}`,new ae.ERR_OUT_OF_RANGE("value",Ze,ie)}be(he,_e,je)}function Ce(ie,P){if(typeof ie!="number")throw new ae.ERR_INVALID_ARG_TYPE(P,"number",ie)}function Se(ie,P,V){throw Math.floor(ie)!==ie?(Ce(ie,V),new ae.ERR_OUT_OF_RANGE("offset","an integer",ie)):P<0?new ae.ERR_BUFFER_OUT_OF_BOUNDS:new ae.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${P}`,ie)}const ke=/[^+/0-9A-Za-z-_]/g;function we(ie){if(ie=ie.split("=")[0],ie=ie.trim().replace(ke,""),ie.length<2)return"";for(;ie.length%4!==0;)ie=ie+"=";return ie}function Fe(ie,P){P=P||1/0;let V;const he=ie.length;let _e=null;const je=[];for(let Ie=0;Ie<he;++Ie){if(V=ie.charCodeAt(Ie),V>55295&&V<57344){if(!_e){if(V>56319){(P-=3)>-1&&je.push(239,191,189);continue}else if(Ie+1===he){(P-=3)>-1&&je.push(239,191,189);continue}_e=V;continue}if(V<56320){(P-=3)>-1&&je.push(239,191,189),_e=V;continue}V=(_e-55296<<10|V-56320)+65536}else _e&&(P-=3)>-1&&je.push(239,191,189);if(_e=null,V<128){if((P-=1)<0)break;je.push(V)}else if(V<2048){if((P-=2)<0)break;je.push(V>>6|192,V&63|128)}else if(V<65536){if((P-=3)<0)break;je.push(V>>12|224,V>>6&63|128,V&63|128)}else if(V<1114112){if((P-=4)<0)break;je.push(V>>18|240,V>>12&63|128,V>>6&63|128,V&63|128)}else throw new Error("Invalid code point")}return je}function Pe(ie){const P=[];for(let V=0;V<ie.length;++V)P.push(ie.charCodeAt(V)&255);return P}function Ye(ie,P){let V,he,_e;const je=[];for(let Ie=0;Ie<ie.length&&!((P-=2)<0);++Ie)V=ie.charCodeAt(Ie),he=V>>8,_e=V%256,je.push(_e),je.push(he);return je}function Ve(ie){return t.toByteArray(we(ie))}function Ee(ie,P,V,he){let _e;for(_e=0;_e<he&&!(_e+V>=P.length||_e>=ie.length);++_e)P[_e+V]=ie[_e];return _e}function ve(ie,P){return ie instanceof P||ie!=null&&ie.constructor!=null&&ie.constructor.name!=null&&ie.constructor.name===P.name}function Te(ie){return ie!==ie}const Re=(function(){const ie="0123456789abcdef",P=new Array(256);for(let V=0;V<16;++V){const he=V*16;for(let _e=0;_e<16;++_e)P[he+_e]=ie[V]+ie[_e]}return P})();function ye(ie){return typeof BigInt>"u"?Ne:ie}function Ne(){throw new Error("BigInt not supported")}})(buffer);const Buffer=buffer.Buffer,Buffer$1=buffer.Buffer;globalThis.Buffer=Buffer$1;var client={exports:{}};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var browser$2={exports:{}},process=browser$2.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?cachedSetTimeout=setTimeout:cachedSetTimeout=defaultSetTimout}catch{cachedSetTimeout=defaultSetTimout}try{typeof clearTimeout=="function"?cachedClearTimeout=clearTimeout:cachedClearTimeout=defaultClearTimeout}catch{cachedClearTimeout=defaultClearTimeout}})();function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch{try{return cachedSetTimeout.call(null,e,0)}catch{return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch{try{return cachedClearTimeout.call(null,e)}catch{return cachedClearTimeout.call(this,e)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),queue.length===1&&!draining&&runTimeout(drainQueue)};function Item(e,t){this.fun=e,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=!0;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(e){return[]};process.binding=function(e){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(e){throw new Error("process.chdir is not supported")};process.umask=function(){return 0};var browserExports$2=browser$2.exports;const process$1=getDefaultExportFromCjs(browserExports$2);var reactDomClient_production={},scheduler={exports:{}},scheduler_production={};var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(e){function t(M,q){var K=M.length;M.push(q);e:for(;0<K;){var H=K-1>>>1,Q=M[H];if(0<o(Q,q))M[H]=q,M[K]=Q,K=H;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var q=M[0],K=M.pop();if(K!==q){M[0]=K;e:for(var H=0,Q=M.length,D=Q>>>1;H<D;){var Y=2*(H+1)-1,J=M[Y],L=Y+1,Z=M[L];if(0>o(J,K))L<Q&&0>o(Z,J)?(M[H]=Z,M[L]=K,H=L):(M[H]=J,M[Y]=K,H=Y);else if(L<Q&&0>o(Z,K))M[H]=Z,M[L]=K,H=L;else break e}}return q}function o(M,q){var K=M.sortIndex-q.sortIndex;return K!==0?K:M.id-q.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var f=[],x=[],p=1,g=null,y=3,b=!1,w=!1,v=!1,B=!1,j=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function N(M){for(var q=r(x);q!==null;){if(q.callback===null)n(x);else if(q.startTime<=M)n(x),q.sortIndex=q.expirationTime,t(f,q);else break;q=r(x)}}function T(M){if(v=!1,N(M),!w)if(r(f)!==null)w=!0,_||(_=!0,U());else{var q=r(x);q!==null&&k(T,q.startTime-M)}}var _=!1,S=-1,O=5,$=-1;function z(){return B?!0:!(e.unstable_now()-$<O)}function W(){if(B=!1,_){var M=e.unstable_now();$=M;var q=!0;try{e:{w=!1,v&&(v=!1,F(S),S=-1),b=!0;var K=y;try{t:{for(N(M),g=r(f);g!==null&&!(g.expirationTime>M&&z());){var H=g.callback;if(typeof H=="function"){g.callback=null,y=g.priorityLevel;var Q=H(g.expirationTime<=M);if(M=e.unstable_now(),typeof Q=="function"){g.callback=Q,N(M),q=!0;break t}g===r(f)&&n(f),N(M)}else n(f);g=r(f)}if(g!==null)q=!0;else{var D=r(x);D!==null&&k(T,D.startTime-M),q=!1}}break e}finally{g=null,y=K,b=!1}q=void 0}}finally{q?U():_=!1}}}var U;if(typeof C=="function")U=function(){C(W)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,G=I.port2;I.port1.onmessage=W,U=function(){G.postMessage(null)}}else U=function(){j(W,0)};function k(M,q){S=j(function(){M(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(M){switch(y){case 1:case 2:case 3:var q=3;break;default:q=y}var K=y;y=q;try{return M()}finally{y=K}},e.unstable_requestPaint=function(){B=!0},e.unstable_runWithPriority=function(M,q){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var K=y;y=M;try{return q()}finally{y=K}},e.unstable_scheduleCallback=function(M,q,K){var H=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?H+K:H):K=H,M){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=K+Q,M={id:p++,callback:q,priorityLevel:M,startTime:K,expirationTime:Q,sortIndex:-1},K>H?(M.sortIndex=K,t(x,M),r(f)===null&&M===r(x)&&(v?(F(S),S=-1):v=!0,k(T,K-H))):(M.sortIndex=Q,t(f,M),w||b||(w=!0,_||(_=!0,U()))),M},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(M){var q=y;return function(){var K=y;y=q;try{return M.apply(this,arguments)}finally{y=K}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var react={exports:{}},react_production={},hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),y=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=y&&D[y]||D["@@iterator"],typeof D=="function"?D:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,B={};function j(D,Y,J){this.props=D,this.context=Y,this.refs=B,this.updater=J||w}j.prototype.isReactComponent={},j.prototype.setState=function(D,Y){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,Y,"setState")},j.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function F(){}F.prototype=j.prototype;function C(D,Y,J){this.props=D,this.context=Y,this.refs=B,this.updater=J||w}var N=C.prototype=new F;N.constructor=C,v(N,j.prototype),N.isPureReactComponent=!0;var T=Array.isArray;function _(){}var S={H:null,A:null,T:null,S:null},O=Object.prototype.hasOwnProperty;function $(D,Y,J){var L=J.ref;return{$$typeof:e,type:D,key:Y,ref:L!==void 0?L:null,props:J}}function z(D,Y){return $(D.type,Y,D.props)}function W(D){return typeof D=="object"&&D!==null&&D.$$typeof===e}function U(D){var Y={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(J){return Y[J]})}var I=/\/+/g;function G(D,Y){return typeof D=="object"&&D!==null&&D.key!=null?U(""+D.key):Y.toString(36)}function k(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(_,_):(D.status="pending",D.then(function(Y){D.status==="pending"&&(D.status="fulfilled",D.value=Y)},function(Y){D.status==="pending"&&(D.status="rejected",D.reason=Y)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function M(D,Y,J,L,Z){var oe=typeof D;(oe==="undefined"||oe==="boolean")&&(D=null);var ce=!1;if(D===null)ce=!0;else switch(oe){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(D.$$typeof){case e:case t:ce=!0;break;case p:return ce=D._init,M(ce(D._payload),Y,J,L,Z)}}if(ce)return Z=Z(D),ce=L===""?"."+G(D,0):L,T(Z)?(J="",ce!=null&&(J=ce.replace(I,"$&/")+"/"),M(Z,Y,J,"",function(te){return te})):Z!=null&&(W(Z)&&(Z=z(Z,J+(Z.key==null||D&&D.key===Z.key?"":(""+Z.key).replace(I,"$&/")+"/")+ce)),Y.push(Z)),1;ce=0;var de=L===""?".":L+":";if(T(D))for(var xe=0;xe<D.length;xe++)L=D[xe],oe=de+G(L,xe),ce+=M(L,Y,J,oe,Z);else if(xe=b(D),typeof xe=="function")for(D=xe.call(D),xe=0;!(L=D.next()).done;)L=L.value,oe=de+G(L,xe++),ce+=M(L,Y,J,oe,Z);else if(oe==="object"){if(typeof D.then=="function")return M(k(D),Y,J,L,Z);throw Y=String(D),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return ce}function q(D,Y,J){if(D==null)return D;var L=[],Z=0;return M(D,L,"","",function(oe){return Y.call(J,oe,Z++)}),L}function K(D){if(D._status===-1){var Y=D._result;Y=Y(),Y.then(function(J){(D._status===0||D._status===-1)&&(D._status=1,D._result=J)},function(J){(D._status===0||D._status===-1)&&(D._status=2,D._result=J)}),D._status===-1&&(D._status=0,D._result=Y)}if(D._status===1)return D._result.default;throw D._result}var H=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(Y))return}else if(typeof process$1=="object"&&typeof process$1.emit=="function"){process$1.emit("uncaughtException",D);return}console.error(D)},Q={map:q,forEach:function(D,Y,J){q(D,function(){Y.apply(this,arguments)},J)},count:function(D){var Y=0;return q(D,function(){Y++}),Y},toArray:function(D){return q(D,function(Y){return Y})||[]},only:function(D){if(!W(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return react_production.Activity=g,react_production.Children=Q,react_production.Component=j,react_production.Fragment=r,react_production.Profiler=o,react_production.PureComponent=C,react_production.StrictMode=n,react_production.Suspense=f,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(D){return S.H.useMemoCache(D)}},react_production.cache=function(D){return function(){return D.apply(null,arguments)}},react_production.cacheSignal=function(){return null},react_production.cloneElement=function(D,Y,J){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var L=v({},D.props),Z=D.key;if(Y!=null)for(oe in Y.key!==void 0&&(Z=""+Y.key),Y)!O.call(Y,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&Y.ref===void 0||(L[oe]=Y[oe]);var oe=arguments.length-2;if(oe===1)L.children=J;else if(1<oe){for(var ce=Array(oe),de=0;de<oe;de++)ce[de]=arguments[de+2];L.children=ce}return $(D.type,Z,L)},react_production.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:a,_context:D},D},react_production.createElement=function(D,Y,J){var L,Z={},oe=null;if(Y!=null)for(L in Y.key!==void 0&&(oe=""+Y.key),Y)O.call(Y,L)&&L!=="key"&&L!=="__self"&&L!=="__source"&&(Z[L]=Y[L]);var ce=arguments.length-2;if(ce===1)Z.children=J;else if(1<ce){for(var de=Array(ce),xe=0;xe<ce;xe++)de[xe]=arguments[xe+2];Z.children=de}if(D&&D.defaultProps)for(L in ce=D.defaultProps,ce)Z[L]===void 0&&(Z[L]=ce[L]);return $(D,oe,Z)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(D){return{$$typeof:u,render:D}},react_production.isValidElement=W,react_production.lazy=function(D){return{$$typeof:p,_payload:{_status:-1,_result:D},_init:K}},react_production.memo=function(D,Y){return{$$typeof:x,type:D,compare:Y===void 0?null:Y}},react_production.startTransition=function(D){var Y=S.T,J={};S.T=J;try{var L=D(),Z=S.S;Z!==null&&Z(J,L),typeof L=="object"&&L!==null&&typeof L.then=="function"&&L.then(_,H)}catch(oe){H(oe)}finally{Y!==null&&J.types!==null&&(Y.types=J.types),S.T=Y}},react_production.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},react_production.use=function(D){return S.H.use(D)},react_production.useActionState=function(D,Y,J){return S.H.useActionState(D,Y,J)},react_production.useCallback=function(D,Y){return S.H.useCallback(D,Y)},react_production.useContext=function(D){return S.H.useContext(D)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(D,Y){return S.H.useDeferredValue(D,Y)},react_production.useEffect=function(D,Y){return S.H.useEffect(D,Y)},react_production.useEffectEvent=function(D){return S.H.useEffectEvent(D)},react_production.useId=function(){return S.H.useId()},react_production.useImperativeHandle=function(D,Y,J){return S.H.useImperativeHandle(D,Y,J)},react_production.useInsertionEffect=function(D,Y){return S.H.useInsertionEffect(D,Y)},react_production.useLayoutEffect=function(D,Y){return S.H.useLayoutEffect(D,Y)},react_production.useMemo=function(D,Y){return S.H.useMemo(D,Y)},react_production.useOptimistic=function(D,Y){return S.H.useOptimistic(D,Y)},react_production.useReducer=function(D,Y,J){return S.H.useReducer(D,Y,J)},react_production.useRef=function(D){return S.H.useRef(D)},react_production.useState=function(D){return S.H.useState(D)},react_production.useSyncExternalStore=function(D,Y,J){return S.H.useSyncExternalStore(D,Y,J)},react_production.useTransition=function(){return S.H.useTransition()},react_production.version="19.2.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactDom={exports:{}},reactDom_production={};var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var e=requireReact();function t(f){var x="https://react.dev/errors/"+f;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)x+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},o=Symbol.for("react.portal");function a(f,x,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:g==null?null:""+g,children:f,containerInfo:x,implementation:p}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,x){if(f==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,reactDom_production.createPortal=function(f,x){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(t(299));return a(f,x,null,p)},reactDom_production.flushSync=function(f){var x=l.T,p=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=x,n.p=p,n.d.f()}},reactDom_production.preconnect=function(f,x){typeof f=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,n.d.C(f,x))},reactDom_production.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},reactDom_production.preinit=function(f,x){if(typeof f=="string"&&x&&typeof x.as=="string"){var p=x.as,g=u(p,x.crossOrigin),y=typeof x.integrity=="string"?x.integrity:void 0,b=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;p==="style"?n.d.S(f,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:b}):p==="script"&&n.d.X(f,{crossOrigin:g,integrity:y,fetchPriority:b,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},reactDom_production.preinitModule=function(f,x){if(typeof f=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var p=u(x.as,x.crossOrigin);n.d.M(f,{crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&n.d.M(f)},reactDom_production.preload=function(f,x){if(typeof f=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var p=x.as,g=u(p,x.crossOrigin);n.d.L(f,p,{crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},reactDom_production.preloadModule=function(f,x){if(typeof f=="string")if(x){var p=u(x.as,x.crossOrigin);n.d.m(f,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else n.d.m(f)},reactDom_production.requestFormReset=function(f){n.d.r(f)},reactDom_production.unstable_batchedUpdates=function(f,x){return f(x)},reactDom_production.useFormState=function(f,x,p){return l.H.useFormState(f,x,p)},reactDom_production.useFormStatus=function(){return l.H.useHostTransitionStatus()},reactDom_production.version="19.2.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),reactDom.exports=requireReactDom_production(),reactDom.exports}var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var e=requireScheduler(),t=requireReact(),r=requireReactDom();function n(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)c+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var c=s,m=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(m=c.return),s=c.return;while(s)}return c.tag===3?m:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function u(s){if(s.tag===31){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function f(s){if(a(s)!==s)throw Error(n(188))}function x(s){var c=s.alternate;if(!c){if(c=a(s),c===null)throw Error(n(188));return c!==s?null:s}for(var m=s,E=c;;){var A=m.return;if(A===null)break;var R=A.alternate;if(R===null){if(E=A.return,E!==null){m=E;continue}break}if(A.child===R.child){for(R=A.child;R;){if(R===m)return f(A),s;if(R===E)return f(A),c;R=R.sibling}throw Error(n(188))}if(m.return!==E.return)m=A,E=R;else{for(var se=!1,pe=A.child;pe;){if(pe===m){se=!0,m=A,E=R;break}if(pe===E){se=!0,E=A,m=R;break}pe=pe.sibling}if(!se){for(pe=R.child;pe;){if(pe===m){se=!0,m=R,E=A;break}if(pe===E){se=!0,E=R,m=A;break}pe=pe.sibling}if(!se)throw Error(n(189))}}if(m.alternate!==E)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?s:c}function p(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=p(s),c!==null)return c;s=s.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),C=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=W&&s[W]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function G(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case v:return"Fragment";case j:return"Profiler";case B:return"StrictMode";case T:return"Suspense";case _:return"SuspenseList";case $:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case C:return s.displayName||"Context";case F:return(s._context.displayName||"Context")+".Consumer";case N:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case S:return c=s.displayName||null,c!==null?c:G(s.type)||"Memo";case O:c=s._payload,s=s._init;try{return G(s(c))}catch{}}return null}var k=Array.isArray,M=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},H=[],Q=-1;function D(s){return{current:s}}function Y(s){0>Q||(s.current=H[Q],H[Q]=null,Q--)}function J(s,c){Q++,H[Q]=s.current,s.current=c}var L=D(null),Z=D(null),oe=D(null),ce=D(null);function de(s,c){switch(J(oe,c),J(Z,s),J(L,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?ex(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=ex(c),s=tx(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Y(L),J(L,s)}function xe(){Y(L),Y(Z),Y(oe)}function te(s){s.memoizedState!==null&&J(ce,s);var c=L.current,m=tx(c,s.type);c!==m&&(J(Z,s),J(L,m))}function ae(s){Z.current===s&&(Y(L),Y(Z)),ce.current===s&&(Y(ce),ls._currentValue=K)}var le,ue;function be(s){if(le===void 0)try{throw Error()}catch(m){var c=m.stack.trim().match(/\n( *(at )?)/);le=c&&c[1]||"",ue=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+le+s+ue}var Be=!1;function Ce(s,c){if(!s||Be)return"";Be=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var E={DetermineComponentFrameRoot:function(){try{if(c){var Xe=function(){throw Error()};if(Object.defineProperty(Xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Xe,[])}catch(Ke){var He=Ke}Reflect.construct(s,[],Xe)}else{try{Xe.call()}catch(Ke){He=Ke}s.call(Xe.prototype)}}else{try{throw Error()}catch(Ke){He=Ke}(Xe=s())&&typeof Xe.catch=="function"&&Xe.catch(function(){})}}catch(Ke){if(Ke&&He&&typeof Ke.stack=="string")return[Ke.stack,He.stack]}return[null,null]}};E.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(E.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(E.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var R=E.DetermineComponentFrameRoot(),se=R[0],pe=R[1];if(se&&pe){var De=se.split(`
`),Le=pe.split(`
`);for(A=E=0;E<De.length&&!De[E].includes("DetermineComponentFrameRoot");)E++;for(;A<Le.length&&!Le[A].includes("DetermineComponentFrameRoot");)A++;if(E===De.length||A===Le.length)for(E=De.length-1,A=Le.length-1;1<=E&&0<=A&&De[E]!==Le[A];)A--;for(;1<=E&&0<=A;E--,A--)if(De[E]!==Le[A]){if(E!==1||A!==1)do if(E--,A--,0>A||De[E]!==Le[A]){var ze=`
`+De[E].replace(" at new "," at ");return s.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",s.displayName)),ze}while(1<=E&&0<=A);break}}}finally{Be=!1,Error.prepareStackTrace=m}return(m=s?s.displayName||s.name:"")?be(m):""}function Se(s,c){switch(s.tag){case 26:case 27:case 5:return be(s.type);case 16:return be("Lazy");case 13:return s.child!==c&&c!==null?be("Suspense Fallback"):be("Suspense");case 19:return be("SuspenseList");case 0:case 15:return Ce(s.type,!1);case 11:return Ce(s.type.render,!1);case 1:return Ce(s.type,!0);case 31:return be("Activity");default:return""}}function ke(s){try{var c="",m=null;do c+=Se(s,m),m=s,s=s.return;while(s);return c}catch(E){return`
Error generating stack: `+E.message+`
`+E.stack}}var we=Object.prototype.hasOwnProperty,Fe=e.unstable_scheduleCallback,Pe=e.unstable_cancelCallback,Ye=e.unstable_shouldYield,Ve=e.unstable_requestPaint,Ee=e.unstable_now,ve=e.unstable_getCurrentPriorityLevel,Te=e.unstable_ImmediatePriority,Re=e.unstable_UserBlockingPriority,ye=e.unstable_NormalPriority,Ne=e.unstable_LowPriority,ie=e.unstable_IdlePriority,P=e.log,V=e.unstable_setDisableYieldValue,he=null,_e=null;function je(s){if(typeof P=="function"&&V(s),_e&&typeof _e.setStrictMode=="function")try{_e.setStrictMode(he,s)}catch{}}var Ie=Math.clz32?Math.clz32:st,Ze=Math.log,et=Math.LN2;function st(s){return s>>>=0,s===0?32:31-(Ze(s)/et|0)|0}var rt=256,nt=262144,Yt=4194304;function $t(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function vr(s,c,m){var E=s.pendingLanes;if(E===0)return 0;var A=0,R=s.suspendedLanes,se=s.pingedLanes;s=s.warmLanes;var pe=E&134217727;return pe!==0?(E=pe&~R,E!==0?A=$t(E):(se&=pe,se!==0?A=$t(se):m||(m=pe&~s,m!==0&&(A=$t(m))))):(pe=E&~R,pe!==0?A=$t(pe):se!==0?A=$t(se):m||(m=E&~s,m!==0&&(A=$t(m)))),A===0?0:c!==0&&c!==A&&(c&R)===0&&(R=A&-A,m=c&-c,R>=m||R===32&&(m&4194048)!==0)?c:A}function En(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function _r(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ds(){var s=Yt;return Yt<<=1,(Yt&62914560)===0&&(Yt=4194304),s}function me(s){for(var c=[],m=0;31>m;m++)c.push(s);return c}function re(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ne(s,c,m,E,A,R){var se=s.pendingLanes;s.pendingLanes=m,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=m,s.entangledLanes&=m,s.errorRecoveryDisabledLanes&=m,s.shellSuspendCounter=0;var pe=s.entanglements,De=s.expirationTimes,Le=s.hiddenUpdates;for(m=se&~m;0<m;){var ze=31-Ie(m),Xe=1<<ze;pe[ze]=0,De[ze]=-1;var He=Le[ze];if(He!==null)for(Le[ze]=null,ze=0;ze<He.length;ze++){var Ke=He[ze];Ke!==null&&(Ke.lane&=-536870913)}m&=~Xe}E!==0&&Ae(s,E,0),R!==0&&A===0&&s.tag!==0&&(s.suspendedLanes|=R&~(se&~c))}function Ae(s,c,m){s.pendingLanes|=c,s.suspendedLanes&=~c;var E=31-Ie(c);s.entangledLanes|=c,s.entanglements[E]=s.entanglements[E]|1073741824|m&261930}function Oe(s,c){var m=s.entangledLanes|=c;for(s=s.entanglements;m;){var E=31-Ie(m),A=1<<E;A&c|s[E]&c&&(s[E]|=c),m&=~A}}function qe(s,c){var m=c&-c;return m=(m&42)!==0?1:We(m),(m&(s.suspendedLanes|c))!==0?0:m}function We(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ct(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Rt(){var s=q.p;return s!==0?s:(s=window.event,s===void 0?32:Bx(s.type))}function _t(s,c){var m=q.p;try{return q.p=s,c()}finally{q.p=m}}var Et=Math.random().toString(36).slice(2),ot="__reactFiber$"+Et,Zt="__reactProps$"+Et,Pn="__reactContainer$"+Et,ko="__reactEvents$"+Et,ff="__reactListeners$"+Et,df="__reactHandles$"+Et,Lc="__reactResources$"+Et,Ai="__reactMarker$"+Et;function Fo(s){delete s[ot],delete s[Zt],delete s[ko],delete s[ff],delete s[df]}function Mn(s){var c=s[ot];if(c)return c;for(var m=s.parentNode;m;){if(c=m[Pn]||m[ot]){if(m=c.alternate,c.child!==null||m!==null&&m.child!==null)for(s=cx(s);s!==null;){if(m=s[ot])return m;s=cx(s)}return c}s=m,m=s.parentNode}return null}function Ln(s){if(s=s[ot]||s[Pn]){var c=s.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return s}return null}function Bi(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(n(33))}function Hn(s){var c=s[Lc];return c||(c=s[Lc]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function qt(s){s[Ai]=!0}var Hc=new Set,qc={};function bn(s,c){qn(s,c),qn(s+"Capture",c)}function qn(s,c){for(qc[s]=c,s=0;s<c.length;s++)Hc.add(c[s])}var hf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kc={},zc={};function pf(s){return we.call(zc,s)?!0:we.call(Kc,s)?!1:hf.test(s)?zc[s]=!0:(Kc[s]=!0,!1)}function hs(s,c,m){if(pf(c))if(m===null)s.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var E=c.toLowerCase().slice(0,5);if(E!=="data-"&&E!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+m)}}function ps(s,c,m){if(m===null)s.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+m)}}function Fr(s,c,m,E){if(E===null)s.removeAttribute(m);else{switch(typeof E){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(m);return}s.setAttributeNS(c,m,""+E)}}function fr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Vc(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function mf(s,c,m){var E=Object.getOwnPropertyDescriptor(s.constructor.prototype,c);if(!s.hasOwnProperty(c)&&typeof E<"u"&&typeof E.get=="function"&&typeof E.set=="function"){var A=E.get,R=E.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return A.call(this)},set:function(se){m=""+se,R.call(this,se)}}),Object.defineProperty(s,c,{enumerable:E.enumerable}),{getValue:function(){return m},setValue:function(se){m=""+se},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function No(s){if(!s._valueTracker){var c=Vc(s)?"checked":"value";s._valueTracker=mf(s,c,""+s[c])}}function Gc(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var m=c.getValue(),E="";return s&&(E=Vc(s)?s.checked?"true":"false":s.value),s=E,s!==m?(c.setValue(s),!0):!1}function gs(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var gf=/[\n"\\]/g;function dr(s){return s.replace(gf,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function To(s,c,m,E,A,R,se,pe){s.name="",se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"?s.type=se:s.removeAttribute("type"),c!=null?se==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+fr(c)):s.value!==""+fr(c)&&(s.value=""+fr(c)):se!=="submit"&&se!=="reset"||s.removeAttribute("value"),c!=null?jo(s,se,fr(c)):m!=null?jo(s,se,fr(m)):E!=null&&s.removeAttribute("value"),A==null&&R!=null&&(s.defaultChecked=!!R),A!=null&&(s.checked=A&&typeof A!="function"&&typeof A!="symbol"),pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"?s.name=""+fr(pe):s.removeAttribute("name")}function Wc(s,c,m,E,A,R,se,pe){if(R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(s.type=R),c!=null||m!=null){if(!(R!=="submit"&&R!=="reset"||c!=null)){No(s);return}m=m!=null?""+fr(m):"",c=c!=null?""+fr(c):m,pe||c===s.value||(s.value=c),s.defaultValue=c}E=E??A,E=typeof E!="function"&&typeof E!="symbol"&&!!E,s.checked=pe?s.checked:!!E,s.defaultChecked=!!E,se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"&&(s.name=se),No(s)}function jo(s,c,m){c==="number"&&gs(s.ownerDocument)===s||s.defaultValue===""+m||(s.defaultValue=""+m)}function Kn(s,c,m,E){if(s=s.options,c){c={};for(var A=0;A<m.length;A++)c["$"+m[A]]=!0;for(m=0;m<s.length;m++)A=c.hasOwnProperty("$"+s[m].value),s[m].selected!==A&&(s[m].selected=A),A&&E&&(s[m].defaultSelected=!0)}else{for(m=""+fr(m),c=null,A=0;A<s.length;A++){if(s[A].value===m){s[A].selected=!0,E&&(s[A].defaultSelected=!0);return}c!==null||s[A].disabled||(c=s[A])}c!==null&&(c.selected=!0)}}function Xc(s,c,m){if(c!=null&&(c=""+fr(c),c!==s.value&&(s.value=c),m==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=m!=null?""+fr(m):""}function Yc(s,c,m,E){if(c==null){if(E!=null){if(m!=null)throw Error(n(92));if(k(E)){if(1<E.length)throw Error(n(93));E=E[0]}m=E}m==null&&(m=""),c=m}m=fr(c),s.defaultValue=m,E=s.textContent,E===m&&E!==""&&E!==null&&(s.value=E),No(s)}function zn(s,c){if(c){var m=s.firstChild;if(m&&m===s.lastChild&&m.nodeType===3){m.nodeValue=c;return}}s.textContent=c}var yf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zc(s,c,m){var E=c.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?E?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":E?s.setProperty(c,m):typeof m!="number"||m===0||yf.has(c)?c==="float"?s.cssFloat=m:s[c]=(""+m).trim():s[c]=m+"px"}function Qc(s,c,m){if(c!=null&&typeof c!="object")throw Error(n(62));if(s=s.style,m!=null){for(var E in m)!m.hasOwnProperty(E)||c!=null&&c.hasOwnProperty(E)||(E.indexOf("--")===0?s.setProperty(E,""):E==="float"?s.cssFloat="":s[E]="");for(var A in c)E=c[A],c.hasOwnProperty(A)&&m[A]!==E&&Zc(s,A,E)}else for(var R in c)c.hasOwnProperty(R)&&Zc(s,R,c[R])}function $o(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ef=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),bf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ys(s){return bf.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Nr(){}var Io=null;function Oo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Vn=null,Gn=null;function Jc(s){var c=Ln(s);if(c&&(s=c.stateNode)){var m=s[Zt]||null;e:switch(s=c.stateNode,c.type){case"input":if(To(s,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),c=m.name,m.type==="radio"&&c!=null){for(m=s;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+dr(""+c)+'"][type="radio"]'),c=0;c<m.length;c++){var E=m[c];if(E!==s&&E.form===s.form){var A=E[Zt]||null;if(!A)throw Error(n(90));To(E,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(c=0;c<m.length;c++)E=m[c],E.form===s.form&&Gc(E)}break e;case"textarea":Xc(s,m.value,m.defaultValue);break e;case"select":c=m.value,c!=null&&Kn(s,!!m.multiple,c,!1)}}}var Uo=!1;function e0(s,c,m){if(Uo)return s(c,m);Uo=!0;try{var E=s(c);return E}finally{if(Uo=!1,(Vn!==null||Gn!==null)&&(so(),Vn&&(c=Vn,s=Gn,Gn=Vn=null,Jc(c),s)))for(c=0;c<s.length;c++)Jc(s[c])}}function Ci(s,c){var m=s.stateNode;if(m===null)return null;var E=m[Zt]||null;if(E===null)return null;m=E[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(s=s.type,E=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!E;break e;default:s=!1}if(s)return null;if(m&&typeof m!="function")throw Error(n(231,c,typeof m));return m}var Tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Po=!1;if(Tr)try{var _i={};Object.defineProperty(_i,"passive",{get:function(){Po=!0}}),window.addEventListener("test",_i,_i),window.removeEventListener("test",_i,_i)}catch{Po=!1}var Xr=null,Mo=null,Es=null;function t0(){if(Es)return Es;var s,c=Mo,m=c.length,E,A="value"in Xr?Xr.value:Xr.textContent,R=A.length;for(s=0;s<m&&c[s]===A[s];s++);var se=m-s;for(E=1;E<=se&&c[m-E]===A[R-E];E++);return Es=A.slice(s,1<E?1-E:void 0)}function bs(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function ws(){return!0}function r0(){return!1}function Qt(s){function c(m,E,A,R,se){this._reactName=m,this._targetInst=A,this.type=E,this.nativeEvent=R,this.target=se,this.currentTarget=null;for(var pe in s)s.hasOwnProperty(pe)&&(m=s[pe],this[pe]=m?m(R):R[pe]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?ws:r0,this.isPropagationStopped=r0,this}return g(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=ws)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=ws)},persist:function(){},isPersistent:ws}),c}var wn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vs=Qt(wn),Si=g({},wn,{view:0,detail:0}),wf=Qt(Si),Lo,Ho,Ri,As=g({},Si,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ko,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ri&&(Ri&&s.type==="mousemove"?(Lo=s.screenX-Ri.screenX,Ho=s.screenY-Ri.screenY):Ho=Lo=0,Ri=s),Lo)},movementY:function(s){return"movementY"in s?s.movementY:Ho}}),n0=Qt(As),vf=g({},As,{dataTransfer:0}),Af=Qt(vf),Bf=g({},Si,{relatedTarget:0}),qo=Qt(Bf),Cf=g({},wn,{animationName:0,elapsedTime:0,pseudoElement:0}),_f=Qt(Cf),Sf=g({},wn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Rf=Qt(Sf),Df=g({},wn,{data:0}),i0=Qt(Df),kf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ff={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tf(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Nf[s])?!!c[s]:!1}function Ko(){return Tf}var jf=g({},Si,{key:function(s){if(s.key){var c=kf[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=bs(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ff[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ko,charCode:function(s){return s.type==="keypress"?bs(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?bs(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),$f=Qt(jf),If=g({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s0=Qt(If),Of=g({},Si,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ko}),Uf=Qt(Of),Pf=g({},wn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mf=Qt(Pf),Lf=g({},As,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Hf=Qt(Lf),qf=g({},wn,{newState:0,oldState:0}),Kf=Qt(qf),zf=[9,13,27,32],zo=Tr&&"CompositionEvent"in window,Di=null;Tr&&"documentMode"in document&&(Di=document.documentMode);var Vf=Tr&&"TextEvent"in window&&!Di,o0=Tr&&(!zo||Di&&8<Di&&11>=Di),a0=" ",c0=!1;function l0(s,c){switch(s){case"keyup":return zf.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u0(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Wn=!1;function Gf(s,c){switch(s){case"compositionend":return u0(c);case"keypress":return c.which!==32?null:(c0=!0,a0);case"textInput":return s=c.data,s===a0&&c0?null:s;default:return null}}function Wf(s,c){if(Wn)return s==="compositionend"||!zo&&l0(s,c)?(s=t0(),Es=Mo=Xr=null,Wn=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return o0&&c.locale!=="ko"?null:c.data;default:return null}}var Xf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function x0(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!Xf[s.type]:c==="textarea"}function f0(s,c,m,E){Vn?Gn?Gn.push(E):Gn=[E]:Vn=E,c=fo(c,"onChange"),0<c.length&&(m=new vs("onChange","change",null,m,E),s.push({event:m,listeners:c}))}var ki=null,Fi=null;function Yf(s){Wu(s,0)}function Bs(s){var c=Bi(s);if(Gc(c))return s}function d0(s,c){if(s==="change")return c}var h0=!1;if(Tr){var Vo;if(Tr){var Go="oninput"in document;if(!Go){var p0=document.createElement("div");p0.setAttribute("oninput","return;"),Go=typeof p0.oninput=="function"}Vo=Go}else Vo=!1;h0=Vo&&(!document.documentMode||9<document.documentMode)}function m0(){ki&&(ki.detachEvent("onpropertychange",g0),Fi=ki=null)}function g0(s){if(s.propertyName==="value"&&Bs(Fi)){var c=[];f0(c,Fi,s,Oo(s)),e0(Yf,c)}}function Zf(s,c,m){s==="focusin"?(m0(),ki=c,Fi=m,ki.attachEvent("onpropertychange",g0)):s==="focusout"&&m0()}function Qf(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Bs(Fi)}function Jf(s,c){if(s==="click")return Bs(c)}function ed(s,c){if(s==="input"||s==="change")return Bs(c)}function td(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var ir=typeof Object.is=="function"?Object.is:td;function Ni(s,c){if(ir(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var m=Object.keys(s),E=Object.keys(c);if(m.length!==E.length)return!1;for(E=0;E<m.length;E++){var A=m[E];if(!we.call(c,A)||!ir(s[A],c[A]))return!1}return!0}function y0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function E0(s,c){var m=y0(s);s=0;for(var E;m;){if(m.nodeType===3){if(E=s+m.textContent.length,s<=c&&E>=c)return{node:m,offset:c-s};s=E}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=y0(m)}}function b0(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?b0(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function w0(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=gs(s.document);c instanceof s.HTMLIFrameElement;){try{var m=typeof c.contentWindow.location.href=="string"}catch{m=!1}if(m)s=c.contentWindow;else break;c=gs(s.document)}return c}function Wo(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var rd=Tr&&"documentMode"in document&&11>=document.documentMode,Xn=null,Xo=null,Ti=null,Yo=!1;function v0(s,c,m){var E=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Yo||Xn==null||Xn!==gs(E)||(E=Xn,"selectionStart"in E&&Wo(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),Ti&&Ni(Ti,E)||(Ti=E,E=fo(Xo,"onSelect"),0<E.length&&(c=new vs("onSelect","select",null,c,m),s.push({event:c,listeners:E}),c.target=Xn)))}function vn(s,c){var m={};return m[s.toLowerCase()]=c.toLowerCase(),m["Webkit"+s]="webkit"+c,m["Moz"+s]="moz"+c,m}var Yn={animationend:vn("Animation","AnimationEnd"),animationiteration:vn("Animation","AnimationIteration"),animationstart:vn("Animation","AnimationStart"),transitionrun:vn("Transition","TransitionRun"),transitionstart:vn("Transition","TransitionStart"),transitioncancel:vn("Transition","TransitionCancel"),transitionend:vn("Transition","TransitionEnd")},Zo={},A0={};Tr&&(A0=document.createElement("div").style,"AnimationEvent"in window||(delete Yn.animationend.animation,delete Yn.animationiteration.animation,delete Yn.animationstart.animation),"TransitionEvent"in window||delete Yn.transitionend.transition);function An(s){if(Zo[s])return Zo[s];if(!Yn[s])return s;var c=Yn[s],m;for(m in c)if(c.hasOwnProperty(m)&&m in A0)return Zo[s]=c[m];return s}var B0=An("animationend"),C0=An("animationiteration"),_0=An("animationstart"),nd=An("transitionrun"),id=An("transitionstart"),sd=An("transitioncancel"),S0=An("transitionend"),R0=new Map,Qo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qo.push("scrollEnd");function Ar(s,c){R0.set(s,c),bn(c,[s])}var Cs=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process$1=="object"&&typeof process$1.emit=="function"){process$1.emit("uncaughtException",s);return}console.error(s)},hr=[],Zn=0,Jo=0;function _s(){for(var s=Zn,c=Jo=Zn=0;c<s;){var m=hr[c];hr[c++]=null;var E=hr[c];hr[c++]=null;var A=hr[c];hr[c++]=null;var R=hr[c];if(hr[c++]=null,E!==null&&A!==null){var se=E.pending;se===null?A.next=A:(A.next=se.next,se.next=A),E.pending=A}R!==0&&D0(m,A,R)}}function Ss(s,c,m,E){hr[Zn++]=s,hr[Zn++]=c,hr[Zn++]=m,hr[Zn++]=E,Jo|=E,s.lanes|=E,s=s.alternate,s!==null&&(s.lanes|=E)}function ea(s,c,m,E){return Ss(s,c,m,E),Rs(s)}function Bn(s,c){return Ss(s,null,null,c),Rs(s)}function D0(s,c,m){s.lanes|=m;var E=s.alternate;E!==null&&(E.lanes|=m);for(var A=!1,R=s.return;R!==null;)R.childLanes|=m,E=R.alternate,E!==null&&(E.childLanes|=m),R.tag===22&&(s=R.stateNode,s===null||s._visibility&1||(A=!0)),s=R,R=R.return;return s.tag===3?(R=s.stateNode,A&&c!==null&&(A=31-Ie(m),s=R.hiddenUpdates,E=s[A],E===null?s[A]=[c]:E.push(c),c.lane=m|536870912),R):null}function Rs(s){if(50<ts)throw ts=0,uc=null,Error(n(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var Qn={};function od(s,c,m,E){this.tag=s,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sr(s,c,m,E){return new od(s,c,m,E)}function ta(s){return s=s.prototype,!(!s||!s.isReactComponent)}function jr(s,c){var m=s.alternate;return m===null?(m=sr(s.tag,c,s.key,s.mode),m.elementType=s.elementType,m.type=s.type,m.stateNode=s.stateNode,m.alternate=s,s.alternate=m):(m.pendingProps=c,m.type=s.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=s.flags&65011712,m.childLanes=s.childLanes,m.lanes=s.lanes,m.child=s.child,m.memoizedProps=s.memoizedProps,m.memoizedState=s.memoizedState,m.updateQueue=s.updateQueue,c=s.dependencies,m.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},m.sibling=s.sibling,m.index=s.index,m.ref=s.ref,m.refCleanup=s.refCleanup,m}function k0(s,c){s.flags&=65011714;var m=s.alternate;return m===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=m.childLanes,s.lanes=m.lanes,s.child=m.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=m.memoizedProps,s.memoizedState=m.memoizedState,s.updateQueue=m.updateQueue,s.type=m.type,c=m.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function Ds(s,c,m,E,A,R){var se=0;if(E=s,typeof s=="function")ta(s)&&(se=1);else if(typeof s=="string")se=xh(s,m,L.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case $:return s=sr(31,m,c,A),s.elementType=$,s.lanes=R,s;case v:return Cn(m.children,A,R,c);case B:se=8,A|=24;break;case j:return s=sr(12,m,c,A|2),s.elementType=j,s.lanes=R,s;case T:return s=sr(13,m,c,A),s.elementType=T,s.lanes=R,s;case _:return s=sr(19,m,c,A),s.elementType=_,s.lanes=R,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case C:se=10;break e;case F:se=9;break e;case N:se=11;break e;case S:se=14;break e;case O:se=16,E=null;break e}se=29,m=Error(n(130,s===null?"null":typeof s,"")),E=null}return c=sr(se,m,c,A),c.elementType=s,c.type=E,c.lanes=R,c}function Cn(s,c,m,E){return s=sr(7,s,E,c),s.lanes=m,s}function ra(s,c,m){return s=sr(6,s,null,c),s.lanes=m,s}function F0(s){var c=sr(18,null,null,0);return c.stateNode=s,c}function na(s,c,m){return c=sr(4,s.children!==null?s.children:[],s.key,c),c.lanes=m,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var N0=new WeakMap;function pr(s,c){if(typeof s=="object"&&s!==null){var m=N0.get(s);return m!==void 0?m:(c={value:s,source:c,stack:ke(c)},N0.set(s,c),c)}return{value:s,source:c,stack:ke(c)}}var Jn=[],ei=0,ks=null,ji=0,mr=[],gr=0,Yr=null,Sr=1,Rr="";function $r(s,c){Jn[ei++]=ji,Jn[ei++]=ks,ks=s,ji=c}function T0(s,c,m){mr[gr++]=Sr,mr[gr++]=Rr,mr[gr++]=Yr,Yr=s;var E=Sr;s=Rr;var A=32-Ie(E)-1;E&=~(1<<A),m+=1;var R=32-Ie(c)+A;if(30<R){var se=A-A%5;R=(E&(1<<se)-1).toString(32),E>>=se,A-=se,Sr=1<<32-Ie(c)+A|m<<A|E,Rr=R+s}else Sr=1<<R|m<<A|E,Rr=s}function ia(s){s.return!==null&&($r(s,1),T0(s,1,0))}function sa(s){for(;s===ks;)ks=Jn[--ei],Jn[ei]=null,ji=Jn[--ei],Jn[ei]=null;for(;s===Yr;)Yr=mr[--gr],mr[gr]=null,Rr=mr[--gr],mr[gr]=null,Sr=mr[--gr],mr[gr]=null}function j0(s,c){mr[gr++]=Sr,mr[gr++]=Rr,mr[gr++]=Yr,Sr=c.id,Rr=c.overflow,Yr=s}var zt=null,Dt=null,mt=!1,Zr=null,yr=!1,oa=Error(n(519));function Qr(s){var c=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw $i(pr(c,s)),oa}function $0(s){var c=s.stateNode,m=s.type,E=s.memoizedProps;switch(c[ot]=s,c[Zt]=E,m){case"dialog":ft("cancel",c),ft("close",c);break;case"iframe":case"object":case"embed":ft("load",c);break;case"video":case"audio":for(m=0;m<ns.length;m++)ft(ns[m],c);break;case"source":ft("error",c);break;case"img":case"image":case"link":ft("error",c),ft("load",c);break;case"details":ft("toggle",c);break;case"input":ft("invalid",c),Wc(c,E.value,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name,!0);break;case"select":ft("invalid",c);break;case"textarea":ft("invalid",c),Yc(c,E.value,E.defaultValue,E.children)}m=E.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||c.textContent===""+m||E.suppressHydrationWarning===!0||Qu(c.textContent,m)?(E.popover!=null&&(ft("beforetoggle",c),ft("toggle",c)),E.onScroll!=null&&ft("scroll",c),E.onScrollEnd!=null&&ft("scrollend",c),E.onClick!=null&&(c.onclick=Nr),c=!0):c=!1,c||Qr(s,!0)}function I0(s){for(zt=s.return;zt;)switch(zt.tag){case 5:case 31:case 13:yr=!1;return;case 27:case 3:yr=!0;return;default:zt=zt.return}}function ti(s){if(s!==zt)return!1;if(!mt)return I0(s),mt=!0,!1;var c=s.tag,m;if((m=c!==3&&c!==27)&&((m=c===5)&&(m=s.type,m=!(m!=="form"&&m!=="button")||Cc(s.type,s.memoizedProps)),m=!m),m&&Dt&&Qr(s),I0(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Dt=ax(s)}else if(c===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Dt=ax(s)}else c===27?(c=Dt,dn(s.type)?(s=kc,kc=null,Dt=s):Dt=c):Dt=zt?br(s.stateNode.nextSibling):null;return!0}function _n(){Dt=zt=null,mt=!1}function aa(){var s=Zr;return s!==null&&(rr===null?rr=s:rr.push.apply(rr,s),Zr=null),s}function $i(s){Zr===null?Zr=[s]:Zr.push(s)}var ca=D(null),Sn=null,Ir=null;function Jr(s,c,m){J(ca,c._currentValue),c._currentValue=m}function Or(s){s._currentValue=ca.current,Y(ca)}function la(s,c,m){for(;s!==null;){var E=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,E!==null&&(E.childLanes|=c)):E!==null&&(E.childLanes&c)!==c&&(E.childLanes|=c),s===m)break;s=s.return}}function ua(s,c,m,E){var A=s.child;for(A!==null&&(A.return=s);A!==null;){var R=A.dependencies;if(R!==null){var se=A.child;R=R.firstContext;e:for(;R!==null;){var pe=R;R=A;for(var De=0;De<c.length;De++)if(pe.context===c[De]){R.lanes|=m,pe=R.alternate,pe!==null&&(pe.lanes|=m),la(R.return,m,s),E||(se=null);break e}R=pe.next}}else if(A.tag===18){if(se=A.return,se===null)throw Error(n(341));se.lanes|=m,R=se.alternate,R!==null&&(R.lanes|=m),la(se,m,s),se=null}else se=A.child;if(se!==null)se.return=A;else for(se=A;se!==null;){if(se===s){se=null;break}if(A=se.sibling,A!==null){A.return=se.return,se=A;break}se=se.return}A=se}}function ri(s,c,m,E){s=null;for(var A=c,R=!1;A!==null;){if(!R){if((A.flags&524288)!==0)R=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var se=A.alternate;if(se===null)throw Error(n(387));if(se=se.memoizedProps,se!==null){var pe=A.type;ir(A.pendingProps.value,se.value)||(s!==null?s.push(pe):s=[pe])}}else if(A===ce.current){if(se=A.alternate,se===null)throw Error(n(387));se.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(s!==null?s.push(ls):s=[ls])}A=A.return}s!==null&&ua(c,s,m,E),c.flags|=262144}function Fs(s){for(s=s.firstContext;s!==null;){if(!ir(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Rn(s){Sn=s,Ir=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Vt(s){return O0(Sn,s)}function Ns(s,c){return Sn===null&&Rn(s),O0(s,c)}function O0(s,c){var m=c._currentValue;if(c={context:c,memoizedValue:m,next:null},Ir===null){if(s===null)throw Error(n(308));Ir=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else Ir=Ir.next=c;return m}var ad=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(m,E){s.push(E)}};this.abort=function(){c.aborted=!0,s.forEach(function(m){return m()})}},cd=e.unstable_scheduleCallback,ld=e.unstable_NormalPriority,Ut={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xa(){return{controller:new ad,data:new Map,refCount:0}}function Ii(s){s.refCount--,s.refCount===0&&cd(ld,function(){s.controller.abort()})}var Oi=null,fa=0,ni=0,ii=null;function ud(s,c){if(Oi===null){var m=Oi=[];fa=0,ni=mc(),ii={status:"pending",value:void 0,then:function(E){m.push(E)}}}return fa++,c.then(U0,U0),c}function U0(){if(--fa===0&&Oi!==null){ii!==null&&(ii.status="fulfilled");var s=Oi;Oi=null,ni=0,ii=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function xd(s,c){var m=[],E={status:"pending",value:null,reason:null,then:function(A){m.push(A)}};return s.then(function(){E.status="fulfilled",E.value=c;for(var A=0;A<m.length;A++)(0,m[A])(c)},function(A){for(E.status="rejected",E.reason=A,A=0;A<m.length;A++)(0,m[A])(void 0)}),E}var P0=M.S;M.S=function(s,c){vu=Ee(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&ud(s,c),P0!==null&&P0(s,c)};var Dn=D(null);function da(){var s=Dn.current;return s!==null?s:St.pooledCache}function Ts(s,c){c===null?J(Dn,Dn.current):J(Dn,c.pool)}function M0(){var s=da();return s===null?null:{parent:Ut._currentValue,pool:s}}var si=Error(n(460)),ha=Error(n(474)),js=Error(n(542)),$s={then:function(){}};function L0(s){return s=s.status,s==="fulfilled"||s==="rejected"}function H0(s,c,m){switch(m=s[m],m===void 0?s.push(c):m!==c&&(c.then(Nr,Nr),c=m),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,K0(s),s;default:if(typeof c.status=="string")c.then(Nr,Nr);else{if(s=St,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=c,s.status="pending",s.then(function(E){if(c.status==="pending"){var A=c;A.status="fulfilled",A.value=E}},function(E){if(c.status==="pending"){var A=c;A.status="rejected",A.reason=E}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,K0(s),s}throw Nn=c,si}}function kn(s){try{var c=s._init;return c(s._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(Nn=m,si):m}}var Nn=null;function q0(){if(Nn===null)throw Error(n(459));var s=Nn;return Nn=null,s}function K0(s){if(s===si||s===js)throw Error(n(483))}var oi=null,Ui=0;function Is(s){var c=Ui;return Ui+=1,oi===null&&(oi=[]),H0(oi,s,c)}function Pi(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Os(s,c){throw c.$$typeof===y?Error(n(525)):(s=Object.prototype.toString.call(c),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function z0(s){function c(Ue,$e){if(s){var Me=Ue.deletions;Me===null?(Ue.deletions=[$e],Ue.flags|=16):Me.push($e)}}function m(Ue,$e){if(!s)return null;for(;$e!==null;)c(Ue,$e),$e=$e.sibling;return null}function E(Ue){for(var $e=new Map;Ue!==null;)Ue.key!==null?$e.set(Ue.key,Ue):$e.set(Ue.index,Ue),Ue=Ue.sibling;return $e}function A(Ue,$e){return Ue=jr(Ue,$e),Ue.index=0,Ue.sibling=null,Ue}function R(Ue,$e,Me){return Ue.index=Me,s?(Me=Ue.alternate,Me!==null?(Me=Me.index,Me<$e?(Ue.flags|=67108866,$e):Me):(Ue.flags|=67108866,$e)):(Ue.flags|=1048576,$e)}function se(Ue){return s&&Ue.alternate===null&&(Ue.flags|=67108866),Ue}function pe(Ue,$e,Me,Ge){return $e===null||$e.tag!==6?($e=ra(Me,Ue.mode,Ge),$e.return=Ue,$e):($e=A($e,Me),$e.return=Ue,$e)}function De(Ue,$e,Me,Ge){var tt=Me.type;return tt===v?ze(Ue,$e,Me.props.children,Ge,Me.key):$e!==null&&($e.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===O&&kn(tt)===$e.type)?($e=A($e,Me.props),Pi($e,Me),$e.return=Ue,$e):($e=Ds(Me.type,Me.key,Me.props,null,Ue.mode,Ge),Pi($e,Me),$e.return=Ue,$e)}function Le(Ue,$e,Me,Ge){return $e===null||$e.tag!==4||$e.stateNode.containerInfo!==Me.containerInfo||$e.stateNode.implementation!==Me.implementation?($e=na(Me,Ue.mode,Ge),$e.return=Ue,$e):($e=A($e,Me.children||[]),$e.return=Ue,$e)}function ze(Ue,$e,Me,Ge,tt){return $e===null||$e.tag!==7?($e=Cn(Me,Ue.mode,Ge,tt),$e.return=Ue,$e):($e=A($e,Me),$e.return=Ue,$e)}function Xe(Ue,$e,Me){if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return $e=ra(""+$e,Ue.mode,Me),$e.return=Ue,$e;if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case b:return Me=Ds($e.type,$e.key,$e.props,null,Ue.mode,Me),Pi(Me,$e),Me.return=Ue,Me;case w:return $e=na($e,Ue.mode,Me),$e.return=Ue,$e;case O:return $e=kn($e),Xe(Ue,$e,Me)}if(k($e)||U($e))return $e=Cn($e,Ue.mode,Me,null),$e.return=Ue,$e;if(typeof $e.then=="function")return Xe(Ue,Is($e),Me);if($e.$$typeof===C)return Xe(Ue,Ns(Ue,$e),Me);Os(Ue,$e)}return null}function He(Ue,$e,Me,Ge){var tt=$e!==null?$e.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return tt!==null?null:pe(Ue,$e,""+Me,Ge);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case b:return Me.key===tt?De(Ue,$e,Me,Ge):null;case w:return Me.key===tt?Le(Ue,$e,Me,Ge):null;case O:return Me=kn(Me),He(Ue,$e,Me,Ge)}if(k(Me)||U(Me))return tt!==null?null:ze(Ue,$e,Me,Ge,null);if(typeof Me.then=="function")return He(Ue,$e,Is(Me),Ge);if(Me.$$typeof===C)return He(Ue,$e,Ns(Ue,Me),Ge);Os(Ue,Me)}return null}function Ke(Ue,$e,Me,Ge,tt){if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return Ue=Ue.get(Me)||null,pe($e,Ue,""+Ge,tt);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case b:return Ue=Ue.get(Ge.key===null?Me:Ge.key)||null,De($e,Ue,Ge,tt);case w:return Ue=Ue.get(Ge.key===null?Me:Ge.key)||null,Le($e,Ue,Ge,tt);case O:return Ge=kn(Ge),Ke(Ue,$e,Me,Ge,tt)}if(k(Ge)||U(Ge))return Ue=Ue.get(Me)||null,ze($e,Ue,Ge,tt,null);if(typeof Ge.then=="function")return Ke(Ue,$e,Me,Is(Ge),tt);if(Ge.$$typeof===C)return Ke(Ue,$e,Me,Ns($e,Ge),tt);Os($e,Ge)}return null}function Qe(Ue,$e,Me,Ge){for(var tt=null,gt=null,Je=$e,lt=$e=0,pt=null;Je!==null&&lt<Me.length;lt++){Je.index>lt?(pt=Je,Je=null):pt=Je.sibling;var yt=He(Ue,Je,Me[lt],Ge);if(yt===null){Je===null&&(Je=pt);break}s&&Je&&yt.alternate===null&&c(Ue,Je),$e=R(yt,$e,lt),gt===null?tt=yt:gt.sibling=yt,gt=yt,Je=pt}if(lt===Me.length)return m(Ue,Je),mt&&$r(Ue,lt),tt;if(Je===null){for(;lt<Me.length;lt++)Je=Xe(Ue,Me[lt],Ge),Je!==null&&($e=R(Je,$e,lt),gt===null?tt=Je:gt.sibling=Je,gt=Je);return mt&&$r(Ue,lt),tt}for(Je=E(Je);lt<Me.length;lt++)pt=Ke(Je,Ue,lt,Me[lt],Ge),pt!==null&&(s&&pt.alternate!==null&&Je.delete(pt.key===null?lt:pt.key),$e=R(pt,$e,lt),gt===null?tt=pt:gt.sibling=pt,gt=pt);return s&&Je.forEach(function(yn){return c(Ue,yn)}),mt&&$r(Ue,lt),tt}function it(Ue,$e,Me,Ge){if(Me==null)throw Error(n(151));for(var tt=null,gt=null,Je=$e,lt=$e=0,pt=null,yt=Me.next();Je!==null&&!yt.done;lt++,yt=Me.next()){Je.index>lt?(pt=Je,Je=null):pt=Je.sibling;var yn=He(Ue,Je,yt.value,Ge);if(yn===null){Je===null&&(Je=pt);break}s&&Je&&yn.alternate===null&&c(Ue,Je),$e=R(yn,$e,lt),gt===null?tt=yn:gt.sibling=yn,gt=yn,Je=pt}if(yt.done)return m(Ue,Je),mt&&$r(Ue,lt),tt;if(Je===null){for(;!yt.done;lt++,yt=Me.next())yt=Xe(Ue,yt.value,Ge),yt!==null&&($e=R(yt,$e,lt),gt===null?tt=yt:gt.sibling=yt,gt=yt);return mt&&$r(Ue,lt),tt}for(Je=E(Je);!yt.done;lt++,yt=Me.next())yt=Ke(Je,Ue,lt,yt.value,Ge),yt!==null&&(s&&yt.alternate!==null&&Je.delete(yt.key===null?lt:yt.key),$e=R(yt,$e,lt),gt===null?tt=yt:gt.sibling=yt,gt=yt);return s&&Je.forEach(function(vh){return c(Ue,vh)}),mt&&$r(Ue,lt),tt}function Ct(Ue,$e,Me,Ge){if(typeof Me=="object"&&Me!==null&&Me.type===v&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case b:e:{for(var tt=Me.key;$e!==null;){if($e.key===tt){if(tt=Me.type,tt===v){if($e.tag===7){m(Ue,$e.sibling),Ge=A($e,Me.props.children),Ge.return=Ue,Ue=Ge;break e}}else if($e.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===O&&kn(tt)===$e.type){m(Ue,$e.sibling),Ge=A($e,Me.props),Pi(Ge,Me),Ge.return=Ue,Ue=Ge;break e}m(Ue,$e);break}else c(Ue,$e);$e=$e.sibling}Me.type===v?(Ge=Cn(Me.props.children,Ue.mode,Ge,Me.key),Ge.return=Ue,Ue=Ge):(Ge=Ds(Me.type,Me.key,Me.props,null,Ue.mode,Ge),Pi(Ge,Me),Ge.return=Ue,Ue=Ge)}return se(Ue);case w:e:{for(tt=Me.key;$e!==null;){if($e.key===tt)if($e.tag===4&&$e.stateNode.containerInfo===Me.containerInfo&&$e.stateNode.implementation===Me.implementation){m(Ue,$e.sibling),Ge=A($e,Me.children||[]),Ge.return=Ue,Ue=Ge;break e}else{m(Ue,$e);break}else c(Ue,$e);$e=$e.sibling}Ge=na(Me,Ue.mode,Ge),Ge.return=Ue,Ue=Ge}return se(Ue);case O:return Me=kn(Me),Ct(Ue,$e,Me,Ge)}if(k(Me))return Qe(Ue,$e,Me,Ge);if(U(Me)){if(tt=U(Me),typeof tt!="function")throw Error(n(150));return Me=tt.call(Me),it(Ue,$e,Me,Ge)}if(typeof Me.then=="function")return Ct(Ue,$e,Is(Me),Ge);if(Me.$$typeof===C)return Ct(Ue,$e,Ns(Ue,Me),Ge);Os(Ue,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint"?(Me=""+Me,$e!==null&&$e.tag===6?(m(Ue,$e.sibling),Ge=A($e,Me),Ge.return=Ue,Ue=Ge):(m(Ue,$e),Ge=ra(Me,Ue.mode,Ge),Ge.return=Ue,Ue=Ge),se(Ue)):m(Ue,$e)}return function(Ue,$e,Me,Ge){try{Ui=0;var tt=Ct(Ue,$e,Me,Ge);return oi=null,tt}catch(Je){if(Je===si||Je===js)throw Je;var gt=sr(29,Je,null,Ue.mode);return gt.lanes=Ge,gt.return=Ue,gt}finally{}}}var Tn=z0(!0),V0=z0(!1),en=!1;function pa(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ma(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function tn(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function rn(s,c,m){var E=s.updateQueue;if(E===null)return null;if(E=E.shared,(bt&2)!==0){var A=E.pending;return A===null?c.next=c:(c.next=A.next,A.next=c),E.pending=c,c=Rs(s),D0(s,null,m),c}return Ss(s,E,c,m),Rs(s)}function Mi(s,c,m){if(c=c.updateQueue,c!==null&&(c=c.shared,(m&4194048)!==0)){var E=c.lanes;E&=s.pendingLanes,m|=E,c.lanes=m,Oe(s,m)}}function ga(s,c){var m=s.updateQueue,E=s.alternate;if(E!==null&&(E=E.updateQueue,m===E)){var A=null,R=null;if(m=m.firstBaseUpdate,m!==null){do{var se={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};R===null?A=R=se:R=R.next=se,m=m.next}while(m!==null);R===null?A=R=c:R=R.next=c}else A=R=c;m={baseState:E.baseState,firstBaseUpdate:A,lastBaseUpdate:R,shared:E.shared,callbacks:E.callbacks},s.updateQueue=m;return}s=m.lastBaseUpdate,s===null?m.firstBaseUpdate=c:s.next=c,m.lastBaseUpdate=c}var ya=!1;function Li(){if(ya){var s=ii;if(s!==null)throw s}}function Hi(s,c,m,E){ya=!1;var A=s.updateQueue;en=!1;var R=A.firstBaseUpdate,se=A.lastBaseUpdate,pe=A.shared.pending;if(pe!==null){A.shared.pending=null;var De=pe,Le=De.next;De.next=null,se===null?R=Le:se.next=Le,se=De;var ze=s.alternate;ze!==null&&(ze=ze.updateQueue,pe=ze.lastBaseUpdate,pe!==se&&(pe===null?ze.firstBaseUpdate=Le:pe.next=Le,ze.lastBaseUpdate=De))}if(R!==null){var Xe=A.baseState;se=0,ze=Le=De=null,pe=R;do{var He=pe.lane&-536870913,Ke=He!==pe.lane;if(Ke?(ht&He)===He:(E&He)===He){He!==0&&He===ni&&(ya=!0),ze!==null&&(ze=ze.next={lane:0,tag:pe.tag,payload:pe.payload,callback:null,next:null});e:{var Qe=s,it=pe;He=c;var Ct=m;switch(it.tag){case 1:if(Qe=it.payload,typeof Qe=="function"){Xe=Qe.call(Ct,Xe,He);break e}Xe=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=it.payload,He=typeof Qe=="function"?Qe.call(Ct,Xe,He):Qe,He==null)break e;Xe=g({},Xe,He);break e;case 2:en=!0}}He=pe.callback,He!==null&&(s.flags|=64,Ke&&(s.flags|=8192),Ke=A.callbacks,Ke===null?A.callbacks=[He]:Ke.push(He))}else Ke={lane:He,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},ze===null?(Le=ze=Ke,De=Xe):ze=ze.next=Ke,se|=He;if(pe=pe.next,pe===null){if(pe=A.shared.pending,pe===null)break;Ke=pe,pe=Ke.next,Ke.next=null,A.lastBaseUpdate=Ke,A.shared.pending=null}}while(!0);ze===null&&(De=Xe),A.baseState=De,A.firstBaseUpdate=Le,A.lastBaseUpdate=ze,R===null&&(A.shared.lanes=0),cn|=se,s.lanes=se,s.memoizedState=Xe}}function G0(s,c){if(typeof s!="function")throw Error(n(191,s));s.call(c)}function W0(s,c){var m=s.callbacks;if(m!==null)for(s.callbacks=null,s=0;s<m.length;s++)G0(m[s],c)}var ai=D(null),Us=D(0);function X0(s,c){s=Vr,J(Us,s),J(ai,c),Vr=s|c.baseLanes}function Ea(){J(Us,Vr),J(ai,ai.current)}function ba(){Vr=Us.current,Y(ai),Y(Us)}var or=D(null),Er=null;function nn(s){var c=s.alternate;J(It,It.current&1),J(or,s),Er===null&&(c===null||ai.current!==null||c.memoizedState!==null)&&(Er=s)}function wa(s){J(It,It.current),J(or,s),Er===null&&(Er=s)}function Y0(s){s.tag===22?(J(It,It.current),J(or,s),Er===null&&(Er=s)):sn()}function sn(){J(It,It.current),J(or,or.current)}function ar(s){Y(or),Er===s&&(Er=null),Y(It)}var It=D(0);function Ps(s){for(var c=s;c!==null;){if(c.tag===13){var m=c.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||Rc(m)||Dc(m)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Ur=0,at=null,At=null,Pt=null,Ms=!1,ci=!1,jn=!1,Ls=0,qi=0,li=null,fd=0;function Nt(){throw Error(n(321))}function va(s,c){if(c===null)return!1;for(var m=0;m<c.length&&m<s.length;m++)if(!ir(s[m],c[m]))return!1;return!0}function Aa(s,c,m,E,A,R){return Ur=R,at=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,M.H=s===null||s.memoizedState===null?Tl:Pa,jn=!1,R=m(E,A),jn=!1,ci&&(R=Q0(c,m,E,A)),Z0(s),R}function Z0(s){M.H=Vi;var c=At!==null&&At.next!==null;if(Ur=0,Pt=At=at=null,Ms=!1,qi=0,li=null,c)throw Error(n(300));s===null||Mt||(s=s.dependencies,s!==null&&Fs(s)&&(Mt=!0))}function Q0(s,c,m,E){at=s;var A=0;do{if(ci&&(li=null),qi=0,ci=!1,25<=A)throw Error(n(301));if(A+=1,Pt=At=null,s.updateQueue!=null){var R=s.updateQueue;R.lastEffect=null,R.events=null,R.stores=null,R.memoCache!=null&&(R.memoCache.index=0)}M.H=jl,R=c(m,E)}while(ci);return R}function dd(){var s=M.H,c=s.useState()[0];return c=typeof c.then=="function"?Ki(c):c,s=s.useState()[0],(At!==null?At.memoizedState:null)!==s&&(at.flags|=1024),c}function Ba(){var s=Ls!==0;return Ls=0,s}function Ca(s,c,m){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~m}function Sa(s){if(Ms){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}Ms=!1}Ur=0,Pt=At=at=null,ci=!1,qi=Ls=0,li=null}function Xt(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pt===null?at.memoizedState=Pt=s:Pt=Pt.next=s,Pt}function Ot(){if(At===null){var s=at.alternate;s=s!==null?s.memoizedState:null}else s=At.next;var c=Pt===null?at.memoizedState:Pt.next;if(c!==null)Pt=c,At=s;else{if(s===null)throw at.alternate===null?Error(n(467)):Error(n(310));At=s,s={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Pt===null?at.memoizedState=Pt=s:Pt=Pt.next=s}return Pt}function Hs(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ki(s){var c=qi;return qi+=1,li===null&&(li=[]),s=H0(li,s,c),c=at,(Pt===null?c.memoizedState:Pt.next)===null&&(c=c.alternate,M.H=c===null||c.memoizedState===null?Tl:Pa),s}function qs(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ki(s);if(s.$$typeof===C)return Vt(s)}throw Error(n(438,String(s)))}function Ra(s){var c=null,m=at.updateQueue;if(m!==null&&(c=m.memoCache),c==null){var E=at.alternate;E!==null&&(E=E.updateQueue,E!==null&&(E=E.memoCache,E!=null&&(c={data:E.data.map(function(A){return A.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),m===null&&(m=Hs(),at.updateQueue=m),m.memoCache=c,m=c.data[c.index],m===void 0)for(m=c.data[c.index]=Array(s),E=0;E<s;E++)m[E]=z;return c.index++,m}function Pr(s,c){return typeof c=="function"?c(s):c}function Ks(s){var c=Ot();return Da(c,At,s)}function Da(s,c,m){var E=s.queue;if(E===null)throw Error(n(311));E.lastRenderedReducer=m;var A=s.baseQueue,R=E.pending;if(R!==null){if(A!==null){var se=A.next;A.next=R.next,R.next=se}c.baseQueue=A=R,E.pending=null}if(R=s.baseState,A===null)s.memoizedState=R;else{c=A.next;var pe=se=null,De=null,Le=c,ze=!1;do{var Xe=Le.lane&-536870913;if(Xe!==Le.lane?(ht&Xe)===Xe:(Ur&Xe)===Xe){var He=Le.revertLane;if(He===0)De!==null&&(De=De.next={lane:0,revertLane:0,gesture:null,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),Xe===ni&&(ze=!0);else if((Ur&He)===He){Le=Le.next,He===ni&&(ze=!0);continue}else Xe={lane:0,revertLane:Le.revertLane,gesture:null,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},De===null?(pe=De=Xe,se=R):De=De.next=Xe,at.lanes|=He,cn|=He;Xe=Le.action,jn&&m(R,Xe),R=Le.hasEagerState?Le.eagerState:m(R,Xe)}else He={lane:Xe,revertLane:Le.revertLane,gesture:Le.gesture,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},De===null?(pe=De=He,se=R):De=De.next=He,at.lanes|=Xe,cn|=Xe;Le=Le.next}while(Le!==null&&Le!==c);if(De===null?se=R:De.next=pe,!ir(R,s.memoizedState)&&(Mt=!0,ze&&(m=ii,m!==null)))throw m;s.memoizedState=R,s.baseState=se,s.baseQueue=De,E.lastRenderedState=R}return A===null&&(E.lanes=0),[s.memoizedState,E.dispatch]}function ka(s){var c=Ot(),m=c.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=s;var E=m.dispatch,A=m.pending,R=c.memoizedState;if(A!==null){m.pending=null;var se=A=A.next;do R=s(R,se.action),se=se.next;while(se!==A);ir(R,c.memoizedState)||(Mt=!0),c.memoizedState=R,c.baseQueue===null&&(c.baseState=R),m.lastRenderedState=R}return[R,E]}function J0(s,c,m){var E=at,A=Ot(),R=mt;if(R){if(m===void 0)throw Error(n(407));m=m()}else m=c();var se=!ir((At||A).memoizedState,m);if(se&&(A.memoizedState=m,Mt=!0),A=A.queue,Ta(rl.bind(null,E,A,s),[s]),A.getSnapshot!==c||se||Pt!==null&&Pt.memoizedState.tag&1){if(E.flags|=2048,ui(9,{destroy:void 0},tl.bind(null,E,A,m,c),null),St===null)throw Error(n(349));R||(Ur&127)!==0||el(E,c,m)}return m}function el(s,c,m){s.flags|=16384,s={getSnapshot:c,value:m},c=at.updateQueue,c===null?(c=Hs(),at.updateQueue=c,c.stores=[s]):(m=c.stores,m===null?c.stores=[s]:m.push(s))}function tl(s,c,m,E){c.value=m,c.getSnapshot=E,nl(c)&&il(s)}function rl(s,c,m){return m(function(){nl(c)&&il(s)})}function nl(s){var c=s.getSnapshot;s=s.value;try{var m=c();return!ir(s,m)}catch{return!0}}function il(s){var c=Bn(s,2);c!==null&&nr(c,s,2)}function Fa(s){var c=Xt();if(typeof s=="function"){var m=s;if(s=m(),jn){je(!0);try{m()}finally{je(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pr,lastRenderedState:s},c}function sl(s,c,m,E){return s.baseState=m,Da(s,At,typeof E=="function"?E:Pr)}function hd(s,c,m,E,A){if(Gs(s))throw Error(n(485));if(s=c.action,s!==null){var R={payload:A,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(se){R.listeners.push(se)}};M.T!==null?m(!0):R.isTransition=!1,E(R),m=c.pending,m===null?(R.next=c.pending=R,ol(c,R)):(R.next=m.next,c.pending=m.next=R)}}function ol(s,c){var m=c.action,E=c.payload,A=s.state;if(c.isTransition){var R=M.T,se={};M.T=se;try{var pe=m(A,E),De=M.S;De!==null&&De(se,pe),al(s,c,pe)}catch(Le){Na(s,c,Le)}finally{R!==null&&se.types!==null&&(R.types=se.types),M.T=R}}else try{R=m(A,E),al(s,c,R)}catch(Le){Na(s,c,Le)}}function al(s,c,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(E){cl(s,c,E)},function(E){return Na(s,c,E)}):cl(s,c,m)}function cl(s,c,m){c.status="fulfilled",c.value=m,ll(c),s.state=m,c=s.pending,c!==null&&(m=c.next,m===c?s.pending=null:(m=m.next,c.next=m,ol(s,m)))}function Na(s,c,m){var E=s.pending;if(s.pending=null,E!==null){E=E.next;do c.status="rejected",c.reason=m,ll(c),c=c.next;while(c!==E)}s.action=null}function ll(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function ul(s,c){return c}function xl(s,c){if(mt){var m=St.formState;if(m!==null){e:{var E=at;if(mt){if(Dt){t:{for(var A=Dt,R=yr;A.nodeType!==8;){if(!R){A=null;break t}if(A=br(A.nextSibling),A===null){A=null;break t}}R=A.data,A=R==="F!"||R==="F"?A:null}if(A){Dt=br(A.nextSibling),E=A.data==="F!";break e}}Qr(E)}E=!1}E&&(c=m[0])}}return m=Xt(),m.memoizedState=m.baseState=c,E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ul,lastRenderedState:c},m.queue=E,m=kl.bind(null,at,E),E.dispatch=m,E=Fa(!1),R=Ua.bind(null,at,!1,E.queue),E=Xt(),A={state:c,dispatch:null,action:s,pending:null},E.queue=A,m=hd.bind(null,at,A,R,m),A.dispatch=m,E.memoizedState=s,[c,m,!1]}function fl(s){var c=Ot();return dl(c,At,s)}function dl(s,c,m){if(c=Da(s,c,ul)[0],s=Ks(Pr)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var E=Ki(c)}catch(se){throw se===si?js:se}else E=c;c=Ot();var A=c.queue,R=A.dispatch;return m!==c.memoizedState&&(at.flags|=2048,ui(9,{destroy:void 0},pd.bind(null,A,m),null)),[E,R,s]}function pd(s,c){s.action=c}function hl(s){var c=Ot(),m=At;if(m!==null)return dl(c,m,s);Ot(),c=c.memoizedState,m=Ot();var E=m.queue.dispatch;return m.memoizedState=s,[c,E,!1]}function ui(s,c,m,E){return s={tag:s,create:m,deps:E,inst:c,next:null},c=at.updateQueue,c===null&&(c=Hs(),at.updateQueue=c),m=c.lastEffect,m===null?c.lastEffect=s.next=s:(E=m.next,m.next=s,s.next=E,c.lastEffect=s),s}function pl(){return Ot().memoizedState}function zs(s,c,m,E){var A=Xt();at.flags|=s,A.memoizedState=ui(1|c,{destroy:void 0},m,E===void 0?null:E)}function Vs(s,c,m,E){var A=Ot();E=E===void 0?null:E;var R=A.memoizedState.inst;At!==null&&E!==null&&va(E,At.memoizedState.deps)?A.memoizedState=ui(c,R,m,E):(at.flags|=s,A.memoizedState=ui(1|c,R,m,E))}function ml(s,c){zs(8390656,8,s,c)}function Ta(s,c){Vs(2048,8,s,c)}function md(s){at.flags|=4;var c=at.updateQueue;if(c===null)c=Hs(),at.updateQueue=c,c.events=[s];else{var m=c.events;m===null?c.events=[s]:m.push(s)}}function gl(s){var c=Ot().memoizedState;return md({ref:c,nextImpl:s}),function(){if((bt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}function yl(s,c){return Vs(4,2,s,c)}function El(s,c){return Vs(4,4,s,c)}function bl(s,c){if(typeof c=="function"){s=s();var m=c(s);return function(){typeof m=="function"?m():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function wl(s,c,m){m=m!=null?m.concat([s]):null,Vs(4,4,bl.bind(null,c,s),m)}function ja(){}function vl(s,c){var m=Ot();c=c===void 0?null:c;var E=m.memoizedState;return c!==null&&va(c,E[1])?E[0]:(m.memoizedState=[s,c],s)}function Al(s,c){var m=Ot();c=c===void 0?null:c;var E=m.memoizedState;if(c!==null&&va(c,E[1]))return E[0];if(E=s(),jn){je(!0);try{s()}finally{je(!1)}}return m.memoizedState=[E,c],E}function $a(s,c,m){return m===void 0||(Ur&1073741824)!==0&&(ht&261930)===0?s.memoizedState=c:(s.memoizedState=m,s=Bu(),at.lanes|=s,cn|=s,m)}function Bl(s,c,m,E){return ir(m,c)?m:ai.current!==null?(s=$a(s,m,E),ir(s,c)||(Mt=!0),s):(Ur&42)===0||(Ur&1073741824)!==0&&(ht&261930)===0?(Mt=!0,s.memoizedState=m):(s=Bu(),at.lanes|=s,cn|=s,c)}function Cl(s,c,m,E,A){var R=q.p;q.p=R!==0&&8>R?R:8;var se=M.T,pe={};M.T=pe,Ua(s,!1,c,m);try{var De=A(),Le=M.S;if(Le!==null&&Le(pe,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var ze=xd(De,E);zi(s,c,ze,xr(s))}else zi(s,c,E,xr(s))}catch(Xe){zi(s,c,{then:function(){},status:"rejected",reason:Xe},xr())}finally{q.p=R,se!==null&&pe.types!==null&&(se.types=pe.types),M.T=se}}function gd(){}function Ia(s,c,m,E){if(s.tag!==5)throw Error(n(476));var A=_l(s).queue;Cl(s,A,c,K,m===null?gd:function(){return Sl(s),m(E)})}function _l(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pr,lastRenderedState:K},next:null};var m={};return c.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pr,lastRenderedState:m},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function Sl(s){var c=_l(s);c.next===null&&(c=s.alternate.memoizedState),zi(s,c.next.queue,{},xr())}function Oa(){return Vt(ls)}function Rl(){return Ot().memoizedState}function Dl(){return Ot().memoizedState}function yd(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var m=xr();s=tn(m);var E=rn(c,s,m);E!==null&&(nr(E,c,m),Mi(E,c,m)),c={cache:xa()},s.payload=c;return}c=c.return}}function Ed(s,c,m){var E=xr();m={lane:E,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Gs(s)?Fl(c,m):(m=ea(s,c,m,E),m!==null&&(nr(m,s,E),Nl(m,c,E)))}function kl(s,c,m){var E=xr();zi(s,c,m,E)}function zi(s,c,m,E){var A={lane:E,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(Gs(s))Fl(c,A);else{var R=s.alternate;if(s.lanes===0&&(R===null||R.lanes===0)&&(R=c.lastRenderedReducer,R!==null))try{var se=c.lastRenderedState,pe=R(se,m);if(A.hasEagerState=!0,A.eagerState=pe,ir(pe,se))return Ss(s,c,A,0),St===null&&_s(),!1}catch{}finally{}if(m=ea(s,c,A,E),m!==null)return nr(m,s,E),Nl(m,c,E),!0}return!1}function Ua(s,c,m,E){if(E={lane:2,revertLane:mc(),gesture:null,action:E,hasEagerState:!1,eagerState:null,next:null},Gs(s)){if(c)throw Error(n(479))}else c=ea(s,m,E,2),c!==null&&nr(c,s,2)}function Gs(s){var c=s.alternate;return s===at||c!==null&&c===at}function Fl(s,c){ci=Ms=!0;var m=s.pending;m===null?c.next=c:(c.next=m.next,m.next=c),s.pending=c}function Nl(s,c,m){if((m&4194048)!==0){var E=c.lanes;E&=s.pendingLanes,m|=E,c.lanes=m,Oe(s,m)}}var Vi={readContext:Vt,use:qs,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt,useHostTransitionStatus:Nt,useFormState:Nt,useActionState:Nt,useOptimistic:Nt,useMemoCache:Nt,useCacheRefresh:Nt};Vi.useEffectEvent=Nt;var Tl={readContext:Vt,use:qs,useCallback:function(s,c){return Xt().memoizedState=[s,c===void 0?null:c],s},useContext:Vt,useEffect:ml,useImperativeHandle:function(s,c,m){m=m!=null?m.concat([s]):null,zs(4194308,4,bl.bind(null,c,s),m)},useLayoutEffect:function(s,c){return zs(4194308,4,s,c)},useInsertionEffect:function(s,c){zs(4,2,s,c)},useMemo:function(s,c){var m=Xt();c=c===void 0?null:c;var E=s();if(jn){je(!0);try{s()}finally{je(!1)}}return m.memoizedState=[E,c],E},useReducer:function(s,c,m){var E=Xt();if(m!==void 0){var A=m(c);if(jn){je(!0);try{m(c)}finally{je(!1)}}}else A=c;return E.memoizedState=E.baseState=A,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:A},E.queue=s,s=s.dispatch=Ed.bind(null,at,s),[E.memoizedState,s]},useRef:function(s){var c=Xt();return s={current:s},c.memoizedState=s},useState:function(s){s=Fa(s);var c=s.queue,m=kl.bind(null,at,c);return c.dispatch=m,[s.memoizedState,m]},useDebugValue:ja,useDeferredValue:function(s,c){var m=Xt();return $a(m,s,c)},useTransition:function(){var s=Fa(!1);return s=Cl.bind(null,at,s.queue,!0,!1),Xt().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,m){var E=at,A=Xt();if(mt){if(m===void 0)throw Error(n(407));m=m()}else{if(m=c(),St===null)throw Error(n(349));(ht&127)!==0||el(E,c,m)}A.memoizedState=m;var R={value:m,getSnapshot:c};return A.queue=R,ml(rl.bind(null,E,R,s),[s]),E.flags|=2048,ui(9,{destroy:void 0},tl.bind(null,E,R,m,c),null),m},useId:function(){var s=Xt(),c=St.identifierPrefix;if(mt){var m=Rr,E=Sr;m=(E&~(1<<32-Ie(E)-1)).toString(32)+m,c="_"+c+"R_"+m,m=Ls++,0<m&&(c+="H"+m.toString(32)),c+="_"}else m=fd++,c="_"+c+"r_"+m.toString(32)+"_";return s.memoizedState=c},useHostTransitionStatus:Oa,useFormState:xl,useActionState:xl,useOptimistic:function(s){var c=Xt();c.memoizedState=c.baseState=s;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=m,c=Ua.bind(null,at,!0,m),m.dispatch=c,[s,c]},useMemoCache:Ra,useCacheRefresh:function(){return Xt().memoizedState=yd.bind(null,at)},useEffectEvent:function(s){var c=Xt(),m={impl:s};return c.memoizedState=m,function(){if((bt&2)!==0)throw Error(n(440));return m.impl.apply(void 0,arguments)}}},Pa={readContext:Vt,use:qs,useCallback:vl,useContext:Vt,useEffect:Ta,useImperativeHandle:wl,useInsertionEffect:yl,useLayoutEffect:El,useMemo:Al,useReducer:Ks,useRef:pl,useState:function(){return Ks(Pr)},useDebugValue:ja,useDeferredValue:function(s,c){var m=Ot();return Bl(m,At.memoizedState,s,c)},useTransition:function(){var s=Ks(Pr)[0],c=Ot().memoizedState;return[typeof s=="boolean"?s:Ki(s),c]},useSyncExternalStore:J0,useId:Rl,useHostTransitionStatus:Oa,useFormState:fl,useActionState:fl,useOptimistic:function(s,c){var m=Ot();return sl(m,At,s,c)},useMemoCache:Ra,useCacheRefresh:Dl};Pa.useEffectEvent=gl;var jl={readContext:Vt,use:qs,useCallback:vl,useContext:Vt,useEffect:Ta,useImperativeHandle:wl,useInsertionEffect:yl,useLayoutEffect:El,useMemo:Al,useReducer:ka,useRef:pl,useState:function(){return ka(Pr)},useDebugValue:ja,useDeferredValue:function(s,c){var m=Ot();return At===null?$a(m,s,c):Bl(m,At.memoizedState,s,c)},useTransition:function(){var s=ka(Pr)[0],c=Ot().memoizedState;return[typeof s=="boolean"?s:Ki(s),c]},useSyncExternalStore:J0,useId:Rl,useHostTransitionStatus:Oa,useFormState:hl,useActionState:hl,useOptimistic:function(s,c){var m=Ot();return At!==null?sl(m,At,s,c):(m.baseState=s,[s,m.queue.dispatch])},useMemoCache:Ra,useCacheRefresh:Dl};jl.useEffectEvent=gl;function Ma(s,c,m,E){c=s.memoizedState,m=m(E,c),m=m==null?c:g({},c,m),s.memoizedState=m,s.lanes===0&&(s.updateQueue.baseState=m)}var La={enqueueSetState:function(s,c,m){s=s._reactInternals;var E=xr(),A=tn(E);A.payload=c,m!=null&&(A.callback=m),c=rn(s,A,E),c!==null&&(nr(c,s,E),Mi(c,s,E))},enqueueReplaceState:function(s,c,m){s=s._reactInternals;var E=xr(),A=tn(E);A.tag=1,A.payload=c,m!=null&&(A.callback=m),c=rn(s,A,E),c!==null&&(nr(c,s,E),Mi(c,s,E))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var m=xr(),E=tn(m);E.tag=2,c!=null&&(E.callback=c),c=rn(s,E,m),c!==null&&(nr(c,s,m),Mi(c,s,m))}};function $l(s,c,m,E,A,R,se){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(E,R,se):c.prototype&&c.prototype.isPureReactComponent?!Ni(m,E)||!Ni(A,R):!0}function Il(s,c,m,E){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(m,E),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(m,E),c.state!==s&&La.enqueueReplaceState(c,c.state,null)}function $n(s,c){var m=c;if("ref"in c){m={};for(var E in c)E!=="ref"&&(m[E]=c[E])}if(s=s.defaultProps){m===c&&(m=g({},m));for(var A in s)m[A]===void 0&&(m[A]=s[A])}return m}function Ol(s){Cs(s)}function Ul(s){console.error(s)}function Pl(s){Cs(s)}function Ws(s,c){try{var m=s.onUncaughtError;m(c.value,{componentStack:c.stack})}catch(E){setTimeout(function(){throw E})}}function Ml(s,c,m){try{var E=s.onCaughtError;E(m.value,{componentStack:m.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function Ha(s,c,m){return m=tn(m),m.tag=3,m.payload={element:null},m.callback=function(){Ws(s,c)},m}function Ll(s){return s=tn(s),s.tag=3,s}function Hl(s,c,m,E){var A=m.type.getDerivedStateFromError;if(typeof A=="function"){var R=E.value;s.payload=function(){return A(R)},s.callback=function(){Ml(c,m,E)}}var se=m.stateNode;se!==null&&typeof se.componentDidCatch=="function"&&(s.callback=function(){Ml(c,m,E),typeof A!="function"&&(ln===null?ln=new Set([this]):ln.add(this));var pe=E.stack;this.componentDidCatch(E.value,{componentStack:pe!==null?pe:""})})}function bd(s,c,m,E,A){if(m.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){if(c=m.alternate,c!==null&&ri(c,m,A,!0),m=or.current,m!==null){switch(m.tag){case 31:case 13:return Er===null?oo():m.alternate===null&&Tt===0&&(Tt=3),m.flags&=-257,m.flags|=65536,m.lanes=A,E===$s?m.flags|=16384:(c=m.updateQueue,c===null?m.updateQueue=new Set([E]):c.add(E),dc(s,E,A)),!1;case 22:return m.flags|=65536,E===$s?m.flags|=16384:(c=m.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([E])},m.updateQueue=c):(m=c.retryQueue,m===null?c.retryQueue=new Set([E]):m.add(E)),dc(s,E,A)),!1}throw Error(n(435,m.tag))}return dc(s,E,A),oo(),!1}if(mt)return c=or.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=A,E!==oa&&(s=Error(n(422),{cause:E}),$i(pr(s,m)))):(E!==oa&&(c=Error(n(423),{cause:E}),$i(pr(c,m))),s=s.current.alternate,s.flags|=65536,A&=-A,s.lanes|=A,E=pr(E,m),A=Ha(s.stateNode,E,A),ga(s,A),Tt!==4&&(Tt=2)),!1;var R=Error(n(520),{cause:E});if(R=pr(R,m),es===null?es=[R]:es.push(R),Tt!==4&&(Tt=2),c===null)return!0;E=pr(E,m),m=c;do{switch(m.tag){case 3:return m.flags|=65536,s=A&-A,m.lanes|=s,s=Ha(m.stateNode,E,s),ga(m,s),!1;case 1:if(c=m.type,R=m.stateNode,(m.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(ln===null||!ln.has(R))))return m.flags|=65536,A&=-A,m.lanes|=A,A=Ll(A),Hl(A,s,m,E),ga(m,A),!1}m=m.return}while(m!==null);return!1}var qa=Error(n(461)),Mt=!1;function Gt(s,c,m,E){c.child=s===null?V0(c,null,m,E):Tn(c,s.child,m,E)}function ql(s,c,m,E,A){m=m.render;var R=c.ref;if("ref"in E){var se={};for(var pe in E)pe!=="ref"&&(se[pe]=E[pe])}else se=E;return Rn(c),E=Aa(s,c,m,se,R,A),pe=Ba(),s!==null&&!Mt?(Ca(s,c,A),Mr(s,c,A)):(mt&&pe&&ia(c),c.flags|=1,Gt(s,c,E,A),c.child)}function Kl(s,c,m,E,A){if(s===null){var R=m.type;return typeof R=="function"&&!ta(R)&&R.defaultProps===void 0&&m.compare===null?(c.tag=15,c.type=R,zl(s,c,R,E,A)):(s=Ds(m.type,null,E,c,c.mode,A),s.ref=c.ref,s.return=c,c.child=s)}if(R=s.child,!Za(s,A)){var se=R.memoizedProps;if(m=m.compare,m=m!==null?m:Ni,m(se,E)&&s.ref===c.ref)return Mr(s,c,A)}return c.flags|=1,s=jr(R,E),s.ref=c.ref,s.return=c,c.child=s}function zl(s,c,m,E,A){if(s!==null){var R=s.memoizedProps;if(Ni(R,E)&&s.ref===c.ref)if(Mt=!1,c.pendingProps=E=R,Za(s,A))(s.flags&131072)!==0&&(Mt=!0);else return c.lanes=s.lanes,Mr(s,c,A)}return Ka(s,c,m,E,A)}function Vl(s,c,m,E){var A=E.children,R=s!==null?s.memoizedState:null;if(s===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),E.mode==="hidden"){if((c.flags&128)!==0){if(R=R!==null?R.baseLanes|m:m,s!==null){for(E=c.child=s.child,A=0;E!==null;)A=A|E.lanes|E.childLanes,E=E.sibling;E=A&~R}else E=0,c.child=null;return Gl(s,c,R,m,E)}if((m&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&Ts(c,R!==null?R.cachePool:null),R!==null?X0(c,R):Ea(),Y0(c);else return E=c.lanes=536870912,Gl(s,c,R!==null?R.baseLanes|m:m,m,E)}else R!==null?(Ts(c,R.cachePool),X0(c,R),sn(),c.memoizedState=null):(s!==null&&Ts(c,null),Ea(),sn());return Gt(s,c,A,m),c.child}function Gi(s,c){return s!==null&&s.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function Gl(s,c,m,E,A){var R=da();return R=R===null?null:{parent:Ut._currentValue,pool:R},c.memoizedState={baseLanes:m,cachePool:R},s!==null&&Ts(c,null),Ea(),Y0(c),s!==null&&ri(s,c,E,!0),c.childLanes=A,null}function Xs(s,c){return c=Zs({mode:c.mode,children:c.children},s.mode),c.ref=s.ref,s.child=c,c.return=s,c}function Wl(s,c,m){return Tn(c,s.child,null,m),s=Xs(c,c.pendingProps),s.flags|=2,ar(c),c.memoizedState=null,s}function wd(s,c,m){var E=c.pendingProps,A=(c.flags&128)!==0;if(c.flags&=-129,s===null){if(mt){if(E.mode==="hidden")return s=Xs(c,E),c.lanes=536870912,Gi(null,s);if(wa(c),(s=Dt)?(s=ox(s,yr),s=s!==null&&s.data==="&"?s:null,s!==null&&(c.memoizedState={dehydrated:s,treeContext:Yr!==null?{id:Sr,overflow:Rr}:null,retryLane:536870912,hydrationErrors:null},m=F0(s),m.return=c,c.child=m,zt=c,Dt=null)):s=null,s===null)throw Qr(c);return c.lanes=536870912,null}return Xs(c,E)}var R=s.memoizedState;if(R!==null){var se=R.dehydrated;if(wa(c),A)if(c.flags&256)c.flags&=-257,c=Wl(s,c,m);else if(c.memoizedState!==null)c.child=s.child,c.flags|=128,c=null;else throw Error(n(558));else if(Mt||ri(s,c,m,!1),A=(m&s.childLanes)!==0,Mt||A){if(E=St,E!==null&&(se=qe(E,m),se!==0&&se!==R.retryLane))throw R.retryLane=se,Bn(s,se),nr(E,s,se),qa;oo(),c=Wl(s,c,m)}else s=R.treeContext,Dt=br(se.nextSibling),zt=c,mt=!0,Zr=null,yr=!1,s!==null&&j0(c,s),c=Xs(c,E),c.flags|=4096;return c}return s=jr(s.child,{mode:E.mode,children:E.children}),s.ref=c.ref,c.child=s,s.return=c,s}function Ys(s,c){var m=c.ref;if(m===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(n(284));(s===null||s.ref!==m)&&(c.flags|=4194816)}}function Ka(s,c,m,E,A){return Rn(c),m=Aa(s,c,m,E,void 0,A),E=Ba(),s!==null&&!Mt?(Ca(s,c,A),Mr(s,c,A)):(mt&&E&&ia(c),c.flags|=1,Gt(s,c,m,A),c.child)}function Xl(s,c,m,E,A,R){return Rn(c),c.updateQueue=null,m=Q0(c,E,m,A),Z0(s),E=Ba(),s!==null&&!Mt?(Ca(s,c,R),Mr(s,c,R)):(mt&&E&&ia(c),c.flags|=1,Gt(s,c,m,R),c.child)}function Yl(s,c,m,E,A){if(Rn(c),c.stateNode===null){var R=Qn,se=m.contextType;typeof se=="object"&&se!==null&&(R=Vt(se)),R=new m(E,R),c.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,R.updater=La,c.stateNode=R,R._reactInternals=c,R=c.stateNode,R.props=E,R.state=c.memoizedState,R.refs={},pa(c),se=m.contextType,R.context=typeof se=="object"&&se!==null?Vt(se):Qn,R.state=c.memoizedState,se=m.getDerivedStateFromProps,typeof se=="function"&&(Ma(c,m,se,E),R.state=c.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(se=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),se!==R.state&&La.enqueueReplaceState(R,R.state,null),Hi(c,E,R,A),Li(),R.state=c.memoizedState),typeof R.componentDidMount=="function"&&(c.flags|=4194308),E=!0}else if(s===null){R=c.stateNode;var pe=c.memoizedProps,De=$n(m,pe);R.props=De;var Le=R.context,ze=m.contextType;se=Qn,typeof ze=="object"&&ze!==null&&(se=Vt(ze));var Xe=m.getDerivedStateFromProps;ze=typeof Xe=="function"||typeof R.getSnapshotBeforeUpdate=="function",pe=c.pendingProps!==pe,ze||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(pe||Le!==se)&&Il(c,R,E,se),en=!1;var He=c.memoizedState;R.state=He,Hi(c,E,R,A),Li(),Le=c.memoizedState,pe||He!==Le||en?(typeof Xe=="function"&&(Ma(c,m,Xe,E),Le=c.memoizedState),(De=en||$l(c,m,De,E,He,Le,se))?(ze||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(c.flags|=4194308)):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=E,c.memoizedState=Le),R.props=E,R.state=Le,R.context=se,E=De):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),E=!1)}else{R=c.stateNode,ma(s,c),se=c.memoizedProps,ze=$n(m,se),R.props=ze,Xe=c.pendingProps,He=R.context,Le=m.contextType,De=Qn,typeof Le=="object"&&Le!==null&&(De=Vt(Le)),pe=m.getDerivedStateFromProps,(Le=typeof pe=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(se!==Xe||He!==De)&&Il(c,R,E,De),en=!1,He=c.memoizedState,R.state=He,Hi(c,E,R,A),Li();var Ke=c.memoizedState;se!==Xe||He!==Ke||en||s!==null&&s.dependencies!==null&&Fs(s.dependencies)?(typeof pe=="function"&&(Ma(c,m,pe,E),Ke=c.memoizedState),(ze=en||$l(c,m,ze,E,He,Ke,De)||s!==null&&s.dependencies!==null&&Fs(s.dependencies))?(Le||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(E,Ke,De),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(E,Ke,De)),typeof R.componentDidUpdate=="function"&&(c.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof R.componentDidUpdate!="function"||se===s.memoizedProps&&He===s.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||se===s.memoizedProps&&He===s.memoizedState||(c.flags|=1024),c.memoizedProps=E,c.memoizedState=Ke),R.props=E,R.state=Ke,R.context=De,E=ze):(typeof R.componentDidUpdate!="function"||se===s.memoizedProps&&He===s.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||se===s.memoizedProps&&He===s.memoizedState||(c.flags|=1024),E=!1)}return R=E,Ys(s,c),E=(c.flags&128)!==0,R||E?(R=c.stateNode,m=E&&typeof m.getDerivedStateFromError!="function"?null:R.render(),c.flags|=1,s!==null&&E?(c.child=Tn(c,s.child,null,A),c.child=Tn(c,null,m,A)):Gt(s,c,m,A),c.memoizedState=R.state,s=c.child):s=Mr(s,c,A),s}function Zl(s,c,m,E){return _n(),c.flags|=256,Gt(s,c,m,E),c.child}var za={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Va(s){return{baseLanes:s,cachePool:M0()}}function Ga(s,c,m){return s=s!==null?s.childLanes&~m:0,c&&(s|=lr),s}function Ql(s,c,m){var E=c.pendingProps,A=!1,R=(c.flags&128)!==0,se;if((se=R)||(se=s!==null&&s.memoizedState===null?!1:(It.current&2)!==0),se&&(A=!0,c.flags&=-129),se=(c.flags&32)!==0,c.flags&=-33,s===null){if(mt){if(A?nn(c):sn(),(s=Dt)?(s=ox(s,yr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(c.memoizedState={dehydrated:s,treeContext:Yr!==null?{id:Sr,overflow:Rr}:null,retryLane:536870912,hydrationErrors:null},m=F0(s),m.return=c,c.child=m,zt=c,Dt=null)):s=null,s===null)throw Qr(c);return Dc(s)?c.lanes=32:c.lanes=536870912,null}var pe=E.children;return E=E.fallback,A?(sn(),A=c.mode,pe=Zs({mode:"hidden",children:pe},A),E=Cn(E,A,m,null),pe.return=c,E.return=c,pe.sibling=E,c.child=pe,E=c.child,E.memoizedState=Va(m),E.childLanes=Ga(s,se,m),c.memoizedState=za,Gi(null,E)):(nn(c),Wa(c,pe))}var De=s.memoizedState;if(De!==null&&(pe=De.dehydrated,pe!==null)){if(R)c.flags&256?(nn(c),c.flags&=-257,c=Xa(s,c,m)):c.memoizedState!==null?(sn(),c.child=s.child,c.flags|=128,c=null):(sn(),pe=E.fallback,A=c.mode,E=Zs({mode:"visible",children:E.children},A),pe=Cn(pe,A,m,null),pe.flags|=2,E.return=c,pe.return=c,E.sibling=pe,c.child=E,Tn(c,s.child,null,m),E=c.child,E.memoizedState=Va(m),E.childLanes=Ga(s,se,m),c.memoizedState=za,c=Gi(null,E));else if(nn(c),Dc(pe)){if(se=pe.nextSibling&&pe.nextSibling.dataset,se)var Le=se.dgst;se=Le,E=Error(n(419)),E.stack="",E.digest=se,$i({value:E,source:null,stack:null}),c=Xa(s,c,m)}else if(Mt||ri(s,c,m,!1),se=(m&s.childLanes)!==0,Mt||se){if(se=St,se!==null&&(E=qe(se,m),E!==0&&E!==De.retryLane))throw De.retryLane=E,Bn(s,E),nr(se,s,E),qa;Rc(pe)||oo(),c=Xa(s,c,m)}else Rc(pe)?(c.flags|=192,c.child=s.child,c=null):(s=De.treeContext,Dt=br(pe.nextSibling),zt=c,mt=!0,Zr=null,yr=!1,s!==null&&j0(c,s),c=Wa(c,E.children),c.flags|=4096);return c}return A?(sn(),pe=E.fallback,A=c.mode,De=s.child,Le=De.sibling,E=jr(De,{mode:"hidden",children:E.children}),E.subtreeFlags=De.subtreeFlags&65011712,Le!==null?pe=jr(Le,pe):(pe=Cn(pe,A,m,null),pe.flags|=2),pe.return=c,E.return=c,E.sibling=pe,c.child=E,Gi(null,E),E=c.child,pe=s.child.memoizedState,pe===null?pe=Va(m):(A=pe.cachePool,A!==null?(De=Ut._currentValue,A=A.parent!==De?{parent:De,pool:De}:A):A=M0(),pe={baseLanes:pe.baseLanes|m,cachePool:A}),E.memoizedState=pe,E.childLanes=Ga(s,se,m),c.memoizedState=za,Gi(s.child,E)):(nn(c),m=s.child,s=m.sibling,m=jr(m,{mode:"visible",children:E.children}),m.return=c,m.sibling=null,s!==null&&(se=c.deletions,se===null?(c.deletions=[s],c.flags|=16):se.push(s)),c.child=m,c.memoizedState=null,m)}function Wa(s,c){return c=Zs({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function Zs(s,c){return s=sr(22,s,null,c),s.lanes=0,s}function Xa(s,c,m){return Tn(c,s.child,null,m),s=Wa(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Jl(s,c,m){s.lanes|=c;var E=s.alternate;E!==null&&(E.lanes|=c),la(s.return,c,m)}function Ya(s,c,m,E,A,R){var se=s.memoizedState;se===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:E,tail:m,tailMode:A,treeForkCount:R}:(se.isBackwards=c,se.rendering=null,se.renderingStartTime=0,se.last=E,se.tail=m,se.tailMode=A,se.treeForkCount=R)}function eu(s,c,m){var E=c.pendingProps,A=E.revealOrder,R=E.tail;E=E.children;var se=It.current,pe=(se&2)!==0;if(pe?(se=se&1|2,c.flags|=128):se&=1,J(It,se),Gt(s,c,E,m),E=mt?ji:0,!pe&&s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Jl(s,m,c);else if(s.tag===19)Jl(s,m,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(A){case"forwards":for(m=c.child,A=null;m!==null;)s=m.alternate,s!==null&&Ps(s)===null&&(A=m),m=m.sibling;m=A,m===null?(A=c.child,c.child=null):(A=m.sibling,m.sibling=null),Ya(c,!1,A,m,R,E);break;case"backwards":case"unstable_legacy-backwards":for(m=null,A=c.child,c.child=null;A!==null;){if(s=A.alternate,s!==null&&Ps(s)===null){c.child=A;break}s=A.sibling,A.sibling=m,m=A,A=s}Ya(c,!0,m,null,R,E);break;case"together":Ya(c,!1,null,null,void 0,E);break;default:c.memoizedState=null}return c.child}function Mr(s,c,m){if(s!==null&&(c.dependencies=s.dependencies),cn|=c.lanes,(m&c.childLanes)===0)if(s!==null){if(ri(s,c,m,!1),(m&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(n(153));if(c.child!==null){for(s=c.child,m=jr(s,s.pendingProps),c.child=m,m.return=c;s.sibling!==null;)s=s.sibling,m=m.sibling=jr(s,s.pendingProps),m.return=c;m.sibling=null}return c.child}function Za(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&Fs(s)))}function vd(s,c,m){switch(c.tag){case 3:de(c,c.stateNode.containerInfo),Jr(c,Ut,s.memoizedState.cache),_n();break;case 27:case 5:te(c);break;case 4:de(c,c.stateNode.containerInfo);break;case 10:Jr(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,wa(c),null;break;case 13:var E=c.memoizedState;if(E!==null)return E.dehydrated!==null?(nn(c),c.flags|=128,null):(m&c.child.childLanes)!==0?Ql(s,c,m):(nn(c),s=Mr(s,c,m),s!==null?s.sibling:null);nn(c);break;case 19:var A=(s.flags&128)!==0;if(E=(m&c.childLanes)!==0,E||(ri(s,c,m,!1),E=(m&c.childLanes)!==0),A){if(E)return eu(s,c,m);c.flags|=128}if(A=c.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),J(It,It.current),E)break;return null;case 22:return c.lanes=0,Vl(s,c,m,c.pendingProps);case 24:Jr(c,Ut,s.memoizedState.cache)}return Mr(s,c,m)}function tu(s,c,m){if(s!==null)if(s.memoizedProps!==c.pendingProps)Mt=!0;else{if(!Za(s,m)&&(c.flags&128)===0)return Mt=!1,vd(s,c,m);Mt=(s.flags&131072)!==0}else Mt=!1,mt&&(c.flags&1048576)!==0&&T0(c,ji,c.index);switch(c.lanes=0,c.tag){case 16:e:{var E=c.pendingProps;if(s=kn(c.elementType),c.type=s,typeof s=="function")ta(s)?(E=$n(s,E),c.tag=1,c=Yl(null,c,s,E,m)):(c.tag=0,c=Ka(null,c,s,E,m));else{if(s!=null){var A=s.$$typeof;if(A===N){c.tag=11,c=ql(null,c,s,E,m);break e}else if(A===S){c.tag=14,c=Kl(null,c,s,E,m);break e}}throw c=G(s)||s,Error(n(306,c,""))}}return c;case 0:return Ka(s,c,c.type,c.pendingProps,m);case 1:return E=c.type,A=$n(E,c.pendingProps),Yl(s,c,E,A,m);case 3:e:{if(de(c,c.stateNode.containerInfo),s===null)throw Error(n(387));E=c.pendingProps;var R=c.memoizedState;A=R.element,ma(s,c),Hi(c,E,null,m);var se=c.memoizedState;if(E=se.cache,Jr(c,Ut,E),E!==R.cache&&ua(c,[Ut],m,!0),Li(),E=se.element,R.isDehydrated)if(R={element:E,isDehydrated:!1,cache:se.cache},c.updateQueue.baseState=R,c.memoizedState=R,c.flags&256){c=Zl(s,c,E,m);break e}else if(E!==A){A=pr(Error(n(424)),c),$i(A),c=Zl(s,c,E,m);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Dt=br(s.firstChild),zt=c,mt=!0,Zr=null,yr=!0,m=V0(c,null,E,m),c.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(_n(),E===A){c=Mr(s,c,m);break e}Gt(s,c,E,m)}c=c.child}return c;case 26:return Ys(s,c),s===null?(m=fx(c.type,null,c.pendingProps,null))?c.memoizedState=m:mt||(m=c.type,s=c.pendingProps,E=ho(oe.current).createElement(m),E[ot]=c,E[Zt]=s,Wt(E,m,s),qt(E),c.stateNode=E):c.memoizedState=fx(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return te(c),s===null&&mt&&(E=c.stateNode=lx(c.type,c.pendingProps,oe.current),zt=c,yr=!0,A=Dt,dn(c.type)?(kc=A,Dt=br(E.firstChild)):Dt=A),Gt(s,c,c.pendingProps.children,m),Ys(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&mt&&((A=E=Dt)&&(E=Qd(E,c.type,c.pendingProps,yr),E!==null?(c.stateNode=E,zt=c,Dt=br(E.firstChild),yr=!1,A=!0):A=!1),A||Qr(c)),te(c),A=c.type,R=c.pendingProps,se=s!==null?s.memoizedProps:null,E=R.children,Cc(A,R)?E=null:se!==null&&Cc(A,se)&&(c.flags|=32),c.memoizedState!==null&&(A=Aa(s,c,dd,null,null,m),ls._currentValue=A),Ys(s,c),Gt(s,c,E,m),c.child;case 6:return s===null&&mt&&((s=m=Dt)&&(m=Jd(m,c.pendingProps,yr),m!==null?(c.stateNode=m,zt=c,Dt=null,s=!0):s=!1),s||Qr(c)),null;case 13:return Ql(s,c,m);case 4:return de(c,c.stateNode.containerInfo),E=c.pendingProps,s===null?c.child=Tn(c,null,E,m):Gt(s,c,E,m),c.child;case 11:return ql(s,c,c.type,c.pendingProps,m);case 7:return Gt(s,c,c.pendingProps,m),c.child;case 8:return Gt(s,c,c.pendingProps.children,m),c.child;case 12:return Gt(s,c,c.pendingProps.children,m),c.child;case 10:return E=c.pendingProps,Jr(c,c.type,E.value),Gt(s,c,E.children,m),c.child;case 9:return A=c.type._context,E=c.pendingProps.children,Rn(c),A=Vt(A),E=E(A),c.flags|=1,Gt(s,c,E,m),c.child;case 14:return Kl(s,c,c.type,c.pendingProps,m);case 15:return zl(s,c,c.type,c.pendingProps,m);case 19:return eu(s,c,m);case 31:return wd(s,c,m);case 22:return Vl(s,c,m,c.pendingProps);case 24:return Rn(c),E=Vt(Ut),s===null?(A=da(),A===null&&(A=St,R=xa(),A.pooledCache=R,R.refCount++,R!==null&&(A.pooledCacheLanes|=m),A=R),c.memoizedState={parent:E,cache:A},pa(c),Jr(c,Ut,A)):((s.lanes&m)!==0&&(ma(s,c),Hi(c,null,null,m),Li()),A=s.memoizedState,R=c.memoizedState,A.parent!==E?(A={parent:E,cache:E},c.memoizedState=A,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=A),Jr(c,Ut,E)):(E=R.cache,Jr(c,Ut,E),E!==A.cache&&ua(c,[Ut],m,!0))),Gt(s,c,c.pendingProps.children,m),c.child;case 29:throw c.pendingProps}throw Error(n(156,c.tag))}function Lr(s){s.flags|=4}function Qa(s,c,m,E,A){if((c=(s.mode&32)!==0)&&(c=!1),c){if(s.flags|=16777216,(A&335544128)===A)if(s.stateNode.complete)s.flags|=8192;else if(Ru())s.flags|=8192;else throw Nn=$s,ha}else s.flags&=-16777217}function ru(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!gx(c))if(Ru())s.flags|=8192;else throw Nn=$s,ha}function Qs(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?ds():536870912,s.lanes|=c,hi|=c)}function Wi(s,c){if(!mt)switch(s.tailMode){case"hidden":c=s.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?s.tail=null:m.sibling=null;break;case"collapsed":m=s.tail;for(var E=null;m!==null;)m.alternate!==null&&(E=m),m=m.sibling;E===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:E.sibling=null}}function kt(s){var c=s.alternate!==null&&s.alternate.child===s.child,m=0,E=0;if(c)for(var A=s.child;A!==null;)m|=A.lanes|A.childLanes,E|=A.subtreeFlags&65011712,E|=A.flags&65011712,A.return=s,A=A.sibling;else for(A=s.child;A!==null;)m|=A.lanes|A.childLanes,E|=A.subtreeFlags,E|=A.flags,A.return=s,A=A.sibling;return s.subtreeFlags|=E,s.childLanes=m,c}function Ad(s,c,m){var E=c.pendingProps;switch(sa(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(c),null;case 1:return kt(c),null;case 3:return m=c.stateNode,E=null,s!==null&&(E=s.memoizedState.cache),c.memoizedState.cache!==E&&(c.flags|=2048),Or(Ut),xe(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(ti(c)?Lr(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,aa())),kt(c),null;case 26:var A=c.type,R=c.memoizedState;return s===null?(Lr(c),R!==null?(kt(c),ru(c,R)):(kt(c),Qa(c,A,null,E,m))):R?R!==s.memoizedState?(Lr(c),kt(c),ru(c,R)):(kt(c),c.flags&=-16777217):(s=s.memoizedProps,s!==E&&Lr(c),kt(c),Qa(c,A,s,E,m)),null;case 27:if(ae(c),m=oe.current,A=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==E&&Lr(c);else{if(!E){if(c.stateNode===null)throw Error(n(166));return kt(c),null}s=L.current,ti(c)?$0(c):(s=lx(A,E,m),c.stateNode=s,Lr(c))}return kt(c),null;case 5:if(ae(c),A=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==E&&Lr(c);else{if(!E){if(c.stateNode===null)throw Error(n(166));return kt(c),null}if(R=L.current,ti(c))$0(c);else{var se=ho(oe.current);switch(R){case 1:R=se.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:R=se.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":R=se.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":R=se.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":R=se.createElement("div"),R.innerHTML="<script><\/script>",R=R.removeChild(R.firstChild);break;case"select":R=typeof E.is=="string"?se.createElement("select",{is:E.is}):se.createElement("select"),E.multiple?R.multiple=!0:E.size&&(R.size=E.size);break;default:R=typeof E.is=="string"?se.createElement(A,{is:E.is}):se.createElement(A)}}R[ot]=c,R[Zt]=E;e:for(se=c.child;se!==null;){if(se.tag===5||se.tag===6)R.appendChild(se.stateNode);else if(se.tag!==4&&se.tag!==27&&se.child!==null){se.child.return=se,se=se.child;continue}if(se===c)break e;for(;se.sibling===null;){if(se.return===null||se.return===c)break e;se=se.return}se.sibling.return=se.return,se=se.sibling}c.stateNode=R;e:switch(Wt(R,A,E),A){case"button":case"input":case"select":case"textarea":E=!!E.autoFocus;break e;case"img":E=!0;break e;default:E=!1}E&&Lr(c)}}return kt(c),Qa(c,c.type,s===null?null:s.memoizedProps,c.pendingProps,m),null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==E&&Lr(c);else{if(typeof E!="string"&&c.stateNode===null)throw Error(n(166));if(s=oe.current,ti(c)){if(s=c.stateNode,m=c.memoizedProps,E=null,A=zt,A!==null)switch(A.tag){case 27:case 5:E=A.memoizedProps}s[ot]=c,s=!!(s.nodeValue===m||E!==null&&E.suppressHydrationWarning===!0||Qu(s.nodeValue,m)),s||Qr(c,!0)}else s=ho(s).createTextNode(E),s[ot]=c,c.stateNode=s}return kt(c),null;case 31:if(m=c.memoizedState,s===null||s.memoizedState!==null){if(E=ti(c),m!==null){if(s===null){if(!E)throw Error(n(318));if(s=c.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[ot]=c}else _n(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;kt(c),s=!1}else m=aa(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),s=!0;if(!s)return c.flags&256?(ar(c),c):(ar(c),null);if((c.flags&128)!==0)throw Error(n(558))}return kt(c),null;case 13:if(E=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(A=ti(c),E!==null&&E.dehydrated!==null){if(s===null){if(!A)throw Error(n(318));if(A=c.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));A[ot]=c}else _n(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;kt(c),A=!1}else A=aa(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=A),A=!0;if(!A)return c.flags&256?(ar(c),c):(ar(c),null)}return ar(c),(c.flags&128)!==0?(c.lanes=m,c):(m=E!==null,s=s!==null&&s.memoizedState!==null,m&&(E=c.child,A=null,E.alternate!==null&&E.alternate.memoizedState!==null&&E.alternate.memoizedState.cachePool!==null&&(A=E.alternate.memoizedState.cachePool.pool),R=null,E.memoizedState!==null&&E.memoizedState.cachePool!==null&&(R=E.memoizedState.cachePool.pool),R!==A&&(E.flags|=2048)),m!==s&&m&&(c.child.flags|=8192),Qs(c,c.updateQueue),kt(c),null);case 4:return xe(),s===null&&bc(c.stateNode.containerInfo),kt(c),null;case 10:return Or(c.type),kt(c),null;case 19:if(Y(It),E=c.memoizedState,E===null)return kt(c),null;if(A=(c.flags&128)!==0,R=E.rendering,R===null)if(A)Wi(E,!1);else{if(Tt!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(R=Ps(s),R!==null){for(c.flags|=128,Wi(E,!1),s=R.updateQueue,c.updateQueue=s,Qs(c,s),c.subtreeFlags=0,s=m,m=c.child;m!==null;)k0(m,s),m=m.sibling;return J(It,It.current&1|2),mt&&$r(c,E.treeForkCount),c.child}s=s.sibling}E.tail!==null&&Ee()>no&&(c.flags|=128,A=!0,Wi(E,!1),c.lanes=4194304)}else{if(!A)if(s=Ps(R),s!==null){if(c.flags|=128,A=!0,s=s.updateQueue,c.updateQueue=s,Qs(c,s),Wi(E,!0),E.tail===null&&E.tailMode==="hidden"&&!R.alternate&&!mt)return kt(c),null}else 2*Ee()-E.renderingStartTime>no&&m!==536870912&&(c.flags|=128,A=!0,Wi(E,!1),c.lanes=4194304);E.isBackwards?(R.sibling=c.child,c.child=R):(s=E.last,s!==null?s.sibling=R:c.child=R,E.last=R)}return E.tail!==null?(s=E.tail,E.rendering=s,E.tail=s.sibling,E.renderingStartTime=Ee(),s.sibling=null,m=It.current,J(It,A?m&1|2:m&1),mt&&$r(c,E.treeForkCount),s):(kt(c),null);case 22:case 23:return ar(c),ba(),E=c.memoizedState!==null,s!==null?s.memoizedState!==null!==E&&(c.flags|=8192):E&&(c.flags|=8192),E?(m&536870912)!==0&&(c.flags&128)===0&&(kt(c),c.subtreeFlags&6&&(c.flags|=8192)):kt(c),m=c.updateQueue,m!==null&&Qs(c,m.retryQueue),m=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),E=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(E=c.memoizedState.cachePool.pool),E!==m&&(c.flags|=2048),s!==null&&Y(Dn),null;case 24:return m=null,s!==null&&(m=s.memoizedState.cache),c.memoizedState.cache!==m&&(c.flags|=2048),Or(Ut),kt(c),null;case 25:return null;case 30:return null}throw Error(n(156,c.tag))}function Bd(s,c){switch(sa(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return Or(Ut),xe(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return ae(c),null;case 31:if(c.memoizedState!==null){if(ar(c),c.alternate===null)throw Error(n(340));_n()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 13:if(ar(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(n(340));_n()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return Y(It),null;case 4:return xe(),null;case 10:return Or(c.type),null;case 22:case 23:return ar(c),ba(),s!==null&&Y(Dn),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return Or(Ut),null;case 25:return null;default:return null}}function nu(s,c){switch(sa(c),c.tag){case 3:Or(Ut),xe();break;case 26:case 27:case 5:ae(c);break;case 4:xe();break;case 31:c.memoizedState!==null&&ar(c);break;case 13:ar(c);break;case 19:Y(It);break;case 10:Or(c.type);break;case 22:case 23:ar(c),ba(),s!==null&&Y(Dn);break;case 24:Or(Ut)}}function Xi(s,c){try{var m=c.updateQueue,E=m!==null?m.lastEffect:null;if(E!==null){var A=E.next;m=A;do{if((m.tag&s)===s){E=void 0;var R=m.create,se=m.inst;E=R(),se.destroy=E}m=m.next}while(m!==A)}}catch(pe){vt(c,c.return,pe)}}function on(s,c,m){try{var E=c.updateQueue,A=E!==null?E.lastEffect:null;if(A!==null){var R=A.next;E=R;do{if((E.tag&s)===s){var se=E.inst,pe=se.destroy;if(pe!==void 0){se.destroy=void 0,A=c;var De=m,Le=pe;try{Le()}catch(ze){vt(A,De,ze)}}}E=E.next}while(E!==R)}}catch(ze){vt(c,c.return,ze)}}function iu(s){var c=s.updateQueue;if(c!==null){var m=s.stateNode;try{W0(c,m)}catch(E){vt(s,s.return,E)}}}function su(s,c,m){m.props=$n(s.type,s.memoizedProps),m.state=s.memoizedState;try{m.componentWillUnmount()}catch(E){vt(s,c,E)}}function Yi(s,c){try{var m=s.ref;if(m!==null){switch(s.tag){case 26:case 27:case 5:var E=s.stateNode;break;case 30:E=s.stateNode;break;default:E=s.stateNode}typeof m=="function"?s.refCleanup=m(E):m.current=E}}catch(A){vt(s,c,A)}}function Dr(s,c){var m=s.ref,E=s.refCleanup;if(m!==null)if(typeof E=="function")try{E()}catch(A){vt(s,c,A)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(A){vt(s,c,A)}else m.current=null}function ou(s){var c=s.type,m=s.memoizedProps,E=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":m.autoFocus&&E.focus();break e;case"img":m.src?E.src=m.src:m.srcSet&&(E.srcset=m.srcSet)}}catch(A){vt(s,s.return,A)}}function Ja(s,c,m){try{var E=s.stateNode;Vd(E,s.type,m,c),E[Zt]=c}catch(A){vt(s,s.return,A)}}function au(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&dn(s.type)||s.tag===4}function ec(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||au(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&dn(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function tc(s,c,m){var E=s.tag;if(E===5||E===6)s=s.stateNode,c?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(s,c):(c=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,c.appendChild(s),m=m._reactRootContainer,m!=null||c.onclick!==null||(c.onclick=Nr));else if(E!==4&&(E===27&&dn(s.type)&&(m=s.stateNode,c=null),s=s.child,s!==null))for(tc(s,c,m),s=s.sibling;s!==null;)tc(s,c,m),s=s.sibling}function Js(s,c,m){var E=s.tag;if(E===5||E===6)s=s.stateNode,c?m.insertBefore(s,c):m.appendChild(s);else if(E!==4&&(E===27&&dn(s.type)&&(m=s.stateNode),s=s.child,s!==null))for(Js(s,c,m),s=s.sibling;s!==null;)Js(s,c,m),s=s.sibling}function cu(s){var c=s.stateNode,m=s.memoizedProps;try{for(var E=s.type,A=c.attributes;A.length;)c.removeAttributeNode(A[0]);Wt(c,E,m),c[ot]=s,c[Zt]=m}catch(R){vt(s,s.return,R)}}var Hr=!1,Lt=!1,rc=!1,lu=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function Cd(s,c){if(s=s.containerInfo,Ac=wo,s=w0(s),Wo(s)){if("selectionStart"in s)var m={start:s.selectionStart,end:s.selectionEnd};else e:{m=(m=s.ownerDocument)&&m.defaultView||window;var E=m.getSelection&&m.getSelection();if(E&&E.rangeCount!==0){m=E.anchorNode;var A=E.anchorOffset,R=E.focusNode;E=E.focusOffset;try{m.nodeType,R.nodeType}catch{m=null;break e}var se=0,pe=-1,De=-1,Le=0,ze=0,Xe=s,He=null;t:for(;;){for(var Ke;Xe!==m||A!==0&&Xe.nodeType!==3||(pe=se+A),Xe!==R||E!==0&&Xe.nodeType!==3||(De=se+E),Xe.nodeType===3&&(se+=Xe.nodeValue.length),(Ke=Xe.firstChild)!==null;)He=Xe,Xe=Ke;for(;;){if(Xe===s)break t;if(He===m&&++Le===A&&(pe=se),He===R&&++ze===E&&(De=se),(Ke=Xe.nextSibling)!==null)break;Xe=He,He=Xe.parentNode}Xe=Ke}m=pe===-1||De===-1?null:{start:pe,end:De}}else m=null}m=m||{start:0,end:0}}else m=null;for(Bc={focusedElem:s,selectionRange:m},wo=!1,Kt=c;Kt!==null;)if(c=Kt,s=c.child,(c.subtreeFlags&1028)!==0&&s!==null)s.return=c,Kt=s;else for(;Kt!==null;){switch(c=Kt,R=c.alternate,s=c.flags,c.tag){case 0:if((s&4)!==0&&(s=c.updateQueue,s=s!==null?s.events:null,s!==null))for(m=0;m<s.length;m++)A=s[m],A.ref.impl=A.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&R!==null){s=void 0,m=c,A=R.memoizedProps,R=R.memoizedState,E=m.stateNode;try{var Qe=$n(m.type,A);s=E.getSnapshotBeforeUpdate(Qe,R),E.__reactInternalSnapshotBeforeUpdate=s}catch(it){vt(m,m.return,it)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,m=s.nodeType,m===9)Sc(s);else if(m===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Sc(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=c.sibling,s!==null){s.return=c.return,Kt=s;break}Kt=c.return}}function uu(s,c,m){var E=m.flags;switch(m.tag){case 0:case 11:case 15:Kr(s,m),E&4&&Xi(5,m);break;case 1:if(Kr(s,m),E&4)if(s=m.stateNode,c===null)try{s.componentDidMount()}catch(se){vt(m,m.return,se)}else{var A=$n(m.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(A,c,s.__reactInternalSnapshotBeforeUpdate)}catch(se){vt(m,m.return,se)}}E&64&&iu(m),E&512&&Yi(m,m.return);break;case 3:if(Kr(s,m),E&64&&(s=m.updateQueue,s!==null)){if(c=null,m.child!==null)switch(m.child.tag){case 27:case 5:c=m.child.stateNode;break;case 1:c=m.child.stateNode}try{W0(s,c)}catch(se){vt(m,m.return,se)}}break;case 27:c===null&&E&4&&cu(m);case 26:case 5:Kr(s,m),c===null&&E&4&&ou(m),E&512&&Yi(m,m.return);break;case 12:Kr(s,m);break;case 31:Kr(s,m),E&4&&du(s,m);break;case 13:Kr(s,m),E&4&&hu(s,m),E&64&&(s=m.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(m=jd.bind(null,m),eh(s,m))));break;case 22:if(E=m.memoizedState!==null||Hr,!E){c=c!==null&&c.memoizedState!==null||Lt,A=Hr;var R=Lt;Hr=E,(Lt=c)&&!R?zr(s,m,(m.subtreeFlags&8772)!==0):Kr(s,m),Hr=A,Lt=R}break;case 30:break;default:Kr(s,m)}}function xu(s){var c=s.alternate;c!==null&&(s.alternate=null,xu(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&Fo(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ft=null,Jt=!1;function qr(s,c,m){for(m=m.child;m!==null;)fu(s,c,m),m=m.sibling}function fu(s,c,m){if(_e&&typeof _e.onCommitFiberUnmount=="function")try{_e.onCommitFiberUnmount(he,m)}catch{}switch(m.tag){case 26:Lt||Dr(m,c),qr(s,c,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Lt||Dr(m,c);var E=Ft,A=Jt;dn(m.type)&&(Ft=m.stateNode,Jt=!1),qr(s,c,m),os(m.stateNode),Ft=E,Jt=A;break;case 5:Lt||Dr(m,c);case 6:if(E=Ft,A=Jt,Ft=null,qr(s,c,m),Ft=E,Jt=A,Ft!==null)if(Jt)try{(Ft.nodeType===9?Ft.body:Ft.nodeName==="HTML"?Ft.ownerDocument.body:Ft).removeChild(m.stateNode)}catch(R){vt(m,c,R)}else try{Ft.removeChild(m.stateNode)}catch(R){vt(m,c,R)}break;case 18:Ft!==null&&(Jt?(s=Ft,ix(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,m.stateNode),vi(s)):ix(Ft,m.stateNode));break;case 4:E=Ft,A=Jt,Ft=m.stateNode.containerInfo,Jt=!0,qr(s,c,m),Ft=E,Jt=A;break;case 0:case 11:case 14:case 15:on(2,m,c),Lt||on(4,m,c),qr(s,c,m);break;case 1:Lt||(Dr(m,c),E=m.stateNode,typeof E.componentWillUnmount=="function"&&su(m,c,E)),qr(s,c,m);break;case 21:qr(s,c,m);break;case 22:Lt=(E=Lt)||m.memoizedState!==null,qr(s,c,m),Lt=E;break;default:qr(s,c,m)}}function du(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{vi(s)}catch(m){vt(c,c.return,m)}}}function hu(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{vi(s)}catch(m){vt(c,c.return,m)}}function _d(s){switch(s.tag){case 31:case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new lu),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new lu),c;default:throw Error(n(435,s.tag))}}function eo(s,c){var m=_d(s);c.forEach(function(E){if(!m.has(E)){m.add(E);var A=$d.bind(null,s,E);E.then(A,A)}})}function er(s,c){var m=c.deletions;if(m!==null)for(var E=0;E<m.length;E++){var A=m[E],R=s,se=c,pe=se;e:for(;pe!==null;){switch(pe.tag){case 27:if(dn(pe.type)){Ft=pe.stateNode,Jt=!1;break e}break;case 5:Ft=pe.stateNode,Jt=!1;break e;case 3:case 4:Ft=pe.stateNode.containerInfo,Jt=!0;break e}pe=pe.return}if(Ft===null)throw Error(n(160));fu(R,se,A),Ft=null,Jt=!1,R=A.alternate,R!==null&&(R.return=null),A.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)pu(c,s),c=c.sibling}var Br=null;function pu(s,c){var m=s.alternate,E=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:er(c,s),tr(s),E&4&&(on(3,s,s.return),Xi(3,s),on(5,s,s.return));break;case 1:er(c,s),tr(s),E&512&&(Lt||m===null||Dr(m,m.return)),E&64&&Hr&&(s=s.updateQueue,s!==null&&(E=s.callbacks,E!==null&&(m=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=m===null?E:m.concat(E))));break;case 26:var A=Br;if(er(c,s),tr(s),E&512&&(Lt||m===null||Dr(m,m.return)),E&4){var R=m!==null?m.memoizedState:null;if(E=s.memoizedState,m===null)if(E===null)if(s.stateNode===null){e:{E=s.type,m=s.memoizedProps,A=A.ownerDocument||A;t:switch(E){case"title":R=A.getElementsByTagName("title")[0],(!R||R[Ai]||R[ot]||R.namespaceURI==="http://www.w3.org/2000/svg"||R.hasAttribute("itemprop"))&&(R=A.createElement(E),A.head.insertBefore(R,A.querySelector("head > title"))),Wt(R,E,m),R[ot]=s,qt(R),E=R;break e;case"link":var se=px("link","href",A).get(E+(m.href||""));if(se){for(var pe=0;pe<se.length;pe++)if(R=se[pe],R.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&R.getAttribute("rel")===(m.rel==null?null:m.rel)&&R.getAttribute("title")===(m.title==null?null:m.title)&&R.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){se.splice(pe,1);break t}}R=A.createElement(E),Wt(R,E,m),A.head.appendChild(R);break;case"meta":if(se=px("meta","content",A).get(E+(m.content||""))){for(pe=0;pe<se.length;pe++)if(R=se[pe],R.getAttribute("content")===(m.content==null?null:""+m.content)&&R.getAttribute("name")===(m.name==null?null:m.name)&&R.getAttribute("property")===(m.property==null?null:m.property)&&R.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&R.getAttribute("charset")===(m.charSet==null?null:m.charSet)){se.splice(pe,1);break t}}R=A.createElement(E),Wt(R,E,m),A.head.appendChild(R);break;default:throw Error(n(468,E))}R[ot]=s,qt(R),E=R}s.stateNode=E}else mx(A,s.type,s.stateNode);else s.stateNode=hx(A,E,s.memoizedProps);else R!==E?(R===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):R.count--,E===null?mx(A,s.type,s.stateNode):hx(A,E,s.memoizedProps)):E===null&&s.stateNode!==null&&Ja(s,s.memoizedProps,m.memoizedProps)}break;case 27:er(c,s),tr(s),E&512&&(Lt||m===null||Dr(m,m.return)),m!==null&&E&4&&Ja(s,s.memoizedProps,m.memoizedProps);break;case 5:if(er(c,s),tr(s),E&512&&(Lt||m===null||Dr(m,m.return)),s.flags&32){A=s.stateNode;try{zn(A,"")}catch(Qe){vt(s,s.return,Qe)}}E&4&&s.stateNode!=null&&(A=s.memoizedProps,Ja(s,A,m!==null?m.memoizedProps:A)),E&1024&&(rc=!0);break;case 6:if(er(c,s),tr(s),E&4){if(s.stateNode===null)throw Error(n(162));E=s.memoizedProps,m=s.stateNode;try{m.nodeValue=E}catch(Qe){vt(s,s.return,Qe)}}break;case 3:if(go=null,A=Br,Br=po(c.containerInfo),er(c,s),Br=A,tr(s),E&4&&m!==null&&m.memoizedState.isDehydrated)try{vi(c.containerInfo)}catch(Qe){vt(s,s.return,Qe)}rc&&(rc=!1,mu(s));break;case 4:E=Br,Br=po(s.stateNode.containerInfo),er(c,s),tr(s),Br=E;break;case 12:er(c,s),tr(s);break;case 31:er(c,s),tr(s),E&4&&(E=s.updateQueue,E!==null&&(s.updateQueue=null,eo(s,E)));break;case 13:er(c,s),tr(s),s.child.flags&8192&&s.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(ro=Ee()),E&4&&(E=s.updateQueue,E!==null&&(s.updateQueue=null,eo(s,E)));break;case 22:A=s.memoizedState!==null;var De=m!==null&&m.memoizedState!==null,Le=Hr,ze=Lt;if(Hr=Le||A,Lt=ze||De,er(c,s),Lt=ze,Hr=Le,tr(s),E&8192)e:for(c=s.stateNode,c._visibility=A?c._visibility&-2:c._visibility|1,A&&(m===null||De||Hr||Lt||In(s)),m=null,c=s;;){if(c.tag===5||c.tag===26){if(m===null){De=m=c;try{if(R=De.stateNode,A)se=R.style,typeof se.setProperty=="function"?se.setProperty("display","none","important"):se.display="none";else{pe=De.stateNode;var Xe=De.memoizedProps.style,He=Xe!=null&&Xe.hasOwnProperty("display")?Xe.display:null;pe.style.display=He==null||typeof He=="boolean"?"":(""+He).trim()}}catch(Qe){vt(De,De.return,Qe)}}}else if(c.tag===6){if(m===null){De=c;try{De.stateNode.nodeValue=A?"":De.memoizedProps}catch(Qe){vt(De,De.return,Qe)}}}else if(c.tag===18){if(m===null){De=c;try{var Ke=De.stateNode;A?sx(Ke,!0):sx(De.stateNode,!1)}catch(Qe){vt(De,De.return,Qe)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;m===c&&(m=null),c=c.return}m===c&&(m=null),c.sibling.return=c.return,c=c.sibling}E&4&&(E=s.updateQueue,E!==null&&(m=E.retryQueue,m!==null&&(E.retryQueue=null,eo(s,m))));break;case 19:er(c,s),tr(s),E&4&&(E=s.updateQueue,E!==null&&(s.updateQueue=null,eo(s,E)));break;case 30:break;case 21:break;default:er(c,s),tr(s)}}function tr(s){var c=s.flags;if(c&2){try{for(var m,E=s.return;E!==null;){if(au(E)){m=E;break}E=E.return}if(m==null)throw Error(n(160));switch(m.tag){case 27:var A=m.stateNode,R=ec(s);Js(s,R,A);break;case 5:var se=m.stateNode;m.flags&32&&(zn(se,""),m.flags&=-33);var pe=ec(s);Js(s,pe,se);break;case 3:case 4:var De=m.stateNode.containerInfo,Le=ec(s);tc(s,Le,De);break;default:throw Error(n(161))}}catch(ze){vt(s,s.return,ze)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function mu(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;mu(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Kr(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)uu(s,c.alternate,c),c=c.sibling}function In(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:on(4,c,c.return),In(c);break;case 1:Dr(c,c.return);var m=c.stateNode;typeof m.componentWillUnmount=="function"&&su(c,c.return,m),In(c);break;case 27:os(c.stateNode);case 26:case 5:Dr(c,c.return),In(c);break;case 22:c.memoizedState===null&&In(c);break;case 30:In(c);break;default:In(c)}s=s.sibling}}function zr(s,c,m){for(m=m&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var E=c.alternate,A=s,R=c,se=R.flags;switch(R.tag){case 0:case 11:case 15:zr(A,R,m),Xi(4,R);break;case 1:if(zr(A,R,m),E=R,A=E.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Le){vt(E,E.return,Le)}if(E=R,A=E.updateQueue,A!==null){var pe=E.stateNode;try{var De=A.shared.hiddenCallbacks;if(De!==null)for(A.shared.hiddenCallbacks=null,A=0;A<De.length;A++)G0(De[A],pe)}catch(Le){vt(E,E.return,Le)}}m&&se&64&&iu(R),Yi(R,R.return);break;case 27:cu(R);case 26:case 5:zr(A,R,m),m&&E===null&&se&4&&ou(R),Yi(R,R.return);break;case 12:zr(A,R,m);break;case 31:zr(A,R,m),m&&se&4&&du(A,R);break;case 13:zr(A,R,m),m&&se&4&&hu(A,R);break;case 22:R.memoizedState===null&&zr(A,R,m),Yi(R,R.return);break;case 30:break;default:zr(A,R,m)}c=c.sibling}}function nc(s,c){var m=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==m&&(s!=null&&s.refCount++,m!=null&&Ii(m))}function ic(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Ii(s))}function Cr(s,c,m,E){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)gu(s,c,m,E),c=c.sibling}function gu(s,c,m,E){var A=c.flags;switch(c.tag){case 0:case 11:case 15:Cr(s,c,m,E),A&2048&&Xi(9,c);break;case 1:Cr(s,c,m,E);break;case 3:Cr(s,c,m,E),A&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Ii(s)));break;case 12:if(A&2048){Cr(s,c,m,E),s=c.stateNode;try{var R=c.memoizedProps,se=R.id,pe=R.onPostCommit;typeof pe=="function"&&pe(se,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(De){vt(c,c.return,De)}}else Cr(s,c,m,E);break;case 31:Cr(s,c,m,E);break;case 13:Cr(s,c,m,E);break;case 23:break;case 22:R=c.stateNode,se=c.alternate,c.memoizedState!==null?R._visibility&2?Cr(s,c,m,E):Zi(s,c):R._visibility&2?Cr(s,c,m,E):(R._visibility|=2,xi(s,c,m,E,(c.subtreeFlags&10256)!==0||!1)),A&2048&&nc(se,c);break;case 24:Cr(s,c,m,E),A&2048&&ic(c.alternate,c);break;default:Cr(s,c,m,E)}}function xi(s,c,m,E,A){for(A=A&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var R=s,se=c,pe=m,De=E,Le=se.flags;switch(se.tag){case 0:case 11:case 15:xi(R,se,pe,De,A),Xi(8,se);break;case 23:break;case 22:var ze=se.stateNode;se.memoizedState!==null?ze._visibility&2?xi(R,se,pe,De,A):Zi(R,se):(ze._visibility|=2,xi(R,se,pe,De,A)),A&&Le&2048&&nc(se.alternate,se);break;case 24:xi(R,se,pe,De,A),A&&Le&2048&&ic(se.alternate,se);break;default:xi(R,se,pe,De,A)}c=c.sibling}}function Zi(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var m=s,E=c,A=E.flags;switch(E.tag){case 22:Zi(m,E),A&2048&&nc(E.alternate,E);break;case 24:Zi(m,E),A&2048&&ic(E.alternate,E);break;default:Zi(m,E)}c=c.sibling}}var Qi=8192;function fi(s,c,m){if(s.subtreeFlags&Qi)for(s=s.child;s!==null;)yu(s,c,m),s=s.sibling}function yu(s,c,m){switch(s.tag){case 26:fi(s,c,m),s.flags&Qi&&s.memoizedState!==null&&fh(m,Br,s.memoizedState,s.memoizedProps);break;case 5:fi(s,c,m);break;case 3:case 4:var E=Br;Br=po(s.stateNode.containerInfo),fi(s,c,m),Br=E;break;case 22:s.memoizedState===null&&(E=s.alternate,E!==null&&E.memoizedState!==null?(E=Qi,Qi=16777216,fi(s,c,m),Qi=E):fi(s,c,m));break;default:fi(s,c,m)}}function Eu(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Ji(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var m=0;m<c.length;m++){var E=c[m];Kt=E,wu(E,s)}Eu(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)bu(s),s=s.sibling}function bu(s){switch(s.tag){case 0:case 11:case 15:Ji(s),s.flags&2048&&on(9,s,s.return);break;case 3:Ji(s);break;case 12:Ji(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,to(s)):Ji(s);break;default:Ji(s)}}function to(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var m=0;m<c.length;m++){var E=c[m];Kt=E,wu(E,s)}Eu(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:on(8,c,c.return),to(c);break;case 22:m=c.stateNode,m._visibility&2&&(m._visibility&=-3,to(c));break;default:to(c)}s=s.sibling}}function wu(s,c){for(;Kt!==null;){var m=Kt;switch(m.tag){case 0:case 11:case 15:on(8,m,c);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var E=m.memoizedState.cachePool.pool;E!=null&&E.refCount++}break;case 24:Ii(m.memoizedState.cache)}if(E=m.child,E!==null)E.return=m,Kt=E;else e:for(m=s;Kt!==null;){E=Kt;var A=E.sibling,R=E.return;if(xu(E),E===m){Kt=null;break e}if(A!==null){A.return=R,Kt=A;break e}Kt=R}}}var Sd={getCacheForType:function(s){var c=Vt(Ut),m=c.data.get(s);return m===void 0&&(m=s(),c.data.set(s,m)),m},cacheSignal:function(){return Vt(Ut).controller.signal}},Rd=typeof WeakMap=="function"?WeakMap:Map,bt=0,St=null,xt=null,ht=0,wt=0,cr=null,an=!1,di=!1,sc=!1,Vr=0,Tt=0,cn=0,On=0,oc=0,lr=0,hi=0,es=null,rr=null,ac=!1,ro=0,vu=0,no=1/0,io=null,ln=null,Ht=0,un=null,pi=null,Gr=0,cc=0,lc=null,Au=null,ts=0,uc=null;function xr(){return(bt&2)!==0&&ht!==0?ht&-ht:M.T!==null?mc():Rt()}function Bu(){if(lr===0)if((ht&536870912)===0||mt){var s=nt;nt<<=1,(nt&3932160)===0&&(nt=262144),lr=s}else lr=536870912;return s=or.current,s!==null&&(s.flags|=32),lr}function nr(s,c,m){(s===St&&(wt===2||wt===9)||s.cancelPendingCommit!==null)&&(mi(s,0),xn(s,ht,lr,!1)),re(s,m),((bt&2)===0||s!==St)&&(s===St&&((bt&2)===0&&(On|=m),Tt===4&&xn(s,ht,lr,!1)),kr(s))}function Cu(s,c,m){if((bt&6)!==0)throw Error(n(327));var E=!m&&(c&127)===0&&(c&s.expiredLanes)===0||En(s,c),A=E?Fd(s,c):fc(s,c,!0),R=E;do{if(A===0){di&&!E&&xn(s,c,0,!1);break}else{if(m=s.current.alternate,R&&!Dd(m)){A=fc(s,c,!1),R=!1;continue}if(A===2){if(R=c,s.errorRecoveryDisabledLanes&R)var se=0;else se=s.pendingLanes&-536870913,se=se!==0?se:se&536870912?536870912:0;if(se!==0){c=se;e:{var pe=s;A=es;var De=pe.current.memoizedState.isDehydrated;if(De&&(mi(pe,se).flags|=256),se=fc(pe,se,!1),se!==2){if(sc&&!De){pe.errorRecoveryDisabledLanes|=R,On|=R,A=4;break e}R=rr,rr=A,R!==null&&(rr===null?rr=R:rr.push.apply(rr,R))}A=se}if(R=!1,A!==2)continue}}if(A===1){mi(s,0),xn(s,c,0,!0);break}e:{switch(E=s,R=A,R){case 0:case 1:throw Error(n(345));case 4:if((c&4194048)!==c)break;case 6:xn(E,c,lr,!an);break e;case 2:rr=null;break;case 3:case 5:break;default:throw Error(n(329))}if((c&62914560)===c&&(A=ro+300-Ee(),10<A)){if(xn(E,c,lr,!an),vr(E,0,!0)!==0)break e;Gr=c,E.timeoutHandle=rx(_u.bind(null,E,m,rr,io,ac,c,lr,On,hi,an,R,"Throttled",-0,0),A);break e}_u(E,m,rr,io,ac,c,lr,On,hi,an,R,null,-0,0)}}break}while(!0);kr(s)}function _u(s,c,m,E,A,R,se,pe,De,Le,ze,Xe,He,Ke){if(s.timeoutHandle=-1,Xe=c.subtreeFlags,Xe&8192||(Xe&16785408)===16785408){Xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Nr},yu(c,R,Xe);var Qe=(R&62914560)===R?ro-Ee():(R&4194048)===R?vu-Ee():0;if(Qe=dh(Xe,Qe),Qe!==null){Gr=R,s.cancelPendingCommit=Qe(ju.bind(null,s,c,R,m,E,A,se,pe,De,ze,Xe,null,He,Ke)),xn(s,R,se,!Le);return}}ju(s,c,R,m,E,A,se,pe,De)}function Dd(s){for(var c=s;;){var m=c.tag;if((m===0||m===11||m===15)&&c.flags&16384&&(m=c.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var E=0;E<m.length;E++){var A=m[E],R=A.getSnapshot;A=A.value;try{if(!ir(R(),A))return!1}catch{return!1}}if(m=c.child,c.subtreeFlags&16384&&m!==null)m.return=c,c=m;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function xn(s,c,m,E){c&=~oc,c&=~On,s.suspendedLanes|=c,s.pingedLanes&=~c,E&&(s.warmLanes|=c),E=s.expirationTimes;for(var A=c;0<A;){var R=31-Ie(A),se=1<<R;E[R]=-1,A&=~se}m!==0&&Ae(s,m,c)}function so(){return(bt&6)===0?(rs(0),!1):!0}function xc(){if(xt!==null){if(wt===0)var s=xt.return;else s=xt,Ir=Sn=null,Sa(s),oi=null,Ui=0,s=xt;for(;s!==null;)nu(s.alternate,s),s=s.return;xt=null}}function mi(s,c){var m=s.timeoutHandle;m!==-1&&(s.timeoutHandle=-1,Xd(m)),m=s.cancelPendingCommit,m!==null&&(s.cancelPendingCommit=null,m()),Gr=0,xc(),St=s,xt=m=jr(s.current,null),ht=c,wt=0,cr=null,an=!1,di=En(s,c),sc=!1,hi=lr=oc=On=cn=Tt=0,rr=es=null,ac=!1,(c&8)!==0&&(c|=c&32);var E=s.entangledLanes;if(E!==0)for(s=s.entanglements,E&=c;0<E;){var A=31-Ie(E),R=1<<A;c|=s[A],E&=~R}return Vr=c,_s(),m}function Su(s,c){at=null,M.H=Vi,c===si||c===js?(c=q0(),wt=3):c===ha?(c=q0(),wt=4):wt=c===qa?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,cr=c,xt===null&&(Tt=1,Ws(s,pr(c,s.current)))}function Ru(){var s=or.current;return s===null?!0:(ht&4194048)===ht?Er===null:(ht&62914560)===ht||(ht&536870912)!==0?s===Er:!1}function Du(){var s=M.H;return M.H=Vi,s===null?Vi:s}function ku(){var s=M.A;return M.A=Sd,s}function oo(){Tt=4,an||(ht&4194048)!==ht&&or.current!==null||(di=!0),(cn&134217727)===0&&(On&134217727)===0||St===null||xn(St,ht,lr,!1)}function fc(s,c,m){var E=bt;bt|=2;var A=Du(),R=ku();(St!==s||ht!==c)&&(io=null,mi(s,c)),c=!1;var se=Tt;e:do try{if(wt!==0&&xt!==null){var pe=xt,De=cr;switch(wt){case 8:xc(),se=6;break e;case 3:case 2:case 9:case 6:or.current===null&&(c=!0);var Le=wt;if(wt=0,cr=null,gi(s,pe,De,Le),m&&di){se=0;break e}break;default:Le=wt,wt=0,cr=null,gi(s,pe,De,Le)}}kd(),se=Tt;break}catch(ze){Su(s,ze)}while(!0);return c&&s.shellSuspendCounter++,Ir=Sn=null,bt=E,M.H=A,M.A=R,xt===null&&(St=null,ht=0,_s()),se}function kd(){for(;xt!==null;)Fu(xt)}function Fd(s,c){var m=bt;bt|=2;var E=Du(),A=ku();St!==s||ht!==c?(io=null,no=Ee()+500,mi(s,c)):di=En(s,c);e:do try{if(wt!==0&&xt!==null){c=xt;var R=cr;t:switch(wt){case 1:wt=0,cr=null,gi(s,c,R,1);break;case 2:case 9:if(L0(R)){wt=0,cr=null,Nu(c);break}c=function(){wt!==2&&wt!==9||St!==s||(wt=7),kr(s)},R.then(c,c);break e;case 3:wt=7;break e;case 4:wt=5;break e;case 7:L0(R)?(wt=0,cr=null,Nu(c)):(wt=0,cr=null,gi(s,c,R,7));break;case 5:var se=null;switch(xt.tag){case 26:se=xt.memoizedState;case 5:case 27:var pe=xt;if(se?gx(se):pe.stateNode.complete){wt=0,cr=null;var De=pe.sibling;if(De!==null)xt=De;else{var Le=pe.return;Le!==null?(xt=Le,ao(Le)):xt=null}break t}}wt=0,cr=null,gi(s,c,R,5);break;case 6:wt=0,cr=null,gi(s,c,R,6);break;case 8:xc(),Tt=6;break e;default:throw Error(n(462))}}Nd();break}catch(ze){Su(s,ze)}while(!0);return Ir=Sn=null,M.H=E,M.A=A,bt=m,xt!==null?0:(St=null,ht=0,_s(),Tt)}function Nd(){for(;xt!==null&&!Ye();)Fu(xt)}function Fu(s){var c=tu(s.alternate,s,Vr);s.memoizedProps=s.pendingProps,c===null?ao(s):xt=c}function Nu(s){var c=s,m=c.alternate;switch(c.tag){case 15:case 0:c=Xl(m,c,c.pendingProps,c.type,void 0,ht);break;case 11:c=Xl(m,c,c.pendingProps,c.type.render,c.ref,ht);break;case 5:Sa(c);default:nu(m,c),c=xt=k0(c,Vr),c=tu(m,c,Vr)}s.memoizedProps=s.pendingProps,c===null?ao(s):xt=c}function gi(s,c,m,E){Ir=Sn=null,Sa(c),oi=null,Ui=0;var A=c.return;try{if(bd(s,A,c,m,ht)){Tt=1,Ws(s,pr(m,s.current)),xt=null;return}}catch(R){if(A!==null)throw xt=A,R;Tt=1,Ws(s,pr(m,s.current)),xt=null;return}c.flags&32768?(mt||E===1?s=!0:di||(ht&536870912)!==0?s=!1:(an=s=!0,(E===2||E===9||E===3||E===6)&&(E=or.current,E!==null&&E.tag===13&&(E.flags|=16384))),Tu(c,s)):ao(c)}function ao(s){var c=s;do{if((c.flags&32768)!==0){Tu(c,an);return}s=c.return;var m=Ad(c.alternate,c,Vr);if(m!==null){xt=m;return}if(c=c.sibling,c!==null){xt=c;return}xt=c=s}while(c!==null);Tt===0&&(Tt=5)}function Tu(s,c){do{var m=Bd(s.alternate,s);if(m!==null){m.flags&=32767,xt=m;return}if(m=s.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!c&&(s=s.sibling,s!==null)){xt=s;return}xt=s=m}while(s!==null);Tt=6,xt=null}function ju(s,c,m,E,A,R,se,pe,De){s.cancelPendingCommit=null;do co();while(Ht!==0);if((bt&6)!==0)throw Error(n(327));if(c!==null){if(c===s.current)throw Error(n(177));if(R=c.lanes|c.childLanes,R|=Jo,ne(s,m,R,se,pe,De),s===St&&(xt=St=null,ht=0),pi=c,un=s,Gr=m,cc=R,lc=A,Au=E,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Id(ye,function(){return Pu(),null})):(s.callbackNode=null,s.callbackPriority=0),E=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||E){E=M.T,M.T=null,A=q.p,q.p=2,se=bt,bt|=4;try{Cd(s,c,m)}finally{bt=se,q.p=A,M.T=E}}Ht=1,$u(),Iu(),Ou()}}function $u(){if(Ht===1){Ht=0;var s=un,c=pi,m=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||m){m=M.T,M.T=null;var E=q.p;q.p=2;var A=bt;bt|=4;try{pu(c,s);var R=Bc,se=w0(s.containerInfo),pe=R.focusedElem,De=R.selectionRange;if(se!==pe&&pe&&pe.ownerDocument&&b0(pe.ownerDocument.documentElement,pe)){if(De!==null&&Wo(pe)){var Le=De.start,ze=De.end;if(ze===void 0&&(ze=Le),"selectionStart"in pe)pe.selectionStart=Le,pe.selectionEnd=Math.min(ze,pe.value.length);else{var Xe=pe.ownerDocument||document,He=Xe&&Xe.defaultView||window;if(He.getSelection){var Ke=He.getSelection(),Qe=pe.textContent.length,it=Math.min(De.start,Qe),Ct=De.end===void 0?it:Math.min(De.end,Qe);!Ke.extend&&it>Ct&&(se=Ct,Ct=it,it=se);var Ue=E0(pe,it),$e=E0(pe,Ct);if(Ue&&$e&&(Ke.rangeCount!==1||Ke.anchorNode!==Ue.node||Ke.anchorOffset!==Ue.offset||Ke.focusNode!==$e.node||Ke.focusOffset!==$e.offset)){var Me=Xe.createRange();Me.setStart(Ue.node,Ue.offset),Ke.removeAllRanges(),it>Ct?(Ke.addRange(Me),Ke.extend($e.node,$e.offset)):(Me.setEnd($e.node,$e.offset),Ke.addRange(Me))}}}}for(Xe=[],Ke=pe;Ke=Ke.parentNode;)Ke.nodeType===1&&Xe.push({element:Ke,left:Ke.scrollLeft,top:Ke.scrollTop});for(typeof pe.focus=="function"&&pe.focus(),pe=0;pe<Xe.length;pe++){var Ge=Xe[pe];Ge.element.scrollLeft=Ge.left,Ge.element.scrollTop=Ge.top}}wo=!!Ac,Bc=Ac=null}finally{bt=A,q.p=E,M.T=m}}s.current=c,Ht=2}}function Iu(){if(Ht===2){Ht=0;var s=un,c=pi,m=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||m){m=M.T,M.T=null;var E=q.p;q.p=2;var A=bt;bt|=4;try{uu(s,c.alternate,c)}finally{bt=A,q.p=E,M.T=m}}Ht=3}}function Ou(){if(Ht===4||Ht===3){Ht=0,Ve();var s=un,c=pi,m=Gr,E=Au;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Ht=5:(Ht=0,pi=un=null,Uu(s,s.pendingLanes));var A=s.pendingLanes;if(A===0&&(ln=null),ct(m),c=c.stateNode,_e&&typeof _e.onCommitFiberRoot=="function")try{_e.onCommitFiberRoot(he,c,void 0,(c.current.flags&128)===128)}catch{}if(E!==null){c=M.T,A=q.p,q.p=2,M.T=null;try{for(var R=s.onRecoverableError,se=0;se<E.length;se++){var pe=E[se];R(pe.value,{componentStack:pe.stack})}}finally{M.T=c,q.p=A}}(Gr&3)!==0&&co(),kr(s),A=s.pendingLanes,(m&261930)!==0&&(A&42)!==0?s===uc?ts++:(ts=0,uc=s):ts=0,rs(0)}}function Uu(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Ii(c)))}function co(){return $u(),Iu(),Ou(),Pu()}function Pu(){if(Ht!==5)return!1;var s=un,c=cc;cc=0;var m=ct(Gr),E=M.T,A=q.p;try{q.p=32>m?32:m,M.T=null,m=lc,lc=null;var R=un,se=Gr;if(Ht=0,pi=un=null,Gr=0,(bt&6)!==0)throw Error(n(331));var pe=bt;if(bt|=4,bu(R.current),gu(R,R.current,se,m),bt=pe,rs(0,!1),_e&&typeof _e.onPostCommitFiberRoot=="function")try{_e.onPostCommitFiberRoot(he,R)}catch{}return!0}finally{q.p=A,M.T=E,Uu(s,c)}}function Mu(s,c,m){c=pr(m,c),c=Ha(s.stateNode,c,2),s=rn(s,c,2),s!==null&&(re(s,2),kr(s))}function vt(s,c,m){if(s.tag===3)Mu(s,s,m);else for(;c!==null;){if(c.tag===3){Mu(c,s,m);break}else if(c.tag===1){var E=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(ln===null||!ln.has(E))){s=pr(m,s),m=Ll(2),E=rn(c,m,2),E!==null&&(Hl(m,E,c,s),re(E,2),kr(E));break}}c=c.return}}function dc(s,c,m){var E=s.pingCache;if(E===null){E=s.pingCache=new Rd;var A=new Set;E.set(c,A)}else A=E.get(c),A===void 0&&(A=new Set,E.set(c,A));A.has(m)||(sc=!0,A.add(m),s=Td.bind(null,s,c,m),c.then(s,s))}function Td(s,c,m){var E=s.pingCache;E!==null&&E.delete(c),s.pingedLanes|=s.suspendedLanes&m,s.warmLanes&=~m,St===s&&(ht&m)===m&&(Tt===4||Tt===3&&(ht&62914560)===ht&&300>Ee()-ro?(bt&2)===0&&mi(s,0):oc|=m,hi===ht&&(hi=0)),kr(s)}function Lu(s,c){c===0&&(c=ds()),s=Bn(s,c),s!==null&&(re(s,c),kr(s))}function jd(s){var c=s.memoizedState,m=0;c!==null&&(m=c.retryLane),Lu(s,m)}function $d(s,c){var m=0;switch(s.tag){case 31:case 13:var E=s.stateNode,A=s.memoizedState;A!==null&&(m=A.retryLane);break;case 19:E=s.stateNode;break;case 22:E=s.stateNode._retryCache;break;default:throw Error(n(314))}E!==null&&E.delete(c),Lu(s,m)}function Id(s,c){return Fe(s,c)}var lo=null,yi=null,hc=!1,uo=!1,pc=!1,fn=0;function kr(s){s!==yi&&s.next===null&&(yi===null?lo=yi=s:yi=yi.next=s),uo=!0,hc||(hc=!0,Ud())}function rs(s,c){if(!pc&&uo){pc=!0;do for(var m=!1,E=lo;E!==null;){if(s!==0){var A=E.pendingLanes;if(A===0)var R=0;else{var se=E.suspendedLanes,pe=E.pingedLanes;R=(1<<31-Ie(42|s)+1)-1,R&=A&~(se&~pe),R=R&201326741?R&201326741|1:R?R|2:0}R!==0&&(m=!0,zu(E,R))}else R=ht,R=vr(E,E===St?R:0,E.cancelPendingCommit!==null||E.timeoutHandle!==-1),(R&3)===0||En(E,R)||(m=!0,zu(E,R));E=E.next}while(m);pc=!1}}function Od(){Hu()}function Hu(){uo=hc=!1;var s=0;fn!==0&&Wd()&&(s=fn);for(var c=Ee(),m=null,E=lo;E!==null;){var A=E.next,R=qu(E,c);R===0?(E.next=null,m===null?lo=A:m.next=A,A===null&&(yi=m)):(m=E,(s!==0||(R&3)!==0)&&(uo=!0)),E=A}Ht!==0&&Ht!==5||rs(s),fn!==0&&(fn=0)}function qu(s,c){for(var m=s.suspendedLanes,E=s.pingedLanes,A=s.expirationTimes,R=s.pendingLanes&-62914561;0<R;){var se=31-Ie(R),pe=1<<se,De=A[se];De===-1?((pe&m)===0||(pe&E)!==0)&&(A[se]=_r(pe,c)):De<=c&&(s.expiredLanes|=pe),R&=~pe}if(c=St,m=ht,m=vr(s,s===c?m:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),E=s.callbackNode,m===0||s===c&&(wt===2||wt===9)||s.cancelPendingCommit!==null)return E!==null&&E!==null&&Pe(E),s.callbackNode=null,s.callbackPriority=0;if((m&3)===0||En(s,m)){if(c=m&-m,c===s.callbackPriority)return c;switch(E!==null&&Pe(E),ct(m)){case 2:case 8:m=Re;break;case 32:m=ye;break;case 268435456:m=ie;break;default:m=ye}return E=Ku.bind(null,s),m=Fe(m,E),s.callbackPriority=c,s.callbackNode=m,c}return E!==null&&E!==null&&Pe(E),s.callbackPriority=2,s.callbackNode=null,2}function Ku(s,c){if(Ht!==0&&Ht!==5)return s.callbackNode=null,s.callbackPriority=0,null;var m=s.callbackNode;if(co()&&s.callbackNode!==m)return null;var E=ht;return E=vr(s,s===St?E:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),E===0?null:(Cu(s,E,c),qu(s,Ee()),s.callbackNode!=null&&s.callbackNode===m?Ku.bind(null,s):null)}function zu(s,c){if(co())return null;Cu(s,c,!0)}function Ud(){Yd(function(){(bt&6)!==0?Fe(Te,Od):Hu()})}function mc(){if(fn===0){var s=ni;s===0&&(s=rt,rt<<=1,(rt&261888)===0&&(rt=256)),fn=s}return fn}function Vu(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ys(""+s)}function Gu(s,c){var m=c.ownerDocument.createElement("input");return m.name=c.name,m.value=c.value,s.id&&m.setAttribute("form",s.id),c.parentNode.insertBefore(m,c),s=new FormData(s),m.parentNode.removeChild(m),s}function Pd(s,c,m,E,A){if(c==="submit"&&m&&m.stateNode===A){var R=Vu((A[Zt]||null).action),se=E.submitter;se&&(c=(c=se[Zt]||null)?Vu(c.formAction):se.getAttribute("formAction"),c!==null&&(R=c,se=null));var pe=new vs("action","action",null,E,A);s.push({event:pe,listeners:[{instance:null,listener:function(){if(E.defaultPrevented){if(fn!==0){var De=se?Gu(A,se):new FormData(A);Ia(m,{pending:!0,data:De,method:A.method,action:R},null,De)}}else typeof R=="function"&&(pe.preventDefault(),De=se?Gu(A,se):new FormData(A),Ia(m,{pending:!0,data:De,method:A.method,action:R},R,De))},currentTarget:A}]})}}for(var gc=0;gc<Qo.length;gc++){var yc=Qo[gc],Md=yc.toLowerCase(),Ld=yc[0].toUpperCase()+yc.slice(1);Ar(Md,"on"+Ld)}Ar(B0,"onAnimationEnd"),Ar(C0,"onAnimationIteration"),Ar(_0,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(nd,"onTransitionRun"),Ar(id,"onTransitionStart"),Ar(sd,"onTransitionCancel"),Ar(S0,"onTransitionEnd"),qn("onMouseEnter",["mouseout","mouseover"]),qn("onMouseLeave",["mouseout","mouseover"]),qn("onPointerEnter",["pointerout","pointerover"]),qn("onPointerLeave",["pointerout","pointerover"]),bn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bn("onBeforeInput",["compositionend","keypress","textInput","paste"]),bn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ns="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ns));function Wu(s,c){c=(c&4)!==0;for(var m=0;m<s.length;m++){var E=s[m],A=E.event;E=E.listeners;e:{var R=void 0;if(c)for(var se=E.length-1;0<=se;se--){var pe=E[se],De=pe.instance,Le=pe.currentTarget;if(pe=pe.listener,De!==R&&A.isPropagationStopped())break e;R=pe,A.currentTarget=Le;try{R(A)}catch(ze){Cs(ze)}A.currentTarget=null,R=De}else for(se=0;se<E.length;se++){if(pe=E[se],De=pe.instance,Le=pe.currentTarget,pe=pe.listener,De!==R&&A.isPropagationStopped())break e;R=pe,A.currentTarget=Le;try{R(A)}catch(ze){Cs(ze)}A.currentTarget=null,R=De}}}}function ft(s,c){var m=c[ko];m===void 0&&(m=c[ko]=new Set);var E=s+"__bubble";m.has(E)||(Xu(c,s,2,!1),m.add(E))}function Ec(s,c,m){var E=0;c&&(E|=4),Xu(m,s,E,c)}var xo="_reactListening"+Math.random().toString(36).slice(2);function bc(s){if(!s[xo]){s[xo]=!0,Hc.forEach(function(m){m!=="selectionchange"&&(Hd.has(m)||Ec(m,!1,s),Ec(m,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[xo]||(c[xo]=!0,Ec("selectionchange",!1,c))}}function Xu(s,c,m,E){switch(Bx(c)){case 2:var A=mh;break;case 8:A=gh;break;default:A=$c}m=A.bind(null,c,m,s),A=void 0,!Po||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(A=!0),E?A!==void 0?s.addEventListener(c,m,{capture:!0,passive:A}):s.addEventListener(c,m,!0):A!==void 0?s.addEventListener(c,m,{passive:A}):s.addEventListener(c,m,!1)}function wc(s,c,m,E,A){var R=E;if((c&1)===0&&(c&2)===0&&E!==null)e:for(;;){if(E===null)return;var se=E.tag;if(se===3||se===4){var pe=E.stateNode.containerInfo;if(pe===A)break;if(se===4)for(se=E.return;se!==null;){var De=se.tag;if((De===3||De===4)&&se.stateNode.containerInfo===A)return;se=se.return}for(;pe!==null;){if(se=Mn(pe),se===null)return;if(De=se.tag,De===5||De===6||De===26||De===27){E=R=se;continue e}pe=pe.parentNode}}E=E.return}e0(function(){var Le=R,ze=Oo(m),Xe=[];e:{var He=R0.get(s);if(He!==void 0){var Ke=vs,Qe=s;switch(s){case"keypress":if(bs(m)===0)break e;case"keydown":case"keyup":Ke=$f;break;case"focusin":Qe="focus",Ke=qo;break;case"focusout":Qe="blur",Ke=qo;break;case"beforeblur":case"afterblur":Ke=qo;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ke=n0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ke=Af;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ke=Uf;break;case B0:case C0:case _0:Ke=_f;break;case S0:Ke=Mf;break;case"scroll":case"scrollend":Ke=wf;break;case"wheel":Ke=Hf;break;case"copy":case"cut":case"paste":Ke=Rf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ke=s0;break;case"toggle":case"beforetoggle":Ke=Kf}var it=(c&4)!==0,Ct=!it&&(s==="scroll"||s==="scrollend"),Ue=it?He!==null?He+"Capture":null:He;it=[];for(var $e=Le,Me;$e!==null;){var Ge=$e;if(Me=Ge.stateNode,Ge=Ge.tag,Ge!==5&&Ge!==26&&Ge!==27||Me===null||Ue===null||(Ge=Ci($e,Ue),Ge!=null&&it.push(ss($e,Ge,Me))),Ct)break;$e=$e.return}0<it.length&&(He=new Ke(He,Qe,null,m,ze),Xe.push({event:He,listeners:it}))}}if((c&7)===0){e:{if(He=s==="mouseover"||s==="pointerover",Ke=s==="mouseout"||s==="pointerout",He&&m!==Io&&(Qe=m.relatedTarget||m.fromElement)&&(Mn(Qe)||Qe[Pn]))break e;if((Ke||He)&&(He=ze.window===ze?ze:(He=ze.ownerDocument)?He.defaultView||He.parentWindow:window,Ke?(Qe=m.relatedTarget||m.toElement,Ke=Le,Qe=Qe?Mn(Qe):null,Qe!==null&&(Ct=a(Qe),it=Qe.tag,Qe!==Ct||it!==5&&it!==27&&it!==6)&&(Qe=null)):(Ke=null,Qe=Le),Ke!==Qe)){if(it=n0,Ge="onMouseLeave",Ue="onMouseEnter",$e="mouse",(s==="pointerout"||s==="pointerover")&&(it=s0,Ge="onPointerLeave",Ue="onPointerEnter",$e="pointer"),Ct=Ke==null?He:Bi(Ke),Me=Qe==null?He:Bi(Qe),He=new it(Ge,$e+"leave",Ke,m,ze),He.target=Ct,He.relatedTarget=Me,Ge=null,Mn(ze)===Le&&(it=new it(Ue,$e+"enter",Qe,m,ze),it.target=Me,it.relatedTarget=Ct,Ge=it),Ct=Ge,Ke&&Qe)t:{for(it=qd,Ue=Ke,$e=Qe,Me=0,Ge=Ue;Ge;Ge=it(Ge))Me++;Ge=0;for(var tt=$e;tt;tt=it(tt))Ge++;for(;0<Me-Ge;)Ue=it(Ue),Me--;for(;0<Ge-Me;)$e=it($e),Ge--;for(;Me--;){if(Ue===$e||$e!==null&&Ue===$e.alternate){it=Ue;break t}Ue=it(Ue),$e=it($e)}it=null}else it=null;Ke!==null&&Yu(Xe,He,Ke,it,!1),Qe!==null&&Ct!==null&&Yu(Xe,Ct,Qe,it,!0)}}e:{if(He=Le?Bi(Le):window,Ke=He.nodeName&&He.nodeName.toLowerCase(),Ke==="select"||Ke==="input"&&He.type==="file")var gt=d0;else if(x0(He))if(h0)gt=ed;else{gt=Qf;var Je=Zf}else Ke=He.nodeName,!Ke||Ke.toLowerCase()!=="input"||He.type!=="checkbox"&&He.type!=="radio"?Le&&$o(Le.elementType)&&(gt=d0):gt=Jf;if(gt&&(gt=gt(s,Le))){f0(Xe,gt,m,ze);break e}Je&&Je(s,He,Le),s==="focusout"&&Le&&He.type==="number"&&Le.memoizedProps.value!=null&&jo(He,"number",He.value)}switch(Je=Le?Bi(Le):window,s){case"focusin":(x0(Je)||Je.contentEditable==="true")&&(Xn=Je,Xo=Le,Ti=null);break;case"focusout":Ti=Xo=Xn=null;break;case"mousedown":Yo=!0;break;case"contextmenu":case"mouseup":case"dragend":Yo=!1,v0(Xe,m,ze);break;case"selectionchange":if(rd)break;case"keydown":case"keyup":v0(Xe,m,ze)}var lt;if(zo)e:{switch(s){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else Wn?l0(s,m)&&(pt="onCompositionEnd"):s==="keydown"&&m.keyCode===229&&(pt="onCompositionStart");pt&&(o0&&m.locale!=="ko"&&(Wn||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&Wn&&(lt=t0()):(Xr=ze,Mo="value"in Xr?Xr.value:Xr.textContent,Wn=!0)),Je=fo(Le,pt),0<Je.length&&(pt=new i0(pt,s,null,m,ze),Xe.push({event:pt,listeners:Je}),lt?pt.data=lt:(lt=u0(m),lt!==null&&(pt.data=lt)))),(lt=Vf?Gf(s,m):Wf(s,m))&&(pt=fo(Le,"onBeforeInput"),0<pt.length&&(Je=new i0("onBeforeInput","beforeinput",null,m,ze),Xe.push({event:Je,listeners:pt}),Je.data=lt)),Pd(Xe,s,Le,m,ze)}Wu(Xe,c)})}function ss(s,c,m){return{instance:s,listener:c,currentTarget:m}}function fo(s,c){for(var m=c+"Capture",E=[];s!==null;){var A=s,R=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||R===null||(A=Ci(s,m),A!=null&&E.unshift(ss(s,A,R)),A=Ci(s,c),A!=null&&E.push(ss(s,A,R))),s.tag===3)return E;s=s.return}return[]}function qd(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Yu(s,c,m,E,A){for(var R=c._reactName,se=[];m!==null&&m!==E;){var pe=m,De=pe.alternate,Le=pe.stateNode;if(pe=pe.tag,De!==null&&De===E)break;pe!==5&&pe!==26&&pe!==27||Le===null||(De=Le,A?(Le=Ci(m,R),Le!=null&&se.unshift(ss(m,Le,De))):A||(Le=Ci(m,R),Le!=null&&se.push(ss(m,Le,De)))),m=m.return}se.length!==0&&s.push({event:c,listeners:se})}var Kd=/\r\n?/g,zd=/\u0000|\uFFFD/g;function Zu(s){return(typeof s=="string"?s:""+s).replace(Kd,`
`).replace(zd,"")}function Qu(s,c){return c=Zu(c),Zu(s)===c}function Bt(s,c,m,E,A,R){switch(m){case"children":typeof E=="string"?c==="body"||c==="textarea"&&E===""||zn(s,E):(typeof E=="number"||typeof E=="bigint")&&c!=="body"&&zn(s,""+E);break;case"className":ps(s,"class",E);break;case"tabIndex":ps(s,"tabindex",E);break;case"dir":case"role":case"viewBox":case"width":case"height":ps(s,m,E);break;case"style":Qc(s,E,R);break;case"data":if(c!=="object"){ps(s,"data",E);break}case"src":case"href":if(E===""&&(c!=="a"||m!=="href")){s.removeAttribute(m);break}if(E==null||typeof E=="function"||typeof E=="symbol"||typeof E=="boolean"){s.removeAttribute(m);break}E=ys(""+E),s.setAttribute(m,E);break;case"action":case"formAction":if(typeof E=="function"){s.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof R=="function"&&(m==="formAction"?(c!=="input"&&Bt(s,c,"name",A.name,A,null),Bt(s,c,"formEncType",A.formEncType,A,null),Bt(s,c,"formMethod",A.formMethod,A,null),Bt(s,c,"formTarget",A.formTarget,A,null)):(Bt(s,c,"encType",A.encType,A,null),Bt(s,c,"method",A.method,A,null),Bt(s,c,"target",A.target,A,null)));if(E==null||typeof E=="symbol"||typeof E=="boolean"){s.removeAttribute(m);break}E=ys(""+E),s.setAttribute(m,E);break;case"onClick":E!=null&&(s.onclick=Nr);break;case"onScroll":E!=null&&ft("scroll",s);break;case"onScrollEnd":E!=null&&ft("scrollend",s);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(n(61));if(m=E.__html,m!=null){if(A.children!=null)throw Error(n(60));s.innerHTML=m}}break;case"multiple":s.multiple=E&&typeof E!="function"&&typeof E!="symbol";break;case"muted":s.muted=E&&typeof E!="function"&&typeof E!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(E==null||typeof E=="function"||typeof E=="boolean"||typeof E=="symbol"){s.removeAttribute("xlink:href");break}m=ys(""+E),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":E!=null&&typeof E!="function"&&typeof E!="symbol"?s.setAttribute(m,""+E):s.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":E&&typeof E!="function"&&typeof E!="symbol"?s.setAttribute(m,""):s.removeAttribute(m);break;case"capture":case"download":E===!0?s.setAttribute(m,""):E!==!1&&E!=null&&typeof E!="function"&&typeof E!="symbol"?s.setAttribute(m,E):s.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":E!=null&&typeof E!="function"&&typeof E!="symbol"&&!isNaN(E)&&1<=E?s.setAttribute(m,E):s.removeAttribute(m);break;case"rowSpan":case"start":E==null||typeof E=="function"||typeof E=="symbol"||isNaN(E)?s.removeAttribute(m):s.setAttribute(m,E);break;case"popover":ft("beforetoggle",s),ft("toggle",s),hs(s,"popover",E);break;case"xlinkActuate":Fr(s,"http://www.w3.org/1999/xlink","xlink:actuate",E);break;case"xlinkArcrole":Fr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",E);break;case"xlinkRole":Fr(s,"http://www.w3.org/1999/xlink","xlink:role",E);break;case"xlinkShow":Fr(s,"http://www.w3.org/1999/xlink","xlink:show",E);break;case"xlinkTitle":Fr(s,"http://www.w3.org/1999/xlink","xlink:title",E);break;case"xlinkType":Fr(s,"http://www.w3.org/1999/xlink","xlink:type",E);break;case"xmlBase":Fr(s,"http://www.w3.org/XML/1998/namespace","xml:base",E);break;case"xmlLang":Fr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",E);break;case"xmlSpace":Fr(s,"http://www.w3.org/XML/1998/namespace","xml:space",E);break;case"is":hs(s,"is",E);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=Ef.get(m)||m,hs(s,m,E))}}function vc(s,c,m,E,A,R){switch(m){case"style":Qc(s,E,R);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(n(61));if(m=E.__html,m!=null){if(A.children!=null)throw Error(n(60));s.innerHTML=m}}break;case"children":typeof E=="string"?zn(s,E):(typeof E=="number"||typeof E=="bigint")&&zn(s,""+E);break;case"onScroll":E!=null&&ft("scroll",s);break;case"onScrollEnd":E!=null&&ft("scrollend",s);break;case"onClick":E!=null&&(s.onclick=Nr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qc.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(A=m.endsWith("Capture"),c=m.slice(2,A?m.length-7:void 0),R=s[Zt]||null,R=R!=null?R[m]:null,typeof R=="function"&&s.removeEventListener(c,R,A),typeof E=="function")){typeof R!="function"&&R!==null&&(m in s?s[m]=null:s.hasAttribute(m)&&s.removeAttribute(m)),s.addEventListener(c,E,A);break e}m in s?s[m]=E:E===!0?s.setAttribute(m,""):hs(s,m,E)}}}function Wt(s,c,m){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",s),ft("load",s);var E=!1,A=!1,R;for(R in m)if(m.hasOwnProperty(R)){var se=m[R];if(se!=null)switch(R){case"src":E=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:Bt(s,c,R,se,m,null)}}A&&Bt(s,c,"srcSet",m.srcSet,m,null),E&&Bt(s,c,"src",m.src,m,null);return;case"input":ft("invalid",s);var pe=R=se=A=null,De=null,Le=null;for(E in m)if(m.hasOwnProperty(E)){var ze=m[E];if(ze!=null)switch(E){case"name":A=ze;break;case"type":se=ze;break;case"checked":De=ze;break;case"defaultChecked":Le=ze;break;case"value":R=ze;break;case"defaultValue":pe=ze;break;case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(n(137,c));break;default:Bt(s,c,E,ze,m,null)}}Wc(s,R,pe,De,Le,se,A,!1);return;case"select":ft("invalid",s),E=se=R=null;for(A in m)if(m.hasOwnProperty(A)&&(pe=m[A],pe!=null))switch(A){case"value":R=pe;break;case"defaultValue":se=pe;break;case"multiple":E=pe;default:Bt(s,c,A,pe,m,null)}c=R,m=se,s.multiple=!!E,c!=null?Kn(s,!!E,c,!1):m!=null&&Kn(s,!!E,m,!0);return;case"textarea":ft("invalid",s),R=A=E=null;for(se in m)if(m.hasOwnProperty(se)&&(pe=m[se],pe!=null))switch(se){case"value":E=pe;break;case"defaultValue":A=pe;break;case"children":R=pe;break;case"dangerouslySetInnerHTML":if(pe!=null)throw Error(n(91));break;default:Bt(s,c,se,pe,m,null)}Yc(s,E,A,R);return;case"option":for(De in m)if(m.hasOwnProperty(De)&&(E=m[De],E!=null))switch(De){case"selected":s.selected=E&&typeof E!="function"&&typeof E!="symbol";break;default:Bt(s,c,De,E,m,null)}return;case"dialog":ft("beforetoggle",s),ft("toggle",s),ft("cancel",s),ft("close",s);break;case"iframe":case"object":ft("load",s);break;case"video":case"audio":for(E=0;E<ns.length;E++)ft(ns[E],s);break;case"image":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"embed":case"source":case"link":ft("error",s),ft("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Le in m)if(m.hasOwnProperty(Le)&&(E=m[Le],E!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:Bt(s,c,Le,E,m,null)}return;default:if($o(c)){for(ze in m)m.hasOwnProperty(ze)&&(E=m[ze],E!==void 0&&vc(s,c,ze,E,m,void 0));return}}for(pe in m)m.hasOwnProperty(pe)&&(E=m[pe],E!=null&&Bt(s,c,pe,E,m,null))}function Vd(s,c,m,E){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,R=null,se=null,pe=null,De=null,Le=null,ze=null;for(Ke in m){var Xe=m[Ke];if(m.hasOwnProperty(Ke)&&Xe!=null)switch(Ke){case"checked":break;case"value":break;case"defaultValue":De=Xe;default:E.hasOwnProperty(Ke)||Bt(s,c,Ke,null,E,Xe)}}for(var He in E){var Ke=E[He];if(Xe=m[He],E.hasOwnProperty(He)&&(Ke!=null||Xe!=null))switch(He){case"type":R=Ke;break;case"name":A=Ke;break;case"checked":Le=Ke;break;case"defaultChecked":ze=Ke;break;case"value":se=Ke;break;case"defaultValue":pe=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(n(137,c));break;default:Ke!==Xe&&Bt(s,c,He,Ke,E,Xe)}}To(s,se,pe,De,Le,ze,R,A);return;case"select":Ke=se=pe=He=null;for(R in m)if(De=m[R],m.hasOwnProperty(R)&&De!=null)switch(R){case"value":break;case"multiple":Ke=De;default:E.hasOwnProperty(R)||Bt(s,c,R,null,E,De)}for(A in E)if(R=E[A],De=m[A],E.hasOwnProperty(A)&&(R!=null||De!=null))switch(A){case"value":He=R;break;case"defaultValue":pe=R;break;case"multiple":se=R;default:R!==De&&Bt(s,c,A,R,E,De)}c=pe,m=se,E=Ke,He!=null?Kn(s,!!m,He,!1):!!E!=!!m&&(c!=null?Kn(s,!!m,c,!0):Kn(s,!!m,m?[]:"",!1));return;case"textarea":Ke=He=null;for(pe in m)if(A=m[pe],m.hasOwnProperty(pe)&&A!=null&&!E.hasOwnProperty(pe))switch(pe){case"value":break;case"children":break;default:Bt(s,c,pe,null,E,A)}for(se in E)if(A=E[se],R=m[se],E.hasOwnProperty(se)&&(A!=null||R!=null))switch(se){case"value":He=A;break;case"defaultValue":Ke=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:A!==R&&Bt(s,c,se,A,E,R)}Xc(s,He,Ke);return;case"option":for(var Qe in m)if(He=m[Qe],m.hasOwnProperty(Qe)&&He!=null&&!E.hasOwnProperty(Qe))switch(Qe){case"selected":s.selected=!1;break;default:Bt(s,c,Qe,null,E,He)}for(De in E)if(He=E[De],Ke=m[De],E.hasOwnProperty(De)&&He!==Ke&&(He!=null||Ke!=null))switch(De){case"selected":s.selected=He&&typeof He!="function"&&typeof He!="symbol";break;default:Bt(s,c,De,He,E,Ke)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in m)He=m[it],m.hasOwnProperty(it)&&He!=null&&!E.hasOwnProperty(it)&&Bt(s,c,it,null,E,He);for(Le in E)if(He=E[Le],Ke=m[Le],E.hasOwnProperty(Le)&&He!==Ke&&(He!=null||Ke!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(n(137,c));break;default:Bt(s,c,Le,He,E,Ke)}return;default:if($o(c)){for(var Ct in m)He=m[Ct],m.hasOwnProperty(Ct)&&He!==void 0&&!E.hasOwnProperty(Ct)&&vc(s,c,Ct,void 0,E,He);for(ze in E)He=E[ze],Ke=m[ze],!E.hasOwnProperty(ze)||He===Ke||He===void 0&&Ke===void 0||vc(s,c,ze,He,E,Ke);return}}for(var Ue in m)He=m[Ue],m.hasOwnProperty(Ue)&&He!=null&&!E.hasOwnProperty(Ue)&&Bt(s,c,Ue,null,E,He);for(Xe in E)He=E[Xe],Ke=m[Xe],!E.hasOwnProperty(Xe)||He===Ke||He==null&&Ke==null||Bt(s,c,Xe,He,E,Ke)}function Ju(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Gd(){if(typeof performance.getEntriesByType=="function"){for(var s=0,c=0,m=performance.getEntriesByType("resource"),E=0;E<m.length;E++){var A=m[E],R=A.transferSize,se=A.initiatorType,pe=A.duration;if(R&&pe&&Ju(se)){for(se=0,pe=A.responseEnd,E+=1;E<m.length;E++){var De=m[E],Le=De.startTime;if(Le>pe)break;var ze=De.transferSize,Xe=De.initiatorType;ze&&Ju(Xe)&&(De=De.responseEnd,se+=ze*(De<pe?1:(pe-Le)/(De-Le)))}if(--E,c+=8*(R+se)/(A.duration/1e3),s++,10<s)break}}if(0<s)return c/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Ac=null,Bc=null;function ho(s){return s.nodeType===9?s:s.ownerDocument}function ex(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tx(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function Cc(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var _c=null;function Wd(){var s=window.event;return s&&s.type==="popstate"?s===_c?!1:(_c=s,!0):(_c=null,!1)}var rx=typeof setTimeout=="function"?setTimeout:void 0,Xd=typeof clearTimeout=="function"?clearTimeout:void 0,nx=typeof Promise=="function"?Promise:void 0,Yd=typeof queueMicrotask=="function"?queueMicrotask:typeof nx<"u"?function(s){return nx.resolve(null).then(s).catch(Zd)}:rx;function Zd(s){setTimeout(function(){throw s})}function dn(s){return s==="head"}function ix(s,c){var m=c,E=0;do{var A=m.nextSibling;if(s.removeChild(m),A&&A.nodeType===8)if(m=A.data,m==="/$"||m==="/&"){if(E===0){s.removeChild(A),vi(c);return}E--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")E++;else if(m==="html")os(s.ownerDocument.documentElement);else if(m==="head"){m=s.ownerDocument.head,os(m);for(var R=m.firstChild;R;){var se=R.nextSibling,pe=R.nodeName;R[Ai]||pe==="SCRIPT"||pe==="STYLE"||pe==="LINK"&&R.rel.toLowerCase()==="stylesheet"||m.removeChild(R),R=se}}else m==="body"&&os(s.ownerDocument.body);m=A}while(m);vi(c)}function sx(s,c){var m=s;s=0;do{var E=m.nextSibling;if(m.nodeType===1?c?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(c?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),E&&E.nodeType===8)if(m=E.data,m==="/$"){if(s===0)break;s--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||s++;m=E}while(m)}function Sc(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var m=c;switch(c=c.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Sc(m),Fo(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}s.removeChild(m)}}function Qd(s,c,m,E){for(;s.nodeType===1;){var A=m;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!E&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(E){if(!s[Ai])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(R=s.getAttribute("rel"),R==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(R!==A.rel||s.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||s.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||s.getAttribute("title")!==(A.title==null?null:A.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(R=s.getAttribute("src"),(R!==(A.src==null?null:A.src)||s.getAttribute("type")!==(A.type==null?null:A.type)||s.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&R&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var R=A.name==null?null:""+A.name;if(A.type==="hidden"&&s.getAttribute("name")===R)return s}else return s;if(s=br(s.nextSibling),s===null)break}return null}function Jd(s,c,m){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!m||(s=br(s.nextSibling),s===null))return null;return s}function ox(s,c){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=br(s.nextSibling),s===null))return null;return s}function Rc(s){return s.data==="$?"||s.data==="$~"}function Dc(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function eh(s,c){var m=s.ownerDocument;if(s.data==="$~")s._reactRetry=c;else if(s.data!=="$?"||m.readyState!=="loading")c();else{var E=function(){c(),m.removeEventListener("DOMContentLoaded",E)};m.addEventListener("DOMContentLoaded",E),s._reactRetry=E}}function br(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return s}var kc=null;function ax(s){s=s.nextSibling;for(var c=0;s;){if(s.nodeType===8){var m=s.data;if(m==="/$"||m==="/&"){if(c===0)return br(s.nextSibling);c--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||c++}s=s.nextSibling}return null}function cx(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var m=s.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(c===0)return s;c--}else m!=="/$"&&m!=="/&"||c++}s=s.previousSibling}return null}function lx(s,c,m){switch(c=ho(m),s){case"html":if(s=c.documentElement,!s)throw Error(n(452));return s;case"head":if(s=c.head,!s)throw Error(n(453));return s;case"body":if(s=c.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function os(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);Fo(s)}var wr=new Map,ux=new Set;function po(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Wr=q.d;q.d={f:th,r:rh,D:nh,C:ih,L:sh,m:oh,X:ch,S:ah,M:lh};function th(){var s=Wr.f(),c=so();return s||c}function rh(s){var c=Ln(s);c!==null&&c.tag===5&&c.type==="form"?Sl(c):Wr.r(s)}var Ei=typeof document>"u"?null:document;function xx(s,c,m){var E=Ei;if(E&&typeof c=="string"&&c){var A=dr(c);A='link[rel="'+s+'"][href="'+A+'"]',typeof m=="string"&&(A+='[crossorigin="'+m+'"]'),ux.has(A)||(ux.add(A),s={rel:s,crossOrigin:m,href:c},E.querySelector(A)===null&&(c=E.createElement("link"),Wt(c,"link",s),qt(c),E.head.appendChild(c)))}}function nh(s){Wr.D(s),xx("dns-prefetch",s,null)}function ih(s,c){Wr.C(s,c),xx("preconnect",s,c)}function sh(s,c,m){Wr.L(s,c,m);var E=Ei;if(E&&s&&c){var A='link[rel="preload"][as="'+dr(c)+'"]';c==="image"&&m&&m.imageSrcSet?(A+='[imagesrcset="'+dr(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(A+='[imagesizes="'+dr(m.imageSizes)+'"]')):A+='[href="'+dr(s)+'"]';var R=A;switch(c){case"style":R=bi(s);break;case"script":R=wi(s)}wr.has(R)||(s=g({rel:"preload",href:c==="image"&&m&&m.imageSrcSet?void 0:s,as:c},m),wr.set(R,s),E.querySelector(A)!==null||c==="style"&&E.querySelector(as(R))||c==="script"&&E.querySelector(cs(R))||(c=E.createElement("link"),Wt(c,"link",s),qt(c),E.head.appendChild(c)))}}function oh(s,c){Wr.m(s,c);var m=Ei;if(m&&s){var E=c&&typeof c.as=="string"?c.as:"script",A='link[rel="modulepreload"][as="'+dr(E)+'"][href="'+dr(s)+'"]',R=A;switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":R=wi(s)}if(!wr.has(R)&&(s=g({rel:"modulepreload",href:s},c),wr.set(R,s),m.querySelector(A)===null)){switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(cs(R)))return}E=m.createElement("link"),Wt(E,"link",s),qt(E),m.head.appendChild(E)}}}function ah(s,c,m){Wr.S(s,c,m);var E=Ei;if(E&&s){var A=Hn(E).hoistableStyles,R=bi(s);c=c||"default";var se=A.get(R);if(!se){var pe={loading:0,preload:null};if(se=E.querySelector(as(R)))pe.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":c},m),(m=wr.get(R))&&Fc(s,m);var De=se=E.createElement("link");qt(De),Wt(De,"link",s),De._p=new Promise(function(Le,ze){De.onload=Le,De.onerror=ze}),De.addEventListener("load",function(){pe.loading|=1}),De.addEventListener("error",function(){pe.loading|=2}),pe.loading|=4,mo(se,c,E)}se={type:"stylesheet",instance:se,count:1,state:pe},A.set(R,se)}}}function ch(s,c){Wr.X(s,c);var m=Ei;if(m&&s){var E=Hn(m).hoistableScripts,A=wi(s),R=E.get(A);R||(R=m.querySelector(cs(A)),R||(s=g({src:s,async:!0},c),(c=wr.get(A))&&Nc(s,c),R=m.createElement("script"),qt(R),Wt(R,"link",s),m.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},E.set(A,R))}}function lh(s,c){Wr.M(s,c);var m=Ei;if(m&&s){var E=Hn(m).hoistableScripts,A=wi(s),R=E.get(A);R||(R=m.querySelector(cs(A)),R||(s=g({src:s,async:!0,type:"module"},c),(c=wr.get(A))&&Nc(s,c),R=m.createElement("script"),qt(R),Wt(R,"link",s),m.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},E.set(A,R))}}function fx(s,c,m,E){var A=(A=oe.current)?po(A):null;if(!A)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(c=bi(m.href),m=Hn(A).hoistableStyles,E=m.get(c),E||(E={type:"style",instance:null,count:0,state:null},m.set(c,E)),E):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){s=bi(m.href);var R=Hn(A).hoistableStyles,se=R.get(s);if(se||(A=A.ownerDocument||A,se={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},R.set(s,se),(R=A.querySelector(as(s)))&&!R._p&&(se.instance=R,se.state.loading=5),wr.has(s)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},wr.set(s,m),R||uh(A,s,m,se.state))),c&&E===null)throw Error(n(528,""));return se}if(c&&E!==null)throw Error(n(529,""));return null;case"script":return c=m.async,m=m.src,typeof m=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=wi(m),m=Hn(A).hoistableScripts,E=m.get(c),E||(E={type:"script",instance:null,count:0,state:null},m.set(c,E)),E):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function bi(s){return'href="'+dr(s)+'"'}function as(s){return'link[rel="stylesheet"]['+s+"]"}function dx(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function uh(s,c,m,E){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?E.loading=1:(c=s.createElement("link"),E.preload=c,c.addEventListener("load",function(){return E.loading|=1}),c.addEventListener("error",function(){return E.loading|=2}),Wt(c,"link",m),qt(c),s.head.appendChild(c))}function wi(s){return'[src="'+dr(s)+'"]'}function cs(s){return"script[async]"+s}function hx(s,c,m){if(c.count++,c.instance===null)switch(c.type){case"style":var E=s.querySelector('style[data-href~="'+dr(m.href)+'"]');if(E)return c.instance=E,qt(E),E;var A=g({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return E=(s.ownerDocument||s).createElement("style"),qt(E),Wt(E,"style",A),mo(E,m.precedence,s),c.instance=E;case"stylesheet":A=bi(m.href);var R=s.querySelector(as(A));if(R)return c.state.loading|=4,c.instance=R,qt(R),R;E=dx(m),(A=wr.get(A))&&Fc(E,A),R=(s.ownerDocument||s).createElement("link"),qt(R);var se=R;return se._p=new Promise(function(pe,De){se.onload=pe,se.onerror=De}),Wt(R,"link",E),c.state.loading|=4,mo(R,m.precedence,s),c.instance=R;case"script":return R=wi(m.src),(A=s.querySelector(cs(R)))?(c.instance=A,qt(A),A):(E=m,(A=wr.get(R))&&(E=g({},m),Nc(E,A)),s=s.ownerDocument||s,A=s.createElement("script"),qt(A),Wt(A,"link",E),s.head.appendChild(A),c.instance=A);case"void":return null;default:throw Error(n(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(E=c.instance,c.state.loading|=4,mo(E,m.precedence,s));return c.instance}function mo(s,c,m){for(var E=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=E.length?E[E.length-1]:null,R=A,se=0;se<E.length;se++){var pe=E[se];if(pe.dataset.precedence===c)R=pe;else if(R!==A)break}R?R.parentNode.insertBefore(s,R.nextSibling):(c=m.nodeType===9?m.head:m,c.insertBefore(s,c.firstChild))}function Fc(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function Nc(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var go=null;function px(s,c,m){if(go===null){var E=new Map,A=go=new Map;A.set(m,E)}else A=go,E=A.get(m),E||(E=new Map,A.set(m,E));if(E.has(s))return E;for(E.set(s,null),m=m.getElementsByTagName(s),A=0;A<m.length;A++){var R=m[A];if(!(R[Ai]||R[ot]||s==="link"&&R.getAttribute("rel")==="stylesheet")&&R.namespaceURI!=="http://www.w3.org/2000/svg"){var se=R.getAttribute(c)||"";se=s+se;var pe=E.get(se);pe?pe.push(R):E.set(se,[R])}}return E}function mx(s,c,m){s=s.ownerDocument||s,s.head.insertBefore(m,c==="title"?s.querySelector("head > title"):null)}function xh(s,c,m){if(m===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function gx(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function fh(s,c,m,E){if(m.type==="stylesheet"&&(typeof E.media!="string"||matchMedia(E.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var A=bi(E.href),R=c.querySelector(as(A));if(R){c=R._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(s.count++,s=yo.bind(s),c.then(s,s)),m.state.loading|=4,m.instance=R,qt(R);return}R=c.ownerDocument||c,E=dx(E),(A=wr.get(A))&&Fc(E,A),R=R.createElement("link"),qt(R);var se=R;se._p=new Promise(function(pe,De){se.onload=pe,se.onerror=De}),Wt(R,"link",E),m.instance=R}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(m,c),(c=m.state.preload)&&(m.state.loading&3)===0&&(s.count++,m=yo.bind(s),c.addEventListener("load",m),c.addEventListener("error",m))}}var Tc=0;function dh(s,c){return s.stylesheets&&s.count===0&&bo(s,s.stylesheets),0<s.count||0<s.imgCount?function(m){var E=setTimeout(function(){if(s.stylesheets&&bo(s,s.stylesheets),s.unsuspend){var R=s.unsuspend;s.unsuspend=null,R()}},6e4+c);0<s.imgBytes&&Tc===0&&(Tc=62500*Gd());var A=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&bo(s,s.stylesheets),s.unsuspend)){var R=s.unsuspend;s.unsuspend=null,R()}},(s.imgBytes>Tc?50:800)+c);return s.unsuspend=m,function(){s.unsuspend=null,clearTimeout(E),clearTimeout(A)}}:null}function yo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bo(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Eo=null;function bo(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Eo=new Map,c.forEach(hh,s),Eo=null,yo.call(s))}function hh(s,c){if(!(c.state.loading&4)){var m=Eo.get(s);if(m)var E=m.get(null);else{m=new Map,Eo.set(s,m);for(var A=s.querySelectorAll("link[data-precedence],style[data-precedence]"),R=0;R<A.length;R++){var se=A[R];(se.nodeName==="LINK"||se.getAttribute("media")!=="not all")&&(m.set(se.dataset.precedence,se),E=se)}E&&m.set(null,E)}A=c.instance,se=A.getAttribute("data-precedence"),R=m.get(se)||E,R===E&&m.set(null,A),m.set(se,A),this.count++,E=yo.bind(this),A.addEventListener("load",E),A.addEventListener("error",E),R?R.parentNode.insertBefore(A,R.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(A,s.firstChild)),c.state.loading|=4}}var ls={$$typeof:C,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function ph(s,c,m,E,A,R,se,pe,De){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=me(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.hiddenUpdates=me(null),this.identifierPrefix=E,this.onUncaughtError=A,this.onCaughtError=R,this.onRecoverableError=se,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function yx(s,c,m,E,A,R,se,pe,De,Le,ze,Xe){return s=new ph(s,c,m,se,De,Le,ze,Xe,pe),c=1,R===!0&&(c|=24),R=sr(3,null,null,c),s.current=R,R.stateNode=s,c=xa(),c.refCount++,s.pooledCache=c,c.refCount++,R.memoizedState={element:E,isDehydrated:m,cache:c},pa(R),s}function Ex(s){return s?(s=Qn,s):Qn}function bx(s,c,m,E,A,R){A=Ex(A),E.context===null?E.context=A:E.pendingContext=A,E=tn(c),E.payload={element:m},R=R===void 0?null:R,R!==null&&(E.callback=R),m=rn(s,E,c),m!==null&&(nr(m,s,c),Mi(m,s,c))}function wx(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var m=s.retryLane;s.retryLane=m!==0&&m<c?m:c}}function jc(s,c){wx(s,c),(s=s.alternate)&&wx(s,c)}function vx(s){if(s.tag===13||s.tag===31){var c=Bn(s,67108864);c!==null&&nr(c,s,67108864),jc(s,67108864)}}function Ax(s){if(s.tag===13||s.tag===31){var c=xr();c=We(c);var m=Bn(s,c);m!==null&&nr(m,s,c),jc(s,c)}}var wo=!0;function mh(s,c,m,E){var A=M.T;M.T=null;var R=q.p;try{q.p=2,$c(s,c,m,E)}finally{q.p=R,M.T=A}}function gh(s,c,m,E){var A=M.T;M.T=null;var R=q.p;try{q.p=8,$c(s,c,m,E)}finally{q.p=R,M.T=A}}function $c(s,c,m,E){if(wo){var A=Ic(E);if(A===null)wc(s,c,E,vo,m),Cx(s,E);else if(Eh(A,s,c,m,E))E.stopPropagation();else if(Cx(s,E),c&4&&-1<yh.indexOf(s)){for(;A!==null;){var R=Ln(A);if(R!==null)switch(R.tag){case 3:if(R=R.stateNode,R.current.memoizedState.isDehydrated){var se=$t(R.pendingLanes);if(se!==0){var pe=R;for(pe.pendingLanes|=2,pe.entangledLanes|=2;se;){var De=1<<31-Ie(se);pe.entanglements[1]|=De,se&=~De}kr(R),(bt&6)===0&&(no=Ee()+500,rs(0))}}break;case 31:case 13:pe=Bn(R,2),pe!==null&&nr(pe,R,2),so(),jc(R,2)}if(R=Ic(E),R===null&&wc(s,c,E,vo,m),R===A)break;A=R}A!==null&&E.stopPropagation()}else wc(s,c,E,null,m)}}function Ic(s){return s=Oo(s),Oc(s)}var vo=null;function Oc(s){if(vo=null,s=Mn(s),s!==null){var c=a(s);if(c===null)s=null;else{var m=c.tag;if(m===13){if(s=l(c),s!==null)return s;s=null}else if(m===31){if(s=u(c),s!==null)return s;s=null}else if(m===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return vo=s,null}function Bx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ve()){case Te:return 2;case Re:return 8;case ye:case Ne:return 32;case ie:return 268435456;default:return 32}default:return 32}}var Uc=!1,hn=null,pn=null,mn=null,us=new Map,xs=new Map,gn=[],yh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cx(s,c){switch(s){case"focusin":case"focusout":hn=null;break;case"dragenter":case"dragleave":pn=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":us.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":xs.delete(c.pointerId)}}function fs(s,c,m,E,A,R){return s===null||s.nativeEvent!==R?(s={blockedOn:c,domEventName:m,eventSystemFlags:E,nativeEvent:R,targetContainers:[A]},c!==null&&(c=Ln(c),c!==null&&vx(c)),s):(s.eventSystemFlags|=E,c=s.targetContainers,A!==null&&c.indexOf(A)===-1&&c.push(A),s)}function Eh(s,c,m,E,A){switch(c){case"focusin":return hn=fs(hn,s,c,m,E,A),!0;case"dragenter":return pn=fs(pn,s,c,m,E,A),!0;case"mouseover":return mn=fs(mn,s,c,m,E,A),!0;case"pointerover":var R=A.pointerId;return us.set(R,fs(us.get(R)||null,s,c,m,E,A)),!0;case"gotpointercapture":return R=A.pointerId,xs.set(R,fs(xs.get(R)||null,s,c,m,E,A)),!0}return!1}function _x(s){var c=Mn(s.target);if(c!==null){var m=a(c);if(m!==null){if(c=m.tag,c===13){if(c=l(m),c!==null){s.blockedOn=c,_t(s.priority,function(){Ax(m)});return}}else if(c===31){if(c=u(m),c!==null){s.blockedOn=c,_t(s.priority,function(){Ax(m)});return}}else if(c===3&&m.stateNode.current.memoizedState.isDehydrated){s.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ao(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var m=Ic(s.nativeEvent);if(m===null){m=s.nativeEvent;var E=new m.constructor(m.type,m);Io=E,m.target.dispatchEvent(E),Io=null}else return c=Ln(m),c!==null&&vx(c),s.blockedOn=m,!1;c.shift()}return!0}function Sx(s,c,m){Ao(s)&&m.delete(c)}function bh(){Uc=!1,hn!==null&&Ao(hn)&&(hn=null),pn!==null&&Ao(pn)&&(pn=null),mn!==null&&Ao(mn)&&(mn=null),us.forEach(Sx),xs.forEach(Sx)}function Bo(s,c){s.blockedOn===c&&(s.blockedOn=null,Uc||(Uc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,bh)))}var Co=null;function Rx(s){Co!==s&&(Co=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Co===s&&(Co=null);for(var c=0;c<s.length;c+=3){var m=s[c],E=s[c+1],A=s[c+2];if(typeof E!="function"){if(Oc(E||m)===null)continue;break}var R=Ln(m);R!==null&&(s.splice(c,3),c-=3,Ia(R,{pending:!0,data:A,method:m.method,action:E},E,A))}}))}function vi(s){function c(De){return Bo(De,s)}hn!==null&&Bo(hn,s),pn!==null&&Bo(pn,s),mn!==null&&Bo(mn,s),us.forEach(c),xs.forEach(c);for(var m=0;m<gn.length;m++){var E=gn[m];E.blockedOn===s&&(E.blockedOn=null)}for(;0<gn.length&&(m=gn[0],m.blockedOn===null);)_x(m),m.blockedOn===null&&gn.shift();if(m=(s.ownerDocument||s).$$reactFormReplay,m!=null)for(E=0;E<m.length;E+=3){var A=m[E],R=m[E+1],se=A[Zt]||null;if(typeof R=="function")se||Rx(m);else if(se){var pe=null;if(R&&R.hasAttribute("formAction")){if(A=R,se=R[Zt]||null)pe=se.formAction;else if(Oc(A)!==null)continue}else pe=se.action;typeof pe=="function"?m[E+1]=pe:(m.splice(E,3),E-=3),Rx(m)}}}function Dx(){function s(R){R.canIntercept&&R.info==="react-transition"&&R.intercept({handler:function(){return new Promise(function(se){return A=se})},focusReset:"manual",scroll:"manual"})}function c(){A!==null&&(A(),A=null),E||setTimeout(m,20)}function m(){if(!E&&!navigation.transition){var R=navigation.currentEntry;R&&R.url!=null&&navigation.navigate(R.url,{state:R.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var E=!1,A=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(m,100),function(){E=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),A!==null&&(A(),A=null)}}}function Pc(s){this._internalRoot=s}_o.prototype.render=Pc.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(n(409));var m=c.current,E=xr();bx(m,E,s,c,null,null)},_o.prototype.unmount=Pc.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;bx(s.current,2,null,s,null,null),so(),c[Pn]=null}};function _o(s){this._internalRoot=s}_o.prototype.unstable_scheduleHydration=function(s){if(s){var c=Rt();s={blockedOn:null,target:s,priority:c};for(var m=0;m<gn.length&&c!==0&&c<gn[m].priority;m++);gn.splice(m,0,s),m===0&&_x(s)}};var kx=t.version;if(kx!=="19.2.0")throw Error(n(527,kx,"19.2.0"));q.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=x(c),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var wh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var So=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!So.isDisabled&&So.supportsFiber)try{he=So.inject(wh),_e=So}catch{}}return reactDomClient_production.createRoot=function(s,c){if(!o(s))throw Error(n(299));var m=!1,E="",A=Ol,R=Ul,se=Pl;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onUncaughtError!==void 0&&(A=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(se=c.onRecoverableError)),c=yx(s,1,!1,null,null,m,E,null,A,R,se,Dx),s[Pn]=c.current,bc(s),new Pc(c)},reactDomClient_production.hydrateRoot=function(s,c,m){if(!o(s))throw Error(n(299));var E=!1,A="",R=Ol,se=Ul,pe=Pl,De=null;return m!=null&&(m.unstable_strictMode===!0&&(E=!0),m.identifierPrefix!==void 0&&(A=m.identifierPrefix),m.onUncaughtError!==void 0&&(R=m.onUncaughtError),m.onCaughtError!==void 0&&(se=m.onCaughtError),m.onRecoverableError!==void 0&&(pe=m.onRecoverableError),m.formState!==void 0&&(De=m.formState)),c=yx(s,1,!0,c,m??null,E,A,De,R,se,pe,Dx),c.context=Ex(null),m=c.current,E=xr(),E=We(E),A=tn(E),A.callback=null,rn(m,A,E),m=E,c.current.lanes=m,re(c,m),kr(c),s[Pn]=c.current,bc(s),new _o(c)},reactDomClient_production.version="19.2.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient(),reactExports=requireReact();const React=getDefaultExportFromCjs$1(reactExports),createStoreImpl=e=>{let t;const r=new Set,n=(x,p)=>{const g=typeof x=="function"?x(t):x;if(!Object.is(g,t)){const y=t;t=p??(typeof g!="object"||g===null)?g:Object.assign({},t,g),r.forEach(b=>b(t,y))}},o=()=>t,u={setState:n,getState:o,getInitialState:()=>f,subscribe:x=>(r.add(x),()=>r.delete(x))},f=t=e(n,o,u);return u},createStore$1=(e=>e?createStoreImpl(e):createStoreImpl),identity=e=>e;function useStore(e,t=identity){const r=React.useSyncExternalStore(e.subscribe,React.useCallback(()=>t(e.getState()),[e,t]),React.useCallback(()=>t(e.getInitialState()),[e,t]));return React.useDebugValue(r),r}const createImpl=e=>{const t=createStore$1(e),r=n=>useStore(t,n);return Object.assign(r,t),r},create=(e=>e?createImpl(e):createImpl);function createJSONStorage(e,t){let r;try{r=e()}catch{return}return{getItem:o=>{var a;const l=f=>f===null?null:JSON.parse(f,void 0),u=(a=r.getItem(o))!=null?a:null;return u instanceof Promise?u.then(l):l(u)},setItem:(o,a)=>r.setItem(o,JSON.stringify(a,void 0)),removeItem:o=>r.removeItem(o)}}const toThenable=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return toThenable(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return toThenable(n)(r)}}}},persistImpl=(e,t)=>(r,n,o)=>{let a={storage:createJSONStorage(()=>localStorage),partialize:v=>v,version:0,merge:(v,B)=>({...B,...v}),...t},l=!1;const u=new Set,f=new Set;let x=a.storage;if(!x)return e((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...v)},n,o);const p=()=>{const v=a.partialize({...n()});return x.setItem(a.name,{state:v,version:a.version})},g=o.setState;o.setState=(v,B)=>(g(v,B),p());const y=e((...v)=>(r(...v),p()),n,o);o.getInitialState=()=>y;let b;const w=()=>{var v,B;if(!x)return;l=!1,u.forEach(F=>{var C;return F((C=n())!=null?C:y)});const j=((B=a.onRehydrateStorage)==null?void 0:B.call(a,(v=n())!=null?v:y))||void 0;return toThenable(x.getItem.bind(x))(a.name).then(F=>{if(F)if(typeof F.version=="number"&&F.version!==a.version){if(a.migrate){const C=a.migrate(F.state,F.version);return C instanceof Promise?C.then(N=>[!0,N]):[!0,C]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,F.state];return[!1,void 0]}).then(F=>{var C;const[N,T]=F;if(b=a.merge(T,(C=n())!=null?C:y),r(b,!0),N)return p()}).then(()=>{j?.(b,void 0),b=n(),l=!0,f.forEach(F=>F(b))}).catch(F=>{j?.(void 0,F)})};return o.persist={setOptions:v=>{a={...a,...v},v.storage&&(x=v.storage)},clearStorage:()=>{x?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>l,onHydrate:v=>(u.add(v),()=>{u.delete(v)}),onFinishHydration:v=>(f.add(v),()=>{f.delete(v)})},a.skipHydration||w(),b||y},persist=persistImpl,useAuthStore=create()(persist(e=>({encryptedKey:null,publicKey:null,isUnlocked:!1,decryptedKey:null,password:null,setEncryptedKey:(t,r)=>e({encryptedKey:t,publicKey:r}),unlock:(t,r)=>e({isUnlocked:!0,decryptedKey:t,password:r||null}),lock:()=>e({isUnlocked:!1,decryptedKey:null,password:null}),logout:()=>e({encryptedKey:null,publicKey:null,isUnlocked:!1,decryptedKey:null,password:null})}),{name:"amber-auth-storage",partialize:e=>({encryptedKey:e.encryptedKey,publicKey:e.publicKey})})),scriptRel="modulepreload",assetsURL=function(e,t){return new URL(e,t).href},seen={},__vitePreload=function(t,r,n){let o=Promise.resolve();if(r&&r.length>0){let x=function(p){return Promise.all(p.map(g=>Promise.resolve(g).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};const l=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");o=x(r.map(p=>{if(p=assetsURL(p,n),p in seen)return;seen[p]=!0;const g=p.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(n)for(let w=l.length-1;w>=0;w--){const v=l[w];if(v.href===p&&(!g||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${p}"]${y}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":scriptRel,g||(b.as="script"),b.crossOrigin="",b.href=p,f&&b.setAttribute("nonce",f),document.head.appendChild(b),g)return new Promise((w,v)=>{b.addEventListener("load",w),b.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return o.then(l=>{for(const u of l||[])u.status==="rejected"&&a(u.reason);return t().catch(a)})},useWalletStore=create()(persist((e,t)=>({wallets:[],currentWalletId:null,currentKeypairId:null,addWallet:r=>e(n=>({wallets:[...n.wallets,r]})),removeWallet:r=>e(n=>({wallets:n.wallets.filter(o=>o.id!==r),currentWalletId:n.currentWalletId===r?null:n.currentWalletId})),updateWallet:(r,n)=>e(o=>({wallets:o.wallets.map(a=>a.id===r?{...a,...n}:a)})),getWallet:r=>t().wallets.find(n=>n.id===r),setCurrentWallet:r=>e(n=>{const a=n.wallets.find(l=>l.id===r)?.keypairs[0]?.id||null;return{currentWalletId:r,currentKeypairId:a}}),setCurrentKeypair:r=>e({currentKeypairId:r}),addKeypair:(r,n)=>e(o=>({wallets:o.wallets.map(a=>a.id===r?{...a,keypairs:[...a.keypairs,n]}:a)})),removeKeypair:(r,n)=>e(o=>({wallets:o.wallets.map(a=>a.id===r?{...a,keypairs:a.keypairs.filter(l=>l.id!==n)}:a),currentKeypairId:o.currentKeypairId===n?null:o.currentKeypairId})),updateKeypair:(r,n,o)=>e(a=>({wallets:a.wallets.map(l=>l.id===r?{...l,keypairs:l.keypairs.map(u=>u.id===n?{...u,...o}:u)}:l)})),getKeypair:r=>{for(const n of t().wallets){const o=n.keypairs.find(a=>a.id===r);if(o)return o}},getCurrentKeypair:()=>{const{currentKeypairId:r}=t();if(r)return t().getKeypair(r)}}),{name:"wallet-storage",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-Bra1CBZx.js");return{storage:r}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:r}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-Bra1CBZx.js");return{storage:n}},[],import.meta.url);return r.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-Bra1CBZx.js");return{storage:r}},[],import.meta.url);return t.removeItem(e)}}))}));function isBytes$5(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber$4(e,t=""){if(!Number.isSafeInteger(e)||e<0){const r=t&&`"${t}" `;throw new Error(`${r}expected integer >= 0, got ${e}`)}}function abytes$2(e,t,r=""){const n=isBytes$5(e),o=e?.length,a=t!==void 0;if(!n||a&&o!==t){const l=r&&`"${r}" `,u=a?` of length ${t}`:"",f=n?`length=${o}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+u+", got "+f)}return e}function ahash$2(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");anumber$4(e.outputLen),anumber$4(e.blockLen)}function aexists$2(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput$2(e,t){abytes$2(e,void 0,"digestInto() output");const r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function clean$2(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView$5(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr$4(e,t){return e<<32-t|e>>>t}function utf8ToBytes$5(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function kdfInputToBytes(e,t=""){return typeof e=="string"?utf8ToBytes$5(e):abytes$2(e,void 0,t)}function checkOpts$2(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}function createHasher$2(e,t={}){const r=(o,a)=>e(a).update(o).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=o=>e(o),Object.assign(r,t),Object.freeze(r)}function randomBytes$4(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const oidNist$1=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});let _HMAC$1=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(ahash$2(t),abytes$2(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?t.create().update(r).digest():r);for(let a=0;a<o.length;a++)o[a]^=54;this.iHash.update(o),this.oHash=t.create();for(let a=0;a<o.length;a++)o[a]^=106;this.oHash.update(o),clean$2(o)}update(t){return aexists$2(this),this.iHash.update(t),this}digestInto(t){aexists$2(this),abytes$2(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:n,finished:o,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=o,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$5=(e,t,r)=>new _HMAC$1(e,t).update(r).digest();hmac$5.create=(e,t)=>new _HMAC$1(e,t);function pbkdf2Init$1(e,t,r,n){ahash$2(e);const o=checkOpts$2({dkLen:32,asyncTick:10},n),{c:a,dkLen:l,asyncTick:u}=o;if(anumber$4(a,"c"),anumber$4(l,"dkLen"),anumber$4(u,"asyncTick"),a<1)throw new Error("iterations (c) must be >= 1");const f=kdfInputToBytes(t,"password"),x=kdfInputToBytes(r,"salt"),p=new Uint8Array(l),g=hmac$5.create(e,f),y=g._cloneInto().update(x);return{c:a,dkLen:l,asyncTick:u,DK:p,PRF:g,PRFSalt:y}}function pbkdf2Output$1(e,t,r,n,o){return e.destroy(),t.destroy(),n&&n.destroy(),clean$2(o),r}function pbkdf2$1(e,t,r,n){const{c:o,dkLen:a,DK:l,PRF:u,PRFSalt:f}=pbkdf2Init$1(e,t,r,n);let x;const p=new Uint8Array(4),g=createView$5(p),y=new Uint8Array(u.outputLen);for(let b=1,w=0;w<a;b++,w+=u.outputLen){const v=l.subarray(w,w+u.outputLen);g.setInt32(0,b,!1),(x=f._cloneInto(x)).update(p).digestInto(y),v.set(y.subarray(0,v.length));for(let B=1;B<o;B++){u._cloneInto(x).update(y).digestInto(y);for(let j=0;j<v.length;j++)v[j]^=y[j]}}return pbkdf2Output$1(u,f,l,x,y)}function Chi$4(e,t,r){return e&t^~e&r}function Maj$4(e,t,r){return e&t^e&r^t&r}let HashMD$2=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,o){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=createView$5(this.buffer)}update(t){aexists$2(this),abytes$2(t);const{view:r,buffer:n,blockLen:o}=this,a=t.length;for(let l=0;l<a;){const u=Math.min(o-this.pos,a-l);if(u===o){const f=createView$5(t);for(;o<=a-l;l+=o)this.process(f,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists$2(this),aoutput$2(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:a}=this;let{pos:l}=this;r[l++]=128,clean$2(this.buffer.subarray(l)),this.padOffset>o-l&&(this.process(n,0),l=0);for(let g=l;g<o;g++)r[g]=0;n.setBigUint64(o-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$5(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const x=f/4,p=this.get();if(x>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<x;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:a,destroyed:l,pos:u}=this;return t.destroyed=l,t.finished=a,t.length=o,t.pos=u,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}};const SHA256_IV$2=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA512_IV$1=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),U32_MASK64$1=BigInt(2**32-1),_32n$1=BigInt(32);function fromBig$1(e,t=!1){return t?{h:Number(e&U32_MASK64$1),l:Number(e>>_32n$1&U32_MASK64$1)}:{h:Number(e>>_32n$1&U32_MASK64$1)|0,l:Number(e&U32_MASK64$1)|0}}function split$1(e,t=!1){const r=e.length;let n=new Uint32Array(r),o=new Uint32Array(r);for(let a=0;a<r;a++){const{h:l,l:u}=fromBig$1(e[a],t);[n[a],o[a]]=[l,u]}return[n,o]}const shrSH$1=(e,t,r)=>e>>>r,shrSL$1=(e,t,r)=>e<<32-r|t>>>r,rotrSH$1=(e,t,r)=>e>>>r|t<<32-r,rotrSL$1=(e,t,r)=>e<<32-r|t>>>r,rotrBH$1=(e,t,r)=>e<<64-r|t>>>r-32,rotrBL$1=(e,t,r)=>e>>>r-32|t<<64-r;function add$1(e,t,r,n){const o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}const add3L$1=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H$1=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L$1=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H$1=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,add5L$1=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),add5H$1=(e,t,r,n,o,a)=>t+r+n+o+a+(e/2**32|0)|0,SHA256_K$4=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W$4=new Uint32Array(64);let SHA2_32B$1=class extends HashMD$2{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:r,C:n,D:o,E:a,F:l,G:u,H:f}=this;return[t,r,n,o,a,l,u,f]}set(t,r,n,o,a,l,u,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=f|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W$4[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W$4[g-15],b=SHA256_W$4[g-2],w=rotr$4(y,7)^rotr$4(y,18)^y>>>3,v=rotr$4(b,17)^rotr$4(b,19)^b>>>10;SHA256_W$4[g]=v+SHA256_W$4[g-7]+w+SHA256_W$4[g-16]|0}let{A:n,B:o,C:a,D:l,E:u,F:f,G:x,H:p}=this;for(let g=0;g<64;g++){const y=rotr$4(u,6)^rotr$4(u,11)^rotr$4(u,25),b=p+y+Chi$4(u,f,x)+SHA256_K$4[g]+SHA256_W$4[g]|0,v=(rotr$4(n,2)^rotr$4(n,13)^rotr$4(n,22))+Maj$4(n,o,a)|0;p=x,x=f,f=u,u=l+b|0,l=a,a=o,o=n,n=b+v|0}n=n+this.A|0,o=o+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,f=f+this.F|0,x=x+this.G|0,p=p+this.H|0,this.set(n,o,a,l,u,f,x,p)}roundClean(){clean$2(SHA256_W$4)}destroy(){this.set(0,0,0,0,0,0,0,0),clean$2(this.buffer)}},_SHA256$1=class extends SHA2_32B$1{A=SHA256_IV$2[0]|0;B=SHA256_IV$2[1]|0;C=SHA256_IV$2[2]|0;D=SHA256_IV$2[3]|0;E=SHA256_IV$2[4]|0;F=SHA256_IV$2[5]|0;G=SHA256_IV$2[6]|0;H=SHA256_IV$2[7]|0;constructor(){super(32)}};const K512$1=split$1(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),SHA512_Kh$1=K512$1[0],SHA512_Kl$1=K512$1[1],SHA512_W_H$1=new Uint32Array(80),SHA512_W_L$1=new Uint32Array(80);let SHA2_64B$1=class extends HashMD$2{constructor(t){super(128,t,16,!1)}get(){const{Ah:t,Al:r,Bh:n,Bl:o,Ch:a,Cl:l,Dh:u,Dl:f,Eh:x,El:p,Fh:g,Fl:y,Gh:b,Gl:w,Hh:v,Hl:B}=this;return[t,r,n,o,a,l,u,f,x,p,g,y,b,w,v,B]}set(t,r,n,o,a,l,u,f,x,p,g,y,b,w,v,B){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=a|0,this.Cl=l|0,this.Dh=u|0,this.Dl=f|0,this.Eh=x|0,this.El=p|0,this.Fh=g|0,this.Fl=y|0,this.Gh=b|0,this.Gl=w|0,this.Hh=v|0,this.Hl=B|0}process(t,r){for(let C=0;C<16;C++,r+=4)SHA512_W_H$1[C]=t.getUint32(r),SHA512_W_L$1[C]=t.getUint32(r+=4);for(let C=16;C<80;C++){const N=SHA512_W_H$1[C-15]|0,T=SHA512_W_L$1[C-15]|0,_=rotrSH$1(N,T,1)^rotrSH$1(N,T,8)^shrSH$1(N,T,7),S=rotrSL$1(N,T,1)^rotrSL$1(N,T,8)^shrSL$1(N,T,7),O=SHA512_W_H$1[C-2]|0,$=SHA512_W_L$1[C-2]|0,z=rotrSH$1(O,$,19)^rotrBH$1(O,$,61)^shrSH$1(O,$,6),W=rotrSL$1(O,$,19)^rotrBL$1(O,$,61)^shrSL$1(O,$,6),U=add4L$1(S,W,SHA512_W_L$1[C-7],SHA512_W_L$1[C-16]),I=add4H$1(U,_,z,SHA512_W_H$1[C-7],SHA512_W_H$1[C-16]);SHA512_W_H$1[C]=I|0,SHA512_W_L$1[C]=U|0}let{Ah:n,Al:o,Bh:a,Bl:l,Ch:u,Cl:f,Dh:x,Dl:p,Eh:g,El:y,Fh:b,Fl:w,Gh:v,Gl:B,Hh:j,Hl:F}=this;for(let C=0;C<80;C++){const N=rotrSH$1(g,y,14)^rotrSH$1(g,y,18)^rotrBH$1(g,y,41),T=rotrSL$1(g,y,14)^rotrSL$1(g,y,18)^rotrBL$1(g,y,41),_=g&b^~g&v,S=y&w^~y&B,O=add5L$1(F,T,S,SHA512_Kl$1[C],SHA512_W_L$1[C]),$=add5H$1(O,j,N,_,SHA512_Kh$1[C],SHA512_W_H$1[C]),z=O|0,W=rotrSH$1(n,o,28)^rotrBH$1(n,o,34)^rotrBH$1(n,o,39),U=rotrSL$1(n,o,28)^rotrBL$1(n,o,34)^rotrBL$1(n,o,39),I=n&a^n&u^a&u,G=o&l^o&f^l&f;j=v|0,F=B|0,v=b|0,B=w|0,b=g|0,w=y|0,{h:g,l:y}=add$1(x|0,p|0,$|0,z|0),x=u|0,p=f|0,u=a|0,f=l|0,a=n|0,l=o|0;const k=add3L$1(z,U,G);n=add3H$1(k,$,W,I),o=k|0}({h:n,l:o}=add$1(this.Ah|0,this.Al|0,n|0,o|0)),{h:a,l}=add$1(this.Bh|0,this.Bl|0,a|0,l|0),{h:u,l:f}=add$1(this.Ch|0,this.Cl|0,u|0,f|0),{h:x,l:p}=add$1(this.Dh|0,this.Dl|0,x|0,p|0),{h:g,l:y}=add$1(this.Eh|0,this.El|0,g|0,y|0),{h:b,l:w}=add$1(this.Fh|0,this.Fl|0,b|0,w|0),{h:v,l:B}=add$1(this.Gh|0,this.Gl|0,v|0,B|0),{h:j,l:F}=add$1(this.Hh|0,this.Hl|0,j|0,F|0),this.set(n,o,a,l,u,f,x,p,g,y,b,w,v,B,j,F)}roundClean(){clean$2(SHA512_W_H$1,SHA512_W_L$1)}destroy(){clean$2(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},_SHA512$1=class extends SHA2_64B$1{Ah=SHA512_IV$1[0]|0;Al=SHA512_IV$1[1]|0;Bh=SHA512_IV$1[2]|0;Bl=SHA512_IV$1[3]|0;Ch=SHA512_IV$1[4]|0;Cl=SHA512_IV$1[5]|0;Dh=SHA512_IV$1[6]|0;Dl=SHA512_IV$1[7]|0;Eh=SHA512_IV$1[8]|0;El=SHA512_IV$1[9]|0;Fh=SHA512_IV$1[10]|0;Fl=SHA512_IV$1[11]|0;Gh=SHA512_IV$1[12]|0;Gl=SHA512_IV$1[13]|0;Hh=SHA512_IV$1[14]|0;Hl=SHA512_IV$1[15]|0;constructor(){super(64)}};const sha256$6=createHasher$2(()=>new _SHA256$1,oidNist$1(1)),sha512$2=createHasher$2(()=>new _SHA512$1,oidNist$1(3));function isBytes$4(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function isArrayOf$1(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(r=>typeof r=="string"):t.every(r=>Number.isSafeInteger(r)):!1}function afn$1(e){if(typeof e!="function")throw new Error("function expected");return!0}function astr$1(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function anumber$3(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function aArr$1(e){if(!Array.isArray(e))throw new Error("array expected")}function astrArr$1(e,t){if(!isArrayOf$1(!0,t))throw new Error(`${e}: array of strings expected`)}function anumArr$1(e,t){if(!isArrayOf$1(!1,t))throw new Error(`${e}: array of numbers expected`)}function chain$2(...e){const t=a=>a,r=(a,l)=>u=>a(l(u)),n=e.map(a=>a.encode).reduceRight(r,t),o=e.map(a=>a.decode).reduce(r,t);return{encode:n,decode:o}}function alphabet$2(e){const t=typeof e=="string"?e.split(""):e,r=t.length;astrArr$1("alphabet",t);const n=new Map(t.map((o,a)=>[o,a]));return{encode:o=>(aArr$1(o),o.map(a=>{if(!Number.isSafeInteger(a)||a<0||a>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${a}". Allowed: ${e}`);return t[a]})),decode:o=>(aArr$1(o),o.map(a=>{astr$1("alphabet.decode",a);const l=n.get(a);if(l===void 0)throw new Error(`Unknown letter: "${a}". Allowed: ${e}`);return l}))}}function join$2(e=""){return astr$1("join",e),{encode:t=>(astrArr$1("join.decode",t),t.join(e)),decode:t=>(astr$1("join.decode",t),t.split(e))}}function padding$1(e,t="="){return anumber$3(e),astr$1("padding",t),{encode(r){for(astrArr$1("padding.encode",r);r.length*e%8;)r.push(t);return r},decode(r){astrArr$1("padding.decode",r);let n=r.length;if(n*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if((n-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,n)}}}function convertRadix$2(e,t,r){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: invalid to=${r}, base cannot be less than 2`);if(aArr$1(e),!e.length)return[];let n=0;const o=[],a=Array.from(e,u=>{if(anumber$3(u),u<0||u>=t)throw new Error(`invalid integer: ${u}`);return u}),l=a.length;for(;;){let u=0,f=!0;for(let x=n;x<l;x++){const p=a[x],g=t*u,y=g+p;if(!Number.isSafeInteger(y)||g/t!==u||y-p!==g)throw new Error("convertRadix: carry overflow");const b=y/r;u=y%r;const w=Math.floor(b);if(a[x]=w,!Number.isSafeInteger(w)||w*r+u!==y)throw new Error("convertRadix: carry overflow");if(f)w?f=!1:n=x;else continue}if(o.push(u),f)break}for(let u=0;u<e.length-1&&e[u]===0;u++)o.push(0);return o.reverse()}const gcd$1=(e,t)=>t===0?e:gcd$1(t,e%t),radix2carry$1=(e,t)=>e+(t-gcd$1(e,t)),powers=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function convertRadix2$1(e,t,r,n){if(aArr$1(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(radix2carry$1(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${radix2carry$1(t,r)}`);let o=0,a=0;const l=powers[t],u=powers[r]-1,f=[];for(const x of e){if(anumber$3(x),x>=l)throw new Error(`convertRadix2: invalid data word=${x} from=${t}`);if(o=o<<t|x,a+t>32)throw new Error(`convertRadix2: carry overflow pos=${a} from=${t}`);for(a+=t;a>=r;a-=r)f.push((o>>a-r&u)>>>0);const p=powers[a];if(p===void 0)throw new Error("invalid carry");o&=p-1}if(o=o<<r-a&u,!n&&a>=t)throw new Error("Excess padding");if(!n&&o>0)throw new Error(`Non-zero padding: ${o}`);return n&&a>0&&f.push(o>>>0),f}function radix$2(e){anumber$3(e);const t=2**8;return{encode:r=>{if(!isBytes$4(r))throw new Error("radix.encode input should be Uint8Array");return convertRadix$2(Array.from(r),t,e)},decode:r=>(anumArr$1("radix.decode",r),Uint8Array.from(convertRadix$2(r,e,t)))}}function radix2$1(e,t=!1){if(anumber$3(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry$1(8,e)>32||radix2carry$1(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!isBytes$4(r))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2$1(Array.from(r),8,e,!t)},decode:r=>(anumArr$1("radix2.decode",r),Uint8Array.from(convertRadix2$1(r,e,8,t)))}}function checksum$1(e,t){return anumber$3(e),afn$1(t),{encode(r){if(!isBytes$4(r))throw new Error("checksum.encode: input should be Uint8Array");const n=t(r).slice(0,e),o=new Uint8Array(r.length+e);return o.set(r),o.set(n,r.length),o},decode(r){if(!isBytes$4(r))throw new Error("checksum.decode: input should be Uint8Array");const n=r.slice(0,-e),o=r.slice(-e),a=t(n).slice(0,e);for(let l=0;l<e;l++)if(a[l]!==o[l])throw new Error("Invalid checksum");return n}}}const utils$8={alphabet:alphabet$2,chain:chain$2,checksum:checksum$1,convertRadix:convertRadix$2,convertRadix2:convertRadix2$1,radix:radix$2,radix2:radix2$1,join:join$2,padding:padding$1};const isJapanese=e=>e[0]==="";function nfkd(e){if(typeof e!="string")throw new TypeError("invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function normalize$2(e){const t=nfkd(e),r=t.split(" ");if(![12,15,18,21,24].includes(r.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:r}}function aentropy(e){if(abytes$2(e),![16,20,24,28,32].includes(e.length))throw new Error("invalid entropy length")}function generateMnemonic(e,t=128){if(anumber$4(t),t%32!==0||t>256)throw new TypeError("Invalid entropy");return entropyToMnemonic(randomBytes$4(t/8),e)}const calcChecksum=e=>{const t=8-e.length/4;return new Uint8Array([sha256$6(e)[0]>>t<<t])};function getCoder(e){if(!Array.isArray(e)||e.length!==2048||typeof e[0]!="string")throw new Error("Wordlist: expected array of 2048 strings");return e.forEach(t=>{if(typeof t!="string")throw new Error("wordlist: non-string element: "+t)}),utils$8.chain(utils$8.checksum(1,calcChecksum),utils$8.radix2(11,!0),utils$8.alphabet(e))}function mnemonicToEntropy(e,t){const{words:r}=normalize$2(e),n=getCoder(t).decode(r);return aentropy(n),n}function entropyToMnemonic(e,t){return aentropy(e),getCoder(t).encode(e).join(isJapanese(t)?"":" ")}function validateMnemonic(e,t){try{mnemonicToEntropy(e,t)}catch{return!1}return!0}const psalt=e=>nfkd("mnemonic"+e);function mnemonicToSeedSync(e,t=""){return pbkdf2$1(sha512$2,normalize$2(e).nfkd,psalt(t),{c:2048,dkLen:64})}const wordlist=`abandon
ability
able
about
above
absent
absorb
abstract
absurd
abuse
access
accident
account
accuse
achieve
acid
acoustic
acquire
across
act
action
actor
actress
actual
adapt
add
addict
address
adjust
admit
adult
advance
advice
aerobic
affair
afford
afraid
again
age
agent
agree
ahead
aim
air
airport
aisle
alarm
album
alcohol
alert
alien
all
alley
allow
almost
alone
alpha
already
also
alter
always
amateur
amazing
among
amount
amused
analyst
anchor
ancient
anger
angle
angry
animal
ankle
announce
annual
another
answer
antenna
antique
anxiety
any
apart
apology
appear
apple
approve
april
arch
arctic
area
arena
argue
arm
armed
armor
army
around
arrange
arrest
arrive
arrow
art
artefact
artist
artwork
ask
aspect
assault
asset
assist
assume
asthma
athlete
atom
attack
attend
attitude
attract
auction
audit
august
aunt
author
auto
autumn
average
avocado
avoid
awake
aware
away
awesome
awful
awkward
axis
baby
bachelor
bacon
badge
bag
balance
balcony
ball
bamboo
banana
banner
bar
barely
bargain
barrel
base
basic
basket
battle
beach
bean
beauty
because
become
beef
before
begin
behave
behind
believe
below
belt
bench
benefit
best
betray
better
between
beyond
bicycle
bid
bike
bind
biology
bird
birth
bitter
black
blade
blame
blanket
blast
bleak
bless
blind
blood
blossom
blouse
blue
blur
blush
board
boat
body
boil
bomb
bone
bonus
book
boost
border
boring
borrow
boss
bottom
bounce
box
boy
bracket
brain
brand
brass
brave
bread
breeze
brick
bridge
brief
bright
bring
brisk
broccoli
broken
bronze
broom
brother
brown
brush
bubble
buddy
budget
buffalo
build
bulb
bulk
bullet
bundle
bunker
burden
burger
burst
bus
business
busy
butter
buyer
buzz
cabbage
cabin
cable
cactus
cage
cake
call
calm
camera
camp
can
canal
cancel
candy
cannon
canoe
canvas
canyon
capable
capital
captain
car
carbon
card
cargo
carpet
carry
cart
case
cash
casino
castle
casual
cat
catalog
catch
category
cattle
caught
cause
caution
cave
ceiling
celery
cement
census
century
cereal
certain
chair
chalk
champion
change
chaos
chapter
charge
chase
chat
cheap
check
cheese
chef
cherry
chest
chicken
chief
child
chimney
choice
choose
chronic
chuckle
chunk
churn
cigar
cinnamon
circle
citizen
city
civil
claim
clap
clarify
claw
clay
clean
clerk
clever
click
client
cliff
climb
clinic
clip
clock
clog
close
cloth
cloud
clown
club
clump
cluster
clutch
coach
coast
coconut
code
coffee
coil
coin
collect
color
column
combine
come
comfort
comic
common
company
concert
conduct
confirm
congress
connect
consider
control
convince
cook
cool
copper
copy
coral
core
corn
correct
cost
cotton
couch
country
couple
course
cousin
cover
coyote
crack
cradle
craft
cram
crane
crash
crater
crawl
crazy
cream
credit
creek
crew
cricket
crime
crisp
critic
crop
cross
crouch
crowd
crucial
cruel
cruise
crumble
crunch
crush
cry
crystal
cube
culture
cup
cupboard
curious
current
curtain
curve
cushion
custom
cute
cycle
dad
damage
damp
dance
danger
daring
dash
daughter
dawn
day
deal
debate
debris
decade
december
decide
decline
decorate
decrease
deer
defense
define
defy
degree
delay
deliver
demand
demise
denial
dentist
deny
depart
depend
deposit
depth
deputy
derive
describe
desert
design
desk
despair
destroy
detail
detect
develop
device
devote
diagram
dial
diamond
diary
dice
diesel
diet
differ
digital
dignity
dilemma
dinner
dinosaur
direct
dirt
disagree
discover
disease
dish
dismiss
disorder
display
distance
divert
divide
divorce
dizzy
doctor
document
dog
doll
dolphin
domain
donate
donkey
donor
door
dose
double
dove
draft
dragon
drama
drastic
draw
dream
dress
drift
drill
drink
drip
drive
drop
drum
dry
duck
dumb
dune
during
dust
dutch
duty
dwarf
dynamic
eager
eagle
early
earn
earth
easily
east
easy
echo
ecology
economy
edge
edit
educate
effort
egg
eight
either
elbow
elder
electric
elegant
element
elephant
elevator
elite
else
embark
embody
embrace
emerge
emotion
employ
empower
empty
enable
enact
end
endless
endorse
enemy
energy
enforce
engage
engine
enhance
enjoy
enlist
enough
enrich
enroll
ensure
enter
entire
entry
envelope
episode
equal
equip
era
erase
erode
erosion
error
erupt
escape
essay
essence
estate
eternal
ethics
evidence
evil
evoke
evolve
exact
example
excess
exchange
excite
exclude
excuse
execute
exercise
exhaust
exhibit
exile
exist
exit
exotic
expand
expect
expire
explain
expose
express
extend
extra
eye
eyebrow
fabric
face
faculty
fade
faint
faith
fall
false
fame
family
famous
fan
fancy
fantasy
farm
fashion
fat
fatal
father
fatigue
fault
favorite
feature
february
federal
fee
feed
feel
female
fence
festival
fetch
fever
few
fiber
fiction
field
figure
file
film
filter
final
find
fine
finger
finish
fire
firm
first
fiscal
fish
fit
fitness
fix
flag
flame
flash
flat
flavor
flee
flight
flip
float
flock
floor
flower
fluid
flush
fly
foam
focus
fog
foil
fold
follow
food
foot
force
forest
forget
fork
fortune
forum
forward
fossil
foster
found
fox
fragile
frame
frequent
fresh
friend
fringe
frog
front
frost
frown
frozen
fruit
fuel
fun
funny
furnace
fury
future
gadget
gain
galaxy
gallery
game
gap
garage
garbage
garden
garlic
garment
gas
gasp
gate
gather
gauge
gaze
general
genius
genre
gentle
genuine
gesture
ghost
giant
gift
giggle
ginger
giraffe
girl
give
glad
glance
glare
glass
glide
glimpse
globe
gloom
glory
glove
glow
glue
goat
goddess
gold
good
goose
gorilla
gospel
gossip
govern
gown
grab
grace
grain
grant
grape
grass
gravity
great
green
grid
grief
grit
grocery
group
grow
grunt
guard
guess
guide
guilt
guitar
gun
gym
habit
hair
half
hammer
hamster
hand
happy
harbor
hard
harsh
harvest
hat
have
hawk
hazard
head
health
heart
heavy
hedgehog
height
hello
helmet
help
hen
hero
hidden
high
hill
hint
hip
hire
history
hobby
hockey
hold
hole
holiday
hollow
home
honey
hood
hope
horn
horror
horse
hospital
host
hotel
hour
hover
hub
huge
human
humble
humor
hundred
hungry
hunt
hurdle
hurry
hurt
husband
hybrid
ice
icon
idea
identify
idle
ignore
ill
illegal
illness
image
imitate
immense
immune
impact
impose
improve
impulse
inch
include
income
increase
index
indicate
indoor
industry
infant
inflict
inform
inhale
inherit
initial
inject
injury
inmate
inner
innocent
input
inquiry
insane
insect
inside
inspire
install
intact
interest
into
invest
invite
involve
iron
island
isolate
issue
item
ivory
jacket
jaguar
jar
jazz
jealous
jeans
jelly
jewel
job
join
joke
journey
joy
judge
juice
jump
jungle
junior
junk
just
kangaroo
keen
keep
ketchup
key
kick
kid
kidney
kind
kingdom
kiss
kit
kitchen
kite
kitten
kiwi
knee
knife
knock
know
lab
label
labor
ladder
lady
lake
lamp
language
laptop
large
later
latin
laugh
laundry
lava
law
lawn
lawsuit
layer
lazy
leader
leaf
learn
leave
lecture
left
leg
legal
legend
leisure
lemon
lend
length
lens
leopard
lesson
letter
level
liar
liberty
library
license
life
lift
light
like
limb
limit
link
lion
liquid
list
little
live
lizard
load
loan
lobster
local
lock
logic
lonely
long
loop
lottery
loud
lounge
love
loyal
lucky
luggage
lumber
lunar
lunch
luxury
lyrics
machine
mad
magic
magnet
maid
mail
main
major
make
mammal
man
manage
mandate
mango
mansion
manual
maple
marble
march
margin
marine
market
marriage
mask
mass
master
match
material
math
matrix
matter
maximum
maze
meadow
mean
measure
meat
mechanic
medal
media
melody
melt
member
memory
mention
menu
mercy
merge
merit
merry
mesh
message
metal
method
middle
midnight
milk
million
mimic
mind
minimum
minor
minute
miracle
mirror
misery
miss
mistake
mix
mixed
mixture
mobile
model
modify
mom
moment
monitor
monkey
monster
month
moon
moral
more
morning
mosquito
mother
motion
motor
mountain
mouse
move
movie
much
muffin
mule
multiply
muscle
museum
mushroom
music
must
mutual
myself
mystery
myth
naive
name
napkin
narrow
nasty
nation
nature
near
neck
need
negative
neglect
neither
nephew
nerve
nest
net
network
neutral
never
news
next
nice
night
noble
noise
nominee
noodle
normal
north
nose
notable
note
nothing
notice
novel
now
nuclear
number
nurse
nut
oak
obey
object
oblige
obscure
observe
obtain
obvious
occur
ocean
october
odor
off
offer
office
often
oil
okay
old
olive
olympic
omit
once
one
onion
online
only
open
opera
opinion
oppose
option
orange
orbit
orchard
order
ordinary
organ
orient
original
orphan
ostrich
other
outdoor
outer
output
outside
oval
oven
over
own
owner
oxygen
oyster
ozone
pact
paddle
page
pair
palace
palm
panda
panel
panic
panther
paper
parade
parent
park
parrot
party
pass
patch
path
patient
patrol
pattern
pause
pave
payment
peace
peanut
pear
peasant
pelican
pen
penalty
pencil
people
pepper
perfect
permit
person
pet
phone
photo
phrase
physical
piano
picnic
picture
piece
pig
pigeon
pill
pilot
pink
pioneer
pipe
pistol
pitch
pizza
place
planet
plastic
plate
play
please
pledge
pluck
plug
plunge
poem
poet
point
polar
pole
police
pond
pony
pool
popular
portion
position
possible
post
potato
pottery
poverty
powder
power
practice
praise
predict
prefer
prepare
present
pretty
prevent
price
pride
primary
print
priority
prison
private
prize
problem
process
produce
profit
program
project
promote
proof
property
prosper
protect
proud
provide
public
pudding
pull
pulp
pulse
pumpkin
punch
pupil
puppy
purchase
purity
purpose
purse
push
put
puzzle
pyramid
quality
quantum
quarter
question
quick
quit
quiz
quote
rabbit
raccoon
race
rack
radar
radio
rail
rain
raise
rally
ramp
ranch
random
range
rapid
rare
rate
rather
raven
raw
razor
ready
real
reason
rebel
rebuild
recall
receive
recipe
record
recycle
reduce
reflect
reform
refuse
region
regret
regular
reject
relax
release
relief
rely
remain
remember
remind
remove
render
renew
rent
reopen
repair
repeat
replace
report
require
rescue
resemble
resist
resource
response
result
retire
retreat
return
reunion
reveal
review
reward
rhythm
rib
ribbon
rice
rich
ride
ridge
rifle
right
rigid
ring
riot
ripple
risk
ritual
rival
river
road
roast
robot
robust
rocket
romance
roof
rookie
room
rose
rotate
rough
round
route
royal
rubber
rude
rug
rule
run
runway
rural
sad
saddle
sadness
safe
sail
salad
salmon
salon
salt
salute
same
sample
sand
satisfy
satoshi
sauce
sausage
save
say
scale
scan
scare
scatter
scene
scheme
school
science
scissors
scorpion
scout
scrap
screen
script
scrub
sea
search
season
seat
second
secret
section
security
seed
seek
segment
select
sell
seminar
senior
sense
sentence
series
service
session
settle
setup
seven
shadow
shaft
shallow
share
shed
shell
sheriff
shield
shift
shine
ship
shiver
shock
shoe
shoot
shop
short
shoulder
shove
shrimp
shrug
shuffle
shy
sibling
sick
side
siege
sight
sign
silent
silk
silly
silver
similar
simple
since
sing
siren
sister
situate
six
size
skate
sketch
ski
skill
skin
skirt
skull
slab
slam
sleep
slender
slice
slide
slight
slim
slogan
slot
slow
slush
small
smart
smile
smoke
smooth
snack
snake
snap
sniff
snow
soap
soccer
social
sock
soda
soft
solar
soldier
solid
solution
solve
someone
song
soon
sorry
sort
soul
sound
soup
source
south
space
spare
spatial
spawn
speak
special
speed
spell
spend
sphere
spice
spider
spike
spin
spirit
split
spoil
sponsor
spoon
sport
spot
spray
spread
spring
spy
square
squeeze
squirrel
stable
stadium
staff
stage
stairs
stamp
stand
start
state
stay
steak
steel
stem
step
stereo
stick
still
sting
stock
stomach
stone
stool
story
stove
strategy
street
strike
strong
struggle
student
stuff
stumble
style
subject
submit
subway
success
such
sudden
suffer
sugar
suggest
suit
summer
sun
sunny
sunset
super
supply
supreme
sure
surface
surge
surprise
surround
survey
suspect
sustain
swallow
swamp
swap
swarm
swear
sweet
swift
swim
swing
switch
sword
symbol
symptom
syrup
system
table
tackle
tag
tail
talent
talk
tank
tape
target
task
taste
tattoo
taxi
teach
team
tell
ten
tenant
tennis
tent
term
test
text
thank
that
theme
then
theory
there
they
thing
this
thought
three
thrive
throw
thumb
thunder
ticket
tide
tiger
tilt
timber
time
tiny
tip
tired
tissue
title
toast
tobacco
today
toddler
toe
together
toilet
token
tomato
tomorrow
tone
tongue
tonight
tool
tooth
top
topic
topple
torch
tornado
tortoise
toss
total
tourist
toward
tower
town
toy
track
trade
traffic
tragic
train
transfer
trap
trash
travel
tray
treat
tree
trend
trial
tribe
trick
trigger
trim
trip
trophy
trouble
truck
true
truly
trumpet
trust
truth
try
tube
tuition
tumble
tuna
tunnel
turkey
turn
turtle
twelve
twenty
twice
twin
twist
two
type
typical
ugly
umbrella
unable
unaware
uncle
uncover
under
undo
unfair
unfold
unhappy
uniform
unique
unit
universe
unknown
unlock
until
unusual
unveil
update
upgrade
uphold
upon
upper
upset
urban
urge
usage
use
used
useful
useless
usual
utility
vacant
vacuum
vague
valid
valley
valve
van
vanish
vapor
various
vast
vault
vehicle
velvet
vendor
venture
venue
verb
verify
version
very
vessel
veteran
viable
vibrant
vicious
victory
video
view
village
vintage
violin
virtual
virus
visa
visit
visual
vital
vivid
vocal
voice
void
volcano
volume
vote
voyage
wage
wagon
wait
walk
wall
walnut
want
warfare
warm
warrior
wash
wasp
waste
water
wave
way
wealth
weapon
wear
weasel
weather
web
wedding
weekend
weird
welcome
west
wet
whale
what
wheat
wheel
when
where
whip
whisper
wide
width
wife
wild
will
win
window
wine
wing
wink
winner
winter
wire
wisdom
wise
wish
witness
wolf
woman
wonder
wood
wool
word
work
world
worry
worth
wrap
wreck
wrestle
wrist
write
wrong
yard
year
yellow
you
young
youth
zebra
zero
zone
zoo`.split(`
`);function isBytes$3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber$2(e,t=""){if(!Number.isSafeInteger(e)||e<0){const r=t&&`"${t}" `;throw new Error(`${r}expected integer >= 0, got ${e}`)}}function abytes$1(e,t,r=""){const n=isBytes$3(e),o=e?.length,a=t!==void 0;if(!n||a&&o!==t){const l=r&&`"${r}" `,u=a?` of length ${t}`:"",f=n?`length=${o}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+u+", got "+f)}return e}function ahash$1(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");anumber$2(e.outputLen),anumber$2(e.blockLen)}function aexists$1(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput$1(e,t){abytes$1(e,void 0,"digestInto() output");const r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function clean$1(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView$4(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr$3(e,t){return e<<32-t|e>>>t}function rotl$3(e,t){return e<<t|e>>>32-t>>>0}const hasHexBuiltin$1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes$4=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$4(e){if(abytes$1(e),hasHexBuiltin$1)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=hexes$4[e[r]];return t}const asciis$2={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16$2(e){if(e>=asciis$2._0&&e<=asciis$2._9)return e-asciis$2._0;if(e>=asciis$2.A&&e<=asciis$2.F)return e-(asciis$2.A-10);if(e>=asciis$2.a&&e<=asciis$2.f)return e-(asciis$2.a-10)}function hexToBytes$6(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(hasHexBuiltin$1)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let o=0,a=0;o<r;o++,a+=2){const l=asciiToBase16$2(e.charCodeAt(a)),u=asciiToBase16$2(e.charCodeAt(a+1));if(l===void 0||u===void 0){const f=e[a]+e[a+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+a)}n[o]=l*16+u}return n}function concatBytes$4(...e){let t=0;for(let n=0;n<e.length;n++){const o=e[n];abytes$1(o),t+=o.length}const r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){const a=e[n];r.set(a,o),o+=a.length}return r}function createHasher$1(e,t={}){const r=(o,a)=>e(a).update(o).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=o=>e(o),Object.assign(r,t),Object.freeze(r)}function randomBytes$3(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const oidNist=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function Chi$3(e,t,r){return e&t^~e&r}function Maj$3(e,t,r){return e&t^e&r^t&r}let HashMD$1=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,o){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=createView$4(this.buffer)}update(t){aexists$1(this),abytes$1(t);const{view:r,buffer:n,blockLen:o}=this,a=t.length;for(let l=0;l<a;){const u=Math.min(o-this.pos,a-l);if(u===o){const f=createView$4(t);for(;o<=a-l;l+=o)this.process(f,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists$1(this),aoutput$1(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:a}=this;let{pos:l}=this;r[l++]=128,clean$1(this.buffer.subarray(l)),this.padOffset>o-l&&(this.process(n,0),l=0);for(let g=l;g<o;g++)r[g]=0;n.setBigUint64(o-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$4(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const x=f/4,p=this.get();if(x>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<x;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:a,destroyed:l,pos:u}=this;return t.destroyed=l,t.finished=a,t.length=o,t.pos=u,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}};const SHA256_IV$1=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(e,t=!1){return t?{h:Number(e&U32_MASK64),l:Number(e>>_32n&U32_MASK64)}:{h:Number(e>>_32n&U32_MASK64)|0,l:Number(e&U32_MASK64)|0}}function split(e,t=!1){const r=e.length;let n=new Uint32Array(r),o=new Uint32Array(r);for(let a=0;a<r;a++){const{h:l,l:u}=fromBig(e[a],t);[n[a],o[a]]=[l,u]}return[n,o]}const shrSH=(e,t,r)=>e>>>r,shrSL=(e,t,r)=>e<<32-r|t>>>r,rotrSH=(e,t,r)=>e>>>r|t<<32-r,rotrSL=(e,t,r)=>e<<32-r|t>>>r,rotrBH=(e,t,r)=>e<<64-r|t>>>r-32,rotrBL=(e,t,r)=>e>>>r-32|t<<64-r;function add(e,t,r,n){const o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}const add3L=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,add5L=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),add5H=(e,t,r,n,o,a)=>t+r+n+o+a+(e/2**32|0)|0,SHA256_K$3=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W$3=new Uint32Array(64);class SHA2_32B extends HashMD$1{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:r,C:n,D:o,E:a,F:l,G:u,H:f}=this;return[t,r,n,o,a,l,u,f]}set(t,r,n,o,a,l,u,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=f|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W$3[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W$3[g-15],b=SHA256_W$3[g-2],w=rotr$3(y,7)^rotr$3(y,18)^y>>>3,v=rotr$3(b,17)^rotr$3(b,19)^b>>>10;SHA256_W$3[g]=v+SHA256_W$3[g-7]+w+SHA256_W$3[g-16]|0}let{A:n,B:o,C:a,D:l,E:u,F:f,G:x,H:p}=this;for(let g=0;g<64;g++){const y=rotr$3(u,6)^rotr$3(u,11)^rotr$3(u,25),b=p+y+Chi$3(u,f,x)+SHA256_K$3[g]+SHA256_W$3[g]|0,v=(rotr$3(n,2)^rotr$3(n,13)^rotr$3(n,22))+Maj$3(n,o,a)|0;p=x,x=f,f=u,u=l+b|0,l=a,a=o,o=n,n=b+v|0}n=n+this.A|0,o=o+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,f=f+this.F|0,x=x+this.G|0,p=p+this.H|0,this.set(n,o,a,l,u,f,x,p)}roundClean(){clean$1(SHA256_W$3)}destroy(){this.set(0,0,0,0,0,0,0,0),clean$1(this.buffer)}}class _SHA256 extends SHA2_32B{A=SHA256_IV$1[0]|0;B=SHA256_IV$1[1]|0;C=SHA256_IV$1[2]|0;D=SHA256_IV$1[3]|0;E=SHA256_IV$1[4]|0;F=SHA256_IV$1[5]|0;G=SHA256_IV$1[6]|0;H=SHA256_IV$1[7]|0;constructor(){super(32)}}const K512=split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),SHA512_Kh=K512[0],SHA512_Kl=K512[1],SHA512_W_H=new Uint32Array(80),SHA512_W_L=new Uint32Array(80);class SHA2_64B extends HashMD$1{constructor(t){super(128,t,16,!1)}get(){const{Ah:t,Al:r,Bh:n,Bl:o,Ch:a,Cl:l,Dh:u,Dl:f,Eh:x,El:p,Fh:g,Fl:y,Gh:b,Gl:w,Hh:v,Hl:B}=this;return[t,r,n,o,a,l,u,f,x,p,g,y,b,w,v,B]}set(t,r,n,o,a,l,u,f,x,p,g,y,b,w,v,B){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=a|0,this.Cl=l|0,this.Dh=u|0,this.Dl=f|0,this.Eh=x|0,this.El=p|0,this.Fh=g|0,this.Fl=y|0,this.Gh=b|0,this.Gl=w|0,this.Hh=v|0,this.Hl=B|0}process(t,r){for(let C=0;C<16;C++,r+=4)SHA512_W_H[C]=t.getUint32(r),SHA512_W_L[C]=t.getUint32(r+=4);for(let C=16;C<80;C++){const N=SHA512_W_H[C-15]|0,T=SHA512_W_L[C-15]|0,_=rotrSH(N,T,1)^rotrSH(N,T,8)^shrSH(N,T,7),S=rotrSL(N,T,1)^rotrSL(N,T,8)^shrSL(N,T,7),O=SHA512_W_H[C-2]|0,$=SHA512_W_L[C-2]|0,z=rotrSH(O,$,19)^rotrBH(O,$,61)^shrSH(O,$,6),W=rotrSL(O,$,19)^rotrBL(O,$,61)^shrSL(O,$,6),U=add4L(S,W,SHA512_W_L[C-7],SHA512_W_L[C-16]),I=add4H(U,_,z,SHA512_W_H[C-7],SHA512_W_H[C-16]);SHA512_W_H[C]=I|0,SHA512_W_L[C]=U|0}let{Ah:n,Al:o,Bh:a,Bl:l,Ch:u,Cl:f,Dh:x,Dl:p,Eh:g,El:y,Fh:b,Fl:w,Gh:v,Gl:B,Hh:j,Hl:F}=this;for(let C=0;C<80;C++){const N=rotrSH(g,y,14)^rotrSH(g,y,18)^rotrBH(g,y,41),T=rotrSL(g,y,14)^rotrSL(g,y,18)^rotrBL(g,y,41),_=g&b^~g&v,S=y&w^~y&B,O=add5L(F,T,S,SHA512_Kl[C],SHA512_W_L[C]),$=add5H(O,j,N,_,SHA512_Kh[C],SHA512_W_H[C]),z=O|0,W=rotrSH(n,o,28)^rotrBH(n,o,34)^rotrBH(n,o,39),U=rotrSL(n,o,28)^rotrBL(n,o,34)^rotrBL(n,o,39),I=n&a^n&u^a&u,G=o&l^o&f^l&f;j=v|0,F=B|0,v=b|0,B=w|0,b=g|0,w=y|0,{h:g,l:y}=add(x|0,p|0,$|0,z|0),x=u|0,p=f|0,u=a|0,f=l|0,a=n|0,l=o|0;const k=add3L(z,U,G);n=add3H(k,$,W,I),o=k|0}({h:n,l:o}=add(this.Ah|0,this.Al|0,n|0,o|0)),{h:a,l}=add(this.Bh|0,this.Bl|0,a|0,l|0),{h:u,l:f}=add(this.Ch|0,this.Cl|0,u|0,f|0),{h:x,l:p}=add(this.Dh|0,this.Dl|0,x|0,p|0),{h:g,l:y}=add(this.Eh|0,this.El|0,g|0,y|0),{h:b,l:w}=add(this.Fh|0,this.Fl|0,b|0,w|0),{h:v,l:B}=add(this.Gh|0,this.Gl|0,v|0,B|0),{h:j,l:F}=add(this.Hh|0,this.Hl|0,j|0,F|0),this.set(n,o,a,l,u,f,x,p,g,y,b,w,v,B,j,F)}roundClean(){clean$1(SHA512_W_H,SHA512_W_L)}destroy(){clean$1(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class _SHA512 extends SHA2_64B{Ah=SHA512_IV[0]|0;Al=SHA512_IV[1]|0;Bh=SHA512_IV[2]|0;Bl=SHA512_IV[3]|0;Ch=SHA512_IV[4]|0;Cl=SHA512_IV[5]|0;Dh=SHA512_IV[6]|0;Dl=SHA512_IV[7]|0;Eh=SHA512_IV[8]|0;El=SHA512_IV[9]|0;Fh=SHA512_IV[10]|0;Fl=SHA512_IV[11]|0;Gh=SHA512_IV[12]|0;Gl=SHA512_IV[13]|0;Hh=SHA512_IV[14]|0;Hl=SHA512_IV[15]|0;constructor(){super(64)}}const sha256$5=createHasher$1(()=>new _SHA256,oidNist(1)),sha512$1=createHasher$1(()=>new _SHA512,oidNist(3));const _0n$d=BigInt(0),_1n$d=BigInt(1);function abool(e,t=""){if(typeof e!="boolean"){const r=t&&`"${t}" `;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function abignumber(e){if(typeof e=="bigint"){if(!isPosBig$1(e))throw new Error("positive bigint expected, got "+e)}else anumber$2(e);return e}function numberToHexUnpadded$2(e){const t=abignumber(e).toString(16);return t.length&1?"0"+t:t}function hexToNumber$2(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?_0n$d:BigInt("0x"+e)}function bytesToNumberBE$2(e){return hexToNumber$2(bytesToHex$4(e))}function bytesToNumberLE$2(e){return hexToNumber$2(bytesToHex$4(copyBytes(abytes$1(e)).reverse()))}function numberToBytesBE$2(e,t){anumber$2(t),e=abignumber(e);const r=hexToBytes$6(e.toString(16).padStart(t*2,"0"));if(r.length!==t)throw new Error("number too large");return r}function numberToBytesLE$2(e,t){return numberToBytesBE$2(e,t).reverse()}function copyBytes(e){return Uint8Array.from(e)}const isPosBig$1=e=>typeof e=="bigint"&&_0n$d<=e;function inRange$1(e,t,r){return isPosBig$1(e)&&isPosBig$1(t)&&isPosBig$1(r)&&t<=e&&e<r}function aInRange$1(e,t,r,n){if(!inRange$1(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function bitLen$2(e){let t;for(t=0;e>_0n$d;e>>=_1n$d,t+=1);return t}const bitMask$2=e=>(_1n$d<<BigInt(e))-_1n$d;function createHmacDrbg$2(e,t,r){if(anumber$2(e,"hashLen"),anumber$2(t,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");const n=B=>new Uint8Array(B),o=Uint8Array.of(),a=Uint8Array.of(0),l=Uint8Array.of(1),u=1e3;let f=n(e),x=n(e),p=0;const g=()=>{f.fill(1),x.fill(0),p=0},y=(...B)=>r(x,concatBytes$4(f,...B)),b=(B=o)=>{x=y(a,B),f=y(),B.length!==0&&(x=y(l,B),f=y())},w=()=>{if(p++>=u)throw new Error("drbg: tried max amount of iterations");let B=0;const j=[];for(;B<t;){f=y();const F=f.slice();j.push(F),B+=f.length}return concatBytes$4(...j)};return(B,j)=>{g(),b(B);let F;for(;!(F=j(w()));)b();return g(),F}}function validateObject$1(e,t={},r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(a,l,u){const f=e[a];if(u&&f===void 0)return;const x=typeof f;if(x!==l||f===null)throw new Error(`param "${a}" is invalid: expected ${l}, got ${x}`)}const o=(a,l)=>Object.entries(a).forEach(([u,f])=>n(u,f,l));o(t,!1),o(r,!0)}function memoized$1(e){const t=new WeakMap;return(r,...n)=>{const o=t.get(r);if(o!==void 0)return o;const a=e(r,...n);return t.set(r,a),a}}const _0n$c=BigInt(0),_1n$c=BigInt(1),_2n$8=BigInt(2),_3n$5=BigInt(3),_4n$4=BigInt(4),_5n$2=BigInt(5),_7n$1=BigInt(7),_8n$2=BigInt(8),_9n$1=BigInt(9),_16n$1=BigInt(16);function mod$2(e,t){const r=e%t;return r>=_0n$c?r:t+r}function pow2$2(e,t,r){let n=e;for(;t-- >_0n$c;)n*=n,n%=r;return n}function invert$2(e,t){if(e===_0n$c)throw new Error("invert: expected non-zero number");if(t<=_0n$c)throw new Error("invert: expected positive modulus, got "+t);let r=mod$2(e,t),n=t,o=_0n$c,a=_1n$c;for(;r!==_0n$c;){const u=n/r,f=n%r,x=o-a*u;n=r,r=f,o=a,a=x}if(n!==_1n$c)throw new Error("invert: does not exist");return mod$2(o,t)}function assertIsSquare$1(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function sqrt3mod4$1(e,t){const r=(e.ORDER+_1n$c)/_4n$4,n=e.pow(t,r);return assertIsSquare$1(e,n,t),n}function sqrt5mod8$1(e,t){const r=(e.ORDER-_5n$2)/_8n$2,n=e.mul(t,_2n$8),o=e.pow(n,r),a=e.mul(t,o),l=e.mul(e.mul(a,_2n$8),o),u=e.mul(a,e.sub(l,e.ONE));return assertIsSquare$1(e,u,t),u}function sqrt9mod16$1(e){const t=Field$2(e),r=tonelliShanks$2(e),n=r(t,t.neg(t.ONE)),o=r(t,n),a=r(t,t.neg(n)),l=(e+_7n$1)/_16n$1;return(u,f)=>{let x=u.pow(f,l),p=u.mul(x,n);const g=u.mul(x,o),y=u.mul(x,a),b=u.eql(u.sqr(p),f),w=u.eql(u.sqr(g),f);x=u.cmov(x,p,b),p=u.cmov(y,g,w);const v=u.eql(u.sqr(p),f),B=u.cmov(x,p,v);return assertIsSquare$1(u,B,f),B}}function tonelliShanks$2(e){if(e<_3n$5)throw new Error("sqrt is not defined for small field");let t=e-_1n$c,r=0;for(;t%_2n$8===_0n$c;)t/=_2n$8,r++;let n=_2n$8;const o=Field$2(e);for(;FpLegendre$1(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return sqrt3mod4$1;let a=o.pow(n,t);const l=(t+_1n$c)/_2n$8;return function(f,x){if(f.is0(x))return x;if(FpLegendre$1(f,x)!==1)throw new Error("Cannot find square root");let p=r,g=f.mul(f.ONE,a),y=f.pow(x,t),b=f.pow(x,l);for(;!f.eql(y,f.ONE);){if(f.is0(y))return f.ZERO;let w=1,v=f.sqr(y);for(;!f.eql(v,f.ONE);)if(w++,v=f.sqr(v),w===p)throw new Error("Cannot find square root");const B=_1n$c<<BigInt(p-w-1),j=f.pow(g,B);p=w,g=f.sqr(j),y=f.mul(y,g),b=f.mul(b,j)}return b}}function FpSqrt$2(e){return e%_4n$4===_3n$5?sqrt3mod4$1:e%_8n$2===_5n$2?sqrt5mod8$1:e%_16n$1===_9n$1?sqrt9mod16$1(e):tonelliShanks$2(e)}const FIELD_FIELDS$2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$2(e){const t={ORDER:"bigint",BYTES:"number",BITS:"number"},r=FIELD_FIELDS$2.reduce((n,o)=>(n[o]="function",n),t);return validateObject$1(e,r),e}function FpPow$2(e,t,r){if(r<_0n$c)throw new Error("invalid exponent, negatives unsupported");if(r===_0n$c)return e.ONE;if(r===_1n$c)return t;let n=e.ONE,o=t;for(;r>_0n$c;)r&_1n$c&&(n=e.mul(n,o)),o=e.sqr(o),r>>=_1n$c;return n}function FpInvertBatch$2(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((l,u,f)=>e.is0(u)?l:(n[f]=l,e.mul(l,u)),e.ONE),a=e.inv(o);return t.reduceRight((l,u,f)=>e.is0(u)?l:(n[f]=e.mul(l,n[f]),e.mul(l,u)),a),n}function FpLegendre$1(e,t){const r=(e.ORDER-_1n$c)/_2n$8,n=e.pow(t,r),o=e.eql(n,e.ONE),a=e.eql(n,e.ZERO),l=e.eql(n,e.neg(e.ONE));if(!o&&!a&&!l)throw new Error("invalid Legendre symbol result");return o?1:a?0:-1}function nLength$2(e,t){t!==void 0&&anumber$2(t);const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}class _Field{ORDER;BITS;BYTES;isLE;ZERO=_0n$c;ONE=_1n$c;_lengths;_sqrt;_mod;constructor(t,r={}){if(t<=_0n$c)throw new Error("invalid field: expected ORDER > 0, got "+t);let n;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(n=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));const{nBitLength:o,nByteLength:a}=nLength$2(t,n);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=a,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return mod$2(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return _0n$c<=t&&t<this.ORDER}is0(t){return t===_0n$c}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&_1n$c)===_1n$c}neg(t){return mod$2(-t,this.ORDER)}eql(t,r){return t===r}sqr(t){return mod$2(t*t,this.ORDER)}add(t,r){return mod$2(t+r,this.ORDER)}sub(t,r){return mod$2(t-r,this.ORDER)}mul(t,r){return mod$2(t*r,this.ORDER)}pow(t,r){return FpPow$2(this,t,r)}div(t,r){return mod$2(t*invert$2(r,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,r){return t+r}subN(t,r){return t-r}mulN(t,r){return t*r}inv(t){return invert$2(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=FpSqrt$2(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?numberToBytesLE$2(t,this.BYTES):numberToBytesBE$2(t,this.BYTES)}fromBytes(t,r=!1){abytes$1(t);const{_lengths:n,BYTES:o,isLE:a,ORDER:l,_mod:u}=this;if(n){if(!n.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+n+" bytes, got "+t.length);const x=new Uint8Array(o);x.set(t,a?0:x.length-t.length),t=x}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let f=a?bytesToNumberLE$2(t):bytesToNumberBE$2(t);if(u&&(f=mod$2(f,l)),!r&&!this.isValid(f))throw new Error("invalid field element: outside of range 0..ORDER");return f}invertBatch(t){return FpInvertBatch$2(this,t)}cmov(t,r,n){return n?r:t}}function Field$2(e,t={}){return new _Field(e,t)}function getFieldBytesLength$2(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength$2(e){const t=getFieldBytesLength$2(e);return t+Math.ceil(t/2)}function mapHashToField$2(e,t,r=!1){abytes$1(e);const n=e.length,o=getFieldBytesLength$2(t),a=getMinHashLength$2(t);if(n<16||n<a||n>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+n);const l=r?bytesToNumberLE$2(e):bytesToNumberBE$2(e),u=mod$2(l,t-_1n$c)+_1n$c;return r?numberToBytesLE$2(u,o):numberToBytesBE$2(u,o)}const _0n$b=BigInt(0),_1n$b=BigInt(1);function negateCt$1(e,t){const r=t.negate();return e?r:t}function normalizeZ$1(e,t){const r=FpInvertBatch$2(e.Fp,t.map(n=>n.Z));return t.map((n,o)=>e.fromAffine(n.toAffine(r[o])))}function validateW$1(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function calcWOpts$1(e,t){validateW$1(e,t);const r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,a=bitMask$2(e),l=BigInt(e);return{windows:r,windowSize:n,mask:a,maxNumber:o,shiftBy:l}}function calcOffsets$1(e,t,r){const{windowSize:n,mask:o,maxNumber:a,shiftBy:l}=r;let u=Number(e&o),f=e>>l;u>n&&(u-=a,f+=_1n$b);const x=t*n,p=x+Math.abs(u)-1,g=u===0,y=u<0,b=t%2!==0;return{nextN:f,offset:p,isZero:g,isNeg:y,isNegF:b,offsetF:x}}const pointPrecomputes$1=new WeakMap,pointWindowSizes$1=new WeakMap;function getW$1(e){return pointWindowSizes$1.get(e)||1}function assert0$1(e){if(e!==_0n$b)throw new Error("invalid wNAF")}let wNAF$2=class{BASE;ZERO;Fn;bits;constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let o=t;for(;r>_0n$b;)r&_1n$b&&(n=n.add(o)),o=o.double(),r>>=_1n$b;return n}precomputeWindow(t,r){const{windows:n,windowSize:o}=calcWOpts$1(r,this.bits),a=[];let l=t,u=l;for(let f=0;f<n;f++){u=l,a.push(u);for(let x=1;x<o;x++)u=u.add(l),a.push(u);l=u.double()}return a}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let o=this.ZERO,a=this.BASE;const l=calcWOpts$1(t,this.bits);for(let u=0;u<l.windows;u++){const{nextN:f,offset:x,isZero:p,isNeg:g,isNegF:y,offsetF:b}=calcOffsets$1(n,u,l);n=f,p?a=a.add(negateCt$1(y,r[b])):o=o.add(negateCt$1(g,r[x]))}return assert0$1(n),{p:o,f:a}}wNAFUnsafe(t,r,n,o=this.ZERO){const a=calcWOpts$1(t,this.bits);for(let l=0;l<a.windows&&n!==_0n$b;l++){const{nextN:u,offset:f,isZero:x,isNeg:p}=calcOffsets$1(n,l,a);if(n=u,!x){const g=r[f];o=o.add(p?g.negate():g)}}return assert0$1(n),o}getPrecomputes(t,r,n){let o=pointPrecomputes$1.get(r);return o||(o=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(o=n(o)),pointPrecomputes$1.set(r,o))),o}cached(t,r,n){const o=getW$1(t);return this.wNAF(o,this.getPrecomputes(o,t,n),r)}unsafe(t,r,n,o){const a=getW$1(t);return a===1?this._unsafeLadder(t,r,o):this.wNAFUnsafe(a,this.getPrecomputes(a,t,n),r,o)}createCache(t,r){validateW$1(r,this.bits),pointWindowSizes$1.set(t,r),pointPrecomputes$1.delete(t)}hasCache(t){return getW$1(t)!==1}};function mulEndoUnsafe$1(e,t,r,n){let o=t,a=e.ZERO,l=e.ZERO;for(;r>_0n$b||n>_0n$b;)r&_1n$b&&(a=a.add(o)),n&_1n$b&&(l=l.add(o)),o=o.double(),r>>=_1n$b,n>>=_1n$b;return{p1:a,p2:l}}function createField$1(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField$2(t),t}else return Field$2(e,{isLE:r})}function createCurveFields(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const f of["p","n","h"]){const x=t[f];if(!(typeof x=="bigint"&&x>_0n$b))throw new Error(`CURVE.${f} must be positive bigint`)}const o=createField$1(t.p,r.Fp,n),a=createField$1(t.n,r.Fn,n),u=["Gx","Gy","a","b"];for(const f of u)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:a}}function createKeygen(e,t){return function(n){const o=e(n);return{secretKey:o,publicKey:t(o)}}}class _HMAC{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(ahash$1(t),abytes$1(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?t.create().update(r).digest():r);for(let a=0;a<o.length;a++)o[a]^=54;this.iHash.update(o),this.oHash=t.create();for(let a=0;a<o.length;a++)o[a]^=106;this.oHash.update(o),clean$1(o)}update(t){return aexists$1(this),this.iHash.update(t),this}digestInto(t){aexists$1(this),abytes$1(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:n,finished:o,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=o,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac$4=(e,t,r)=>new _HMAC(e,t).update(r).digest();hmac$4.create=(e,t)=>new _HMAC(e,t);const divNearest$2=(e,t)=>(e+(e>=0?t:-t)/_2n$7)/t;function _splitEndoScalar$1(e,t,r){const[[n,o],[a,l]]=t,u=divNearest$2(l*e,r),f=divNearest$2(-o*e,r);let x=e-u*n-f*a,p=-u*o-f*l;const g=x<_0n$a,y=p<_0n$a;g&&(x=-x),y&&(p=-p);const b=bitMask$2(Math.ceil(bitLen$2(r)/2))+_1n$a;if(x<_0n$a||x>=b||p<_0n$a||p>=b)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:g,k1:x,k2neg:y,k2:p}}function validateSigFormat$1(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function validateSigOpts$1(e,t){const r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return abool(r.lowS,"lowS"),abool(r.prehash,"prehash"),r.format!==void 0&&validateSigFormat$1(r.format),r}let DERErr$1=class extends Error{constructor(t=""){super(t)}};const DER$2={Err:DERErr$1,_tlv:{encode:(e,t)=>{const{Err:r}=DER$2;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");const n=t.length/2,o=numberToHexUnpadded$2(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");const a=n>127?numberToHexUnpadded$2(o.length/2|128):"";return numberToHexUnpadded$2(e)+a+o+t},decode(e,t){const{Err:r}=DER$2;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const o=t[n++],a=!!(o&128);let l=0;if(!a)l=o;else{const f=o&127;if(!f)throw new r("tlv.decode(long): indefinite length not supported");if(f>4)throw new r("tlv.decode(long): byte length is too big");const x=t.subarray(n,n+f);if(x.length!==f)throw new r("tlv.decode: length bytes not complete");if(x[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const p of x)l=l<<8|p;if(n+=f,l<128)throw new r("tlv.decode(long): not minimal encoding")}const u=t.subarray(n,n+l);if(u.length!==l)throw new r("tlv.decode: wrong value length");return{v:u,l:t.subarray(n+l)}}},_int:{encode(e){const{Err:t}=DER$2;if(e<_0n$a)throw new t("integer: negative integers are not allowed");let r=numberToHexUnpadded$2(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=DER$2;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return bytesToNumberBE$2(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=DER$2,o=abytes$1(e,void 0,"signature"),{v:a,l}=n.decode(48,o);if(l.length)throw new t("invalid signature: left bytes after parsing");const{v:u,l:f}=n.decode(2,a),{v:x,l:p}=n.decode(2,f);if(p.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(u),s:r.decode(x)}},hexFromSig(e){const{_tlv:t,_int:r}=DER$2,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),a=n+o;return t.encode(48,a)}},_0n$a=BigInt(0),_1n$a=BigInt(1),_2n$7=BigInt(2),_3n$4=BigInt(3),_4n$3=BigInt(4);function weierstrass$3(e,t={}){const r=createCurveFields("weierstrass",e,t),{Fp:n,Fn:o}=r;let a=r.CURVE;const{h:l,n:u}=a;validateObject$1(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});const{endo:f}=t;if(f&&(!n.is0(a.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const x=getWLengths$1(n,o);function p(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function g(U,I,G){const{x:k,y:M}=I.toAffine(),q=n.toBytes(k);if(abool(G,"isCompressed"),G){p();const K=!n.isOdd(M);return concatBytes$4(pprefix$1(K),q)}else return concatBytes$4(Uint8Array.of(4),q,n.toBytes(M))}function y(U){abytes$1(U,void 0,"Point");const{publicKey:I,publicKeyUncompressed:G}=x,k=U.length,M=U[0],q=U.subarray(1);if(k===I&&(M===2||M===3)){const K=n.fromBytes(q);if(!n.isValid(K))throw new Error("bad point: is not on curve, wrong x");const H=v(K);let Q;try{Q=n.sqrt(H)}catch(J){const L=J instanceof Error?": "+J.message:"";throw new Error("bad point: is not on curve, sqrt error"+L)}p();const D=n.isOdd(Q);return(M&1)===1!==D&&(Q=n.neg(Q)),{x:K,y:Q}}else if(k===G&&M===4){const K=n.BYTES,H=n.fromBytes(q.subarray(0,K)),Q=n.fromBytes(q.subarray(K,K*2));if(!B(H,Q))throw new Error("bad point: is not on curve");return{x:H,y:Q}}else throw new Error(`bad point: got length ${k}, expected compressed=${I} or uncompressed=${G}`)}const b=t.toBytes||g,w=t.fromBytes||y;function v(U){const I=n.sqr(U),G=n.mul(I,U);return n.add(n.add(G,n.mul(U,a.a)),a.b)}function B(U,I){const G=n.sqr(I),k=v(U);return n.eql(G,k)}if(!B(a.Gx,a.Gy))throw new Error("bad curve params: generator point");const j=n.mul(n.pow(a.a,_3n$4),_4n$3),F=n.mul(n.sqr(a.b),BigInt(27));if(n.is0(n.add(j,F)))throw new Error("bad curve params: a or b");function C(U,I,G=!1){if(!n.isValid(I)||G&&n.is0(I))throw new Error(`bad point coordinate ${U}`);return I}function N(U){if(!(U instanceof $))throw new Error("Weierstrass Point expected")}function T(U){if(!f||!f.basises)throw new Error("no endo");return _splitEndoScalar$1(U,f.basises,o.ORDER)}const _=memoized$1((U,I)=>{const{X:G,Y:k,Z:M}=U;if(n.eql(M,n.ONE))return{x:G,y:k};const q=U.is0();I==null&&(I=q?n.ONE:n.inv(M));const K=n.mul(G,I),H=n.mul(k,I),Q=n.mul(M,I);if(q)return{x:n.ZERO,y:n.ZERO};if(!n.eql(Q,n.ONE))throw new Error("invZ was invalid");return{x:K,y:H}}),S=memoized$1(U=>{if(U.is0()){if(t.allowInfinityPoint&&!n.is0(U.Y))return;throw new Error("bad point: ZERO")}const{x:I,y:G}=U.toAffine();if(!n.isValid(I)||!n.isValid(G))throw new Error("bad point: x or y not field elements");if(!B(I,G))throw new Error("bad point: equation left != right");if(!U.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function O(U,I,G,k,M){return G=new $(n.mul(G.X,U),G.Y,G.Z),I=negateCt$1(k,I),G=negateCt$1(M,G),I.add(G)}class ${static BASE=new $(a.Gx,a.Gy,n.ONE);static ZERO=new $(n.ZERO,n.ONE,n.ZERO);static Fp=n;static Fn=o;X;Y;Z;constructor(I,G,k){this.X=C("x",I),this.Y=C("y",G,!0),this.Z=C("z",k),Object.freeze(this)}static CURVE(){return a}static fromAffine(I){const{x:G,y:k}=I||{};if(!I||!n.isValid(G)||!n.isValid(k))throw new Error("invalid affine point");if(I instanceof $)throw new Error("projective point not allowed");return n.is0(G)&&n.is0(k)?$.ZERO:new $(G,k,n.ONE)}static fromBytes(I){const G=$.fromAffine(w(abytes$1(I,void 0,"point")));return G.assertValidity(),G}static fromHex(I){return $.fromBytes(hexToBytes$6(I))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(I=8,G=!0){return W.createCache(this,I),G||this.multiply(_3n$4),this}assertValidity(){S(this)}hasEvenY(){const{y:I}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(I)}equals(I){N(I);const{X:G,Y:k,Z:M}=this,{X:q,Y:K,Z:H}=I,Q=n.eql(n.mul(G,H),n.mul(q,M)),D=n.eql(n.mul(k,H),n.mul(K,M));return Q&&D}negate(){return new $(this.X,n.neg(this.Y),this.Z)}double(){const{a:I,b:G}=a,k=n.mul(G,_3n$4),{X:M,Y:q,Z:K}=this;let H=n.ZERO,Q=n.ZERO,D=n.ZERO,Y=n.mul(M,M),J=n.mul(q,q),L=n.mul(K,K),Z=n.mul(M,q);return Z=n.add(Z,Z),D=n.mul(M,K),D=n.add(D,D),H=n.mul(I,D),Q=n.mul(k,L),Q=n.add(H,Q),H=n.sub(J,Q),Q=n.add(J,Q),Q=n.mul(H,Q),H=n.mul(Z,H),D=n.mul(k,D),L=n.mul(I,L),Z=n.sub(Y,L),Z=n.mul(I,Z),Z=n.add(Z,D),D=n.add(Y,Y),Y=n.add(D,Y),Y=n.add(Y,L),Y=n.mul(Y,Z),Q=n.add(Q,Y),L=n.mul(q,K),L=n.add(L,L),Y=n.mul(L,Z),H=n.sub(H,Y),D=n.mul(L,J),D=n.add(D,D),D=n.add(D,D),new $(H,Q,D)}add(I){N(I);const{X:G,Y:k,Z:M}=this,{X:q,Y:K,Z:H}=I;let Q=n.ZERO,D=n.ZERO,Y=n.ZERO;const J=a.a,L=n.mul(a.b,_3n$4);let Z=n.mul(G,q),oe=n.mul(k,K),ce=n.mul(M,H),de=n.add(G,k),xe=n.add(q,K);de=n.mul(de,xe),xe=n.add(Z,oe),de=n.sub(de,xe),xe=n.add(G,M);let te=n.add(q,H);return xe=n.mul(xe,te),te=n.add(Z,ce),xe=n.sub(xe,te),te=n.add(k,M),Q=n.add(K,H),te=n.mul(te,Q),Q=n.add(oe,ce),te=n.sub(te,Q),Y=n.mul(J,xe),Q=n.mul(L,ce),Y=n.add(Q,Y),Q=n.sub(oe,Y),Y=n.add(oe,Y),D=n.mul(Q,Y),oe=n.add(Z,Z),oe=n.add(oe,Z),ce=n.mul(J,ce),xe=n.mul(L,xe),oe=n.add(oe,ce),ce=n.sub(Z,ce),ce=n.mul(J,ce),xe=n.add(xe,ce),Z=n.mul(oe,xe),D=n.add(D,Z),Z=n.mul(te,xe),Q=n.mul(de,Q),Q=n.sub(Q,Z),Z=n.mul(de,oe),Y=n.mul(te,Y),Y=n.add(Y,Z),new $(Q,D,Y)}subtract(I){return this.add(I.negate())}is0(){return this.equals($.ZERO)}multiply(I){const{endo:G}=t;if(!o.isValidNot0(I))throw new Error("invalid scalar: out of range");let k,M;const q=K=>W.cached(this,K,H=>normalizeZ$1($,H));if(G){const{k1neg:K,k1:H,k2neg:Q,k2:D}=T(I),{p:Y,f:J}=q(H),{p:L,f:Z}=q(D);M=J.add(Z),k=O(G.beta,Y,L,K,Q)}else{const{p:K,f:H}=q(I);k=K,M=H}return normalizeZ$1($,[k,M])[0]}multiplyUnsafe(I){const{endo:G}=t,k=this;if(!o.isValid(I))throw new Error("invalid scalar: out of range");if(I===_0n$a||k.is0())return $.ZERO;if(I===_1n$a)return k;if(W.hasCache(this))return this.multiply(I);if(G){const{k1neg:M,k1:q,k2neg:K,k2:H}=T(I),{p1:Q,p2:D}=mulEndoUnsafe$1($,k,q,H);return O(G.beta,Q,D,M,K)}else return W.unsafe(k,I)}toAffine(I){return _(this,I)}isTorsionFree(){const{isTorsionFree:I}=t;return l===_1n$a?!0:I?I($,this):W.unsafe(this,u).is0()}clearCofactor(){const{clearCofactor:I}=t;return l===_1n$a?this:I?I($,this):this.multiplyUnsafe(l)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}toBytes(I=!0){return abool(I,"isCompressed"),this.assertValidity(),b($,this,I)}toHex(I=!0){return bytesToHex$4(this.toBytes(I))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const z=o.BITS,W=new wNAF$2($,t.endo?Math.ceil(z/2):z);return $.BASE.precompute(8),$}function pprefix$1(e){return Uint8Array.of(e?2:3)}function getWLengths$1(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function ecdh$1(e,t={}){const{Fn:r}=e,n=t.randomBytes||randomBytes$3,o=Object.assign(getWLengths$1(e.Fp,r),{seed:getMinHashLength$2(r.ORDER)});function a(b){try{const w=r.fromBytes(b);return r.isValidNot0(w)}catch{return!1}}function l(b,w){const{publicKey:v,publicKeyUncompressed:B}=o;try{const j=b.length;return w===!0&&j!==v||w===!1&&j!==B?!1:!!e.fromBytes(b)}catch{return!1}}function u(b=n(o.seed)){return mapHashToField$2(abytes$1(b,o.seed,"seed"),r.ORDER)}function f(b,w=!0){return e.BASE.multiply(r.fromBytes(b)).toBytes(w)}function x(b){const{secretKey:w,publicKey:v,publicKeyUncompressed:B}=o;if(!isBytes$3(b)||"_lengths"in r&&r._lengths||w===v)return;const j=abytes$1(b,void 0,"key").length;return j===v||j===B}function p(b,w,v=!0){if(x(b)===!0)throw new Error("first arg must be private key");if(x(w)===!1)throw new Error("second arg must be public key");const B=r.fromBytes(b);return e.fromBytes(w).multiply(B).toBytes(v)}const g={isValidSecretKey:a,isValidPublicKey:l,randomSecretKey:u},y=createKeygen(u,f);return Object.freeze({getPublicKey:f,getSharedSecret:p,keygen:y,Point:e,utils:g,lengths:o})}function ecdsa$1(e,t,r={}){ahash$1(t),validateObject$1(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);const n=r.randomBytes||randomBytes$3,o=r.hmac||((G,k)=>hmac$4(t,G,k)),{Fp:a,Fn:l}=e,{ORDER:u,BITS:f}=l,{keygen:x,getPublicKey:p,getSharedSecret:g,utils:y,lengths:b}=ecdh$1(e,r),w={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},v=u*_2n$7<a.ORDER;function B(G){const k=u>>_1n$a;return G>k}function j(G,k){if(!l.isValidNot0(k))throw new Error(`invalid signature ${G}: out of range 1..Point.Fn.ORDER`);return k}function F(){if(v)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function C(G,k){validateSigFormat$1(k);const M=b.signature,q=k==="compact"?M:k==="recovered"?M+1:void 0;return abytes$1(G,q)}class N{r;s;recovery;constructor(k,M,q){if(this.r=j("r",k),this.s=j("s",M),q!=null){if(F(),![0,1,2,3].includes(q))throw new Error("invalid recovery id");this.recovery=q}Object.freeze(this)}static fromBytes(k,M=w.format){C(k,M);let q;if(M==="der"){const{r:D,s:Y}=DER$2.toSig(abytes$1(k));return new N(D,Y)}M==="recovered"&&(q=k[0],M="compact",k=k.subarray(1));const K=b.signature/2,H=k.subarray(0,K),Q=k.subarray(K,K*2);return new N(l.fromBytes(H),l.fromBytes(Q),q)}static fromHex(k,M){return this.fromBytes(hexToBytes$6(k),M)}assertRecovery(){const{recovery:k}=this;if(k==null)throw new Error("invalid recovery id: must be present");return k}addRecoveryBit(k){return new N(this.r,this.s,k)}recoverPublicKey(k){const{r:M,s:q}=this,K=this.assertRecovery(),H=K===2||K===3?M+u:M;if(!a.isValid(H))throw new Error("invalid recovery id: sig.r+curve.n != R.x");const Q=a.toBytes(H),D=e.fromBytes(concatBytes$4(pprefix$1((K&1)===0),Q)),Y=l.inv(H),J=_(abytes$1(k,void 0,"msgHash")),L=l.create(-J*Y),Z=l.create(q*Y),oe=e.BASE.multiplyUnsafe(L).add(D.multiplyUnsafe(Z));if(oe.is0())throw new Error("invalid recovery: point at infinify");return oe.assertValidity(),oe}hasHighS(){return B(this.s)}toBytes(k=w.format){if(validateSigFormat$1(k),k==="der")return hexToBytes$6(DER$2.hexFromSig(this));const{r:M,s:q}=this,K=l.toBytes(M),H=l.toBytes(q);return k==="recovered"?(F(),concatBytes$4(Uint8Array.of(this.assertRecovery()),K,H)):concatBytes$4(K,H)}toHex(k){return bytesToHex$4(this.toBytes(k))}}const T=r.bits2int||function(k){if(k.length>8192)throw new Error("input is too large");const M=bytesToNumberBE$2(k),q=k.length*8-f;return q>0?M>>BigInt(q):M},_=r.bits2int_modN||function(k){return l.create(T(k))},S=bitMask$2(f);function O(G){return aInRange$1("num < 2^"+f,G,_0n$a,S),l.toBytes(G)}function $(G,k){return abytes$1(G,void 0,"message"),k?abytes$1(t(G),void 0,"prehashed message"):G}function z(G,k,M){const{lowS:q,prehash:K,extraEntropy:H}=validateSigOpts$1(M,w);G=$(G,K);const Q=_(G),D=l.fromBytes(k);if(!l.isValidNot0(D))throw new Error("invalid private key");const Y=[O(D),O(Q)];if(H!=null&&H!==!1){const oe=H===!0?n(b.secretKey):H;Y.push(abytes$1(oe,void 0,"extraEntropy"))}const J=concatBytes$4(...Y),L=Q;function Z(oe){const ce=T(oe);if(!l.isValidNot0(ce))return;const de=l.inv(ce),xe=e.BASE.multiply(ce).toAffine(),te=l.create(xe.x);if(te===_0n$a)return;const ae=l.create(de*l.create(L+te*D));if(ae===_0n$a)return;let le=(xe.x===te?0:2)|Number(xe.y&_1n$a),ue=ae;return q&&B(ae)&&(ue=l.neg(ae),le^=1),new N(te,ue,v?void 0:le)}return{seed:J,k2sig:Z}}function W(G,k,M={}){const{seed:q,k2sig:K}=z(G,k,M);return createHmacDrbg$2(t.outputLen,l.BYTES,o)(q,K).toBytes(M.format)}function U(G,k,M,q={}){const{lowS:K,prehash:H,format:Q}=validateSigOpts$1(q,w);if(M=abytes$1(M,void 0,"publicKey"),k=$(k,H),!isBytes$3(G)){const D=G instanceof N?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+D)}C(G,Q);try{const D=N.fromBytes(G,Q),Y=e.fromBytes(M);if(K&&D.hasHighS())return!1;const{r:J,s:L}=D,Z=_(k),oe=l.inv(L),ce=l.create(Z*oe),de=l.create(J*oe),xe=e.BASE.multiplyUnsafe(ce).add(Y.multiplyUnsafe(de));return xe.is0()?!1:l.create(xe.x)===J}catch{return!1}}function I(G,k,M={}){const{prehash:q}=validateSigOpts$1(M,w);return k=$(k,q),N.fromBytes(G,"recovered").recoverPublicKey(k).toBytes()}return Object.freeze({keygen:x,getPublicKey:p,getSharedSecret:g,utils:y,lengths:b,Point:e,sign:W,verify:U,recoverPublicKey:I,Signature:N,hash:t})}const secp256k1_CURVE$1={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO$1={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_2n$6=BigInt(2);function sqrtMod$2(e){const t=secp256k1_CURVE$1.p,r=BigInt(3),n=BigInt(6),o=BigInt(11),a=BigInt(22),l=BigInt(23),u=BigInt(44),f=BigInt(88),x=e*e*e%t,p=x*x*e%t,g=pow2$2(p,r,t)*p%t,y=pow2$2(g,r,t)*p%t,b=pow2$2(y,_2n$6,t)*x%t,w=pow2$2(b,o,t)*b%t,v=pow2$2(w,a,t)*w%t,B=pow2$2(v,u,t)*v%t,j=pow2$2(B,f,t)*B%t,F=pow2$2(j,u,t)*v%t,C=pow2$2(F,r,t)*p%t,N=pow2$2(C,l,t)*w%t,T=pow2$2(N,n,t)*x%t,_=pow2$2(T,_2n$6,t);if(!Fpk1$1.eql(Fpk1$1.sqr(_),e))throw new Error("Cannot find square root");return _}const Fpk1$1=Field$2(secp256k1_CURVE$1.p,{sqrt:sqrtMod$2}),Pointk1$1=weierstrass$3(secp256k1_CURVE$1,{Fp:Fpk1$1,endo:secp256k1_ENDO$1}),secp256k1$3=ecdsa$1(Pointk1$1,sha256$5),Rho160$1=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Id160$1=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),Pi160$1=Id160$1.map(e=>(9*e+5)%16),idxLR$1=(()=>{const r=[[Id160$1],[Pi160$1]];for(let n=0;n<4;n++)for(let o of r)o.push(o[n].map(a=>Rho160$1[a]));return r})(),idxL$1=idxLR$1[0],idxR$1=idxLR$1[1],shifts160$1=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),shiftsL160$1=idxL$1.map((e,t)=>e.map(r=>shifts160$1[t][r])),shiftsR160$1=idxR$1.map((e,t)=>e.map(r=>shifts160$1[t][r])),Kl160$1=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Kr160$1=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ripemd_f$1(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}const BUF_160$1=new Uint32Array(16);class _RIPEMD160 extends HashMD$1{h0=1732584193;h1=-271733879;h2=-1732584194;h3=271733878;h4=-1009589776;constructor(){super(64,20,8,!0)}get(){const{h0:t,h1:r,h2:n,h3:o,h4:a}=this;return[t,r,n,o,a]}set(t,r,n,o,a){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=o|0,this.h4=a|0}process(t,r){for(let b=0;b<16;b++,r+=4)BUF_160$1[b]=t.getUint32(r,!0);let n=this.h0|0,o=n,a=this.h1|0,l=a,u=this.h2|0,f=u,x=this.h3|0,p=x,g=this.h4|0,y=g;for(let b=0;b<5;b++){const w=4-b,v=Kl160$1[b],B=Kr160$1[b],j=idxL$1[b],F=idxR$1[b],C=shiftsL160$1[b],N=shiftsR160$1[b];for(let T=0;T<16;T++){const _=rotl$3(n+ripemd_f$1(b,a,u,x)+BUF_160$1[j[T]]+v,C[T])+g|0;n=g,g=x,x=rotl$3(u,10)|0,u=a,a=_}for(let T=0;T<16;T++){const _=rotl$3(o+ripemd_f$1(w,l,f,p)+BUF_160$1[F[T]]+B,N[T])+y|0;o=y,y=p,p=rotl$3(f,10)|0,f=l,l=_}}this.set(this.h1+u+p|0,this.h2+x+y|0,this.h3+g+o|0,this.h4+n+l|0,this.h0+a+f|0)}roundClean(){clean$1(BUF_160$1)}destroy(){this.destroyed=!0,clean$1(this.buffer),this.set(0,0,0,0,0)}}const ripemd160$2=createHasher$1(()=>new _RIPEMD160);function isBytes$2(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function isArrayOf(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(r=>typeof r=="string"):t.every(r=>Number.isSafeInteger(r)):!1}function afn(e){if(typeof e!="function")throw new Error("function expected");return!0}function astr(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function anumber$1(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function aArr(e){if(!Array.isArray(e))throw new Error("array expected")}function astrArr(e,t){if(!isArrayOf(!0,t))throw new Error(`${e}: array of strings expected`)}function anumArr(e,t){if(!isArrayOf(!1,t))throw new Error(`${e}: array of numbers expected`)}function chain$1(...e){const t=a=>a,r=(a,l)=>u=>a(l(u)),n=e.map(a=>a.encode).reduceRight(r,t),o=e.map(a=>a.decode).reduce(r,t);return{encode:n,decode:o}}function alphabet$1(e){const t=typeof e=="string"?e.split(""):e,r=t.length;astrArr("alphabet",t);const n=new Map(t.map((o,a)=>[o,a]));return{encode:o=>(aArr(o),o.map(a=>{if(!Number.isSafeInteger(a)||a<0||a>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${a}". Allowed: ${e}`);return t[a]})),decode:o=>(aArr(o),o.map(a=>{astr("alphabet.decode",a);const l=n.get(a);if(l===void 0)throw new Error(`Unknown letter: "${a}". Allowed: ${e}`);return l}))}}function join$1(e=""){return astr("join",e),{encode:t=>(astrArr("join.decode",t),t.join(e)),decode:t=>(astr("join.decode",t),t.split(e))}}function convertRadix$1(e,t,r){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: invalid to=${r}, base cannot be less than 2`);if(aArr(e),!e.length)return[];let n=0;const o=[],a=Array.from(e,u=>{if(anumber$1(u),u<0||u>=t)throw new Error(`invalid integer: ${u}`);return u}),l=a.length;for(;;){let u=0,f=!0;for(let x=n;x<l;x++){const p=a[x],g=t*u,y=g+p;if(!Number.isSafeInteger(y)||g/t!==u||y-p!==g)throw new Error("convertRadix: carry overflow");const b=y/r;u=y%r;const w=Math.floor(b);if(a[x]=w,!Number.isSafeInteger(w)||w*r+u!==y)throw new Error("convertRadix: carry overflow");if(f)w?f=!1:n=x;else continue}if(o.push(u),f)break}for(let u=0;u<e.length-1&&e[u]===0;u++)o.push(0);return o.reverse()}function radix$1(e){anumber$1(e);const t=2**8;return{encode:r=>{if(!isBytes$2(r))throw new Error("radix.encode input should be Uint8Array");return convertRadix$1(Array.from(r),t,e)},decode:r=>(anumArr("radix.decode",r),Uint8Array.from(convertRadix$1(r,e,t)))}}function checksum(e,t){return anumber$1(e),afn(t),{encode(r){if(!isBytes$2(r))throw new Error("checksum.encode: input should be Uint8Array");const n=t(r).slice(0,e),o=new Uint8Array(r.length+e);return o.set(r),o.set(n,r.length),o},decode(r){if(!isBytes$2(r))throw new Error("checksum.decode: input should be Uint8Array");const n=r.slice(0,-e),o=r.slice(-e),a=t(n).slice(0,e);for(let l=0;l<e;l++)if(a[l]!==o[l])throw new Error("Invalid checksum");return n}}}const genBase58$1=e=>chain$1(radix$1(58),alphabet$1(e),join$1("")),base58$2=genBase58$1("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),createBase58check=e=>chain$1(checksum(4,t=>e(e(t))),base58$2);const Point$1=secp256k1$3.Point,{Fn}=Point$1,base58check=createBase58check(sha256$5),MASTER_SECRET=Uint8Array.from("Bitcoin seed".split(""),e=>e.charCodeAt(0)),BITCOIN_VERSIONS={private:76066276,public:76067358},HARDENED_OFFSET=2147483648,hash160$1=e=>ripemd160$2(sha256$5(e)),fromU32=e=>createView$4(e).getUint32(0,!1),toU32=e=>{if(!Number.isSafeInteger(e)||e<0||e>2**32-1)throw new Error("invalid number, should be from 0 to 2**32-1, got "+e);const t=new Uint8Array(4);return createView$4(t).setUint32(0,e,!1),t};class HDKey{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return fromU32(this.pubHash)}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this._privateKey||null}get publicKey(){return this._publicKey||null}get privateExtendedKey(){const t=this._privateKey;if(!t)throw new Error("No private key");return base58check.encode(this.serialize(this.versions.private,concatBytes$4(Uint8Array.of(0),t)))}get publicExtendedKey(){if(!this._publicKey)throw new Error("No public key");return base58check.encode(this.serialize(this.versions.public,this._publicKey))}static fromMasterSeed(t,r=BITCOIN_VERSIONS){if(abytes$1(t),8*t.length<128||8*t.length>512)throw new Error("HDKey: seed length must be between 128 and 512 bits; 256 bits is advised, got "+t.length);const n=hmac$4(sha512$1,MASTER_SECRET,t),o=n.slice(0,32),a=n.slice(32);return new HDKey({versions:r,chainCode:a,privateKey:o})}static fromExtendedKey(t,r=BITCOIN_VERSIONS){const n=base58check.decode(t),o=createView$4(n),a=o.getUint32(0,!1),l={versions:r,depth:n[4],parentFingerprint:o.getUint32(5,!1),index:o.getUint32(9,!1),chainCode:n.slice(13,45)},u=n.slice(45),f=u[0]===0;if(a!==r[f?"private":"public"])throw new Error("Version mismatch");return f?new HDKey({...l,privateKey:u.slice(1)}):new HDKey({...l,publicKey:u})}static fromJSON(t){return HDKey.fromExtendedKey(t.xpriv)}versions;depth=0;index=0;chainCode=null;parentFingerprint=0;_privateKey;_publicKey;pubHash;constructor(t){if(!t||typeof t!="object")throw new Error("HDKey.constructor must not be called directly");if(this.versions=t.versions||BITCOIN_VERSIONS,this.depth=t.depth||0,this.chainCode=t.chainCode||null,this.index=t.index||0,this.parentFingerprint=t.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(this.depth>255)throw new Error("HDKey: depth exceeds the serializable value 255");if(t.publicKey&&t.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(t.privateKey){if(!secp256k1$3.utils.isValidSecretKey(t.privateKey))throw new Error("Invalid private key");this._privateKey=t.privateKey,this._publicKey=secp256k1$3.getPublicKey(t.privateKey,!0)}else if(t.publicKey)this._publicKey=Point$1.fromBytes(t.publicKey).toBytes(!0);else throw new Error("HDKey: no public or private key provided");this.pubHash=hash160$1(this._publicKey)}derive(t){if(!/^[mM]'?/.test(t))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(t))return this;const r=t.replace(/^[mM]'?\//,"").split("/");let n=this;for(const o of r){const a=/^(\d+)('?)$/.exec(o),l=a&&a[1];if(!a||a.length!==3||typeof l!="string")throw new Error("invalid child index: "+o);let u=+l;if(!Number.isSafeInteger(u)||u>=HARDENED_OFFSET)throw new Error("Invalid index");a[2]==="'"&&(u+=HARDENED_OFFSET),n=n.deriveChild(u)}return n}deriveChild(t){if(!this._publicKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let r=toU32(t);if(t>=HARDENED_OFFSET){const f=this._privateKey;if(!f)throw new Error("Could not derive hardened child key");r=concatBytes$4(Uint8Array.of(0),f,r)}else r=concatBytes$4(this._publicKey,r);const n=hmac$4(sha512$1,this.chainCode,r),o=n.slice(0,32),a=n.slice(32);if(!secp256k1$3.utils.isValidSecretKey(o))throw new Error("Tweak bigger than curve order");const l={versions:this.versions,chainCode:a,depth:this.depth+1,parentFingerprint:this.fingerprint,index:t},u=Fn.fromBytes(o);try{if(this._privateKey){const f=Fn.create(Fn.fromBytes(this._privateKey)+u);if(!Fn.isValidNot0(f))throw new Error("The tweak was out of range or the resulted private key is invalid");l.privateKey=Fn.toBytes(f)}else{const f=Point$1.fromBytes(this._publicKey).add(Point$1.BASE.multiply(u));if(f.equals(Point$1.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");l.publicKey=f.toBytes(!0)}return new HDKey(l)}catch{return this.deriveChild(t+1)}}sign(t){if(!this._privateKey)throw new Error("No privateKey set!");return abytes$1(t,32),secp256k1$3.sign(t,this._privateKey,{prehash:!1})}verify(t,r){if(abytes$1(t,32),abytes$1(r,64),!this._publicKey)throw new Error("No publicKey set!");return secp256k1$3.verify(r,t,this._publicKey,{prehash:!1})}wipePrivateData(){return this._privateKey&&(this._privateKey.fill(0),this._privateKey=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(t,r){if(!this.chainCode)throw new Error("No chainCode set");return abytes$1(r,33),concatBytes$4(toU32(t),new Uint8Array([this.depth]),toU32(this.parentFingerprint),toU32(this.index),this.chainCode,r)}}function number$4(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bytes$2(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$2(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$4(e.outputLen),number$4(e.blockLen)}function exists$2(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$2(e,t){bytes$2(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const crypto$5=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const u8a$2=e=>e instanceof Uint8Array,createView$3=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$2=(e,t)=>e<<32-t|e>>>t,isLE$2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$2)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$4(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$3(e){if(typeof e=="string"&&(e=utf8ToBytes$4(e)),!u8a$2(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function concatBytes$3(...e){const t=new Uint8Array(e.reduce((n,o)=>n+o.length,0));let r=0;return e.forEach(n=>{if(!u8a$2(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}let Hash$2=class{clone(){return this._cloneInto()}};function wrapConstructor$1(e){const t=n=>e().update(toBytes$3(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function randomBytes$2(e=32){if(crypto$5&&typeof crypto$5.getRandomValues=="function")return crypto$5.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$3(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const o=BigInt(32),a=BigInt(4294967295),l=Number(r>>o&a),u=Number(r&a),f=n?4:0,x=n?0:4;e.setUint32(t+f,l,n),e.setUint32(t+x,u,n)}let SHA2$1=class extends Hash$2{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=createView$3(this.buffer)}update(t){exists$2(this);const{view:r,buffer:n,blockLen:o}=this;t=toBytes$3(t);const a=t.length;for(let l=0;l<a;){const u=Math.min(o-this.pos,a-l);if(u===o){const f=createView$3(t);for(;o<=a-l;l+=o)this.process(f,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){exists$2(this),output$2(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:a}=this;let{pos:l}=this;r[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>o-l&&(this.process(n,0),l=0);for(let g=l;g<o;g++)r[g]=0;setBigUint64$3(n,o-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$3(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const x=f/4,p=this.get();if(x>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<x;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:a,destroyed:l,pos:u}=this;return t.length=o,t.pos=u,t.finished=a,t.destroyed=l,o%r&&t.buffer.set(n),t}};const Chi$2=(e,t,r)=>e&t^~e&r,Maj$2=(e,t,r)=>e&t^e&r^t&r,SHA256_K$2=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$2=new Uint32Array(64);let SHA256$2=class extends SHA2$1{constructor(){super(64,32,8,!1),this.A=IV$1[0]|0,this.B=IV$1[1]|0,this.C=IV$1[2]|0,this.D=IV$1[3]|0,this.E=IV$1[4]|0,this.F=IV$1[5]|0,this.G=IV$1[6]|0,this.H=IV$1[7]|0}get(){const{A:t,B:r,C:n,D:o,E:a,F:l,G:u,H:f}=this;return[t,r,n,o,a,l,u,f]}set(t,r,n,o,a,l,u,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=f|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W$2[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W$2[g-15],b=SHA256_W$2[g-2],w=rotr$2(y,7)^rotr$2(y,18)^y>>>3,v=rotr$2(b,17)^rotr$2(b,19)^b>>>10;SHA256_W$2[g]=v+SHA256_W$2[g-7]+w+SHA256_W$2[g-16]|0}let{A:n,B:o,C:a,D:l,E:u,F:f,G:x,H:p}=this;for(let g=0;g<64;g++){const y=rotr$2(u,6)^rotr$2(u,11)^rotr$2(u,25),b=p+y+Chi$2(u,f,x)+SHA256_K$2[g]+SHA256_W$2[g]|0,v=(rotr$2(n,2)^rotr$2(n,13)^rotr$2(n,22))+Maj$2(n,o,a)|0;p=x,x=f,f=u,u=l+b|0,l=a,a=o,o=n,n=b+v|0}n=n+this.A|0,o=o+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,f=f+this.F|0,x=x+this.G|0,p=p+this.H|0,this.set(n,o,a,l,u,f,x,p)}roundClean(){SHA256_W$2.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$4=wrapConstructor$1(()=>new SHA256$2);const _0n$9=BigInt(0),_1n$9=BigInt(1),_2n$5=BigInt(2),u8a$1=e=>e instanceof Uint8Array,hexes$3=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$3(e){if(!u8a$1(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=hexes$3[e[r]];return t}function numberToHexUnpadded$1(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function hexToNumber$1(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function hexToBytes$5(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){const o=n*2,a=e.slice(o,o+2),l=Number.parseInt(a,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");r[n]=l}return r}function bytesToNumberBE$1(e){return hexToNumber$1(bytesToHex$3(e))}function bytesToNumberLE$1(e){if(!u8a$1(e))throw new Error("Uint8Array expected");return hexToNumber$1(bytesToHex$3(Uint8Array.from(e).reverse()))}function numberToBytesBE$1(e,t){return hexToBytes$5(e.toString(16).padStart(t*2,"0"))}function numberToBytesLE$1(e,t){return numberToBytesBE$1(e,t).reverse()}function numberToVarBytesBE(e){return hexToBytes$5(numberToHexUnpadded$1(e))}function ensureBytes$1(e,t,r){let n;if(typeof t=="string")try{n=hexToBytes$5(t)}catch(a){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${a}`)}else if(u8a$1(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);const o=n.length;if(typeof r=="number"&&o!==r)throw new Error(`${e} expected ${r} bytes, got ${o}`);return n}function concatBytes$2(...e){const t=new Uint8Array(e.reduce((n,o)=>n+o.length,0));let r=0;return e.forEach(n=>{if(!u8a$1(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}function equalBytes$1(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function utf8ToBytes$3(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function bitLen$1(e){let t;for(t=0;e>_0n$9;e>>=_1n$9,t+=1);return t}function bitGet(e,t){return e>>BigInt(t)&_1n$9}const bitSet=(e,t,r)=>e|(r?_1n$9:_0n$9)<<BigInt(t),bitMask$1=e=>(_2n$5<<BigInt(e-1))-_1n$9,u8n=e=>new Uint8Array(e),u8fr=e=>Uint8Array.from(e);function createHmacDrbg$1(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=u8n(e),o=u8n(e),a=0;const l=()=>{n.fill(1),o.fill(0),a=0},u=(...g)=>r(o,n,...g),f=(g=u8n())=>{o=u(u8fr([0]),g),n=u(),g.length!==0&&(o=u(u8fr([1]),g),n=u())},x=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let g=0;const y=[];for(;g<t;){n=u();const b=n.slice();y.push(b),g+=n.length}return concatBytes$2(...y)};return(g,y)=>{l(),f(g);let b;for(;!(b=y(x()));)f();return l(),b}}const validatorFns={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function validateObject(e,t,r={}){const n=(o,a,l)=>{const u=validatorFns[a];if(typeof u!="function")throw new Error(`Invalid validator "${a}", expected function`);const f=e[o];if(!(l&&f===void 0)&&!u(f,e))throw new Error(`Invalid param ${String(o)}=${f} (${typeof f}), expected ${a}`)};for(const[o,a]of Object.entries(t))n(o,a,!1);for(const[o,a]of Object.entries(r))n(o,a,!0);return e}const ut=Object.freeze(Object.defineProperty({__proto__:null,bitGet,bitLen:bitLen$1,bitMask:bitMask$1,bitSet,bytesToHex:bytesToHex$3,bytesToNumberBE:bytesToNumberBE$1,bytesToNumberLE:bytesToNumberLE$1,concatBytes:concatBytes$2,createHmacDrbg:createHmacDrbg$1,ensureBytes:ensureBytes$1,equalBytes:equalBytes$1,hexToBytes:hexToBytes$5,hexToNumber:hexToNumber$1,numberToBytesBE:numberToBytesBE$1,numberToBytesLE:numberToBytesLE$1,numberToHexUnpadded:numberToHexUnpadded$1,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$3,validateObject},Symbol.toStringTag,{value:"Module"}));const _0n$8=BigInt(0),_1n$8=BigInt(1),_2n$4=BigInt(2),_3n$3=BigInt(3),_4n$2=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);BigInt(9);BigInt(16);function mod$1(e,t){const r=e%t;return r>=_0n$8?r:t+r}function pow$1(e,t,r){if(r<=_0n$8||t<_0n$8)throw new Error("Expected power/modulo > 0");if(r===_1n$8)return _0n$8;let n=_1n$8;for(;t>_0n$8;)t&_1n$8&&(n=n*e%r),e=e*e%r,t>>=_1n$8;return n}function pow2$1(e,t,r){let n=e;for(;t-- >_0n$8;)n*=n,n%=r;return n}function invert$1(e,t){if(e===_0n$8||t<=_0n$8)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=mod$1(e,t),n=t,o=_0n$8,a=_1n$8;for(;r!==_0n$8;){const u=n/r,f=n%r,x=o-a*u;n=r,r=f,o=a,a=x}if(n!==_1n$8)throw new Error("invert: does not exist");return mod$1(o,t)}function tonelliShanks$1(e){const t=(e-_1n$8)/_2n$4;let r,n,o;for(r=e-_1n$8,n=0;r%_2n$4===_0n$8;r/=_2n$4,n++);for(o=_2n$4;o<e&&pow$1(o,t,e)!==e-_1n$8;o++);if(n===1){const l=(e+_1n$8)/_4n$2;return function(f,x){const p=f.pow(x,l);if(!f.eql(f.sqr(p),x))throw new Error("Cannot find square root");return p}}const a=(r+_1n$8)/_2n$4;return function(u,f){if(u.pow(f,t)===u.neg(u.ONE))throw new Error("Cannot find square root");let x=n,p=u.pow(u.mul(u.ONE,o),r),g=u.pow(f,a),y=u.pow(f,r);for(;!u.eql(y,u.ONE);){if(u.eql(y,u.ZERO))return u.ZERO;let b=1;for(let v=u.sqr(y);b<x&&!u.eql(v,u.ONE);b++)v=u.sqr(v);const w=u.pow(p,_1n$8<<BigInt(x-b-1));p=u.sqr(w),g=u.mul(g,w),y=u.mul(y,p),x=b}return g}}function FpSqrt$1(e){if(e%_4n$2===_3n$3){const t=(e+_1n$8)/_4n$2;return function(n,o){const a=n.pow(o,t);if(!n.eql(n.sqr(a),o))throw new Error("Cannot find square root");return a}}if(e%_8n$1===_5n$1){const t=(e-_5n$1)/_8n$1;return function(n,o){const a=n.mul(o,_2n$4),l=n.pow(a,t),u=n.mul(o,l),f=n.mul(n.mul(u,_2n$4),l),x=n.mul(u,n.sub(f,n.ONE));if(!n.eql(n.sqr(x),o))throw new Error("Cannot find square root");return x}}return tonelliShanks$1(e)}const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=FIELD_FIELDS$1.reduce((n,o)=>(n[o]="function",n),t);return validateObject(e,r)}function FpPow$1(e,t,r){if(r<_0n$8)throw new Error("Expected power > 0");if(r===_0n$8)return e.ONE;if(r===_1n$8)return t;let n=e.ONE,o=t;for(;r>_0n$8;)r&_1n$8&&(n=e.mul(n,o)),o=e.sqr(o),r>>=_1n$8;return n}function FpInvertBatch$1(e,t){const r=new Array(t.length),n=t.reduce((a,l,u)=>e.is0(l)?a:(r[u]=a,e.mul(a,l)),e.ONE),o=e.inv(n);return t.reduceRight((a,l,u)=>e.is0(l)?a:(r[u]=e.mul(a,r[u]),e.mul(a,l)),o),r}function nLength$1(e,t){const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Field$1(e,t,r=!1,n={}){if(e<=_0n$8)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:a}=nLength$1(e,t);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const l=FpSqrt$1(e),u=Object.freeze({ORDER:e,BITS:o,BYTES:a,MASK:bitMask$1(o),ZERO:_0n$8,ONE:_1n$8,create:f=>mod$1(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return _0n$8<=f&&f<e},is0:f=>f===_0n$8,isOdd:f=>(f&_1n$8)===_1n$8,neg:f=>mod$1(-f,e),eql:(f,x)=>f===x,sqr:f=>mod$1(f*f,e),add:(f,x)=>mod$1(f+x,e),sub:(f,x)=>mod$1(f-x,e),mul:(f,x)=>mod$1(f*x,e),pow:(f,x)=>FpPow$1(u,f,x),div:(f,x)=>mod$1(f*invert$1(x,e),e),sqrN:f=>f*f,addN:(f,x)=>f+x,subN:(f,x)=>f-x,mulN:(f,x)=>f*x,inv:f=>invert$1(f,e),sqrt:n.sqrt||(f=>l(u,f)),invertBatch:f=>FpInvertBatch$1(u,f),cmov:(f,x,p)=>p?x:f,toBytes:f=>r?numberToBytesLE$1(f,a):numberToBytesBE$1(f,a),fromBytes:f=>{if(f.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${f.length}`);return r?bytesToNumberLE$1(f):bytesToNumberBE$1(f)}});return Object.freeze(u)}function getFieldBytesLength$1(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength$1(e){const t=getFieldBytesLength$1(e);return t+Math.ceil(t/2)}function mapHashToField$1(e,t,r=!1){const n=e.length,o=getFieldBytesLength$1(t),a=getMinHashLength$1(t);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);const l=r?bytesToNumberBE$1(e):bytesToNumberLE$1(e),u=mod$1(l,t-_1n$8)+_1n$8;return r?numberToBytesLE$1(u,o):numberToBytesBE$1(u,o)}const _0n$7=BigInt(0),_1n$7=BigInt(1);function wNAF$1(e,t){const r=(o,a)=>{const l=a.negate();return o?l:a},n=o=>{const a=Math.ceil(t/o)+1,l=2**(o-1);return{windows:a,windowSize:l}};return{constTimeNegate:r,unsafeLadder(o,a){let l=e.ZERO,u=o;for(;a>_0n$7;)a&_1n$7&&(l=l.add(u)),u=u.double(),a>>=_1n$7;return l},precomputeWindow(o,a){const{windows:l,windowSize:u}=n(a),f=[];let x=o,p=x;for(let g=0;g<l;g++){p=x,f.push(p);for(let y=1;y<u;y++)p=p.add(x),f.push(p);x=p.double()}return f},wNAF(o,a,l){const{windows:u,windowSize:f}=n(o);let x=e.ZERO,p=e.BASE;const g=BigInt(2**o-1),y=2**o,b=BigInt(o);for(let w=0;w<u;w++){const v=w*f;let B=Number(l&g);l>>=b,B>f&&(B-=y,l+=_1n$7);const j=v,F=v+Math.abs(B)-1,C=w%2!==0,N=B<0;B===0?p=p.add(r(C,a[j])):x=x.add(r(N,a[F]))}return{p:x,f:p}},wNAFCached(o,a,l,u){const f=o._WINDOW_SIZE||1;let x=a.get(o);return x||(x=this.precomputeWindow(o,f),f!==1&&a.set(o,u(x))),this.wNAF(f,x,l)}}}function validateBasic(e){return validateField$1(e.Fp),validateObject(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$1(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function validatePointOpts(e){const t=validateBasic(e);validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:o}=t;if(r){if(!n.eql(o,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut,DER$1={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){const{Err:t}=DER$1;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");const r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:b2n(n),l:e.subarray(r+2)}},toSig(e){const{Err:t}=DER$1,r=typeof e=="string"?h2b(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");const{d:o,l:a}=DER$1._parseInt(r.subarray(2)),{d:l,l:u}=DER$1._parseInt(a);if(u.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:l}},hexFromSig(e){const t=x=>Number.parseInt(x[0],16)&8?"00"+x:x,r=x=>{const p=x.toString(16);return p.length&1?`0${p}`:p},n=t(r(e.s)),o=t(r(e.r)),a=n.length/2,l=o.length/2,u=r(a),f=r(l);return`30${r(l+a+4)}02${f}${o}02${u}${n}`}},_0n$6=BigInt(0),_1n$6=BigInt(1);BigInt(2);const _3n$2=BigInt(3);BigInt(4);function weierstrassPoints(e){const t=validatePointOpts(e),{Fp:r}=t,n=t.toBytes||((w,v,B)=>{const j=v.toAffine();return concatBytes$2(Uint8Array.from([4]),r.toBytes(j.x),r.toBytes(j.y))}),o=t.fromBytes||(w=>{const v=w.subarray(1),B=r.fromBytes(v.subarray(0,r.BYTES)),j=r.fromBytes(v.subarray(r.BYTES,2*r.BYTES));return{x:B,y:j}});function a(w){const{a:v,b:B}=t,j=r.sqr(w),F=r.mul(j,w);return r.add(r.add(F,r.mul(w,v)),B)}if(!r.eql(r.sqr(t.Gy),a(t.Gx)))throw new Error("bad generator point: equation left != right");function l(w){return typeof w=="bigint"&&_0n$6<w&&w<t.n}function u(w){if(!l(w))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(w){const{allowedPrivateKeyLengths:v,nByteLength:B,wrapPrivateKey:j,n:F}=t;if(v&&typeof w!="bigint"){if(w instanceof Uint8Array&&(w=bytesToHex$3(w)),typeof w!="string"||!v.includes(w.length))throw new Error("Invalid key");w=w.padStart(B*2,"0")}let C;try{C=typeof w=="bigint"?w:bytesToNumberBE$1(ensureBytes$1("private key",w,B))}catch{throw new Error(`private key must be ${B} bytes, hex or bigint, not ${typeof w}`)}return j&&(C=mod$1(C,F)),u(C),C}const x=new Map;function p(w){if(!(w instanceof g))throw new Error("ProjectivePoint expected")}class g{constructor(v,B,j){if(this.px=v,this.py=B,this.pz=j,v==null||!r.isValid(v))throw new Error("x required");if(B==null||!r.isValid(B))throw new Error("y required");if(j==null||!r.isValid(j))throw new Error("z required")}static fromAffine(v){const{x:B,y:j}=v||{};if(!v||!r.isValid(B)||!r.isValid(j))throw new Error("invalid affine point");if(v instanceof g)throw new Error("projective point not allowed");const F=C=>r.eql(C,r.ZERO);return F(B)&&F(j)?g.ZERO:new g(B,j,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){const B=r.invertBatch(v.map(j=>j.pz));return v.map((j,F)=>j.toAffine(B[F])).map(g.fromAffine)}static fromHex(v){const B=g.fromAffine(o(ensureBytes$1("pointHex",v)));return B.assertValidity(),B}static fromPrivateKey(v){return g.BASE.multiply(f(v))}_setWindowSize(v){this._WINDOW_SIZE=v,x.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:v,y:B}=this.toAffine();if(!r.isValid(v)||!r.isValid(B))throw new Error("bad point: x or y not FE");const j=r.sqr(B),F=a(v);if(!r.eql(j,F))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:v}=this.toAffine();if(r.isOdd)return!r.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){p(v);const{px:B,py:j,pz:F}=this,{px:C,py:N,pz:T}=v,_=r.eql(r.mul(B,T),r.mul(C,F)),S=r.eql(r.mul(j,T),r.mul(N,F));return _&&S}negate(){return new g(this.px,r.neg(this.py),this.pz)}double(){const{a:v,b:B}=t,j=r.mul(B,_3n$2),{px:F,py:C,pz:N}=this;let T=r.ZERO,_=r.ZERO,S=r.ZERO,O=r.mul(F,F),$=r.mul(C,C),z=r.mul(N,N),W=r.mul(F,C);return W=r.add(W,W),S=r.mul(F,N),S=r.add(S,S),T=r.mul(v,S),_=r.mul(j,z),_=r.add(T,_),T=r.sub($,_),_=r.add($,_),_=r.mul(T,_),T=r.mul(W,T),S=r.mul(j,S),z=r.mul(v,z),W=r.sub(O,z),W=r.mul(v,W),W=r.add(W,S),S=r.add(O,O),O=r.add(S,O),O=r.add(O,z),O=r.mul(O,W),_=r.add(_,O),z=r.mul(C,N),z=r.add(z,z),O=r.mul(z,W),T=r.sub(T,O),S=r.mul(z,$),S=r.add(S,S),S=r.add(S,S),new g(T,_,S)}add(v){p(v);const{px:B,py:j,pz:F}=this,{px:C,py:N,pz:T}=v;let _=r.ZERO,S=r.ZERO,O=r.ZERO;const $=t.a,z=r.mul(t.b,_3n$2);let W=r.mul(B,C),U=r.mul(j,N),I=r.mul(F,T),G=r.add(B,j),k=r.add(C,N);G=r.mul(G,k),k=r.add(W,U),G=r.sub(G,k),k=r.add(B,F);let M=r.add(C,T);return k=r.mul(k,M),M=r.add(W,I),k=r.sub(k,M),M=r.add(j,F),_=r.add(N,T),M=r.mul(M,_),_=r.add(U,I),M=r.sub(M,_),O=r.mul($,k),_=r.mul(z,I),O=r.add(_,O),_=r.sub(U,O),O=r.add(U,O),S=r.mul(_,O),U=r.add(W,W),U=r.add(U,W),I=r.mul($,I),k=r.mul(z,k),U=r.add(U,I),I=r.sub(W,I),I=r.mul($,I),k=r.add(k,I),W=r.mul(U,k),S=r.add(S,W),W=r.mul(M,k),_=r.mul(G,_),_=r.sub(_,W),W=r.mul(G,U),O=r.mul(M,O),O=r.add(O,W),new g(_,S,O)}subtract(v){return this.add(v.negate())}is0(){return this.equals(g.ZERO)}wNAF(v){return b.wNAFCached(this,x,v,B=>{const j=r.invertBatch(B.map(F=>F.pz));return B.map((F,C)=>F.toAffine(j[C])).map(g.fromAffine)})}multiplyUnsafe(v){const B=g.ZERO;if(v===_0n$6)return B;if(u(v),v===_1n$6)return this;const{endo:j}=t;if(!j)return b.unsafeLadder(this,v);let{k1neg:F,k1:C,k2neg:N,k2:T}=j.splitScalar(v),_=B,S=B,O=this;for(;C>_0n$6||T>_0n$6;)C&_1n$6&&(_=_.add(O)),T&_1n$6&&(S=S.add(O)),O=O.double(),C>>=_1n$6,T>>=_1n$6;return F&&(_=_.negate()),N&&(S=S.negate()),S=new g(r.mul(S.px,j.beta),S.py,S.pz),_.add(S)}multiply(v){u(v);let B=v,j,F;const{endo:C}=t;if(C){const{k1neg:N,k1:T,k2neg:_,k2:S}=C.splitScalar(B);let{p:O,f:$}=this.wNAF(T),{p:z,f:W}=this.wNAF(S);O=b.constTimeNegate(N,O),z=b.constTimeNegate(_,z),z=new g(r.mul(z.px,C.beta),z.py,z.pz),j=O.add(z),F=$.add(W)}else{const{p:N,f:T}=this.wNAF(B);j=N,F=T}return g.normalizeZ([j,F])[0]}multiplyAndAddUnsafe(v,B,j){const F=g.BASE,C=(T,_)=>_===_0n$6||_===_1n$6||!T.equals(F)?T.multiplyUnsafe(_):T.multiply(_),N=C(this,B).add(C(v,j));return N.is0()?void 0:N}toAffine(v){const{px:B,py:j,pz:F}=this,C=this.is0();v==null&&(v=C?r.ONE:r.inv(F));const N=r.mul(B,v),T=r.mul(j,v),_=r.mul(F,v);if(C)return{x:r.ZERO,y:r.ZERO};if(!r.eql(_,r.ONE))throw new Error("invZ was invalid");return{x:N,y:T}}isTorsionFree(){const{h:v,isTorsionFree:B}=t;if(v===_1n$6)return!0;if(B)return B(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:v,clearCofactor:B}=t;return v===_1n$6?this:B?B(g,this):this.multiplyUnsafe(t.h)}toRawBytes(v=!0){return this.assertValidity(),n(g,this,v)}toHex(v=!0){return bytesToHex$3(this.toRawBytes(v))}}g.BASE=new g(t.Gx,t.Gy,r.ONE),g.ZERO=new g(r.ZERO,r.ONE,r.ZERO);const y=t.nBitLength,b=wNAF$1(g,t.endo?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:g,normPrivateKeyToScalar:f,weierstrassEquation:a,isWithinCurveOrder:l}}function validateOpts(e){const t=validateBasic(e);return validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass$2(e){const t=validateOpts(e),{Fp:r,n}=t,o=r.BYTES+1,a=2*r.BYTES+1;function l(k){return _0n$6<k&&k<r.ORDER}function u(k){return mod$1(k,n)}function f(k){return invert$1(k,n)}const{ProjectivePoint:x,normPrivateKeyToScalar:p,weierstrassEquation:g,isWithinCurveOrder:y}=weierstrassPoints({...t,toBytes(k,M,q){const K=M.toAffine(),H=r.toBytes(K.x),Q=concatBytes$2;return q?Q(Uint8Array.from([M.hasEvenY()?2:3]),H):Q(Uint8Array.from([4]),H,r.toBytes(K.y))},fromBytes(k){const M=k.length,q=k[0],K=k.subarray(1);if(M===o&&(q===2||q===3)){const H=bytesToNumberBE$1(K);if(!l(H))throw new Error("Point is not on curve");const Q=g(H);let D=r.sqrt(Q);const Y=(D&_1n$6)===_1n$6;return(q&1)===1!==Y&&(D=r.neg(D)),{x:H,y:D}}else if(M===a&&q===4){const H=r.fromBytes(K.subarray(0,r.BYTES)),Q=r.fromBytes(K.subarray(r.BYTES,2*r.BYTES));return{x:H,y:Q}}else throw new Error(`Point of length ${M} was invalid. Expected ${o} compressed bytes or ${a} uncompressed bytes`)}}),b=k=>bytesToHex$3(numberToBytesBE$1(k,t.nByteLength));function w(k){const M=n>>_1n$6;return k>M}function v(k){return w(k)?u(-k):k}const B=(k,M,q)=>bytesToNumberBE$1(k.slice(M,q));class j{constructor(M,q,K){this.r=M,this.s=q,this.recovery=K,this.assertValidity()}static fromCompact(M){const q=t.nByteLength;return M=ensureBytes$1("compactSignature",M,q*2),new j(B(M,0,q),B(M,q,2*q))}static fromDER(M){const{r:q,s:K}=DER$1.toSig(ensureBytes$1("DER",M));return new j(q,K)}assertValidity(){if(!y(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!y(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(M){return new j(this.r,this.s,M)}recoverPublicKey(M){const{r:q,s:K,recovery:H}=this,Q=S(ensureBytes$1("msgHash",M));if(H==null||![0,1,2,3].includes(H))throw new Error("recovery id invalid");const D=H===2||H===3?q+t.n:q;if(D>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const Y=(H&1)===0?"02":"03",J=x.fromHex(Y+b(D)),L=f(D),Z=u(-Q*L),oe=u(K*L),ce=x.BASE.multiplyAndAddUnsafe(J,Z,oe);if(!ce)throw new Error("point at infinify");return ce.assertValidity(),ce}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new j(this.r,u(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$5(this.toDERHex())}toDERHex(){return DER$1.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$5(this.toCompactHex())}toCompactHex(){return b(this.r)+b(this.s)}}const F={isValidPrivateKey(k){try{return p(k),!0}catch{return!1}},normPrivateKeyToScalar:p,randomPrivateKey:()=>{const k=getMinHashLength$1(t.n);return mapHashToField$1(t.randomBytes(k),t.n)},precompute(k=8,M=x.BASE){return M._setWindowSize(k),M.multiply(BigInt(3)),M}};function C(k,M=!0){return x.fromPrivateKey(k).toRawBytes(M)}function N(k){const M=k instanceof Uint8Array,q=typeof k=="string",K=(M||q)&&k.length;return M?K===o||K===a:q?K===2*o||K===2*a:k instanceof x}function T(k,M,q=!0){if(N(k))throw new Error("first arg must be private key");if(!N(M))throw new Error("second arg must be public key");return x.fromHex(M).multiply(p(k)).toRawBytes(q)}const _=t.bits2int||function(k){const M=bytesToNumberBE$1(k),q=k.length*8-t.nBitLength;return q>0?M>>BigInt(q):M},S=t.bits2int_modN||function(k){return u(_(k))},O=bitMask$1(t.nBitLength);function $(k){if(typeof k!="bigint")throw new Error("bigint expected");if(!(_0n$6<=k&&k<O))throw new Error(`bigint expected < 2^${t.nBitLength}`);return numberToBytesBE$1(k,t.nByteLength)}function z(k,M,q=W){if(["recovered","canonical"].some(xe=>xe in q))throw new Error("sign() legacy options not supported");const{hash:K,randomBytes:H}=t;let{lowS:Q,prehash:D,extraEntropy:Y}=q;Q==null&&(Q=!0),k=ensureBytes$1("msgHash",k),D&&(k=ensureBytes$1("prehashed msgHash",K(k)));const J=S(k),L=p(M),Z=[$(L),$(J)];if(Y!=null){const xe=Y===!0?H(r.BYTES):Y;Z.push(ensureBytes$1("extraEntropy",xe))}const oe=concatBytes$2(...Z),ce=J;function de(xe){const te=_(xe);if(!y(te))return;const ae=f(te),le=x.BASE.multiply(te).toAffine(),ue=u(le.x);if(ue===_0n$6)return;const be=u(ae*u(ce+ue*L));if(be===_0n$6)return;let Be=(le.x===ue?0:2)|Number(le.y&_1n$6),Ce=be;return Q&&w(be)&&(Ce=v(be),Be^=1),new j(ue,Ce,Be)}return{seed:oe,k2sig:de}}const W={lowS:t.lowS,prehash:!1},U={lowS:t.lowS,prehash:!1};function I(k,M,q=W){const{seed:K,k2sig:H}=z(k,M,q),Q=t;return createHmacDrbg$1(Q.hash.outputLen,Q.nByteLength,Q.hmac)(K,H)}x.BASE._setWindowSize(8);function G(k,M,q,K=U){const H=k;if(M=ensureBytes$1("msgHash",M),q=ensureBytes$1("publicKey",q),"strict"in K)throw new Error("options.strict was renamed to lowS");const{lowS:Q,prehash:D}=K;let Y,J;try{if(typeof H=="string"||H instanceof Uint8Array)try{Y=j.fromDER(H)}catch(le){if(!(le instanceof DER$1.Err))throw le;Y=j.fromCompact(H)}else if(typeof H=="object"&&typeof H.r=="bigint"&&typeof H.s=="bigint"){const{r:le,s:ue}=H;Y=new j(le,ue)}else throw new Error("PARSE");J=x.fromHex(q)}catch(le){if(le.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Q&&Y.hasHighS())return!1;D&&(M=t.hash(M));const{r:L,s:Z}=Y,oe=S(M),ce=f(Z),de=u(oe*ce),xe=u(L*ce),te=x.BASE.multiplyAndAddUnsafe(J,de,xe)?.toAffine();return te?u(te.x)===L:!1}return{CURVE:t,getPublicKey:C,getSharedSecret:T,sign:I,verify:G,ProjectivePoint:x,Signature:j,utils:F}}let HMAC$2=class extends Hash$2{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,hash$2(t);const n=toBytes$3(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,a=new Uint8Array(o);a.set(n.length>o?t.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=t.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),a.fill(0)}update(t){return exists$2(this),this.iHash.update(t),this}digestInto(t){exists$2(this),bytes$2(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:o,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=o,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$3=(e,t,r)=>new HMAC$2(e,t).update(r).digest();hmac$3.create=(e,t)=>new HMAC$2(e,t);function getHash(e){return{hash:e,hmac:(t,...r)=>hmac$3(e,t,concatBytes$3(...r)),randomBytes:randomBytes$2}}function createCurve$1(e,t){const r=n=>weierstrass$2({...e,...getHash(n)});return Object.freeze({...r(t),create:r})}const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$5=BigInt(1),_2n$3=BigInt(2),divNearest$1=(e,t)=>(e+t/_2n$3)/t;function sqrtMod$1(e){const t=secp256k1P,r=BigInt(3),n=BigInt(6),o=BigInt(11),a=BigInt(22),l=BigInt(23),u=BigInt(44),f=BigInt(88),x=e*e*e%t,p=x*x*e%t,g=pow2$1(p,r,t)*p%t,y=pow2$1(g,r,t)*p%t,b=pow2$1(y,_2n$3,t)*x%t,w=pow2$1(b,o,t)*b%t,v=pow2$1(w,a,t)*w%t,B=pow2$1(v,u,t)*v%t,j=pow2$1(B,f,t)*B%t,F=pow2$1(j,u,t)*v%t,C=pow2$1(F,r,t)*p%t,N=pow2$1(C,l,t)*w%t,T=pow2$1(N,n,t)*x%t,_=pow2$1(T,_2n$3,t);if(!Fp.eql(Fp.sqr(_),e))throw new Error("Cannot find square root");return _}const Fp=Field$1(secp256k1P,void 0,void 0,{sqrt:sqrtMod$1}),secp256k1$2=createCurve$1({a:BigInt(0),b:BigInt(7),Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=secp256k1N,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-_1n$5*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,l=BigInt("0x100000000000000000000000000000000"),u=divNearest$1(a*e,t),f=divNearest$1(-n*e,t);let x=mod$1(e-u*r-f*o,t),p=mod$1(-u*n-f*a,t);const g=x>l,y=p>l;if(g&&(x=t-x),y&&(p=t-p),x>l||p>l)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:g,k1:x,k2neg:y,k2:p}}}},sha256$4),_0n$5=BigInt(0),fe=e=>typeof e=="bigint"&&_0n$5<e&&e<secp256k1P,ge=e=>typeof e=="bigint"&&_0n$5<e&&e<secp256k1N,TAGGED_HASH_PREFIXES$2={};function taggedHash$2(e,...t){let r=TAGGED_HASH_PREFIXES$2[e];if(r===void 0){const n=sha256$4(Uint8Array.from(e,o=>o.charCodeAt(0)));r=concatBytes$2(n,n),TAGGED_HASH_PREFIXES$2[e]=r}return sha256$4(concatBytes$2(r,...t))}const pointToBytes$1=e=>e.toRawBytes(!0).slice(1),numTo32b=e=>numberToBytesBE$1(e,32),modP=e=>mod$1(e,secp256k1P),modN=e=>mod$1(e,secp256k1N),Point=secp256k1$2.ProjectivePoint,GmulAdd=(e,t,r)=>Point.BASE.multiplyAndAddUnsafe(e,t,r);function schnorrGetExtPubKey$1(e){let t=secp256k1$2.utils.normPrivateKeyToScalar(e),r=Point.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:modN(-t),bytes:pointToBytes$1(r)}}function lift_x$1(e){if(!fe(e))throw new Error("bad x: need 0 < x < p");const t=modP(e*e),r=modP(t*e+BigInt(7));let n=sqrtMod$1(r);n%_2n$3!==_0n$5&&(n=modP(-n));const o=new Point(e,n,_1n$5);return o.assertValidity(),o}function challenge$1(...e){return modN(bytesToNumberBE$1(taggedHash$2("BIP0340/challenge",...e)))}function schnorrGetPublicKey$1(e){return schnorrGetExtPubKey$1(e).bytes}function schnorrSign$1(e,t,r=randomBytes$2(32)){const n=ensureBytes$1("message",e),{bytes:o,scalar:a}=schnorrGetExtPubKey$1(t),l=ensureBytes$1("auxRand",r,32),u=numTo32b(a^bytesToNumberBE$1(taggedHash$2("BIP0340/aux",l))),f=taggedHash$2("BIP0340/nonce",u,o,n),x=modN(bytesToNumberBE$1(f));if(x===_0n$5)throw new Error("sign failed: k is zero");const{bytes:p,scalar:g}=schnorrGetExtPubKey$1(x),y=challenge$1(p,o,n),b=new Uint8Array(64);if(b.set(p,0),b.set(numTo32b(modN(g+y*a)),32),!schnorrVerify$1(b,n,o))throw new Error("sign: Invalid signature produced");return b}function schnorrVerify$1(e,t,r){const n=ensureBytes$1("signature",e,64),o=ensureBytes$1("message",t),a=ensureBytes$1("publicKey",r,32);try{const l=lift_x$1(bytesToNumberBE$1(a)),u=bytesToNumberBE$1(n.subarray(0,32));if(!fe(u))return!1;const f=bytesToNumberBE$1(n.subarray(32,64));if(!ge(f))return!1;const x=challenge$1(numTo32b(u),pointToBytes$1(l),o),p=GmulAdd(l,f,modN(-x));return!(!p||!p.hasEvenY()||p.toAffine().x!==u)}catch{return!1}}const schnorr$1={getPublicKey:schnorrGetPublicKey$1,sign:schnorrSign$1,verify:schnorrVerify$1,utils:{randomPrivateKey:secp256k1$2.utils.randomPrivateKey,lift_x:lift_x$1,pointToBytes:pointToBytes$1,numberToBytesBE:numberToBytesBE$1,bytesToNumberBE:bytesToNumberBE$1,taggedHash:taggedHash$2,mod:mod$1}},crypto$4=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const u8a=e=>e instanceof Uint8Array,u32$1=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),createView$2=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$1=(e,t)=>e<<32-t|e>>>t,isLE$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$1)throw new Error("Non little-endian hardware is not supported");const hexes$2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$2(e){if(!u8a(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=hexes$2[e[r]];return t}function hexToBytes$4(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){const o=n*2,a=e.slice(o,o+2),l=Number.parseInt(a,16);if(Number.isNaN(l)||l<0)throw new Error("Invalid byte sequence");r[n]=l}return r}function utf8ToBytes$2(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$2(e){if(typeof e=="string"&&(e=utf8ToBytes$2(e)),!u8a(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function concatBytes$1(...e){const t=new Uint8Array(e.reduce((n,o)=>n+o.length,0));let r=0;return e.forEach(n=>{if(!u8a(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}let Hash$1=class{clone(){return this._cloneInto()}};const isPlainObject=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function checkOpts$1(e,t){if(t!==void 0&&(typeof t!="object"||!isPlainObject(t)))throw new Error("Options should be object or undefined");return Object.assign(e,t)}function wrapConstructor(e){const t=n=>e().update(toBytes$2(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function randomBytes$1(e=32){if(crypto$4&&typeof crypto$4.getRandomValues=="function")return crypto$4.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function number$3(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bool$1(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function bytes$1(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$1(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$3(e.outputLen),number$3(e.blockLen)}function exists$1(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$1(e,t){bytes$1(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const assert$3={number:number$3,bool:bool$1,bytes:bytes$1,hash:hash$1,exists:exists$1,output:output$1};function setBigUint64$2(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const o=BigInt(32),a=BigInt(4294967295),l=Number(r>>o&a),u=Number(r&a),f=n?4:0,x=n?0:4;e.setUint32(t+f,l,n),e.setUint32(t+x,u,n)}class SHA2 extends Hash$1{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=createView$2(this.buffer)}update(t){assert$3.exists(this);const{view:r,buffer:n,blockLen:o}=this;t=toBytes$2(t);const a=t.length;for(let l=0;l<a;){const u=Math.min(o-this.pos,a-l);if(u===o){const f=createView$2(t);for(;o<=a-l;l+=o)this.process(f,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){assert$3.exists(this),assert$3.output(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:a}=this;let{pos:l}=this;r[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>o-l&&(this.process(n,0),l=0);for(let g=l;g<o;g++)r[g]=0;setBigUint64$2(n,o-8,BigInt(this.length*8),a),this.process(n,0);const u=createView$2(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const x=f/4,p=this.get();if(x>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<x;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:a,destroyed:l,pos:u}=this;return t.length=o,t.pos=u,t.finished=a,t.destroyed=l,o%r&&t.buffer.set(n),t}}const Chi$1=(e,t,r)=>e&t^~e&r,Maj$1=(e,t,r)=>e&t^e&r^t&r,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends SHA2{constructor(){super(64,32,8,!1),this.A=IV[0]|0,this.B=IV[1]|0,this.C=IV[2]|0,this.D=IV[3]|0,this.E=IV[4]|0,this.F=IV[5]|0,this.G=IV[6]|0,this.H=IV[7]|0}get(){const{A:t,B:r,C:n,D:o,E:a,F:l,G:u,H:f}=this;return[t,r,n,o,a,l,u,f]}set(t,r,n,o,a,l,u,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=f|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W$1[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W$1[g-15],b=SHA256_W$1[g-2],w=rotr$1(y,7)^rotr$1(y,18)^y>>>3,v=rotr$1(b,17)^rotr$1(b,19)^b>>>10;SHA256_W$1[g]=v+SHA256_W$1[g-7]+w+SHA256_W$1[g-16]|0}let{A:n,B:o,C:a,D:l,E:u,F:f,G:x,H:p}=this;for(let g=0;g<64;g++){const y=rotr$1(u,6)^rotr$1(u,11)^rotr$1(u,25),b=p+y+Chi$1(u,f,x)+SHA256_K$1[g]+SHA256_W$1[g]|0,v=(rotr$1(n,2)^rotr$1(n,13)^rotr$1(n,22))+Maj$1(n,o,a)|0;p=x,x=f,f=u,u=l+b|0,l=a,a=o,o=n,n=b+v|0}n=n+this.A|0,o=o+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,f=f+this.F|0,x=x+this.G|0,p=p+this.H|0,this.set(n,o,a,l,u,f,x,p)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class SHA224 extends SHA256$1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const sha256$3=wrapConstructor(()=>new SHA256$1);wrapConstructor(()=>new SHA224);function assertNumber(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function chain(...e){const t=(o,a)=>l=>o(a(l)),r=Array.from(e).reverse().reduce((o,a)=>o?t(o,a.encode):a.encode,void 0),n=e.reduce((o,a)=>o?t(o,a.decode):a.decode,void 0);return{encode:r,decode:n}}function alphabet(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(r=>{if(assertNumber(r),r<0||r>=e.length)throw new Error(`Digit index outside alphabet: ${r} (alphabet: ${e.length})`);return e[r]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(r=>{if(typeof r!="string")throw new Error(`alphabet.decode: not string element=${r}`);const n=e.indexOf(r);if(n===-1)throw new Error(`Unknown letter: "${r}". Allowed: ${e}`);return n})}}}function join(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let r of t)if(typeof r!="string")throw new Error(`join.encode: non-string input=${r}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function padding(e,t="="){if(assertNumber(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let n of r)if(typeof n!="string")throw new Error(`padding.encode: non-string input=${n}`);for(;r.length*e%8;)r.push(t);return r},decode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of r)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let n=r.length;if(n*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if(!((n-1)*e%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function normalize$1(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function convertRadix(e,t,r){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let n=0;const o=[],a=Array.from(e);for(a.forEach(l=>{if(assertNumber(l),l<0||l>=t)throw new Error(`Wrong integer: ${l}`)});;){let l=0,u=!0;for(let f=n;f<a.length;f++){const x=a[f],p=t*l+x;if(!Number.isSafeInteger(p)||t*l/t!==l||p-x!==t*l)throw new Error("convertRadix: carry overflow");if(l=p%r,a[f]=Math.floor(p/r),!Number.isSafeInteger(a[f])||a[f]*r+l!==p)throw new Error("convertRadix: carry overflow");if(u)a[f]?u=!1:n=f;else continue}if(o.push(l),u)break}for(let l=0;l<e.length-1&&e[l]===0;l++)o.push(0);return o.reverse()}const gcd=(e,t)=>t?gcd(t,e%t):e,radix2carry=(e,t)=>e+(t-gcd(e,t));function convertRadix2(e,t,r,n){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(radix2carry(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${radix2carry(t,r)}`);let o=0,a=0;const l=2**r-1,u=[];for(const f of e){if(assertNumber(f),f>=2**t)throw new Error(`convertRadix2: invalid data word=${f} from=${t}`);if(o=o<<t|f,a+t>32)throw new Error(`convertRadix2: carry overflow pos=${a} from=${t}`);for(a+=t;a>=r;a-=r)u.push((o>>a-r&l)>>>0);o&=2**a-1}if(o=o<<r-a&l,!n&&a>=t)throw new Error("Excess padding");if(!n&&o)throw new Error(`Non-zero padding: ${o}`);return n&&a>0&&u.push(o>>>0),u}function radix(e){return assertNumber(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(convertRadix(t,e,2**8))}}}function radix2(e,t=!1){if(assertNumber(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,e)>32||radix2carry(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(r),8,e,!t)},decode:r=>{if(!Array.isArray(r)||r.length&&typeof r[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(convertRadix2(r,e,8,t))}}}function unsafeWrapper(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}const base16=chain(radix2(4),alphabet("0123456789ABCDEF"),join("")),base32=chain(radix2(5),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHIJKLMNOPQRSTUV"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),join(""),normalize$1(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const base64=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),padding(6),join("")),base64url=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),padding(6),join("")),genBase58=e=>chain(radix(58),alphabet(e),join("")),base58$1=genBase58("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");genBase58("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");genBase58("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const XMR_BLOCK_LEN=[0,2,3,5,6,7,9,10,11],base58xmr={encode(e){let t="";for(let r=0;r<e.length;r+=8){const n=e.subarray(r,r+8);t+=base58$1.encode(n).padStart(XMR_BLOCK_LEN[n.length],"1")}return t},decode(e){let t=[];for(let r=0;r<e.length;r+=11){const n=e.slice(r,r+11),o=XMR_BLOCK_LEN.indexOf(n.length),a=base58$1.decode(n);for(let l=0;l<a.length-o;l++)if(a[l]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(a.slice(a.length-o)))}return Uint8Array.from(t)}},BECH_ALPHABET=chain(alphabet("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join("")),POLYMOD_GENERATORS=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod(e){const t=e>>25;let r=(e&33554431)<<5;for(let n=0;n<POLYMOD_GENERATORS.length;n++)(t>>n&1)===1&&(r^=POLYMOD_GENERATORS[n]);return r}function bechChecksum(e,t,r=1){const n=e.length;let o=1;for(let a=0;a<n;a++){const l=e.charCodeAt(a);if(l<33||l>126)throw new Error(`Invalid prefix (${e})`);o=bech32Polymod(o)^l>>5}o=bech32Polymod(o);for(let a=0;a<n;a++)o=bech32Polymod(o)^e.charCodeAt(a)&31;for(let a of t)o=bech32Polymod(o)^a;for(let a=0;a<6;a++)o=bech32Polymod(o);return o^=r,BECH_ALPHABET.encode(convertRadix2([o%2**30],30,5,!1))}function genBech32(e){const t=e==="bech32"?1:734539939,r=radix2(5),n=r.decode,o=r.encode,a=unsafeWrapper(n);function l(p,g,y=90){if(typeof p!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof p}`);if(!Array.isArray(g)||g.length&&typeof g[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof g}`);const b=p.length+7+g.length;if(y!==!1&&b>y)throw new TypeError(`Length ${b} exceeds limit ${y}`);return p=p.toLowerCase(),`${p}1${BECH_ALPHABET.encode(g)}${bechChecksum(p,g,t)}`}function u(p,g=90){if(typeof p!="string")throw new Error(`bech32.decode input should be string, not ${typeof p}`);if(p.length<8||g!==!1&&p.length>g)throw new TypeError(`Wrong string length: ${p.length} (${p}). Expected (8..${g})`);const y=p.toLowerCase();if(p!==y&&p!==p.toUpperCase())throw new Error("String must be lowercase or uppercase");p=y;const b=p.lastIndexOf("1");if(b===0||b===-1)throw new Error('Letter "1" must be present between prefix and data only');const w=p.slice(0,b),v=p.slice(b+1);if(v.length<6)throw new Error("Data must be at least 6 characters long");const B=BECH_ALPHABET.decode(v).slice(0,-6),j=bechChecksum(w,B,t);if(!v.endsWith(j))throw new Error(`Invalid checksum in ${p}: expected "${j}"`);return{prefix:w,words:B}}const f=unsafeWrapper(u);function x(p){const{prefix:g,words:y}=u(p,!1);return{prefix:g,words:y,bytes:n(y)}}return{encode:l,decode:u,decodeToBytes:x,decodeUnsafe:f,fromWords:n,fromWordsUnsafe:a,toWords:o}}const bech32=genBech32("bech32");genBech32("bech32m");const utf8={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},hex=chain(radix2(4),alphabet("0123456789abcdef"),join(""),normalize$1(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),CODERS={utf8,hex,base16,base32,base64,base64url,base58:base58$1,base58xmr};`${Object.keys(CODERS).join(", ")}`;function number$2(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function bool(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function isBytes$1(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function bytes(e,...t){if(!isBytes$1(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function exists(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output(e,t){bytes(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),createView$1=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");const hexes$1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$1(e){bytes(e);let t="";for(let r=0;r<e.length;r++)t+=hexes$1[e[r]];return t}const asciis$1={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16$1(e){if(e>=asciis$1._0&&e<=asciis$1._9)return e-asciis$1._0;if(e>=asciis$1._A&&e<=asciis$1._F)return e-(asciis$1._A-10);if(e>=asciis$1._a&&e<=asciis$1._f)return e-(asciis$1._a-10)}function hexToBytes$3(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let o=0,a=0;o<r;o++,a+=2){const l=asciiToBase16$1(e.charCodeAt(a)),u=asciiToBase16$1(e.charCodeAt(a+1));if(l===void 0||u===void 0){const f=e[a]+e[a+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+a)}n[o]=l*16+u}return n}function utf8ToBytes$1(e){if(typeof e!="string")throw new Error(`string expected, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$1(e){if(typeof e=="string")e=utf8ToBytes$1(e);else if(isBytes$1(e))e=e.slice();else throw new Error(`Uint8Array expected, got ${typeof e}`);return e}function checkOpts(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function equalBytes(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}const wrapCipher=(e,t)=>(Object.assign(t,e),t);function setBigUint64$1(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const o=BigInt(32),a=BigInt(4294967295),l=Number(r>>o&a),u=Number(r&a),f=4,x=0;e.setUint32(t+f,l,n),e.setUint32(t+x,u,n)}const BLOCK_SIZE=16,POLY=283;function mul2(e){return e<<1^POLY&-(e>>7)}function mul(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(t&1),e=mul2(e);return r}const sbox=(()=>{let e=new Uint8Array(256);for(let r=0,n=1;r<256;r++,n^=mul2(n))e[r]=n;const t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return t})(),invSbox=sbox.map((e,t)=>sbox.indexOf(t)),rotr32_8=e=>e<<24|e>>>8,rotl32_8=e=>e<<8|e>>>24;function genTtable(e,t){if(e.length!==256)throw new Error("Wrong sbox length");const r=new Uint32Array(256).map((x,p)=>t(e[p])),n=r.map(rotl32_8),o=n.map(rotl32_8),a=o.map(rotl32_8),l=new Uint32Array(256*256),u=new Uint32Array(256*256),f=new Uint16Array(256*256);for(let x=0;x<256;x++)for(let p=0;p<256;p++){const g=x*256+p;l[g]=r[x]^n[p],u[g]=o[x]^a[p],f[g]=e[x]<<8|e[p]}return{sbox:e,sbox2:f,T0:r,T1:n,T2:o,T3:a,T01:l,T23:u}}const tableEncoding=genTtable(sbox,e=>mul(e,3)<<24|e<<16|e<<8|mul(e,2)),tableDecoding=genTtable(invSbox,e=>mul(e,11)<<24|mul(e,13)<<16|mul(e,9)<<8|mul(e,14)),xPowers=(()=>{const e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=mul2(r))e[t]=r;return e})();function expandKeyLE(e){bytes(e);const t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);const{sbox2:r}=tableEncoding,n=u32(e),o=n.length,a=u=>applySbox(r,u,u,u,u),l=new Uint32Array(t+28);l.set(n);for(let u=o;u<l.length;u++){let f=l[u-1];u%o===0?f=a(rotr32_8(f))^xPowers[u/o-1]:o>6&&u%o===4&&(f=a(f)),l[u]=l[u-o]^f}return l}function expandKeyDecLE(e){const t=expandKeyLE(e),r=t.slice(),n=t.length,{sbox2:o}=tableEncoding,{T0:a,T1:l,T2:u,T3:f}=tableDecoding;for(let x=0;x<n;x+=4)for(let p=0;p<4;p++)r[x+p]=t[n-x-4+p];t.fill(0);for(let x=4;x<n-4;x++){const p=r[x],g=applySbox(o,p,p,p,p);r[x]=a[g&255]^l[g>>>8&255]^u[g>>>16&255]^f[g>>>24]}return r}function apply0123(e,t,r,n,o,a){return e[r<<8&65280|n>>>8&255]^t[o>>>8&65280|a>>>24&255]}function applySbox(e,t,r,n,o){return e[t&255|r&65280]|e[n>>>16&255|o>>>16&65280]<<16}function encrypt$3(e,t,r,n,o){const{sbox2:a,T01:l,T23:u}=tableEncoding;let f=0;t^=e[f++],r^=e[f++],n^=e[f++],o^=e[f++];const x=e.length/4-2;for(let w=0;w<x;w++){const v=e[f++]^apply0123(l,u,t,r,n,o),B=e[f++]^apply0123(l,u,r,n,o,t),j=e[f++]^apply0123(l,u,n,o,t,r),F=e[f++]^apply0123(l,u,o,t,r,n);t=v,r=B,n=j,o=F}const p=e[f++]^applySbox(a,t,r,n,o),g=e[f++]^applySbox(a,r,n,o,t),y=e[f++]^applySbox(a,n,o,t,r),b=e[f++]^applySbox(a,o,t,r,n);return{s0:p,s1:g,s2:y,s3:b}}function decrypt$3(e,t,r,n,o){const{sbox2:a,T01:l,T23:u}=tableDecoding;let f=0;t^=e[f++],r^=e[f++],n^=e[f++],o^=e[f++];const x=e.length/4-2;for(let w=0;w<x;w++){const v=e[f++]^apply0123(l,u,t,o,n,r),B=e[f++]^apply0123(l,u,r,t,o,n),j=e[f++]^apply0123(l,u,n,r,t,o),F=e[f++]^apply0123(l,u,o,n,r,t);t=v,r=B,n=j,o=F}const p=e[f++]^applySbox(a,t,o,n,r),g=e[f++]^applySbox(a,r,t,o,n),y=e[f++]^applySbox(a,n,r,t,o),b=e[f++]^applySbox(a,o,n,r,t);return{s0:p,s1:g,s2:y,s3:b}}function getDst(e,t){if(!t)return new Uint8Array(e);if(bytes(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function validateBlockDecrypt(e){if(bytes(e),e.length%BLOCK_SIZE!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${BLOCK_SIZE}`)}function validateBlockEncrypt(e,t,r){let n=e.length;const o=n%BLOCK_SIZE;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const a=u32(e);if(t){let f=BLOCK_SIZE-o;f||(f=BLOCK_SIZE),n=n+f}const l=getDst(n,r),u=u32(l);return{b:a,o:u,out:l}}function validatePCKS(e,t){if(!t)return e;const r=e.length;if(!r)throw new Error("aes/pcks5: empty ciphertext not allowed");const n=e[r-1];if(n<=0||n>16)throw new Error(`aes/pcks5: wrong padding byte: ${n}`);const o=e.subarray(0,-n);for(let a=0;a<n;a++)if(e[r-a-1]!==n)throw new Error("aes/pcks5: wrong padding");return o}function padPCKS(e){const t=new Uint8Array(16),r=u32(t);t.set(e);const n=BLOCK_SIZE-e.length;for(let o=BLOCK_SIZE-n;o<BLOCK_SIZE;o++)t[o]=n;return r}const cbc=wrapCipher({blockSize:16,nonceLength:16},function(t,r,n={}){bytes(t),bytes(r,16);const o=!n.disablePadding;return{encrypt:(a,l)=>{const u=expandKeyLE(t),{b:f,o:x,out:p}=validateBlockEncrypt(a,o,l),g=u32(r);let y=g[0],b=g[1],w=g[2],v=g[3],B=0;for(;B+4<=f.length;)y^=f[B+0],b^=f[B+1],w^=f[B+2],v^=f[B+3],{s0:y,s1:b,s2:w,s3:v}=encrypt$3(u,y,b,w,v),x[B++]=y,x[B++]=b,x[B++]=w,x[B++]=v;if(o){const j=padPCKS(a.subarray(B*4));y^=j[0],b^=j[1],w^=j[2],v^=j[3],{s0:y,s1:b,s2:w,s3:v}=encrypt$3(u,y,b,w,v),x[B++]=y,x[B++]=b,x[B++]=w,x[B++]=v}return u.fill(0),p},decrypt:(a,l)=>{validateBlockDecrypt(a);const u=expandKeyDecLE(t),f=u32(r),x=getDst(a.length,l),p=u32(a),g=u32(x);let y=f[0],b=f[1],w=f[2],v=f[3];for(let B=0;B+4<=p.length;){const j=y,F=b,C=w,N=v;y=p[B+0],b=p[B+1],w=p[B+2],v=p[B+3];const{s0:T,s1:_,s2:S,s3:O}=decrypt$3(u,y,b,w,v);g[B++]=T^j,g[B++]=_^F,g[B++]=S^C,g[B++]=O^N}return u.fill(0),validatePCKS(x,o)}}}),u8to16=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class Poly1305{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=toBytes$1(t),bytes(t,32);const r=u8to16(t,0),n=u8to16(t,2),o=u8to16(t,4),a=u8to16(t,6),l=u8to16(t,8),u=u8to16(t,10),f=u8to16(t,12),x=u8to16(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|a<<9)&8191,this.r[4]=(a>>>4|l<<12)&255,this.r[5]=l>>>1&8190,this.r[6]=(l>>>14|u<<2)&8191,this.r[7]=(u>>>11|f<<5)&8065,this.r[8]=(f>>>8|x<<8)&8191,this.r[9]=x>>>5&127;for(let p=0;p<8;p++)this.pad[p]=u8to16(t,16+2*p)}process(t,r,n=!1){const o=n?0:2048,{h:a,r:l}=this,u=l[0],f=l[1],x=l[2],p=l[3],g=l[4],y=l[5],b=l[6],w=l[7],v=l[8],B=l[9],j=u8to16(t,r+0),F=u8to16(t,r+2),C=u8to16(t,r+4),N=u8to16(t,r+6),T=u8to16(t,r+8),_=u8to16(t,r+10),S=u8to16(t,r+12),O=u8to16(t,r+14);let $=a[0]+(j&8191),z=a[1]+((j>>>13|F<<3)&8191),W=a[2]+((F>>>10|C<<6)&8191),U=a[3]+((C>>>7|N<<9)&8191),I=a[4]+((N>>>4|T<<12)&8191),G=a[5]+(T>>>1&8191),k=a[6]+((T>>>14|_<<2)&8191),M=a[7]+((_>>>11|S<<5)&8191),q=a[8]+((S>>>8|O<<8)&8191),K=a[9]+(O>>>5|o),H=0,Q=H+$*u+z*(5*B)+W*(5*v)+U*(5*w)+I*(5*b);H=Q>>>13,Q&=8191,Q+=G*(5*y)+k*(5*g)+M*(5*p)+q*(5*x)+K*(5*f),H+=Q>>>13,Q&=8191;let D=H+$*f+z*u+W*(5*B)+U*(5*v)+I*(5*w);H=D>>>13,D&=8191,D+=G*(5*b)+k*(5*y)+M*(5*g)+q*(5*p)+K*(5*x),H+=D>>>13,D&=8191;let Y=H+$*x+z*f+W*u+U*(5*B)+I*(5*v);H=Y>>>13,Y&=8191,Y+=G*(5*w)+k*(5*b)+M*(5*y)+q*(5*g)+K*(5*p),H+=Y>>>13,Y&=8191;let J=H+$*p+z*x+W*f+U*u+I*(5*B);H=J>>>13,J&=8191,J+=G*(5*v)+k*(5*w)+M*(5*b)+q*(5*y)+K*(5*g),H+=J>>>13,J&=8191;let L=H+$*g+z*p+W*x+U*f+I*u;H=L>>>13,L&=8191,L+=G*(5*B)+k*(5*v)+M*(5*w)+q*(5*b)+K*(5*y),H+=L>>>13,L&=8191;let Z=H+$*y+z*g+W*p+U*x+I*f;H=Z>>>13,Z&=8191,Z+=G*u+k*(5*B)+M*(5*v)+q*(5*w)+K*(5*b),H+=Z>>>13,Z&=8191;let oe=H+$*b+z*y+W*g+U*p+I*x;H=oe>>>13,oe&=8191,oe+=G*f+k*u+M*(5*B)+q*(5*v)+K*(5*w),H+=oe>>>13,oe&=8191;let ce=H+$*w+z*b+W*y+U*g+I*p;H=ce>>>13,ce&=8191,ce+=G*x+k*f+M*u+q*(5*B)+K*(5*v),H+=ce>>>13,ce&=8191;let de=H+$*v+z*w+W*b+U*y+I*g;H=de>>>13,de&=8191,de+=G*p+k*x+M*f+q*u+K*(5*B),H+=de>>>13,de&=8191;let xe=H+$*B+z*v+W*w+U*b+I*y;H=xe>>>13,xe&=8191,xe+=G*g+k*p+M*x+q*f+K*u,H+=xe>>>13,xe&=8191,H=(H<<2)+H|0,H=H+Q|0,Q=H&8191,H=H>>>13,D+=H,a[0]=Q,a[1]=D,a[2]=Y,a[3]=J,a[4]=L,a[5]=Z,a[6]=oe,a[7]=ce,a[8]=de,a[9]=xe}finalize(){const{h:t,pad:r}=this,n=new Uint16Array(10);let o=t[1]>>>13;t[1]&=8191;for(let u=2;u<10;u++)t[u]+=o,o=t[u]>>>13,t[u]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,n[0]=t[0]+5,o=n[0]>>>13,n[0]&=8191;for(let u=1;u<10;u++)n[u]=t[u]+o,o=n[u]>>>13,n[u]&=8191;n[9]-=8192;let a=(o^1)-1;for(let u=0;u<10;u++)n[u]&=a;a=~a;for(let u=0;u<10;u++)t[u]=t[u]&a|n[u];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let l=t[0]+r[0];t[0]=l&65535;for(let u=1;u<8;u++)l=(t[u]+r[u]|0)+(l>>>16)|0,t[u]=l&65535}update(t){exists(this);const{buffer:r,blockLen:n}=this;t=toBytes$1(t);const o=t.length;for(let a=0;a<o;){const l=Math.min(n-this.pos,o-a);if(l===n){for(;n<=o-a;a+=n)this.process(t,a);continue}r.set(t.subarray(a,a+l),this.pos),this.pos+=l,a+=l,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){exists(this),output(t,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let a=0;for(let l=0;l<8;l++)t[a++]=n[l]>>>0,t[a++]=n[l]>>>8;return t}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}}function wrapConstructorWithKey(e){const t=(n,o)=>e(o).update(toBytes$1(n)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}const poly1305=wrapConstructorWithKey(e=>new Poly1305(e)),_utf8ToBytes=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),sigma16=_utf8ToBytes("expand 16-byte k"),sigma32=_utf8ToBytes("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32);sigma32_32.slice();function rotl$2(e,t){return e<<t|e>>>32-t}function isAligned32(e){return e.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(e,t,r,n,o,a,l,u){const f=o.length,x=new Uint8Array(BLOCK_LEN),p=u32(x),g=isAligned32(o)&&isAligned32(a),y=g?u32(o):U32_EMPTY,b=g?u32(a):U32_EMPTY;for(let w=0;w<f;l++){if(e(t,r,n,p,l,u),l>=MAX_COUNTER)throw new Error("arx: counter overflow");const v=Math.min(BLOCK_LEN,f-w);if(g&&v===BLOCK_LEN){const B=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let j=0,F;j<BLOCK_LEN32;j++)F=B+j,b[F]=y[F]^p[j];w+=BLOCK_LEN;continue}for(let B=0,j;B<v;B++)j=w+B,a[j]=o[j]^x[B];w+=v}}function createCipher(e,t){const{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:a,rounds:l}=checkOpts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return number$2(o),number$2(l),bool(a),bool(r),(u,f,x,p,g=0)=>{bytes(u),bytes(f),bytes(x);const y=x.length;if(p||(p=new Uint8Array(y)),bytes(p),number$2(g),g<0||g>=MAX_COUNTER)throw new Error("arx: counter overflow");if(p.length<y)throw new Error(`arx: output (${p.length}) is shorter than data (${y})`);const b=[];let w=u.length,v,B;if(w===32)v=u.slice(),b.push(v),B=sigma32_32;else if(w===16&&r)v=new Uint8Array(32),v.set(u),v.set(u,16),B=sigma16_32,b.push(v);else throw new Error(`arx: invalid 32-byte key, got length=${w}`);isAligned32(f)||(f=f.slice(),b.push(f));const j=u32(v);if(n){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(B,j,u32(f.subarray(0,16)),j),f=f.subarray(16)}const F=16-o;if(F!==f.length)throw new Error(`arx: nonce must be ${F} or 16 bytes`);if(F!==12){const N=new Uint8Array(12);N.set(f,a?0:12-f.length),f=N,b.push(f)}const C=u32(f);for(runCipher(e,B,j,C,x,p,g,l);b.length>0;)b.pop().fill(0);return p}}function chachaCore(e,t,r,n,o,a=20){let l=e[0],u=e[1],f=e[2],x=e[3],p=t[0],g=t[1],y=t[2],b=t[3],w=t[4],v=t[5],B=t[6],j=t[7],F=o,C=r[0],N=r[1],T=r[2],_=l,S=u,O=f,$=x,z=p,W=g,U=y,I=b,G=w,k=v,M=B,q=j,K=F,H=C,Q=N,D=T;for(let J=0;J<a;J+=2)_=_+z|0,K=rotl$2(K^_,16),G=G+K|0,z=rotl$2(z^G,12),_=_+z|0,K=rotl$2(K^_,8),G=G+K|0,z=rotl$2(z^G,7),S=S+W|0,H=rotl$2(H^S,16),k=k+H|0,W=rotl$2(W^k,12),S=S+W|0,H=rotl$2(H^S,8),k=k+H|0,W=rotl$2(W^k,7),O=O+U|0,Q=rotl$2(Q^O,16),M=M+Q|0,U=rotl$2(U^M,12),O=O+U|0,Q=rotl$2(Q^O,8),M=M+Q|0,U=rotl$2(U^M,7),$=$+I|0,D=rotl$2(D^$,16),q=q+D|0,I=rotl$2(I^q,12),$=$+I|0,D=rotl$2(D^$,8),q=q+D|0,I=rotl$2(I^q,7),_=_+W|0,D=rotl$2(D^_,16),M=M+D|0,W=rotl$2(W^M,12),_=_+W|0,D=rotl$2(D^_,8),M=M+D|0,W=rotl$2(W^M,7),S=S+U|0,K=rotl$2(K^S,16),q=q+K|0,U=rotl$2(U^q,12),S=S+U|0,K=rotl$2(K^S,8),q=q+K|0,U=rotl$2(U^q,7),O=O+I|0,H=rotl$2(H^O,16),G=G+H|0,I=rotl$2(I^G,12),O=O+I|0,H=rotl$2(H^O,8),G=G+H|0,I=rotl$2(I^G,7),$=$+z|0,Q=rotl$2(Q^$,16),k=k+Q|0,z=rotl$2(z^k,12),$=$+z|0,Q=rotl$2(Q^$,8),k=k+Q|0,z=rotl$2(z^k,7);let Y=0;n[Y++]=l+_|0,n[Y++]=u+S|0,n[Y++]=f+O|0,n[Y++]=x+$|0,n[Y++]=p+z|0,n[Y++]=g+W|0,n[Y++]=y+U|0,n[Y++]=b+I|0,n[Y++]=w+G|0,n[Y++]=v+k|0,n[Y++]=B+M|0,n[Y++]=j+q|0,n[Y++]=F+K|0,n[Y++]=C+H|0,n[Y++]=N+Q|0,n[Y++]=T+D|0}function hchacha(e,t,r,n){let o=e[0],a=e[1],l=e[2],u=e[3],f=t[0],x=t[1],p=t[2],g=t[3],y=t[4],b=t[5],w=t[6],v=t[7],B=r[0],j=r[1],F=r[2],C=r[3];for(let T=0;T<20;T+=2)o=o+f|0,B=rotl$2(B^o,16),y=y+B|0,f=rotl$2(f^y,12),o=o+f|0,B=rotl$2(B^o,8),y=y+B|0,f=rotl$2(f^y,7),a=a+x|0,j=rotl$2(j^a,16),b=b+j|0,x=rotl$2(x^b,12),a=a+x|0,j=rotl$2(j^a,8),b=b+j|0,x=rotl$2(x^b,7),l=l+p|0,F=rotl$2(F^l,16),w=w+F|0,p=rotl$2(p^w,12),l=l+p|0,F=rotl$2(F^l,8),w=w+F|0,p=rotl$2(p^w,7),u=u+g|0,C=rotl$2(C^u,16),v=v+C|0,g=rotl$2(g^v,12),u=u+g|0,C=rotl$2(C^u,8),v=v+C|0,g=rotl$2(g^v,7),o=o+x|0,C=rotl$2(C^o,16),w=w+C|0,x=rotl$2(x^w,12),o=o+x|0,C=rotl$2(C^o,8),w=w+C|0,x=rotl$2(x^w,7),a=a+p|0,B=rotl$2(B^a,16),v=v+B|0,p=rotl$2(p^v,12),a=a+p|0,B=rotl$2(B^a,8),v=v+B|0,p=rotl$2(p^v,7),l=l+g|0,j=rotl$2(j^l,16),y=y+j|0,g=rotl$2(g^y,12),l=l+g|0,j=rotl$2(j^l,8),y=y+j|0,g=rotl$2(g^y,7),u=u+f|0,F=rotl$2(F^u,16),b=b+F|0,f=rotl$2(f^b,12),u=u+f|0,F=rotl$2(F^u,8),b=b+F|0,f=rotl$2(f^b,7);let N=0;n[N++]=o,n[N++]=a,n[N++]=l,n[N++]=u,n[N++]=B,n[N++]=j,n[N++]=F,n[N++]=C}const chacha20=createCipher(chachaCore,{counterRight:!1,counterLength:4,allowShortKeys:!1}),xchacha20=createCipher(chachaCore,{counterRight:!1,counterLength:8,extendNonceFn:hchacha,allowShortKeys:!1}),ZEROS16=new Uint8Array(16),updatePadded=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(ZEROS16.subarray(r))},ZEROS32=new Uint8Array(32);function computeTag(e,t,r,n,o){const a=e(t,r,ZEROS32),l=poly1305.create(a);o&&updatePadded(l,o),updatePadded(l,n);const u=new Uint8Array(16),f=createView$1(u);setBigUint64$1(f,0,BigInt(o?o.length:0),!0),setBigUint64$1(f,8,BigInt(n.length),!0),l.update(u);const x=l.digest();return a.fill(0),x}const _poly1305_aead=e=>(t,r,n)=>(bytes(t,32),bytes(r),{encrypt:(a,l)=>{const u=a.length,f=u+16;l?bytes(l,f):l=new Uint8Array(f),e(t,r,a,l,1);const x=computeTag(e,t,r,l.subarray(0,-16),n);return l.set(x,u),l},decrypt:(a,l)=>{const u=a.length,f=u-16;if(u<16)throw new Error("encrypted data must be at least 16 bytes");l?bytes(l,f):l=new Uint8Array(f);const x=a.subarray(0,-16),p=a.subarray(-16),g=computeTag(e,t,r,x,n);if(!equalBytes(p,g))throw new Error("invalid tag");return e(t,r,x,l,1),l}}),xchacha20poly1305=wrapCipher({blockSize:64,nonceLength:24,tagLength:16},_poly1305_aead(xchacha20));let HMAC$1=class extends Hash$1{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,assert$3.hash(t);const n=toBytes$2(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,a=new Uint8Array(o);a.set(n.length>o?t.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=t.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),a.fill(0)}update(t){return assert$3.exists(this),this.iHash.update(t),this}digestInto(t){assert$3.exists(this),assert$3.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:o,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=o,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$2=(e,t,r)=>new HMAC$1(e,t).update(r).digest();hmac$2.create=(e,t)=>new HMAC$1(e,t);function extract(e,t,r){return assert$3.hash(e),hmac$2(e,toBytes$2(r),toBytes$2(t))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER$3=new Uint8Array;function expand(e,t,r,n=32){if(assert$3.hash(e),assert$3.number(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(n/e.outputLen);r===void 0&&(r=EMPTY_BUFFER$3);const a=new Uint8Array(o*e.outputLen),l=hmac$2.create(e,t),u=l._cloneInto(),f=new Uint8Array(l.outputLen);for(let x=0;x<o;x++)HKDF_COUNTER[0]=x+1,u.update(x===0?EMPTY_BUFFER$3:f).update(r).update(HKDF_COUNTER).digestInto(f),a.set(f,e.outputLen*x),l._cloneInto(u);return l.destroy(),u.destroy(),f.fill(0),HKDF_COUNTER.fill(0),a.slice(0,n)}var __defProp$2=Object.defineProperty,__export=(e,t)=>{for(var r in t)__defProp$2(e,r,{get:t[r],enumerable:!0})},verifiedSymbol=Symbol("verified"),isRecord=e=>e instanceof Object;function validateEvent(e){if(!isRecord(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let r=e.tags[t];if(!Array.isArray(r))return!1;for(let n=0;n<r.length;n++)if(typeof r[n]!="string")return!1}return!0}var utils_exports={};__export(utils_exports,{Queue:()=>Queue$1,QueueNode:()=>QueueNode,binarySearch:()=>binarySearch,bytesToHex:()=>bytesToHex$2,hexToBytes:()=>hexToBytes$4,insertEventIntoAscendingList:()=>insertEventIntoAscendingList,insertEventIntoDescendingList:()=>insertEventIntoDescendingList,normalizeURL:()=>normalizeURL,utf8Decoder:()=>utf8Decoder$1,utf8Encoder:()=>utf8Encoder$1});var utf8Decoder$1=new TextDecoder("utf-8"),utf8Encoder$1=new TextEncoder;function normalizeURL(e){try{e.indexOf("://")===-1&&(e="wss://"+e);let t=new URL(e);return t.protocol==="http:"?t.protocol="ws:":t.protocol==="https:"&&(t.protocol="wss:"),t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}catch{throw new Error(`Invalid URL: ${e}`)}}function insertEventIntoDescendingList(e,t){const[r,n]=binarySearch(e,o=>t.id===o.id?0:t.created_at===o.created_at?-1:o.created_at-t.created_at);return n||e.splice(r,0,t),e}function insertEventIntoAscendingList(e,t){const[r,n]=binarySearch(e,o=>t.id===o.id?0:t.created_at===o.created_at?-1:t.created_at-o.created_at);return n||e.splice(r,0,t),e}function binarySearch(e,t){let r=0,n=e.length-1;for(;r<=n;){const o=Math.floor((r+n)/2),a=t(e[o]);if(a===0)return[o,!0];a<0?n=o-1:r=o+1}return[r,!1]}var QueueNode=class{value;next=null;prev=null;constructor(e){this.value=e}},Queue$1=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const r=new QueueNode(t);return this.last?this.last===this.first?(this.last=r,this.last.prev=this.first,this.first.next=r):(r.prev=this.last,this.last.next=r,this.last=r):(this.first=r,this.last=r),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const r=this.first;return this.first=null,this.last=null,r.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}},JS=class{generateSecretKey(){return schnorr$1.utils.randomPrivateKey()}getPublicKey(e){return bytesToHex$2(schnorr$1.getPublicKey(e))}finalizeEvent(e,t){const r=e;return r.pubkey=bytesToHex$2(schnorr$1.getPublicKey(t)),r.id=getEventHash$1(r),r.sig=bytesToHex$2(schnorr$1.sign(getEventHash$1(r),t)),r[verifiedSymbol]=!0,r}verifyEvent(e){if(typeof e[verifiedSymbol]=="boolean")return e[verifiedSymbol];const t=getEventHash$1(e);if(t!==e.id)return e[verifiedSymbol]=!1,!1;try{const r=schnorr$1.verify(e.sig,t,e.pubkey);return e[verifiedSymbol]=r,r}catch{return e[verifiedSymbol]=!1,!1}}};function serializeEvent(e){if(!validateEvent(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function getEventHash$1(e){let t=sha256$3(utf8Encoder$1.encode(serializeEvent(e)));return bytesToHex$2(t)}var i=new JS,generateSecretKey=i.generateSecretKey,getPublicKey=i.getPublicKey,finalizeEvent=i.finalizeEvent,verifyEvent=i.verifyEvent,kinds_exports={};__export(kinds_exports,{Application:()=>Application,BadgeAward:()=>BadgeAward,BadgeDefinition:()=>BadgeDefinition,BlockedRelaysList:()=>BlockedRelaysList,BookmarkList:()=>BookmarkList,Bookmarksets:()=>Bookmarksets,Calendar:()=>Calendar,CalendarEventRSVP:()=>CalendarEventRSVP,ChannelCreation:()=>ChannelCreation,ChannelHideMessage:()=>ChannelHideMessage,ChannelMessage:()=>ChannelMessage,ChannelMetadata:()=>ChannelMetadata,ChannelMuteUser:()=>ChannelMuteUser,ClassifiedListing:()=>ClassifiedListing,ClientAuth:()=>ClientAuth,CommunitiesList:()=>CommunitiesList,CommunityDefinition:()=>CommunityDefinition,CommunityPostApproval:()=>CommunityPostApproval,Contacts:()=>Contacts,CreateOrUpdateProduct:()=>CreateOrUpdateProduct,CreateOrUpdateStall:()=>CreateOrUpdateStall,Curationsets:()=>Curationsets,Date:()=>Date2,DirectMessageRelaysList:()=>DirectMessageRelaysList,DraftClassifiedListing:()=>DraftClassifiedListing,DraftLong:()=>DraftLong,Emojisets:()=>Emojisets,EncryptedDirectMessage:()=>EncryptedDirectMessage,EventDeletion:()=>EventDeletion,FileMetadata:()=>FileMetadata,FileServerPreference:()=>FileServerPreference,Followsets:()=>Followsets,GenericRepost:()=>GenericRepost,Genericlists:()=>Genericlists,GiftWrap:()=>GiftWrap,HTTPAuth:()=>HTTPAuth,Handlerinformation:()=>Handlerinformation,Handlerrecommendation:()=>Handlerrecommendation,Highlights:()=>Highlights,InterestsList:()=>InterestsList,Interestsets:()=>Interestsets,JobFeedback:()=>JobFeedback,JobRequest:()=>JobRequest,JobResult:()=>JobResult,Label:()=>Label,LightningPubRPC:()=>LightningPubRPC,LiveChatMessage:()=>LiveChatMessage,LiveEvent:()=>LiveEvent,LongFormArticle:()=>LongFormArticle,Metadata:()=>Metadata,Mutelist:()=>Mutelist,NWCWalletInfo:()=>NWCWalletInfo,NWCWalletRequest:()=>NWCWalletRequest,NWCWalletResponse:()=>NWCWalletResponse,NostrConnect:()=>NostrConnect,OpenTimestamps:()=>OpenTimestamps,Pinlist:()=>Pinlist,PrivateDirectMessage:()=>PrivateDirectMessage,ProblemTracker:()=>ProblemTracker,ProfileBadges:()=>ProfileBadges,PublicChatsList:()=>PublicChatsList,Reaction:()=>Reaction,RecommendRelay:()=>RecommendRelay,RelayList:()=>RelayList,Relaysets:()=>Relaysets,Report:()=>Report,Reporting:()=>Reporting,Repost:()=>Repost,Seal:()=>Seal,SearchRelaysList:()=>SearchRelaysList,ShortTextNote:()=>ShortTextNote,Time:()=>Time,UserEmojiList:()=>UserEmojiList,UserStatuses:()=>UserStatuses,Zap:()=>Zap$1,ZapGoal:()=>ZapGoal,ZapRequest:()=>ZapRequest,classifyKind:()=>classifyKind,isAddressableKind:()=>isAddressableKind,isEphemeralKind:()=>isEphemeralKind,isKind:()=>isKind,isRegularKind:()=>isRegularKind,isReplaceableKind:()=>isReplaceableKind});function isRegularKind(e){return e<1e4&&e!==0&&e!==3}function isReplaceableKind(e){return e===0||e===3||1e4<=e&&e<2e4}function isEphemeralKind(e){return 2e4<=e&&e<3e4}function isAddressableKind(e){return 3e4<=e&&e<4e4}function classifyKind(e){return isRegularKind(e)?"regular":isReplaceableKind(e)?"replaceable":isEphemeralKind(e)?"ephemeral":isAddressableKind(e)?"parameterized":"unknown"}function isKind(e,t){const r=t instanceof Array?t:[t];return validateEvent(e)&&r.includes(e.kind)||!1}var Metadata=0,ShortTextNote=1,RecommendRelay=2,Contacts=3,EncryptedDirectMessage=4,EventDeletion=5,Repost=6,Reaction=7,BadgeAward=8,Seal=13,PrivateDirectMessage=14,GenericRepost=16,ChannelCreation=40,ChannelMetadata=41,ChannelMessage=42,ChannelHideMessage=43,ChannelMuteUser=44,OpenTimestamps=1040,GiftWrap=1059,FileMetadata=1063,LiveChatMessage=1311,ProblemTracker=1971,Report=1984,Reporting=1984,Label=1985,CommunityPostApproval=4550,JobRequest=5999,JobResult=6999,JobFeedback=7e3,ZapGoal=9041,ZapRequest=9734,Zap$1=9735,Highlights=9802,Mutelist=1e4,Pinlist=10001,RelayList=10002,BookmarkList=10003,CommunitiesList=10004,PublicChatsList=10005,BlockedRelaysList=10006,SearchRelaysList=10007,InterestsList=10015,UserEmojiList=10030,DirectMessageRelaysList=10050,FileServerPreference=10096,NWCWalletInfo=13194,LightningPubRPC=21e3,ClientAuth=22242,NWCWalletRequest=23194,NWCWalletResponse=23195,NostrConnect=24133,HTTPAuth=27235,Followsets=3e4,Genericlists=30001,Relaysets=30002,Bookmarksets=30003,Curationsets=30004,ProfileBadges=30008,BadgeDefinition=30009,Interestsets=30015,CreateOrUpdateStall=30017,CreateOrUpdateProduct=30018,LongFormArticle=30023,DraftLong=30024,Emojisets=30030,Application=30078,LiveEvent=30311,UserStatuses=30315,ClassifiedListing=30402,DraftClassifiedListing=30403,Date2=31922,Time=31923,Calendar=31924,CalendarEventRSVP=31925,Handlerrecommendation=31989,Handlerinformation=31990,CommunityDefinition=34550;function matchFilter(e,t){if(e.ids&&e.ids.indexOf(t.id)===-1||e.kinds&&e.kinds.indexOf(t.kind)===-1||e.authors&&e.authors.indexOf(t.pubkey)===-1)return!1;for(let r in e)if(r[0]==="#"){let n=r.slice(1),o=e[`#${n}`];if(o&&!t.tags.find(([a,l])=>a===r.slice(1)&&o.indexOf(l)!==-1))return!1}return!(e.since&&t.created_at<e.since||e.until&&t.created_at>e.until)}function matchFilters(e,t){for(let r=0;r<e.length;r++)if(matchFilter(e[r],t))return!0;return!1}var fakejson_exports={};__export(fakejson_exports,{getHex64:()=>getHex64,getInt:()=>getInt,getSubscriptionId:()=>getSubscriptionId,matchEventId:()=>matchEventId,matchEventKind:()=>matchEventKind,matchEventPubkey:()=>matchEventPubkey});function getHex64(e,t){let r=t.length+3,n=e.indexOf(`"${t}":`)+r,o=e.slice(n).indexOf('"')+n+1;return e.slice(o,o+64)}function getInt(e,t){let r=t.length,n=e.indexOf(`"${t}":`)+r+3,o=e.slice(n),a=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,a),10)}function getSubscriptionId(e){let t=e.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let r=e.slice(t+7+1).indexOf('"');if(r===-1)return null;let n=t+7+1+r,o=e.slice(n+1,80).indexOf('"');if(o===-1)return null;let a=n+1+o;return e.slice(n+1,a)}function matchEventId(e,t){return t===getHex64(e,"id")}function matchEventPubkey(e,t){return t===getHex64(e,"pubkey")}function matchEventKind(e,t){return t===getInt(e,"kind")}var nip42_exports={};__export(nip42_exports,{makeAuthEvent:()=>makeAuthEvent});function makeAuthEvent(e,t){return{kind:ClientAuth,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}var _WebSocket;try{_WebSocket=WebSocket}catch{}var _WebSocket2;try{_WebSocket2=WebSocket}catch{}var nip19_exports$1={};__export(nip19_exports$1,{BECH32_REGEX:()=>BECH32_REGEX$2,Bech32MaxSize:()=>Bech32MaxSize$2,NostrTypeGuard:()=>NostrTypeGuard$1,decode:()=>decode$j,decodeNostrURI:()=>decodeNostrURI$1,encodeBytes:()=>encodeBytes$2,naddrEncode:()=>naddrEncode$1,neventEncode:()=>neventEncode$1,noteEncode:()=>noteEncode$1,nprofileEncode:()=>nprofileEncode$1,npubEncode:()=>npubEncode$1,nsecEncode:()=>nsecEncode$1});var NostrTypeGuard$1={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},Bech32MaxSize$2=5e3,BECH32_REGEX$2=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array$1(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function decodeNostrURI$1(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),decode$j(e)}catch{return{type:"invalid",data:null}}}function decode$j(e){let{prefix:t,words:r}=bech32.decode(e,Bech32MaxSize$2),n=new Uint8Array(bech32.fromWords(r));switch(t){case"nprofile":{let o=parseTLV$1(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$2(o[0][0]),relays:o[1]?o[1].map(a=>utf8Decoder$1.decode(a)):[]}}}case"nevent":{let o=parseTLV$1(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$2(o[0][0]),relays:o[1]?o[1].map(a=>utf8Decoder$1.decode(a)):[],author:o[2]?.[0]?bytesToHex$2(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(bytesToHex$2(o[3][0]),16):void 0}}}case"naddr":{let o=parseTLV$1(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder$1.decode(o[0][0]),pubkey:bytesToHex$2(o[2][0]),kind:parseInt(bytesToHex$2(o[3][0]),16),relays:o[1]?o[1].map(a=>utf8Decoder$1.decode(a)):[]}}}case"nsec":return{type:t,data:n};case"npub":case"note":return{type:t,data:bytesToHex$2(n)};default:throw new Error(`unknown prefix ${t}`)}}function parseTLV$1(e){let t={},r=e;for(;r.length>0;){let n=r[0],o=r[1],a=r.slice(2,2+o);if(r=r.slice(2+o),a.length<o)throw new Error(`not enough data to read on TLV ${n}`);t[n]=t[n]||[],t[n].push(a)}return t}function nsecEncode$1(e){return encodeBytes$2("nsec",e)}function npubEncode$1(e){return encodeBytes$2("npub",hexToBytes$4(e))}function noteEncode$1(e){return encodeBytes$2("note",hexToBytes$4(e))}function encodeBech32$2(e,t){let r=bech32.toWords(t);return bech32.encode(e,r,Bech32MaxSize$2)}function encodeBytes$2(e,t){return encodeBech32$2(e,t)}function nprofileEncode$1(e){let t=encodeTLV$1({0:[hexToBytes$4(e.pubkey)],1:(e.relays||[]).map(r=>utf8Encoder$1.encode(r))});return encodeBech32$2("nprofile",t)}function neventEncode$1(e){let t;e.kind!==void 0&&(t=integerToUint8Array$1(e.kind));let r=encodeTLV$1({0:[hexToBytes$4(e.id)],1:(e.relays||[]).map(n=>utf8Encoder$1.encode(n)),2:e.author?[hexToBytes$4(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return encodeBech32$2("nevent",r)}function naddrEncode$1(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let r=encodeTLV$1({0:[utf8Encoder$1.encode(e.identifier)],1:(e.relays||[]).map(n=>utf8Encoder$1.encode(n)),2:[hexToBytes$4(e.pubkey)],3:[new Uint8Array(t)]});return encodeBech32$2("naddr",r)}function encodeTLV$1(e){let t=[];return Object.entries(e).reverse().forEach(([r,n])=>{n.forEach(o=>{let a=new Uint8Array(o.length+2);a.set([parseInt(r)],0),a.set([o.length],1),a.set(o,2),t.push(a)})}),concatBytes$1(...t)}var nip04_exports={};__export(nip04_exports,{decrypt:()=>decrypt$2,encrypt:()=>encrypt$2});function encrypt$2(e,t,r){const n=e instanceof Uint8Array?bytesToHex$2(e):e,o=secp256k1$2.getSharedSecret(n,"02"+t),a=getNormalizedX(o);let l=Uint8Array.from(randomBytes$1(16)),u=utf8Encoder$1.encode(r),f=cbc(a,l).encrypt(u),x=base64.encode(new Uint8Array(f)),p=base64.encode(new Uint8Array(l.buffer));return`${x}?iv=${p}`}function decrypt$2(e,t,r){const n=e instanceof Uint8Array?bytesToHex$2(e):e;let[o,a]=r.split("?iv="),l=secp256k1$2.getSharedSecret(n,"02"+t),u=getNormalizedX(l),f=base64.decode(a),x=base64.decode(o),p=cbc(u,f).decrypt(x);return utf8Decoder$1.decode(p)}function getNormalizedX(e){return e.slice(1,33)}var nip05_exports={};__export(nip05_exports,{NIP05_REGEX:()=>NIP05_REGEX$1,isNip05:()=>isNip05,isValid:()=>isValid,queryProfile:()=>queryProfile,searchDomain:()=>searchDomain,useFetchImplementation:()=>useFetchImplementation});var NIP05_REGEX$1=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,isNip05=e=>NIP05_REGEX$1.test(e||""),_fetch;try{_fetch=fetch}catch{}function useFetchImplementation(e){_fetch=e}async function searchDomain(e,t=""){try{const r=`https://${e}/.well-known/nostr.json?name=${t}`,n=await _fetch(r,{redirect:"manual"});if(n.status!==200)throw Error("Wrong response code");return(await n.json()).names}catch{return{}}}async function queryProfile(e){const t=e.match(NIP05_REGEX$1);if(!t)return null;const[,r="_",n]=t;try{const o=`https://${n}/.well-known/nostr.json?name=${r}`,a=await _fetch(o,{redirect:"manual"});if(a.status!==200)throw Error("Wrong response code");const l=await a.json(),u=l.names[r];return u?{pubkey:u,relays:l.relays?.[u]}:null}catch{return null}}async function isValid(e,t){const r=await queryProfile(t);return r?r.pubkey===e:!1}var nip10_exports={};__export(nip10_exports,{parse:()=>parse$2});function parse$2(e){const t={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let r,n;for(let o=e.tags.length-1;o>=0;o--){const a=e.tags[o];if(a[0]==="e"&&a[1]){const[l,u,f,x,p]=a,g={id:u,relays:f?[f]:[],author:p};if(x==="root"){t.root=g;continue}if(x==="reply"){t.reply=g;continue}if(x==="mention"){t.mentions.push(g);continue}r?n=g:r=g,t.mentions.push(g);continue}if(a[0]==="q"&&a[1]){const[l,u,f]=a;t.quotes.push({id:u,relays:f?[f]:[]})}if(a[0]==="p"&&a[1]){t.profiles.push({pubkey:a[1],relays:a[2]?[a[2]]:[]});continue}}return t.root||(t.root=n||r||t.reply),t.reply||(t.reply=r||t.root),[t.reply,t.root].forEach(o=>{if(!o)return;let a=t.mentions.indexOf(o);if(a!==-1&&t.mentions.splice(a,1),o.author){let l=t.profiles.find(u=>u.pubkey===o.author);l&&l.relays&&(o.relays||(o.relays=[]),l.relays.forEach(u=>{o.relays?.indexOf(u)===-1&&o.relays.push(u)}),l.relays=o.relays)}}),t.mentions.forEach(o=>{if(o.author){let a=t.profiles.find(l=>l.pubkey===o.author);a&&a.relays&&(o.relays||(o.relays=[]),a.relays.forEach(l=>{o.relays.indexOf(l)===-1&&o.relays.push(l)}),a.relays=o.relays)}}),t}var nip11_exports={};__export(nip11_exports,{fetchRelayInformation:()=>fetchRelayInformation$1,useFetchImplementation:()=>useFetchImplementation2});var _fetch2;try{_fetch2=fetch}catch{}function useFetchImplementation2(e){_fetch2=e}async function fetchRelayInformation$1(e){return await(await fetch(e.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var nip13_exports={};__export(nip13_exports,{fastEventHash:()=>fastEventHash,getPow:()=>getPow,minePow:()=>minePow});function getPow(e){let t=0;for(let r=0;r<64;r+=8){const n=parseInt(e.substring(r,r+8),16);if(n===0)t+=32;else{t+=Math.clz32(n);break}}return t}function minePow(e,t){let r=0;const n=e,o=["nonce",r.toString(),t.toString()];for(n.tags.push(o);;){const a=Math.floor(new Date().getTime()/1e3);if(a!==n.created_at&&(r=0,n.created_at=a),o[1]=(++r).toString(),n.id=fastEventHash(n),getPow(n.id)>=t)break}return n}function fastEventHash(e){return bytesToHex$2(sha256$3(utf8Encoder$1.encode(JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content]))))}var nip17_exports={};__export(nip17_exports,{unwrapEvent:()=>unwrapEvent2,unwrapManyEvents:()=>unwrapManyEvents2,wrapEvent:()=>wrapEvent2,wrapManyEvents:()=>wrapManyEvents2});var nip59_exports={};__export(nip59_exports,{createRumor:()=>createRumor,createSeal:()=>createSeal,createWrap:()=>createWrap,unwrapEvent:()=>unwrapEvent,unwrapManyEvents:()=>unwrapManyEvents,wrapEvent:()=>wrapEvent$1,wrapManyEvents:()=>wrapManyEvents});var nip44_exports={};__export(nip44_exports,{decrypt:()=>decrypt2,encrypt:()=>encrypt2,getConversationKey:()=>getConversationKey,v2:()=>v2});var minPlaintextSize=1,maxPlaintextSize=65535;function getConversationKey(e,t){const r=secp256k1$2.getSharedSecret(e,"02"+t).subarray(1,33);return extract(sha256$3,r,"nip44-v2")}function getMessageKeys(e,t){const r=expand(sha256$3,e,t,76);return{chacha_key:r.subarray(0,32),chacha_nonce:r.subarray(32,44),hmac_key:r.subarray(44,76)}}function calcPaddedLen(e){if(!Number.isSafeInteger(e)||e<1)throw new Error("expected positive integer");if(e<=32)return 32;const t=1<<Math.floor(Math.log2(e-1))+1,r=t<=256?32:t/8;return r*(Math.floor((e-1)/r)+1)}function writeU16BE(e){if(!Number.isSafeInteger(e)||e<minPlaintextSize||e>maxPlaintextSize)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function pad(e){const t=utf8Encoder$1.encode(e),r=t.length,n=writeU16BE(r),o=new Uint8Array(calcPaddedLen(r)-r);return concatBytes$1(n,t,o)}function unpad(e){const t=new DataView(e.buffer).getUint16(0),r=e.subarray(2,2+t);if(t<minPlaintextSize||t>maxPlaintextSize||r.length!==t||e.length!==2+calcPaddedLen(t))throw new Error("invalid padding");return utf8Decoder$1.decode(r)}function hmacAad(e,t,r){if(r.length!==32)throw new Error("AAD associated data must be 32 bytes");const n=concatBytes$1(r,t);return hmac$2(sha256$3,e,n)}function decodePayload(e){if(typeof e!="string")throw new Error("payload must be a valid string");const t=e.length;if(t<132||t>87472)throw new Error("invalid payload length: "+t);if(e[0]==="#")throw new Error("unknown encryption version");let r;try{r=base64.decode(e)}catch(a){throw new Error("invalid base64: "+a.message)}const n=r.length;if(n<99||n>65603)throw new Error("invalid data length: "+n);const o=r[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:r.subarray(1,33),ciphertext:r.subarray(33,-32),mac:r.subarray(-32)}}function encrypt2(e,t,r=randomBytes$1(32)){const{chacha_key:n,chacha_nonce:o,hmac_key:a}=getMessageKeys(t,r),l=pad(e),u=chacha20(n,o,l),f=hmacAad(a,u,r);return base64.encode(concatBytes$1(new Uint8Array([2]),r,u,f))}function decrypt2(e,t){const{nonce:r,ciphertext:n,mac:o}=decodePayload(e),{chacha_key:a,chacha_nonce:l,hmac_key:u}=getMessageKeys(t,r),f=hmacAad(u,n,r);if(!equalBytes(f,o))throw new Error("invalid MAC");const x=chacha20(a,l,n);return unpad(x)}var v2={utils:{getConversationKey,calcPaddedLen},encrypt:encrypt2,decrypt:decrypt2},TWO_DAYS=2880*60,now=()=>Math.round(Date.now()/1e3),randomNow=()=>Math.round(now()-Math.random()*TWO_DAYS),nip44ConversationKey=(e,t)=>getConversationKey(e,t),nip44Encrypt=(e,t,r)=>encrypt2(JSON.stringify(e),nip44ConversationKey(t,r)),nip44Decrypt=(e,t)=>JSON.parse(decrypt2(e.content,nip44ConversationKey(t,e.pubkey)));function createRumor(e,t){const r={created_at:now(),content:"",tags:[],...e,pubkey:getPublicKey(t)};return r.id=getEventHash$1(r),r}function createSeal(e,t,r){return finalizeEvent({kind:Seal,content:nip44Encrypt(e,t,r),created_at:randomNow(),tags:[]},t)}function createWrap(e,t){const r=generateSecretKey();return finalizeEvent({kind:GiftWrap,content:nip44Encrypt(e,r,t),created_at:randomNow(),tags:[["p",t]]},r)}function wrapEvent$1(e,t,r){const n=createRumor(e,t),o=createSeal(n,t,r);return createWrap(o,r)}function wrapManyEvents(e,t,r){if(!r||r.length===0)throw new Error("At least one recipient is required.");const n=getPublicKey(t),o=[wrapEvent$1(e,t,n)];return r.forEach(a=>{o.push(wrapEvent$1(e,t,a))}),o}function unwrapEvent(e,t){const r=nip44Decrypt(e,t);return nip44Decrypt(r,t)}function unwrapManyEvents(e,t){let r=[];return e.forEach(n=>{r.push(unwrapEvent(n,t))}),r.sort((n,o)=>n.created_at-o.created_at),r}function createEvent(e,t,r,n){const o={created_at:Math.ceil(Date.now()/1e3),kind:PrivateDirectMessage,tags:[],content:t};return(Array.isArray(e)?e:[e]).forEach(({publicKey:l,relayUrl:u})=>{o.tags.push(u?["p",l,u]:["p",l])}),n&&o.tags.push(["e",n.eventId,n.relayUrl||"","reply"]),r&&o.tags.push(["subject",r]),o}function wrapEvent2(e,t,r,n,o){const a=createEvent(t,r,n,o);return wrapEvent$1(a,e,t.publicKey)}function wrapManyEvents2(e,t,r,n,o){if(!t||t.length===0)throw new Error("At least one recipient is required.");return[{publicKey:getPublicKey(e)},...t].map(l=>wrapEvent2(e,l,r,n,o))}var unwrapEvent2=unwrapEvent,unwrapManyEvents2=unwrapManyEvents,nip18_exports={};__export(nip18_exports,{finishRepostEvent:()=>finishRepostEvent,getRepostedEvent:()=>getRepostedEvent,getRepostedEventPointer:()=>getRepostedEventPointer});function finishRepostEvent(e,t,r,n){let o;const a=[...e.tags??[],["e",t.id,r],["p",t.pubkey]];return t.kind===ShortTextNote?o=Repost:(o=GenericRepost,a.push(["k",String(t.kind)])),finalizeEvent({kind:o,tags:a,content:e.content===""||t.tags?.find(l=>l[0]==="-")?"":JSON.stringify(t),created_at:e.created_at},n)}function getRepostedEventPointer(e){if(![Repost,GenericRepost].includes(e.kind))return;let t,r;for(let n=e.tags.length-1;n>=0&&(t===void 0||r===void 0);n--){const o=e.tags[n];o.length>=2&&(o[0]==="e"&&t===void 0?t=o:o[0]==="p"&&r===void 0&&(r=o))}if(t!==void 0)return{id:t[1],relays:[t[2],r?.[2]].filter(n=>typeof n=="string"),author:r?.[1]}}function getRepostedEvent(e,{skipVerification:t}={}){const r=getRepostedEventPointer(e);if(r===void 0||e.content==="")return;let n;try{n=JSON.parse(e.content)}catch{return}if(n.id===r.id&&!(!t&&!verifyEvent(n)))return n}var nip21_exports={};__export(nip21_exports,{NOSTR_URI_REGEX:()=>NOSTR_URI_REGEX,parse:()=>parse2,test:()=>test});var NOSTR_URI_REGEX=new RegExp(`nostr:(${BECH32_REGEX$2.source})`);function test(e){return typeof e=="string"&&new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(e)}function parse2(e){const t=e.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));if(!t)throw new Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:decode$j(t[1])}}var nip25_exports={};__export(nip25_exports,{finishReactionEvent:()=>finishReactionEvent,getReactedEventPointer:()=>getReactedEventPointer});function finishReactionEvent(e,t,r){const n=t.tags.filter(o=>o.length>=2&&(o[0]==="e"||o[0]==="p"));return finalizeEvent({...e,kind:Reaction,tags:[...e.tags??[],...n,["e",t.id],["p",t.pubkey]],content:e.content??"+"},r)}function getReactedEventPointer(e){if(e.kind!==Reaction)return;let t,r;for(let n=e.tags.length-1;n>=0&&(t===void 0||r===void 0);n--){const o=e.tags[n];o.length>=2&&(o[0]==="e"&&t===void 0?t=o:o[0]==="p"&&r===void 0&&(r=o))}if(!(t===void 0||r===void 0))return{id:t[1],relays:[t[2],r[2]].filter(n=>n!==void 0),author:r[1]}}var nip27_exports={};__export(nip27_exports,{parse:()=>parse3});var noCharacter=/\W/m,noURLCharacter=/\W |\W$|$|,| /m,MAX_HASHTAG_LENGTH=42;function*parse3(e){let t=[];if(typeof e!="string"){for(let a=0;a<e.tags.length;a++){const l=e.tags[a];l[0]==="emoji"&&l.length>=3&&t.push({type:"emoji",shortcode:l[1],url:l[2]})}e=e.content}const r=e.length;let n=0,o=0;e:for(;o<r;){const a=e.indexOf(":",o),l=e.indexOf("#",o);if(a===-1&&l===-1)break e;if(a===-1||l>=0&&l<a){if(l===0||e[l-1]===" "){const u=e.slice(l+1,l+MAX_HASHTAG_LENGTH).match(noCharacter),f=u?l+1+u.index:r;yield{type:"text",text:e.slice(n,l)},yield{type:"hashtag",value:e.slice(l+1,f)},o=f,n=o;continue e}o=l+1;continue e}if(e.slice(a-5,a)==="nostr"){const u=e.slice(a+60).match(noCharacter),f=u?a+60+u.index:r;try{let x,{data:p,type:g}=decode$j(e.slice(a+1,f));switch(g){case"npub":x={pubkey:p};break;case"nsec":case"note":o=f+1;continue;default:x=p}n!==a-5&&(yield{type:"text",text:e.slice(n,a-5)}),yield{type:"reference",pointer:x},o=f,n=o;continue e}catch{o=a+1;continue e}}else if(e.slice(a-5,a)==="https"||e.slice(a-4,a)==="http"){const u=e.slice(a+4).match(noURLCharacter),f=u?a+4+u.index:r,x=e[a-1]==="s"?5:4;try{let p=new URL(e.slice(a-x,f));if(p.hostname.indexOf(".")===-1)throw new Error("invalid url");if(n!==a-x&&(yield{type:"text",text:e.slice(n,a-x)}),/\.(png|jpe?g|gif|webp|heic|svg)$/i.test(p.pathname)){yield{type:"image",url:p.toString()},o=f,n=o;continue e}if(/\.(mp4|avi|webm|mkv|mov)$/i.test(p.pathname)){yield{type:"video",url:p.toString()},o=f,n=o;continue e}if(/\.(mp3|aac|ogg|opus|wav|flac)$/i.test(p.pathname)){yield{type:"audio",url:p.toString()},o=f,n=o;continue e}yield{type:"url",url:p.toString()},o=f,n=o;continue e}catch{o=f+1;continue e}}else if(e.slice(a-3,a)==="wss"||e.slice(a-2,a)==="ws"){const u=e.slice(a+4).match(noURLCharacter),f=u?a+4+u.index:r,x=e[a-1]==="s"?3:2;try{let p=new URL(e.slice(a-x,f));if(p.hostname.indexOf(".")===-1)throw new Error("invalid ws url");n!==a-x&&(yield{type:"text",text:e.slice(n,a-x)}),yield{type:"relay",url:p.toString()},o=f,n=o;continue e}catch{o=f+1;continue e}}else{for(let u=0;u<t.length;u++){const f=t[u];if(e[a+f.shortcode.length+1]===":"&&e.slice(a+1,a+f.shortcode.length+1)===f.shortcode){n!==a&&(yield{type:"text",text:e.slice(n,a)}),yield f,o=a+f.shortcode.length+2,n=o;continue e}}o=a+1;continue e}}n!==r&&(yield{type:"text",text:e.slice(n)})}var nip28_exports={};__export(nip28_exports,{channelCreateEvent:()=>channelCreateEvent,channelHideMessageEvent:()=>channelHideMessageEvent,channelMessageEvent:()=>channelMessageEvent,channelMetadataEvent:()=>channelMetadataEvent,channelMuteUserEvent:()=>channelMuteUserEvent});var channelCreateEvent=(e,t)=>{let r;if(typeof e.content=="object")r=JSON.stringify(e.content);else if(typeof e.content=="string")r=e.content;else return;return finalizeEvent({kind:ChannelCreation,tags:[...e.tags??[]],content:r,created_at:e.created_at},t)},channelMetadataEvent=(e,t)=>{let r;if(typeof e.content=="object")r=JSON.stringify(e.content);else if(typeof e.content=="string")r=e.content;else return;return finalizeEvent({kind:ChannelMetadata,tags:[["e",e.channel_create_event_id],...e.tags??[]],content:r,created_at:e.created_at},t)},channelMessageEvent=(e,t)=>{const r=[["e",e.channel_create_event_id,e.relay_url,"root"]];return e.reply_to_channel_message_event_id&&r.push(["e",e.reply_to_channel_message_event_id,e.relay_url,"reply"]),finalizeEvent({kind:ChannelMessage,tags:[...r,...e.tags??[]],content:e.content,created_at:e.created_at},t)},channelHideMessageEvent=(e,t)=>{let r;if(typeof e.content=="object")r=JSON.stringify(e.content);else if(typeof e.content=="string")r=e.content;else return;return finalizeEvent({kind:ChannelHideMessage,tags:[["e",e.channel_message_event_id],...e.tags??[]],content:r,created_at:e.created_at},t)},channelMuteUserEvent=(e,t)=>{let r;if(typeof e.content=="object")r=JSON.stringify(e.content);else if(typeof e.content=="string")r=e.content;else return;return finalizeEvent({kind:ChannelMuteUser,tags:[["p",e.pubkey_to_mute],...e.tags??[]],content:r,created_at:e.created_at},t)},nip30_exports={};__export(nip30_exports,{EMOJI_SHORTCODE_REGEX:()=>EMOJI_SHORTCODE_REGEX,matchAll:()=>matchAll,regex:()=>regex$2,replaceAll:()=>replaceAll});var EMOJI_SHORTCODE_REGEX=/:(\w+):/,regex$2=()=>new RegExp(`\\B${EMOJI_SHORTCODE_REGEX.source}\\B`,"g");function*matchAll(e){const t=e.matchAll(regex$2());for(const r of t)try{const[n,o]=r;yield{shortcode:n,name:o,start:r.index,end:r.index+n.length}}catch{}}function replaceAll(e,t){return e.replaceAll(regex$2(),(r,n)=>t({shortcode:r,name:n}))}var nip39_exports={};__export(nip39_exports,{useFetchImplementation:()=>useFetchImplementation3,validateGithub:()=>validateGithub});var _fetch3;try{_fetch3=fetch}catch{}function useFetchImplementation3(e){_fetch3=e}async function validateGithub(e,t,r){try{return await(await _fetch3(`https://gist.github.com/${t}/${r}/raw`)).text()===`Verifying that I control the following Nostr public key: ${e}`}catch{return!1}}var nip47_exports={};__export(nip47_exports,{makeNwcRequestEvent:()=>makeNwcRequestEvent,parseConnectionString:()=>parseConnectionString});function parseConnectionString(e){const{host:t,pathname:r,searchParams:n}=new URL(e),o=r||t,a=n.get("relay"),l=n.get("secret");if(!o||!a||!l)throw new Error("invalid connection string");return{pubkey:o,relay:a,secret:l}}async function makeNwcRequestEvent(e,t,r){const o=encrypt$2(t,e,JSON.stringify({method:"pay_invoice",params:{invoice:r}})),a={kind:NWCWalletRequest,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e]]};return finalizeEvent(a,t)}var nip54_exports={};__export(nip54_exports,{normalizeIdentifier:()=>normalizeIdentifier});function normalizeIdentifier(e){return e=e.trim().toLowerCase(),e=e.normalize("NFKC"),Array.from(e).map(t=>new RegExp("\\p{Letter}","u").test(t)||new RegExp("\\p{Number}","u").test(t)?t:"-").join("")}var nip57_exports={};__export(nip57_exports,{getSatoshisAmountFromBolt11:()=>getSatoshisAmountFromBolt11,getZapEndpoint:()=>getZapEndpoint,makeZapReceipt:()=>makeZapReceipt,makeZapRequest:()=>makeZapRequest,useFetchImplementation:()=>useFetchImplementation4,validateZapRequest:()=>validateZapRequest});var _fetch4;try{_fetch4=fetch}catch{}function useFetchImplementation4(e){_fetch4=e}async function getZapEndpoint(e){try{let t="",{lud06:r,lud16:n}=JSON.parse(e.content);if(n){let[l,u]=n.split("@");t=new URL(`/.well-known/lnurlp/${l}`,`https://${u}`).toString()}else if(r){let{words:l}=bech32.decode(r,1e3),u=bech32.fromWords(l);t=utf8Decoder$1.decode(u)}else return null;let a=await(await _fetch4(t)).json();if(a.allowsNostr&&a.nostrPubkey)return a.callback}catch{}return null}function makeZapRequest(e){let t={kind:9734,created_at:Math.round(Date.now()/1e3),content:e.comment||"",tags:[["p","pubkey"in e?e.pubkey:e.event.pubkey],["amount",e.amount.toString()],["relays",...e.relays]]};if("event"in e){if(t.tags.push(["e",e.event.id]),isReplaceableKind(e.event.kind)){const r=["a",`${e.event.kind}:${e.event.pubkey}:`];t.tags.push(r)}else if(isAddressableKind(e.event.kind)){let r=e.event.tags.find(([o,a])=>o==="d"&&a);if(!r)throw new Error("d tag not found or is empty");const n=["a",`${e.event.kind}:${e.event.pubkey}:${r[1]}`];t.tags.push(n)}t.tags.push(["k",e.event.kind.toString()])}return t}function validateZapRequest(e){let t;try{t=JSON.parse(e)}catch{return"Invalid zap request JSON."}if(!validateEvent(t))return"Zap request is not a valid Nostr event.";if(!verifyEvent(t))return"Invalid signature on zap request.";let r=t.tags.find(([a,l])=>a==="p"&&l);if(!r)return"Zap request doesn't have a 'p' tag.";if(!r[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let n=t.tags.find(([a,l])=>a==="e"&&l);return n&&!n[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find(([a,l])=>a==="relays"&&l)?null:"Zap request doesn't have a 'relays' tag."}function makeZapReceipt({zapRequest:e,preimage:t,bolt11:r,paidAt:n}){let o=JSON.parse(e),a=o.tags.filter(([u])=>u==="e"||u==="p"||u==="a"),l={kind:9735,created_at:Math.round(n.getTime()/1e3),content:"",tags:[...a,["P",o.pubkey],["bolt11",r],["description",e]]};return t&&l.tags.push(["preimage",t]),l}function getSatoshisAmountFromBolt11(e){if(e.length<50)return 0;e=e.substring(0,50);const t=e.lastIndexOf("1");if(t===-1)return 0;const r=e.substring(0,t);if(!r.startsWith("lnbc"))return 0;const n=r.substring(4);if(n.length<1)return 0;const o=n[n.length-1],a=o.charCodeAt(0)-48,l=a>=0&&a<=9;let u=n.length-1;if(l&&u++,u<1)return 0;const f=parseInt(n.substring(0,u));switch(o){case"m":return f*1e5;case"u":return f*100;case"n":return f/10;case"p":return f/1e4;default:return f*1e8}}var nip77_exports={};__export(nip77_exports,{Negentropy:()=>Negentropy,NegentropyStorageVector:()=>NegentropyStorageVector,NegentropySync:()=>NegentropySync});var PROTOCOL_VERSION=97,ID_SIZE=32,FINGERPRINT_SIZE=16,Mode={Skip:0,Fingerprint:1,IdList:2},WrappedBuffer=class{_raw;length;constructor(e){typeof e=="number"?(this._raw=new Uint8Array(e),this.length=0):e instanceof Uint8Array?(this._raw=new Uint8Array(e),this.length=e.length):(this._raw=new Uint8Array(512),this.length=0)}unwrap(){return this._raw.subarray(0,this.length)}get capacity(){return this._raw.byteLength}extend(e){if(e instanceof WrappedBuffer&&(e=e.unwrap()),typeof e.length!="number")throw Error("bad length");const t=e.length+this.length;if(this.capacity<t){const r=this._raw,n=Math.max(this.capacity*2,t);this._raw=new Uint8Array(n),this._raw.set(r)}this._raw.set(e,this.length),this.length+=e.length}shift(){const e=this._raw[0];return this._raw=this._raw.subarray(1),this.length--,e}shiftN(e=1){const t=this._raw.subarray(0,e);return this._raw=this._raw.subarray(e),this.length-=e,t}};function decodeVarInt(e){let t=0;for(;;){if(e.length===0)throw Error("parse ends prematurely");let r=e.shift();if(t=t<<7|r&127,(r&128)===0)break}return t}function encodeVarInt(e){if(e===0)return new WrappedBuffer(new Uint8Array([0]));let t=[];for(;e!==0;)t.push(e&127),e>>>=7;t.reverse();for(let r=0;r<t.length-1;r++)t[r]|=128;return new WrappedBuffer(new Uint8Array(t))}function getByte(e){return getBytes(e,1)[0]}function getBytes(e,t){if(e.length<t)throw Error("parse ends prematurely");return e.shiftN(t)}var Accumulator=class{buf;constructor(){this.setToZero()}setToZero(){this.buf=new Uint8Array(ID_SIZE)}add(e){let t=0,r=0,n=new DataView(this.buf.buffer),o=new DataView(e.buffer);for(let a=0;a<8;a++){let l=a*4,u=n.getUint32(l,!0),f=o.getUint32(l,!0),x=u;x+=t,x+=f,x>4294967295&&(r=1),n.setUint32(l,x&4294967295,!0),t=r,r=0}}negate(){let e=new DataView(this.buf.buffer);for(let r=0;r<8;r++){let n=r*4;e.setUint32(n,~e.getUint32(n,!0))}let t=new Uint8Array(ID_SIZE);t[0]=1,this.add(t)}getFingerprint(e){let t=new WrappedBuffer;return t.extend(this.buf),t.extend(encodeVarInt(e)),sha256$3(t.unwrap()).subarray(0,FINGERPRINT_SIZE)}},NegentropyStorageVector=class{items;sealed;constructor(){this.items=[],this.sealed=!1}insert(e,t){if(this.sealed)throw Error("already sealed");const r=hexToBytes$3(t);if(r.byteLength!==ID_SIZE)throw Error("bad id size for added item");this.items.push({timestamp:e,id:r})}seal(){if(this.sealed)throw Error("already sealed");this.sealed=!0,this.items.sort(itemCompare);for(let e=1;e<this.items.length;e++)if(itemCompare(this.items[e-1],this.items[e])===0)throw Error("duplicate item inserted")}unseal(){this.sealed=!1}size(){return this._checkSealed(),this.items.length}getItem(e){if(this._checkSealed(),e>=this.items.length)throw Error("out of range");return this.items[e]}iterate(e,t,r){this._checkSealed(),this._checkBounds(e,t);for(let n=e;n<t&&r(this.items[n],n);++n);}findLowerBound(e,t,r){return this._checkSealed(),this._checkBounds(e,t),this._binarySearch(this.items,e,t,n=>itemCompare(n,r)<0)}fingerprint(e,t){let r=new Accumulator;return r.setToZero(),this.iterate(e,t,n=>(r.add(n.id),!0)),r.getFingerprint(t-e)}_checkSealed(){if(!this.sealed)throw Error("not sealed")}_checkBounds(e,t){if(e>t||t>this.items.length)throw Error("bad range")}_binarySearch(e,t,r,n){let o=r-t;for(;o>0;){let a=t,l=Math.floor(o/2);a+=l,n(e[a])?(t=++a,o-=l+1):o=l}return t}},Negentropy=class{storage;frameSizeLimit;lastTimestampIn;lastTimestampOut;constructor(e,t=6e4){if(t<4096)throw Error("frameSizeLimit too small");this.storage=e,this.frameSizeLimit=t,this.lastTimestampIn=0,this.lastTimestampOut=0}_bound(e,t){return{timestamp:e,id:t||new Uint8Array(0)}}initiate(){let e=new WrappedBuffer;return e.extend(new Uint8Array([PROTOCOL_VERSION])),this.splitRange(0,this.storage.size(),this._bound(Number.MAX_VALUE),e),bytesToHex$1(e.unwrap())}reconcile(e,t,r){const n=new WrappedBuffer(hexToBytes$3(e));this.lastTimestampIn=this.lastTimestampOut=0;let o=new WrappedBuffer;o.extend(new Uint8Array([PROTOCOL_VERSION]));let a=getByte(n);if(a<96||a>111)throw Error("invalid negentropy protocol version byte");if(a!==PROTOCOL_VERSION)throw Error("unsupported negentropy protocol version requested: "+(a-96));let l=this.storage.size(),u=this._bound(0),f=0,x=!1;for(;n.length!==0;){let p=new WrappedBuffer,g=()=>{x&&(x=!1,p.extend(this.encodeBound(u)),p.extend(encodeVarInt(Mode.Skip)))},y=this.decodeBound(n),b=decodeVarInt(n),w=f,v=this.storage.findLowerBound(f,l,y);if(b===Mode.Skip)x=!0;else if(b===Mode.Fingerprint){let B=getBytes(n,FINGERPRINT_SIZE),j=this.storage.fingerprint(w,v);compareUint8Array(B,j)!==0?(g(),this.splitRange(w,v,y,p)):x=!0}else if(b===Mode.IdList){let B=decodeVarInt(n),j={};for(let F=0;F<B;F++){let C=getBytes(n,ID_SIZE);j[bytesToHex$1(C)]=C}if(x=!0,this.storage.iterate(w,v,F=>{let C=F.id;const N=bytesToHex$1(C);return j[N]?delete j[bytesToHex$1(C)]:t?.(N),!0}),r)for(let F of Object.values(j))r(bytesToHex$1(F))}else throw Error("unexpected mode");if(this.exceededFrameSizeLimit(o.length+p.length)){let B=this.storage.fingerprint(v,l);o.extend(this.encodeBound(this._bound(Number.MAX_VALUE))),o.extend(encodeVarInt(Mode.Fingerprint)),o.extend(B);break}else o.extend(p);f=v,u=y}return o.length===1?null:bytesToHex$1(o.unwrap())}splitRange(e,t,r,n){let o=t-e,a=16;if(o<a*2)n.extend(this.encodeBound(r)),n.extend(encodeVarInt(Mode.IdList)),n.extend(encodeVarInt(o)),this.storage.iterate(e,t,l=>(n.extend(l.id),!0));else{let l=Math.floor(o/a),u=o%a,f=e;for(let x=0;x<a;x++){let p=l+(x<u?1:0),g=this.storage.fingerprint(f,f+p);f+=p;let y;if(f===t)y=r;else{let b,w;this.storage.iterate(f-1,f+1,(v,B)=>(B===f-1?b=v:w=v,!0)),y=this.getMinimalBound(b,w)}n.extend(this.encodeBound(y)),n.extend(encodeVarInt(Mode.Fingerprint)),n.extend(g)}}}exceededFrameSizeLimit(e){return e>this.frameSizeLimit-200}decodeTimestampIn(e){let t=decodeVarInt(e);return t=t===0?Number.MAX_VALUE:t-1,this.lastTimestampIn===Number.MAX_VALUE||t===Number.MAX_VALUE?(this.lastTimestampIn=Number.MAX_VALUE,Number.MAX_VALUE):(t+=this.lastTimestampIn,this.lastTimestampIn=t,t)}decodeBound(e){let t=this.decodeTimestampIn(e),r=decodeVarInt(e);if(r>ID_SIZE)throw Error("bound key too long");let n=getBytes(e,r);return{timestamp:t,id:n}}encodeTimestampOut(e){if(e===Number.MAX_VALUE)return this.lastTimestampOut=Number.MAX_VALUE,encodeVarInt(0);let t=e;return e-=this.lastTimestampOut,this.lastTimestampOut=t,encodeVarInt(e+1)}encodeBound(e){let t=new WrappedBuffer;return t.extend(this.encodeTimestampOut(e.timestamp)),t.extend(encodeVarInt(e.id.length)),t.extend(e.id),t}getMinimalBound(e,t){if(t.timestamp!==e.timestamp)return this._bound(t.timestamp);{let r=0,n=t.id,o=e.id;for(let a=0;a<ID_SIZE&&n[a]===o[a];a++)r++;return this._bound(t.timestamp,t.id.subarray(0,r+1))}}};function compareUint8Array(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function itemCompare(e,t){return e.timestamp===t.timestamp?compareUint8Array(e.id,t.id):e.timestamp-t.timestamp}var NegentropySync=class{relay;storage;neg;filter;subscription;onhave;onneed;constructor(e,t,r,n={}){this.relay=e,this.storage=t,this.neg=new Negentropy(t),this.onhave=n.onhave,this.onneed=n.onneed,this.filter=r,this.subscription=this.relay.prepareSubscription([{}],{label:n.label||"negentropy"}),this.subscription.oncustom=o=>{switch(o[0]){case"NEG-MSG":{o.length<3&&console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${o}`);try{const a=this.neg.reconcile(o[2],this.onhave,this.onneed);a?this.relay.send(`["NEG-MSG", "${this.subscription.id}", "${a}"]`):(this.close(),n.onclose?.())}catch(a){console.error("negentropy reconcile error:",a),n?.onclose?.(`reconcile error: ${a}`)}break}case"NEG-CLOSE":{const a=o[2];console.warn("negentropy error:",a),n.onclose?.(a);break}case"NEG-ERR":n.onclose?.()}}}async start(){const e=this.neg.initiate();this.relay.send(`["NEG-OPEN","${this.subscription.id}",${JSON.stringify(this.filter)},"${e}"]`)}close(){this.relay.send(`["NEG-CLOSE","${this.subscription.id}"]`),this.subscription.close()}},nip98_exports={};__export(nip98_exports,{getToken:()=>getToken,hashPayload:()=>hashPayload,unpackEventFromToken:()=>unpackEventFromToken,validateEvent:()=>validateEvent2,validateEventKind:()=>validateEventKind,validateEventMethodTag:()=>validateEventMethodTag,validateEventPayloadTag:()=>validateEventPayloadTag,validateEventTimestamp:()=>validateEventTimestamp,validateEventUrlTag:()=>validateEventUrlTag,validateToken:()=>validateToken});var _authorizationScheme="Nostr ";async function getToken(e,t,r,n=!1,o){const a={kind:HTTPAuth,tags:[["u",e],["method",t]],created_at:Math.round(new Date().getTime()/1e3),content:""};o&&a.tags.push(["payload",hashPayload(o)]);const l=await r(a);return(n?_authorizationScheme:"")+base64.encode(utf8Encoder$1.encode(JSON.stringify(l)))}async function validateToken(e,t,r){const n=await unpackEventFromToken(e).catch(a=>{throw a});return await validateEvent2(n,t,r).catch(a=>{throw a})}async function unpackEventFromToken(e){if(!e)throw new Error("Missing token");e=e.replace(_authorizationScheme,"");const t=utf8Decoder$1.decode(base64.decode(e));if(!t||t.length===0||!t.startsWith("{"))throw new Error("Invalid token");return JSON.parse(t)}function validateEventTimestamp(e){return e.created_at?Math.round(new Date().getTime()/1e3)-e.created_at<60:!1}function validateEventKind(e){return e.kind===HTTPAuth}function validateEventUrlTag(e,t){const r=e.tags.find(n=>n[0]==="u");return r?r.length>0&&r[1]===t:!1}function validateEventMethodTag(e,t){const r=e.tags.find(n=>n[0]==="method");return r?r.length>0&&r[1].toLowerCase()===t.toLowerCase():!1}function hashPayload(e){const t=sha256$3(utf8Encoder$1.encode(JSON.stringify(e)));return bytesToHex$2(t)}function validateEventPayloadTag(e,t){const r=e.tags.find(o=>o[0]==="payload");if(!r)return!1;const n=hashPayload(t);return r.length>0&&r[1]===n}async function validateEvent2(e,t,r,n){if(!verifyEvent(e))throw new Error("Invalid nostr event, signature invalid");if(!validateEventKind(e))throw new Error("Invalid nostr event, kind invalid");if(!validateEventTimestamp(e))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!validateEventUrlTag(e,t))throw new Error("Invalid nostr event, url tag invalid");if(!validateEventMethodTag(e,r))throw new Error("Invalid nostr event, method tag invalid");if(n&&typeof n=="object"&&Object.keys(n).length>0&&!validateEventPayloadTag(e,n))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}class CryptoService{static isWebCryptoAvailable(){return!!(window.crypto&&window.crypto.subtle)}static simpleFallbackEncrypt(t,r){const n=this.hashPassword(r),o=[];for(let a=0;a<t.length;a++)o.push(t.charCodeAt(a)^n.charCodeAt(a%n.length));return btoa(JSON.stringify(o))}static simpleFallbackDecrypt(t,r){const n=this.hashPassword(r),o=JSON.parse(atob(t));let a="";for(let l=0;l<o.length;l++)a+=String.fromCharCode(o[l]^n.charCodeAt(l%n.length));return a}static hashPassword(t){let r=0;for(let n=0;n<t.length;n++){const o=t.charCodeAt(n);r=(r<<5)-r+o,r=r&r}return r.toString(36)+t}static async getPasswordKey(t){const r=new TextEncoder;return window.crypto.subtle.importKey("raw",r.encode(t),"PBKDF2",!1,["deriveKey"])}static async deriveKey(t,r){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}static async encrypt(t,r){if(!this.isWebCryptoAvailable())return console.warn("[Crypto] Using fallback encryption"),"FALLBACK:"+this.simpleFallbackEncrypt(t,r);const n=window.crypto.getRandomValues(new Uint8Array(16)),o=window.crypto.getRandomValues(new Uint8Array(12)),a=await this.getPasswordKey(r),l=await this.deriveKey(a,n),u=new TextEncoder,f=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},l,u.encode(t)),x=new Uint8Array(f),p=new Uint8Array(n.length+o.length+x.length);return p.set(n,0),p.set(o,n.length),p.set(x,n.length+o.length),btoa(String.fromCharCode(...p))}static async decrypt(t,r){if(t.startsWith("FALLBACK:"))return this.simpleFallbackDecrypt(t.substring(9),r);const n=atob(t),o=new Uint8Array(n.length);for(let y=0;y<n.length;y++)o[y]=n.charCodeAt(y);const a=o.slice(0,16),l=o.slice(16,28),u=o.slice(28),f=await this.getPasswordKey(r),x=await this.deriveKey(f,a),p=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:l},x,u);return new TextDecoder().decode(p)}static generateMnemonic(t=12){return generateMnemonic(wordlist,t===12?128:256)}static validateMnemonic(t){return validateMnemonic(t,wordlist)}static deriveKeypair(t,r){const n=mnemonicToSeedSync(t),o=`m/44'/1237'/0'/0/${r}`,a=HDKey.fromMasterSeed(n).derive(o);if(!a.privateKey)throw new Error("Failed to derive private key");const l=Array.from(a.privateKey).map(f=>f.toString(16).padStart(2,"0")).join(""),u=getPublicKey(a.privateKey);return{nsec:nip19_exports$1.nsecEncode(a.privateKey),npub:nip19_exports$1.npubEncode(u),path:o,privateKeyHex:l}}static nsecToHex(t){const r=nip19_exports$1.decode(t);if(r.type!=="nsec")throw new Error("Invalid nsec format");const n=r.data;return Array.from(n).map(o=>o.toString(16).padStart(2,"0")).join("")}static nsecToNpub(t){const r=nip19_exports$1.decode(t);if(r.type!=="nsec")throw new Error("Invalid nsec format");const n=r.data,o=getPublicKey(n);return nip19_exports$1.npubEncode(o)}}const crypto$3=Object.freeze(Object.defineProperty({__proto__:null,CryptoService},Symbol.toStringTag,{value:"Module"}));const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),toPascalCase=e=>{const t=toCamelCase(e);return t.charAt(0).toUpperCase()+t.slice(1)},mergeClasses=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),hasA11yProp=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Icon=reactExports.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:o="",children:a,iconNode:l,...u},f)=>reactExports.createElement("svg",{ref:f,...defaultAttributes,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:mergeClasses("lucide",o),...!a&&!hasA11yProp(u)&&{"aria-hidden":"true"},...u},[...l.map(([x,p])=>reactExports.createElement(x,p)),...Array.isArray(a)?a:[a]]));const createLucideIcon=(e,t)=>{const r=reactExports.forwardRef(({className:n,...o},a)=>reactExports.createElement(Icon,{ref:a,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(e))}`,`lucide-${e}`,n),...o}));return r.displayName=toPascalCase(e),r};const __iconNode$Q=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],ArrowDownLeft=createLucideIcon("arrow-down-left",__iconNode$Q);const __iconNode$P=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ArrowLeft=createLucideIcon("arrow-left",__iconNode$P);const __iconNode$O=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],ArrowRightLeft=createLucideIcon("arrow-right-left",__iconNode$O);const __iconNode$N=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ArrowRight=createLucideIcon("arrow-right",__iconNode$N);const __iconNode$M=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ArrowUpDown=createLucideIcon("arrow-up-down",__iconNode$M);const __iconNode$L=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],ArrowUpRight=createLucideIcon("arrow-up-right",__iconNode$L);const __iconNode$K=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Bell=createLucideIcon("bell",__iconNode$K);const __iconNode$J=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Check=createLucideIcon("check",__iconNode$J);const __iconNode$I=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ChevronDown=createLucideIcon("chevron-down",__iconNode$I);const __iconNode$H=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ChevronRight=createLucideIcon("chevron-right",__iconNode$H);const __iconNode$G=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],CircleAlert=createLucideIcon("circle-alert",__iconNode$G);const __iconNode$F=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CircleCheckBig=createLucideIcon("circle-check-big",__iconNode$F);const __iconNode$E=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],CircleX=createLucideIcon("circle-x",__iconNode$E);const __iconNode$D=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Code=createLucideIcon("code",__iconNode$D);const __iconNode$C=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Copy=createLucideIcon("copy",__iconNode$C);const __iconNode$B=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Download=createLucideIcon("download",__iconNode$B);const __iconNode$A=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ExternalLink=createLucideIcon("external-link",__iconNode$A);const __iconNode$z=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],EyeOff=createLucideIcon("eye-off",__iconNode$z);const __iconNode$y=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Eye=createLucideIcon("eye",__iconNode$y);const __iconNode$x=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],FileBraces=createLucideIcon("file-braces",__iconNode$x);const __iconNode$w=[["path",{d:"m18.226 5.226-2.52-2.52A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-.351",key:"1k2beg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]],FilePenLine=createLucideIcon("file-pen-line",__iconNode$w);const __iconNode$v=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],FileText=createLucideIcon("file-text",__iconNode$v);const __iconNode$u=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Heart=createLucideIcon("heart",__iconNode$u);const __iconNode$t=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],KeyRound=createLucideIcon("key-round",__iconNode$t);const __iconNode$s=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Key=createLucideIcon("key",__iconNode$s);const __iconNode$r=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Link=createLucideIcon("link",__iconNode$r);const __iconNode$q=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],LoaderCircle=createLucideIcon("loader-circle",__iconNode$q);const __iconNode$p=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Loader=createLucideIcon("loader",__iconNode$p);const __iconNode$o=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Lock=createLucideIcon("lock",__iconNode$o);const __iconNode$n=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],LogIn=createLucideIcon("log-in",__iconNode$n);const __iconNode$m=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],LogOut=createLucideIcon("log-out",__iconNode$m);const __iconNode$l=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],MessageSquare=createLucideIcon("message-square",__iconNode$l);const __iconNode$k=[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]],Notebook=createLucideIcon("notebook",__iconNode$k);const __iconNode$j=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Pen=createLucideIcon("pen",__iconNode$j);const __iconNode$i=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Plus=createLucideIcon("plus",__iconNode$i);const __iconNode$h=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],QrCode=createLucideIcon("qr-code",__iconNode$h);const __iconNode$g=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Radio=createLucideIcon("radio",__iconNode$g);const __iconNode$f=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],RefreshCw=createLucideIcon("refresh-cw",__iconNode$f);const __iconNode$e=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Save=createLucideIcon("save",__iconNode$e);const __iconNode$d=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Send=createLucideIcon("send",__iconNode$d);const __iconNode$c=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Settings=createLucideIcon("settings",__iconNode$c);const __iconNode$b=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],ShieldAlert=createLucideIcon("shield-alert",__iconNode$b);const __iconNode$a=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ShieldCheck=createLucideIcon("shield-check",__iconNode$a);const __iconNode$9=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Shield=createLucideIcon("shield",__iconNode$9);const __iconNode$8=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Trash2=createLucideIcon("trash-2",__iconNode$8);const __iconNode$7=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],TriangleAlert=createLucideIcon("triangle-alert",__iconNode$7);const __iconNode$6=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Upload=createLucideIcon("upload",__iconNode$6);const __iconNode$5=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],User=createLucideIcon("user",__iconNode$5);const __iconNode$4=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Wallet=createLucideIcon("wallet",__iconNode$4);const __iconNode$3=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],WifiOff=createLucideIcon("wifi-off",__iconNode$3);const __iconNode$2=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Wifi=createLucideIcon("wifi",__iconNode$2);const __iconNode$1=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X=createLucideIcon("x",__iconNode$1);const __iconNode=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Zap=createLucideIcon("zap",__iconNode),Toast=({message:e,type:t,isOpen:r,onClose:n,duration:o=3e3})=>{if(reactExports.useEffect(()=>{if(r&&o>0){const u=setTimeout(n,o);return()=>clearTimeout(u)}},[r,o,n]),!r)return null;const a={success:jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5 text-green-500"}),error:jsxRuntimeExports.jsx(CircleX,{className:"w-5 h-5 text-red-500"}),info:jsxRuntimeExports.jsx(CircleAlert,{className:"w-5 h-5 text-blue-500"})},l={success:"bg-green-500/10 border-green-500/20 text-green-400",error:"bg-red-500/10 border-red-500/20 text-red-400",info:"bg-blue-500/10 border-blue-500/20 text-blue-400"};return jsxRuntimeExports.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-top-2",children:jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-3 p-4 rounded-lg border ${l[t]} shadow-lg max-w-md`,children:[a[t],jsxRuntimeExports.jsx("p",{className:"flex-1 text-sm font-medium",children:e}),jsxRuntimeExports.jsx("button",{onClick:n,className:"text-current opacity-70 hover:opacity-100 transition-opacity",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})]})})},CreateWallet=({onBack:e,onComplete:t})=>{const[r,n]=reactExports.useState("type"),[o,a]=reactExports.useState(""),[l,u]=reactExports.useState(""),[f,x]=reactExports.useState(""),[p,g]=reactExports.useState(""),[y,b]=reactExports.useState(!1),[w,v]=reactExports.useState(null),[B,j]=reactExports.useState(!1),[F,C]=reactExports.useState(!1),[N,T]=reactExports.useState(null),{addWallet:_,setCurrentWallet:S,setCurrentKeypair:O}=useWalletStore(),{unlock:$}=useAuthStore(),z=I=>{const G=CryptoService.generateMnemonic(I);a(G),n("mnemonic")},W=()=>{navigator.clipboard.writeText(o),b(!0),setTimeout(()=>b(!1),2e3)},U=async I=>{if(I.preventDefault(),v(null),f!==p){v("Passwords do not match");return}if(f.length<8){v("Password must be at least 8 characters");return}j(!0);try{const G=await CryptoService.encrypt(o,f),{nsec:k,npub:M,path:q,privateKeyHex:K}=CryptoService.deriveKeypair(o,0),H=await CryptoService.encrypt(k,f),Q=crypto.randomUUID(),D=crypto.randomUUID(),Y={id:D,walletId:Q,name:"Main Account",derivationPath:q,encryptedNsec:H,npub:M,createdAt:Date.now(),connections:[]},J={id:Q,name:l||"My Address Book",type:"mnemonic",encryptedSeed:G,createdAt:Date.now(),keypairs:[Y]};_(J),S(Q),O(D),$(K),t()}catch(G){console.error(G),v("Failed to create wallet")}finally{j(!1)}};return jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:e,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),r==="type"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Create New Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Choose the security level for your new address book."})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>z(12),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"12 Words"}),jsxRuntimeExports.jsx(Shield,{className:"w-5 h-5 text-amber-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Standard security. Easier to write down and remember."})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>z(24),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"24 Words"}),jsxRuntimeExports.jsx(Shield,{className:"w-5 h-5 text-green-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Maximum security. Recommended for large amounts."})]})]})]}),r==="mnemonic"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Backup Your Seed"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm",children:"Write down these words in order. This is the ONLY way to recover your address book."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 relative group",children:[jsxRuntimeExports.jsx("div",{className:`grid grid-cols-3 gap-2 ${F?"":"blur-sm select-none"}`,children:o.split(" ").map((I,G)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 p-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500 text-xs w-4",children:[G+1,"."]}),jsxRuntimeExports.jsx("span",{className:"font-mono font-medium text-amber-50",children:I})]},G))}),jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>C(!F),className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:F?"Hide seed phrase":"Show seed phrase",children:F?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4 text-slate-400"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("button",{onClick:W,className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:"Copy to clipboard",children:y?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 flex items-start gap-3",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:"Do not share these words with anyone. Anyone with these words can steal your funds and identity."})]}),jsxRuntimeExports.jsx("button",{onClick:()=>n("encrypt"),className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors",children:"Continue "})]}),r==="encrypt"&&jsxRuntimeExports.jsxs("form",{onSubmit:U,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Secure Your Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Set a name and password for this device."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Address Book Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:l,onChange:I=>u(I.target.value),placeholder:"e.g. Main Address Book",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:f,onChange:I=>x(I.target.value),placeholder:"At least 8 characters",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0,minLength:8})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Confirm Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:p,onChange:I=>g(I.target.value),placeholder:"Repeat password",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]})]}),w&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:w}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:async()=>{if(!f||f.length<8){T({message:"Please enter a valid password (at least 8 characters)",type:"error"});return}if(f!==p){T({message:"Passwords do not match",type:"error"});return}try{const I=await CryptoService.encrypt(o,f),G=JSON.stringify({wallet:l||"My Wallet",encrypted:I,timestamp:Date.now()},null,2),k=new Blob([G],{type:"application/json"}),M=URL.createObjectURL(k),q=document.createElement("a");q.href=M,q.download=`${(l||"wallet").toLowerCase().replace(/\s+/g,"-")}-backup-encrypted.json`,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(M),T({message:"Encrypted backup downloaded successfully!",type:"success"})}catch(I){console.error("Failed to create backup:",I),T({message:"Failed to create encrypted backup",type:"error"})}},className:"w-full py-3 px-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors border border-slate-700 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),"Download Encrypted Backup"]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:B,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:B?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Address Book..."]}):"Create Address Book"})]})]}),N&&jsxRuntimeExports.jsx(Toast,{message:N.message,type:N.type,isOpen:!!N,onClose:()=>T(null)})]})},ImportWallet=({onBack:e,onComplete:t})=>{const[r,n]=reactExports.useState("method"),[o,a]=reactExports.useState(""),[l,u]=reactExports.useState(null),[f,x]=reactExports.useState(null),[p,g]=reactExports.useState(""),[y,b]=reactExports.useState(""),[w,v]=reactExports.useState(""),[B,j]=reactExports.useState(null),[F,C]=reactExports.useState(!1),{addWallet:N,setCurrentWallet:T,setCurrentKeypair:_,updateKeypair:S,wallets:O}=useWalletStore(),{unlock:$}=useAuthStore(),z=()=>{const I=o.trim();if(I.includes(" "))if(CryptoService.validateMnemonic(I)){u("mnemonic"),n("encrypt"),j(null);return}else{j("Invalid mnemonic phrase");return}if(I.startsWith("nsec"))try{const{type:G}=nip19_exports$1.decode(I);if(G==="nsec"){u("nsec"),n("encrypt"),j(null);return}}catch{}j("Invalid input. Please enter a valid mnemonic phrase or nsec.")},W=async I=>{const G=I.target.files?.[0];if(G)try{const k=await G.text(),M=JSON.parse(k);if(!M.wallet||!M.encrypted||!M.timestamp){j("Invalid backup file format");return}x(M),g(M.wallet),u("encrypted"),n("encrypt"),j(null)}catch(k){console.error("Failed to read backup file:",k),j("Failed to read backup file. Make sure it's a valid encrypted backup.")}},U=async I=>{if(I.preventDefault(),j(null),l!=="encrypted"){if(y!==w){j("Passwords do not match");return}if(y.length<8){j("Password must be at least 8 characters");return}}C(!0);try{const G=crypto.randomUUID(),k=crypto.randomUUID();let M,q;if(l==="encrypted"&&f){const K=await CryptoService.decrypt(f.encrypted,y);if(K.includes(" ")){const Q=K,{nsec:D,npub:Y,path:J,privateKeyHex:L}=CryptoService.deriveKeypair(Q,0);if(O.some(ce=>ce.keypairs.some(de=>de.npub===Y))){j("Wallet already exists"),C(!1);return}const Z=await CryptoService.encrypt(D,y);q=L;const oe={id:k,walletId:G,name:"Main Account",derivationPath:J,encryptedNsec:Z,npub:Y,createdAt:Date.now(),connections:[]};M={id:G,name:p||f.wallet,type:"mnemonic",encryptedSeed:f.encrypted,createdAt:f.timestamp,keypairs:[oe]}}else{const Q=K,D=CryptoService.nsecToNpub(Q);if(O.some(L=>L.keypairs.some(Z=>Z.npub===D))){j("Wallet already exists"),C(!1);return}const Y=await CryptoService.encrypt(Q,y);q=CryptoService.nsecToHex(Q);const J={id:k,walletId:G,name:"Main Account",encryptedNsec:Y,npub:D,createdAt:Date.now(),connections:[]};M={id:G,name:p||f.wallet,type:"imported",createdAt:f.timestamp,keypairs:[J]}}}else if(l==="mnemonic"){const K=o.trim(),H=await CryptoService.encrypt(K,y),{nsec:Q,npub:D,path:Y,privateKeyHex:J}=CryptoService.deriveKeypair(K,0);if(O.some(oe=>oe.keypairs.some(ce=>ce.npub===D))){j("Wallet already exists"),C(!1);return}const L=await CryptoService.encrypt(Q,y);q=J;const Z={id:k,walletId:G,name:"Main Account",derivationPath:Y,encryptedNsec:L,npub:D,createdAt:Date.now(),connections:[]};M={id:G,name:p||"Imported Wallet",type:"mnemonic",encryptedSeed:H,createdAt:Date.now(),keypairs:[Z]}}else{const K=o.trim(),H=CryptoService.nsecToNpub(K);if(O.some(Y=>Y.keypairs.some(J=>J.npub===H))){j("Wallet already exists"),C(!1);return}const Q=await CryptoService.encrypt(K,y);q=CryptoService.nsecToHex(K);const D={id:k,walletId:G,name:"Main Account",encryptedNsec:Q,npub:H,createdAt:Date.now(),connections:[]};M={id:G,name:p||"Imported Wallet",type:"imported",createdAt:Date.now(),keypairs:[D]}}N(M),T(G),_(k),setTimeout(async()=>{try{const{ProfileService:K}=await __vitePreload(async()=>{const{ProfileService:Q}=await Promise.resolve().then(()=>profile);return{ProfileService:Q}},void 0,import.meta.url),H=await K.fetchProfile(M.keypairs[0].npub);H&&S(G,k,{profile:{...H,lastFetched:Date.now()}})}catch(K){console.error("Failed to fetch profile for imported wallet:",K)}},100),$(q,y),t()}catch(G){console.error(G),j(l==="encrypted"?"Incorrect password. Failed to decrypt backup.":"Failed to import wallet")}finally{C(!1)}};return jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{r==="method"?e():n(r==="encrypt"?l==="encrypted"?"method":"input":"method")},className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),r==="method"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Import Wallet"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Choose how you want to import your wallet."})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>n("input"),className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"Recovery Phrase / Private Key"}),jsxRuntimeExports.jsx(KeyRound,{className:"w-5 h-5 text-amber-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Import using your 12/24 word seed phrase or nsec."})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{document.getElementById("backup-file-input")?.click()},className:"p-4 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-700 transition-all text-left group relative",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-lg",children:"Encrypted Backup File"}),jsxRuntimeExports.jsx(FileBraces,{className:"w-5 h-5 text-blue-500"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Import from a previously exported JSON backup file."}),jsxRuntimeExports.jsx("input",{id:"backup-file-input",type:"file",accept:".json",onChange:W,className:"hidden"})]})]}),B&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:B})]}),r==="input"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Enter Credentials"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Enter your recovery phrase or private key (nsec)."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("textarea",{value:o,onChange:I=>a(I.target.value),placeholder:"word1 word2 word3... OR nsec1...",className:"w-full h-32 bg-slate-900 border border-slate-800 rounded-xl p-4 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm resize-none"}),B&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 p-3 rounded-lg border border-red-500/20",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),B]}),jsxRuntimeExports.jsx("button",{onClick:z,disabled:!o.trim(),className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"})]})]}),r==="encrypt"&&jsxRuntimeExports.jsxs("form",{onSubmit:U,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:l==="encrypted"?"Decrypt Backup":"Secure Your Wallet"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:l==="encrypted"?"Enter the password used to encrypt this backup.":"Set a name and password for this device."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Wallet Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:p,onChange:I=>g(I.target.value),placeholder:"e.g. Main Wallet",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:l==="encrypted"?"Backup Password":"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:y,onChange:I=>b(I.target.value),placeholder:l==="encrypted"?"Enter backup password":"At least 8 characters",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0,minLength:l==="encrypted"?1:8})]}),l!=="encrypted"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Confirm Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:w,onChange:I=>v(I.target.value),placeholder:"Repeat password",inputMode:"numeric",className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",required:!0})]})]}),B&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm text-center",children:B}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:F,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:F?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-2 animate-spin"}),l==="encrypted"?"Decrypting...":"Importing..."]}):l==="encrypted"?"Decrypt & Import":"Import Wallet"})]})]})},Login=()=>{const{unlock:e}=useAuthStore(),{wallets:t,currentWalletId:r,setCurrentWallet:n}=useWalletStore(),[o,a]=reactExports.useState("login"),[l,u]=reactExports.useState(""),[f,x]=reactExports.useState(null),[p,g]=reactExports.useState(!1),[y,b]=reactExports.useState(""),[w,v]=reactExports.useState(!1);reactExports.useEffect(()=>{t.length===0||(r&&t.find(j=>j.id===r)?b(r):t.length>0&&b(t[0].id))},[t,r]);const B=async j=>{j.preventDefault(),x(null),g(!0);try{const F=t.find(_=>_.id===y);if(!F)throw new Error("Wallet not found");const C=F.keypairs[0];if(!C)throw new Error("No keypairs in wallet");const N=await CryptoService.decrypt(C.encryptedNsec,l),T=CryptoService.nsecToHex(N);n(F.id),e(T,l)}catch(F){console.error(F),x("Invalid password")}finally{g(!1)}};return o==="create"?jsxRuntimeExports.jsx(CreateWallet,{onBack:()=>a("login"),onComplete:()=>{}}):o==="import"?jsxRuntimeExports.jsx(ImportWallet,{onBack:()=>a("login"),onComplete:()=>{}}):t.length===0?jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 p-4",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md bg-slate-900 rounded-2xl p-8 shadow-xl border border-slate-800 text-center",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"PWANS Logo",className:"w-24 h-24 rounded-full"})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 mb-8",children:"Your secure Nostr signer. Create a new address book or import an existing one to get started."}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>a("create"),className:"w-full py-4 px-6 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-3",children:[jsxRuntimeExports.jsx(Plus,{className:"w-5 h-5"}),"Create New Address Book"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>a("import"),className:"w-full py-4 px-6 bg-slate-800 hover:bg-slate-700 text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-3",children:[jsxRuntimeExports.jsx(Download,{className:"w-5 h-5"}),"Import Address Book"]})]})]})}):jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 p-4",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md bg-slate-900 rounded-2xl p-8 shadow-xl border border-slate-800",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsx("div",{className:"p-4 bg-amber-500/10 rounded-full",children:jsxRuntimeExports.jsx(Lock,{className:"w-8 h-8 text-amber-500"})})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-center mb-2",children:"Unlock Address Book"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-center mb-8",children:"Enter your password to access your keys"}),jsxRuntimeExports.jsxs("form",{onSubmit:B,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Select Address Book"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>v(!w),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all text-left flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{children:t.find(j=>j.id===y)?.name||"Select..."}),jsxRuntimeExports.jsx("svg",{className:`w-5 h-5 transition-transform ${w?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 w-full mt-2 bg-slate-900 border border-slate-800 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:t.map(j=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{b(j.id),v(!1)},className:`w-full px-4 py-3 text-left hover:bg-slate-800 transition-colors ${y===j.id?"bg-amber-500/10 text-amber-500":"text-white"}`,children:j.name},j.id))})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:l,onChange:j=>u(j.target.value),inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"",required:!0})]}),f&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-400/10 p-3 rounded-lg",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"w-4 h-4"}),f]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:p,className:"w-full bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:p?"Unlocking...":jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LogIn,{className:"w-4 h-4"}),"Unlock"]})}),jsxRuntimeExports.jsxs("div",{className:"pt-4 border-t border-slate-800 flex justify-center gap-4 text-sm",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>a("create"),className:"text-slate-400 hover:text-amber-500 transition-colors",children:"Create New"}),jsxRuntimeExports.jsx("span",{className:"text-slate-600",children:"|"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>a("import"),className:"text-slate-400 hover:text-amber-500 transition-colors",children:"Import"})]})]})]})})};var __defProp$1=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp$1=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp$1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp$1.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__objRest=(e,t)=>{var r={};for(var n in e)__hasOwnProp$1.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&__getOwnPropSymbols)for(var n of __getOwnPropSymbols(e))t.indexOf(n)<0&&__propIsEnum.call(e,n)&&(r[n]=e[n]);return r};var qrcodegen;(e=>{const t=class dt{constructor(f,x,p,g){if(this.version=f,this.errorCorrectionLevel=x,this.modules=[],this.isFunction=[],f<dt.MIN_VERSION||f>dt.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let y=[];for(let w=0;w<this.size;w++)y.push(!1);for(let w=0;w<this.size;w++)this.modules.push(y.slice()),this.isFunction.push(y.slice());this.drawFunctionPatterns();const b=this.addEccAndInterleave(p);if(this.drawCodewords(b),g==-1){let w=1e9;for(let v=0;v<8;v++){this.applyMask(v),this.drawFormatBits(v);const B=this.getPenaltyScore();B<w&&(g=v,w=B),this.applyMask(v)}}o(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,x){const p=e.QrSegment.makeSegments(f);return dt.encodeSegments(p,x)}static encodeBinary(f,x){const p=e.QrSegment.makeBytes(f);return dt.encodeSegments([p],x)}static encodeSegments(f,x,p=1,g=40,y=-1,b=!0){if(!(dt.MIN_VERSION<=p&&p<=g&&g<=dt.MAX_VERSION)||y<-1||y>7)throw new RangeError("Invalid value");let w,v;for(w=p;;w++){const C=dt.getNumDataCodewords(w,x)*8,N=l.getTotalBits(f,w);if(N<=C){v=N;break}if(w>=g)throw new RangeError("Data too long")}for(const C of[dt.Ecc.MEDIUM,dt.Ecc.QUARTILE,dt.Ecc.HIGH])b&&v<=dt.getNumDataCodewords(w,C)*8&&(x=C);let B=[];for(const C of f){r(C.mode.modeBits,4,B),r(C.numChars,C.mode.numCharCountBits(w),B);for(const N of C.getData())B.push(N)}o(B.length==v);const j=dt.getNumDataCodewords(w,x)*8;o(B.length<=j),r(0,Math.min(4,j-B.length),B),r(0,(8-B.length%8)%8,B),o(B.length%8==0);for(let C=236;B.length<j;C^=253)r(C,8,B);let F=[];for(;F.length*8<B.length;)F.push(0);return B.forEach((C,N)=>F[N>>>3]|=C<<7-(N&7)),new dt(w,x,F,y)}getModule(f,x){return 0<=f&&f<this.size&&0<=x&&x<this.size&&this.modules[x][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let p=0;p<this.size;p++)this.setFunctionModule(6,p,p%2==0),this.setFunctionModule(p,6,p%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),x=f.length;for(let p=0;p<x;p++)for(let g=0;g<x;g++)p==0&&g==0||p==0&&g==x-1||p==x-1&&g==0||this.drawAlignmentPattern(f[p],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const x=this.errorCorrectionLevel.formatBits<<3|f;let p=x;for(let y=0;y<10;y++)p=p<<1^(p>>>9)*1335;const g=(x<<10|p)^21522;o(g>>>15==0);for(let y=0;y<=5;y++)this.setFunctionModule(8,y,n(g,y));this.setFunctionModule(8,7,n(g,6)),this.setFunctionModule(8,8,n(g,7)),this.setFunctionModule(7,8,n(g,8));for(let y=9;y<15;y++)this.setFunctionModule(14-y,8,n(g,y));for(let y=0;y<8;y++)this.setFunctionModule(this.size-1-y,8,n(g,y));for(let y=8;y<15;y++)this.setFunctionModule(8,this.size-15+y,n(g,y));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let p=0;p<12;p++)f=f<<1^(f>>>11)*7973;const x=this.version<<12|f;o(x>>>18==0);for(let p=0;p<18;p++){const g=n(x,p),y=this.size-11+p%3,b=Math.floor(p/3);this.setFunctionModule(y,b,g),this.setFunctionModule(b,y,g)}}drawFinderPattern(f,x){for(let p=-4;p<=4;p++)for(let g=-4;g<=4;g++){const y=Math.max(Math.abs(g),Math.abs(p)),b=f+g,w=x+p;0<=b&&b<this.size&&0<=w&&w<this.size&&this.setFunctionModule(b,w,y!=2&&y!=4)}}drawAlignmentPattern(f,x){for(let p=-2;p<=2;p++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,x+p,Math.max(Math.abs(g),Math.abs(p))!=1)}setFunctionModule(f,x,p){this.modules[x][f]=p,this.isFunction[x][f]=!0}addEccAndInterleave(f){const x=this.version,p=this.errorCorrectionLevel;if(f.length!=dt.getNumDataCodewords(x,p))throw new RangeError("Invalid argument");const g=dt.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][x],y=dt.ECC_CODEWORDS_PER_BLOCK[p.ordinal][x],b=Math.floor(dt.getNumRawDataModules(x)/8),w=g-b%g,v=Math.floor(b/g);let B=[];const j=dt.reedSolomonComputeDivisor(y);for(let C=0,N=0;C<g;C++){let T=f.slice(N,N+v-y+(C<w?0:1));N+=T.length;const _=dt.reedSolomonComputeRemainder(T,j);C<w&&T.push(0),B.push(T.concat(_))}let F=[];for(let C=0;C<B[0].length;C++)B.forEach((N,T)=>{(C!=v-y||T>=w)&&F.push(N[C])});return o(F.length==b),F}drawCodewords(f){if(f.length!=Math.floor(dt.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let x=0;for(let p=this.size-1;p>=1;p-=2){p==6&&(p=5);for(let g=0;g<this.size;g++)for(let y=0;y<2;y++){const b=p-y,v=(p+1&2)==0?this.size-1-g:g;!this.isFunction[v][b]&&x<f.length*8&&(this.modules[v][b]=n(f[x>>>3],7-(x&7)),x++)}}o(x==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let x=0;x<this.size;x++)for(let p=0;p<this.size;p++){let g;switch(f){case 0:g=(p+x)%2==0;break;case 1:g=x%2==0;break;case 2:g=p%3==0;break;case 3:g=(p+x)%3==0;break;case 4:g=(Math.floor(p/3)+Math.floor(x/2))%2==0;break;case 5:g=p*x%2+p*x%3==0;break;case 6:g=(p*x%2+p*x%3)%2==0;break;case 7:g=((p+x)%2+p*x%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[x][p]&&g&&(this.modules[x][p]=!this.modules[x][p])}}getPenaltyScore(){let f=0;for(let y=0;y<this.size;y++){let b=!1,w=0,v=[0,0,0,0,0,0,0];for(let B=0;B<this.size;B++)this.modules[y][B]==b?(w++,w==5?f+=dt.PENALTY_N1:w>5&&f++):(this.finderPenaltyAddHistory(w,v),b||(f+=this.finderPenaltyCountPatterns(v)*dt.PENALTY_N3),b=this.modules[y][B],w=1);f+=this.finderPenaltyTerminateAndCount(b,w,v)*dt.PENALTY_N3}for(let y=0;y<this.size;y++){let b=!1,w=0,v=[0,0,0,0,0,0,0];for(let B=0;B<this.size;B++)this.modules[B][y]==b?(w++,w==5?f+=dt.PENALTY_N1:w>5&&f++):(this.finderPenaltyAddHistory(w,v),b||(f+=this.finderPenaltyCountPatterns(v)*dt.PENALTY_N3),b=this.modules[B][y],w=1);f+=this.finderPenaltyTerminateAndCount(b,w,v)*dt.PENALTY_N3}for(let y=0;y<this.size-1;y++)for(let b=0;b<this.size-1;b++){const w=this.modules[y][b];w==this.modules[y][b+1]&&w==this.modules[y+1][b]&&w==this.modules[y+1][b+1]&&(f+=dt.PENALTY_N2)}let x=0;for(const y of this.modules)x=y.reduce((b,w)=>b+(w?1:0),x);const p=this.size*this.size,g=Math.ceil(Math.abs(x*20-p*10)/p)-1;return o(0<=g&&g<=9),f+=g*dt.PENALTY_N4,o(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,x=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let p=[6];for(let g=this.size-7;p.length<f;g-=x)p.splice(1,0,g);return p}}static getNumRawDataModules(f){if(f<dt.MIN_VERSION||f>dt.MAX_VERSION)throw new RangeError("Version number out of range");let x=(16*f+128)*f+64;if(f>=2){const p=Math.floor(f/7)+2;x-=(25*p-10)*p-55,f>=7&&(x-=36)}return o(208<=x&&x<=29648),x}static getNumDataCodewords(f,x){return Math.floor(dt.getNumRawDataModules(f)/8)-dt.ECC_CODEWORDS_PER_BLOCK[x.ordinal][f]*dt.NUM_ERROR_CORRECTION_BLOCKS[x.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let x=[];for(let g=0;g<f-1;g++)x.push(0);x.push(1);let p=1;for(let g=0;g<f;g++){for(let y=0;y<x.length;y++)x[y]=dt.reedSolomonMultiply(x[y],p),y+1<x.length&&(x[y]^=x[y+1]);p=dt.reedSolomonMultiply(p,2)}return x}static reedSolomonComputeRemainder(f,x){let p=x.map(g=>0);for(const g of f){const y=g^p.shift();p.push(0),x.forEach((b,w)=>p[w]^=dt.reedSolomonMultiply(b,y))}return p}static reedSolomonMultiply(f,x){if(f>>>8||x>>>8)throw new RangeError("Byte out of range");let p=0;for(let g=7;g>=0;g--)p=p<<1^(p>>>7)*285,p^=(x>>>g&1)*f;return o(p>>>8==0),p}finderPenaltyCountPatterns(f){const x=f[1];o(x<=this.size*3);const p=x>0&&f[2]==x&&f[3]==x*3&&f[4]==x&&f[5]==x;return(p&&f[0]>=x*4&&f[6]>=x?1:0)+(p&&f[6]>=x*4&&f[0]>=x?1:0)}finderPenaltyTerminateAndCount(f,x,p){return f&&(this.finderPenaltyAddHistory(x,p),x=0),x+=this.size,this.finderPenaltyAddHistory(x,p),this.finderPenaltyCountPatterns(p)}finderPenaltyAddHistory(f,x){x[0]==0&&(f+=this.size),x.pop(),x.unshift(f)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;function r(u,f,x){if(f<0||f>31||u>>>f)throw new RangeError("Value out of range");for(let p=f-1;p>=0;p--)x.push(u>>>p&1)}function n(u,f){return(u>>>f&1)!=0}function o(u){if(!u)throw new Error("Assertion error")}const a=class jt{constructor(f,x,p){if(this.mode=f,this.numChars=x,this.bitData=p,x<0)throw new RangeError("Invalid argument");this.bitData=p.slice()}static makeBytes(f){let x=[];for(const p of f)r(p,8,x);return new jt(jt.Mode.BYTE,f.length,x)}static makeNumeric(f){if(!jt.isNumeric(f))throw new RangeError("String contains non-numeric characters");let x=[];for(let p=0;p<f.length;){const g=Math.min(f.length-p,3);r(parseInt(f.substring(p,p+g),10),g*3+1,x),p+=g}return new jt(jt.Mode.NUMERIC,f.length,x)}static makeAlphanumeric(f){if(!jt.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let x=[],p;for(p=0;p+2<=f.length;p+=2){let g=jt.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p))*45;g+=jt.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p+1)),r(g,11,x)}return p<f.length&&r(jt.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p)),6,x),new jt(jt.Mode.ALPHANUMERIC,f.length,x)}static makeSegments(f){return f==""?[]:jt.isNumeric(f)?[jt.makeNumeric(f)]:jt.isAlphanumeric(f)?[jt.makeAlphanumeric(f)]:[jt.makeBytes(jt.toUtf8ByteArray(f))]}static makeEci(f){let x=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)r(f,8,x);else if(f<16384)r(2,2,x),r(f,14,x);else if(f<1e6)r(6,3,x),r(f,21,x);else throw new RangeError("ECI assignment value out of range");return new jt(jt.Mode.ECI,0,x)}static isNumeric(f){return jt.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return jt.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,x){let p=0;for(const g of f){const y=g.mode.numCharCountBits(x);if(g.numChars>=1<<y)return 1/0;p+=4+y+g.bitData.length}return p}static toUtf8ByteArray(f){f=encodeURI(f);let x=[];for(let p=0;p<f.length;p++)f.charAt(p)!="%"?x.push(f.charCodeAt(p)):(x.push(parseInt(f.substring(p+1,p+3),16)),p+=2);return x}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=a;e.QrSegment=a})(qrcodegen||(qrcodegen={}));(e=>{(t=>{const r=class{constructor(o,a){this.ordinal=o,this.formatBits=a}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),t.Ecc=r})(e.QrCode||(e.QrCode={}))})(qrcodegen||(qrcodegen={}));(e=>{(t=>{const r=class{constructor(o,a){this.modeBits=o,this.numBitsCharCount=a}numCharCountBits(o){return this.numBitsCharCount[Math.floor((o+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),t.Mode=r})(e.QrSegment||(e.QrSegment={}))})(qrcodegen||(qrcodegen={}));var qrcodegen_default=qrcodegen;var ERROR_LEVEL_MAP={L:qrcodegen_default.QrCode.Ecc.LOW,M:qrcodegen_default.QrCode.Ecc.MEDIUM,Q:qrcodegen_default.QrCode.Ecc.QUARTILE,H:qrcodegen_default.QrCode.Ecc.HIGH},DEFAULT_SIZE=128,DEFAULT_LEVEL="L",DEFAULT_BGCOLOR="#FFFFFF",DEFAULT_FGCOLOR="#000000",DEFAULT_INCLUDEMARGIN=!1,DEFAULT_MINVERSION=1,SPEC_MARGIN_SIZE=4,DEFAULT_MARGIN_SIZE=0,DEFAULT_IMG_SCALE=.1;function generatePath(e,t=0){const r=[];return e.forEach(function(n,o){let a=null;n.forEach(function(l,u){if(!l&&a!==null){r.push(`M${a+t} ${o+t}h${u-a}v1H${a+t}z`),a=null;return}if(u===n.length-1){if(!l)return;a===null?r.push(`M${u+t},${o+t} h1v1H${u+t}z`):r.push(`M${a+t},${o+t} h${u+1-a}v1H${a+t}z`);return}l&&a===null&&(a=u)})}),r.join("")}function excavateModules(e,t){return e.slice().map((r,n)=>n<t.y||n>=t.y+t.h?r:r.map((o,a)=>a<t.x||a>=t.x+t.w?o:!1))}function getImageSettings(e,t,r,n){if(n==null)return null;const o=e.length+r*2,a=Math.floor(t*DEFAULT_IMG_SCALE),l=o/t,u=(n.width||a)*l,f=(n.height||a)*l,x=n.x==null?e.length/2-u/2:n.x*l,p=n.y==null?e.length/2-f/2:n.y*l,g=n.opacity==null?1:n.opacity;let y=null;if(n.excavate){let w=Math.floor(x),v=Math.floor(p),B=Math.ceil(u+x-w),j=Math.ceil(f+p-v);y={x:w,y:v,w:B,h:j}}const b=n.crossOrigin;return{x,y:p,h:f,w:u,excavation:y,opacity:g,crossOrigin:b}}function getMarginSize(e,t){return t!=null?Math.max(Math.floor(t),0):e?SPEC_MARGIN_SIZE:DEFAULT_MARGIN_SIZE}function useQRCode({value:e,level:t,minVersion:r,includeMargin:n,marginSize:o,imageSettings:a,size:l,boostLevel:u}){let f=React.useMemo(()=>{const w=(Array.isArray(e)?e:[e]).reduce((v,B)=>(v.push(...qrcodegen_default.QrSegment.makeSegments(B)),v),[]);return qrcodegen_default.QrCode.encodeSegments(w,ERROR_LEVEL_MAP[t],r,void 0,void 0,u)},[e,t,r,u]);const{cells:x,margin:p,numCells:g,calculatedImageSettings:y}=React.useMemo(()=>{let b=f.getModules();const w=getMarginSize(n,o),v=b.length+w*2,B=getImageSettings(b,l,w,a);return{cells:b,margin:w,numCells:v,calculatedImageSettings:B}},[f,l,a,n,o]);return{qrcode:f,margin:p,cells:x,numCells:g,calculatedImageSettings:y}}var SUPPORTS_PATH2D=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),QRCodeCanvas=React.forwardRef(function(t,r){const n=t,{value:o,size:a=DEFAULT_SIZE,level:l=DEFAULT_LEVEL,bgColor:u=DEFAULT_BGCOLOR,fgColor:f=DEFAULT_FGCOLOR,includeMargin:x=DEFAULT_INCLUDEMARGIN,minVersion:p=DEFAULT_MINVERSION,boostLevel:g,marginSize:y,imageSettings:b}=n,v=__objRest(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:B}=v,j=__objRest(v,["style"]),F=b?.src,C=React.useRef(null),N=React.useRef(null),T=React.useCallback(G=>{C.current=G,typeof r=="function"?r(G):r&&(r.current=G)},[r]),[_,S]=React.useState(!1),{margin:O,cells:$,numCells:z,calculatedImageSettings:W}=useQRCode({value:o,level:l,minVersion:p,boostLevel:g,includeMargin:x,marginSize:y,imageSettings:b,size:a});React.useEffect(()=>{if(C.current!=null){const G=C.current,k=G.getContext("2d");if(!k)return;let M=$;const q=N.current,K=W!=null&&q!==null&&q.complete&&q.naturalHeight!==0&&q.naturalWidth!==0;K&&W.excavation!=null&&(M=excavateModules($,W.excavation));const H=window.devicePixelRatio||1;G.height=G.width=a*H;const Q=a/z*H;k.scale(Q,Q),k.fillStyle=u,k.fillRect(0,0,z,z),k.fillStyle=f,SUPPORTS_PATH2D?k.fill(new Path2D(generatePath(M,O))):$.forEach(function(D,Y){D.forEach(function(J,L){J&&k.fillRect(L+O,Y+O,1,1)})}),W&&(k.globalAlpha=W.opacity),K&&k.drawImage(q,W.x+O,W.y+O,W.w,W.h)}}),React.useEffect(()=>{S(!1)},[F]);const U=__spreadValues({height:a,width:a},B);let I=null;return F!=null&&(I=React.createElement("img",{src:F,key:F,style:{display:"none"},onLoad:()=>{S(!0)},ref:N,crossOrigin:W?.crossOrigin})),React.createElement(React.Fragment,null,React.createElement("canvas",__spreadValues({style:U,height:a,width:a,ref:T,role:"img"},j)),I)});QRCodeCanvas.displayName="QRCodeCanvas";var QRCodeSVG=React.forwardRef(function(t,r){const n=t,{value:o,size:a=DEFAULT_SIZE,level:l=DEFAULT_LEVEL,bgColor:u=DEFAULT_BGCOLOR,fgColor:f=DEFAULT_FGCOLOR,includeMargin:x=DEFAULT_INCLUDEMARGIN,minVersion:p=DEFAULT_MINVERSION,boostLevel:g,title:y,marginSize:b,imageSettings:w}=n,v=__objRest(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:B,cells:j,numCells:F,calculatedImageSettings:C}=useQRCode({value:o,level:l,minVersion:p,boostLevel:g,includeMargin:x,marginSize:b,imageSettings:w,size:a});let N=j,T=null;w!=null&&C!=null&&(C.excavation!=null&&(N=excavateModules(j,C.excavation)),T=React.createElement("image",{href:w.src,height:C.h,width:C.w,x:C.x+B,y:C.y+B,preserveAspectRatio:"none",opacity:C.opacity,crossOrigin:C.crossOrigin}));const _=generatePath(N,B);return React.createElement("svg",__spreadValues({height:a,width:a,viewBox:`0 0 ${F} ${F}`,ref:r,role:"img"},v),!!y&&React.createElement("title",null,y),React.createElement("path",{fill:u,d:`M0,0 h${F}v${F}H0z`,shapeRendering:"crispEdges"}),React.createElement("path",{fill:f,d:_,shapeRendering:"crispEdges"}),T)});QRCodeSVG.displayName="QRCodeSVG";const useSettingsStore=create()(persist(e=>({eventCreatorMode:!1,toggleEventCreatorMode:()=>e(t=>({eventCreatorMode:!t.eventCreatorMode}))}),{name:"amber-settings",storage:createJSONStorage(()=>localStorage)}));var dist$4={},ur={},errors$1={},hasRequiredErrors$1;function requireErrors$1(){if(hasRequiredErrors$1)return errors$1;hasRequiredErrors$1=1,Object.defineProperty(errors$1,"__esModule",{value:!0}),errors$1.InvalidChecksumError=errors$1.InvalidSequenceComponentError=errors$1.InvalidTypeError=errors$1.InvalidPathLengthError=errors$1.InvalidSchemeError=void 0;class e extends Error{constructor(){super("Invalid Scheme"),this.name="InvalidSchemeError"}}errors$1.InvalidSchemeError=e;class t extends Error{constructor(){super("Invalid Path"),this.name="InvalidPathLengthError"}}errors$1.InvalidPathLengthError=t;class r extends Error{constructor(){super("Invalid Type"),this.name="InvalidTypeError"}}errors$1.InvalidTypeError=r;class n extends Error{constructor(){super("Invalid Sequence Component"),this.name="InvalidSequenceComponentError"}}errors$1.InvalidSequenceComponentError=n;class o extends Error{constructor(){super("Invalid Checksum"),this.name="InvalidChecksumError"}}return errors$1.InvalidChecksumError=o,errors$1}var utils$7={},sha_js={exports:{}},inherits_browser={exports:{}},hasRequiredInherits_browser;function requireInherits_browser(){return hasRequiredInherits_browser||(hasRequiredInherits_browser=1,typeof Object.create=="function"?inherits_browser.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}}),inherits_browser.exports}var safeBuffer={exports:{}},dist$3={},hasRequiredDist$4;function requireDist$4(){return hasRequiredDist$4||(hasRequiredDist$4=1,(function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},r={};r.byteLength=p,r.toByteArray=y,r.fromByteArray=v;for(var n=[],o=[],a=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,f=l.length;u<f;++u)n[u]=l[u],o[l.charCodeAt(u)]=u;o[45]=62,o[95]=63;function x(F){var C=F.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var N=F.indexOf("=");N===-1&&(N=C);var T=N===C?0:4-N%4;return[N,T]}function p(F){var C=x(F),N=C[0],T=C[1];return(N+T)*3/4-T}function g(F,C,N){return(C+N)*3/4-N}function y(F){var C,N=x(F),T=N[0],_=N[1],S=new a(g(F,T,_)),O=0,$=_>0?T-4:T,z;for(z=0;z<$;z+=4)C=o[F.charCodeAt(z)]<<18|o[F.charCodeAt(z+1)]<<12|o[F.charCodeAt(z+2)]<<6|o[F.charCodeAt(z+3)],S[O++]=C>>16&255,S[O++]=C>>8&255,S[O++]=C&255;return _===2&&(C=o[F.charCodeAt(z)]<<2|o[F.charCodeAt(z+1)]>>4,S[O++]=C&255),_===1&&(C=o[F.charCodeAt(z)]<<10|o[F.charCodeAt(z+1)]<<4|o[F.charCodeAt(z+2)]>>2,S[O++]=C>>8&255,S[O++]=C&255),S}function b(F){return n[F>>18&63]+n[F>>12&63]+n[F>>6&63]+n[F&63]}function w(F,C,N){for(var T,_=[],S=C;S<N;S+=3)T=(F[S]<<16&16711680)+(F[S+1]<<8&65280)+(F[S+2]&255),_.push(b(T));return _.join("")}function v(F){for(var C,N=F.length,T=N%3,_=[],S=16383,O=0,$=N-T;O<$;O+=S)_.push(w(F,O,O+S>$?$:O+S));return T===1?(C=F[N-1],_.push(n[C>>2]+n[C<<4&63]+"==")):T===2&&(C=(F[N-2]<<8)+F[N-1],_.push(n[C>>10]+n[C>>4&63]+n[C<<2&63]+"=")),_.join("")}var B={};B.read=function(F,C,N,T,_){var S,O,$=_*8-T-1,z=(1<<$)-1,W=z>>1,U=-7,I=N?_-1:0,G=N?-1:1,k=F[C+I];for(I+=G,S=k&(1<<-U)-1,k>>=-U,U+=$;U>0;S=S*256+F[C+I],I+=G,U-=8);for(O=S&(1<<-U)-1,S>>=-U,U+=T;U>0;O=O*256+F[C+I],I+=G,U-=8);if(S===0)S=1-W;else{if(S===z)return O?NaN:(k?-1:1)*(1/0);O=O+Math.pow(2,T),S=S-W}return(k?-1:1)*O*Math.pow(2,S-T)},B.write=function(F,C,N,T,_,S){var O,$,z,W=S*8-_-1,U=(1<<W)-1,I=U>>1,G=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=T?0:S-1,M=T?1:-1,q=C<0||C===0&&1/C<0?1:0;for(C=Math.abs(C),isNaN(C)||C===1/0?($=isNaN(C)?1:0,O=U):(O=Math.floor(Math.log(C)/Math.LN2),C*(z=Math.pow(2,-O))<1&&(O--,z*=2),O+I>=1?C+=G/z:C+=G*Math.pow(2,1-I),C*z>=2&&(O++,z/=2),O+I>=U?($=0,O=U):O+I>=1?($=(C*z-1)*Math.pow(2,_),O=O+I):($=C*Math.pow(2,I-1)*Math.pow(2,_),O=0));_>=8;F[N+k]=$&255,k+=M,$/=256,_-=8);for(O=O<<_|$,W+=_;W>0;F[N+k]=O&255,k+=M,O/=256,W-=8);F[N+k-M]|=q*128};(function(F){const C=r,N=B,T=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;F.Buffer=U,F.SlowBuffer=J,F.INSPECT_MAX_BYTES=50;const _=2147483647;F.kMaxLength=_;const{Uint8Array:S,ArrayBuffer:O,SharedArrayBuffer:$}=globalThis;U.TYPED_ARRAY_SUPPORT=z(),!U.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function z(){try{const me=new S(1),re={foo:function(){return 42}};return Object.setPrototypeOf(re,S.prototype),Object.setPrototypeOf(me,re),me.foo()===42}catch{return!1}}Object.defineProperty(U.prototype,"parent",{enumerable:!0,get:function(){if(U.isBuffer(this))return this.buffer}}),Object.defineProperty(U.prototype,"offset",{enumerable:!0,get:function(){if(U.isBuffer(this))return this.byteOffset}});function W(me){if(me>_)throw new RangeError('The value "'+me+'" is invalid for option "size"');const re=new S(me);return Object.setPrototypeOf(re,U.prototype),re}function U(me,re,ne){if(typeof me=="number"){if(typeof re=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return M(me)}return I(me,re,ne)}U.poolSize=8192;function I(me,re,ne){if(typeof me=="string")return q(me,re);if(O.isView(me))return H(me);if(me==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof me);if($t(me,O)||me&&$t(me.buffer,O)||typeof $<"u"&&($t(me,$)||me&&$t(me.buffer,$)))return Q(me,re,ne);if(typeof me=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Ae=me.valueOf&&me.valueOf();if(Ae!=null&&Ae!==me)return U.from(Ae,re,ne);const Oe=D(me);if(Oe)return Oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof me[Symbol.toPrimitive]=="function")return U.from(me[Symbol.toPrimitive]("string"),re,ne);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof me)}U.from=function(me,re,ne){return I(me,re,ne)},Object.setPrototypeOf(U.prototype,S.prototype),Object.setPrototypeOf(U,S);function G(me){if(typeof me!="number")throw new TypeError('"size" argument must be of type number');if(me<0)throw new RangeError('The value "'+me+'" is invalid for option "size"')}function k(me,re,ne){return G(me),me<=0?W(me):re!==void 0?typeof ne=="string"?W(me).fill(re,ne):W(me).fill(re):W(me)}U.alloc=function(me,re,ne){return k(me,re,ne)};function M(me){return G(me),W(me<0?0:Y(me)|0)}U.allocUnsafe=function(me){return M(me)},U.allocUnsafeSlow=function(me){return M(me)};function q(me,re){if((typeof re!="string"||re==="")&&(re="utf8"),!U.isEncoding(re))throw new TypeError("Unknown encoding: "+re);const ne=L(me,re)|0;let Ae=W(ne);const Oe=Ae.write(me,re);return Oe!==ne&&(Ae=Ae.slice(0,Oe)),Ae}function K(me){const re=me.length<0?0:Y(me.length)|0,ne=W(re);for(let Ae=0;Ae<re;Ae+=1)ne[Ae]=me[Ae]&255;return ne}function H(me){if($t(me,S)){const re=new S(me);return Q(re.buffer,re.byteOffset,re.byteLength)}return K(me)}function Q(me,re,ne){if(re<0||me.byteLength<re)throw new RangeError('"offset" is outside of buffer bounds');if(me.byteLength<re+(ne||0))throw new RangeError('"length" is outside of buffer bounds');let Ae;return re===void 0&&ne===void 0?Ae=new S(me):ne===void 0?Ae=new S(me,re):Ae=new S(me,re,ne),Object.setPrototypeOf(Ae,U.prototype),Ae}function D(me){if(U.isBuffer(me)){const re=Y(me.length)|0,ne=W(re);return ne.length===0||me.copy(ne,0,0,re),ne}if(me.length!==void 0)return typeof me.length!="number"||vr(me.length)?W(0):K(me);if(me.type==="Buffer"&&Array.isArray(me.data))return K(me.data)}function Y(me){if(me>=_)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+_.toString(16)+" bytes");return me|0}function J(me){return+me!=me&&(me=0),U.alloc(+me)}U.isBuffer=function(re){return re!=null&&re._isBuffer===!0&&re!==U.prototype},U.compare=function(re,ne){if($t(re,S)&&(re=U.from(re,re.offset,re.byteLength)),$t(ne,S)&&(ne=U.from(ne,ne.offset,ne.byteLength)),!U.isBuffer(re)||!U.isBuffer(ne))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(re===ne)return 0;let Ae=re.length,Oe=ne.length;for(let qe=0,We=Math.min(Ae,Oe);qe<We;++qe)if(re[qe]!==ne[qe]){Ae=re[qe],Oe=ne[qe];break}return Ae<Oe?-1:Oe<Ae?1:0},U.isEncoding=function(re){switch(String(re).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},U.concat=function(re,ne){if(!Array.isArray(re))throw new TypeError('"list" argument must be an Array of Buffers');if(re.length===0)return U.alloc(0);let Ae;if(ne===void 0)for(ne=0,Ae=0;Ae<re.length;++Ae)ne+=re[Ae].length;const Oe=U.allocUnsafe(ne);let qe=0;for(Ae=0;Ae<re.length;++Ae){let We=re[Ae];if($t(We,S))qe+We.length>Oe.length?(U.isBuffer(We)||(We=U.from(We)),We.copy(Oe,qe)):S.prototype.set.call(Oe,We,qe);else if(U.isBuffer(We))We.copy(Oe,qe);else throw new TypeError('"list" argument must be an Array of Buffers');qe+=We.length}return Oe};function L(me,re){if(U.isBuffer(me))return me.length;if(O.isView(me)||$t(me,O))return me.byteLength;if(typeof me!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof me);const ne=me.length,Ae=arguments.length>2&&arguments[2]===!0;if(!Ae&&ne===0)return 0;let Oe=!1;for(;;)switch(re){case"ascii":case"latin1":case"binary":return ne;case"utf8":case"utf-8":return et(me).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne*2;case"hex":return ne>>>1;case"base64":return nt(me).length;default:if(Oe)return Ae?-1:et(me).length;re=(""+re).toLowerCase(),Oe=!0}}U.byteLength=L;function Z(me,re,ne){let Ae=!1;if((re===void 0||re<0)&&(re=0),re>this.length||((ne===void 0||ne>this.length)&&(ne=this.length),ne<=0)||(ne>>>=0,re>>>=0,ne<=re))return"";for(me||(me="utf8");;)switch(me){case"hex":return Fe(this,re,ne);case"utf8":case"utf-8":return Be(this,re,ne);case"ascii":return ke(this,re,ne);case"latin1":case"binary":return we(this,re,ne);case"base64":return be(this,re,ne);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pe(this,re,ne);default:if(Ae)throw new TypeError("Unknown encoding: "+me);me=(me+"").toLowerCase(),Ae=!0}}U.prototype._isBuffer=!0;function oe(me,re,ne){const Ae=me[re];me[re]=me[ne],me[ne]=Ae}U.prototype.swap16=function(){const re=this.length;if(re%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let ne=0;ne<re;ne+=2)oe(this,ne,ne+1);return this},U.prototype.swap32=function(){const re=this.length;if(re%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let ne=0;ne<re;ne+=4)oe(this,ne,ne+3),oe(this,ne+1,ne+2);return this},U.prototype.swap64=function(){const re=this.length;if(re%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let ne=0;ne<re;ne+=8)oe(this,ne,ne+7),oe(this,ne+1,ne+6),oe(this,ne+2,ne+5),oe(this,ne+3,ne+4);return this},U.prototype.toString=function(){const re=this.length;return re===0?"":arguments.length===0?Be(this,0,re):Z.apply(this,arguments)},U.prototype.toLocaleString=U.prototype.toString,U.prototype.equals=function(re){if(!U.isBuffer(re))throw new TypeError("Argument must be a Buffer");return this===re?!0:U.compare(this,re)===0},U.prototype.inspect=function(){let re="";const ne=F.INSPECT_MAX_BYTES;return re=this.toString("hex",0,ne).replace(/(.{2})/g,"$1 ").trim(),this.length>ne&&(re+=" ... "),"<Buffer "+re+">"},T&&(U.prototype[T]=U.prototype.inspect),U.prototype.compare=function(re,ne,Ae,Oe,qe){if($t(re,S)&&(re=U.from(re,re.offset,re.byteLength)),!U.isBuffer(re))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof re);if(ne===void 0&&(ne=0),Ae===void 0&&(Ae=re?re.length:0),Oe===void 0&&(Oe=0),qe===void 0&&(qe=this.length),ne<0||Ae>re.length||Oe<0||qe>this.length)throw new RangeError("out of range index");if(Oe>=qe&&ne>=Ae)return 0;if(Oe>=qe)return-1;if(ne>=Ae)return 1;if(ne>>>=0,Ae>>>=0,Oe>>>=0,qe>>>=0,this===re)return 0;let We=qe-Oe,ct=Ae-ne;const Rt=Math.min(We,ct),_t=this.slice(Oe,qe),Et=re.slice(ne,Ae);for(let ot=0;ot<Rt;++ot)if(_t[ot]!==Et[ot]){We=_t[ot],ct=Et[ot];break}return We<ct?-1:ct<We?1:0};function ce(me,re,ne,Ae,Oe){if(me.length===0)return-1;if(typeof ne=="string"?(Ae=ne,ne=0):ne>2147483647?ne=2147483647:ne<-2147483648&&(ne=-2147483648),ne=+ne,vr(ne)&&(ne=Oe?0:me.length-1),ne<0&&(ne=me.length+ne),ne>=me.length){if(Oe)return-1;ne=me.length-1}else if(ne<0)if(Oe)ne=0;else return-1;if(typeof re=="string"&&(re=U.from(re,Ae)),U.isBuffer(re))return re.length===0?-1:de(me,re,ne,Ae,Oe);if(typeof re=="number")return re=re&255,typeof S.prototype.indexOf=="function"?Oe?S.prototype.indexOf.call(me,re,ne):S.prototype.lastIndexOf.call(me,re,ne):de(me,[re],ne,Ae,Oe);throw new TypeError("val must be string, number or Buffer")}function de(me,re,ne,Ae,Oe){let qe=1,We=me.length,ct=re.length;if(Ae!==void 0&&(Ae=String(Ae).toLowerCase(),Ae==="ucs2"||Ae==="ucs-2"||Ae==="utf16le"||Ae==="utf-16le")){if(me.length<2||re.length<2)return-1;qe=2,We/=2,ct/=2,ne/=2}function Rt(Et,ot){return qe===1?Et[ot]:Et.readUInt16BE(ot*qe)}let _t;if(Oe){let Et=-1;for(_t=ne;_t<We;_t++)if(Rt(me,_t)===Rt(re,Et===-1?0:_t-Et)){if(Et===-1&&(Et=_t),_t-Et+1===ct)return Et*qe}else Et!==-1&&(_t-=_t-Et),Et=-1}else for(ne+ct>We&&(ne=We-ct),_t=ne;_t>=0;_t--){let Et=!0;for(let ot=0;ot<ct;ot++)if(Rt(me,_t+ot)!==Rt(re,ot)){Et=!1;break}if(Et)return _t}return-1}U.prototype.includes=function(re,ne,Ae){return this.indexOf(re,ne,Ae)!==-1},U.prototype.indexOf=function(re,ne,Ae){return ce(this,re,ne,Ae,!0)},U.prototype.lastIndexOf=function(re,ne,Ae){return ce(this,re,ne,Ae,!1)};function xe(me,re,ne,Ae){ne=Number(ne)||0;const Oe=me.length-ne;Ae?(Ae=Number(Ae),Ae>Oe&&(Ae=Oe)):Ae=Oe;const qe=re.length;Ae>qe/2&&(Ae=qe/2);let We;for(We=0;We<Ae;++We){const ct=parseInt(re.substr(We*2,2),16);if(vr(ct))return We;me[ne+We]=ct}return We}function te(me,re,ne,Ae){return Yt(et(re,me.length-ne),me,ne,Ae)}function ae(me,re,ne,Ae){return Yt(st(re),me,ne,Ae)}function le(me,re,ne,Ae){return Yt(nt(re),me,ne,Ae)}function ue(me,re,ne,Ae){return Yt(rt(re,me.length-ne),me,ne,Ae)}U.prototype.write=function(re,ne,Ae,Oe){if(ne===void 0)Oe="utf8",Ae=this.length,ne=0;else if(Ae===void 0&&typeof ne=="string")Oe=ne,Ae=this.length,ne=0;else if(isFinite(ne))ne=ne>>>0,isFinite(Ae)?(Ae=Ae>>>0,Oe===void 0&&(Oe="utf8")):(Oe=Ae,Ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const qe=this.length-ne;if((Ae===void 0||Ae>qe)&&(Ae=qe),re.length>0&&(Ae<0||ne<0)||ne>this.length)throw new RangeError("Attempt to write outside buffer bounds");Oe||(Oe="utf8");let We=!1;for(;;)switch(Oe){case"hex":return xe(this,re,ne,Ae);case"utf8":case"utf-8":return te(this,re,ne,Ae);case"ascii":case"latin1":case"binary":return ae(this,re,ne,Ae);case"base64":return le(this,re,ne,Ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,re,ne,Ae);default:if(We)throw new TypeError("Unknown encoding: "+Oe);Oe=(""+Oe).toLowerCase(),We=!0}},U.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function be(me,re,ne){return re===0&&ne===me.length?C.fromByteArray(me):C.fromByteArray(me.slice(re,ne))}function Be(me,re,ne){ne=Math.min(me.length,ne);const Ae=[];let Oe=re;for(;Oe<ne;){const qe=me[Oe];let We=null,ct=qe>239?4:qe>223?3:qe>191?2:1;if(Oe+ct<=ne){let Rt,_t,Et,ot;switch(ct){case 1:qe<128&&(We=qe);break;case 2:Rt=me[Oe+1],(Rt&192)===128&&(ot=(qe&31)<<6|Rt&63,ot>127&&(We=ot));break;case 3:Rt=me[Oe+1],_t=me[Oe+2],(Rt&192)===128&&(_t&192)===128&&(ot=(qe&15)<<12|(Rt&63)<<6|_t&63,ot>2047&&(ot<55296||ot>57343)&&(We=ot));break;case 4:Rt=me[Oe+1],_t=me[Oe+2],Et=me[Oe+3],(Rt&192)===128&&(_t&192)===128&&(Et&192)===128&&(ot=(qe&15)<<18|(Rt&63)<<12|(_t&63)<<6|Et&63,ot>65535&&ot<1114112&&(We=ot))}}We===null?(We=65533,ct=1):We>65535&&(We-=65536,Ae.push(We>>>10&1023|55296),We=56320|We&1023),Ae.push(We),Oe+=ct}return Se(Ae)}const Ce=4096;function Se(me){const re=me.length;if(re<=Ce)return String.fromCharCode.apply(String,me);let ne="",Ae=0;for(;Ae<re;)ne+=String.fromCharCode.apply(String,me.slice(Ae,Ae+=Ce));return ne}function ke(me,re,ne){let Ae="";ne=Math.min(me.length,ne);for(let Oe=re;Oe<ne;++Oe)Ae+=String.fromCharCode(me[Oe]&127);return Ae}function we(me,re,ne){let Ae="";ne=Math.min(me.length,ne);for(let Oe=re;Oe<ne;++Oe)Ae+=String.fromCharCode(me[Oe]);return Ae}function Fe(me,re,ne){const Ae=me.length;(!re||re<0)&&(re=0),(!ne||ne<0||ne>Ae)&&(ne=Ae);let Oe="";for(let qe=re;qe<ne;++qe)Oe+=En[me[qe]];return Oe}function Pe(me,re,ne){const Ae=me.slice(re,ne);let Oe="";for(let qe=0;qe<Ae.length-1;qe+=2)Oe+=String.fromCharCode(Ae[qe]+Ae[qe+1]*256);return Oe}U.prototype.slice=function(re,ne){const Ae=this.length;re=~~re,ne=ne===void 0?Ae:~~ne,re<0?(re+=Ae,re<0&&(re=0)):re>Ae&&(re=Ae),ne<0?(ne+=Ae,ne<0&&(ne=0)):ne>Ae&&(ne=Ae),ne<re&&(ne=re);const Oe=this.subarray(re,ne);return Object.setPrototypeOf(Oe,U.prototype),Oe};function Ye(me,re,ne){if(me%1!==0||me<0)throw new RangeError("offset is not uint");if(me+re>ne)throw new RangeError("Trying to access beyond buffer length")}U.prototype.readUintLE=U.prototype.readUIntLE=function(re,ne,Ae){re=re>>>0,ne=ne>>>0,Ae||Ye(re,ne,this.length);let Oe=this[re],qe=1,We=0;for(;++We<ne&&(qe*=256);)Oe+=this[re+We]*qe;return Oe},U.prototype.readUintBE=U.prototype.readUIntBE=function(re,ne,Ae){re=re>>>0,ne=ne>>>0,Ae||Ye(re,ne,this.length);let Oe=this[re+--ne],qe=1;for(;ne>0&&(qe*=256);)Oe+=this[re+--ne]*qe;return Oe},U.prototype.readUint8=U.prototype.readUInt8=function(re,ne){return re=re>>>0,ne||Ye(re,1,this.length),this[re]},U.prototype.readUint16LE=U.prototype.readUInt16LE=function(re,ne){return re=re>>>0,ne||Ye(re,2,this.length),this[re]|this[re+1]<<8},U.prototype.readUint16BE=U.prototype.readUInt16BE=function(re,ne){return re=re>>>0,ne||Ye(re,2,this.length),this[re]<<8|this[re+1]},U.prototype.readUint32LE=U.prototype.readUInt32LE=function(re,ne){return re=re>>>0,ne||Ye(re,4,this.length),(this[re]|this[re+1]<<8|this[re+2]<<16)+this[re+3]*16777216},U.prototype.readUint32BE=U.prototype.readUInt32BE=function(re,ne){return re=re>>>0,ne||Ye(re,4,this.length),this[re]*16777216+(this[re+1]<<16|this[re+2]<<8|this[re+3])},U.prototype.readBigUInt64LE=_r(function(re){re=re>>>0,_e(re,"offset");const ne=this[re],Ae=this[re+7];(ne===void 0||Ae===void 0)&&je(re,this.length-8);const Oe=ne+this[++re]*2**8+this[++re]*2**16+this[++re]*2**24,qe=this[++re]+this[++re]*2**8+this[++re]*2**16+Ae*2**24;return BigInt(Oe)+(BigInt(qe)<<BigInt(32))}),U.prototype.readBigUInt64BE=_r(function(re){re=re>>>0,_e(re,"offset");const ne=this[re],Ae=this[re+7];(ne===void 0||Ae===void 0)&&je(re,this.length-8);const Oe=ne*2**24+this[++re]*2**16+this[++re]*2**8+this[++re],qe=this[++re]*2**24+this[++re]*2**16+this[++re]*2**8+Ae;return(BigInt(Oe)<<BigInt(32))+BigInt(qe)}),U.prototype.readIntLE=function(re,ne,Ae){re=re>>>0,ne=ne>>>0,Ae||Ye(re,ne,this.length);let Oe=this[re],qe=1,We=0;for(;++We<ne&&(qe*=256);)Oe+=this[re+We]*qe;return qe*=128,Oe>=qe&&(Oe-=Math.pow(2,8*ne)),Oe},U.prototype.readIntBE=function(re,ne,Ae){re=re>>>0,ne=ne>>>0,Ae||Ye(re,ne,this.length);let Oe=ne,qe=1,We=this[re+--Oe];for(;Oe>0&&(qe*=256);)We+=this[re+--Oe]*qe;return qe*=128,We>=qe&&(We-=Math.pow(2,8*ne)),We},U.prototype.readInt8=function(re,ne){return re=re>>>0,ne||Ye(re,1,this.length),this[re]&128?(255-this[re]+1)*-1:this[re]},U.prototype.readInt16LE=function(re,ne){re=re>>>0,ne||Ye(re,2,this.length);const Ae=this[re]|this[re+1]<<8;return Ae&32768?Ae|4294901760:Ae},U.prototype.readInt16BE=function(re,ne){re=re>>>0,ne||Ye(re,2,this.length);const Ae=this[re+1]|this[re]<<8;return Ae&32768?Ae|4294901760:Ae},U.prototype.readInt32LE=function(re,ne){return re=re>>>0,ne||Ye(re,4,this.length),this[re]|this[re+1]<<8|this[re+2]<<16|this[re+3]<<24},U.prototype.readInt32BE=function(re,ne){return re=re>>>0,ne||Ye(re,4,this.length),this[re]<<24|this[re+1]<<16|this[re+2]<<8|this[re+3]},U.prototype.readBigInt64LE=_r(function(re){re=re>>>0,_e(re,"offset");const ne=this[re],Ae=this[re+7];(ne===void 0||Ae===void 0)&&je(re,this.length-8);const Oe=this[re+4]+this[re+5]*2**8+this[re+6]*2**16+(Ae<<24);return(BigInt(Oe)<<BigInt(32))+BigInt(ne+this[++re]*2**8+this[++re]*2**16+this[++re]*2**24)}),U.prototype.readBigInt64BE=_r(function(re){re=re>>>0,_e(re,"offset");const ne=this[re],Ae=this[re+7];(ne===void 0||Ae===void 0)&&je(re,this.length-8);const Oe=(ne<<24)+this[++re]*2**16+this[++re]*2**8+this[++re];return(BigInt(Oe)<<BigInt(32))+BigInt(this[++re]*2**24+this[++re]*2**16+this[++re]*2**8+Ae)}),U.prototype.readFloatLE=function(re,ne){return re=re>>>0,ne||Ye(re,4,this.length),N.read(this,re,!0,23,4)},U.prototype.readFloatBE=function(re,ne){return re=re>>>0,ne||Ye(re,4,this.length),N.read(this,re,!1,23,4)},U.prototype.readDoubleLE=function(re,ne){return re=re>>>0,ne||Ye(re,8,this.length),N.read(this,re,!0,52,8)},U.prototype.readDoubleBE=function(re,ne){return re=re>>>0,ne||Ye(re,8,this.length),N.read(this,re,!1,52,8)};function Ve(me,re,ne,Ae,Oe,qe){if(!U.isBuffer(me))throw new TypeError('"buffer" argument must be a Buffer instance');if(re>Oe||re<qe)throw new RangeError('"value" argument is out of bounds');if(ne+Ae>me.length)throw new RangeError("Index out of range")}U.prototype.writeUintLE=U.prototype.writeUIntLE=function(re,ne,Ae,Oe){if(re=+re,ne=ne>>>0,Ae=Ae>>>0,!Oe){const ct=Math.pow(2,8*Ae)-1;Ve(this,re,ne,Ae,ct,0)}let qe=1,We=0;for(this[ne]=re&255;++We<Ae&&(qe*=256);)this[ne+We]=re/qe&255;return ne+Ae},U.prototype.writeUintBE=U.prototype.writeUIntBE=function(re,ne,Ae,Oe){if(re=+re,ne=ne>>>0,Ae=Ae>>>0,!Oe){const ct=Math.pow(2,8*Ae)-1;Ve(this,re,ne,Ae,ct,0)}let qe=Ae-1,We=1;for(this[ne+qe]=re&255;--qe>=0&&(We*=256);)this[ne+qe]=re/We&255;return ne+Ae},U.prototype.writeUint8=U.prototype.writeUInt8=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,1,255,0),this[ne]=re&255,ne+1},U.prototype.writeUint16LE=U.prototype.writeUInt16LE=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,2,65535,0),this[ne]=re&255,this[ne+1]=re>>>8,ne+2},U.prototype.writeUint16BE=U.prototype.writeUInt16BE=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,2,65535,0),this[ne]=re>>>8,this[ne+1]=re&255,ne+2},U.prototype.writeUint32LE=U.prototype.writeUInt32LE=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,4,4294967295,0),this[ne+3]=re>>>24,this[ne+2]=re>>>16,this[ne+1]=re>>>8,this[ne]=re&255,ne+4},U.prototype.writeUint32BE=U.prototype.writeUInt32BE=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,4,4294967295,0),this[ne]=re>>>24,this[ne+1]=re>>>16,this[ne+2]=re>>>8,this[ne+3]=re&255,ne+4};function Ee(me,re,ne,Ae,Oe){he(re,Ae,Oe,me,ne,7);let qe=Number(re&BigInt(4294967295));me[ne++]=qe,qe=qe>>8,me[ne++]=qe,qe=qe>>8,me[ne++]=qe,qe=qe>>8,me[ne++]=qe;let We=Number(re>>BigInt(32)&BigInt(4294967295));return me[ne++]=We,We=We>>8,me[ne++]=We,We=We>>8,me[ne++]=We,We=We>>8,me[ne++]=We,ne}function ve(me,re,ne,Ae,Oe){he(re,Ae,Oe,me,ne,7);let qe=Number(re&BigInt(4294967295));me[ne+7]=qe,qe=qe>>8,me[ne+6]=qe,qe=qe>>8,me[ne+5]=qe,qe=qe>>8,me[ne+4]=qe;let We=Number(re>>BigInt(32)&BigInt(4294967295));return me[ne+3]=We,We=We>>8,me[ne+2]=We,We=We>>8,me[ne+1]=We,We=We>>8,me[ne]=We,ne+8}U.prototype.writeBigUInt64LE=_r(function(re,ne=0){return Ee(this,re,ne,BigInt(0),BigInt("0xffffffffffffffff"))}),U.prototype.writeBigUInt64BE=_r(function(re,ne=0){return ve(this,re,ne,BigInt(0),BigInt("0xffffffffffffffff"))}),U.prototype.writeIntLE=function(re,ne,Ae,Oe){if(re=+re,ne=ne>>>0,!Oe){const Rt=Math.pow(2,8*Ae-1);Ve(this,re,ne,Ae,Rt-1,-Rt)}let qe=0,We=1,ct=0;for(this[ne]=re&255;++qe<Ae&&(We*=256);)re<0&&ct===0&&this[ne+qe-1]!==0&&(ct=1),this[ne+qe]=(re/We>>0)-ct&255;return ne+Ae},U.prototype.writeIntBE=function(re,ne,Ae,Oe){if(re=+re,ne=ne>>>0,!Oe){const Rt=Math.pow(2,8*Ae-1);Ve(this,re,ne,Ae,Rt-1,-Rt)}let qe=Ae-1,We=1,ct=0;for(this[ne+qe]=re&255;--qe>=0&&(We*=256);)re<0&&ct===0&&this[ne+qe+1]!==0&&(ct=1),this[ne+qe]=(re/We>>0)-ct&255;return ne+Ae},U.prototype.writeInt8=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,1,127,-128),re<0&&(re=255+re+1),this[ne]=re&255,ne+1},U.prototype.writeInt16LE=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,2,32767,-32768),this[ne]=re&255,this[ne+1]=re>>>8,ne+2},U.prototype.writeInt16BE=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,2,32767,-32768),this[ne]=re>>>8,this[ne+1]=re&255,ne+2},U.prototype.writeInt32LE=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,4,2147483647,-2147483648),this[ne]=re&255,this[ne+1]=re>>>8,this[ne+2]=re>>>16,this[ne+3]=re>>>24,ne+4},U.prototype.writeInt32BE=function(re,ne,Ae){return re=+re,ne=ne>>>0,Ae||Ve(this,re,ne,4,2147483647,-2147483648),re<0&&(re=4294967295+re+1),this[ne]=re>>>24,this[ne+1]=re>>>16,this[ne+2]=re>>>8,this[ne+3]=re&255,ne+4},U.prototype.writeBigInt64LE=_r(function(re,ne=0){return Ee(this,re,ne,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),U.prototype.writeBigInt64BE=_r(function(re,ne=0){return ve(this,re,ne,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Te(me,re,ne,Ae,Oe,qe){if(ne+Ae>me.length)throw new RangeError("Index out of range");if(ne<0)throw new RangeError("Index out of range")}function Re(me,re,ne,Ae,Oe){return re=+re,ne=ne>>>0,Oe||Te(me,re,ne,4),N.write(me,re,ne,Ae,23,4),ne+4}U.prototype.writeFloatLE=function(re,ne,Ae){return Re(this,re,ne,!0,Ae)},U.prototype.writeFloatBE=function(re,ne,Ae){return Re(this,re,ne,!1,Ae)};function ye(me,re,ne,Ae,Oe){return re=+re,ne=ne>>>0,Oe||Te(me,re,ne,8),N.write(me,re,ne,Ae,52,8),ne+8}U.prototype.writeDoubleLE=function(re,ne,Ae){return ye(this,re,ne,!0,Ae)},U.prototype.writeDoubleBE=function(re,ne,Ae){return ye(this,re,ne,!1,Ae)},U.prototype.copy=function(re,ne,Ae,Oe){if(!U.isBuffer(re))throw new TypeError("argument should be a Buffer");if(Ae||(Ae=0),!Oe&&Oe!==0&&(Oe=this.length),ne>=re.length&&(ne=re.length),ne||(ne=0),Oe>0&&Oe<Ae&&(Oe=Ae),Oe===Ae||re.length===0||this.length===0)return 0;if(ne<0)throw new RangeError("targetStart out of bounds");if(Ae<0||Ae>=this.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("sourceEnd out of bounds");Oe>this.length&&(Oe=this.length),re.length-ne<Oe-Ae&&(Oe=re.length-ne+Ae);const qe=Oe-Ae;return this===re&&typeof S.prototype.copyWithin=="function"?this.copyWithin(ne,Ae,Oe):S.prototype.set.call(re,this.subarray(Ae,Oe),ne),qe},U.prototype.fill=function(re,ne,Ae,Oe){if(typeof re=="string"){if(typeof ne=="string"?(Oe=ne,ne=0,Ae=this.length):typeof Ae=="string"&&(Oe=Ae,Ae=this.length),Oe!==void 0&&typeof Oe!="string")throw new TypeError("encoding must be a string");if(typeof Oe=="string"&&!U.isEncoding(Oe))throw new TypeError("Unknown encoding: "+Oe);if(re.length===1){const We=re.charCodeAt(0);(Oe==="utf8"&&We<128||Oe==="latin1")&&(re=We)}}else typeof re=="number"?re=re&255:typeof re=="boolean"&&(re=Number(re));if(ne<0||this.length<ne||this.length<Ae)throw new RangeError("Out of range index");if(Ae<=ne)return this;ne=ne>>>0,Ae=Ae===void 0?this.length:Ae>>>0,re||(re=0);let qe;if(typeof re=="number")for(qe=ne;qe<Ae;++qe)this[qe]=re;else{const We=U.isBuffer(re)?re:U.from(re,Oe),ct=We.length;if(ct===0)throw new TypeError('The value "'+re+'" is invalid for argument "value"');for(qe=0;qe<Ae-ne;++qe)this[qe+ne]=We[qe%ct]}return this};const Ne={};function ie(me,re,ne){Ne[me]=class extends ne{constructor(){super(),Object.defineProperty(this,"message",{value:re.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${me}]`,this.stack,delete this.name}get code(){return me}set code(Oe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Oe,writable:!0})}toString(){return`${this.name} [${me}]: ${this.message}`}}}ie("ERR_BUFFER_OUT_OF_BOUNDS",function(me){return me?`${me} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ie("ERR_INVALID_ARG_TYPE",function(me,re){return`The "${me}" argument must be of type number. Received type ${typeof re}`},TypeError),ie("ERR_OUT_OF_RANGE",function(me,re,ne){let Ae=`The value of "${me}" is out of range.`,Oe=ne;return Number.isInteger(ne)&&Math.abs(ne)>2**32?Oe=P(String(ne)):typeof ne=="bigint"&&(Oe=String(ne),(ne>BigInt(2)**BigInt(32)||ne<-(BigInt(2)**BigInt(32)))&&(Oe=P(Oe)),Oe+="n"),Ae+=` It must be ${re}. Received ${Oe}`,Ae},RangeError);function P(me){let re="",ne=me.length;const Ae=me[0]==="-"?1:0;for(;ne>=Ae+4;ne-=3)re=`_${me.slice(ne-3,ne)}${re}`;return`${me.slice(0,ne)}${re}`}function V(me,re,ne){_e(re,"offset"),(me[re]===void 0||me[re+ne]===void 0)&&je(re,me.length-(ne+1))}function he(me,re,ne,Ae,Oe,qe){if(me>ne||me<re){const We=typeof re=="bigint"?"n":"";let ct;throw re===0||re===BigInt(0)?ct=`>= 0${We} and < 2${We} ** ${(qe+1)*8}${We}`:ct=`>= -(2${We} ** ${(qe+1)*8-1}${We}) and < 2 ** ${(qe+1)*8-1}${We}`,new Ne.ERR_OUT_OF_RANGE("value",ct,me)}V(Ae,Oe,qe)}function _e(me,re){if(typeof me!="number")throw new Ne.ERR_INVALID_ARG_TYPE(re,"number",me)}function je(me,re,ne){throw Math.floor(me)!==me?(_e(me,ne),new Ne.ERR_OUT_OF_RANGE("offset","an integer",me)):re<0?new Ne.ERR_BUFFER_OUT_OF_BOUNDS:new Ne.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${re}`,me)}const Ie=/[^+/0-9A-Za-z-_]/g;function Ze(me){if(me=me.split("=")[0],me=me.trim().replace(Ie,""),me.length<2)return"";for(;me.length%4!==0;)me=me+"=";return me}function et(me,re){re=re||1/0;let ne;const Ae=me.length;let Oe=null;const qe=[];for(let We=0;We<Ae;++We){if(ne=me.charCodeAt(We),ne>55295&&ne<57344){if(!Oe){if(ne>56319){(re-=3)>-1&&qe.push(239,191,189);continue}else if(We+1===Ae){(re-=3)>-1&&qe.push(239,191,189);continue}Oe=ne;continue}if(ne<56320){(re-=3)>-1&&qe.push(239,191,189),Oe=ne;continue}ne=(Oe-55296<<10|ne-56320)+65536}else Oe&&(re-=3)>-1&&qe.push(239,191,189);if(Oe=null,ne<128){if((re-=1)<0)break;qe.push(ne)}else if(ne<2048){if((re-=2)<0)break;qe.push(ne>>6|192,ne&63|128)}else if(ne<65536){if((re-=3)<0)break;qe.push(ne>>12|224,ne>>6&63|128,ne&63|128)}else if(ne<1114112){if((re-=4)<0)break;qe.push(ne>>18|240,ne>>12&63|128,ne>>6&63|128,ne&63|128)}else throw new Error("Invalid code point")}return qe}function st(me){const re=[];for(let ne=0;ne<me.length;++ne)re.push(me.charCodeAt(ne)&255);return re}function rt(me,re){let ne,Ae,Oe;const qe=[];for(let We=0;We<me.length&&!((re-=2)<0);++We)ne=me.charCodeAt(We),Ae=ne>>8,Oe=ne%256,qe.push(Oe),qe.push(Ae);return qe}function nt(me){return C.toByteArray(Ze(me))}function Yt(me,re,ne,Ae){let Oe;for(Oe=0;Oe<Ae&&!(Oe+ne>=re.length||Oe>=me.length);++Oe)re[Oe+ne]=me[Oe];return Oe}function $t(me,re){return me instanceof re||me!=null&&me.constructor!=null&&me.constructor.name!=null&&me.constructor.name===re.name}function vr(me){return me!==me}const En=(function(){const me="0123456789abcdef",re=new Array(256);for(let ne=0;ne<16;++ne){const Ae=ne*16;for(let Oe=0;Oe<16;++Oe)re[Ae+Oe]=me[ne]+me[Oe]}return re})();function _r(me){return typeof BigInt>"u"?ds:me}function ds(){throw new Error("BigInt not supported")}})(t);const j=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=j,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode})(dist$3)),dist$3}var hasRequiredSafeBuffer;function requireSafeBuffer(){return hasRequiredSafeBuffer||(hasRequiredSafeBuffer=1,(function(e,t){var r=requireDist$4(),n=r.Buffer;function o(l,u){for(var f in l)u[f]=l[f]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a);function a(l,u,f){return n(l,u,f)}a.prototype=Object.create(n.prototype),o(n,a),a.from=function(l,u,f){if(typeof l=="number")throw new TypeError("Argument must not be a number");return n(l,u,f)},a.alloc=function(l,u,f){if(typeof l!="number")throw new TypeError("Argument must be a number");var x=n(l);return u!==void 0?typeof f=="string"?x.fill(u,f):x.fill(u):x.fill(0),x},a.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return n(l)},a.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(l)}})(safeBuffer,safeBuffer.exports)),safeBuffer.exports}var isarray,hasRequiredIsarray;function requireIsarray(){if(hasRequiredIsarray)return isarray;hasRequiredIsarray=1;var e={}.toString;return isarray=Array.isArray||function(t){return e.call(t)=="[object Array]"},isarray}var type,hasRequiredType;function requireType(){return hasRequiredType||(hasRequiredType=1,type=TypeError),type}var esObjectAtoms,hasRequiredEsObjectAtoms;function requireEsObjectAtoms(){return hasRequiredEsObjectAtoms||(hasRequiredEsObjectAtoms=1,esObjectAtoms=Object),esObjectAtoms}var esErrors,hasRequiredEsErrors;function requireEsErrors(){return hasRequiredEsErrors||(hasRequiredEsErrors=1,esErrors=Error),esErrors}var _eval,hasRequired_eval;function require_eval(){return hasRequired_eval||(hasRequired_eval=1,_eval=EvalError),_eval}var range$4,hasRequiredRange;function requireRange(){return hasRequiredRange||(hasRequiredRange=1,range$4=RangeError),range$4}var ref,hasRequiredRef;function requireRef(){return hasRequiredRef||(hasRequiredRef=1,ref=ReferenceError),ref}var syntax,hasRequiredSyntax;function requireSyntax(){return hasRequiredSyntax||(hasRequiredSyntax=1,syntax=SyntaxError),syntax}var uri,hasRequiredUri;function requireUri(){return hasRequiredUri||(hasRequiredUri=1,uri=URIError),uri}var abs,hasRequiredAbs;function requireAbs(){return hasRequiredAbs||(hasRequiredAbs=1,abs=Math.abs),abs}var floor,hasRequiredFloor;function requireFloor(){return hasRequiredFloor||(hasRequiredFloor=1,floor=Math.floor),floor}var max,hasRequiredMax;function requireMax(){return hasRequiredMax||(hasRequiredMax=1,max=Math.max),max}var min,hasRequiredMin;function requireMin(){return hasRequiredMin||(hasRequiredMin=1,min=Math.min),min}var pow,hasRequiredPow;function requirePow(){return hasRequiredPow||(hasRequiredPow=1,pow=Math.pow),pow}var round,hasRequiredRound;function requireRound(){return hasRequiredRound||(hasRequiredRound=1,round=Math.round),round}var _isNaN,hasRequired_isNaN;function require_isNaN(){return hasRequired_isNaN||(hasRequired_isNaN=1,_isNaN=Number.isNaN||function(t){return t!==t}),_isNaN}var sign,hasRequiredSign;function requireSign(){if(hasRequiredSign)return sign;hasRequiredSign=1;var e=require_isNaN();return sign=function(r){return e(r)||r===0?r:r<0?-1:1},sign}var gOPD,hasRequiredGOPD;function requireGOPD(){return hasRequiredGOPD||(hasRequiredGOPD=1,gOPD=Object.getOwnPropertyDescriptor),gOPD}var gopd,hasRequiredGopd;function requireGopd(){if(hasRequiredGopd)return gopd;hasRequiredGopd=1;var e=requireGOPD();if(e)try{e([],"length")}catch{e=null}return gopd=e,gopd}var esDefineProperty,hasRequiredEsDefineProperty;function requireEsDefineProperty(){if(hasRequiredEsDefineProperty)return esDefineProperty;hasRequiredEsDefineProperty=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return esDefineProperty=e,esDefineProperty}var shams$1,hasRequiredShams$1;function requireShams$1(){return hasRequiredShams$1||(hasRequiredShams$1=1,shams$1=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var o=42;t[r]=o;for(var a in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var l=Object.getOwnPropertySymbols(t);if(l.length!==1||l[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(t,r);if(u.value!==o||u.enumerable!==!0)return!1}return!0}),shams$1}var hasSymbols,hasRequiredHasSymbols;function requireHasSymbols(){if(hasRequiredHasSymbols)return hasSymbols;hasRequiredHasSymbols=1;var e=typeof Symbol<"u"&&Symbol,t=requireShams$1();return hasSymbols=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},hasSymbols}var Reflect_getPrototypeOf,hasRequiredReflect_getPrototypeOf;function requireReflect_getPrototypeOf(){return hasRequiredReflect_getPrototypeOf||(hasRequiredReflect_getPrototypeOf=1,Reflect_getPrototypeOf=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Reflect_getPrototypeOf}var Object_getPrototypeOf,hasRequiredObject_getPrototypeOf;function requireObject_getPrototypeOf(){if(hasRequiredObject_getPrototypeOf)return Object_getPrototypeOf;hasRequiredObject_getPrototypeOf=1;var e=requireEsObjectAtoms();return Object_getPrototypeOf=e.getPrototypeOf||null,Object_getPrototypeOf}var implementation$4,hasRequiredImplementation$4;function requireImplementation$4(){if(hasRequiredImplementation$4)return implementation$4;hasRequiredImplementation$4=1;var e="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,r=Math.max,n="[object Function]",o=function(f,x){for(var p=[],g=0;g<f.length;g+=1)p[g]=f[g];for(var y=0;y<x.length;y+=1)p[y+f.length]=x[y];return p},a=function(f,x){for(var p=[],g=x,y=0;g<f.length;g+=1,y+=1)p[y]=f[g];return p},l=function(u,f){for(var x="",p=0;p<u.length;p+=1)x+=u[p],p+1<u.length&&(x+=f);return x};return implementation$4=function(f){var x=this;if(typeof x!="function"||t.apply(x)!==n)throw new TypeError(e+x);for(var p=a(arguments,1),g,y=function(){if(this instanceof g){var j=x.apply(this,o(p,arguments));return Object(j)===j?j:this}return x.apply(f,o(p,arguments))},b=r(0,x.length-p.length),w=[],v=0;v<b;v++)w[v]="$"+v;if(g=Function("binder","return function ("+l(w,",")+"){ return binder.apply(this,arguments); }")(y),x.prototype){var B=function(){};B.prototype=x.prototype,g.prototype=new B,B.prototype=null}return g},implementation$4}var functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var e=requireImplementation$4();return functionBind=Function.prototype.bind||e,functionBind}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){return hasRequiredFunctionCall||(hasRequiredFunctionCall=1,functionCall=Function.prototype.call),functionCall}var functionApply,hasRequiredFunctionApply;function requireFunctionApply(){return hasRequiredFunctionApply||(hasRequiredFunctionApply=1,functionApply=Function.prototype.apply),functionApply}var reflectApply,hasRequiredReflectApply;function requireReflectApply(){return hasRequiredReflectApply||(hasRequiredReflectApply=1,reflectApply=typeof Reflect<"u"&&Reflect&&Reflect.apply),reflectApply}var actualApply,hasRequiredActualApply;function requireActualApply(){if(hasRequiredActualApply)return actualApply;hasRequiredActualApply=1;var e=requireFunctionBind(),t=requireFunctionApply(),r=requireFunctionCall(),n=requireReflectApply();return actualApply=n||e.call(r,t),actualApply}var callBindApplyHelpers,hasRequiredCallBindApplyHelpers;function requireCallBindApplyHelpers(){if(hasRequiredCallBindApplyHelpers)return callBindApplyHelpers;hasRequiredCallBindApplyHelpers=1;var e=requireFunctionBind(),t=requireType(),r=requireFunctionCall(),n=requireActualApply();return callBindApplyHelpers=function(a){if(a.length<1||typeof a[0]!="function")throw new t("a function is required");return n(e,r,a)},callBindApplyHelpers}var get$1,hasRequiredGet;function requireGet(){if(hasRequiredGet)return get$1;hasRequiredGet=1;var e=requireCallBindApplyHelpers(),t=requireGopd(),r;try{r=[].__proto__===Array.prototype}catch(l){if(!l||typeof l!="object"||!("code"in l)||l.code!=="ERR_PROTO_ACCESS")throw l}var n=!!r&&t&&t(Object.prototype,"__proto__"),o=Object,a=o.getPrototypeOf;return get$1=n&&typeof n.get=="function"?e([n.get]):typeof a=="function"?function(u){return a(u==null?u:o(u))}:!1,get$1}var getProto,hasRequiredGetProto;function requireGetProto(){if(hasRequiredGetProto)return getProto;hasRequiredGetProto=1;var e=requireReflect_getPrototypeOf(),t=requireObject_getPrototypeOf(),r=requireGet();return getProto=e?function(o){return e(o)}:t?function(o){if(!o||typeof o!="object"&&typeof o!="function")throw new TypeError("getProto: not an object");return t(o)}:r?function(o){return r(o)}:null,getProto}var hasown,hasRequiredHasown;function requireHasown(){if(hasRequiredHasown)return hasown;hasRequiredHasown=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=requireFunctionBind();return hasown=r.call(e,t),hasown}var getIntrinsic,hasRequiredGetIntrinsic;function requireGetIntrinsic(){if(hasRequiredGetIntrinsic)return getIntrinsic;hasRequiredGetIntrinsic=1;var e,t=requireEsObjectAtoms(),r=requireEsErrors(),n=require_eval(),o=requireRange(),a=requireRef(),l=requireSyntax(),u=requireType(),f=requireUri(),x=requireAbs(),p=requireFloor(),g=requireMax(),y=requireMin(),b=requirePow(),w=requireRound(),v=requireSign(),B=Function,j=function(xe){try{return B('"use strict"; return ('+xe+").constructor;")()}catch{}},F=requireGopd(),C=requireEsDefineProperty(),N=function(){throw new u},T=F?(function(){try{return arguments.callee,N}catch{try{return F(arguments,"callee").get}catch{return N}}})():N,_=requireHasSymbols()(),S=requireGetProto(),O=requireObject_getPrototypeOf(),$=requireReflect_getPrototypeOf(),z=requireFunctionApply(),W=requireFunctionCall(),U={},I=typeof Uint8Array>"u"||!S?e:S(Uint8Array),G={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":_&&S?S([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":U,"%AsyncGenerator%":U,"%AsyncGeneratorFunction%":U,"%AsyncIteratorPrototype%":U,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":B,"%GeneratorFunction%":U,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":_&&S?S(S([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!_||!S?e:S(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":F,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":o,"%ReferenceError%":a,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!_||!S?e:S(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":_&&S?S(""[Symbol.iterator]()):e,"%Symbol%":_?Symbol:e,"%SyntaxError%":l,"%ThrowTypeError%":T,"%TypedArray%":I,"%TypeError%":u,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":f,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":W,"%Function.prototype.apply%":z,"%Object.defineProperty%":C,"%Object.getPrototypeOf%":O,"%Math.abs%":x,"%Math.floor%":p,"%Math.max%":g,"%Math.min%":y,"%Math.pow%":b,"%Math.round%":w,"%Math.sign%":v,"%Reflect.getPrototypeOf%":$};if(S)try{null.error}catch(xe){var k=S(S(xe));G["%Error.prototype%"]=k}var M=function xe(te){var ae;if(te==="%AsyncFunction%")ae=j("async function () {}");else if(te==="%GeneratorFunction%")ae=j("function* () {}");else if(te==="%AsyncGeneratorFunction%")ae=j("async function* () {}");else if(te==="%AsyncGenerator%"){var le=xe("%AsyncGeneratorFunction%");le&&(ae=le.prototype)}else if(te==="%AsyncIteratorPrototype%"){var ue=xe("%AsyncGenerator%");ue&&S&&(ae=S(ue.prototype))}return G[te]=ae,ae},q={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},K=requireFunctionBind(),H=requireHasown(),Q=K.call(W,Array.prototype.concat),D=K.call(z,Array.prototype.splice),Y=K.call(W,String.prototype.replace),J=K.call(W,String.prototype.slice),L=K.call(W,RegExp.prototype.exec),Z=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,oe=/\\(\\)?/g,ce=function(te){var ae=J(te,0,1),le=J(te,-1);if(ae==="%"&&le!=="%")throw new l("invalid intrinsic syntax, expected closing `%`");if(le==="%"&&ae!=="%")throw new l("invalid intrinsic syntax, expected opening `%`");var ue=[];return Y(te,Z,function(be,Be,Ce,Se){ue[ue.length]=Ce?Y(Se,oe,"$1"):Be||be}),ue},de=function(te,ae){var le=te,ue;if(H(q,le)&&(ue=q[le],le="%"+ue[0]+"%"),H(G,le)){var be=G[le];if(be===U&&(be=M(le)),typeof be>"u"&&!ae)throw new u("intrinsic "+te+" exists, but is not available. Please file an issue!");return{alias:ue,name:le,value:be}}throw new l("intrinsic "+te+" does not exist!")};return getIntrinsic=function(te,ae){if(typeof te!="string"||te.length===0)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof ae!="boolean")throw new u('"allowMissing" argument must be a boolean');if(L(/^%?[^%]*%?$/,te)===null)throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var le=ce(te),ue=le.length>0?le[0]:"",be=de("%"+ue+"%",ae),Be=be.name,Ce=be.value,Se=!1,ke=be.alias;ke&&(ue=ke[0],D(le,Q([0,1],ke)));for(var we=1,Fe=!0;we<le.length;we+=1){var Pe=le[we],Ye=J(Pe,0,1),Ve=J(Pe,-1);if((Ye==='"'||Ye==="'"||Ye==="`"||Ve==='"'||Ve==="'"||Ve==="`")&&Ye!==Ve)throw new l("property names with quotes must have matching quotes");if((Pe==="constructor"||!Fe)&&(Se=!0),ue+="."+Pe,Be="%"+ue+"%",H(G,Be))Ce=G[Be];else if(Ce!=null){if(!(Pe in Ce)){if(!ae)throw new u("base intrinsic for "+te+" exists, but the property is not available.");return}if(F&&we+1>=le.length){var Ee=F(Ce,Pe);Fe=!!Ee,Fe&&"get"in Ee&&!("originalValue"in Ee.get)?Ce=Ee.get:Ce=Ce[Pe]}else Fe=H(Ce,Pe),Ce=Ce[Pe];Fe&&!Se&&(G[Be]=Ce)}}return Ce},getIntrinsic}var callBound$1,hasRequiredCallBound$1;function requireCallBound$1(){if(hasRequiredCallBound$1)return callBound$1;hasRequiredCallBound$1=1;var e=requireGetIntrinsic(),t=requireCallBindApplyHelpers(),r=t([e("%String.prototype.indexOf%")]);return callBound$1=function(o,a){var l=e(o,!!a);return typeof l=="function"&&r(o,".prototype.")>-1?t([l]):l},callBound$1}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var e=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,n;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw n}}),n={},t(function(){throw 42},null,r)}catch(F){F!==n&&(t=null)}else t=null;var o=/^\s*class\b/,a=function(C){try{var N=e.call(C);return o.test(N)}catch{return!1}},l=function(C){try{return a(C)?!1:(e.call(C),!0)}catch{return!1}},u=Object.prototype.toString,f="[object Object]",x="[object Function]",p="[object GeneratorFunction]",g="[object HTMLAllCollection]",y="[object HTML document.all class]",b="[object HTMLCollection]",w=typeof Symbol=="function"&&!!Symbol.toStringTag,v=!(0 in[,]),B=function(){return!1};if(typeof document=="object"){var j=document.all;u.call(j)===u.call(document.all)&&(B=function(C){if((v||!C)&&(typeof C>"u"||typeof C=="object"))try{var N=u.call(C);return(N===g||N===y||N===b||N===f)&&C("")==null}catch{}return!1})}return isCallable=t?function(C){if(B(C))return!0;if(!C||typeof C!="function"&&typeof C!="object")return!1;try{t(C,null,r)}catch(N){if(N!==n)return!1}return!a(C)&&l(C)}:function(C){if(B(C))return!0;if(!C||typeof C!="function"&&typeof C!="object")return!1;if(w)return l(C);if(a(C))return!1;var N=u.call(C);return N!==x&&N!==p&&!/^\[object HTML/.test(N)?!1:l(C)},isCallable}var forEach,hasRequiredForEach;function requireForEach(){if(hasRequiredForEach)return forEach;hasRequiredForEach=1;var e=requireIsCallable(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,n=function(f,x,p){for(var g=0,y=f.length;g<y;g++)r.call(f,g)&&(p==null?x(f[g],g,f):x.call(p,f[g],g,f))},o=function(f,x,p){for(var g=0,y=f.length;g<y;g++)p==null?x(f.charAt(g),g,f):x.call(p,f.charAt(g),g,f)},a=function(f,x,p){for(var g in f)r.call(f,g)&&(p==null?x(f[g],g,f):x.call(p,f[g],g,f))};function l(u){return t.call(u)==="[object Array]"}return forEach=function(f,x,p){if(!e(x))throw new TypeError("iterator must be a function");var g;arguments.length>=3&&(g=p),l(f)?n(f,x,g):typeof f=="string"?o(f,x,g):a(f,x,g)},forEach}var possibleTypedArrayNames,hasRequiredPossibleTypedArrayNames;function requirePossibleTypedArrayNames(){return hasRequiredPossibleTypedArrayNames||(hasRequiredPossibleTypedArrayNames=1,possibleTypedArrayNames=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),possibleTypedArrayNames}var availableTypedArrays,hasRequiredAvailableTypedArrays;function requireAvailableTypedArrays(){if(hasRequiredAvailableTypedArrays)return availableTypedArrays;hasRequiredAvailableTypedArrays=1;var e=requirePossibleTypedArrayNames(),t=typeof globalThis>"u"?commonjsGlobal:globalThis;return availableTypedArrays=function(){for(var n=[],o=0;o<e.length;o++)typeof t[e[o]]=="function"&&(n[n.length]=e[o]);return n},availableTypedArrays}var callBind={exports:{}},defineDataProperty,hasRequiredDefineDataProperty;function requireDefineDataProperty(){if(hasRequiredDefineDataProperty)return defineDataProperty;hasRequiredDefineDataProperty=1;var e=requireEsDefineProperty(),t=requireSyntax(),r=requireType(),n=requireGopd();return defineDataProperty=function(a,l,u){if(!a||typeof a!="object"&&typeof a!="function")throw new r("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var f=arguments.length>3?arguments[3]:null,x=arguments.length>4?arguments[4]:null,p=arguments.length>5?arguments[5]:null,g=arguments.length>6?arguments[6]:!1,y=!!n&&n(a,l);if(e)e(a,l,{configurable:p===null&&y?y.configurable:!p,enumerable:f===null&&y?y.enumerable:!f,value:u,writable:x===null&&y?y.writable:!x});else if(g||!f&&!x&&!p)a[l]=u;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},defineDataProperty}var hasPropertyDescriptors_1,hasRequiredHasPropertyDescriptors;function requireHasPropertyDescriptors(){if(hasRequiredHasPropertyDescriptors)return hasPropertyDescriptors_1;hasRequiredHasPropertyDescriptors=1;var e=requireEsDefineProperty(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},hasPropertyDescriptors_1=t,hasPropertyDescriptors_1}var setFunctionLength,hasRequiredSetFunctionLength;function requireSetFunctionLength(){if(hasRequiredSetFunctionLength)return setFunctionLength;hasRequiredSetFunctionLength=1;var e=requireGetIntrinsic(),t=requireDefineDataProperty(),r=requireHasPropertyDescriptors()(),n=requireGopd(),o=requireType(),a=e("%Math.floor%");return setFunctionLength=function(u,f){if(typeof u!="function")throw new o("`fn` is not a function");if(typeof f!="number"||f<0||f>4294967295||a(f)!==f)throw new o("`length` must be a positive 32-bit integer");var x=arguments.length>2&&!!arguments[2],p=!0,g=!0;if("length"in u&&n){var y=n(u,"length");y&&!y.configurable&&(p=!1),y&&!y.writable&&(g=!1)}return(p||g||!x)&&(r?t(u,"length",f,!0,!0):t(u,"length",f)),u},setFunctionLength}var applyBind,hasRequiredApplyBind;function requireApplyBind(){if(hasRequiredApplyBind)return applyBind;hasRequiredApplyBind=1;var e=requireFunctionBind(),t=requireFunctionApply(),r=requireActualApply();return applyBind=function(){return r(e,t,arguments)},applyBind}var hasRequiredCallBind;function requireCallBind(){return hasRequiredCallBind||(hasRequiredCallBind=1,(function(e){var t=requireSetFunctionLength(),r=requireEsDefineProperty(),n=requireCallBindApplyHelpers(),o=requireApplyBind();e.exports=function(l){var u=n(arguments),f=l.length-(arguments.length-1);return t(u,1+(f>0?f:0),!0)},r?r(e.exports,"apply",{value:o}):e.exports.apply=o})(callBind)),callBind.exports}var shams,hasRequiredShams;function requireShams(){if(hasRequiredShams)return shams;hasRequiredShams=1;var e=requireShams$1();return shams=function(){return e()&&!!Symbol.toStringTag},shams}var whichTypedArray,hasRequiredWhichTypedArray;function requireWhichTypedArray(){if(hasRequiredWhichTypedArray)return whichTypedArray;hasRequiredWhichTypedArray=1;var e=requireForEach(),t=requireAvailableTypedArrays(),r=requireCallBind(),n=requireCallBound$1(),o=requireGopd(),a=requireGetProto(),l=n("Object.prototype.toString"),u=requireShams()(),f=typeof globalThis>"u"?commonjsGlobal:globalThis,x=t(),p=n("String.prototype.slice"),g=n("Array.prototype.indexOf",!0)||function(B,j){for(var F=0;F<B.length;F+=1)if(B[F]===j)return F;return-1},y={__proto__:null};u&&o&&a?e(x,function(v){var B=new f[v];if(Symbol.toStringTag in B&&a){var j=a(B),F=o(j,Symbol.toStringTag);if(!F&&j){var C=a(j);F=o(C,Symbol.toStringTag)}y["$"+v]=r(F.get)}}):e(x,function(v){var B=new f[v],j=B.slice||B.set;j&&(y["$"+v]=r(j))});var b=function(B){var j=!1;return e(y,function(F,C){if(!j)try{"$"+F(B)===C&&(j=p(C,1))}catch{}}),j},w=function(B){var j=!1;return e(y,function(F,C){if(!j)try{F(B),j=p(C,1)}catch{}}),j};return whichTypedArray=function(B){if(!B||typeof B!="object")return!1;if(!u){var j=p(l(B),8,-1);return g(x,j)>-1?j:j!=="Object"?!1:w(B)}return o?b(B):null},whichTypedArray}var isTypedArray,hasRequiredIsTypedArray;function requireIsTypedArray(){if(hasRequiredIsTypedArray)return isTypedArray;hasRequiredIsTypedArray=1;var e=requireWhichTypedArray();return isTypedArray=function(r){return!!e(r)},isTypedArray}var typedArrayBuffer,hasRequiredTypedArrayBuffer;function requireTypedArrayBuffer(){if(hasRequiredTypedArrayBuffer)return typedArrayBuffer;hasRequiredTypedArrayBuffer=1;var e=requireType(),t=requireCallBound$1(),r=t("TypedArray.prototype.buffer",!0),n=requireIsTypedArray();return typedArrayBuffer=r||function(a){if(!n(a))throw new e("Not a Typed Array");return a.buffer},typedArrayBuffer}var toBuffer,hasRequiredToBuffer;function requireToBuffer(){if(hasRequiredToBuffer)return toBuffer;hasRequiredToBuffer=1;var e=requireSafeBuffer().Buffer,t=requireIsarray(),r=requireTypedArrayBuffer(),n=ArrayBuffer.isView||function(f){try{return r(f),!0}catch{return!1}},o=typeof Uint8Array<"u",a=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l=a&&(e.prototype instanceof Uint8Array||e.TYPED_ARRAY_SUPPORT);return toBuffer=function(f,x){if(e.isBuffer(f))return f.constructor&&!("isBuffer"in f)?e.from(f):f;if(typeof f=="string")return e.from(f,x);if(a&&n(f)){if(f.byteLength===0)return e.alloc(0);if(l){var p=e.from(f.buffer,f.byteOffset,f.byteLength);if(p.byteLength===f.byteLength)return p}var g=f instanceof Uint8Array?f:new Uint8Array(f.buffer,f.byteOffset,f.byteLength),y=e.from(g);if(y.length===f.byteLength)return y}if(o&&f instanceof Uint8Array)return e.from(f);var b=t(f);if(b)for(var w=0;w<f.length;w+=1){var v=f[w];if(typeof v!="number"||v<0||v>255||~~v!==v)throw new RangeError("Array items must be numbers in the range 0-255.")}if(b||e.isBuffer(f)&&f.constructor&&typeof f.constructor.isBuffer=="function"&&f.constructor.isBuffer(f))return e.from(f);throw new TypeError('The "data" argument must be a string, an Array, a Buffer, a Uint8Array, or a DataView.')},toBuffer}var hash,hasRequiredHash;function requireHash(){if(hasRequiredHash)return hash;hasRequiredHash=1;var e=requireSafeBuffer().Buffer,t=requireToBuffer();function r(n,o){this._block=e.alloc(n),this._finalSize=o,this._blockSize=n,this._len=0}return r.prototype.update=function(n,o){n=t(n,o||"utf8");for(var a=this._block,l=this._blockSize,u=n.length,f=this._len,x=0;x<u;){for(var p=f%l,g=Math.min(u-x,l-p),y=0;y<g;y++)a[p+y]=n[x+y];f+=g,x+=g,f%l===0&&this._update(a)}return this._len+=u,this},r.prototype.digest=function(n){var o=this._len%this._blockSize;this._block[o]=128,this._block.fill(0,o+1),o>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var l=(a&4294967295)>>>0,u=(a-l)/4294967296;this._block.writeUInt32BE(u,this._blockSize-8),this._block.writeUInt32BE(l,this._blockSize-4)}this._update(this._block);var f=this._hash();return n?f.toString(n):f},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},hash=r,hash}var sha,hasRequiredSha;function requireSha(){if(hasRequiredSha)return sha;hasRequiredSha=1;var e=requireInherits_browser(),t=requireHash(),r=requireSafeBuffer().Buffer,n=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function a(){this.init(),this._w=o,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function l(x){return x<<5|x>>>27}function u(x){return x<<30|x>>>2}function f(x,p,g,y){return x===0?p&g|~p&y:x===2?p&g|p&y|g&y:p^g^y}return a.prototype._update=function(x){for(var p=this._w,g=this._a|0,y=this._b|0,b=this._c|0,w=this._d|0,v=this._e|0,B=0;B<16;++B)p[B]=x.readInt32BE(B*4);for(;B<80;++B)p[B]=p[B-3]^p[B-8]^p[B-14]^p[B-16];for(var j=0;j<80;++j){var F=~~(j/20),C=l(g)+f(F,y,b,w)+v+p[j]+n[F]|0;v=w,w=b,b=u(y),y=g,g=C}this._a=g+this._a|0,this._b=y+this._b|0,this._c=b+this._c|0,this._d=w+this._d|0,this._e=v+this._e|0},a.prototype._hash=function(){var x=r.allocUnsafe(20);return x.writeInt32BE(this._a|0,0),x.writeInt32BE(this._b|0,4),x.writeInt32BE(this._c|0,8),x.writeInt32BE(this._d|0,12),x.writeInt32BE(this._e|0,16),x},sha=a,sha}var sha1,hasRequiredSha1;function requireSha1(){if(hasRequiredSha1)return sha1;hasRequiredSha1=1;var e=requireInherits_browser(),t=requireHash(),r=requireSafeBuffer().Buffer,n=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function a(){this.init(),this._w=o,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function l(p){return p<<1|p>>>31}function u(p){return p<<5|p>>>27}function f(p){return p<<30|p>>>2}function x(p,g,y,b){return p===0?g&y|~g&b:p===2?g&y|g&b|y&b:g^y^b}return a.prototype._update=function(p){for(var g=this._w,y=this._a|0,b=this._b|0,w=this._c|0,v=this._d|0,B=this._e|0,j=0;j<16;++j)g[j]=p.readInt32BE(j*4);for(;j<80;++j)g[j]=l(g[j-3]^g[j-8]^g[j-14]^g[j-16]);for(var F=0;F<80;++F){var C=~~(F/20),N=u(y)+x(C,b,w,v)+B+g[F]+n[C]|0;B=v,v=w,w=f(b),b=y,y=N}this._a=y+this._a|0,this._b=b+this._b|0,this._c=w+this._c|0,this._d=v+this._d|0,this._e=B+this._e|0},a.prototype._hash=function(){var p=r.allocUnsafe(20);return p.writeInt32BE(this._a|0,0),p.writeInt32BE(this._b|0,4),p.writeInt32BE(this._c|0,8),p.writeInt32BE(this._d|0,12),p.writeInt32BE(this._e|0,16),p},sha1=a,sha1}var sha256$2,hasRequiredSha256;function requireSha256(){if(hasRequiredSha256)return sha256$2;hasRequiredSha256=1;var e=requireInherits_browser(),t=requireHash(),r=requireSafeBuffer().Buffer,n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function a(){this.init(),this._w=o,t.call(this,64,56)}e(a,t),a.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function l(y,b,w){return w^y&(b^w)}function u(y,b,w){return y&b|w&(y|b)}function f(y){return(y>>>2|y<<30)^(y>>>13|y<<19)^(y>>>22|y<<10)}function x(y){return(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7)}function p(y){return(y>>>7|y<<25)^(y>>>18|y<<14)^y>>>3}function g(y){return(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10}return a.prototype._update=function(y){for(var b=this._w,w=this._a|0,v=this._b|0,B=this._c|0,j=this._d|0,F=this._e|0,C=this._f|0,N=this._g|0,T=this._h|0,_=0;_<16;++_)b[_]=y.readInt32BE(_*4);for(;_<64;++_)b[_]=g(b[_-2])+b[_-7]+p(b[_-15])+b[_-16]|0;for(var S=0;S<64;++S){var O=T+x(F)+l(F,C,N)+n[S]+b[S]|0,$=f(w)+u(w,v,B)|0;T=N,N=C,C=F,F=j+O|0,j=B,B=v,v=w,w=O+$|0}this._a=w+this._a|0,this._b=v+this._b|0,this._c=B+this._c|0,this._d=j+this._d|0,this._e=F+this._e|0,this._f=C+this._f|0,this._g=N+this._g|0,this._h=T+this._h|0},a.prototype._hash=function(){var y=r.allocUnsafe(32);return y.writeInt32BE(this._a,0),y.writeInt32BE(this._b,4),y.writeInt32BE(this._c,8),y.writeInt32BE(this._d,12),y.writeInt32BE(this._e,16),y.writeInt32BE(this._f,20),y.writeInt32BE(this._g,24),y.writeInt32BE(this._h,28),y},sha256$2=a,sha256$2}var sha224,hasRequiredSha224;function requireSha224(){if(hasRequiredSha224)return sha224;hasRequiredSha224=1;var e=requireInherits_browser(),t=requireSha256(),r=requireHash(),n=requireSafeBuffer().Buffer,o=new Array(64);function a(){this.init(),this._w=o,r.call(this,64,56)}return e(a,t),a.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},a.prototype._hash=function(){var l=n.allocUnsafe(28);return l.writeInt32BE(this._a,0),l.writeInt32BE(this._b,4),l.writeInt32BE(this._c,8),l.writeInt32BE(this._d,12),l.writeInt32BE(this._e,16),l.writeInt32BE(this._f,20),l.writeInt32BE(this._g,24),l},sha224=a,sha224}var sha512,hasRequiredSha512;function requireSha512(){if(hasRequiredSha512)return sha512;hasRequiredSha512=1;var e=requireInherits_browser(),t=requireHash(),r=requireSafeBuffer().Buffer,n=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function a(){this.init(),this._w=o,t.call(this,128,112)}e(a,t),a.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function l(v,B,j){return j^v&(B^j)}function u(v,B,j){return v&B|j&(v|B)}function f(v,B){return(v>>>28|B<<4)^(B>>>2|v<<30)^(B>>>7|v<<25)}function x(v,B){return(v>>>14|B<<18)^(v>>>18|B<<14)^(B>>>9|v<<23)}function p(v,B){return(v>>>1|B<<31)^(v>>>8|B<<24)^v>>>7}function g(v,B){return(v>>>1|B<<31)^(v>>>8|B<<24)^(v>>>7|B<<25)}function y(v,B){return(v>>>19|B<<13)^(B>>>29|v<<3)^v>>>6}function b(v,B){return(v>>>19|B<<13)^(B>>>29|v<<3)^(v>>>6|B<<26)}function w(v,B){return v>>>0<B>>>0?1:0}return a.prototype._update=function(v){for(var B=this._w,j=this._ah|0,F=this._bh|0,C=this._ch|0,N=this._dh|0,T=this._eh|0,_=this._fh|0,S=this._gh|0,O=this._hh|0,$=this._al|0,z=this._bl|0,W=this._cl|0,U=this._dl|0,I=this._el|0,G=this._fl|0,k=this._gl|0,M=this._hl|0,q=0;q<32;q+=2)B[q]=v.readInt32BE(q*4),B[q+1]=v.readInt32BE(q*4+4);for(;q<160;q+=2){var K=B[q-30],H=B[q-30+1],Q=p(K,H),D=g(H,K);K=B[q-4],H=B[q-4+1];var Y=y(K,H),J=b(H,K),L=B[q-14],Z=B[q-14+1],oe=B[q-32],ce=B[q-32+1],de=D+Z|0,xe=Q+L+w(de,D)|0;de=de+J|0,xe=xe+Y+w(de,J)|0,de=de+ce|0,xe=xe+oe+w(de,ce)|0,B[q]=xe,B[q+1]=de}for(var te=0;te<160;te+=2){xe=B[te],de=B[te+1];var ae=u(j,F,C),le=u($,z,W),ue=f(j,$),be=f($,j),Be=x(T,I),Ce=x(I,T),Se=n[te],ke=n[te+1],we=l(T,_,S),Fe=l(I,G,k),Pe=M+Ce|0,Ye=O+Be+w(Pe,M)|0;Pe=Pe+Fe|0,Ye=Ye+we+w(Pe,Fe)|0,Pe=Pe+ke|0,Ye=Ye+Se+w(Pe,ke)|0,Pe=Pe+de|0,Ye=Ye+xe+w(Pe,de)|0;var Ve=be+le|0,Ee=ue+ae+w(Ve,be)|0;O=S,M=k,S=_,k=G,_=T,G=I,I=U+Pe|0,T=N+Ye+w(I,U)|0,N=C,U=W,C=F,W=z,F=j,z=$,$=Pe+Ve|0,j=Ye+Ee+w($,Pe)|0}this._al=this._al+$|0,this._bl=this._bl+z|0,this._cl=this._cl+W|0,this._dl=this._dl+U|0,this._el=this._el+I|0,this._fl=this._fl+G|0,this._gl=this._gl+k|0,this._hl=this._hl+M|0,this._ah=this._ah+j+w(this._al,$)|0,this._bh=this._bh+F+w(this._bl,z)|0,this._ch=this._ch+C+w(this._cl,W)|0,this._dh=this._dh+N+w(this._dl,U)|0,this._eh=this._eh+T+w(this._el,I)|0,this._fh=this._fh+_+w(this._fl,G)|0,this._gh=this._gh+S+w(this._gl,k)|0,this._hh=this._hh+O+w(this._hl,M)|0},a.prototype._hash=function(){var v=r.allocUnsafe(64);function B(j,F,C){v.writeInt32BE(j,C),v.writeInt32BE(F,C+4)}return B(this._ah,this._al,0),B(this._bh,this._bl,8),B(this._ch,this._cl,16),B(this._dh,this._dl,24),B(this._eh,this._el,32),B(this._fh,this._fl,40),B(this._gh,this._gl,48),B(this._hh,this._hl,56),v},sha512=a,sha512}var sha384,hasRequiredSha384;function requireSha384(){if(hasRequiredSha384)return sha384;hasRequiredSha384=1;var e=requireInherits_browser(),t=requireSha512(),r=requireHash(),n=requireSafeBuffer().Buffer,o=new Array(160);function a(){this.init(),this._w=o,r.call(this,128,112)}return e(a,t),a.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},a.prototype._hash=function(){var l=n.allocUnsafe(48);function u(f,x,p){l.writeInt32BE(f,p),l.writeInt32BE(x,p+4)}return u(this._ah,this._al,0),u(this._bh,this._bl,8),u(this._ch,this._cl,16),u(this._dh,this._dl,24),u(this._eh,this._el,32),u(this._fh,this._fl,40),l},sha384=a,sha384}var hasRequiredSha_js;function requireSha_js(){return hasRequiredSha_js||(hasRequiredSha_js=1,(function(e){e.exports=function(r){var n=r.toLowerCase(),o=e.exports[n];if(!o)throw new Error(n+" is not supported (we accept pull requests)");return new o},e.exports.sha=requireSha(),e.exports.sha1=requireSha1(),e.exports.sha224=requireSha224(),e.exports.sha256=requireSha256(),e.exports.sha384=requireSha384(),e.exports.sha512=requireSha512()})(sha_js)),sha_js.exports}const createBuffer=Buffer$1.from&&Buffer$1.alloc&&Buffer$1.allocUnsafe&&Buffer$1.allocUnsafeSlow?Buffer$1.from:e=>new Buffer$1(e);function defineCrc(e,t){const r=(n,o)=>t(n,o)>>>0;return r.signed=t,r.unsigned=r,r.model=e,r}const crc1=defineCrc("crc1",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=~~t,n=0;for(let o=0;o<e.length;o++){const a=e[o];n+=a}return r+=n%256,r%256});let TABLE$8=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243];typeof Int32Array<"u"&&(TABLE$8=new Int32Array(TABLE$8));const crc8=defineCrc("crc-8",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=~~t;for(let n=0;n<e.length;n++){const o=e[n];r=TABLE$8[(r^o)&255]&255}return r});let TABLE$7=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];typeof Int32Array<"u"&&(TABLE$7=new Int32Array(TABLE$7));const crc81wire=defineCrc("dallas-1-wire",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=~~t;for(let n=0;n<e.length;n++){const o=e[n];r=TABLE$7[(r^o)&255]&255}return r});let TABLE$6=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];typeof Int32Array<"u"&&(TABLE$6=new Int32Array(TABLE$6));const crc16=defineCrc("crc-16",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=~~t;for(let n=0;n<e.length;n++){const o=e[n];r=(TABLE$6[(r^o)&255]^r>>8)&65535}return r});let TABLE$5=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];typeof Int32Array<"u"&&(TABLE$5=new Int32Array(TABLE$5));const crc16ccitt=defineCrc("ccitt",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:65535;for(let n=0;n<e.length;n++){const o=e[n];r=(TABLE$5[(r>>8^o)&255]^r<<8)&65535}return r});let TABLE$4=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];typeof Int32Array<"u"&&(TABLE$4=new Int32Array(TABLE$4));const crc16modbus=defineCrc("crc-16-modbus",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:65535;for(let n=0;n<e.length;n++){const o=e[n];r=(TABLE$4[(r^o)&255]^r>>8)&65535}return r}),crc16xmodem=defineCrc("xmodem",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:0;for(let n=0;n<e.length;n++){const o=e[n];let a=r>>>8&255;a^=o&255,a^=a>>>4,r=r<<8&65535,r^=a,a=a<<5&65535,r^=a,a=a<<7&65535,r^=a}return r});let TABLE$3=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];typeof Int32Array<"u"&&(TABLE$3=new Int32Array(TABLE$3));const crc16kermit=defineCrc("kermit",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:0;for(let n=0;n<e.length;n++){const o=e[n];r=(TABLE$3[(r^o)&255]^r>>8)&65535}return r});let TABLE$2=[0,8801531,9098509,825846,9692897,1419802,1651692,10452759,10584377,2608578,2839604,11344079,3303384,11807523,12104405,4128302,12930697,4391538,5217156,13227903,5679208,13690003,14450021,5910942,6606768,14844747,15604413,6837830,16197969,7431594,8256604,16494759,840169,9084178,8783076,18463,10434312,1670131,1434117,9678590,11358416,2825259,2590173,10602790,4109873,12122826,11821884,3289031,13213536,5231515,4409965,12912278,5929345,14431610,13675660,5693559,6823513,15618722,14863188,6588335,16513208,8238147,7417269,16212302,1680338,10481449,9664223,1391140,9061683,788936,36926,8838341,12067563,4091408,3340262,11844381,2868234,11372785,10555655,2579964,14478683,5939616,5650518,13661357,5180346,13190977,12967607,4428364,8219746,16457881,16234863,7468436,15633027,6866552,6578062,14816117,1405499,9649856,10463030,1698765,8819930,55329,803287,9047340,11858690,3325945,4072975,12086004,2561507,10574104,11387118,2853909,13647026,5664841,5958079,14460228,4446803,12949160,13176670,5194661,7454091,16249200,16476294,8201341,14834538,6559633,6852199,15647388,3360676,11864927,12161705,4185682,10527045,2551230,2782280,11286707,9619101,1346150,1577872,10379115,73852,8875143,9172337,899466,16124205,7357910,8182816,16421083,6680524,14918455,15678145,6911546,5736468,13747439,14507289,5968354,12873461,4334094,5159928,13170435,4167245,12180150,11879232,3346363,11301036,2767959,2532769,10545498,10360692,1596303,1360505,9604738,913813,9157998,8856728,92259,16439492,8164415,7343561,16138546,6897189,15692510,14936872,6662099,5986813,14488838,13733104,5750795,13156124,5174247,4352529,12855018,2810998,11315341,10498427,2522496,12124823,4148844,3397530,11901793,9135439,862644,110658,8912057,1606574,10407765,9590435,1317464,15706879,6940164,6651890,14889737,8145950,16384229,16161043,7394792,5123014,13133629,12910283,4370992,14535975,5997020,5707818,13718737,2504095,10516836,11329682,2796649,11916158,3383173,4130419,12143240,8893606,129117,876971,9121104,1331783,9576124,10389322,1625009,14908182,6633453,6925851,15721184,7380471,16175372,16402682,8127489,4389423,12891860,13119266,5137369,13704398,5722165,6015427,14517560];typeof Int32Array<"u"&&(TABLE$2=new Int32Array(TABLE$2));const crc24=defineCrc("crc-24",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=typeof t<"u"?~~t:11994318;for(let n=0;n<e.length;n++){const o=e[n];r=(TABLE$2[(r>>16^o)&255]^r<<8)&16777215}return r});let TABLE$1=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(TABLE$1=new Int32Array(TABLE$1));const crc32=defineCrc("crc-32",function(e,t){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=t===0?0:~~t^-1;for(let n=0;n<e.length;n++){const o=e[n];r=TABLE$1[(r^o)&255]^r>>>8}return r^-1});let TABLE=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(TABLE=new Int32Array(TABLE));const crcjam=defineCrc("jam",function(e,t=-1){Buffer$1.isBuffer(e)||(e=createBuffer(e));let r=t===0?0:~~t;for(let n=0;n<e.length;n++){const o=e[n];r=TABLE[(r^o)&255]^r>>>8}return r}),index$1={crc1,crc8,crc81wire,crc16,crc16ccitt,crc16modbus,crc16xmodem,crc16kermit,crc24,crc32,crcjam},crc=Object.freeze(Object.defineProperty({__proto__:null,crc1,crc16,crc16ccitt,crc16kermit,crc16modbus,crc16xmodem,crc24,crc32,crc8,crc81wire,crcjam,default:index$1},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(crc);var hasRequiredUtils$7;function requireUtils$7(){if(hasRequiredUtils$7)return utils$7;hasRequiredUtils$7=1;var e=utils$7&&utils$7.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(utils$7,"__esModule",{value:!0}),utils$7.bufferXOR=utils$7.setDifference=utils$7.arrayContains=utils$7.arraysEqual=utils$7.hasPrefix=utils$7.isURType=utils$7.intToBytes=utils$7.toUint32=utils$7.getCRCHex=utils$7.getCRC=utils$7.split=utils$7.partition=utils$7.sha256Hash=void 0;const t=e(requireSha_js()),r=require$$1,n=B=>t.default("sha256").update(B).digest();utils$7.sha256Hash=n;const o=(B,j)=>B.match(new RegExp(".{1,"+j+"}","g"))||[B];utils$7.partition=o;const a=(B,j)=>[B.slice(0,-j),B.slice(-j)];utils$7.split=a;const l=B=>r.crc32(B);utils$7.getCRC=l;const u=B=>r.crc32(B).toString(16).padStart(8,"0");utils$7.getCRCHex=u;const f=B=>B>>>0;utils$7.toUint32=f;const x=B=>{const j=new ArrayBuffer(4);return new DataView(j).setUint32(0,B,!1),Buffer.from(j)};utils$7.intToBytes=x;const p=B=>B.split("").every((j,F)=>{let C=B.charCodeAt(F);return 97<=C&&C<=122||48<=C&&C<=57||C===45});utils$7.isURType=p;const g=(B,j)=>B.indexOf(j)===0;utils$7.hasPrefix=g;const y=(B,j)=>B.length!==j.length?!1:B.every(F=>j.includes(F));utils$7.arraysEqual=y;const b=(B,j)=>j.every(F=>B.includes(F));utils$7.arrayContains=b;const w=(B,j)=>B.filter(F=>j.indexOf(F)<0);utils$7.setDifference=w;const v=(B,j)=>{const F=Math.max(B.length,j.length),C=Buffer.allocUnsafe(F);for(let N=0;N<F;++N)C[N]=B[N]^j[N];return C};return utils$7.bufferXOR=v,utils$7}var cbor={},main$1={exports:{}},main=main$1.exports,hasRequiredMain;function requireMain(){return hasRequiredMain||(hasRequiredMain=1,(function(e){(function(t,r){e.exports?e.exports=r():t.CBOR=r()})(main,function(){var t=(function(){function r(_){this.$hex=_}r.prototype={length:function(){return this.$hex.length/2},toString:function(_){if(!_||_==="hex"||_===16)return this.$hex;if(_==="utf-8"){for(var S="",O=0;O<this.$hex.length;O+=2)S+="%"+this.$hex.substring(O,O+2);return decodeURIComponent(S)}if(_==="latin"){for(var S=[],O=0;O<this.$hex.length;O+=2)S.push(parseInt(this.$hex.substring(O,O+2),16));return String.fromCharCode.apply(String,S)}throw new Error("Unrecognised format: "+_)}},r.fromLatinString=function(_){for(var S="",O=0;O<_.length;O++){var $=_.charCodeAt(O).toString(16);$.length===1&&($="0"+$),S+=$}return new r(S)},r.fromUtf8String=function(_){for(var S=encodeURIComponent(_),O="",$=0;$<S.length;$++)if(S.charAt($)==="%")O+=S.substring($+1,$+3),$+=2;else{var z=S.charCodeAt($).toString(16);z.length<2&&(z="0"+z),O+=z}return new r(O)};var n=[],o={},a=function(_){return function(){throw new Error(_+" not implemented")}};function l(){}l.prototype={peekByte:a("peekByte"),readByte:a("readByte"),readChunk:a("readChunk"),readFloat16:function(){var _=this.readUint16(),S=(_&32767)>>10,O=_&1023,$=_&32768;if(S===31)return O===0?$?-1/0:1/0:NaN;var z=S?Math.pow(2,S-25)*(1024+O):Math.pow(2,-24)*O;return $?-z:z},readFloat32:function(){var _=this.readUint32(),S=(_&2147483647)>>23,O=_&8388607,$=_&2147483648;if(S===255)return O===0?$?-1/0:1/0:NaN;var z=S?Math.pow(2,S-23-127)*(8388608+O):Math.pow(2,-149)*O;return $?-z:z},readFloat64:function(){var _=this.readUint32(),S=this.readUint32(),O=_>>20&2047,$=(_&1048575)*4294967296+S,z=_&2147483648;if(O===2047)return $===0?z?-1/0:1/0:NaN;var W=O?Math.pow(2,O-52-1023)*(4503599627370496+$):Math.pow(2,-1074)*$;return z?-W:W},readUint16:function(){return this.readByte()*256+this.readByte()},readUint32:function(){return this.readUint16()*65536+this.readUint16()},readUint64:function(){return this.readUint32()*4294967296+this.readUint32()}};function u(){}u.prototype={writeByte:a("writeByte"),result:a("result"),writeFloat16:a("writeFloat16"),writeFloat32:a("writeFloat32"),writeFloat64:a("writeFloat64"),writeUint16:function(_){this.writeByte(_>>8&255),this.writeByte(_&255)},writeUint32:function(_){this.writeUint16(_>>16&65535),this.writeUint16(_&65535)},writeUint64:function(_){if(_>=9007199254740992||_<=-9007199254740992)throw new Error("Cannot encode Uint64 of: "+_+" magnitude to big (floating point errors)");this.writeUint32(Math.floor(_/4294967296)),this.writeUint32(_%4294967296)},writeString:a("writeString"),canWriteBinary:function(_){return!1},writeBinary:a("writeChunk")};function f(_){var S=_.readByte(),O=S>>5,$=S&31;return{type:O,value:$}}function x(_,S){var O=_.value;if(O<24)return O;if(O==24)return S.readByte();if(O==25)return S.readUint16();if(O==26)return S.readUint32();if(O==27)return S.readUint64();if(O==31)return null;a("Additional info: "+O)()}function p(_,S,O){O.writeByte(_<<5|S)}function g(_,S,O){var $=_<<5;S<24?O.writeByte($|S):S<256?(O.writeByte($|24),O.writeByte(S)):S<65536?(O.writeByte($|25),O.writeUint16(S)):S<4294967296?(O.writeByte($|26),O.writeUint32(S)):(O.writeByte($|27),O.writeUint64(S))}var y=new Error;function b(_){var S=f(_);switch(S.type){case 0:return x(S,_);case 1:return-1-x(S,_);case 2:return _.readChunk(x(S,_));case 3:var O=_.readChunk(x(S,_));return O.toString("utf-8");case 4:case 5:var $=x(S,_),k=[];if($!==null){S.type===5&&($*=2);for(var z=0;z<$;z++)k[z]=b(_)}else for(var W;(W=b(_))!==y;)k.push(W);if(S.type===5){for(var U={},z=0;z<k.length;z+=2)U[k[z]]=k[z+1];return U}else return k;case 6:var I=x(S,_),G=o[I],k=b(_);return G?G(k):k;case 7:if(S.value===25)return _.readFloat16();if(S.value===26)return _.readFloat32();if(S.value===27)return _.readFloat64();switch(x(S,_)){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case null:return y;default:throw new Error("Unknown fixed value: "+S.value)}default:throw new Error("Unsupported header: "+JSON.stringify(S))}throw new Error("not implemented yet")}function w(_,S){for(var O=0;O<n.length;O++){var $=n[O].fn(_);if($!==void 0)return g(6,n[O].tag,S),w($,S)}if(_&&typeof _.toCBOR=="function"&&(_=_.toCBOR()),_===!1)g(7,20,S);else if(_===!0)g(7,21,S);else if(_===null)g(7,22,S);else if(_===void 0)g(7,23,S);else if(typeof _=="number")Math.floor(_)===_&&_<9007199254740992&&_>-9007199254740992?_<0?g(1,-1-_,S):g(0,_,S):(p(7,27,S),S.writeFloat64(_));else if(typeof _=="string")S.writeString(_,function(W){g(3,W,S)});else if(S.canWriteBinary(_))S.writeBinary(_,function(W){g(2,W,S)});else if(typeof _=="object")if(j.config.useToJSON&&typeof _.toJSON=="function"&&(_=_.toJSON()),Array.isArray(_)){g(4,_.length,S);for(var O=0;O<_.length;O++)w(_[O],S)}else{var z=Object.keys(_);g(5,z.length,S);for(var O=0;O<z.length;O++)w(z[O],S),w(_[z[O]],S)}else throw new Error("CBOR encoding not supported: "+_)}var v=[],B=[],j={config:{useToJSON:!0},addWriter:function(_,S){typeof _=="string"?B.push(function(O){if(_===O)return S(O)}):B.push(_)},addReader:function(_,S){typeof _=="string"?v.push(function(O,$){if(_===$)return S(O,$)}):v.push(_)},encode:function(_,S){for(var O=0;O<B.length;O++){var $=B[O],z=$(S);if(z)return w(_,z),z.result()}throw new Error("Unsupported output format: "+S)},decode:function(_,S){for(var O=0;O<v.length;O++){var $=v[O],z=$(_,S);if(z)return b(z)}throw new Error("Unsupported input format: "+S)},addSemanticEncode:function(_,S){if(typeof _!="number"||_%1!==0||_<0)throw new Error("Tag must be a positive integer");return n.push({tag:_,fn:S}),this},addSemanticDecode:function(_,S){if(typeof _!="number"||_%1!==0||_<0)throw new Error("Tag must be a positive integer");return o[_]=S,this},Reader:l,Writer:u};function F(_){this.buffer=_,this.pos=0}F.prototype=Object.create(l.prototype),F.prototype.peekByte=function(){return this.buffer[this.pos]},F.prototype.readByte=function(){return this.buffer[this.pos++]},F.prototype.readUint16=function(){var _=this.buffer.readUInt16BE(this.pos);return this.pos+=2,_},F.prototype.readUint32=function(){var _=this.buffer.readUInt32BE(this.pos);return this.pos+=4,_},F.prototype.readFloat32=function(){var _=this.buffer.readFloatBE(this.pos);return this.pos+=4,_},F.prototype.readFloat64=function(){var _=this.buffer.readDoubleBE(this.pos);return this.pos+=8,_},F.prototype.readChunk=function(_){var S=Buffer.alloc(_);return this.buffer.copy(S,0,this.pos,this.pos+=_),S};function C(_){this.byteLength=0,this.defaultBufferLength=16384,this.latestBuffer=Buffer.alloc(this.defaultBufferLength),this.latestBufferOffset=0,this.completeBuffers=[],this.stringFormat=_}C.prototype=Object.create(u.prototype),C.prototype.writeByte=function(_){this.latestBuffer[this.latestBufferOffset++]=_,this.latestBufferOffset>=this.latestBuffer.length&&(this.completeBuffers.push(this.latestBuffer),this.latestBuffer=Buffer.alloc(this.defaultBufferLength),this.latestBufferOffset=0),this.byteLength++},C.prototype.writeFloat32=function(_){var S=Buffer.alloc(4);S.writeFloatBE(_,0),this.writeBuffer(S)},C.prototype.writeFloat64=function(_){var S=Buffer.alloc(8);S.writeDoubleBE(_,0),this.writeBuffer(S)},C.prototype.writeString=function(_,S){var O=Buffer.from(_,"utf-8");S(O.length),this.writeBuffer(O)},C.prototype.canWriteBinary=function(_){return _ instanceof Buffer},C.prototype.writeBinary=function(_,S){S(_.length),this.writeBuffer(_)},C.prototype.writeBuffer=function(_){if(!(_ instanceof Buffer))throw new TypeError("BufferWriter only accepts Buffers");this.latestBufferOffset?this.latestBuffer.length-this.latestBufferOffset>=_.length?(_.copy(this.latestBuffer,this.latestBufferOffset),this.latestBufferOffset+=_.length,this.latestBufferOffset>=this.latestBuffer.length&&(this.completeBuffers.push(this.latestBuffer),this.latestBuffer=Buffer.alloc(this.defaultBufferLength),this.latestBufferOffset=0)):(this.completeBuffers.push(this.latestBuffer.slice(0,this.latestBufferOffset)),this.completeBuffers.push(_),this.latestBuffer=Buffer.alloc(this.defaultBufferLength),this.latestBufferOffset=0):this.completeBuffers.push(_),this.byteLength+=_.length},C.prototype.result=function(){for(var _=Buffer.alloc(this.byteLength),S=0,O=0;O<this.completeBuffers.length;O++){var $=this.completeBuffers[O];$.copy(_,S,0,$.length),S+=$.length}return this.latestBufferOffset&&this.latestBuffer.copy(_,S,0,this.latestBufferOffset),this.stringFormat?_.toString(this.stringFormat):_},typeof Buffer=="function"&&(j.addReader(function(_,S){if(_ instanceof Buffer)return new F(_);if(S==="hex"||S==="base64"){var O=Buffer.from(_,S);return new F(O)}}),j.addWriter(function(_){if(!_||_==="buffer")return new C;if(_==="hex"||_==="base64")return new C(_)}));function N(_){this.hex=_,this.pos=0}N.prototype=Object.create(l.prototype),N.prototype.peekByte=function(){var _=this.hex.substring(this.pos,2);return parseInt(_,16)},N.prototype.readByte=function(){var _=this.hex.substring(this.pos,this.pos+2);return this.pos+=2,parseInt(_,16)},N.prototype.readChunk=function(_){var S=this.hex.substring(this.pos,this.pos+_*2);return this.pos+=_*2,typeof Buffer=="function"?Buffer.from(S,"hex"):new r(S)};function T(_){this.$hex="",this.finalFormat=_||"hex"}return T.prototype=Object.create(u.prototype),T.prototype.writeByte=function(_){if(_<0||_>255)throw new Error("Byte value out of range: "+_);var S=_.toString(16);S.length==1&&(S="0"+S),this.$hex+=S},T.prototype.canWriteBinary=function(_){return _ instanceof r||typeof Buffer=="function"&&_ instanceof Buffer},T.prototype.writeBinary=function(_,S){if(_ instanceof r)S(_.length()),this.$hex+=_.$hex;else if(typeof Buffer=="function"&&_ instanceof Buffer)S(_.length),this.$hex+=_.toString("hex");else throw new TypeError("HexWriter only accepts BinaryHex or Buffers")},T.prototype.result=function(){return this.finalFormat==="buffer"&&typeof Buffer=="function"?Buffer.from(this.$hex,"hex"):new r(this.$hex).toString(this.finalFormat)},T.prototype.writeString=function(_,S){var O=r.fromUtf8String(_);S(O.length()),this.$hex+=O.$hex},j.addReader(function(_,S){if(_ instanceof r||_.$hex)return new N(_.$hex);if(S==="hex")return new N(_)}),j.addWriter(function(_){if(_==="hex")return new T}),j})();return t.addSemanticEncode(0,function(r){if(r instanceof Date)return r.toISOString()}).addSemanticDecode(0,function(r){return new Date(r)}).addSemanticDecode(1,function(r){return new Date(r)}),t})})(main$1)),main$1.exports}var hasRequiredCbor;function requireCbor(){if(hasRequiredCbor)return cbor;hasRequiredCbor=1,Object.defineProperty(cbor,"__esModule",{value:!0}),cbor.cborDecode=cbor.cborEncode=void 0;const e=requireMain(),t=n=>e.encode(n);cbor.cborEncode=t;const r=n=>e.decode(Buffer.isBuffer(n)?n:Buffer.from(n,"hex"));return cbor.cborDecode=r,cbor}var hasRequiredUr;function requireUr(){if(hasRequiredUr)return ur;hasRequiredUr=1,Object.defineProperty(ur,"__esModule",{value:!0});const e=requireErrors$1(),t=requireUtils$7(),r=requireCbor();class n{constructor(a,l="bytes"){if(this._cborPayload=a,this._type=l,!t.isURType(this._type))throw new e.InvalidTypeError}static fromBuffer(a){return new n(r.cborEncode(a))}static from(a,l){return n.fromBuffer(Buffer.from(a,l))}decodeCBOR(){return r.cborDecode(this._cborPayload)}get type(){return this._type}get cbor(){return this._cborPayload}equals(a){return this.type===a.type&&this.cbor.equals(a.cbor)}}return ur.default=n,ur}var urEncoder={},fountainEncoder={},assert$2={exports:{}},errors={},util={},types$1={},isArguments$1,hasRequiredIsArguments$1;function requireIsArguments$1(){if(hasRequiredIsArguments$1)return isArguments$1;hasRequiredIsArguments$1=1;var e=requireShams()(),t=requireCallBound$1(),r=t("Object.prototype.toString"),n=function(u){return e&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:r(u)==="[object Arguments]"},o=function(u){return n(u)?!0:u!==null&&typeof u=="object"&&"length"in u&&typeof u.length=="number"&&u.length>=0&&r(u)!=="[object Array]"&&"callee"in u&&r(u.callee)==="[object Function]"},a=(function(){return n(arguments)})();return n.isLegacyArguments=o,isArguments$1=a?n:o,isArguments$1}var isRegex,hasRequiredIsRegex;function requireIsRegex(){if(hasRequiredIsRegex)return isRegex;hasRequiredIsRegex=1;var e=requireCallBound$1(),t=requireShams()(),r=requireHasown(),n=requireGopd(),o;if(t){var a=e("RegExp.prototype.exec"),l={},u=function(){throw l},f={toString:u,valueOf:u};typeof Symbol.toPrimitive=="symbol"&&(f[Symbol.toPrimitive]=u),o=function(y){if(!y||typeof y!="object")return!1;var b=n(y,"lastIndex"),w=b&&r(b,"value");if(!w)return!1;try{a(y,f)}catch(v){return v===l}}}else{var x=e("Object.prototype.toString"),p="[object RegExp]";o=function(y){return!y||typeof y!="object"&&typeof y!="function"?!1:x(y)===p}}return isRegex=o,isRegex}var safeRegexTest,hasRequiredSafeRegexTest;function requireSafeRegexTest(){if(hasRequiredSafeRegexTest)return safeRegexTest;hasRequiredSafeRegexTest=1;var e=requireCallBound$1(),t=requireIsRegex(),r=e("RegExp.prototype.exec"),n=requireType();return safeRegexTest=function(a){if(!t(a))throw new n("`regex` must be a RegExp");return function(u){return r(a,u)!==null}},safeRegexTest}var generatorFunction,hasRequiredGeneratorFunction;function requireGeneratorFunction(){if(hasRequiredGeneratorFunction)return generatorFunction;hasRequiredGeneratorFunction=1;const e=(function*(){}).constructor;return generatorFunction=()=>e,generatorFunction}var isGeneratorFunction,hasRequiredIsGeneratorFunction;function requireIsGeneratorFunction(){if(hasRequiredIsGeneratorFunction)return isGeneratorFunction;hasRequiredIsGeneratorFunction=1;var e=requireCallBound$1(),t=requireSafeRegexTest(),r=t(/^\s*(?:function)?\*/),n=requireShams()(),o=requireGetProto(),a=e("Object.prototype.toString"),l=e("Function.prototype.toString"),u=requireGeneratorFunction();return isGeneratorFunction=function(x){if(typeof x!="function")return!1;if(r(l(x)))return!0;if(!n){var p=a(x);return p==="[object GeneratorFunction]"}if(!o)return!1;var g=u();return g&&o(x)===g.prototype},isGeneratorFunction}var hasRequiredTypes$1;function requireTypes$1(){return hasRequiredTypes$1||(hasRequiredTypes$1=1,(function(e){var t=requireIsArguments$1(),r=requireIsGeneratorFunction(),n=requireWhichTypedArray(),o=requireIsTypedArray();function a(we){return we.call.bind(we)}var l=typeof BigInt<"u",u=typeof Symbol<"u",f=a(Object.prototype.toString),x=a(Number.prototype.valueOf),p=a(String.prototype.valueOf),g=a(Boolean.prototype.valueOf);if(l)var y=a(BigInt.prototype.valueOf);if(u)var b=a(Symbol.prototype.valueOf);function w(we,Fe){if(typeof we!="object")return!1;try{return Fe(we),!0}catch{return!1}}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=o;function v(we){return typeof Promise<"u"&&we instanceof Promise||we!==null&&typeof we=="object"&&typeof we.then=="function"&&typeof we.catch=="function"}e.isPromise=v;function B(we){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(we):o(we)||J(we)}e.isArrayBufferView=B;function j(we){return n(we)==="Uint8Array"}e.isUint8Array=j;function F(we){return n(we)==="Uint8ClampedArray"}e.isUint8ClampedArray=F;function C(we){return n(we)==="Uint16Array"}e.isUint16Array=C;function N(we){return n(we)==="Uint32Array"}e.isUint32Array=N;function T(we){return n(we)==="Int8Array"}e.isInt8Array=T;function _(we){return n(we)==="Int16Array"}e.isInt16Array=_;function S(we){return n(we)==="Int32Array"}e.isInt32Array=S;function O(we){return n(we)==="Float32Array"}e.isFloat32Array=O;function $(we){return n(we)==="Float64Array"}e.isFloat64Array=$;function z(we){return n(we)==="BigInt64Array"}e.isBigInt64Array=z;function W(we){return n(we)==="BigUint64Array"}e.isBigUint64Array=W;function U(we){return f(we)==="[object Map]"}U.working=typeof Map<"u"&&U(new Map);function I(we){return typeof Map>"u"?!1:U.working?U(we):we instanceof Map}e.isMap=I;function G(we){return f(we)==="[object Set]"}G.working=typeof Set<"u"&&G(new Set);function k(we){return typeof Set>"u"?!1:G.working?G(we):we instanceof Set}e.isSet=k;function M(we){return f(we)==="[object WeakMap]"}M.working=typeof WeakMap<"u"&&M(new WeakMap);function q(we){return typeof WeakMap>"u"?!1:M.working?M(we):we instanceof WeakMap}e.isWeakMap=q;function K(we){return f(we)==="[object WeakSet]"}K.working=typeof WeakSet<"u"&&K(new WeakSet);function H(we){return K(we)}e.isWeakSet=H;function Q(we){return f(we)==="[object ArrayBuffer]"}Q.working=typeof ArrayBuffer<"u"&&Q(new ArrayBuffer);function D(we){return typeof ArrayBuffer>"u"?!1:Q.working?Q(we):we instanceof ArrayBuffer}e.isArrayBuffer=D;function Y(we){return f(we)==="[object DataView]"}Y.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Y(new DataView(new ArrayBuffer(1),0,1));function J(we){return typeof DataView>"u"?!1:Y.working?Y(we):we instanceof DataView}e.isDataView=J;var L=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Z(we){return f(we)==="[object SharedArrayBuffer]"}function oe(we){return typeof L>"u"?!1:(typeof Z.working>"u"&&(Z.working=Z(new L)),Z.working?Z(we):we instanceof L)}e.isSharedArrayBuffer=oe;function ce(we){return f(we)==="[object AsyncFunction]"}e.isAsyncFunction=ce;function de(we){return f(we)==="[object Map Iterator]"}e.isMapIterator=de;function xe(we){return f(we)==="[object Set Iterator]"}e.isSetIterator=xe;function te(we){return f(we)==="[object Generator]"}e.isGeneratorObject=te;function ae(we){return f(we)==="[object WebAssembly.Module]"}e.isWebAssemblyCompiledModule=ae;function le(we){return w(we,x)}e.isNumberObject=le;function ue(we){return w(we,p)}e.isStringObject=ue;function be(we){return w(we,g)}e.isBooleanObject=be;function Be(we){return l&&w(we,y)}e.isBigIntObject=Be;function Ce(we){return u&&w(we,b)}e.isSymbolObject=Ce;function Se(we){return le(we)||ue(we)||be(we)||Be(we)||Ce(we)}e.isBoxedPrimitive=Se;function ke(we){return typeof Uint8Array<"u"&&(D(we)||oe(we))}e.isAnyArrayBuffer=ke,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(we){Object.defineProperty(e,we,{enumerable:!1,value:function(){throw new Error(we+" is not supported in userland")}})})})(types$1)),types$1}var isBufferBrowser,hasRequiredIsBufferBrowser;function requireIsBufferBrowser(){return hasRequiredIsBufferBrowser||(hasRequiredIsBufferBrowser=1,isBufferBrowser=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),isBufferBrowser}var hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,(function(e){var t={},r=Object.getOwnPropertyDescriptors||function(L){for(var Z=Object.keys(L),oe={},ce=0;ce<Z.length;ce++)oe[Z[ce]]=Object.getOwnPropertyDescriptor(L,Z[ce]);return oe},n=/%[sdj%]/g;e.format=function(J){if(!_(J)){for(var L=[],Z=0;Z<arguments.length;Z++)L.push(u(arguments[Z]));return L.join(" ")}for(var Z=1,oe=arguments,ce=oe.length,de=String(J).replace(n,function(te){if(te==="%%")return"%";if(Z>=ce)return te;switch(te){case"%s":return String(oe[Z++]);case"%d":return Number(oe[Z++]);case"%j":try{return JSON.stringify(oe[Z++])}catch{return"[Circular]"}default:return te}}),xe=oe[Z];Z<ce;xe=oe[++Z])C(xe)||!z(xe)?de+=" "+xe:de+=" "+u(xe);return de},e.deprecate=function(J,L){if(typeof process$1<"u"&&process$1.noDeprecation===!0)return J;if(typeof process$1>"u")return function(){return e.deprecate(J,L).apply(this,arguments)};var Z=!1;function oe(){if(!Z){if(process$1.throwDeprecation)throw new Error(L);process$1.traceDeprecation?console.trace(L):console.error(L),Z=!0}return J.apply(this,arguments)}return oe};var o={},a=/^$/;if(t.NODE_DEBUG){var l=t.NODE_DEBUG;l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+l+"$","i")}e.debuglog=function(J){if(J=J.toUpperCase(),!o[J])if(a.test(J)){var L=process$1.pid;o[J]=function(){var Z=e.format.apply(e,arguments);console.error("%s %d: %s",J,L,Z)}}else o[J]=function(){};return o[J]};function u(J,L){var Z={seen:[],stylize:x};return arguments.length>=3&&(Z.depth=arguments[2]),arguments.length>=4&&(Z.colors=arguments[3]),F(L)?Z.showHidden=L:L&&e._extend(Z,L),O(Z.showHidden)&&(Z.showHidden=!1),O(Z.depth)&&(Z.depth=2),O(Z.colors)&&(Z.colors=!1),O(Z.customInspect)&&(Z.customInspect=!0),Z.colors&&(Z.stylize=f),g(Z,J,Z.depth)}e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function f(J,L){var Z=u.styles[L];return Z?"\x1B["+u.colors[Z][0]+"m"+J+"\x1B["+u.colors[Z][1]+"m":J}function x(J,L){return J}function p(J){var L={};return J.forEach(function(Z,oe){L[Z]=!0}),L}function g(J,L,Z){if(J.customInspect&&L&&I(L.inspect)&&L.inspect!==e.inspect&&!(L.constructor&&L.constructor.prototype===L)){var oe=L.inspect(Z,J);return _(oe)||(oe=g(J,oe,Z)),oe}var ce=y(J,L);if(ce)return ce;var de=Object.keys(L),xe=p(de);if(J.showHidden&&(de=Object.getOwnPropertyNames(L)),U(L)&&(de.indexOf("message")>=0||de.indexOf("description")>=0))return b(L);if(de.length===0){if(I(L)){var te=L.name?": "+L.name:"";return J.stylize("[Function"+te+"]","special")}if($(L))return J.stylize(RegExp.prototype.toString.call(L),"regexp");if(W(L))return J.stylize(Date.prototype.toString.call(L),"date");if(U(L))return b(L)}var ae="",le=!1,ue=["{","}"];if(j(L)&&(le=!0,ue=["[","]"]),I(L)){var be=L.name?": "+L.name:"";ae=" [Function"+be+"]"}if($(L)&&(ae=" "+RegExp.prototype.toString.call(L)),W(L)&&(ae=" "+Date.prototype.toUTCString.call(L)),U(L)&&(ae=" "+b(L)),de.length===0&&(!le||L.length==0))return ue[0]+ae+ue[1];if(Z<0)return $(L)?J.stylize(RegExp.prototype.toString.call(L),"regexp"):J.stylize("[Object]","special");J.seen.push(L);var Be;return le?Be=w(J,L,Z,xe,de):Be=de.map(function(Ce){return v(J,L,Z,xe,Ce,le)}),J.seen.pop(),B(Be,ae,ue)}function y(J,L){if(O(L))return J.stylize("undefined","undefined");if(_(L)){var Z="'"+JSON.stringify(L).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return J.stylize(Z,"string")}if(T(L))return J.stylize(""+L,"number");if(F(L))return J.stylize(""+L,"boolean");if(C(L))return J.stylize("null","null")}function b(J){return"["+Error.prototype.toString.call(J)+"]"}function w(J,L,Z,oe,ce){for(var de=[],xe=0,te=L.length;xe<te;++xe)H(L,String(xe))?de.push(v(J,L,Z,oe,String(xe),!0)):de.push("");return ce.forEach(function(ae){ae.match(/^\d+$/)||de.push(v(J,L,Z,oe,ae,!0))}),de}function v(J,L,Z,oe,ce,de){var xe,te,ae;if(ae=Object.getOwnPropertyDescriptor(L,ce)||{value:L[ce]},ae.get?ae.set?te=J.stylize("[Getter/Setter]","special"):te=J.stylize("[Getter]","special"):ae.set&&(te=J.stylize("[Setter]","special")),H(oe,ce)||(xe="["+ce+"]"),te||(J.seen.indexOf(ae.value)<0?(C(Z)?te=g(J,ae.value,null):te=g(J,ae.value,Z-1),te.indexOf(`
`)>-1&&(de?te=te.split(`
`).map(function(le){return"  "+le}).join(`
`).slice(2):te=`
`+te.split(`
`).map(function(le){return"   "+le}).join(`
`))):te=J.stylize("[Circular]","special")),O(xe)){if(de&&ce.match(/^\d+$/))return te;xe=JSON.stringify(""+ce),xe.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(xe=xe.slice(1,-1),xe=J.stylize(xe,"name")):(xe=xe.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),xe=J.stylize(xe,"string"))}return xe+": "+te}function B(J,L,Z){var oe=J.reduce(function(ce,de){return de.indexOf(`
`)>=0,ce+de.replace(/\u001b\[\d\d?m/g,"").length+1},0);return oe>60?Z[0]+(L===""?"":L+`
 `)+" "+J.join(`,
  `)+" "+Z[1]:Z[0]+L+" "+J.join(", ")+" "+Z[1]}e.types=requireTypes$1();function j(J){return Array.isArray(J)}e.isArray=j;function F(J){return typeof J=="boolean"}e.isBoolean=F;function C(J){return J===null}e.isNull=C;function N(J){return J==null}e.isNullOrUndefined=N;function T(J){return typeof J=="number"}e.isNumber=T;function _(J){return typeof J=="string"}e.isString=_;function S(J){return typeof J=="symbol"}e.isSymbol=S;function O(J){return J===void 0}e.isUndefined=O;function $(J){return z(J)&&k(J)==="[object RegExp]"}e.isRegExp=$,e.types.isRegExp=$;function z(J){return typeof J=="object"&&J!==null}e.isObject=z;function W(J){return z(J)&&k(J)==="[object Date]"}e.isDate=W,e.types.isDate=W;function U(J){return z(J)&&(k(J)==="[object Error]"||J instanceof Error)}e.isError=U,e.types.isNativeError=U;function I(J){return typeof J=="function"}e.isFunction=I;function G(J){return J===null||typeof J=="boolean"||typeof J=="number"||typeof J=="string"||typeof J=="symbol"||typeof J>"u"}e.isPrimitive=G,e.isBuffer=requireIsBufferBrowser();function k(J){return Object.prototype.toString.call(J)}function M(J){return J<10?"0"+J.toString(10):J.toString(10)}var q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function K(){var J=new Date,L=[M(J.getHours()),M(J.getMinutes()),M(J.getSeconds())].join(":");return[J.getDate(),q[J.getMonth()],L].join(" ")}e.log=function(){console.log("%s - %s",K(),e.format.apply(e,arguments))},e.inherits=requireInherits_browser(),e._extend=function(J,L){if(!L||!z(L))return J;for(var Z=Object.keys(L),oe=Z.length;oe--;)J[Z[oe]]=L[Z[oe]];return J};function H(J,L){return Object.prototype.hasOwnProperty.call(J,L)}var Q=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;e.promisify=function(L){if(typeof L!="function")throw new TypeError('The "original" argument must be of type Function');if(Q&&L[Q]){var Z=L[Q];if(typeof Z!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(Z,Q,{value:Z,enumerable:!1,writable:!1,configurable:!0}),Z}function Z(){for(var oe,ce,de=new Promise(function(ae,le){oe=ae,ce=le}),xe=[],te=0;te<arguments.length;te++)xe.push(arguments[te]);xe.push(function(ae,le){ae?ce(ae):oe(le)});try{L.apply(this,xe)}catch(ae){ce(ae)}return de}return Object.setPrototypeOf(Z,Object.getPrototypeOf(L)),Q&&Object.defineProperty(Z,Q,{value:Z,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(Z,r(L))},e.promisify.custom=Q;function D(J,L){if(!J){var Z=new Error("Promise was rejected with a falsy value");Z.reason=J,J=Z}return L(J)}function Y(J){if(typeof J!="function")throw new TypeError('The "original" argument must be of type Function');function L(){for(var Z=[],oe=0;oe<arguments.length;oe++)Z.push(arguments[oe]);var ce=Z.pop();if(typeof ce!="function")throw new TypeError("The last argument must be of type Function");var de=this,xe=function(){return ce.apply(de,arguments)};J.apply(this,Z).then(function(te){process$1.nextTick(xe.bind(null,null,te))},function(te){process$1.nextTick(D.bind(null,te,xe))})}return Object.setPrototypeOf(L,Object.getPrototypeOf(J)),Object.defineProperties(L,r(J)),L}e.callbackify=Y})(util)),util}var hasRequiredErrors;function requireErrors(){if(hasRequiredErrors)return errors;hasRequiredErrors=1;function e(F){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},e(F)}function t(F,C,N){return Object.defineProperty(F,"prototype",{writable:!1}),F}function r(F,C){if(!(F instanceof C))throw new TypeError("Cannot call a class as a function")}function n(F,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(C&&C.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),Object.defineProperty(F,"prototype",{writable:!1}),C&&o(F,C)}function o(F,C){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(T,_){return T.__proto__=_,T},o(F,C)}function a(F){var C=f();return function(){var T=x(F),_;if(C){var S=x(this).constructor;_=Reflect.construct(T,arguments,S)}else _=T.apply(this,arguments);return l(this,_)}}function l(F,C){if(C&&(e(C)==="object"||typeof C=="function"))return C;if(C!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u(F)}function u(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}function f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function x(F){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(N){return N.__proto__||Object.getPrototypeOf(N)},x(F)}var p={},g,y;function b(F,C,N){N||(N=Error);function T(S,O,$){return typeof C=="string"?C:C(S,O,$)}var _=(function(S){n($,S);var O=a($);function $(z,W,U){var I;return r(this,$),I=O.call(this,T(z,W,U)),I.code=F,I}return t($)})(N);p[F]=_}function w(F,C){if(Array.isArray(F)){var N=F.length;return F=F.map(function(T){return String(T)}),N>2?"one of ".concat(C," ").concat(F.slice(0,N-1).join(", "),", or ")+F[N-1]:N===2?"one of ".concat(C," ").concat(F[0]," or ").concat(F[1]):"of ".concat(C," ").concat(F[0])}else return"of ".concat(C," ").concat(String(F))}function v(F,C,N){return F.substr(0,C.length)===C}function B(F,C,N){return(N===void 0||N>F.length)&&(N=F.length),F.substring(N-C.length,N)===C}function j(F,C,N){return typeof N!="number"&&(N=0),N+C.length>F.length?!1:F.indexOf(C,N)!==-1}return b("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),b("ERR_INVALID_ARG_TYPE",function(F,C,N){g===void 0&&(g=requireAssert()),g(typeof F=="string","'name' must be a string");var T;typeof C=="string"&&v(C,"not ")?(T="must not be",C=C.replace(/^not /,"")):T="must be";var _;if(B(F," argument"))_="The ".concat(F," ").concat(T," ").concat(w(C,"type"));else{var S=j(F,".")?"property":"argument";_='The "'.concat(F,'" ').concat(S," ").concat(T," ").concat(w(C,"type"))}return _+=". Received type ".concat(e(N)),_},TypeError),b("ERR_INVALID_ARG_VALUE",function(F,C){var N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";y===void 0&&(y=requireUtil());var T=y.inspect(C);return T.length>128&&(T="".concat(T.slice(0,128),"...")),"The argument '".concat(F,"' ").concat(N,". Received ").concat(T)},TypeError),b("ERR_INVALID_RETURN_VALUE",function(F,C,N){var T;return N&&N.constructor&&N.constructor.name?T="instance of ".concat(N.constructor.name):T="type ".concat(e(N)),"Expected ".concat(F,' to be returned from the "').concat(C,'"')+" function but got ".concat(T,".")},TypeError),b("ERR_MISSING_ARGS",function(){for(var F=arguments.length,C=new Array(F),N=0;N<F;N++)C[N]=arguments[N];g===void 0&&(g=requireAssert()),g(C.length>0,"At least one arg needs to be specified");var T="The ",_=C.length;switch(C=C.map(function(S){return'"'.concat(S,'"')}),_){case 1:T+="".concat(C[0]," argument");break;case 2:T+="".concat(C[0]," and ").concat(C[1]," arguments");break;default:T+=C.slice(0,_-1).join(", "),T+=", and ".concat(C[_-1]," arguments");break}return"".concat(T," must be specified")},TypeError),errors.codes=p,errors}var assertion_error,hasRequiredAssertion_error;function requireAssertion_error(){if(hasRequiredAssertion_error)return assertion_error;hasRequiredAssertion_error=1;function e(H,Q){var D=Object.keys(H);if(Object.getOwnPropertySymbols){var Y=Object.getOwnPropertySymbols(H);Q&&(Y=Y.filter(function(J){return Object.getOwnPropertyDescriptor(H,J).enumerable})),D.push.apply(D,Y)}return D}function t(H){for(var Q=1;Q<arguments.length;Q++){var D=arguments[Q]!=null?arguments[Q]:{};Q%2?e(Object(D),!0).forEach(function(Y){r(H,Y,D[Y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(D)):e(Object(D)).forEach(function(Y){Object.defineProperty(H,Y,Object.getOwnPropertyDescriptor(D,Y))})}return H}function r(H,Q,D){return Q=l(Q),Q in H?Object.defineProperty(H,Q,{value:D,enumerable:!0,configurable:!0,writable:!0}):H[Q]=D,H}function n(H,Q){if(!(H instanceof Q))throw new TypeError("Cannot call a class as a function")}function o(H,Q){for(var D=0;D<Q.length;D++){var Y=Q[D];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(H,l(Y.key),Y)}}function a(H,Q,D){return Q&&o(H.prototype,Q),Object.defineProperty(H,"prototype",{writable:!1}),H}function l(H){var Q=u(H,"string");return F(Q)==="symbol"?Q:String(Q)}function u(H,Q){if(F(H)!=="object"||H===null)return H;var D=H[Symbol.toPrimitive];if(D!==void 0){var Y=D.call(H,Q);if(F(Y)!=="object")return Y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(H)}function f(H,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function");H.prototype=Object.create(Q&&Q.prototype,{constructor:{value:H,writable:!0,configurable:!0}}),Object.defineProperty(H,"prototype",{writable:!1}),Q&&B(H,Q)}function x(H){var Q=w();return function(){var Y=j(H),J;if(Q){var L=j(this).constructor;J=Reflect.construct(Y,arguments,L)}else J=Y.apply(this,arguments);return p(this,J)}}function p(H,Q){if(Q&&(F(Q)==="object"||typeof Q=="function"))return Q;if(Q!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g(H)}function g(H){if(H===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return H}function y(H){var Q=typeof Map=="function"?new Map:void 0;return y=function(Y){if(Y===null||!v(Y))return Y;if(typeof Y!="function")throw new TypeError("Super expression must either be null or a function");if(typeof Q<"u"){if(Q.has(Y))return Q.get(Y);Q.set(Y,J)}function J(){return b(Y,arguments,j(this).constructor)}return J.prototype=Object.create(Y.prototype,{constructor:{value:J,enumerable:!1,writable:!0,configurable:!0}}),B(J,Y)},y(H)}function b(H,Q,D){return w()?b=Reflect.construct.bind():b=function(J,L,Z){var oe=[null];oe.push.apply(oe,L);var ce=Function.bind.apply(J,oe),de=new ce;return Z&&B(de,Z.prototype),de},b.apply(null,arguments)}function w(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(H){return Function.toString.call(H).indexOf("[native code]")!==-1}function B(H,Q){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Y,J){return Y.__proto__=J,Y},B(H,Q)}function j(H){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(D){return D.__proto__||Object.getPrototypeOf(D)},j(H)}function F(H){"@babel/helpers - typeof";return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},F(H)}var C=requireUtil(),N=C.inspect,T=requireErrors(),_=T.codes.ERR_INVALID_ARG_TYPE;function S(H,Q,D){return(D===void 0||D>H.length)&&(D=H.length),H.substring(D-Q.length,D)===Q}function O(H,Q){if(Q=Math.floor(Q),H.length==0||Q==0)return"";var D=H.length*Q;for(Q=Math.floor(Math.log(Q)/Math.log(2));Q;)H+=H,Q--;return H+=H.substring(0,D-H.length),H}var $="",z="",W="",U="",I={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},G=10;function k(H){var Q=Object.keys(H),D=Object.create(Object.getPrototypeOf(H));return Q.forEach(function(Y){D[Y]=H[Y]}),Object.defineProperty(D,"message",{value:H.message}),D}function M(H){return N(H,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function q(H,Q,D){var Y="",J="",L=0,Z="",oe=!1,ce=M(H),de=ce.split(`
`),xe=M(Q).split(`
`),te=0,ae="";if(D==="strictEqual"&&F(H)==="object"&&F(Q)==="object"&&H!==null&&Q!==null&&(D="strictEqualObject"),de.length===1&&xe.length===1&&de[0]!==xe[0]){var le=de[0].length+xe[0].length;if(le<=G){if((F(H)!=="object"||H===null)&&(F(Q)!=="object"||Q===null)&&(H!==0||Q!==0))return"".concat(I[D],`

`)+"".concat(de[0]," !== ").concat(xe[0],`
`)}else if(D!=="strictEqualObject"){var ue=process$1.stderr&&process$1.stderr.isTTY?process$1.stderr.columns:80;if(le<ue){for(;de[0][te]===xe[0][te];)te++;te>2&&(ae=`
  `.concat(O(" ",te),"^"),te=0)}}}for(var be=de[de.length-1],Be=xe[xe.length-1];be===Be&&(te++<2?Z=`
  `.concat(be).concat(Z):Y=be,de.pop(),xe.pop(),!(de.length===0||xe.length===0));)be=de[de.length-1],Be=xe[xe.length-1];var Ce=Math.max(de.length,xe.length);if(Ce===0){var Se=ce.split(`
`);if(Se.length>30)for(Se[26]="".concat($,"...").concat(U);Se.length>27;)Se.pop();return"".concat(I.notIdentical,`

`).concat(Se.join(`
`),`
`)}te>3&&(Z=`
`.concat($,"...").concat(U).concat(Z),oe=!0),Y!==""&&(Z=`
  `.concat(Y).concat(Z),Y="");var ke=0,we=I[D]+`
`.concat(z,"+ actual").concat(U," ").concat(W,"- expected").concat(U),Fe=" ".concat($,"...").concat(U," Lines skipped");for(te=0;te<Ce;te++){var Pe=te-L;if(de.length<te+1)Pe>1&&te>2&&(Pe>4?(J+=`
`.concat($,"...").concat(U),oe=!0):Pe>3&&(J+=`
  `.concat(xe[te-2]),ke++),J+=`
  `.concat(xe[te-1]),ke++),L=te,Y+=`
`.concat(W,"-").concat(U," ").concat(xe[te]),ke++;else if(xe.length<te+1)Pe>1&&te>2&&(Pe>4?(J+=`
`.concat($,"...").concat(U),oe=!0):Pe>3&&(J+=`
  `.concat(de[te-2]),ke++),J+=`
  `.concat(de[te-1]),ke++),L=te,J+=`
`.concat(z,"+").concat(U," ").concat(de[te]),ke++;else{var Ye=xe[te],Ve=de[te],Ee=Ve!==Ye&&(!S(Ve,",")||Ve.slice(0,-1)!==Ye);Ee&&S(Ye,",")&&Ye.slice(0,-1)===Ve&&(Ee=!1,Ve+=","),Ee?(Pe>1&&te>2&&(Pe>4?(J+=`
`.concat($,"...").concat(U),oe=!0):Pe>3&&(J+=`
  `.concat(de[te-2]),ke++),J+=`
  `.concat(de[te-1]),ke++),L=te,J+=`
`.concat(z,"+").concat(U," ").concat(Ve),Y+=`
`.concat(W,"-").concat(U," ").concat(Ye),ke+=2):(J+=Y,Y="",(Pe===1||te===0)&&(J+=`
  `.concat(Ve),ke++))}if(ke>20&&te<Ce-2)return"".concat(we).concat(Fe,`
`).concat(J,`
`).concat($,"...").concat(U).concat(Y,`
`)+"".concat($,"...").concat(U)}return"".concat(we).concat(oe?Fe:"",`
`).concat(J).concat(Y).concat(Z).concat(ae)}var K=(function(H,Q){f(Y,H);var D=x(Y);function Y(J){var L;if(n(this,Y),F(J)!=="object"||J===null)throw new _("options","Object",J);var Z=J.message,oe=J.operator,ce=J.stackStartFn,de=J.actual,xe=J.expected,te=Error.stackTraceLimit;if(Error.stackTraceLimit=0,Z!=null)L=D.call(this,String(Z));else if(process$1.stderr&&process$1.stderr.isTTY&&(process$1.stderr&&process$1.stderr.getColorDepth&&process$1.stderr.getColorDepth()!==1?($="\x1B[34m",z="\x1B[32m",U="\x1B[39m",W="\x1B[31m"):($="",z="",U="",W="")),F(de)==="object"&&de!==null&&F(xe)==="object"&&xe!==null&&"stack"in de&&de instanceof Error&&"stack"in xe&&xe instanceof Error&&(de=k(de),xe=k(xe)),oe==="deepStrictEqual"||oe==="strictEqual")L=D.call(this,q(de,xe,oe));else if(oe==="notDeepStrictEqual"||oe==="notStrictEqual"){var ae=I[oe],le=M(de).split(`
`);if(oe==="notStrictEqual"&&F(de)==="object"&&de!==null&&(ae=I.notStrictEqualObject),le.length>30)for(le[26]="".concat($,"...").concat(U);le.length>27;)le.pop();le.length===1?L=D.call(this,"".concat(ae," ").concat(le[0])):L=D.call(this,"".concat(ae,`

`).concat(le.join(`
`),`
`))}else{var ue=M(de),be="",Be=I[oe];oe==="notDeepEqual"||oe==="notEqual"?(ue="".concat(I[oe],`

`).concat(ue),ue.length>1024&&(ue="".concat(ue.slice(0,1021),"..."))):(be="".concat(M(xe)),ue.length>512&&(ue="".concat(ue.slice(0,509),"...")),be.length>512&&(be="".concat(be.slice(0,509),"...")),oe==="deepEqual"||oe==="equal"?ue="".concat(Be,`

`).concat(ue,`

should equal

`):be=" ".concat(oe," ").concat(be)),L=D.call(this,"".concat(ue).concat(be))}return Error.stackTraceLimit=te,L.generatedMessage=!Z,Object.defineProperty(g(L),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),L.code="ERR_ASSERTION",L.actual=de,L.expected=xe,L.operator=oe,Error.captureStackTrace&&Error.captureStackTrace(g(L),ce),L.stack,L.name="AssertionError",p(L)}return a(Y,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:Q,value:function(L,Z){return N(this,t(t({},Z),{},{customInspect:!1,depth:0}))}}]),Y})(y(Error),N.custom);return assertion_error=K,assertion_error}var isArguments,hasRequiredIsArguments;function requireIsArguments(){if(hasRequiredIsArguments)return isArguments;hasRequiredIsArguments=1;var e=Object.prototype.toString;return isArguments=function(r){var n=e.call(r),o=n==="[object Arguments]";return o||(o=n!=="[object Array]"&&r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&e.call(r.callee)==="[object Function]"),o},isArguments}var implementation$3,hasRequiredImplementation$3;function requireImplementation$3(){if(hasRequiredImplementation$3)return implementation$3;hasRequiredImplementation$3=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=requireIsArguments(),o=Object.prototype.propertyIsEnumerable,a=!o.call({toString:null},"toString"),l=o.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(y){var b=y.constructor;return b&&b.prototype===y},x={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=(function(){if(typeof window>"u")return!1;for(var y in window)try{if(!x["$"+y]&&t.call(window,y)&&window[y]!==null&&typeof window[y]=="object")try{f(window[y])}catch{return!0}}catch{return!0}return!1})(),g=function(y){if(typeof window>"u"||!p)return f(y);try{return f(y)}catch{return!1}};e=function(b){var w=b!==null&&typeof b=="object",v=r.call(b)==="[object Function]",B=n(b),j=w&&r.call(b)==="[object String]",F=[];if(!w&&!v&&!B)throw new TypeError("Object.keys called on a non-object");var C=l&&v;if(j&&b.length>0&&!t.call(b,0))for(var N=0;N<b.length;++N)F.push(String(N));if(B&&b.length>0)for(var T=0;T<b.length;++T)F.push(String(T));else for(var _ in b)!(C&&_==="prototype")&&t.call(b,_)&&F.push(String(_));if(a)for(var S=g(b),O=0;O<u.length;++O)!(S&&u[O]==="constructor")&&t.call(b,u[O])&&F.push(u[O]);return F}}return implementation$3=e,implementation$3}var objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var e=Array.prototype.slice,t=requireIsArguments(),r=Object.keys,n=r?function(l){return r(l)}:requireImplementation$3(),o=Object.keys;return n.shim=function(){if(Object.keys){var l=(function(){var u=Object.keys(arguments);return u&&u.length===arguments.length})(1,2);l||(Object.keys=function(f){return t(f)?o(e.call(f)):o(f)})}else Object.keys=n;return Object.keys||n},objectKeys=n,objectKeys}var implementation$2,hasRequiredImplementation$2;function requireImplementation$2(){if(hasRequiredImplementation$2)return implementation$2;hasRequiredImplementation$2=1;var e=requireObjectKeys(),t=requireShams$1()(),r=requireCallBound$1(),n=requireEsObjectAtoms(),o=r("Array.prototype.push"),a=r("Object.prototype.propertyIsEnumerable"),l=t?n.getOwnPropertySymbols:null;return implementation$2=function(f,x){if(f==null)throw new TypeError("target must be an object");var p=n(f);if(arguments.length===1)return p;for(var g=1;g<arguments.length;++g){var y=n(arguments[g]),b=e(y),w=t&&(n.getOwnPropertySymbols||l);if(w)for(var v=w(y),B=0;B<v.length;++B){var j=v[B];a(y,j)&&o(b,j)}for(var F=0;F<b.length;++F){var C=b[F];if(a(y,C)){var N=y[C];p[C]=N}}}return p},implementation$2}var polyfill$2,hasRequiredPolyfill$2;function requirePolyfill$2(){if(hasRequiredPolyfill$2)return polyfill$2;hasRequiredPolyfill$2=1;var e=requireImplementation$2(),t=function(){if(!Object.assign)return!1;for(var n="abcdefghijklmnopqrst",o=n.split(""),a={},l=0;l<o.length;++l)a[o[l]]=o[l];var u=Object.assign({},a),f="";for(var x in u)f+=x;return n!==f},r=function(){if(!Object.assign||!Object.preventExtensions)return!1;var n=Object.preventExtensions({1:2});try{Object.assign(n,"xy")}catch{return n[1]==="y"}return!1};return polyfill$2=function(){return!Object.assign||t()||r()?e:Object.assign},polyfill$2}var implementation$1,hasRequiredImplementation$1;function requireImplementation$1(){if(hasRequiredImplementation$1)return implementation$1;hasRequiredImplementation$1=1;var e=function(t){return t!==t};return implementation$1=function(r,n){return r===0&&n===0?1/r===1/n:!!(r===n||e(r)&&e(n))},implementation$1}var polyfill$1,hasRequiredPolyfill$1;function requirePolyfill$1(){if(hasRequiredPolyfill$1)return polyfill$1;hasRequiredPolyfill$1=1;var e=requireImplementation$1();return polyfill$1=function(){return typeof Object.is=="function"?Object.is:e},polyfill$1}var callBound,hasRequiredCallBound;function requireCallBound(){if(hasRequiredCallBound)return callBound;hasRequiredCallBound=1;var e=requireGetIntrinsic(),t=requireCallBind(),r=t(e("String.prototype.indexOf"));return callBound=function(o,a){var l=e(o,!!a);return typeof l=="function"&&r(o,".prototype.")>-1?t(l):l},callBound}var defineProperties_1,hasRequiredDefineProperties;function requireDefineProperties(){if(hasRequiredDefineProperties)return defineProperties_1;hasRequiredDefineProperties=1;var e=requireObjectKeys(),t=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",r=Object.prototype.toString,n=Array.prototype.concat,o=requireDefineDataProperty(),a=function(x){return typeof x=="function"&&r.call(x)==="[object Function]"},l=requireHasPropertyDescriptors()(),u=function(x,p,g,y){if(p in x){if(y===!0){if(x[p]===g)return}else if(!a(y)||!y())return}l?o(x,p,g,!0):o(x,p,g)},f=function(x,p){var g=arguments.length>2?arguments[2]:{},y=e(p);t&&(y=n.call(y,Object.getOwnPropertySymbols(p)));for(var b=0;b<y.length;b+=1)u(x,y[b],p[y[b]],g[y[b]])};return f.supportsDescriptors=!!l,defineProperties_1=f,defineProperties_1}var shim$1,hasRequiredShim$1;function requireShim$1(){if(hasRequiredShim$1)return shim$1;hasRequiredShim$1=1;var e=requirePolyfill$1(),t=requireDefineProperties();return shim$1=function(){var n=e();return t(Object,{is:n},{is:function(){return Object.is!==n}}),n},shim$1}var objectIs,hasRequiredObjectIs;function requireObjectIs(){if(hasRequiredObjectIs)return objectIs;hasRequiredObjectIs=1;var e=requireDefineProperties(),t=requireCallBind(),r=requireImplementation$1(),n=requirePolyfill$1(),o=requireShim$1(),a=t(n(),Object);return e(a,{getPolyfill:n,implementation:r,shim:o}),objectIs=a,objectIs}var implementation,hasRequiredImplementation;function requireImplementation(){return hasRequiredImplementation||(hasRequiredImplementation=1,implementation=function(t){return t!==t}),implementation}var polyfill,hasRequiredPolyfill;function requirePolyfill(){if(hasRequiredPolyfill)return polyfill;hasRequiredPolyfill=1;var e=requireImplementation();return polyfill=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:e},polyfill}var shim,hasRequiredShim;function requireShim(){if(hasRequiredShim)return shim;hasRequiredShim=1;var e=requireDefineProperties(),t=requirePolyfill();return shim=function(){var n=t();return e(Number,{isNaN:n},{isNaN:function(){return Number.isNaN!==n}}),n},shim}var isNan,hasRequiredIsNan;function requireIsNan(){if(hasRequiredIsNan)return isNan;hasRequiredIsNan=1;var e=requireCallBind(),t=requireDefineProperties(),r=requireImplementation(),n=requirePolyfill(),o=requireShim(),a=e(n(),Number);return t(a,{getPolyfill:n,implementation:r,shim:o}),isNan=a,isNan}var comparisons,hasRequiredComparisons;function requireComparisons(){if(hasRequiredComparisons)return comparisons;hasRequiredComparisons=1;function e(Ee,ve){return a(Ee)||o(Ee,ve)||r(Ee,ve)||t()}function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(Ee,ve){if(Ee){if(typeof Ee=="string")return n(Ee,ve);var Te=Object.prototype.toString.call(Ee).slice(8,-1);if(Te==="Object"&&Ee.constructor&&(Te=Ee.constructor.name),Te==="Map"||Te==="Set")return Array.from(Ee);if(Te==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Te))return n(Ee,ve)}}function n(Ee,ve){(ve==null||ve>Ee.length)&&(ve=Ee.length);for(var Te=0,Re=new Array(ve);Te<ve;Te++)Re[Te]=Ee[Te];return Re}function o(Ee,ve){var Te=Ee==null?null:typeof Symbol<"u"&&Ee[Symbol.iterator]||Ee["@@iterator"];if(Te!=null){var Re,ye,Ne,ie,P=[],V=!0,he=!1;try{if(Ne=(Te=Te.call(Ee)).next,ve!==0)for(;!(V=(Re=Ne.call(Te)).done)&&(P.push(Re.value),P.length!==ve);V=!0);}catch(_e){he=!0,ye=_e}finally{try{if(!V&&Te.return!=null&&(ie=Te.return(),Object(ie)!==ie))return}finally{if(he)throw ye}}return P}}function a(Ee){if(Array.isArray(Ee))return Ee}function l(Ee){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ve){return typeof ve}:function(ve){return ve&&typeof Symbol=="function"&&ve.constructor===Symbol&&ve!==Symbol.prototype?"symbol":typeof ve},l(Ee)}var u=/a/g.flags!==void 0,f=function(ve){var Te=[];return ve.forEach(function(Re){return Te.push(Re)}),Te},x=function(ve){var Te=[];return ve.forEach(function(Re,ye){return Te.push([ye,Re])}),Te},p=Object.is?Object.is:requireObjectIs(),g=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},y=Number.isNaN?Number.isNaN:requireIsNan();function b(Ee){return Ee.call.bind(Ee)}var w=b(Object.prototype.hasOwnProperty),v=b(Object.prototype.propertyIsEnumerable),B=b(Object.prototype.toString),j=requireUtil().types,F=j.isAnyArrayBuffer,C=j.isArrayBufferView,N=j.isDate,T=j.isMap,_=j.isRegExp,S=j.isSet,O=j.isNativeError,$=j.isBoxedPrimitive,z=j.isNumberObject,W=j.isStringObject,U=j.isBooleanObject,I=j.isBigIntObject,G=j.isSymbolObject,k=j.isFloat32Array,M=j.isFloat64Array;function q(Ee){if(Ee.length===0||Ee.length>10)return!0;for(var ve=0;ve<Ee.length;ve++){var Te=Ee.charCodeAt(ve);if(Te<48||Te>57)return!0}return Ee.length===10&&Ee>=Math.pow(2,32)}function K(Ee){return Object.keys(Ee).filter(q).concat(g(Ee).filter(Object.prototype.propertyIsEnumerable.bind(Ee)))}function H(Ee,ve){if(Ee===ve)return 0;for(var Te=Ee.length,Re=ve.length,ye=0,Ne=Math.min(Te,Re);ye<Ne;++ye)if(Ee[ye]!==ve[ye]){Te=Ee[ye],Re=ve[ye];break}return Te<Re?-1:Re<Te?1:0}var Q=!0,D=!1,Y=0,J=1,L=2,Z=3;function oe(Ee,ve){return u?Ee.source===ve.source&&Ee.flags===ve.flags:RegExp.prototype.toString.call(Ee)===RegExp.prototype.toString.call(ve)}function ce(Ee,ve){if(Ee.byteLength!==ve.byteLength)return!1;for(var Te=0;Te<Ee.byteLength;Te++)if(Ee[Te]!==ve[Te])return!1;return!0}function de(Ee,ve){return Ee.byteLength!==ve.byteLength?!1:H(new Uint8Array(Ee.buffer,Ee.byteOffset,Ee.byteLength),new Uint8Array(ve.buffer,ve.byteOffset,ve.byteLength))===0}function xe(Ee,ve){return Ee.byteLength===ve.byteLength&&H(new Uint8Array(Ee),new Uint8Array(ve))===0}function te(Ee,ve){return z(Ee)?z(ve)&&p(Number.prototype.valueOf.call(Ee),Number.prototype.valueOf.call(ve)):W(Ee)?W(ve)&&String.prototype.valueOf.call(Ee)===String.prototype.valueOf.call(ve):U(Ee)?U(ve)&&Boolean.prototype.valueOf.call(Ee)===Boolean.prototype.valueOf.call(ve):I(Ee)?I(ve)&&BigInt.prototype.valueOf.call(Ee)===BigInt.prototype.valueOf.call(ve):G(ve)&&Symbol.prototype.valueOf.call(Ee)===Symbol.prototype.valueOf.call(ve)}function ae(Ee,ve,Te,Re){if(Ee===ve)return Ee!==0?!0:Te?p(Ee,ve):!0;if(Te){if(l(Ee)!=="object")return typeof Ee=="number"&&y(Ee)&&y(ve);if(l(ve)!=="object"||Ee===null||ve===null||Object.getPrototypeOf(Ee)!==Object.getPrototypeOf(ve))return!1}else{if(Ee===null||l(Ee)!=="object")return ve===null||l(ve)!=="object"?Ee==ve:!1;if(ve===null||l(ve)!=="object")return!1}var ye=B(Ee),Ne=B(ve);if(ye!==Ne)return!1;if(Array.isArray(Ee)){if(Ee.length!==ve.length)return!1;var ie=K(Ee),P=K(ve);return ie.length!==P.length?!1:ue(Ee,ve,Te,Re,J,ie)}if(ye==="[object Object]"&&(!T(Ee)&&T(ve)||!S(Ee)&&S(ve)))return!1;if(N(Ee)){if(!N(ve)||Date.prototype.getTime.call(Ee)!==Date.prototype.getTime.call(ve))return!1}else if(_(Ee)){if(!_(ve)||!oe(Ee,ve))return!1}else if(O(Ee)||Ee instanceof Error){if(Ee.message!==ve.message||Ee.name!==ve.name)return!1}else if(C(Ee)){if(!Te&&(k(Ee)||M(Ee))){if(!ce(Ee,ve))return!1}else if(!de(Ee,ve))return!1;var V=K(Ee),he=K(ve);return V.length!==he.length?!1:ue(Ee,ve,Te,Re,Y,V)}else{if(S(Ee))return!S(ve)||Ee.size!==ve.size?!1:ue(Ee,ve,Te,Re,L);if(T(Ee))return!T(ve)||Ee.size!==ve.size?!1:ue(Ee,ve,Te,Re,Z);if(F(Ee)){if(!xe(Ee,ve))return!1}else if($(Ee)&&!te(Ee,ve))return!1}return ue(Ee,ve,Te,Re,Y)}function le(Ee,ve){return ve.filter(function(Te){return v(Ee,Te)})}function ue(Ee,ve,Te,Re,ye,Ne){if(arguments.length===5){Ne=Object.keys(Ee);var ie=Object.keys(ve);if(Ne.length!==ie.length)return!1}for(var P=0;P<Ne.length;P++)if(!w(ve,Ne[P]))return!1;if(Te&&arguments.length===5){var V=g(Ee);if(V.length!==0){var he=0;for(P=0;P<V.length;P++){var _e=V[P];if(v(Ee,_e)){if(!v(ve,_e))return!1;Ne.push(_e),he++}else if(v(ve,_e))return!1}var je=g(ve);if(V.length!==je.length&&le(ve,je).length!==he)return!1}else{var Ie=g(ve);if(Ie.length!==0&&le(ve,Ie).length!==0)return!1}}if(Ne.length===0&&(ye===Y||ye===J&&Ee.length===0||Ee.size===0))return!0;if(Re===void 0)Re={val1:new Map,val2:new Map,position:0};else{var Ze=Re.val1.get(Ee);if(Ze!==void 0){var et=Re.val2.get(ve);if(et!==void 0)return Ze===et}Re.position++}Re.val1.set(Ee,Re.position),Re.val2.set(ve,Re.position);var st=Pe(Ee,ve,Te,Ne,Re,ye);return Re.val1.delete(Ee),Re.val2.delete(ve),st}function be(Ee,ve,Te,Re){for(var ye=f(Ee),Ne=0;Ne<ye.length;Ne++){var ie=ye[Ne];if(ae(ve,ie,Te,Re))return Ee.delete(ie),!0}return!1}function Be(Ee){switch(l(Ee)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":Ee=+Ee;case"number":if(y(Ee))return!1}return!0}function Ce(Ee,ve,Te){var Re=Be(Te);return Re??(ve.has(Re)&&!Ee.has(Re))}function Se(Ee,ve,Te,Re,ye){var Ne=Be(Te);if(Ne!=null)return Ne;var ie=ve.get(Ne);return ie===void 0&&!ve.has(Ne)||!ae(Re,ie,!1,ye)?!1:!Ee.has(Ne)&&ae(Re,ie,!1,ye)}function ke(Ee,ve,Te,Re){for(var ye=null,Ne=f(Ee),ie=0;ie<Ne.length;ie++){var P=Ne[ie];if(l(P)==="object"&&P!==null)ye===null&&(ye=new Set),ye.add(P);else if(!ve.has(P)){if(Te||!Ce(Ee,ve,P))return!1;ye===null&&(ye=new Set),ye.add(P)}}if(ye!==null){for(var V=f(ve),he=0;he<V.length;he++){var _e=V[he];if(l(_e)==="object"&&_e!==null){if(!be(ye,_e,Te,Re))return!1}else if(!Te&&!Ee.has(_e)&&!be(ye,_e,Te,Re))return!1}return ye.size===0}return!0}function we(Ee,ve,Te,Re,ye,Ne){for(var ie=f(Ee),P=0;P<ie.length;P++){var V=ie[P];if(ae(Te,V,ye,Ne)&&ae(Re,ve.get(V),ye,Ne))return Ee.delete(V),!0}return!1}function Fe(Ee,ve,Te,Re){for(var ye=null,Ne=x(Ee),ie=0;ie<Ne.length;ie++){var P=e(Ne[ie],2),V=P[0],he=P[1];if(l(V)==="object"&&V!==null)ye===null&&(ye=new Set),ye.add(V);else{var _e=ve.get(V);if(_e===void 0&&!ve.has(V)||!ae(he,_e,Te,Re)){if(Te||!Se(Ee,ve,V,he,Re))return!1;ye===null&&(ye=new Set),ye.add(V)}}}if(ye!==null){for(var je=x(ve),Ie=0;Ie<je.length;Ie++){var Ze=e(je[Ie],2),et=Ze[0],st=Ze[1];if(l(et)==="object"&&et!==null){if(!we(ye,Ee,et,st,Te,Re))return!1}else if(!Te&&(!Ee.has(et)||!ae(Ee.get(et),st,!1,Re))&&!we(ye,Ee,et,st,!1,Re))return!1}return ye.size===0}return!0}function Pe(Ee,ve,Te,Re,ye,Ne){var ie=0;if(Ne===L){if(!ke(Ee,ve,Te,ye))return!1}else if(Ne===Z){if(!Fe(Ee,ve,Te,ye))return!1}else if(Ne===J)for(;ie<Ee.length;ie++)if(w(Ee,ie)){if(!w(ve,ie)||!ae(Ee[ie],ve[ie],Te,ye))return!1}else{if(w(ve,ie))return!1;for(var P=Object.keys(Ee);ie<P.length;ie++){var V=P[ie];if(!w(ve,V)||!ae(Ee[V],ve[V],Te,ye))return!1}return P.length===Object.keys(ve).length}for(ie=0;ie<Re.length;ie++){var he=Re[ie];if(!ae(Ee[he],ve[he],Te,ye))return!1}return!0}function Ye(Ee,ve){return ae(Ee,ve,D)}function Ve(Ee,ve){return ae(Ee,ve,Q)}return comparisons={isDeepEqual:Ye,isDeepStrictEqual:Ve},comparisons}var hasRequiredAssert;function requireAssert(){if(hasRequiredAssert)return assert$2.exports;hasRequiredAssert=1;function e(L){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z},e(L)}function t(L,Z,oe){return Object.defineProperty(L,"prototype",{writable:!1}),L}function r(L,Z){if(!(L instanceof Z))throw new TypeError("Cannot call a class as a function")}var n=requireErrors(),o=n.codes,a=o.ERR_AMBIGUOUS_ARGUMENT,l=o.ERR_INVALID_ARG_TYPE,u=o.ERR_INVALID_ARG_VALUE,f=o.ERR_INVALID_RETURN_VALUE,x=o.ERR_MISSING_ARGS,p=requireAssertion_error(),g=requireUtil(),y=g.inspect,b=requireUtil().types,w=b.isPromise,v=b.isRegExp,B=requirePolyfill$2()(),j=requirePolyfill$1()(),F=requireCallBound()("RegExp.prototype.test"),C,N;function T(){var L=requireComparisons();C=L.isDeepEqual,N=L.isDeepStrictEqual}var _=!1,S=assert$2.exports=U,O={};function $(L){throw L.message instanceof Error?L.message:new p(L)}function z(L,Z,oe,ce,de){var xe=arguments.length,te;if(xe===0)te="Failed";else if(xe===1)oe=L,L=void 0;else{if(_===!1){_=!0;var ae=process$1.emitWarning?process$1.emitWarning:console.warn.bind(console);ae("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}xe===2&&(ce="!=")}if(oe instanceof Error)throw oe;var le={actual:L,expected:Z,operator:ce===void 0?"fail":ce,stackStartFn:de||z};oe!==void 0&&(le.message=oe);var ue=new p(le);throw te&&(ue.message=te,ue.generatedMessage=!0),ue}S.fail=z,S.AssertionError=p;function W(L,Z,oe,ce){if(!oe){var de=!1;if(Z===0)de=!0,ce="No value argument passed to `assert.ok()`";else if(ce instanceof Error)throw ce;var xe=new p({actual:oe,expected:!0,message:ce,operator:"==",stackStartFn:L});throw xe.generatedMessage=de,xe}}function U(){for(var L=arguments.length,Z=new Array(L),oe=0;oe<L;oe++)Z[oe]=arguments[oe];W.apply(void 0,[U,Z.length].concat(Z))}S.ok=U,S.equal=function L(Z,oe,ce){if(arguments.length<2)throw new x("actual","expected");Z!=oe&&$({actual:Z,expected:oe,message:ce,operator:"==",stackStartFn:L})},S.notEqual=function L(Z,oe,ce){if(arguments.length<2)throw new x("actual","expected");Z==oe&&$({actual:Z,expected:oe,message:ce,operator:"!=",stackStartFn:L})},S.deepEqual=function L(Z,oe,ce){if(arguments.length<2)throw new x("actual","expected");C===void 0&&T(),C(Z,oe)||$({actual:Z,expected:oe,message:ce,operator:"deepEqual",stackStartFn:L})},S.notDeepEqual=function L(Z,oe,ce){if(arguments.length<2)throw new x("actual","expected");C===void 0&&T(),C(Z,oe)&&$({actual:Z,expected:oe,message:ce,operator:"notDeepEqual",stackStartFn:L})},S.deepStrictEqual=function L(Z,oe,ce){if(arguments.length<2)throw new x("actual","expected");C===void 0&&T(),N(Z,oe)||$({actual:Z,expected:oe,message:ce,operator:"deepStrictEqual",stackStartFn:L})},S.notDeepStrictEqual=I;function I(L,Z,oe){if(arguments.length<2)throw new x("actual","expected");C===void 0&&T(),N(L,Z)&&$({actual:L,expected:Z,message:oe,operator:"notDeepStrictEqual",stackStartFn:I})}S.strictEqual=function L(Z,oe,ce){if(arguments.length<2)throw new x("actual","expected");j(Z,oe)||$({actual:Z,expected:oe,message:ce,operator:"strictEqual",stackStartFn:L})},S.notStrictEqual=function L(Z,oe,ce){if(arguments.length<2)throw new x("actual","expected");j(Z,oe)&&$({actual:Z,expected:oe,message:ce,operator:"notStrictEqual",stackStartFn:L})};var G=t(function L(Z,oe,ce){var de=this;r(this,L),oe.forEach(function(xe){xe in Z&&(ce!==void 0&&typeof ce[xe]=="string"&&v(Z[xe])&&F(Z[xe],ce[xe])?de[xe]=ce[xe]:de[xe]=Z[xe])})});function k(L,Z,oe,ce,de,xe){if(!(oe in L)||!N(L[oe],Z[oe])){if(!ce){var te=new G(L,de),ae=new G(Z,de,L),le=new p({actual:te,expected:ae,operator:"deepStrictEqual",stackStartFn:xe});throw le.actual=L,le.expected=Z,le.operator=xe.name,le}$({actual:L,expected:Z,message:ce,operator:xe.name,stackStartFn:xe})}}function M(L,Z,oe,ce){if(typeof Z!="function"){if(v(Z))return F(Z,L);if(arguments.length===2)throw new l("expected",["Function","RegExp"],Z);if(e(L)!=="object"||L===null){var de=new p({actual:L,expected:Z,message:oe,operator:"deepStrictEqual",stackStartFn:ce});throw de.operator=ce.name,de}var xe=Object.keys(Z);if(Z instanceof Error)xe.push("name","message");else if(xe.length===0)throw new u("error",Z,"may not be an empty object");return C===void 0&&T(),xe.forEach(function(te){typeof L[te]=="string"&&v(Z[te])&&F(Z[te],L[te])||k(L,Z,te,oe,xe,ce)}),!0}return Z.prototype!==void 0&&L instanceof Z?!0:Error.isPrototypeOf(Z)?!1:Z.call({},L)===!0}function q(L){if(typeof L!="function")throw new l("fn","Function",L);try{L()}catch(Z){return Z}return O}function K(L){return w(L)||L!==null&&e(L)==="object"&&typeof L.then=="function"&&typeof L.catch=="function"}function H(L){return Promise.resolve().then(function(){var Z;if(typeof L=="function"){if(Z=L(),!K(Z))throw new f("instance of Promise","promiseFn",Z)}else if(K(L))Z=L;else throw new l("promiseFn",["Function","Promise"],L);return Promise.resolve().then(function(){return Z}).then(function(){return O}).catch(function(oe){return oe})})}function Q(L,Z,oe,ce){if(typeof oe=="string"){if(arguments.length===4)throw new l("error",["Object","Error","Function","RegExp"],oe);if(e(Z)==="object"&&Z!==null){if(Z.message===oe)throw new a("error/message",'The error message "'.concat(Z.message,'" is identical to the message.'))}else if(Z===oe)throw new a("error/message",'The error "'.concat(Z,'" is identical to the message.'));ce=oe,oe=void 0}else if(oe!=null&&e(oe)!=="object"&&typeof oe!="function")throw new l("error",["Object","Error","Function","RegExp"],oe);if(Z===O){var de="";oe&&oe.name&&(de+=" (".concat(oe.name,")")),de+=ce?": ".concat(ce):".";var xe=L.name==="rejects"?"rejection":"exception";$({actual:void 0,expected:oe,operator:L.name,message:"Missing expected ".concat(xe).concat(de),stackStartFn:L})}if(oe&&!M(Z,oe,ce,L))throw Z}function D(L,Z,oe,ce){if(Z!==O){if(typeof oe=="string"&&(ce=oe,oe=void 0),!oe||M(Z,oe)){var de=ce?": ".concat(ce):".",xe=L.name==="doesNotReject"?"rejection":"exception";$({actual:Z,expected:oe,operator:L.name,message:"Got unwanted ".concat(xe).concat(de,`
`)+'Actual message: "'.concat(Z&&Z.message,'"'),stackStartFn:L})}throw Z}}S.throws=function L(Z){for(var oe=arguments.length,ce=new Array(oe>1?oe-1:0),de=1;de<oe;de++)ce[de-1]=arguments[de];Q.apply(void 0,[L,q(Z)].concat(ce))},S.rejects=function L(Z){for(var oe=arguments.length,ce=new Array(oe>1?oe-1:0),de=1;de<oe;de++)ce[de-1]=arguments[de];return H(Z).then(function(xe){return Q.apply(void 0,[L,xe].concat(ce))})},S.doesNotThrow=function L(Z){for(var oe=arguments.length,ce=new Array(oe>1?oe-1:0),de=1;de<oe;de++)ce[de-1]=arguments[de];D.apply(void 0,[L,q(Z)].concat(ce))},S.doesNotReject=function L(Z){for(var oe=arguments.length,ce=new Array(oe>1?oe-1:0),de=1;de<oe;de++)ce[de-1]=arguments[de];return H(Z).then(function(xe){return D.apply(void 0,[L,xe].concat(ce))})},S.ifError=function L(Z){if(Z!=null){var oe="ifError got unwanted exception: ";e(Z)==="object"&&typeof Z.message=="string"?Z.message.length===0&&Z.constructor?oe+=Z.constructor.name:oe+=Z.message:oe+=y(Z);var ce=new p({actual:Z,expected:null,operator:"ifError",message:oe,stackStartFn:L}),de=Z.stack;if(typeof de=="string"){var xe=de.split(`
`);xe.shift();for(var te=ce.stack.split(`
`),ae=0;ae<xe.length;ae++){var le=te.indexOf(xe[ae]);if(le!==-1){te=te.slice(0,le);break}}ce.stack="".concat(te.join(`
`),`
`).concat(xe.join(`
`))}throw ce}};function Y(L,Z,oe,ce,de){if(!v(Z))throw new l("regexp","RegExp",Z);var xe=de==="match";if(typeof L!="string"||F(Z,L)!==xe){if(oe instanceof Error)throw oe;var te=!oe;oe=oe||(typeof L!="string"?'The "string" argument must be of type string. Received type '+"".concat(e(L)," (").concat(y(L),")"):(xe?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(y(Z),`. Input:

`).concat(y(L),`
`));var ae=new p({actual:L,expected:Z,message:oe,operator:de,stackStartFn:ce});throw ae.generatedMessage=te,ae}}S.match=function L(Z,oe,ce){Y(Z,oe,ce,L,"match")},S.doesNotMatch=function L(Z,oe,ce){Y(Z,oe,ce,L,"doesNotMatch")};function J(){for(var L=arguments.length,Z=new Array(L),oe=0;oe<L;oe++)Z[oe]=arguments[oe];W.apply(void 0,[J,Z.length].concat(Z))}return S.strict=B(J,S,{equal:S.strictEqual,deepEqual:S.deepStrictEqual,notEqual:S.notStrictEqual,notDeepEqual:S.notDeepStrictEqual}),S.strict.strict=S.strict,assert$2.exports}var fountainUtils={},xoshiro={},bignumber$1={exports:{}},bignumber=bignumber$1.exports,hasRequiredBignumber;function requireBignumber(){return hasRequiredBignumber||(hasRequiredBignumber=1,(function(e){(function(t){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,a=Math.floor,l="[BigNumber Error] ",u=l+"Number primitive has more than 15 significant digits: ",f=1e14,x=14,p=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,b=1e9;function w(_){var S,O,$,z=L.prototype={constructor:L,toString:null,valueOf:null},W=new L(1),U=20,I=4,G=-7,k=21,M=-1e7,q=1e7,K=!1,H=1,Q=0,D={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Y="0123456789abcdefghijklmnopqrstuvwxyz",J=!0;function L(te,ae){var le,ue,be,Be,Ce,Se,ke,we,Fe=this;if(!(Fe instanceof L))return new L(te,ae);if(ae==null){if(te&&te._isBigNumber===!0){Fe.s=te.s,!te.c||te.e>q?Fe.c=Fe.e=null:te.e<M?Fe.c=[Fe.e=0]:(Fe.e=te.e,Fe.c=te.c.slice());return}if((Se=typeof te=="number")&&te*0==0){if(Fe.s=1/te<0?(te=-te,-1):1,te===~~te){for(Be=0,Ce=te;Ce>=10;Ce/=10,Be++);Be>q?Fe.c=Fe.e=null:(Fe.e=Be,Fe.c=[te]);return}we=String(te)}else{if(!n.test(we=String(te)))return $(Fe,we,Se);Fe.s=we.charCodeAt(0)==45?(we=we.slice(1),-1):1}(Be=we.indexOf("."))>-1&&(we=we.replace(".","")),(Ce=we.search(/e/i))>0?(Be<0&&(Be=Ce),Be+=+we.slice(Ce+1),we=we.substring(0,Ce)):Be<0&&(Be=we.length)}else{if(F(ae,2,Y.length,"Base"),ae==10&&J)return Fe=new L(te),de(Fe,U+Fe.e+1,I);if(we=String(te),Se=typeof te=="number"){if(te*0!=0)return $(Fe,we,Se,ae);if(Fe.s=1/te<0?(we=we.slice(1),-1):1,L.DEBUG&&we.replace(/^0\.0*|\./,"").length>15)throw Error(u+te)}else Fe.s=we.charCodeAt(0)===45?(we=we.slice(1),-1):1;for(le=Y.slice(0,ae),Be=Ce=0,ke=we.length;Ce<ke;Ce++)if(le.indexOf(ue=we.charAt(Ce))<0){if(ue=="."){if(Ce>Be){Be=ke;continue}}else if(!be&&(we==we.toUpperCase()&&(we=we.toLowerCase())||we==we.toLowerCase()&&(we=we.toUpperCase()))){be=!0,Ce=-1,Be=0;continue}return $(Fe,String(te),Se,ae)}Se=!1,we=O(we,ae,10,Fe.s),(Be=we.indexOf("."))>-1?we=we.replace(".",""):Be=we.length}for(Ce=0;we.charCodeAt(Ce)===48;Ce++);for(ke=we.length;we.charCodeAt(--ke)===48;);if(we=we.slice(Ce,++ke)){if(ke-=Ce,Se&&L.DEBUG&&ke>15&&(te>p||te!==a(te)))throw Error(u+Fe.s*te);if((Be=Be-Ce-1)>q)Fe.c=Fe.e=null;else if(Be<M)Fe.c=[Fe.e=0];else{if(Fe.e=Be,Fe.c=[],Ce=(Be+1)%x,Be<0&&(Ce+=x),Ce<ke){for(Ce&&Fe.c.push(+we.slice(0,Ce)),ke-=x;Ce<ke;)Fe.c.push(+we.slice(Ce,Ce+=x));Ce=x-(we=we.slice(Ce)).length}else Ce-=ke;for(;Ce--;we+="0");Fe.c.push(+we)}}else Fe.c=[Fe.e=0]}L.clone=w,L.ROUND_UP=0,L.ROUND_DOWN=1,L.ROUND_CEIL=2,L.ROUND_FLOOR=3,L.ROUND_HALF_UP=4,L.ROUND_HALF_DOWN=5,L.ROUND_HALF_EVEN=6,L.ROUND_HALF_CEIL=7,L.ROUND_HALF_FLOOR=8,L.EUCLID=9,L.config=L.set=function(te){var ae,le;if(te!=null)if(typeof te=="object"){if(te.hasOwnProperty(ae="DECIMAL_PLACES")&&(le=te[ae],F(le,0,b,ae),U=le),te.hasOwnProperty(ae="ROUNDING_MODE")&&(le=te[ae],F(le,0,8,ae),I=le),te.hasOwnProperty(ae="EXPONENTIAL_AT")&&(le=te[ae],le&&le.pop?(F(le[0],-b,0,ae),F(le[1],0,b,ae),G=le[0],k=le[1]):(F(le,-b,b,ae),G=-(k=le<0?-le:le))),te.hasOwnProperty(ae="RANGE"))if(le=te[ae],le&&le.pop)F(le[0],-b,-1,ae),F(le[1],1,b,ae),M=le[0],q=le[1];else if(F(le,-b,b,ae),le)M=-(q=le<0?-le:le);else throw Error(l+ae+" cannot be zero: "+le);if(te.hasOwnProperty(ae="CRYPTO"))if(le=te[ae],le===!!le)if(le)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))K=le;else throw K=!le,Error(l+"crypto unavailable");else K=le;else throw Error(l+ae+" not true or false: "+le);if(te.hasOwnProperty(ae="MODULO_MODE")&&(le=te[ae],F(le,0,9,ae),H=le),te.hasOwnProperty(ae="POW_PRECISION")&&(le=te[ae],F(le,0,b,ae),Q=le),te.hasOwnProperty(ae="FORMAT"))if(le=te[ae],typeof le=="object")D=le;else throw Error(l+ae+" not an object: "+le);if(te.hasOwnProperty(ae="ALPHABET"))if(le=te[ae],typeof le=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(le))J=le.slice(0,10)=="0123456789",Y=le;else throw Error(l+ae+" invalid: "+le)}else throw Error(l+"Object expected: "+te);return{DECIMAL_PLACES:U,ROUNDING_MODE:I,EXPONENTIAL_AT:[G,k],RANGE:[M,q],CRYPTO:K,MODULO_MODE:H,POW_PRECISION:Q,FORMAT:D,ALPHABET:Y}},L.isBigNumber=function(te){if(!te||te._isBigNumber!==!0)return!1;if(!L.DEBUG)return!0;var ae,le,ue=te.c,be=te.e,Be=te.s;e:if({}.toString.call(ue)=="[object Array]"){if((Be===1||Be===-1)&&be>=-b&&be<=b&&be===a(be)){if(ue[0]===0){if(be===0&&ue.length===1)return!0;break e}if(ae=(be+1)%x,ae<1&&(ae+=x),String(ue[0]).length==ae){for(ae=0;ae<ue.length;ae++)if(le=ue[ae],le<0||le>=f||le!==a(le))break e;if(le!==0)return!0}}}else if(ue===null&&be===null&&(Be===null||Be===1||Be===-1))return!0;throw Error(l+"Invalid BigNumber: "+te)},L.maximum=L.max=function(){return oe(arguments,-1)},L.minimum=L.min=function(){return oe(arguments,1)},L.random=(function(){var te=9007199254740992,ae=Math.random()*te&2097151?function(){return a(Math.random()*te)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(le){var ue,be,Be,Ce,Se,ke=0,we=[],Fe=new L(W);if(le==null?le=U:F(le,0,b),Ce=o(le/x),K)if(crypto.getRandomValues){for(ue=crypto.getRandomValues(new Uint32Array(Ce*=2));ke<Ce;)Se=ue[ke]*131072+(ue[ke+1]>>>11),Se>=9e15?(be=crypto.getRandomValues(new Uint32Array(2)),ue[ke]=be[0],ue[ke+1]=be[1]):(we.push(Se%1e14),ke+=2);ke=Ce/2}else if(crypto.randomBytes){for(ue=crypto.randomBytes(Ce*=7);ke<Ce;)Se=(ue[ke]&31)*281474976710656+ue[ke+1]*1099511627776+ue[ke+2]*4294967296+ue[ke+3]*16777216+(ue[ke+4]<<16)+(ue[ke+5]<<8)+ue[ke+6],Se>=9e15?crypto.randomBytes(7).copy(ue,ke):(we.push(Se%1e14),ke+=7);ke=Ce/7}else throw K=!1,Error(l+"crypto unavailable");if(!K)for(;ke<Ce;)Se=ae(),Se<9e15&&(we[ke++]=Se%1e14);for(Ce=we[--ke],le%=x,Ce&&le&&(Se=g[x-le],we[ke]=a(Ce/Se)*Se);we[ke]===0;we.pop(),ke--);if(ke<0)we=[Be=0];else{for(Be=-1;we[0]===0;we.splice(0,1),Be-=x);for(ke=1,Se=we[0];Se>=10;Se/=10,ke++);ke<x&&(Be-=x-ke)}return Fe.e=Be,Fe.c=we,Fe}})(),L.sum=function(){for(var te=1,ae=arguments,le=new L(ae[0]);te<ae.length;)le=le.plus(ae[te++]);return le},O=(function(){var te="0123456789";function ae(le,ue,be,Be){for(var Ce,Se=[0],ke,we=0,Fe=le.length;we<Fe;){for(ke=Se.length;ke--;Se[ke]*=ue);for(Se[0]+=Be.indexOf(le.charAt(we++)),Ce=0;Ce<Se.length;Ce++)Se[Ce]>be-1&&(Se[Ce+1]==null&&(Se[Ce+1]=0),Se[Ce+1]+=Se[Ce]/be|0,Se[Ce]%=be)}return Se.reverse()}return function(le,ue,be,Be,Ce){var Se,ke,we,Fe,Pe,Ye,Ve,Ee,ve=le.indexOf("."),Te=U,Re=I;for(ve>=0&&(Fe=Q,Q=0,le=le.replace(".",""),Ee=new L(ue),Ye=Ee.pow(le.length-ve),Q=Fe,Ee.c=ae(T(B(Ye.c),Ye.e,"0"),10,be,te),Ee.e=Ee.c.length),Ve=ae(le,ue,be,Ce?(Se=Y,te):(Se=te,Y)),we=Fe=Ve.length;Ve[--Fe]==0;Ve.pop());if(!Ve[0])return Se.charAt(0);if(ve<0?--we:(Ye.c=Ve,Ye.e=we,Ye.s=Be,Ye=S(Ye,Ee,Te,Re,be),Ve=Ye.c,Pe=Ye.r,we=Ye.e),ke=we+Te+1,ve=Ve[ke],Fe=be/2,Pe=Pe||ke<0||Ve[ke+1]!=null,Pe=Re<4?(ve!=null||Pe)&&(Re==0||Re==(Ye.s<0?3:2)):ve>Fe||ve==Fe&&(Re==4||Pe||Re==6&&Ve[ke-1]&1||Re==(Ye.s<0?8:7)),ke<1||!Ve[0])le=Pe?T(Se.charAt(1),-Te,Se.charAt(0)):Se.charAt(0);else{if(Ve.length=ke,Pe)for(--be;++Ve[--ke]>be;)Ve[ke]=0,ke||(++we,Ve=[1].concat(Ve));for(Fe=Ve.length;!Ve[--Fe];);for(ve=0,le="";ve<=Fe;le+=Se.charAt(Ve[ve++]));le=T(le,we,Se.charAt(0))}return le}})(),S=(function(){function te(ue,be,Be){var Ce,Se,ke,we,Fe=0,Pe=ue.length,Ye=be%y,Ve=be/y|0;for(ue=ue.slice();Pe--;)ke=ue[Pe]%y,we=ue[Pe]/y|0,Ce=Ve*ke+we*Ye,Se=Ye*ke+Ce%y*y+Fe,Fe=(Se/Be|0)+(Ce/y|0)+Ve*we,ue[Pe]=Se%Be;return Fe&&(ue=[Fe].concat(ue)),ue}function ae(ue,be,Be,Ce){var Se,ke;if(Be!=Ce)ke=Be>Ce?1:-1;else for(Se=ke=0;Se<Be;Se++)if(ue[Se]!=be[Se]){ke=ue[Se]>be[Se]?1:-1;break}return ke}function le(ue,be,Be,Ce){for(var Se=0;Be--;)ue[Be]-=Se,Se=ue[Be]<be[Be]?1:0,ue[Be]=Se*Ce+ue[Be]-be[Be];for(;!ue[0]&&ue.length>1;ue.splice(0,1));}return function(ue,be,Be,Ce,Se){var ke,we,Fe,Pe,Ye,Ve,Ee,ve,Te,Re,ye,Ne,ie,P,V,he,_e,je=ue.s==be.s?1:-1,Ie=ue.c,Ze=be.c;if(!Ie||!Ie[0]||!Ze||!Ze[0])return new L(!ue.s||!be.s||(Ie?Ze&&Ie[0]==Ze[0]:!Ze)?NaN:Ie&&Ie[0]==0||!Ze?je*0:je/0);for(ve=new L(je),Te=ve.c=[],we=ue.e-be.e,je=Be+we+1,Se||(Se=f,we=v(ue.e/x)-v(be.e/x),je=je/x|0),Fe=0;Ze[Fe]==(Ie[Fe]||0);Fe++);if(Ze[Fe]>(Ie[Fe]||0)&&we--,je<0)Te.push(1),Pe=!0;else{for(P=Ie.length,he=Ze.length,Fe=0,je+=2,Ye=a(Se/(Ze[0]+1)),Ye>1&&(Ze=te(Ze,Ye,Se),Ie=te(Ie,Ye,Se),he=Ze.length,P=Ie.length),ie=he,Re=Ie.slice(0,he),ye=Re.length;ye<he;Re[ye++]=0);_e=Ze.slice(),_e=[0].concat(_e),V=Ze[0],Ze[1]>=Se/2&&V++;do{if(Ye=0,ke=ae(Ze,Re,he,ye),ke<0){if(Ne=Re[0],he!=ye&&(Ne=Ne*Se+(Re[1]||0)),Ye=a(Ne/V),Ye>1)for(Ye>=Se&&(Ye=Se-1),Ve=te(Ze,Ye,Se),Ee=Ve.length,ye=Re.length;ae(Ve,Re,Ee,ye)==1;)Ye--,le(Ve,he<Ee?_e:Ze,Ee,Se),Ee=Ve.length,ke=1;else Ye==0&&(ke=Ye=1),Ve=Ze.slice(),Ee=Ve.length;if(Ee<ye&&(Ve=[0].concat(Ve)),le(Re,Ve,ye,Se),ye=Re.length,ke==-1)for(;ae(Ze,Re,he,ye)<1;)Ye++,le(Re,he<ye?_e:Ze,ye,Se),ye=Re.length}else ke===0&&(Ye++,Re=[0]);Te[Fe++]=Ye,Re[0]?Re[ye++]=Ie[ie]||0:(Re=[Ie[ie]],ye=1)}while((ie++<P||Re[0]!=null)&&je--);Pe=Re[0]!=null,Te[0]||Te.splice(0,1)}if(Se==f){for(Fe=1,je=Te[0];je>=10;je/=10,Fe++);de(ve,Be+(ve.e=Fe+we*x-1)+1,Ce,Pe)}else ve.e=we,ve.r=+Pe;return ve}})();function Z(te,ae,le,ue){var be,Be,Ce,Se,ke;if(le==null?le=I:F(le,0,8),!te.c)return te.toString();if(be=te.c[0],Ce=te.e,ae==null)ke=B(te.c),ke=ue==1||ue==2&&(Ce<=G||Ce>=k)?N(ke,Ce):T(ke,Ce,"0");else if(te=de(new L(te),ae,le),Be=te.e,ke=B(te.c),Se=ke.length,ue==1||ue==2&&(ae<=Be||Be<=G)){for(;Se<ae;ke+="0",Se++);ke=N(ke,Be)}else if(ae-=Ce+(ue===2&&Be>Ce),ke=T(ke,Be,"0"),Be+1>Se){if(--ae>0)for(ke+=".";ae--;ke+="0");}else if(ae+=Be-Se,ae>0)for(Be+1==Se&&(ke+=".");ae--;ke+="0");return te.s<0&&be?"-"+ke:ke}function oe(te,ae){for(var le,ue,be=1,Be=new L(te[0]);be<te.length;be++)ue=new L(te[be]),(!ue.s||(le=j(Be,ue))===ae||le===0&&Be.s===ae)&&(Be=ue);return Be}function ce(te,ae,le){for(var ue=1,be=ae.length;!ae[--be];ae.pop());for(be=ae[0];be>=10;be/=10,ue++);return(le=ue+le*x-1)>q?te.c=te.e=null:le<M?te.c=[te.e=0]:(te.e=le,te.c=ae),te}$=(function(){var te=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ae=/^([^.]+)\.$/,le=/^\.([^.]+)$/,ue=/^-?(Infinity|NaN)$/,be=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Be,Ce,Se,ke){var we,Fe=Se?Ce:Ce.replace(be,"");if(ue.test(Fe))Be.s=isNaN(Fe)?null:Fe<0?-1:1;else{if(!Se&&(Fe=Fe.replace(te,function(Pe,Ye,Ve){return we=(Ve=Ve.toLowerCase())=="x"?16:Ve=="b"?2:8,!ke||ke==we?Ye:Pe}),ke&&(we=ke,Fe=Fe.replace(ae,"$1").replace(le,"0.$1")),Ce!=Fe))return new L(Fe,we);if(L.DEBUG)throw Error(l+"Not a"+(ke?" base "+ke:"")+" number: "+Ce);Be.s=null}Be.c=Be.e=null}})();function de(te,ae,le,ue){var be,Be,Ce,Se,ke,we,Fe,Pe=te.c,Ye=g;if(Pe){e:{for(be=1,Se=Pe[0];Se>=10;Se/=10,be++);if(Be=ae-be,Be<0)Be+=x,Ce=ae,ke=Pe[we=0],Fe=a(ke/Ye[be-Ce-1]%10);else if(we=o((Be+1)/x),we>=Pe.length)if(ue){for(;Pe.length<=we;Pe.push(0));ke=Fe=0,be=1,Be%=x,Ce=Be-x+1}else break e;else{for(ke=Se=Pe[we],be=1;Se>=10;Se/=10,be++);Be%=x,Ce=Be-x+be,Fe=Ce<0?0:a(ke/Ye[be-Ce-1]%10)}if(ue=ue||ae<0||Pe[we+1]!=null||(Ce<0?ke:ke%Ye[be-Ce-1]),ue=le<4?(Fe||ue)&&(le==0||le==(te.s<0?3:2)):Fe>5||Fe==5&&(le==4||ue||le==6&&(Be>0?Ce>0?ke/Ye[be-Ce]:0:Pe[we-1])%10&1||le==(te.s<0?8:7)),ae<1||!Pe[0])return Pe.length=0,ue?(ae-=te.e+1,Pe[0]=Ye[(x-ae%x)%x],te.e=-ae||0):Pe[0]=te.e=0,te;if(Be==0?(Pe.length=we,Se=1,we--):(Pe.length=we+1,Se=Ye[x-Be],Pe[we]=Ce>0?a(ke/Ye[be-Ce]%Ye[Ce])*Se:0),ue)for(;;)if(we==0){for(Be=1,Ce=Pe[0];Ce>=10;Ce/=10,Be++);for(Ce=Pe[0]+=Se,Se=1;Ce>=10;Ce/=10,Se++);Be!=Se&&(te.e++,Pe[0]==f&&(Pe[0]=1));break}else{if(Pe[we]+=Se,Pe[we]!=f)break;Pe[we--]=0,Se=1}for(Be=Pe.length;Pe[--Be]===0;Pe.pop());}te.e>q?te.c=te.e=null:te.e<M&&(te.c=[te.e=0])}return te}function xe(te){var ae,le=te.e;return le===null?te.toString():(ae=B(te.c),ae=le<=G||le>=k?N(ae,le):T(ae,le,"0"),te.s<0?"-"+ae:ae)}return z.absoluteValue=z.abs=function(){var te=new L(this);return te.s<0&&(te.s=1),te},z.comparedTo=function(te,ae){return j(this,new L(te,ae))},z.decimalPlaces=z.dp=function(te,ae){var le,ue,be,Be=this;if(te!=null)return F(te,0,b),ae==null?ae=I:F(ae,0,8),de(new L(Be),te+Be.e+1,ae);if(!(le=Be.c))return null;if(ue=((be=le.length-1)-v(this.e/x))*x,be=le[be])for(;be%10==0;be/=10,ue--);return ue<0&&(ue=0),ue},z.dividedBy=z.div=function(te,ae){return S(this,new L(te,ae),U,I)},z.dividedToIntegerBy=z.idiv=function(te,ae){return S(this,new L(te,ae),0,1)},z.exponentiatedBy=z.pow=function(te,ae){var le,ue,be,Be,Ce,Se,ke,we,Fe,Pe=this;if(te=new L(te),te.c&&!te.isInteger())throw Error(l+"Exponent not an integer: "+xe(te));if(ae!=null&&(ae=new L(ae)),Se=te.e>14,!Pe.c||!Pe.c[0]||Pe.c[0]==1&&!Pe.e&&Pe.c.length==1||!te.c||!te.c[0])return Fe=new L(Math.pow(+xe(Pe),Se?te.s*(2-C(te)):+xe(te))),ae?Fe.mod(ae):Fe;if(ke=te.s<0,ae){if(ae.c?!ae.c[0]:!ae.s)return new L(NaN);ue=!ke&&Pe.isInteger()&&ae.isInteger(),ue&&(Pe=Pe.mod(ae))}else{if(te.e>9&&(Pe.e>0||Pe.e<-1||(Pe.e==0?Pe.c[0]>1||Se&&Pe.c[1]>=24e7:Pe.c[0]<8e13||Se&&Pe.c[0]<=9999975e7)))return Be=Pe.s<0&&C(te)?-0:0,Pe.e>-1&&(Be=1/Be),new L(ke?1/Be:Be);Q&&(Be=o(Q/x+2))}for(Se?(le=new L(.5),ke&&(te.s=1),we=C(te)):(be=Math.abs(+xe(te)),we=be%2),Fe=new L(W);;){if(we){if(Fe=Fe.times(Pe),!Fe.c)break;Be?Fe.c.length>Be&&(Fe.c.length=Be):ue&&(Fe=Fe.mod(ae))}if(be){if(be=a(be/2),be===0)break;we=be%2}else if(te=te.times(le),de(te,te.e+1,1),te.e>14)we=C(te);else{if(be=+xe(te),be===0)break;we=be%2}Pe=Pe.times(Pe),Be?Pe.c&&Pe.c.length>Be&&(Pe.c.length=Be):ue&&(Pe=Pe.mod(ae))}return ue?Fe:(ke&&(Fe=W.div(Fe)),ae?Fe.mod(ae):Be?de(Fe,Q,I,Ce):Fe)},z.integerValue=function(te){var ae=new L(this);return te==null?te=I:F(te,0,8),de(ae,ae.e+1,te)},z.isEqualTo=z.eq=function(te,ae){return j(this,new L(te,ae))===0},z.isFinite=function(){return!!this.c},z.isGreaterThan=z.gt=function(te,ae){return j(this,new L(te,ae))>0},z.isGreaterThanOrEqualTo=z.gte=function(te,ae){return(ae=j(this,new L(te,ae)))===1||ae===0},z.isInteger=function(){return!!this.c&&v(this.e/x)>this.c.length-2},z.isLessThan=z.lt=function(te,ae){return j(this,new L(te,ae))<0},z.isLessThanOrEqualTo=z.lte=function(te,ae){return(ae=j(this,new L(te,ae)))===-1||ae===0},z.isNaN=function(){return!this.s},z.isNegative=function(){return this.s<0},z.isPositive=function(){return this.s>0},z.isZero=function(){return!!this.c&&this.c[0]==0},z.minus=function(te,ae){var le,ue,be,Be,Ce=this,Se=Ce.s;if(te=new L(te,ae),ae=te.s,!Se||!ae)return new L(NaN);if(Se!=ae)return te.s=-ae,Ce.plus(te);var ke=Ce.e/x,we=te.e/x,Fe=Ce.c,Pe=te.c;if(!ke||!we){if(!Fe||!Pe)return Fe?(te.s=-ae,te):new L(Pe?Ce:NaN);if(!Fe[0]||!Pe[0])return Pe[0]?(te.s=-ae,te):new L(Fe[0]?Ce:I==3?-0:0)}if(ke=v(ke),we=v(we),Fe=Fe.slice(),Se=ke-we){for((Be=Se<0)?(Se=-Se,be=Fe):(we=ke,be=Pe),be.reverse(),ae=Se;ae--;be.push(0));be.reverse()}else for(ue=(Be=(Se=Fe.length)<(ae=Pe.length))?Se:ae,Se=ae=0;ae<ue;ae++)if(Fe[ae]!=Pe[ae]){Be=Fe[ae]<Pe[ae];break}if(Be&&(be=Fe,Fe=Pe,Pe=be,te.s=-te.s),ae=(ue=Pe.length)-(le=Fe.length),ae>0)for(;ae--;Fe[le++]=0);for(ae=f-1;ue>Se;){if(Fe[--ue]<Pe[ue]){for(le=ue;le&&!Fe[--le];Fe[le]=ae);--Fe[le],Fe[ue]+=f}Fe[ue]-=Pe[ue]}for(;Fe[0]==0;Fe.splice(0,1),--we);return Fe[0]?ce(te,Fe,we):(te.s=I==3?-1:1,te.c=[te.e=0],te)},z.modulo=z.mod=function(te,ae){var le,ue,be=this;return te=new L(te,ae),!be.c||!te.s||te.c&&!te.c[0]?new L(NaN):!te.c||be.c&&!be.c[0]?new L(be):(H==9?(ue=te.s,te.s=1,le=S(be,te,0,3),te.s=ue,le.s*=ue):le=S(be,te,0,H),te=be.minus(le.times(te)),!te.c[0]&&H==1&&(te.s=be.s),te)},z.multipliedBy=z.times=function(te,ae){var le,ue,be,Be,Ce,Se,ke,we,Fe,Pe,Ye,Ve,Ee,ve,Te,Re=this,ye=Re.c,Ne=(te=new L(te,ae)).c;if(!ye||!Ne||!ye[0]||!Ne[0])return!Re.s||!te.s||ye&&!ye[0]&&!Ne||Ne&&!Ne[0]&&!ye?te.c=te.e=te.s=null:(te.s*=Re.s,!ye||!Ne?te.c=te.e=null:(te.c=[0],te.e=0)),te;for(ue=v(Re.e/x)+v(te.e/x),te.s*=Re.s,ke=ye.length,Pe=Ne.length,ke<Pe&&(Ee=ye,ye=Ne,Ne=Ee,be=ke,ke=Pe,Pe=be),be=ke+Pe,Ee=[];be--;Ee.push(0));for(ve=f,Te=y,be=Pe;--be>=0;){for(le=0,Ye=Ne[be]%Te,Ve=Ne[be]/Te|0,Ce=ke,Be=be+Ce;Be>be;)we=ye[--Ce]%Te,Fe=ye[Ce]/Te|0,Se=Ve*we+Fe*Ye,we=Ye*we+Se%Te*Te+Ee[Be]+le,le=(we/ve|0)+(Se/Te|0)+Ve*Fe,Ee[Be--]=we%ve;Ee[Be]=le}return le?++ue:Ee.splice(0,1),ce(te,Ee,ue)},z.negated=function(){var te=new L(this);return te.s=-te.s||null,te},z.plus=function(te,ae){var le,ue=this,be=ue.s;if(te=new L(te,ae),ae=te.s,!be||!ae)return new L(NaN);if(be!=ae)return te.s=-ae,ue.minus(te);var Be=ue.e/x,Ce=te.e/x,Se=ue.c,ke=te.c;if(!Be||!Ce){if(!Se||!ke)return new L(be/0);if(!Se[0]||!ke[0])return ke[0]?te:new L(Se[0]?ue:be*0)}if(Be=v(Be),Ce=v(Ce),Se=Se.slice(),be=Be-Ce){for(be>0?(Ce=Be,le=ke):(be=-be,le=Se),le.reverse();be--;le.push(0));le.reverse()}for(be=Se.length,ae=ke.length,be-ae<0&&(le=ke,ke=Se,Se=le,ae=be),be=0;ae;)be=(Se[--ae]=Se[ae]+ke[ae]+be)/f|0,Se[ae]=f===Se[ae]?0:Se[ae]%f;return be&&(Se=[be].concat(Se),++Ce),ce(te,Se,Ce)},z.precision=z.sd=function(te,ae){var le,ue,be,Be=this;if(te!=null&&te!==!!te)return F(te,1,b),ae==null?ae=I:F(ae,0,8),de(new L(Be),te,ae);if(!(le=Be.c))return null;if(be=le.length-1,ue=be*x+1,be=le[be]){for(;be%10==0;be/=10,ue--);for(be=le[0];be>=10;be/=10,ue++);}return te&&Be.e+1>ue&&(ue=Be.e+1),ue},z.shiftedBy=function(te){return F(te,-p,p),this.times("1e"+te)},z.squareRoot=z.sqrt=function(){var te,ae,le,ue,be,Be=this,Ce=Be.c,Se=Be.s,ke=Be.e,we=U+4,Fe=new L("0.5");if(Se!==1||!Ce||!Ce[0])return new L(!Se||Se<0&&(!Ce||Ce[0])?NaN:Ce?Be:1/0);if(Se=Math.sqrt(+xe(Be)),Se==0||Se==1/0?(ae=B(Ce),(ae.length+ke)%2==0&&(ae+="0"),Se=Math.sqrt(+ae),ke=v((ke+1)/2)-(ke<0||ke%2),Se==1/0?ae="5e"+ke:(ae=Se.toExponential(),ae=ae.slice(0,ae.indexOf("e")+1)+ke),le=new L(ae)):le=new L(Se+""),le.c[0]){for(ke=le.e,Se=ke+we,Se<3&&(Se=0);;)if(be=le,le=Fe.times(be.plus(S(Be,be,we,1))),B(be.c).slice(0,Se)===(ae=B(le.c)).slice(0,Se))if(le.e<ke&&--Se,ae=ae.slice(Se-3,Se+1),ae=="9999"||!ue&&ae=="4999"){if(!ue&&(de(be,be.e+U+2,0),be.times(be).eq(Be))){le=be;break}we+=4,Se+=4,ue=1}else{(!+ae||!+ae.slice(1)&&ae.charAt(0)=="5")&&(de(le,le.e+U+2,1),te=!le.times(le).eq(Be));break}}return de(le,le.e+U+1,I,te)},z.toExponential=function(te,ae){return te!=null&&(F(te,0,b),te++),Z(this,te,ae,1)},z.toFixed=function(te,ae){return te!=null&&(F(te,0,b),te=te+this.e+1),Z(this,te,ae)},z.toFormat=function(te,ae,le){var ue,be=this;if(le==null)te!=null&&ae&&typeof ae=="object"?(le=ae,ae=null):te&&typeof te=="object"?(le=te,te=ae=null):le=D;else if(typeof le!="object")throw Error(l+"Argument not an object: "+le);if(ue=be.toFixed(te,ae),be.c){var Be,Ce=ue.split("."),Se=+le.groupSize,ke=+le.secondaryGroupSize,we=le.groupSeparator||"",Fe=Ce[0],Pe=Ce[1],Ye=be.s<0,Ve=Ye?Fe.slice(1):Fe,Ee=Ve.length;if(ke&&(Be=Se,Se=ke,ke=Be,Ee-=Be),Se>0&&Ee>0){for(Be=Ee%Se||Se,Fe=Ve.substr(0,Be);Be<Ee;Be+=Se)Fe+=we+Ve.substr(Be,Se);ke>0&&(Fe+=we+Ve.slice(Be)),Ye&&(Fe="-"+Fe)}ue=Pe?Fe+(le.decimalSeparator||"")+((ke=+le.fractionGroupSize)?Pe.replace(new RegExp("\\d{"+ke+"}\\B","g"),"$&"+(le.fractionGroupSeparator||"")):Pe):Fe}return(le.prefix||"")+ue+(le.suffix||"")},z.toFraction=function(te){var ae,le,ue,be,Be,Ce,Se,ke,we,Fe,Pe,Ye,Ve=this,Ee=Ve.c;if(te!=null&&(Se=new L(te),!Se.isInteger()&&(Se.c||Se.s!==1)||Se.lt(W)))throw Error(l+"Argument "+(Se.isInteger()?"out of range: ":"not an integer: ")+xe(Se));if(!Ee)return new L(Ve);for(ae=new L(W),we=le=new L(W),ue=ke=new L(W),Ye=B(Ee),Be=ae.e=Ye.length-Ve.e-1,ae.c[0]=g[(Ce=Be%x)<0?x+Ce:Ce],te=!te||Se.comparedTo(ae)>0?Be>0?ae:we:Se,Ce=q,q=1/0,Se=new L(Ye),ke.c[0]=0;Fe=S(Se,ae,0,1),be=le.plus(Fe.times(ue)),be.comparedTo(te)!=1;)le=ue,ue=be,we=ke.plus(Fe.times(be=we)),ke=be,ae=Se.minus(Fe.times(be=ae)),Se=be;return be=S(te.minus(le),ue,0,1),ke=ke.plus(be.times(we)),le=le.plus(be.times(ue)),ke.s=we.s=Ve.s,Be=Be*2,Pe=S(we,ue,Be,I).minus(Ve).abs().comparedTo(S(ke,le,Be,I).minus(Ve).abs())<1?[we,ue]:[ke,le],q=Ce,Pe},z.toNumber=function(){return+xe(this)},z.toPrecision=function(te,ae){return te!=null&&F(te,1,b),Z(this,te,ae,2)},z.toString=function(te){var ae,le=this,ue=le.s,be=le.e;return be===null?ue?(ae="Infinity",ue<0&&(ae="-"+ae)):ae="NaN":(te==null?ae=be<=G||be>=k?N(B(le.c),be):T(B(le.c),be,"0"):te===10&&J?(le=de(new L(le),U+be+1,I),ae=T(B(le.c),le.e,"0")):(F(te,2,Y.length,"Base"),ae=O(T(B(le.c),be,"0"),10,te,ue,!0)),ue<0&&le.c[0]&&(ae="-"+ae)),ae},z.valueOf=z.toJSON=function(){return xe(this)},z._isBigNumber=!0,_!=null&&L.set(_),L}function v(_){var S=_|0;return _>0||_===S?S:S-1}function B(_){for(var S,O,$=1,z=_.length,W=_[0]+"";$<z;){for(S=_[$++]+"",O=x-S.length;O--;S="0"+S);W+=S}for(z=W.length;W.charCodeAt(--z)===48;);return W.slice(0,z+1||1)}function j(_,S){var O,$,z=_.c,W=S.c,U=_.s,I=S.s,G=_.e,k=S.e;if(!U||!I)return null;if(O=z&&!z[0],$=W&&!W[0],O||$)return O?$?0:-I:U;if(U!=I)return U;if(O=U<0,$=G==k,!z||!W)return $?0:!z^O?1:-1;if(!$)return G>k^O?1:-1;for(I=(G=z.length)<(k=W.length)?G:k,U=0;U<I;U++)if(z[U]!=W[U])return z[U]>W[U]^O?1:-1;return G==k?0:G>k^O?1:-1}function F(_,S,O,$){if(_<S||_>O||_!==a(_))throw Error(l+($||"Argument")+(typeof _=="number"?_<S||_>O?" out of range: ":" not an integer: ":" not a primitive number: ")+String(_))}function C(_){var S=_.c.length-1;return v(_.e/x)==S&&_.c[S]%2!=0}function N(_,S){return(_.length>1?_.charAt(0)+"."+_.slice(1):_)+(S<0?"e":"e+")+S}function T(_,S,O){var $,z;if(S<0){for(z=O+".";++S;z+=O);_=z+_}else if($=_.length,++S>$){for(z=O,S-=$;--S;z+=O);_+=z}else S<$&&(_=_.slice(0,S)+"."+_.slice(S));return _}r=w(),r.default=r.BigNumber=r,e.exports?e.exports=r:(t||(t=typeof self<"u"&&self?self:window),t.BigNumber=r)})(bignumber)})(bignumber$1)),bignumber$1.exports}var jsbiUmd$1={exports:{}},jsbiUmd=jsbiUmd$1.exports,hasRequiredJsbiUmd;function requireJsbiUmd(){return hasRequiredJsbiUmd||(hasRequiredJsbiUmd=1,(function(e,t){(function(r,n){e.exports=n()})(jsbiUmd,function(){var r=Math.imul,n=Math.clz32,o=Math.abs,a=Math.max,l=Math.floor;class u extends Array{constructor(x,p){if(super(x),this.sign=p,x>u.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(x){var p=Number.isFinite;if(typeof x=="number"){if(x===0)return u.__zero();if(u.__isOneDigitInt(x))return 0>x?u.__oneDigit(-x,!0):u.__oneDigit(x,!1);if(!p(x)||l(x)!==x)throw new RangeError("The number "+x+" cannot be converted to BigInt because it is not an integer");return u.__fromDouble(x)}if(typeof x=="string"){const g=u.__fromString(x);if(g===null)throw new SyntaxError("Cannot convert "+x+" to a BigInt");return g}if(typeof x=="boolean")return x===!0?u.__oneDigit(1,!1):u.__zero();if(typeof x=="object"){if(x.constructor===u)return x;const g=u.__toPrimitive(x);return u.BigInt(g)}throw new TypeError("Cannot convert "+x+" to a BigInt")}toDebugString(){const x=["BigInt["];for(const p of this)x.push((p&&(p>>>0).toString(16))+", ");return x.push("]"),x.join("")}toString(x=10){if(2>x||36<x)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(x&x-1)==0?u.__toStringBasePowerOfTwo(this,x):u.__toStringGeneric(this,x,!1)}static toNumber(x){const p=x.length;if(p===0)return 0;if(p===1){const O=x.__unsignedDigit(0);return x.sign?-O:O}const g=x.__digit(p-1),y=u.__clz30(g),b=30*p-y;if(1024<b)return x.sign?-1/0:1/0;let w=b-1,v=g,B=p-1;const j=y+3;let F=j===32?0:v<<j;F>>>=12;const C=j-12;let N=12<=j?0:v<<20+j,T=20+j;for(0<C&&0<B&&(B--,v=x.__digit(B),F|=v>>>30-C,N=v<<C+2,T=C+2);0<T&&0<B;)B--,v=x.__digit(B),N|=30<=T?v<<T-30:v>>>30-T,T-=30;const _=u.__decideRounding(x,T,B,v);if((_===1||_===0&&(1&N)==1)&&(N=N+1>>>0,N===0&&(F++,F>>>20!=0&&(F=0,w++,1023<w))))return x.sign?-1/0:1/0;const S=x.sign?-2147483648:0;return w=w+1023<<20,u.__kBitConversionInts[1]=S|w|F,u.__kBitConversionInts[0]=N,u.__kBitConversionDouble[0]}static unaryMinus(x){if(x.length===0)return x;const p=x.__copy();return p.sign=!x.sign,p}static bitwiseNot(x){return x.sign?u.__absoluteSubOne(x).__trim():u.__absoluteAddOne(x,!0)}static exponentiate(x,p){if(p.sign)throw new RangeError("Exponent must be positive");if(p.length===0)return u.__oneDigit(1,!1);if(x.length===0)return x;if(x.length===1&&x.__digit(0)===1)return x.sign&&(1&p.__digit(0))==0?u.unaryMinus(x):x;if(1<p.length)throw new RangeError("BigInt too big");let g=p.__unsignedDigit(0);if(g===1)return x;if(g>=u.__kMaxLengthBits)throw new RangeError("BigInt too big");if(x.length===1&&x.__digit(0)===2){const w=1+(0|g/30),v=x.sign&&(1&g)!=0,B=new u(w,v);B.__initializeDigits();const j=1<<g%30;return B.__setDigit(w-1,j),B}let y=null,b=x;for((1&g)!=0&&(y=x),g>>=1;g!==0;g>>=1)b=u.multiply(b,b),(1&g)!=0&&(y===null?y=b:y=u.multiply(y,b));return y}static multiply(x,p){if(x.length===0)return x;if(p.length===0)return p;let g=x.length+p.length;30<=x.__clzmsd()+p.__clzmsd()&&g--;const y=new u(g,x.sign!==p.sign);y.__initializeDigits();for(let b=0;b<x.length;b++)u.__multiplyAccumulate(p,x.__digit(b),y,b);return y.__trim()}static divide(x,p){if(p.length===0)throw new RangeError("Division by zero");if(0>u.__absoluteCompare(x,p))return u.__zero();const g=x.sign!==p.sign,y=p.__unsignedDigit(0);let b;if(p.length===1&&32767>=y){if(y===1)return g===x.sign?x:u.unaryMinus(x);b=u.__absoluteDivSmall(x,y,null)}else b=u.__absoluteDivLarge(x,p,!0,!1);return b.sign=g,b.__trim()}static remainder(x,p){if(p.length===0)throw new RangeError("Division by zero");if(0>u.__absoluteCompare(x,p))return x;const g=p.__unsignedDigit(0);if(p.length===1&&32767>=g){if(g===1)return u.__zero();const b=u.__absoluteModSmall(x,g);return b===0?u.__zero():u.__oneDigit(b,x.sign)}const y=u.__absoluteDivLarge(x,p,!1,!0);return y.sign=x.sign,y.__trim()}static add(x,p){const g=x.sign;return g===p.sign?u.__absoluteAdd(x,p,g):0<=u.__absoluteCompare(x,p)?u.__absoluteSub(x,p,g):u.__absoluteSub(p,x,!g)}static subtract(x,p){const g=x.sign;return g===p.sign?0<=u.__absoluteCompare(x,p)?u.__absoluteSub(x,p,g):u.__absoluteSub(p,x,!g):u.__absoluteAdd(x,p,g)}static leftShift(x,p){return p.length===0||x.length===0?x:p.sign?u.__rightShiftByAbsolute(x,p):u.__leftShiftByAbsolute(x,p)}static signedRightShift(x,p){return p.length===0||x.length===0?x:p.sign?u.__leftShiftByAbsolute(x,p):u.__rightShiftByAbsolute(x,p)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(x,p){return 0>u.__compareToBigInt(x,p)}static lessThanOrEqual(x,p){return 0>=u.__compareToBigInt(x,p)}static greaterThan(x,p){return 0<u.__compareToBigInt(x,p)}static greaterThanOrEqual(x,p){return 0<=u.__compareToBigInt(x,p)}static equal(x,p){if(x.sign!==p.sign||x.length!==p.length)return!1;for(let g=0;g<x.length;g++)if(x.__digit(g)!==p.__digit(g))return!1;return!0}static notEqual(x,p){return!u.equal(x,p)}static bitwiseAnd(x,p){if(!x.sign&&!p.sign)return u.__absoluteAnd(x,p).__trim();if(x.sign&&p.sign){const g=a(x.length,p.length)+1;let y=u.__absoluteSubOne(x,g);const b=u.__absoluteSubOne(p);return y=u.__absoluteOr(y,b,y),u.__absoluteAddOne(y,!0,y).__trim()}return x.sign&&([x,p]=[p,x]),u.__absoluteAndNot(x,u.__absoluteSubOne(p)).__trim()}static bitwiseXor(x,p){if(!x.sign&&!p.sign)return u.__absoluteXor(x,p).__trim();if(x.sign&&p.sign){const b=a(x.length,p.length),w=u.__absoluteSubOne(x,b),v=u.__absoluteSubOne(p);return u.__absoluteXor(w,v,w).__trim()}const g=a(x.length,p.length)+1;x.sign&&([x,p]=[p,x]);let y=u.__absoluteSubOne(p,g);return y=u.__absoluteXor(y,x,y),u.__absoluteAddOne(y,!0,y).__trim()}static bitwiseOr(x,p){const g=a(x.length,p.length);if(!x.sign&&!p.sign)return u.__absoluteOr(x,p).__trim();if(x.sign&&p.sign){let b=u.__absoluteSubOne(x,g);const w=u.__absoluteSubOne(p);return b=u.__absoluteAnd(b,w,b),u.__absoluteAddOne(b,!0,b).__trim()}x.sign&&([x,p]=[p,x]);let y=u.__absoluteSubOne(p,g);return y=u.__absoluteAndNot(y,x,y),u.__absoluteAddOne(y,!0,y).__trim()}static asIntN(x,p){if(p.length===0)return p;if(x=l(x),0>x)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(x===0)return u.__zero();if(x>=u.__kMaxLengthBits)return p;const g=0|(x+29)/30;if(p.length<g)return p;const y=p.__unsignedDigit(g-1),b=1<<(x-1)%30;if(p.length===g&&y<b)return p;if((y&b)!==b)return u.__truncateToNBits(x,p);if(!p.sign)return u.__truncateAndSubFromPowerOfTwo(x,p,!0);if((y&b-1)==0){for(let w=g-2;0<=w;w--)if(p.__digit(w)!==0)return u.__truncateAndSubFromPowerOfTwo(x,p,!1);return p.length===g&&y===b?p:u.__truncateToNBits(x,p)}return u.__truncateAndSubFromPowerOfTwo(x,p,!1)}static asUintN(x,p){if(p.length===0)return p;if(x=l(x),0>x)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(x===0)return u.__zero();if(p.sign){if(x>u.__kMaxLengthBits)throw new RangeError("BigInt too big");return u.__truncateAndSubFromPowerOfTwo(x,p,!1)}if(x>=u.__kMaxLengthBits)return p;const g=0|(x+29)/30;if(p.length<g)return p;const y=x%30;return p.length==g&&(y===0||!(p.__digit(g-1)>>>y))?p:u.__truncateToNBits(x,p)}static ADD(x,p){if(x=u.__toPrimitive(x),p=u.__toPrimitive(p),typeof x=="string")return typeof p!="string"&&(p=p.toString()),x+p;if(typeof p=="string")return x.toString()+p;if(x=u.__toNumeric(x),p=u.__toNumeric(p),u.__isBigInt(x)&&u.__isBigInt(p))return u.add(x,p);if(typeof x=="number"&&typeof p=="number")return x+p;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(x,p){return u.__compare(x,p,0)}static LE(x,p){return u.__compare(x,p,1)}static GT(x,p){return u.__compare(x,p,2)}static GE(x,p){return u.__compare(x,p,3)}static EQ(x,p){for(;;){if(u.__isBigInt(x))return u.__isBigInt(p)?u.equal(x,p):u.EQ(p,x);if(typeof x=="number"){if(u.__isBigInt(p))return u.__equalToNumber(p,x);if(typeof p!="object")return x==p;p=u.__toPrimitive(p)}else if(typeof x=="string"){if(u.__isBigInt(p))return x=u.__fromString(x),x!==null&&u.equal(x,p);if(typeof p!="object")return x==p;p=u.__toPrimitive(p)}else if(typeof x=="boolean"){if(u.__isBigInt(p))return u.__equalToNumber(p,+x);if(typeof p!="object")return x==p;p=u.__toPrimitive(p)}else if(typeof x=="symbol"){if(u.__isBigInt(p))return!1;if(typeof p!="object")return x==p;p=u.__toPrimitive(p)}else if(typeof x=="object"){if(typeof p=="object"&&p.constructor!==u)return x==p;x=u.__toPrimitive(x)}else return x==p}}static NE(x,p){return!u.EQ(x,p)}static __zero(){return new u(0,!1)}static __oneDigit(x,p){const g=new u(1,p);return g.__setDigit(0,x),g}__copy(){const x=new u(this.length,this.sign);for(let p=0;p<this.length;p++)x[p]=this[p];return x}__trim(){let x=this.length,p=this[x-1];for(;p===0;)x--,p=this[x-1],this.pop();return x===0&&(this.sign=!1),this}__initializeDigits(){for(let x=0;x<this.length;x++)this[x]=0}static __decideRounding(x,p,g,y){if(0<p)return-1;let b;if(0>p)b=-p-1;else{if(g===0)return-1;g--,y=x.__digit(g),b=29}let w=1<<b;if((y&w)==0)return-1;if(w-=1,(y&w)!=0)return 1;for(;0<g;)if(g--,x.__digit(g)!==0)return 1;return 0}static __fromDouble(x){u.__kBitConversionDouble[0]=x;const p=2047&u.__kBitConversionInts[1]>>>20,g=p-1023,y=(0|g/30)+1,b=new u(y,0>x);let w=1048575&u.__kBitConversionInts[1]|1048576,v=u.__kBitConversionInts[0];const B=20,j=g%30;let F,C=0;if(20>j){const N=B-j;C=N+32,F=w>>>N,w=w<<32-N|v>>>N,v<<=32-N}else if(j===20)C=32,F=w,w=v,v=0;else{const N=j-B;C=32-N,F=w<<N|v>>>32-N,w=v<<N,v=0}b.__setDigit(y-1,F);for(let N=y-2;0<=N;N--)0<C?(C-=30,F=w>>>2,w=w<<30|v>>>2,v<<=30):F=0,b.__setDigit(N,F);return b.__trim()}static __isWhitespace(x){return 13>=x&&9<=x||(159>=x?x==32:131071>=x?x==160||x==5760:196607>=x?(x&=131071,10>=x||x==40||x==41||x==47||x==95||x==4096):x==65279)}static __fromString(x,p=0){let g=0;const y=x.length;let b=0;if(b===y)return u.__zero();let w=x.charCodeAt(b);for(;u.__isWhitespace(w);){if(++b===y)return u.__zero();w=x.charCodeAt(b)}if(w===43){if(++b===y)return null;w=x.charCodeAt(b),g=1}else if(w===45){if(++b===y)return null;w=x.charCodeAt(b),g=-1}if(p===0){if(p=10,w===48){if(++b===y)return u.__zero();if(w=x.charCodeAt(b),w===88||w===120){if(p=16,++b===y)return null;w=x.charCodeAt(b)}else if(w===79||w===111){if(p=8,++b===y)return null;w=x.charCodeAt(b)}else if(w===66||w===98){if(p=2,++b===y)return null;w=x.charCodeAt(b)}}}else if(p===16&&w===48){if(++b===y)return u.__zero();if(w=x.charCodeAt(b),w===88||w===120){if(++b===y)return null;w=x.charCodeAt(b)}}if(g!=0&&p!==10)return null;for(;w===48;){if(++b===y)return u.__zero();w=x.charCodeAt(b)}const v=y-b;let B=u.__kMaxBitsPerChar[p],j=u.__kBitsPerCharTableMultiplier-1;if(v>1073741824/B)return null;const F=B*v+j>>>u.__kBitsPerCharTableShift,C=new u(0|(F+29)/30,!1),N=10>p?p:10,T=10<p?p-10:0;if((p&p-1)==0){B>>=u.__kBitsPerCharTableShift;const _=[],S=[];let O=!1;do{let $=0,z=0;for(;;){let W;if(w-48>>>0<N)W=w-48;else if((32|w)-97>>>0<T)W=(32|w)-87;else{O=!0;break}if(z+=B,$=$<<B|W,++b===y){O=!0;break}if(w=x.charCodeAt(b),30<z+B)break}_.push($),S.push(z)}while(!O);u.__fillFromParts(C,_,S)}else{C.__initializeDigits();let _=!1,S=0;do{let O=0,$=1;for(;;){let W;if(w-48>>>0<N)W=w-48;else if((32|w)-97>>>0<T)W=(32|w)-87;else{_=!0;break}const U=$*p;if(1073741823<U)break;if($=U,O=O*p+W,S++,++b===y){_=!0;break}w=x.charCodeAt(b)}j=30*u.__kBitsPerCharTableMultiplier-1;const z=0|(B*S+j>>>u.__kBitsPerCharTableShift)/30;C.__inplaceMultiplyAdd($,O,z)}while(!_)}if(b!==y){if(!u.__isWhitespace(w))return null;for(b++;b<y;b++)if(w=x.charCodeAt(b),!u.__isWhitespace(w))return null}return C.sign=g==-1,C.__trim()}static __fillFromParts(x,p,g){let y=0,b=0,w=0;for(let v=p.length-1;0<=v;v--){const B=p[v],j=g[v];b|=B<<w,w+=j,w===30?(x.__setDigit(y++,b),w=0,b=0):30<w&&(x.__setDigit(y++,1073741823&b),w-=30,b=B>>>j-w)}if(b!==0){if(y>=x.length)throw new Error("implementation bug");x.__setDigit(y++,b)}for(;y<x.length;y++)x.__setDigit(y,0)}static __toStringBasePowerOfTwo(x,p){const g=x.length;let y=p-1;y=(85&y>>>1)+(85&y),y=(51&y>>>2)+(51&y),y=(15&y>>>4)+(15&y);const b=y,w=p-1,v=x.__digit(g-1),B=u.__clz30(v);let j=0|(30*g-B+b-1)/b;if(x.sign&&j++,268435456<j)throw new Error("string too long");const F=Array(j);let C=j-1,N=0,T=0;for(let S=0;S<g-1;S++){const O=x.__digit(S),$=(N|O<<T)&w;F[C--]=u.__kConversionChars[$];const z=b-T;for(N=O>>>z,T=30-z;T>=b;)F[C--]=u.__kConversionChars[N&w],N>>>=b,T-=b}const _=(N|v<<T)&w;for(F[C--]=u.__kConversionChars[_],N=v>>>b-T;N!==0;)F[C--]=u.__kConversionChars[N&w],N>>>=b;if(x.sign&&(F[C--]="-"),C!=-1)throw new Error("implementation bug");return F.join("")}static __toStringGeneric(x,p,g){const y=x.length;if(y===0)return"";if(y===1){let S=x.__unsignedDigit(0).toString(p);return g===!1&&x.sign&&(S="-"+S),S}const b=30*y-u.__clz30(x.__digit(y-1)),w=u.__kMaxBitsPerChar[p],v=w-1;let B=b*u.__kBitsPerCharTableMultiplier;B+=v-1,B=0|B/v;const j=B+1>>1,F=u.exponentiate(u.__oneDigit(p,!1),u.__oneDigit(j,!1));let C,N;const T=F.__unsignedDigit(0);if(F.length===1&&32767>=T){C=new u(x.length,!1),C.__initializeDigits();let S=0;for(let O=2*x.length-1;0<=O;O--){const $=S<<15|x.__halfDigit(O);C.__setHalfDigit(O,0|$/T),S=0|$%T}N=S.toString(p)}else{const S=u.__absoluteDivLarge(x,F,!0,!0);C=S.quotient;const O=S.remainder.__trim();N=u.__toStringGeneric(O,p,!0)}C.__trim();let _=u.__toStringGeneric(C,p,!0);for(;N.length<j;)N="0"+N;return g===!1&&x.sign&&(_="-"+_),_+N}static __unequalSign(x){return x?-1:1}static __absoluteGreater(x){return x?-1:1}static __absoluteLess(x){return x?1:-1}static __compareToBigInt(x,p){const g=x.sign;if(g!==p.sign)return u.__unequalSign(g);const y=u.__absoluteCompare(x,p);return 0<y?u.__absoluteGreater(g):0>y?u.__absoluteLess(g):0}static __compareToNumber(x,p){if(u.__isOneDigitInt(p)){const g=x.sign,y=0>p;if(g!==y)return u.__unequalSign(g);if(x.length===0){if(y)throw new Error("implementation bug");return p===0?0:-1}if(1<x.length)return u.__absoluteGreater(g);const b=o(p),w=x.__unsignedDigit(0);return w>b?u.__absoluteGreater(g):w<b?u.__absoluteLess(g):0}return u.__compareToDouble(x,p)}static __compareToDouble(x,p){if(p!==p)return p;if(p===1/0)return-1;if(p===-1/0)return 1;const g=x.sign;if(g!==0>p)return u.__unequalSign(g);if(p===0)throw new Error("implementation bug: should be handled elsewhere");if(x.length===0)return-1;u.__kBitConversionDouble[0]=p;const y=2047&u.__kBitConversionInts[1]>>>20;if(y==2047)throw new Error("implementation bug: handled elsewhere");const b=y-1023;if(0>b)return u.__absoluteGreater(g);const w=x.length;let v=x.__digit(w-1);const B=u.__clz30(v),j=30*w-B,F=b+1;if(j<F)return u.__absoluteLess(g);if(j>F)return u.__absoluteGreater(g);let C=1048576|1048575&u.__kBitConversionInts[1],N=u.__kBitConversionInts[0];const T=20,_=29-B;if(_!==(0|(j-1)%30))throw new Error("implementation bug");let S,O=0;if(20>_){const $=T-_;O=$+32,S=C>>>$,C=C<<32-$|N>>>$,N<<=32-$}else if(_===20)O=32,S=C,C=N,N=0;else{const $=_-T;O=32-$,S=C<<$|N>>>32-$,C=N<<$,N=0}if(v>>>=0,S>>>=0,v>S)return u.__absoluteGreater(g);if(v<S)return u.__absoluteLess(g);for(let $=w-2;0<=$;$--){0<O?(O-=30,S=C>>>2,C=C<<30|N>>>2,N<<=30):S=0;const z=x.__unsignedDigit($);if(z>S)return u.__absoluteGreater(g);if(z<S)return u.__absoluteLess(g)}if(C!==0||N!==0){if(O===0)throw new Error("implementation bug");return u.__absoluteLess(g)}return 0}static __equalToNumber(x,p){return u.__isOneDigitInt(p)?p===0?x.length===0:x.length===1&&x.sign===0>p&&x.__unsignedDigit(0)===o(p):u.__compareToDouble(x,p)===0}static __comparisonResultToBool(x,p){return p===0?0>x:p===1?0>=x:p===2?0<x:p===3?0<=x:void 0}static __compare(x,p,g){if(x=u.__toPrimitive(x),p=u.__toPrimitive(p),typeof x=="string"&&typeof p=="string")switch(g){case 0:return x<p;case 1:return x<=p;case 2:return x>p;case 3:return x>=p}if(u.__isBigInt(x)&&typeof p=="string")return p=u.__fromString(p),p!==null&&u.__comparisonResultToBool(u.__compareToBigInt(x,p),g);if(typeof x=="string"&&u.__isBigInt(p))return x=u.__fromString(x),x!==null&&u.__comparisonResultToBool(u.__compareToBigInt(x,p),g);if(x=u.__toNumeric(x),p=u.__toNumeric(p),u.__isBigInt(x)){if(u.__isBigInt(p))return u.__comparisonResultToBool(u.__compareToBigInt(x,p),g);if(typeof p!="number")throw new Error("implementation bug");return u.__comparisonResultToBool(u.__compareToNumber(x,p),g)}if(typeof x!="number")throw new Error("implementation bug");if(u.__isBigInt(p))return u.__comparisonResultToBool(u.__compareToNumber(p,x),2^g);if(typeof p!="number")throw new Error("implementation bug");return g===0?x<p:g===1?x<=p:g===2?x>p:g===3?x>=p:void 0}__clzmsd(){return u.__clz30(this.__digit(this.length-1))}static __absoluteAdd(x,p,g){if(x.length<p.length)return u.__absoluteAdd(p,x,g);if(x.length===0)return x;if(p.length===0)return x.sign===g?x:u.unaryMinus(x);let y=x.length;(x.__clzmsd()===0||p.length===x.length&&p.__clzmsd()===0)&&y++;const b=new u(y,g);let w=0,v=0;for(;v<p.length;v++){const B=x.__digit(v)+p.__digit(v)+w;w=B>>>30,b.__setDigit(v,1073741823&B)}for(;v<x.length;v++){const B=x.__digit(v)+w;w=B>>>30,b.__setDigit(v,1073741823&B)}return v<b.length&&b.__setDigit(v,w),b.__trim()}static __absoluteSub(x,p,g){if(x.length===0)return x;if(p.length===0)return x.sign===g?x:u.unaryMinus(x);const y=new u(x.length,g);let b=0,w=0;for(;w<p.length;w++){const v=x.__digit(w)-p.__digit(w)-b;b=1&v>>>30,y.__setDigit(w,1073741823&v)}for(;w<x.length;w++){const v=x.__digit(w)-b;b=1&v>>>30,y.__setDigit(w,1073741823&v)}return y.__trim()}static __absoluteAddOne(x,p,g=null){const y=x.length;g===null?g=new u(y,p):g.sign=p;let b=1;for(let w=0;w<y;w++){const v=x.__digit(w)+b;b=v>>>30,g.__setDigit(w,1073741823&v)}return b!=0&&g.__setDigitGrow(y,1),g}static __absoluteSubOne(x,p){const g=x.length;p=p||g;const y=new u(p,!1);let b=1;for(let w=0;w<g;w++){const v=x.__digit(w)-b;b=1&v>>>30,y.__setDigit(w,1073741823&v)}if(b!=0)throw new Error("implementation bug");for(let w=g;w<p;w++)y.__setDigit(w,0);return y}static __absoluteAnd(x,p,g=null){let y=x.length,b=p.length,w=b;if(y<b){w=y;const j=x,F=y;x=p,y=b,p=j,b=F}let v=w;g===null?g=new u(v,!1):v=g.length;let B=0;for(;B<w;B++)g.__setDigit(B,x.__digit(B)&p.__digit(B));for(;B<v;B++)g.__setDigit(B,0);return g}static __absoluteAndNot(x,p,g=null){const y=x.length,b=p.length;let w=b;y<b&&(w=y);let v=y;g===null?g=new u(v,!1):v=g.length;let B=0;for(;B<w;B++)g.__setDigit(B,x.__digit(B)&~p.__digit(B));for(;B<y;B++)g.__setDigit(B,x.__digit(B));for(;B<v;B++)g.__setDigit(B,0);return g}static __absoluteOr(x,p,g=null){let y=x.length,b=p.length,w=b;if(y<b){w=y;const j=x,F=y;x=p,y=b,p=j,b=F}let v=y;g===null?g=new u(v,!1):v=g.length;let B=0;for(;B<w;B++)g.__setDigit(B,x.__digit(B)|p.__digit(B));for(;B<y;B++)g.__setDigit(B,x.__digit(B));for(;B<v;B++)g.__setDigit(B,0);return g}static __absoluteXor(x,p,g=null){let y=x.length,b=p.length,w=b;if(y<b){w=y;const j=x,F=y;x=p,y=b,p=j,b=F}let v=y;g===null?g=new u(v,!1):v=g.length;let B=0;for(;B<w;B++)g.__setDigit(B,x.__digit(B)^p.__digit(B));for(;B<y;B++)g.__setDigit(B,x.__digit(B));for(;B<v;B++)g.__setDigit(B,0);return g}static __absoluteCompare(x,p){const g=x.length-p.length;if(g!=0)return g;let y=x.length-1;for(;0<=y&&x.__digit(y)===p.__digit(y);)y--;return 0>y?0:x.__unsignedDigit(y)>p.__unsignedDigit(y)?1:-1}static __multiplyAccumulate(x,p,g,y){if(p===0)return;const b=32767&p,w=p>>>15;let v=0,B=0;for(let j,F=0;F<x.length;F++,y++){j=g.__digit(y);const C=x.__digit(F),N=32767&C,T=C>>>15,_=u.__imul(N,b),S=u.__imul(N,w),O=u.__imul(T,b),$=u.__imul(T,w);j+=B+_+v,v=j>>>30,j&=1073741823,j+=((32767&S)<<15)+((32767&O)<<15),v+=j>>>30,B=$+(S>>>15)+(O>>>15),g.__setDigit(y,1073741823&j)}for(;v!=0||B!==0;y++){let j=g.__digit(y);j+=v+B,B=0,v=j>>>30,g.__setDigit(y,1073741823&j)}}static __internalMultiplyAdd(x,p,g,y,b){let w=g,v=0;for(let B=0;B<y;B++){const j=x.__digit(B),F=u.__imul(32767&j,p),C=u.__imul(j>>>15,p),N=F+((32767&C)<<15)+v+w;w=N>>>30,v=C>>>15,b.__setDigit(B,1073741823&N)}if(b.length>y)for(b.__setDigit(y++,w+v);y<b.length;)b.__setDigit(y++,0);else if(w+v!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(x,p,g){g>this.length&&(g=this.length);const y=32767&x,b=x>>>15;let w=0,v=p;for(let B=0;B<g;B++){const j=this.__digit(B),F=32767&j,C=j>>>15,N=u.__imul(F,y),T=u.__imul(F,b),_=u.__imul(C,y),S=u.__imul(C,b);let O=v+N+w;w=O>>>30,O&=1073741823,O+=((32767&T)<<15)+((32767&_)<<15),w+=O>>>30,v=S+(T>>>15)+(_>>>15),this.__setDigit(B,1073741823&O)}if(w!=0||v!==0)throw new Error("implementation bug")}static __absoluteDivSmall(x,p,g=null){g===null&&(g=new u(x.length,!1));let y=0;for(let b,w=2*x.length-1;0<=w;w-=2){b=(y<<15|x.__halfDigit(w))>>>0;const v=0|b/p;y=0|b%p,b=(y<<15|x.__halfDigit(w-1))>>>0;const B=0|b/p;y=0|b%p,g.__setDigit(w>>>1,v<<15|B)}return g}static __absoluteModSmall(x,p){let g=0;for(let y=2*x.length-1;0<=y;y--)g=0|((g<<15|x.__halfDigit(y))>>>0)%p;return g}static __absoluteDivLarge(x,p,g,y){const b=p.__halfDigitLength(),w=p.length,v=x.__halfDigitLength()-b;let B=null;g&&(B=new u(v+2>>>1,!1),B.__initializeDigits());const j=new u(b+2>>>1,!1);j.__initializeDigits();const F=u.__clz15(p.__halfDigit(b-1));0<F&&(p=u.__specialLeftShift(p,F,0));const C=u.__specialLeftShift(x,F,1),N=p.__halfDigit(b-1);let T=0;for(let _,S=v;0<=S;S--){_=32767;const O=C.__halfDigit(S+b);if(O!==N){const z=(O<<15|C.__halfDigit(S+b-1))>>>0;_=0|z/N;let W=0|z%N;const U=p.__halfDigit(b-2),I=C.__halfDigit(S+b-2);for(;u.__imul(_,U)>>>0>(W<<16|I)>>>0&&(_--,W+=N,!(32767<W)););}u.__internalMultiplyAdd(p,_,0,w,j);let $=C.__inplaceSub(j,S,b+1);$!==0&&($=C.__inplaceAdd(p,S,b),C.__setHalfDigit(S+b,32767&C.__halfDigit(S+b)+$),_--),g&&(1&S?T=_<<15:B.__setDigit(S>>>1,T|_))}if(y)return C.__inplaceRightShift(F),g?{quotient:B,remainder:C}:C;if(g)return B;throw new Error("unreachable")}static __clz15(x){return u.__clz30(x)-15}__inplaceAdd(x,p,g){let y=0;for(let b=0;b<g;b++){const w=this.__halfDigit(p+b)+x.__halfDigit(b)+y;y=w>>>15,this.__setHalfDigit(p+b,32767&w)}return y}__inplaceSub(x,p,g){let y=0;if(1&p){p>>=1;let b=this.__digit(p),w=32767&b,v=0;for(;v<g-1>>>1;v++){const F=x.__digit(v),C=(b>>>15)-(32767&F)-y;y=1&C>>>15,this.__setDigit(p+v,(32767&C)<<15|32767&w),b=this.__digit(p+v+1),w=(32767&b)-(F>>>15)-y,y=1&w>>>15}const B=x.__digit(v),j=(b>>>15)-(32767&B)-y;if(y=1&j>>>15,this.__setDigit(p+v,(32767&j)<<15|32767&w),p+v+1>=this.length)throw new RangeError("out of bounds");(1&g)==0&&(b=this.__digit(p+v+1),w=(32767&b)-(B>>>15)-y,y=1&w>>>15,this.__setDigit(p+x.length,1073709056&b|32767&w))}else{p>>=1;let b=0;for(;b<x.length-1;b++){const F=this.__digit(p+b),C=x.__digit(b),N=(32767&F)-(32767&C)-y;y=1&N>>>15;const T=(F>>>15)-(C>>>15)-y;y=1&T>>>15,this.__setDigit(p+b,(32767&T)<<15|32767&N)}const w=this.__digit(p+b),v=x.__digit(b),B=(32767&w)-(32767&v)-y;y=1&B>>>15;let j=0;(1&g)==0&&(j=(w>>>15)-(v>>>15)-y,y=1&j>>>15),this.__setDigit(p+b,(32767&j)<<15|32767&B)}return y}__inplaceRightShift(x){if(x===0)return;let p=this.__digit(0)>>>x;const g=this.length-1;for(let y=0;y<g;y++){const b=this.__digit(y+1);this.__setDigit(y,1073741823&b<<30-x|p),p=b>>>x}this.__setDigit(g,p)}static __specialLeftShift(x,p,g){const y=x.length,b=new u(y+g,!1);if(p===0){for(let v=0;v<y;v++)b.__setDigit(v,x.__digit(v));return 0<g&&b.__setDigit(y,0),b}let w=0;for(let v=0;v<y;v++){const B=x.__digit(v);b.__setDigit(v,1073741823&B<<p|w),w=B>>>30-p}return 0<g&&b.__setDigit(y,w),b}static __leftShiftByAbsolute(x,p){const g=u.__toShiftAmount(p);if(0>g)throw new RangeError("BigInt too big");const y=0|g/30,b=g%30,w=x.length,v=b!==0&&x.__digit(w-1)>>>30-b!=0,B=w+y+(v?1:0),j=new u(B,x.sign);if(b===0){let F=0;for(;F<y;F++)j.__setDigit(F,0);for(;F<B;F++)j.__setDigit(F,x.__digit(F-y))}else{let F=0;for(let C=0;C<y;C++)j.__setDigit(C,0);for(let C=0;C<w;C++){const N=x.__digit(C);j.__setDigit(C+y,1073741823&N<<b|F),F=N>>>30-b}if(v)j.__setDigit(w+y,F);else if(F!==0)throw new Error("implementation bug")}return j.__trim()}static __rightShiftByAbsolute(x,p){const g=x.length,y=x.sign,b=u.__toShiftAmount(p);if(0>b)return u.__rightShiftByMaximum(y);const w=0|b/30,v=b%30;let B=g-w;if(0>=B)return u.__rightShiftByMaximum(y);let j=!1;if(y){if((x.__digit(w)&(1<<v)-1)!=0)j=!0;else for(let C=0;C<w;C++)if(x.__digit(C)!==0){j=!0;break}}j&&v===0&&~x.__digit(g-1)==0&&B++;let F=new u(B,y);if(v===0){F.__setDigit(B-1,0);for(let C=w;C<g;C++)F.__setDigit(C-w,x.__digit(C))}else{let C=x.__digit(w)>>>v;const N=g-w-1;for(let T=0;T<N;T++){const _=x.__digit(T+w+1);F.__setDigit(T,1073741823&_<<30-v|C),C=_>>>v}F.__setDigit(N,C)}return j&&(F=u.__absoluteAddOne(F,!0,F)),F.__trim()}static __rightShiftByMaximum(x){return x?u.__oneDigit(1,!0):u.__zero()}static __toShiftAmount(x){if(1<x.length)return-1;const p=x.__unsignedDigit(0);return p>u.__kMaxLengthBits?-1:p}static __toPrimitive(x,p="default"){if(typeof x!="object"||x.constructor===u)return x;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const b=x[Symbol.toPrimitive];if(b){const w=b(p);if(typeof w!="object")return w;throw new TypeError("Cannot convert object to primitive value")}}const g=x.valueOf;if(g){const b=g.call(x);if(typeof b!="object")return b}const y=x.toString;if(y){const b=y.call(x);if(typeof b!="object")return b}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(x){return u.__isBigInt(x)?x:+x}static __isBigInt(x){return typeof x=="object"&&x!==null&&x.constructor===u}static __truncateToNBits(x,p){const g=0|(x+29)/30,y=new u(g,p.sign),b=g-1;for(let v=0;v<b;v++)y.__setDigit(v,p.__digit(v));let w=p.__digit(b);if(x%30!=0){const v=32-x%30;w=w<<v>>>v}return y.__setDigit(b,w),y.__trim()}static __truncateAndSubFromPowerOfTwo(x,p,g){var y=Math.min;const b=0|(x+29)/30,w=new u(b,g);let v=0;const B=b-1;let j=0;for(const T=y(B,p.length);v<T;v++){const _=0-p.__digit(v)-j;j=1&_>>>30,w.__setDigit(v,1073741823&_)}for(;v<B;v++)w.__setDigit(v,0|1073741823&-j);let F=B<p.length?p.__digit(B):0;const C=x%30;let N;if(C==0)N=0-F-j,N&=1073741823;else{const T=32-C;F=F<<T>>>T;const _=1<<32-T;N=_-F-j,N&=_-1}return w.__setDigit(B,N),w.__trim()}__digit(x){return this[x]}__unsignedDigit(x){return this[x]>>>0}__setDigit(x,p){this[x]=0|p}__setDigitGrow(x,p){this[x]=0|p}__halfDigitLength(){const x=this.length;return 32767>=this.__unsignedDigit(x-1)?2*x-1:2*x}__halfDigit(x){return 32767&this[x>>>1]>>>15*(1&x)}__setHalfDigit(x,p){const g=x>>>1,y=this.__digit(g),b=1&x?32767&y|p<<15:1073709056&y|32767&p;this.__setDigit(g,b)}static __digitPow(x,p){let g=1;for(;0<p;)1&p&&(g*=x),p>>>=1,x*=x;return g}static __isOneDigitInt(x){return(1073741823&x)===x}}return u.__kMaxLength=33554432,u.__kMaxLengthBits=u.__kMaxLength<<5,u.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],u.__kBitsPerCharTableShift=5,u.__kBitsPerCharTableMultiplier=1<<u.__kBitsPerCharTableShift,u.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],u.__kBitConversionBuffer=new ArrayBuffer(8),u.__kBitConversionDouble=new Float64Array(u.__kBitConversionBuffer),u.__kBitConversionInts=new Int32Array(u.__kBitConversionBuffer),u.__clz30=n?function(f){return n(f)-2}:function(f){var x=Math.LN2,p=Math.log;return f===0?30:0|29-(0|p(f>>>0)/x)},u.__imul=r||function(f,x){return 0|f*x},u})})(jsbiUmd$1)),jsbiUmd$1.exports}var hasRequiredXoshiro;function requireXoshiro(){if(hasRequiredXoshiro)return xoshiro;hasRequiredXoshiro=1;var e=xoshiro&&xoshiro.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(xoshiro,"__esModule",{value:!0});const t=requireUtils$7(),r=e(requireBignumber()),n=e(requireJsbiUmd()),o=18446744073709552e3,a=(u,f)=>n.default.bitwiseXor(n.default.asUintN(64,n.default.leftShift(u,n.default.BigInt(f))),n.default.BigInt(n.default.asUintN(64,n.default.signedRightShift(u,n.default.subtract(n.default.BigInt(64),n.default.BigInt(f))))));class l{constructor(f){this.next=()=>new r.default(this.roll().toString()),this.nextDouble=()=>new r.default(this.roll().toString()).div(o+1),this.nextInt=(p,g)=>Math.floor(this.nextDouble().toNumber()*(g-p+1)+p),this.nextByte=()=>this.nextInt(0,255),this.nextData=p=>[...new Array(p)].map(()=>this.nextByte());const x=t.sha256Hash(f);this.s=[n.default.BigInt(0),n.default.BigInt(0),n.default.BigInt(0),n.default.BigInt(0)],this.setS(x)}setS(f){for(let x=0;x<4;x++){let p=x*8,g=n.default.BigInt(0);for(let y=0;y<8;y++)g=n.default.asUintN(64,n.default.leftShift(g,n.default.BigInt(8))),g=n.default.asUintN(64,n.default.bitwiseOr(g,n.default.BigInt(f[p+y])));this.s[x]=n.default.asUintN(64,g)}}roll(){const f=n.default.asUintN(64,n.default.multiply(a(n.default.asUintN(64,n.default.multiply(this.s[1],n.default.BigInt(5))),7),n.default.BigInt(9))),x=n.default.asUintN(64,n.default.leftShift(this.s[1],n.default.BigInt(17)));return this.s[2]=n.default.asUintN(64,n.default.bitwiseXor(this.s[2],n.default.BigInt(this.s[0]))),this.s[3]=n.default.asUintN(64,n.default.bitwiseXor(this.s[3],n.default.BigInt(this.s[1]))),this.s[1]=n.default.asUintN(64,n.default.bitwiseXor(this.s[1],n.default.BigInt(this.s[2]))),this.s[0]=n.default.asUintN(64,n.default.bitwiseXor(this.s[0],n.default.BigInt(this.s[3]))),this.s[2]=n.default.asUintN(64,n.default.bitwiseXor(this.s[2],n.default.BigInt(x))),this.s[3]=n.default.asUintN(64,a(this.s[3],45)),f}}return xoshiro.default=l,xoshiro}var precomputeAlias=function(e,t){var r=e.reduce(function(p,g){if(g<0)throw new Error("Probability must be a positive: p["+e.indexOf(g)+"]="+g);return p+g},0);if(r===0)throw new Error("Probability sum must be greater than zero.");for(var n=e.map(function(p){return p*t/r}),o={prob:new Array(t),alias:new Array(t)},a=[],l=[],u=t-1;u>=0;u--)n[u]<1?a.push(u):l.push(u);for(;a.length>0&&l.length>0;){var f=a.pop(),x=l.pop();o.prob[f]=n[f],o.alias[f]=x,n[x]=n[x]+n[f]-1,n[x]<1?a.push(x):l.push(x)}for(;l.length>0;)o.prob[l.pop()]=1;for(;a.length>0;)o.prob[a.pop()]=1;return o},draw=function(e,t,r){var n=Math.floor(r()*e.prob.length);return t[r()<e.prob[n]?n:e.alias[n]]},next=function(e,t,r,n){if(n===void 0&&(n=1),n===1)return draw(e,t,r);for(var o=[],a=0;a<n;a++)o.push(draw(e,t,r));return o},sample=function(e,t,r){if(r===void 0&&(r=Math.random),!Array.isArray(e))throw new Error("Probabilities must be an array.");if(e.length===0)throw new Error("Probabilities array must not be empty.");var n=e.length,o=t??Array.from({length:n},function(l,u){return u}),a=precomputeAlias(e,n);return{next:function(l){return l===void 0&&(l=1),next(a,o,r,l)}}};const esm=Object.freeze(Object.defineProperty({__proto__:null,default:sample},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(esm);var hasRequiredFountainUtils;function requireFountainUtils(){return hasRequiredFountainUtils||(hasRequiredFountainUtils=1,(function(e){var t=fountainUtils&&fountainUtils.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(e,"__esModule",{value:!0}),e.chooseFragments=e.shuffle=e.chooseDegree=void 0;const r=requireUtils$7(),n=t(requireXoshiro()),o=t(require$$2),a=(f,x)=>{const p=[...new Array(f)].map((y,b)=>1/(b+1));return o.default(p,void 0,x.nextDouble).next()+1};e.chooseDegree=a;const l=(f,x)=>{let p=[...f],g=[];for(;p.length>0;){let y=x.nextInt(0,p.length-1),b=p[y];p.splice(y,1),g.push(b)}return g};e.shuffle=l;const u=(f,x,p)=>{if(f<=x)return[f-1];{const g=Buffer.concat([r.intToBytes(f),r.intToBytes(p)]),y=new n.default(g),b=e.chooseDegree(x,y),w=[...new Array(x)].map((B,j)=>j);return e.shuffle(w,y).slice(0,b)}};e.chooseFragments=u})(fountainUtils)),fountainUtils}var hasRequiredFountainEncoder;function requireFountainEncoder(){if(hasRequiredFountainEncoder)return fountainEncoder;hasRequiredFountainEncoder=1;var e=fountainEncoder&&fountainEncoder.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(fountainEncoder,"__esModule",{value:!0}),fountainEncoder.FountainEncoderPart=void 0;const t=e(requireAssert()),r=requireUtils$7(),n=requireFountainUtils(),o=requireCbor();class a{constructor(f,x,p,g,y){this._seqNum=f,this._seqLength=x,this._messageLength=p,this._checksum=g,this._fragment=y}get messageLength(){return this._messageLength}get fragment(){return this._fragment}get seqNum(){return this._seqNum}get seqLength(){return this._seqLength}get checksum(){return this._checksum}cbor(){const f=o.cborEncode([this._seqNum,this._seqLength,this._messageLength,this._checksum,this._fragment]);return Buffer.from(f)}description(){return`seqNum:${this._seqNum}, seqLen:${this._seqLength}, messageLen:${this._messageLength}, checksum:${this._checksum}, data:${this._fragment.toString("hex")}`}static fromCBOR(f){const[x,p,g,y,b]=o.cborDecode(f);return t.default(typeof x=="number"),t.default(typeof p=="number"),t.default(typeof g=="number"),t.default(typeof y=="number"),t.default(Buffer.isBuffer(b)&&b.length>0),new a(x,p,g,y,Buffer.from(b))}}fountainEncoder.FountainEncoderPart=a;class l{constructor(f,x=100,p=0,g=10){const y=l.findNominalFragmentLength(f.length,g,x);this._messageLength=f.length,this._fragments=l.partitionMessage(f,y),this.fragmentLength=y,this.seqNum=r.toUint32(p),this.checksum=r.getCRC(f)}get fragmentsLength(){return this._fragments.length}get fragments(){return this._fragments}get messageLength(){return this._messageLength}isComplete(){return this.seqNum>=this._fragments.length}isSinglePart(){return this._fragments.length===1}seqLength(){return this._fragments.length}mix(f){return f.reduce((x,p)=>r.bufferXOR(this._fragments[p],x),Buffer.alloc(this.fragmentLength,0))}nextPart(){this.seqNum=r.toUint32(this.seqNum+1);const f=n.chooseFragments(this.seqNum,this._fragments.length,this.checksum),x=this.mix(f);return new a(this.seqNum,this._fragments.length,this._messageLength,this.checksum,x)}static findNominalFragmentLength(f,x,p){t.default(f>0),t.default(x>0),t.default(p>=x);const g=Math.ceil(f/x);let y=0;for(let b=1;b<=g&&(y=Math.ceil(f/b),!(y<=p));b++);return y}static partitionMessage(f,x){let p=Buffer.from(f),g,y=[];for(;p.length>0;)[g,p]=r.split(p,-x),g=Buffer.alloc(x,0).fill(g,0,g.length),y.push(g);return y}}return fountainEncoder.default=l,fountainEncoder}var bytewords={},hasRequiredBytewords;function requireBytewords(){if(hasRequiredBytewords)return bytewords;hasRequiredBytewords=1;var e=bytewords&&bytewords.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(bytewords,"__esModule",{value:!0});const t=e(requireAssert()),r=requireUtils$7(),n="ableacidalsoapexaquaarchatomauntawayaxisbackbaldbarnbeltbetabiasbluebodybragbrewbulbbuzzcalmcashcatschefcityclawcodecolacookcostcruxcurlcuspcyandarkdatadaysdelidicedietdoordowndrawdropdrumdulldutyeacheasyechoedgeepicevenexamexiteyesfactfairfernfigsfilmfishfizzflapflewfluxfoxyfreefrogfuelfundgalagamegeargemsgiftgirlglowgoodgraygrimgurugushgyrohalfhanghardhawkheathelphighhillholyhopehornhutsicedideaidleinchinkyintoirisironitemjadejazzjoinjoltjowljudojugsjumpjunkjurykeepkenokeptkeyskickkilnkingkitekiwiknoblamblavalazyleaflegsliarlimplionlistlogoloudloveluaulucklungmainmanymathmazememomenumeowmildmintmissmonknailnavyneednewsnextnoonnotenumbobeyoboeomitonyxopenovalowlspaidpartpeckplaypluspoempoolposepuffpumapurrquadquizraceramprealredorichroadrockroofrubyruinrunsrustsafesagascarsetssilkskewslotsoapsolosongstubsurfswantacotasktaxitenttiedtimetinytoiltombtoystriptunatwinuglyundouniturgeuservastveryvetovialvibeviewvisavoidvowswallwandwarmwaspwavewaxywebswhatwhenwhizwolfworkyankyawnyellyogayurtzapszerozestzinczonezoom";let o=[];const a=256,l=4,u=2;var f;(function(F){F.STANDARD="standard",F.URI="uri",F.MINIMAL="minimal"})(f||(f={}));const x=F=>n.slice(F*l,F*l+l),p=F=>{const C=x(F);return`${C[0]}${C[l-1]}`},g=F=>{const C=r.getCRCHex(Buffer.from(F,"hex"));return`${F}${C}`},y=(F,C)=>{const N=g(F);return Buffer.from(N,"hex").reduce((S,O)=>[...S,x(O)],[]).join(C)},b=F=>{const C=g(F);return Buffer.from(C,"hex").reduce((_,S)=>_+p(S),"")},w=(F,C)=>{t.default(F.length===C,"Invalid Bytewords: word.length does not match wordLength provided");const N=26;if(o.length===0){const $=N*N;o=[...new Array($)].map(()=>-1);for(let z=0;z<a;z++){const W=x(z);let U=W[0].charCodeAt(0)-97,G=(W[3].charCodeAt(0)-97)*N+U;o[G]=z}}let T=F[0].toLowerCase().charCodeAt(0)-97,_=F[C==4?3:1].toLowerCase().charCodeAt(0)-97;t.default(0<=T&&T<N&&0<=_&&_<N,"Invalid Bytewords: invalid word");let S=_*N+T,O=o[S];if(t.default(O!==-1,"Invalid Bytewords: value not in lookup table"),C==l){const $=x(O);let z=F[1].toLowerCase(),W=F[2].toLowerCase();t.default(z===$[1]&&W===$[2],"Invalid Bytewords: invalid middle letters of word")}return Buffer.from([O]).toString("hex")},v=(F,C,N)=>{const _=(N==l?F.split(C):r.partition(F,2)).map(z=>w(z,N)).join("");t.default(_.length>=5,"Invalid Bytewords: invalid decoded string length");const[S,O]=r.split(Buffer.from(_,"hex"),4),$=r.getCRCHex(S);return t.default($===O.toString("hex"),"Invalid Checksum"),S.toString("hex")},B=(F,C=f.MINIMAL)=>{switch(C){case f.STANDARD:return v(F," ",l);case f.URI:return v(F,"-",l);case f.MINIMAL:return v(F,"",u);default:throw new Error(`Invalid style ${C}`)}},j=(F,C=f.MINIMAL)=>{switch(C){case f.STANDARD:return y(F," ");case f.URI:return y(F,"-");case f.MINIMAL:return b(F);default:throw new Error(`Invalid style ${C}`)}};return bytewords.default={decode:B,encode:j,STYLES:f},bytewords}var hasRequiredUrEncoder;function requireUrEncoder(){if(hasRequiredUrEncoder)return urEncoder;hasRequiredUrEncoder=1;var e=urEncoder&&urEncoder.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(urEncoder,"__esModule",{value:!0});const t=e(requireFountainEncoder()),r=e(requireBytewords());class n{constructor(a,l,u,f){this.ur=a,this.fountainEncoder=new t.default(a.cbor,l,u,f)}get fragmentsLength(){return this.fountainEncoder.fragmentsLength}get fragments(){return this.fountainEncoder.fragments}get messageLength(){return this.fountainEncoder.messageLength}get cbor(){return this.ur.cbor}encodeWhole(){return[...new Array(this.fragmentsLength)].map(()=>this.nextPart())}nextPart(){const a=this.fountainEncoder.nextPart();return this.fountainEncoder.isSinglePart()?n.encodeSinglePart(this.ur):n.encodePart(this.ur.type,a)}static encodeUri(a,l){const u=l.join("/");return[a,u].join(":")}static encodeUR(a){return n.encodeUri("ur",a)}static encodePart(a,l){const u=`${l.seqNum}-${l.seqLength}`,f=r.default.encode(l.cbor().toString("hex"),r.default.STYLES.MINIMAL);return n.encodeUR([a,u,f])}static encodeSinglePart(a){const l=r.default.encode(a.cbor.toString("hex"),r.default.STYLES.MINIMAL);return n.encodeUR([a.type,l])}}return urEncoder.default=n,urEncoder}var urDecoder={},fountainDecoder={},hasRequiredFountainDecoder;function requireFountainDecoder(){if(hasRequiredFountainDecoder)return fountainDecoder;hasRequiredFountainDecoder=1,Object.defineProperty(fountainDecoder,"__esModule",{value:!0}),fountainDecoder.FountainDecoderPart=void 0;const e=requireUtils$7(),t=requireFountainUtils(),r=requireErrors$1();class n{constructor(l,u){this._indexes=l,this._fragment=u}get indexes(){return this._indexes}get fragment(){return this._fragment}static fromEncoderPart(l){const u=t.chooseFragments(l.seqNum,l.seqLength,l.checksum),f=l.fragment;return new n(u,f)}isSimple(){return this.indexes.length===1}}fountainDecoder.FountainDecoderPart=n;class o{constructor(){this.result=void 0,this.expectedMessageLength=0,this.expectedChecksum=0,this.expectedFragmentLength=0,this.processedPartsCount=0,this.expectedPartIndexes=[],this.lastPartIndexes=[],this.queuedParts=[],this.receivedPartIndexes=[],this.mixedParts=[],this.simpleParts=[]}validatePart(l){if(this.expectedPartIndexes.length===0)[...new Array(l.seqLength)].forEach((u,f)=>this.expectedPartIndexes.push(f)),this.expectedMessageLength=l.messageLength,this.expectedChecksum=l.checksum,this.expectedFragmentLength=l.fragment.length;else if(this.expectedPartIndexes.length!==l.seqLength||this.expectedMessageLength!==l.messageLength||this.expectedChecksum!==l.checksum||this.expectedFragmentLength!==l.fragment.length)return!1;return!0}reducePartByPart(l,u){if(e.arrayContains(l.indexes,u.indexes)){const f=e.setDifference(l.indexes,u.indexes),x=e.bufferXOR(l.fragment,u.fragment);return new n(f,x)}else return l}reduceMixedBy(l){const u=[];this.mixedParts.map(({value:f})=>this.reducePartByPart(f,l)).forEach(f=>{f.isSimple()?this.queuedParts.push(f):u.push({key:f.indexes,value:f})}),this.mixedParts=u}processSimplePart(l){const u=l.indexes[0];if(!this.receivedPartIndexes.includes(u))if(this.simpleParts.push({key:l.indexes,value:l}),this.receivedPartIndexes.push(u),e.arraysEqual(this.receivedPartIndexes,this.expectedPartIndexes)){const f=this.simpleParts.map(({value:g})=>g).sort((g,y)=>g.indexes[0]-y.indexes[0]),x=o.joinFragments(f.map(g=>g.fragment),this.expectedMessageLength);e.getCRC(x)===this.expectedChecksum?this.result=x:this.error=new r.InvalidChecksumError}else this.reduceMixedBy(l)}processMixedPart(l){if(this.mixedParts.some(({key:f})=>e.arraysEqual(f,l.indexes)))return;let u=this.simpleParts.reduce((f,{value:x})=>this.reducePartByPart(f,x),l);u=this.mixedParts.reduce((f,{value:x})=>this.reducePartByPart(f,x),u),u.isSimple()?this.queuedParts.push(u):(this.reduceMixedBy(u),this.mixedParts.push({key:u.indexes,value:u}))}processQueuedItem(){if(this.queuedParts.length===0)return;const l=this.queuedParts.shift();l.isSimple()?this.processSimplePart(l):this.processMixedPart(l)}receivePart(l){if(this.isComplete()||!this.validatePart(l))return!1;const u=n.fromEncoderPart(l);for(this.lastPartIndexes=u.indexes,this.queuedParts.push(u);!this.isComplete()&&this.queuedParts.length>0;)this.processQueuedItem();return this.processedPartsCount+=1,!0}isComplete(){return this.result!==void 0&&this.result.length>0}isSuccess(){return!!(this.error===void 0&&this.isComplete())}resultMessage(){return this.isSuccess()?this.result:Buffer.from([])}isFailure(){return this.error!==void 0}resultError(){return this.error?this.error.message:""}expectedPartCount(){return this.expectedPartIndexes.length}getExpectedPartIndexes(){return[...this.expectedPartIndexes]}getReceivedPartIndexes(){return[...this.receivedPartIndexes]}getLastPartIndexes(){return[...this.lastPartIndexes]}estimatedPercentComplete(){if(this.isComplete())return 1;const l=this.expectedPartCount();return l===0?0:Math.min(.99,this.processedPartsCount/(l*1.75))}getProgress(){if(this.isComplete())return 1;const l=this.expectedPartCount();return l===0?0:this.receivedPartIndexes.length/l}}return fountainDecoder.default=o,o.joinFragments=(a,l)=>Buffer.concat(a).slice(0,l),fountainDecoder}var hasRequiredUrDecoder;function requireUrDecoder(){if(hasRequiredUrDecoder)return urDecoder;hasRequiredUrDecoder=1;var e=urDecoder&&urDecoder.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(urDecoder,"__esModule",{value:!0});const t=e(requireFountainDecoder()),r=e(requireBytewords()),n=e(requireAssert()),o=requireUtils$7(),a=requireErrors$1(),l=e(requireUr()),u=requireFountainEncoder();class f{constructor(p=new t.default,g="bytes"){this.fountainDecoder=p,this.type=g,n.default(o.isURType(g),"Invalid UR type"),this.expected_type=""}static decodeBody(p,g){const y=r.default.decode(g,r.default.STYLES.MINIMAL);return new l.default(Buffer.from(y,"hex"),p)}validatePart(p){return this.expected_type?this.expected_type===p:o.isURType(p)?(this.expected_type=p,!0):!1}static decode(p){const[g,y]=this.parse(p);if(y.length===0)throw new a.InvalidPathLengthError;const b=y[0];return f.decodeBody(g,b)}static parse(p){const g=p.toLowerCase();if(g.slice(0,3)!=="ur:")throw new a.InvalidSchemeError;const b=g.slice(3).split("/"),w=b[0];if(b.length<2)throw new a.InvalidPathLengthError;if(!o.isURType(w))throw new a.InvalidTypeError;return[w,b.slice(1)]}static parseSequenceComponent(p){const g=p.split("-");if(g.length!==2)throw new a.InvalidSequenceComponentError;const y=o.toUint32(Number(g[0])),b=Number(g[1]);if(y<1||b<1)throw new a.InvalidSequenceComponentError;return[y,b]}receivePart(p){if(this.result!==void 0)return!1;const[g,y]=f.parse(p);if(!this.validatePart(g))return!1;if(y.length===1)return this.result=f.decodeBody(g,y[0]),!0;if(y.length!==2)throw new a.InvalidPathLengthError;const[b,w]=y,[v,B]=f.parseSequenceComponent(b),j=r.default.decode(w,r.default.STYLES.MINIMAL),F=u.FountainEncoderPart.fromCBOR(j);return v!==F.seqNum||B!==F.seqLength||!this.fountainDecoder.receivePart(F)?!1:(this.fountainDecoder.isSuccess()?this.result=new l.default(this.fountainDecoder.resultMessage(),g):this.fountainDecoder.isFailure()&&(this.error=new a.InvalidSchemeError),!0)}resultUR(){return this.result?this.result:new l.default(Buffer.from([]))}isComplete(){return this.result&&this.result.cbor.length>0}isSuccess(){return!this.error&&this.isComplete()}isError(){return this.error!==void 0}resultError(){return this.error?this.error.message:""}expectedPartCount(){return this.fountainDecoder.expectedPartCount()}expectedPartIndexes(){return this.fountainDecoder.getExpectedPartIndexes()}receivedPartIndexes(){return this.fountainDecoder.getReceivedPartIndexes()}lastPartIndexes(){return this.fountainDecoder.getLastPartIndexes()}estimatedPercentComplete(){return this.fountainDecoder.estimatedPercentComplete()}getProgress(){return this.fountainDecoder.getProgress()}}return urDecoder.default=f,urDecoder}var hasRequiredDist$3;function requireDist$3(){if(hasRequiredDist$3)return dist$4;hasRequiredDist$3=1;var e=dist$4&&dist$4.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(dist$4,"__esModule",{value:!0}),dist$4.URDecoder=dist$4.UREncoder=dist$4.UR=void 0;const t=e(requireUr());dist$4.UR=t.default;const r=e(requireUrEncoder());dist$4.UREncoder=r.default;const n=e(requireUrDecoder());return dist$4.URDecoder=n.default,dist$4}var distExports$3=requireDist$3();const AnimatedQRCode=({data:e,type:t="bytes"})=>{const[r,n]=reactExports.useState(""),o=reactExports.useRef(null),a=l=>{const u=l.length;let f;if(u<24)f=Buffer$1.from([64|u]);else if(u<256)f=Buffer$1.from([88,u]);else if(u<65536){const x=Buffer$1.alloc(3);x[0]=89,x.writeUInt16BE(u,1),f=x}else{const x=Buffer$1.alloc(5);x[0]=90,x.writeUInt32BE(u,1),f=x}return Buffer$1.concat([f,l])};return reactExports.useEffect(()=>{const l=Buffer$1.from(e),u=a(l),f=new distExports$3.UREncoder(new distExports$3.UR(u,t),200);o.current=f;const x=setInterval(()=>{o.current&&n(o.current.nextPart())},100);return()=>clearInterval(x)},[e,t]),r?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx("div",{className:"bg-white p-4 rounded-xl",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:r,size:256,level:"L"})}),jsxRuntimeExports.jsx("div",{className:"mt-4 text-center space-y-1",children:(()=>{const l=r.split("/");return l.length>2&&l[1].includes("-")?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"animate-pulse w-2 h-2 rounded-full bg-amber-500"}),jsxRuntimeExports.jsx("p",{className:"text-amber-500 text-xs font-bold uppercase tracking-wider",children:"ANIMATED (FOUNTAIN) QR"})]}):null})()})]}):null},useRequestStore=create(e=>({requests:[],addRequest:t=>e(r=>r.requests.some(n=>n.id===t.id)?r:{requests:[...r.requests,t]}),removeRequest:t=>e(r=>({requests:r.requests.filter(n=>n.id!==t)})),clearRequests:()=>e({requests:[]})}));var lib$1={},types={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0})),types}var ee={},taskCollection$1={},taskCollection={},utils$6={},hasRequiredUtils$6;function requireUtils$6(){if(hasRequiredUtils$6)return utils$6;hasRequiredUtils$6=1,Object.defineProperty(utils$6,"__esModule",{value:!0}),utils$6._fast_remove_single=void 0;function e(t,r){r!==-1&&(r===0?t.shift():r===t.length-1?t.length=t.length-1:t.splice(r,1))}return utils$6._fast_remove_single=e,utils$6}var bakeCollection={},hasRequiredBakeCollection;function requireBakeCollection(){return hasRequiredBakeCollection||(hasRequiredBakeCollection=1,(function(exports$1){Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.bakeCollectionVariadic=exports$1.bakeCollectionAwait=exports$1.bakeCollection=exports$1.BAKED_EMPTY_FUNC=void 0,exports$1.BAKED_EMPTY_FUNC=(function(){});var FORLOOP_FALLBACK=1500;function generateArgsDefCode(e){var t="";if(e===0)return t;for(var r=0;r<e-1;++r)t+="arg"+String(r)+", ";return t+="arg"+String(e-1),t}function generateBodyPartsCode(e,t){for(var r="",n="",o=0;o<t;++o)r+="var f".concat(o," = collection[").concat(o,`];
`),n+="f".concat(o,"(").concat(e,`)
`);return{funcDefCode:r,funcCallCode:n}}function generateBodyPartsVariadicCode(e){for(var t="",r="",n=0;n<e;++n)t+="var f".concat(n," = collection[").concat(n,`];
`),r+="f".concat(n,`.apply(undefined, arguments)
`);return{funcDefCode:t,funcCallCode:r}}function bakeCollection(collection,fixedArgsNum){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                `).concat(funcCallCode,`
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);collection.length%10===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 10) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                        collection[i+4](`).concat(argsDefCode,`);
                        collection[i+5](`).concat(argsDefCode,`);
                        collection[i+6](`).concat(argsDefCode,`);
                        collection[i+7](`).concat(argsDefCode,`);
                        collection[i+8](`).concat(argsDefCode,`);
                        collection[i+9](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%4===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 4) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%3===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 3) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                    }
                });
            })`):funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; ++i) {
                        collection[i](`).concat(argsDefCode,`);
                    }
                });
            })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollection=bakeCollection;function bakeCollectionAwait(collection,fixedArgsNum){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                return Promise.all([ `).concat(funcCallCode,` ]);
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=`(function(collection) {
            return (function(`.concat(argsDefCode,`) {
                var promises = Array(collection.length);
                for (var i = 0; i < collection.length; ++i) {
                    promises[i] = collection[i](`).concat(argsDefCode,`);
                }
                return Promise.all(promises);
            });
        })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollectionAwait=bakeCollectionAwait;function bakeCollectionVariadic(collection){if(collection.length===0)return exports$1.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function() {
                `).concat(funcCallCode,`
            });
        })`)}else funcFactoryCode=`(function(collection) {
            return (function() {
                for (var i = 0; i < collection.length; ++i) {
                    collection[i].apply(undefined, arguments);
                }
            });
        })`;{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports$1.bakeCollectionVariadic=bakeCollectionVariadic})(bakeCollection)),bakeCollection}var hasRequiredTaskCollection$1;function requireTaskCollection$1(){if(hasRequiredTaskCollection$1)return taskCollection;hasRequiredTaskCollection$1=1;var e=taskCollection&&taskCollection.__spreadArray||function(C,N,T){if(T||arguments.length===2)for(var _=0,S=N.length,O;_<S;_++)(O||!(_ in N))&&(O||(O=Array.prototype.slice.call(N,0,_)),O[_]=N[_]);return C.concat(O||Array.prototype.slice.call(N))};Object.defineProperty(taskCollection,"__esModule",{value:!0}),taskCollection.TaskCollection=void 0;var t=requireUtils$6(),r=requireBakeCollection();function n(C,N){var T=this.length;if(T>1)if(N){var _;(_=this._tasks).push.apply(_,arguments),this.length+=arguments.length}else this._tasks.push(C),this.length++;else if(N){if(T===1){var S=Array(1+arguments.length);S.push(S),S.push.apply(S,arguments),this._tasks=S}else{var S=Array(arguments.length);S.push.apply(S,arguments),this._tasks=S}this.length+=arguments.length}else T===1?this._tasks=[this._tasks,C]:this._tasks=C,this.length++}function o(C,N){var T=this.length;if(T>1)if(N){var _;(_=this._tasks).push.apply(_,arguments),this.length+=arguments.length}else this._tasks.push(C),this.length++;else if(N){if(T===1){var S=Array(1+arguments.length);S.push(S),S.push.apply(S,arguments),this._tasks=S}else{var S=Array(arguments.length);S.push.apply(S,arguments),this._tasks=S}this.length+=arguments.length}else T===1?this._tasks=[this._tasks,C]:this._tasks=C,this.length++;this.firstEmitBuildStrategy?this.call=g:this.rebuild()}function a(C){this.length!==0&&(this.length===1?this._tasks===C&&(this.length=0):((0,t._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(C)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function l(C){if(this.length!==0){if(this.length===1)if(this._tasks===C&&(this.length=0),this.firstEmitBuildStrategy){this.call=r.BAKED_EMPTY_FUNC;return}else{this.rebuild();return}else(0,t._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(C)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length;this.firstEmitBuildStrategy?this.call=g:this.rebuild()}}function u(C){for(var N,T=[],_=1;_<arguments.length;_++)T[_-1]=arguments[_];this.length===0?(this._tasks=T,this.length=1):this.length===1?(T.unshift(this._tasks),this._tasks=T,this.length=this._tasks.length):((N=this._tasks).splice.apply(N,e([C,0],T,!1)),this.length=this._tasks.length)}function f(C){for(var N,T=[],_=1;_<arguments.length;_++)T[_-1]=arguments[_];this.length===0?(this._tasks=T,this.length=1):this.length===1?(T.unshift(this._tasks),this._tasks=T,this.length=this._tasks.length):((N=this._tasks).splice.apply(N,e([C,0],T,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=g:this.rebuild()}function x(){this.length===0?this.call=r.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,r.bakeCollection)(this._tasks,this.argsNum)}function p(){this.length===0?this.call=r.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,r.bakeCollectionAwait)(this._tasks,this.argsNum)}function g(){this.rebuild(),this.call.apply(void 0,arguments)}var y=(function(){function C(N,T,_,S){T===void 0&&(T=!0),_===void 0&&(_=null),S===void 0&&(S=!1),this.awaitTasks=S,this.call=r.BAKED_EMPTY_FUNC,this.argsNum=N,this.firstEmitBuildStrategy=!0,S?this.rebuild=p.bind(this):this.rebuild=x.bind(this),this.setAutoRebuild(T),_?typeof _=="function"?(this._tasks=_,this.length=1):(this._tasks=_,this.length=_.length):(this._tasks=null,this.length=0),T&&this.rebuild()}return C})();taskCollection.TaskCollection=y;function b(){this._tasks=null,this.length=0,this.call=r.BAKED_EMPTY_FUNC}function w(){this._tasks=null,this.length=0,this.call=r.BAKED_EMPTY_FUNC}function v(C){this.argsNum<C&&(this.argsNum=C,this.firstEmitBuildStrategy?this.call=g:this.rebuild())}function B(C){C?(this.push=o.bind(this),this.insert=f.bind(this),this.removeLast=l.bind(this)):(this.push=n.bind(this),this.insert=u.bind(this),this.removeLast=a.bind(this))}function j(){return this.length===0?[]:this.length===1?[this._tasks]:this._tasks}function F(C){C.length===0?(this.length=0,this.call=r.BAKED_EMPTY_FUNC):C.length===1?(this.length=1,this.call=C[0],this._tasks=C[0]):(this.length=C.length,this._tasks=C,this.firstEmitBuildStrategy?this.call=g:this.rebuild())}return y.prototype.fastClear=b,y.prototype.clear=w,y.prototype.growArgsNum=v,y.prototype.setAutoRebuild=B,y.prototype.tasksAsArray=j,y.prototype.setTasks=F,taskCollection}var hasRequiredTaskCollection;function requireTaskCollection(){return hasRequiredTaskCollection||(hasRequiredTaskCollection=1,(function(e){var t=taskCollection$1&&taskCollection$1.__createBinding||(Object.create?(function(n,o,a,l){l===void 0&&(l=a);var u=Object.getOwnPropertyDescriptor(o,a);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[a]}}),Object.defineProperty(n,l,u)}):(function(n,o,a,l){l===void 0&&(l=a),n[l]=o[a]})),r=taskCollection$1&&taskCollection$1.__exportStar||function(n,o){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&t(o,n,a)};Object.defineProperty(e,"__esModule",{value:!0}),r(requireTaskCollection$1(),e)})(taskCollection$1)),taskCollection$1}var utils$5={},hasRequiredUtils$5;function requireUtils$5(){if(hasRequiredUtils$5)return utils$5;hasRequiredUtils$5=1,Object.defineProperty(utils$5,"__esModule",{value:!0}),utils$5.nullObj=void 0;function e(){var t={};return t.__proto__=null,t}return utils$5.nullObj=e,utils$5}var hasRequiredEe;function requireEe(){if(hasRequiredEe)return ee;hasRequiredEe=1;var e=ee&&ee.__spreadArray||function(T,_,S){if(S||arguments.length===2)for(var O=0,$=_.length,z;O<$;O++)(z||!(O in _))&&(z||(z=Array.prototype.slice.call(_,0,O)),z[O]=_[O]);return T.concat(z||Array.prototype.slice.call(_))};Object.defineProperty(ee,"__esModule",{value:!0}),ee.EventEmitter=void 0;var t=requireTaskCollection(),r=requireUtils$6(),n=requireUtils$5();function o(T,_,S,O,$,z){var W=this.events[T];if(W){if(W.length===0)return!1;if(W.argsNum<6)W.call(_,S,O,$,z);else{for(var U=new Array(W.argsNum),I=0,G=U.length;I<G;++I)U[I]=arguments[I+1];W.call.apply(void 0,U)}return!0}return!1}function a(T,_,S,O,$,z){var W=this.events[T],U;if(W!==void 0){if(W.length===0)return!1;if(W.argsNum<6)W.call(_,S,O,$,z);else{U=new Array(W.argsNum);for(var I=0,G=U.length;I<G;++I)U[I]=arguments[I+1];W.call.apply(void 0,U)}}var k=this.onceEvents[T];if(k){if(typeof k=="function")if(this.onceEvents[T]=void 0,arguments.length<6)k(_,S,O,$,z);else{if(U===void 0){U=new Array(arguments.length-1);for(var I=0,G=U.length;I<G;++I)U[I]=arguments[I+1]}k.apply(void 0,U)}else{var M=k;if(this.onceEvents[T]=void 0,arguments.length<6)for(var I=0;I<M.length;++I)M[I](_,S,O,$,z);else{if(U===void 0){U=new Array(arguments.length-1);for(var I=0,G=U.length;I<G;++I)U[I]=arguments[I+1]}for(var I=0;I<M.length;++I)M[I].apply(void 0,U)}}return!0}return W!==void 0}var l=(function(){function T(){this.events=(0,n.nullObj)(),this.onceEvents=(0,n.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(T.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),T})();ee.EventEmitter=l;function u(T,_){switch(this.emit===o&&(this.emit=a),typeof this.onceEvents[T]){case"undefined":this.onceEvents[T]=_,typeof T=="symbol"&&this._symbolKeys.add(T);break;case"function":this.onceEvents[T]=[this.onceEvents[T],_];break;case"object":this.onceEvents[T].push(_)}return this}function f(T,_,S){if(S===void 0&&(S=_.length),typeof _!="function")throw new TypeError("The listener must be a function");var O=this.events[T];return O?(O.push(_),O.growArgsNum(S),this.maxListeners!==1/0&&this.maxListeners<=O.length&&console.warn('Maximum event listeners for "'.concat(String(T),'" event!'))):(this.events[T]=new t.TaskCollection(S,!0,_,!1),typeof T=="symbol"&&this._symbolKeys.add(T)),this}function x(T,_){var S=this.events[T];S&&S.removeLast(_);var O=this.onceEvents[T];return O&&(typeof O=="function"?this.onceEvents[T]=void 0:typeof O=="object"&&(O.length===1&&O[0]===_?this.onceEvents[T]=void 0:(0,r._fast_remove_single)(O,O.lastIndexOf(_)))),this}function p(T,_,S,O){S===void 0&&(S=this),O===void 0&&(O=_.length),this.boundFuncs||(this.boundFuncs=new Map);var $=_.bind(S);return this.boundFuncs.set(_,$),this.addListener(T,$,O)}function g(T,_){var S,O,$=(S=this.boundFuncs)===null||S===void 0?void 0:S.get(_);return(O=this.boundFuncs)===null||O===void 0||O.delete(_),this.removeListener(T,$)}function y(T){return this.events[T]&&!!this.events[T].length}function b(T,_,S){if(S===void 0&&(S=_.length),typeof _!="function")throw new TypeError("The listener must be a function");var O=this.events[T];return!O||!(O instanceof t.TaskCollection)?(O=this.events[T]=new t.TaskCollection(S,!0,_,!1),typeof T=="symbol"&&this._symbolKeys.add(T)):(O.insert(0,_),O.growArgsNum(S),this.maxListeners!==1/0&&this.maxListeners<=O.length&&console.warn('Maximum event listeners for "'.concat(String(T),'" event!'))),this}function w(T,_){this.emit===o&&(this.emit=a);var S=this.onceEvents[T];return S?typeof S!="object"?(this.onceEvents[T]=[_,S],typeof T=="symbol"&&this._symbolKeys.add(T)):(S.unshift(_),this.maxListeners!==1/0&&this.maxListeners<=S.length&&console.warn('Maximum event listeners for "'.concat(String(T),'" once event!'))):(this.onceEvents[T]=[_],typeof T=="symbol"&&this._symbolKeys.add(T)),this}function v(T){return T===void 0?(this.events=(0,n.nullObj)(),this.onceEvents=(0,n.nullObj)(),this._symbolKeys=new Set):(this.events[T]=void 0,this.onceEvents[T]=void 0,typeof T=="symbol"&&this._symbolKeys.delete(T)),this}function B(T){return this.maxListeners=T,this}function j(){return this.maxListeners}function F(T){return this.emit===o?this.events[T]?this.events[T].tasksAsArray().slice():[]:this.events[T]&&this.onceEvents[T]?e(e([],this.events[T].tasksAsArray(),!0),typeof this.onceEvents[T]=="function"?[this.onceEvents[T]]:this.onceEvents[T],!0):this.events[T]?this.events[T].tasksAsArray():this.onceEvents[T]?typeof this.onceEvents[T]=="function"?[this.onceEvents[T]]:this.onceEvents[T]:[]}function C(){var T=this;if(this.emit===o){var _=Object.keys(this.events);return e(e([],_,!0),Array.from(this._symbolKeys),!0).filter(function(O){return O in T.events&&T.events[O]&&T.events[O].length})}else{var _=Object.keys(this.events).filter(function($){return T.events[$]&&T.events[$].length}),S=Object.keys(this.onceEvents).filter(function($){return T.onceEvents[$]&&T.onceEvents[$].length});return e(e(e([],_,!0),S,!0),Array.from(this._symbolKeys).filter(function($){return $ in T.events&&T.events[$]&&T.events[$].length||$ in T.onceEvents&&T.onceEvents[$]&&T.onceEvents[$].length}),!0)}}function N(T){return this.emit===o?this.events[T]&&this.events[T].length||0:(this.events[T]&&this.events[T].length||0)+(this.onceEvents[T]&&this.onceEvents[T].length||0)}return l.prototype.emit=o,l.prototype.on=f,l.prototype.once=u,l.prototype.addListener=f,l.prototype.removeListener=x,l.prototype.addListenerBound=p,l.prototype.removeListenerBound=g,l.prototype.hasListeners=y,l.prototype.prependListener=b,l.prototype.prependOnceListener=w,l.prototype.off=x,l.prototype.removeAllListeners=v,l.prototype.setMaxListeners=B,l.prototype.getMaxListeners=j,l.prototype.listeners=F,l.prototype.eventNames=C,l.prototype.listenerCount=N,ee}var hasRequiredLib$1;function requireLib$1(){return hasRequiredLib$1||(hasRequiredLib$1=1,(function(e){var t=lib$1&&lib$1.__createBinding||(Object.create?(function(n,o,a,l){l===void 0&&(l=a);var u=Object.getOwnPropertyDescriptor(o,a);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[a]}}),Object.defineProperty(n,l,u)}):(function(n,o,a,l){l===void 0&&(l=a),n[l]=o[a]})),r=lib$1&&lib$1.__exportStar||function(n,o){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&t(o,n,a)};Object.defineProperty(e,"__esModule",{value:!0}),r(requireTypes(),e),r(requireEe(),e)})(lib$1)),lib$1}var libExports=requireLib$1(),browser$1={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var e=1e3,t=e*60,r=t*60,n=r*24,o=n*7,a=n*365.25;ms=function(p,g){g=g||{};var y=typeof p;if(y==="string"&&p.length>0)return l(p);if(y==="number"&&isFinite(p))return g.long?f(p):u(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))};function l(p){if(p=String(p),!(p.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(g){var y=parseFloat(g[1]),b=(g[2]||"ms").toLowerCase();switch(b){case"years":case"year":case"yrs":case"yr":case"y":return y*a;case"weeks":case"week":case"w":return y*o;case"days":case"day":case"d":return y*n;case"hours":case"hour":case"hrs":case"hr":case"h":return y*r;case"minutes":case"minute":case"mins":case"min":case"m":return y*t;case"seconds":case"second":case"secs":case"sec":case"s":return y*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return y;default:return}}}}function u(p){var g=Math.abs(p);return g>=n?Math.round(p/n)+"d":g>=r?Math.round(p/r)+"h":g>=t?Math.round(p/t)+"m":g>=e?Math.round(p/e)+"s":p+"ms"}function f(p){var g=Math.abs(p);return g>=n?x(p,g,n,"day"):g>=r?x(p,g,r,"hour"):g>=t?x(p,g,t,"minute"):g>=e?x(p,g,e,"second"):p+" ms"}function x(p,g,y,b){var w=g>=y*1.5;return Math.round(p/y)+" "+b+(w?"s":"")}return ms}var common,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;function e(t){n.debug=n,n.default=n,n.coerce=x,n.disable=u,n.enable=a,n.enabled=f,n.humanize=requireMs(),n.destroy=p,Object.keys(t).forEach(g=>{n[g]=t[g]}),n.names=[],n.skips=[],n.formatters={};function r(g){let y=0;for(let b=0;b<g.length;b++)y=(y<<5)-y+g.charCodeAt(b),y|=0;return n.colors[Math.abs(y)%n.colors.length]}n.selectColor=r;function n(g){let y,b=null,w,v;function B(...j){if(!B.enabled)return;const F=B,C=Number(new Date),N=C-(y||C);F.diff=N,F.prev=y,F.curr=C,y=C,j[0]=n.coerce(j[0]),typeof j[0]!="string"&&j.unshift("%O");let T=0;j[0]=j[0].replace(/%([a-zA-Z%])/g,(S,O)=>{if(S==="%%")return"%";T++;const $=n.formatters[O];if(typeof $=="function"){const z=j[T];S=$.call(F,z),j.splice(T,1),T--}return S}),n.formatArgs.call(F,j),(F.log||n.log).apply(F,j)}return B.namespace=g,B.useColors=n.useColors(),B.color=n.selectColor(g),B.extend=o,B.destroy=n.destroy,Object.defineProperty(B,"enabled",{enumerable:!0,configurable:!1,get:()=>b!==null?b:(w!==n.namespaces&&(w=n.namespaces,v=n.enabled(g)),v),set:j=>{b=j}}),typeof n.init=="function"&&n.init(B),B}function o(g,y){const b=n(this.namespace+(typeof y>"u"?":":y)+g);return b.log=this.log,b}function a(g){n.save(g),n.namespaces=g,n.names=[],n.skips=[];const y=(typeof g=="string"?g:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const b of y)b[0]==="-"?n.skips.push(b.slice(1)):n.names.push(b)}function l(g,y){let b=0,w=0,v=-1,B=0;for(;b<g.length;)if(w<y.length&&(y[w]===g[b]||y[w]==="*"))y[w]==="*"?(v=w,B=b,w++):(b++,w++);else if(v!==-1)w=v+1,B++,b=B;else return!1;for(;w<y.length&&y[w]==="*";)w++;return w===y.length}function u(){const g=[...n.names,...n.skips.map(y=>"-"+y)].join(",");return n.enable(""),g}function f(g){for(const y of n.skips)if(l(g,y))return!1;for(const y of n.names)if(l(g,y))return!0;return!1}function x(g){return g instanceof Error?g.stack||g.message:g}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return common=e,common}var hasRequiredBrowser$1;function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,(function(e,t){var r={};t.formatArgs=o,t.save=a,t.load=l,t.useColors=n,t.storage=u(),t.destroy=(()=>{let x=!1;return()=>{x||(x=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let x;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(x=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(x[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(x){if(x[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+x[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const p="color: "+this.color;x.splice(1,0,p,"color: inherit");let g=0,y=0;x[0].replace(/%[a-zA-Z%]/g,b=>{b!=="%%"&&(g++,b==="%c"&&(y=g))}),x.splice(y,0,p)}t.log=console.debug||console.log||(()=>{});function a(x){try{x?t.storage.setItem("debug",x):t.storage.removeItem("debug")}catch{}}function l(){let x;try{x=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch{}return!x&&typeof process$1<"u"&&"env"in process$1&&(x=r.DEBUG),x}function u(){try{return localStorage}catch{}}e.exports=requireCommon()(t);const{formatters:f}=e.exports;f.j=function(x){try{return JSON.stringify(x)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}}})(browser$1,browser$1.exports)),browser$1.exports}var browserExports$1=requireBrowser$1();const createDebug5=getDefaultExportFromCjs$1(browserExports$1),crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function isBytes(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function anumber(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function abytes(e,...t){if(!isBytes(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ahash(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");anumber(e.outputLen),anumber(e.blockLen)}function aexists(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aoutput(e,t){abytes(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function clean(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function createView(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rotr(e,t){return e<<32-t|e>>>t}function rotl$1(e,t){return e<<t|e>>>32-t>>>0}const hasHexBuiltin=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex(e){if(abytes(e),hasHexBuiltin)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=hexes[e[r]];return t}const asciis={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(e){if(e>=asciis._0&&e<=asciis._9)return e-asciis._0;if(e>=asciis.A&&e<=asciis.F)return e-(asciis.A-10);if(e>=asciis.a&&e<=asciis.f)return e-(asciis.a-10)}function hexToBytes$2(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(hasHexBuiltin)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let o=0,a=0;o<r;o++,a+=2){const l=asciiToBase16(e.charCodeAt(a)),u=asciiToBase16(e.charCodeAt(a+1));if(l===void 0||u===void 0){const f=e[a]+e[a+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+a)}n[o]=l*16+u}return n}function utf8ToBytes(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function toBytes(e){return typeof e=="string"&&(e=utf8ToBytes(e)),abytes(e),e}function concatBytes(...e){let t=0;for(let n=0;n<e.length;n++){const o=e[n];abytes(o),t+=o.length}const r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){const a=e[n];r.set(a,o),o+=a.length}return r}class Hash{}function createHasher(e){const t=n=>e().update(toBytes(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function randomBytes(e=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(e));if(crypto$2&&typeof crypto$2.randomBytes=="function")return Uint8Array.from(crypto$2.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const o=BigInt(32),a=BigInt(4294967295),l=Number(r>>o&a),u=Number(r&a),f=n?4:0,x=n?0:4;e.setUint32(t+f,l,n),e.setUint32(t+x,u,n)}function Chi(e,t,r){return e&t^~e&r}function Maj(e,t,r){return e&t^e&r^t&r}class HashMD extends Hash{constructor(t,r,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=createView(this.buffer)}update(t){aexists(this),t=toBytes(t),abytes(t);const{view:r,buffer:n,blockLen:o}=this,a=t.length;for(let l=0;l<a;){const u=Math.min(o-this.pos,a-l);if(u===o){const f=createView(t);for(;o<=a-l;l+=o)this.process(f,l);continue}n.set(t.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){aexists(this),aoutput(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:a}=this;let{pos:l}=this;r[l++]=128,clean(this.buffer.subarray(l)),this.padOffset>o-l&&(this.process(n,0),l=0);for(let g=l;g<o;g++)r[g]=0;setBigUint64(n,o-8,BigInt(this.length*8),a),this.process(n,0);const u=createView(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const x=f/4,p=this.get();if(x>p.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<x;g++)u.setUint32(4*g,p[g],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:a,destroyed:l,pos:u}=this;return t.destroyed=l,t.finished=a,t.length=o,t.pos=u,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_K=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(t=32){super(64,t,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:t,B:r,C:n,D:o,E:a,F:l,G:u,H:f}=this;return[t,r,n,o,a,l,u,f]}set(t,r,n,o,a,l,u,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=a|0,this.F=l|0,this.G=u|0,this.H=f|0}process(t,r){for(let g=0;g<16;g++,r+=4)SHA256_W[g]=t.getUint32(r,!1);for(let g=16;g<64;g++){const y=SHA256_W[g-15],b=SHA256_W[g-2],w=rotr(y,7)^rotr(y,18)^y>>>3,v=rotr(b,17)^rotr(b,19)^b>>>10;SHA256_W[g]=v+SHA256_W[g-7]+w+SHA256_W[g-16]|0}let{A:n,B:o,C:a,D:l,E:u,F:f,G:x,H:p}=this;for(let g=0;g<64;g++){const y=rotr(u,6)^rotr(u,11)^rotr(u,25),b=p+y+Chi(u,f,x)+SHA256_K[g]+SHA256_W[g]|0,v=(rotr(n,2)^rotr(n,13)^rotr(n,22))+Maj(n,o,a)|0;p=x,x=f,f=u,u=l+b|0,l=a,a=o,o=n,n=b+v|0}n=n+this.A|0,o=o+this.B|0,a=a+this.C|0,l=l+this.D|0,u=u+this.E|0,f=f+this.F|0,x=x+this.G|0,p=p+this.H|0,this.set(n,o,a,l,u,f,x,p)}roundClean(){clean(SHA256_W)}destroy(){this.set(0,0,0,0,0,0,0,0),clean(this.buffer)}}const sha256$1=createHasher(()=>new SHA256);class HMAC extends Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,ahash(t);const n=toBytes(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,a=new Uint8Array(o);a.set(n.length>o?t.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=t.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),clean(a)}update(t){return aexists(this),this.iHash.update(t),this}digestInto(t){aexists(this),abytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:o,destroyed:a,blockLen:l,outputLen:u}=this;return t=t,t.finished=o,t.destroyed=a,t.blockLen=l,t.outputLen=u,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac$1=(e,t,r)=>new HMAC(e,t).update(r).digest();hmac$1.create=(e,t)=>new HMAC(e,t);const _0n$4=BigInt(0),_1n$4=BigInt(1);function _abool2(e,t=""){if(typeof e!="boolean"){const r=t&&`"${t}"`;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function _abytes2(e,t,r=""){const n=isBytes(e),o=e?.length,a=t!==void 0;if(!n||a&&o!==t){const l=r&&`"${r}" `,u=a?` of length ${t}`:"",f=n?`length=${o}`:`type=${typeof e}`;throw new Error(l+"expected Uint8Array"+u+", got "+f)}return e}function numberToHexUnpadded(e){const t=e.toString(16);return t.length&1?"0"+t:t}function hexToNumber(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?_0n$4:BigInt("0x"+e)}function bytesToNumberBE(e){return hexToNumber(bytesToHex(e))}function bytesToNumberLE(e){return abytes(e),hexToNumber(bytesToHex(Uint8Array.from(e).reverse()))}function numberToBytesBE(e,t){return hexToBytes$2(e.toString(16).padStart(t*2,"0"))}function numberToBytesLE(e,t){return numberToBytesBE(e,t).reverse()}function ensureBytes(e,t,r){let n;if(typeof t=="string")try{n=hexToBytes$2(t)}catch(a){throw new Error(e+" must be hex string or Uint8Array, cause: "+a)}else if(isBytes(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const o=n.length;if(typeof r=="number"&&o!==r)throw new Error(e+" of length "+r+" expected, got "+o);return n}const isPosBig=e=>typeof e=="bigint"&&_0n$4<=e;function inRange(e,t,r){return isPosBig(e)&&isPosBig(t)&&isPosBig(r)&&t<=e&&e<r}function aInRange(e,t,r,n){if(!inRange(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function bitLen(e){let t;for(t=0;e>_0n$4;e>>=_1n$4,t+=1);return t}const bitMask=e=>(_1n$4<<BigInt(e))-_1n$4;function createHmacDrbg(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");const n=b=>new Uint8Array(b),o=b=>Uint8Array.of(b);let a=n(e),l=n(e),u=0;const f=()=>{a.fill(1),l.fill(0),u=0},x=(...b)=>r(l,a,...b),p=(b=n(0))=>{l=x(o(0),b),a=x(),b.length!==0&&(l=x(o(1),b),a=x())},g=()=>{if(u++>=1e3)throw new Error("drbg: tried 1000 values");let b=0;const w=[];for(;b<t;){a=x();const v=a.slice();w.push(v),b+=a.length}return concatBytes(...w)};return(b,w)=>{f(),p(b);let v;for(;!(v=w(g()));)p();return f(),v}}function _validateObject(e,t,r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(o,a,l){const u=e[o];if(l&&u===void 0)return;const f=typeof u;if(f!==a||u===null)throw new Error(`param "${o}" is invalid: expected ${a}, got ${f}`)}Object.entries(t).forEach(([o,a])=>n(o,a,!1)),Object.entries(r).forEach(([o,a])=>n(o,a,!0))}function memoized(e){const t=new WeakMap;return(r,...n)=>{const o=t.get(r);if(o!==void 0)return o;const a=e(r,...n);return t.set(r,a),a}}const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$2=BigInt(2),_3n$1=BigInt(3),_4n$1=BigInt(4),_5n=BigInt(5),_7n=BigInt(7),_8n=BigInt(8),_9n=BigInt(9),_16n=BigInt(16);function mod(e,t){const r=e%t;return r>=_0n$3?r:t+r}function pow2(e,t,r){let n=e;for(;t-- >_0n$3;)n*=n,n%=r;return n}function invert(e,t){if(e===_0n$3)throw new Error("invert: expected non-zero number");if(t<=_0n$3)throw new Error("invert: expected positive modulus, got "+t);let r=mod(e,t),n=t,o=_0n$3,a=_1n$3;for(;r!==_0n$3;){const u=n/r,f=n%r,x=o-a*u;n=r,r=f,o=a,a=x}if(n!==_1n$3)throw new Error("invert: does not exist");return mod(o,t)}function assertIsSquare(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function sqrt3mod4(e,t){const r=(e.ORDER+_1n$3)/_4n$1,n=e.pow(t,r);return assertIsSquare(e,n,t),n}function sqrt5mod8(e,t){const r=(e.ORDER-_5n)/_8n,n=e.mul(t,_2n$2),o=e.pow(n,r),a=e.mul(t,o),l=e.mul(e.mul(a,_2n$2),o),u=e.mul(a,e.sub(l,e.ONE));return assertIsSquare(e,u,t),u}function sqrt9mod16(e){const t=Field(e),r=tonelliShanks(e),n=r(t,t.neg(t.ONE)),o=r(t,n),a=r(t,t.neg(n)),l=(e+_7n)/_16n;return(u,f)=>{let x=u.pow(f,l),p=u.mul(x,n);const g=u.mul(x,o),y=u.mul(x,a),b=u.eql(u.sqr(p),f),w=u.eql(u.sqr(g),f);x=u.cmov(x,p,b),p=u.cmov(y,g,w);const v=u.eql(u.sqr(p),f),B=u.cmov(x,p,v);return assertIsSquare(u,B,f),B}}function tonelliShanks(e){if(e<_3n$1)throw new Error("sqrt is not defined for small field");let t=e-_1n$3,r=0;for(;t%_2n$2===_0n$3;)t/=_2n$2,r++;let n=_2n$2;const o=Field(e);for(;FpLegendre(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return sqrt3mod4;let a=o.pow(n,t);const l=(t+_1n$3)/_2n$2;return function(f,x){if(f.is0(x))return x;if(FpLegendre(f,x)!==1)throw new Error("Cannot find square root");let p=r,g=f.mul(f.ONE,a),y=f.pow(x,t),b=f.pow(x,l);for(;!f.eql(y,f.ONE);){if(f.is0(y))return f.ZERO;let w=1,v=f.sqr(y);for(;!f.eql(v,f.ONE);)if(w++,v=f.sqr(v),w===p)throw new Error("Cannot find square root");const B=_1n$3<<BigInt(p-w-1),j=f.pow(g,B);p=w,g=f.sqr(j),y=f.mul(y,g),b=f.mul(b,j)}return b}}function FpSqrt(e){return e%_4n$1===_3n$1?sqrt3mod4:e%_8n===_5n?sqrt5mod8:e%_16n===_9n?sqrt9mod16(e):tonelliShanks(e)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=FIELD_FIELDS.reduce((n,o)=>(n[o]="function",n),t);return _validateObject(e,r),e}function FpPow(e,t,r){if(r<_0n$3)throw new Error("invalid exponent, negatives unsupported");if(r===_0n$3)return e.ONE;if(r===_1n$3)return t;let n=e.ONE,o=t;for(;r>_0n$3;)r&_1n$3&&(n=e.mul(n,o)),o=e.sqr(o),r>>=_1n$3;return n}function FpInvertBatch(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((l,u,f)=>e.is0(u)?l:(n[f]=l,e.mul(l,u)),e.ONE),a=e.inv(o);return t.reduceRight((l,u,f)=>e.is0(u)?l:(n[f]=e.mul(l,n[f]),e.mul(l,u)),a),n}function FpLegendre(e,t){const r=(e.ORDER-_1n$3)/_2n$2,n=e.pow(t,r),o=e.eql(n,e.ONE),a=e.eql(n,e.ZERO),l=e.eql(n,e.neg(e.ONE));if(!o&&!a&&!l)throw new Error("invalid Legendre symbol result");return o?1:a?0:-1}function nLength(e,t){t!==void 0&&anumber(t);const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Field(e,t,r=!1,n={}){if(e<=_0n$3)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,a,l=!1,u;if(typeof t=="object"&&t!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const y=t;y.BITS&&(o=y.BITS),y.sqrt&&(a=y.sqrt),typeof y.isLE=="boolean"&&(r=y.isLE),typeof y.modFromBytes=="boolean"&&(l=y.modFromBytes),u=y.allowedLengths}else typeof t=="number"&&(o=t),n.sqrt&&(a=n.sqrt);const{nBitLength:f,nByteLength:x}=nLength(e,o);if(x>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let p;const g=Object.freeze({ORDER:e,isLE:r,BITS:f,BYTES:x,MASK:bitMask(f),ZERO:_0n$3,ONE:_1n$3,allowedLengths:u,create:y=>mod(y,e),isValid:y=>{if(typeof y!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof y);return _0n$3<=y&&y<e},is0:y=>y===_0n$3,isValidNot0:y=>!g.is0(y)&&g.isValid(y),isOdd:y=>(y&_1n$3)===_1n$3,neg:y=>mod(-y,e),eql:(y,b)=>y===b,sqr:y=>mod(y*y,e),add:(y,b)=>mod(y+b,e),sub:(y,b)=>mod(y-b,e),mul:(y,b)=>mod(y*b,e),pow:(y,b)=>FpPow(g,y,b),div:(y,b)=>mod(y*invert(b,e),e),sqrN:y=>y*y,addN:(y,b)=>y+b,subN:(y,b)=>y-b,mulN:(y,b)=>y*b,inv:y=>invert(y,e),sqrt:a||(y=>(p||(p=FpSqrt(e)),p(g,y))),toBytes:y=>r?numberToBytesLE(y,x):numberToBytesBE(y,x),fromBytes:(y,b=!0)=>{if(u){if(!u.includes(y.length)||y.length>x)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+y.length);const v=new Uint8Array(x);v.set(y,r?0:v.length-y.length),y=v}if(y.length!==x)throw new Error("Field.fromBytes: expected "+x+" bytes, got "+y.length);let w=r?bytesToNumberLE(y):bytesToNumberBE(y);if(l&&(w=mod(w,e)),!b&&!g.isValid(w))throw new Error("invalid field element: outside of range 0..ORDER");return w},invertBatch:y=>FpInvertBatch(g,y),cmov:(y,b,w)=>w?b:y});return Object.freeze(g)}function getFieldBytesLength(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength(e){const t=getFieldBytesLength(e);return t+Math.ceil(t/2)}function mapHashToField(e,t,r=!1){const n=e.length,o=getFieldBytesLength(t),a=getMinHashLength(t);if(n<16||n<a||n>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+n);const l=r?bytesToNumberLE(e):bytesToNumberBE(e),u=mod(l,t-_1n$3)+_1n$3;return r?numberToBytesLE(u,o):numberToBytesBE(u,o)}const _0n$2=BigInt(0),_1n$2=BigInt(1);function negateCt(e,t){const r=t.negate();return e?r:t}function normalizeZ(e,t){const r=FpInvertBatch(e.Fp,t.map(n=>n.Z));return t.map((n,o)=>e.fromAffine(n.toAffine(r[o])))}function validateW(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function calcWOpts(e,t){validateW(e,t);const r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,a=bitMask(e),l=BigInt(e);return{windows:r,windowSize:n,mask:a,maxNumber:o,shiftBy:l}}function calcOffsets(e,t,r){const{windowSize:n,mask:o,maxNumber:a,shiftBy:l}=r;let u=Number(e&o),f=e>>l;u>n&&(u-=a,f+=_1n$2);const x=t*n,p=x+Math.abs(u)-1,g=u===0,y=u<0,b=t%2!==0;return{nextN:f,offset:p,isZero:g,isNeg:y,isNegF:b,offsetF:x}}function validateMSMPoints(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function validateMSMScalars(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(e){return pointWindowSizes.get(e)||1}function assert0(e){if(e!==_0n$2)throw new Error("invalid wNAF")}class wNAF{constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let o=t;for(;r>_0n$2;)r&_1n$2&&(n=n.add(o)),o=o.double(),r>>=_1n$2;return n}precomputeWindow(t,r){const{windows:n,windowSize:o}=calcWOpts(r,this.bits),a=[];let l=t,u=l;for(let f=0;f<n;f++){u=l,a.push(u);for(let x=1;x<o;x++)u=u.add(l),a.push(u);l=u.double()}return a}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let o=this.ZERO,a=this.BASE;const l=calcWOpts(t,this.bits);for(let u=0;u<l.windows;u++){const{nextN:f,offset:x,isZero:p,isNeg:g,isNegF:y,offsetF:b}=calcOffsets(n,u,l);n=f,p?a=a.add(negateCt(y,r[b])):o=o.add(negateCt(g,r[x]))}return assert0(n),{p:o,f:a}}wNAFUnsafe(t,r,n,o=this.ZERO){const a=calcWOpts(t,this.bits);for(let l=0;l<a.windows&&n!==_0n$2;l++){const{nextN:u,offset:f,isZero:x,isNeg:p}=calcOffsets(n,l,a);if(n=u,!x){const g=r[f];o=o.add(p?g.negate():g)}}return assert0(n),o}getPrecomputes(t,r,n){let o=pointPrecomputes.get(r);return o||(o=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(o=n(o)),pointPrecomputes.set(r,o))),o}cached(t,r,n){const o=getW(t);return this.wNAF(o,this.getPrecomputes(o,t,n),r)}unsafe(t,r,n,o){const a=getW(t);return a===1?this._unsafeLadder(t,r,o):this.wNAFUnsafe(a,this.getPrecomputes(a,t,n),r,o)}createCache(t,r){validateW(r,this.bits),pointWindowSizes.set(t,r),pointPrecomputes.delete(t)}hasCache(t){return getW(t)!==1}}function mulEndoUnsafe(e,t,r,n){let o=t,a=e.ZERO,l=e.ZERO;for(;r>_0n$2||n>_0n$2;)r&_1n$2&&(a=a.add(o)),n&_1n$2&&(l=l.add(o)),o=o.double(),r>>=_1n$2,n>>=_1n$2;return{p1:a,p2:l}}function pippenger(e,t,r,n){validateMSMPoints(r,e),validateMSMScalars(n,t);const o=r.length,a=n.length;if(o!==a)throw new Error("arrays of points and scalars must have equal length");const l=e.ZERO,u=bitLen(BigInt(o));let f=1;u>12?f=u-3:u>4?f=u-2:u>0&&(f=2);const x=bitMask(f),p=new Array(Number(x)+1).fill(l),g=Math.floor((t.BITS-1)/f)*f;let y=l;for(let b=g;b>=0;b-=f){p.fill(l);for(let v=0;v<a;v++){const B=n[v],j=Number(B>>BigInt(b)&x);p[j]=p[j].add(r[v])}let w=l;for(let v=p.length-1,B=l;v>0;v--)B=B.add(p[v]),w=w.add(B);if(y=y.add(w),b!==0)for(let v=0;v<f;v++)y=y.double()}return y}function createField(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField(t),t}else return Field(e,{isLE:r})}function _createCurveFields(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const f of["p","n","h"]){const x=t[f];if(!(typeof x=="bigint"&&x>_0n$2))throw new Error(`CURVE.${f} must be positive bigint`)}const o=createField(t.p,r.Fp,n),a=createField(t.n,r.Fn,n),u=["Gx","Gy","a","b"];for(const f of u)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:a}}const divNearest=(e,t)=>(e+(e>=0?t:-t)/_2n$1)/t;function _splitEndoScalar(e,t,r){const[[n,o],[a,l]]=t,u=divNearest(l*e,r),f=divNearest(-o*e,r);let x=e-u*n-f*a,p=-u*o-f*l;const g=x<_0n$1,y=p<_0n$1;g&&(x=-x),y&&(p=-p);const b=bitMask(Math.ceil(bitLen(r)/2))+_1n$1;if(x<_0n$1||x>=b||p<_0n$1||p>=b)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:g,k1:x,k2neg:y,k2:p}}function validateSigFormat(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function validateSigOpts(e,t){const r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return _abool2(r.lowS,"lowS"),_abool2(r.prehash,"prehash"),r.format!==void 0&&validateSigFormat(r.format),r}class DERErr extends Error{constructor(t=""){super(t)}}const DER={Err:DERErr,_tlv:{encode:(e,t)=>{const{Err:r}=DER;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");const n=t.length/2,o=numberToHexUnpadded(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");const a=n>127?numberToHexUnpadded(o.length/2|128):"";return numberToHexUnpadded(e)+a+o+t},decode(e,t){const{Err:r}=DER;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const o=t[n++],a=!!(o&128);let l=0;if(!a)l=o;else{const f=o&127;if(!f)throw new r("tlv.decode(long): indefinite length not supported");if(f>4)throw new r("tlv.decode(long): byte length is too big");const x=t.subarray(n,n+f);if(x.length!==f)throw new r("tlv.decode: length bytes not complete");if(x[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const p of x)l=l<<8|p;if(n+=f,l<128)throw new r("tlv.decode(long): not minimal encoding")}const u=t.subarray(n,n+l);if(u.length!==l)throw new r("tlv.decode: wrong value length");return{v:u,l:t.subarray(n+l)}}},_int:{encode(e){const{Err:t}=DER;if(e<_0n$1)throw new t("integer: negative integers are not allowed");let r=numberToHexUnpadded(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=DER;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return bytesToNumberBE(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=DER,o=ensureBytes("signature",e),{v:a,l}=n.decode(48,o);if(l.length)throw new t("invalid signature: left bytes after parsing");const{v:u,l:f}=n.decode(2,a),{v:x,l:p}=n.decode(2,f);if(p.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(u),s:r.decode(x)}},hexFromSig(e){const{_tlv:t,_int:r}=DER,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),a=n+o;return t.encode(48,a)}},_0n$1=BigInt(0),_1n$1=BigInt(1),_2n$1=BigInt(2),_3n=BigInt(3),_4n=BigInt(4);function _normFnElement(e,t){const{BYTES:r}=e;let n;if(typeof t=="bigint")n=t;else{let o=ensureBytes("private key",t);try{n=e.fromBytes(o)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!e.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function weierstrassN(e,t={}){const r=_createCurveFields("weierstrass",e,t),{Fp:n,Fn:o}=r;let a=r.CURVE;const{h:l,n:u}=a;_validateObject(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:f}=t;if(f&&(!n.is0(a.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const x=getWLengths(n,o);function p(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function g(U,I,G){const{x:k,y:M}=I.toAffine(),q=n.toBytes(k);if(_abool2(G,"isCompressed"),G){p();const K=!n.isOdd(M);return concatBytes(pprefix(K),q)}else return concatBytes(Uint8Array.of(4),q,n.toBytes(M))}function y(U){_abytes2(U,void 0,"Point");const{publicKey:I,publicKeyUncompressed:G}=x,k=U.length,M=U[0],q=U.subarray(1);if(k===I&&(M===2||M===3)){const K=n.fromBytes(q);if(!n.isValid(K))throw new Error("bad point: is not on curve, wrong x");const H=v(K);let Q;try{Q=n.sqrt(H)}catch(J){const L=J instanceof Error?": "+J.message:"";throw new Error("bad point: is not on curve, sqrt error"+L)}p();const D=n.isOdd(Q);return(M&1)===1!==D&&(Q=n.neg(Q)),{x:K,y:Q}}else if(k===G&&M===4){const K=n.BYTES,H=n.fromBytes(q.subarray(0,K)),Q=n.fromBytes(q.subarray(K,K*2));if(!B(H,Q))throw new Error("bad point: is not on curve");return{x:H,y:Q}}else throw new Error(`bad point: got length ${k}, expected compressed=${I} or uncompressed=${G}`)}const b=t.toBytes||g,w=t.fromBytes||y;function v(U){const I=n.sqr(U),G=n.mul(I,U);return n.add(n.add(G,n.mul(U,a.a)),a.b)}function B(U,I){const G=n.sqr(I),k=v(U);return n.eql(G,k)}if(!B(a.Gx,a.Gy))throw new Error("bad curve params: generator point");const j=n.mul(n.pow(a.a,_3n),_4n),F=n.mul(n.sqr(a.b),BigInt(27));if(n.is0(n.add(j,F)))throw new Error("bad curve params: a or b");function C(U,I,G=!1){if(!n.isValid(I)||G&&n.is0(I))throw new Error(`bad point coordinate ${U}`);return I}function N(U){if(!(U instanceof $))throw new Error("ProjectivePoint expected")}function T(U){if(!f||!f.basises)throw new Error("no endo");return _splitEndoScalar(U,f.basises,o.ORDER)}const _=memoized((U,I)=>{const{X:G,Y:k,Z:M}=U;if(n.eql(M,n.ONE))return{x:G,y:k};const q=U.is0();I==null&&(I=q?n.ONE:n.inv(M));const K=n.mul(G,I),H=n.mul(k,I),Q=n.mul(M,I);if(q)return{x:n.ZERO,y:n.ZERO};if(!n.eql(Q,n.ONE))throw new Error("invZ was invalid");return{x:K,y:H}}),S=memoized(U=>{if(U.is0()){if(t.allowInfinityPoint&&!n.is0(U.Y))return;throw new Error("bad point: ZERO")}const{x:I,y:G}=U.toAffine();if(!n.isValid(I)||!n.isValid(G))throw new Error("bad point: x or y not field elements");if(!B(I,G))throw new Error("bad point: equation left != right");if(!U.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function O(U,I,G,k,M){return G=new $(n.mul(G.X,U),G.Y,G.Z),I=negateCt(k,I),G=negateCt(M,G),I.add(G)}class ${constructor(I,G,k){this.X=C("x",I),this.Y=C("y",G,!0),this.Z=C("z",k),Object.freeze(this)}static CURVE(){return a}static fromAffine(I){const{x:G,y:k}=I||{};if(!I||!n.isValid(G)||!n.isValid(k))throw new Error("invalid affine point");if(I instanceof $)throw new Error("projective point not allowed");return n.is0(G)&&n.is0(k)?$.ZERO:new $(G,k,n.ONE)}static fromBytes(I){const G=$.fromAffine(w(_abytes2(I,void 0,"point")));return G.assertValidity(),G}static fromHex(I){return $.fromBytes(ensureBytes("pointHex",I))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(I=8,G=!0){return W.createCache(this,I),G||this.multiply(_3n),this}assertValidity(){S(this)}hasEvenY(){const{y:I}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(I)}equals(I){N(I);const{X:G,Y:k,Z:M}=this,{X:q,Y:K,Z:H}=I,Q=n.eql(n.mul(G,H),n.mul(q,M)),D=n.eql(n.mul(k,H),n.mul(K,M));return Q&&D}negate(){return new $(this.X,n.neg(this.Y),this.Z)}double(){const{a:I,b:G}=a,k=n.mul(G,_3n),{X:M,Y:q,Z:K}=this;let H=n.ZERO,Q=n.ZERO,D=n.ZERO,Y=n.mul(M,M),J=n.mul(q,q),L=n.mul(K,K),Z=n.mul(M,q);return Z=n.add(Z,Z),D=n.mul(M,K),D=n.add(D,D),H=n.mul(I,D),Q=n.mul(k,L),Q=n.add(H,Q),H=n.sub(J,Q),Q=n.add(J,Q),Q=n.mul(H,Q),H=n.mul(Z,H),D=n.mul(k,D),L=n.mul(I,L),Z=n.sub(Y,L),Z=n.mul(I,Z),Z=n.add(Z,D),D=n.add(Y,Y),Y=n.add(D,Y),Y=n.add(Y,L),Y=n.mul(Y,Z),Q=n.add(Q,Y),L=n.mul(q,K),L=n.add(L,L),Y=n.mul(L,Z),H=n.sub(H,Y),D=n.mul(L,J),D=n.add(D,D),D=n.add(D,D),new $(H,Q,D)}add(I){N(I);const{X:G,Y:k,Z:M}=this,{X:q,Y:K,Z:H}=I;let Q=n.ZERO,D=n.ZERO,Y=n.ZERO;const J=a.a,L=n.mul(a.b,_3n);let Z=n.mul(G,q),oe=n.mul(k,K),ce=n.mul(M,H),de=n.add(G,k),xe=n.add(q,K);de=n.mul(de,xe),xe=n.add(Z,oe),de=n.sub(de,xe),xe=n.add(G,M);let te=n.add(q,H);return xe=n.mul(xe,te),te=n.add(Z,ce),xe=n.sub(xe,te),te=n.add(k,M),Q=n.add(K,H),te=n.mul(te,Q),Q=n.add(oe,ce),te=n.sub(te,Q),Y=n.mul(J,xe),Q=n.mul(L,ce),Y=n.add(Q,Y),Q=n.sub(oe,Y),Y=n.add(oe,Y),D=n.mul(Q,Y),oe=n.add(Z,Z),oe=n.add(oe,Z),ce=n.mul(J,ce),xe=n.mul(L,xe),oe=n.add(oe,ce),ce=n.sub(Z,ce),ce=n.mul(J,ce),xe=n.add(xe,ce),Z=n.mul(oe,xe),D=n.add(D,Z),Z=n.mul(te,xe),Q=n.mul(de,Q),Q=n.sub(Q,Z),Z=n.mul(de,oe),Y=n.mul(te,Y),Y=n.add(Y,Z),new $(Q,D,Y)}subtract(I){return this.add(I.negate())}is0(){return this.equals($.ZERO)}multiply(I){const{endo:G}=t;if(!o.isValidNot0(I))throw new Error("invalid scalar: out of range");let k,M;const q=K=>W.cached(this,K,H=>normalizeZ($,H));if(G){const{k1neg:K,k1:H,k2neg:Q,k2:D}=T(I),{p:Y,f:J}=q(H),{p:L,f:Z}=q(D);M=J.add(Z),k=O(G.beta,Y,L,K,Q)}else{const{p:K,f:H}=q(I);k=K,M=H}return normalizeZ($,[k,M])[0]}multiplyUnsafe(I){const{endo:G}=t,k=this;if(!o.isValid(I))throw new Error("invalid scalar: out of range");if(I===_0n$1||k.is0())return $.ZERO;if(I===_1n$1)return k;if(W.hasCache(this))return this.multiply(I);if(G){const{k1neg:M,k1:q,k2neg:K,k2:H}=T(I),{p1:Q,p2:D}=mulEndoUnsafe($,k,q,H);return O(G.beta,Q,D,M,K)}else return W.unsafe(k,I)}multiplyAndAddUnsafe(I,G,k){const M=this.multiplyUnsafe(G).add(I.multiplyUnsafe(k));return M.is0()?void 0:M}toAffine(I){return _(this,I)}isTorsionFree(){const{isTorsionFree:I}=t;return l===_1n$1?!0:I?I($,this):W.unsafe(this,u).is0()}clearCofactor(){const{clearCofactor:I}=t;return l===_1n$1?this:I?I($,this):this.multiplyUnsafe(l)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}toBytes(I=!0){return _abool2(I,"isCompressed"),this.assertValidity(),b($,this,I)}toHex(I=!0){return bytesToHex(this.toBytes(I))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(I=!0){return this.toBytes(I)}_setWindowSize(I){this.precompute(I)}static normalizeZ(I){return normalizeZ($,I)}static msm(I,G){return pippenger($,o,I,G)}static fromPrivateKey(I){return $.BASE.multiply(_normFnElement(o,I))}}$.BASE=new $(a.Gx,a.Gy,n.ONE),$.ZERO=new $(n.ZERO,n.ONE,n.ZERO),$.Fp=n,$.Fn=o;const z=o.BITS,W=new wNAF($,t.endo?Math.ceil(z/2):z);return $.BASE.precompute(8),$}function pprefix(e){return Uint8Array.of(e?2:3)}function getWLengths(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function ecdh(e,t={}){const{Fn:r}=e,n=t.randomBytes||randomBytes,o=Object.assign(getWLengths(e.Fp,r),{seed:getMinHashLength(r.ORDER)});function a(b){try{return!!_normFnElement(r,b)}catch{return!1}}function l(b,w){const{publicKey:v,publicKeyUncompressed:B}=o;try{const j=b.length;return w===!0&&j!==v||w===!1&&j!==B?!1:!!e.fromBytes(b)}catch{return!1}}function u(b=n(o.seed)){return mapHashToField(_abytes2(b,o.seed,"seed"),r.ORDER)}function f(b,w=!0){return e.BASE.multiply(_normFnElement(r,b)).toBytes(w)}function x(b){const w=u(b);return{secretKey:w,publicKey:f(w)}}function p(b){if(typeof b=="bigint")return!1;if(b instanceof e)return!0;const{secretKey:w,publicKey:v,publicKeyUncompressed:B}=o;if(r.allowedLengths||w===v)return;const j=ensureBytes("key",b).length;return j===v||j===B}function g(b,w,v=!0){if(p(b)===!0)throw new Error("first arg must be private key");if(p(w)===!1)throw new Error("second arg must be public key");const B=_normFnElement(r,b);return e.fromHex(w).multiply(B).toBytes(v)}return Object.freeze({getPublicKey:f,getSharedSecret:g,keygen:x,Point:e,utils:{isValidSecretKey:a,isValidPublicKey:l,randomSecretKey:u,isValidPrivateKey:a,randomPrivateKey:u,normPrivateKeyToScalar:b=>_normFnElement(r,b),precompute(b=8,w=e.BASE){return w.precompute(b,!1)}},lengths:o})}function ecdsa(e,t,r={}){ahash(t),_validateObject(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||randomBytes,o=r.hmac||((G,...k)=>hmac$1(t,G,concatBytes(...k))),{Fp:a,Fn:l}=e,{ORDER:u,BITS:f}=l,{keygen:x,getPublicKey:p,getSharedSecret:g,utils:y,lengths:b}=ecdh(e,r),w={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},v="compact";function B(G){const k=u>>_1n$1;return G>k}function j(G,k){if(!l.isValidNot0(k))throw new Error(`invalid signature ${G}: out of range 1..Point.Fn.ORDER`);return k}function F(G,k){validateSigFormat(k);const M=b.signature,q=k==="compact"?M:k==="recovered"?M+1:void 0;return _abytes2(G,q,`${k} signature`)}class C{constructor(k,M,q){this.r=j("r",k),this.s=j("s",M),q!=null&&(this.recovery=q),Object.freeze(this)}static fromBytes(k,M=v){F(k,M);let q;if(M==="der"){const{r:D,s:Y}=DER.toSig(_abytes2(k));return new C(D,Y)}M==="recovered"&&(q=k[0],M="compact",k=k.subarray(1));const K=l.BYTES,H=k.subarray(0,K),Q=k.subarray(K,K*2);return new C(l.fromBytes(H),l.fromBytes(Q),q)}static fromHex(k,M){return this.fromBytes(hexToBytes$2(k),M)}addRecoveryBit(k){return new C(this.r,this.s,k)}recoverPublicKey(k){const M=a.ORDER,{r:q,s:K,recovery:H}=this;if(H==null||![0,1,2,3].includes(H))throw new Error("recovery id invalid");if(u*_2n$1<M&&H>1)throw new Error("recovery id is ambiguous for h>1 curve");const D=H===2||H===3?q+u:q;if(!a.isValid(D))throw new Error("recovery id 2 or 3 invalid");const Y=a.toBytes(D),J=e.fromBytes(concatBytes(pprefix((H&1)===0),Y)),L=l.inv(D),Z=T(ensureBytes("msgHash",k)),oe=l.create(-Z*L),ce=l.create(K*L),de=e.BASE.multiplyUnsafe(oe).add(J.multiplyUnsafe(ce));if(de.is0())throw new Error("point at infinify");return de.assertValidity(),de}hasHighS(){return B(this.s)}toBytes(k=v){if(validateSigFormat(k),k==="der")return hexToBytes$2(DER.hexFromSig(this));const M=l.toBytes(this.r),q=l.toBytes(this.s);if(k==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return concatBytes(Uint8Array.of(this.recovery),M,q)}return concatBytes(M,q)}toHex(k){return bytesToHex(this.toBytes(k))}assertValidity(){}static fromCompact(k){return C.fromBytes(ensureBytes("sig",k),"compact")}static fromDER(k){return C.fromBytes(ensureBytes("sig",k),"der")}normalizeS(){return this.hasHighS()?new C(this.r,l.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return bytesToHex(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return bytesToHex(this.toBytes("compact"))}}const N=r.bits2int||function(k){if(k.length>8192)throw new Error("input is too large");const M=bytesToNumberBE(k),q=k.length*8-f;return q>0?M>>BigInt(q):M},T=r.bits2int_modN||function(k){return l.create(N(k))},_=bitMask(f);function S(G){return aInRange("num < 2^"+f,G,_0n$1,_),l.toBytes(G)}function O(G,k){return _abytes2(G,void 0,"message"),k?_abytes2(t(G),void 0,"prehashed message"):G}function $(G,k,M){if(["recovered","canonical"].some(oe=>oe in M))throw new Error("sign() legacy options not supported");const{lowS:q,prehash:K,extraEntropy:H}=validateSigOpts(M,w);G=O(G,K);const Q=T(G),D=_normFnElement(l,k),Y=[S(D),S(Q)];if(H!=null&&H!==!1){const oe=H===!0?n(b.secretKey):H;Y.push(ensureBytes("extraEntropy",oe))}const J=concatBytes(...Y),L=Q;function Z(oe){const ce=N(oe);if(!l.isValidNot0(ce))return;const de=l.inv(ce),xe=e.BASE.multiply(ce).toAffine(),te=l.create(xe.x);if(te===_0n$1)return;const ae=l.create(de*l.create(L+te*D));if(ae===_0n$1)return;let le=(xe.x===te?0:2)|Number(xe.y&_1n$1),ue=ae;return q&&B(ae)&&(ue=l.neg(ae),le^=1),new C(te,ue,le)}return{seed:J,k2sig:Z}}function z(G,k,M={}){G=ensureBytes("message",G);const{seed:q,k2sig:K}=$(G,k,M);return createHmacDrbg(t.outputLen,l.BYTES,o)(q,K)}function W(G){let k;const M=typeof G=="string"||isBytes(G),q=!M&&G!==null&&typeof G=="object"&&typeof G.r=="bigint"&&typeof G.s=="bigint";if(!M&&!q)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(q)k=new C(G.r,G.s);else if(M){try{k=C.fromBytes(ensureBytes("sig",G),"der")}catch(K){if(!(K instanceof DER.Err))throw K}if(!k)try{k=C.fromBytes(ensureBytes("sig",G),"compact")}catch{return!1}}return k||!1}function U(G,k,M,q={}){const{lowS:K,prehash:H,format:Q}=validateSigOpts(q,w);if(M=ensureBytes("publicKey",M),k=O(ensureBytes("message",k),H),"strict"in q)throw new Error("options.strict was renamed to lowS");const D=Q===void 0?W(G):C.fromBytes(ensureBytes("sig",G),Q);if(D===!1)return!1;try{const Y=e.fromBytes(M);if(K&&D.hasHighS())return!1;const{r:J,s:L}=D,Z=T(k),oe=l.inv(L),ce=l.create(Z*oe),de=l.create(J*oe),xe=e.BASE.multiplyUnsafe(ce).add(Y.multiplyUnsafe(de));return xe.is0()?!1:l.create(xe.x)===J}catch{return!1}}function I(G,k,M={}){const{prehash:q}=validateSigOpts(M,w);return k=O(k,q),C.fromBytes(G,"recovered").recoverPublicKey(k).toBytes()}return Object.freeze({keygen:x,getPublicKey:p,getSharedSecret:g,utils:y,lengths:b,Point:e,sign:z,verify:U,recoverPublicKey:I,Signature:C,hash:t})}function _weierstrass_legacy_opts_to_new(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp;let n=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(l=>Math.ceil(l/2)))):void 0;const o=Field(t.n,{BITS:e.nBitLength,allowedLengths:n,modFromBytes:e.wrapPrivateKey}),a={Fp:r,Fn:o,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:a}}function _ecdsa_legacy_opts_to_new(e){const{CURVE:t,curveOpts:r}=_weierstrass_legacy_opts_to_new(e),n={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:n}}function _ecdsa_new_output_to_legacy(e,t){const r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,nLength(r.Fn.ORDER,r.Fn.BITS))})}function weierstrass$1(e){const{CURVE:t,curveOpts:r,hash:n,ecdsaOpts:o}=_ecdsa_legacy_opts_to_new(e),a=weierstrassN(t,r),l=ecdsa(a,n,o);return _ecdsa_new_output_to_legacy(e,l)}function createCurve(e,t){const r=n=>weierstrass$1({...e,hash:n});return{...r(t),create:r}}const secp256k1_CURVE={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2);function sqrtMod(e){const t=secp256k1_CURVE.p,r=BigInt(3),n=BigInt(6),o=BigInt(11),a=BigInt(22),l=BigInt(23),u=BigInt(44),f=BigInt(88),x=e*e*e%t,p=x*x*e%t,g=pow2(p,r,t)*p%t,y=pow2(g,r,t)*p%t,b=pow2(y,_2n,t)*x%t,w=pow2(b,o,t)*b%t,v=pow2(w,a,t)*w%t,B=pow2(v,u,t)*v%t,j=pow2(B,f,t)*B%t,F=pow2(j,u,t)*v%t,C=pow2(F,r,t)*p%t,N=pow2(C,l,t)*w%t,T=pow2(N,n,t)*x%t,_=pow2(T,_2n,t);if(!Fpk1.eql(Fpk1.sqr(_),e))throw new Error("Cannot find square root");return _}const Fpk1=Field(secp256k1_CURVE.p,{sqrt:sqrtMod}),secp256k1$1=createCurve({...secp256k1_CURVE,Fp:Fpk1,lowS:!0,endo:secp256k1_ENDO},sha256$1),TAGGED_HASH_PREFIXES$1={};function taggedHash$1(e,...t){let r=TAGGED_HASH_PREFIXES$1[e];if(r===void 0){const n=sha256$1(utf8ToBytes(e));r=concatBytes(n,n),TAGGED_HASH_PREFIXES$1[e]=r}return sha256$1(concatBytes(r,...t))}const pointToBytes=e=>e.toBytes(!0).slice(1),Pointk1=secp256k1$1.Point,hasEven=e=>e%_2n===_0n;function schnorrGetExtPubKey(e){const{Fn:t,BASE:r}=Pointk1,n=_normFnElement(t,e),o=r.multiply(n);return{scalar:hasEven(o.y)?n:t.neg(n),bytes:pointToBytes(o)}}function lift_x(e){const t=Fpk1;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x  p");const r=t.create(e*e),n=t.create(r*e+BigInt(7));let o=t.sqrt(n);hasEven(o)||(o=t.neg(o));const a=Pointk1.fromAffine({x:e,y:o});return a.assertValidity(),a}const num=bytesToNumberBE;function challenge(...e){return Pointk1.Fn.create(num(taggedHash$1("BIP0340/challenge",...e)))}function schnorrGetPublicKey(e){return schnorrGetExtPubKey(e).bytes}function schnorrSign(e,t,r=randomBytes(32)){const{Fn:n}=Pointk1,o=ensureBytes("message",e),{bytes:a,scalar:l}=schnorrGetExtPubKey(t),u=ensureBytes("auxRand",r,32),f=n.toBytes(l^num(taggedHash$1("BIP0340/aux",u))),x=taggedHash$1("BIP0340/nonce",f,a,o),{bytes:p,scalar:g}=schnorrGetExtPubKey(x),y=challenge(p,a,o),b=new Uint8Array(64);if(b.set(p,0),b.set(n.toBytes(n.create(g+y*l)),32),!schnorrVerify(b,o,a))throw new Error("sign: Invalid signature produced");return b}function schnorrVerify(e,t,r){const{Fn:n,BASE:o}=Pointk1,a=ensureBytes("signature",e,64),l=ensureBytes("message",t),u=ensureBytes("publicKey",r,32);try{const f=lift_x(num(u)),x=num(a.subarray(0,32));if(!inRange(x,_1n,secp256k1_CURVE.p))return!1;const p=num(a.subarray(32,64));if(!inRange(p,_1n,secp256k1_CURVE.n))return!1;const g=challenge(n.toBytes(x),pointToBytes(f),l),y=o.multiplyUnsafe(p).add(f.multiplyUnsafe(n.neg(g))),{x:b,y:w}=y.toAffine();return!(y.is0()||!hasEven(w)||b!==x)}catch{return!1}}const schnorr=(()=>{const r=(o=randomBytes(48))=>mapHashToField(o,secp256k1_CURVE.n);secp256k1$1.utils.randomSecretKey;function n(o){const a=r(o);return{secretKey:a,publicKey:schnorrGetPublicKey(a)}}return{keygen:n,getPublicKey:schnorrGetPublicKey,sign:schnorrSign,verify:schnorrVerify,Point:Pointk1,utils:{randomSecretKey:r,randomPrivateKey:r,taggedHash:taggedHash$1,lift_x,pointToBytes,numberToBytesBE,bytesToNumberBE,mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})(),sha256=sha256$1;var dist$2={},LRUCache={},LRUCacheNode={},hasRequiredLRUCacheNode;function requireLRUCacheNode(){if(hasRequiredLRUCacheNode)return LRUCacheNode;hasRequiredLRUCacheNode=1,Object.defineProperty(LRUCacheNode,"__esModule",{value:!0}),LRUCacheNode.LRUCacheNode=void 0;let e=class{constructor(r,n,o){const{entryExpirationTimeInMS:a=null,next:l=null,prev:u=null,onEntryEvicted:f,onEntryMarkedAsMostRecentlyUsed:x,clone:p,cloneFn:g}=o??{};if(typeof a=="number"&&(a<=0||Number.isNaN(a)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.clone=p??!1,this.cloneFn=g??this.defaultClone,this.key=r,this.internalValue=this.clone?this.cloneFn(n):n,this.created=Date.now(),this.entryExpirationTimeInMS=a,this.next=l,this.prev=u,this.onEntryEvicted=f,this.onEntryMarkedAsMostRecentlyUsed=x}get value(){return this.clone?this.cloneFn(this.internalValue):this.internalValue}get isExpired(){return typeof this.entryExpirationTimeInMS=="number"&&Date.now()-this.created>this.entryExpirationTimeInMS}invokeOnEvicted(){if(this.onEntryEvicted){const{key:r,value:n,isExpired:o}=this;this.onEntryEvicted({key:r,value:n,isExpired:o})}}invokeOnEntryMarkedAsMostRecentlyUsed(){if(this.onEntryMarkedAsMostRecentlyUsed){const{key:r,value:n}=this;this.onEntryMarkedAsMostRecentlyUsed({key:r,value:n})}}defaultClone(r){return typeof r=="boolean"||typeof r=="string"||typeof r=="number"?r:JSON.parse(JSON.stringify(r))}};return LRUCacheNode.LRUCacheNode=e,LRUCacheNode}var hasRequiredLRUCache;function requireLRUCache(){if(hasRequiredLRUCache)return LRUCache;hasRequiredLRUCache=1,Object.defineProperty(LRUCache,"__esModule",{value:!0}),LRUCache.LRUCache=void 0;const e=requireLRUCacheNode();let t=class{constructor(n){this.lookupTable=new Map,this.head=null,this.tail=null;const{maxSize:o=25,entryExpirationTimeInMS:a=null,onEntryEvicted:l,onEntryMarkedAsMostRecentlyUsed:u,cloneFn:f,clone:x}=n??{};if(Number.isNaN(o)||o<=0)throw new Error("maxSize must be greater than 0.");if(typeof a=="number"&&(a<=0||Number.isNaN(a)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.maxSizeInternal=o,this.entryExpirationTimeInMS=a,this.onEntryEvicted=l,this.onEntryMarkedAsMostRecentlyUsed=u,this.clone=x,this.cloneFn=f}get size(){return this.cleanCache(),this.lookupTable.size}get remainingSize(){return this.maxSizeInternal-this.size}get newest(){return this.head?this.head.isExpired?(this.removeNodeFromListAndLookupTable(this.head),this.newest):this.mapNodeToEntry(this.head):null}get oldest(){return this.tail?this.tail.isExpired?(this.removeNodeFromListAndLookupTable(this.tail),this.oldest):this.mapNodeToEntry(this.tail):null}get maxSize(){return this.maxSizeInternal}set maxSize(n){if(Number.isNaN(n)||n<=0)throw new Error("maxSize must be greater than 0.");this.maxSizeInternal=n,this.enforceSizeLimit()}set(n,o,a){const l=this.lookupTable.get(n);l&&this.removeNodeFromListAndLookupTable(l);const u=new e.LRUCacheNode(n,o,{entryExpirationTimeInMS:this.entryExpirationTimeInMS,onEntryEvicted:this.onEntryEvicted,onEntryMarkedAsMostRecentlyUsed:this.onEntryMarkedAsMostRecentlyUsed,clone:this.clone,cloneFn:this.cloneFn,...a});return this.setNodeAsHead(u),this.lookupTable.set(n,u),this.enforceSizeLimit(),this}get(n){const o=this.lookupTable.get(n);return o?o.isExpired?(this.removeNodeFromListAndLookupTable(o),null):(this.setNodeAsHead(o),o.value):null}peek(n){const o=this.lookupTable.get(n);return o?o.isExpired?(this.removeNodeFromListAndLookupTable(o),null):o.value:null}delete(n){const o=this.lookupTable.get(n);return o?this.removeNodeFromListAndLookupTable(o):!1}has(n){const o=this.lookupTable.get(n);return o?o.isExpired?(this.removeNodeFromListAndLookupTable(o),!1):!0:!1}clear(){this.head=null,this.tail=null,this.lookupTable.clear()}find(n){let o=this.head;for(;o;){if(o.isExpired){const l=o.next;this.removeNodeFromListAndLookupTable(o),o=l;continue}const a=this.mapNodeToEntry(o);if(n(a))return this.setNodeAsHead(o),a;o=o.next}return null}forEach(n){let o=this.head,a=0;for(;o;){if(o.isExpired){const l=o.next;this.removeNodeFromListAndLookupTable(o),o=l;continue}n(o.value,o.key,a),o=o.next,a++}}*values(){let n=this.head;for(;n;){if(n.isExpired){const o=n.next;this.removeNodeFromListAndLookupTable(n),n=o;continue}yield n.value,n=n.next}}*keys(){let n=this.head;for(;n;){if(n.isExpired){const o=n.next;this.removeNodeFromListAndLookupTable(n),n=o;continue}yield n.key,n=n.next}}*entries(){let n=this.head;for(;n;){if(n.isExpired){const o=n.next;this.removeNodeFromListAndLookupTable(n),n=o;continue}yield this.mapNodeToEntry(n),n=n.next}}*[Symbol.iterator](){let n=this.head;for(;n;){if(n.isExpired){const o=n.next;this.removeNodeFromListAndLookupTable(n),n=o;continue}yield this.mapNodeToEntry(n),n=n.next}}enforceSizeLimit(){let n=this.tail;for(;n!==null&&this.size>this.maxSizeInternal;){const o=n.prev;this.removeNodeFromListAndLookupTable(n),n=o}}mapNodeToEntry({key:n,value:o}){return{key:n,value:o}}setNodeAsHead(n){this.removeNodeFromList(n),this.head?(n.next=this.head,this.head.prev=n,this.head=n):(this.head=n,this.tail=n),n.invokeOnEntryMarkedAsMostRecentlyUsed()}removeNodeFromList(n){n.prev!==null&&(n.prev.next=n.next),n.next!==null&&(n.next.prev=n.prev),this.head===n&&(this.head=n.next),this.tail===n&&(this.tail=n.prev),n.next=null,n.prev=null}removeNodeFromListAndLookupTable(n){return n.invokeOnEvicted(),this.removeNodeFromList(n),this.lookupTable.delete(n.key)}cleanCache(){if(!this.entryExpirationTimeInMS)return;const n=[];for(const o of this.lookupTable.values())o.isExpired&&n.push(o);n.forEach(o=>this.removeNodeFromListAndLookupTable(o))}};return LRUCache.LRUCache=t,LRUCache}var hasRequiredDist$2;function requireDist$2(){return hasRequiredDist$2||(hasRequiredDist$2=1,(function(e){var t=dist$2&&dist$2.__createBinding||(Object.create?(function(n,o,a,l){l===void 0&&(l=a);var u=Object.getOwnPropertyDescriptor(o,a);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[a]}}),Object.defineProperty(n,l,u)}):(function(n,o,a,l){l===void 0&&(l=a),n[l]=o[a]})),r=dist$2&&dist$2.__exportStar||function(n,o){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&t(o,n,a)};Object.defineProperty(e,"__esModule",{value:!0}),r(requireLRUCache(),e)})(dist$2)),dist$2}var distExports$2=requireDist$2();function pbkdf2Init(e,t,r,n){assert$3.hash(e);const o=checkOpts$1({dkLen:32,asyncTick:10},n),{c:a,dkLen:l,asyncTick:u}=o;if(assert$3.number(a),assert$3.number(l),assert$3.number(u),a<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const f=toBytes$2(t),x=toBytes$2(r),p=new Uint8Array(l),g=hmac$2.create(e,f),y=g._cloneInto().update(x);return{c:a,dkLen:l,asyncTick:u,DK:p,PRF:g,PRFSalt:y}}function pbkdf2Output(e,t,r,n,o){return e.destroy(),t.destroy(),n&&n.destroy(),o.fill(0),r}function pbkdf2(e,t,r,n){const{c:o,dkLen:a,DK:l,PRF:u,PRFSalt:f}=pbkdf2Init(e,t,r,n);let x;const p=new Uint8Array(4),g=createView$2(p),y=new Uint8Array(u.outputLen);for(let b=1,w=0;w<a;b++,w+=u.outputLen){const v=l.subarray(w,w+u.outputLen);g.setInt32(0,b,!1),(x=f._cloneInto(x)).update(p).digestInto(y),v.set(y.subarray(0,v.length));for(let B=1;B<o;B++){u._cloneInto(x).update(y).digestInto(y);for(let j=0;j<v.length;j++)v[j]^=y[j]}}return pbkdf2Output(u,f,l,x,y)}const rotl=(e,t)=>e<<t|e>>>32-t;function XorAndSalsa(e,t,r,n,o,a){let l=e[t++]^r[n++],u=e[t++]^r[n++],f=e[t++]^r[n++],x=e[t++]^r[n++],p=e[t++]^r[n++],g=e[t++]^r[n++],y=e[t++]^r[n++],b=e[t++]^r[n++],w=e[t++]^r[n++],v=e[t++]^r[n++],B=e[t++]^r[n++],j=e[t++]^r[n++],F=e[t++]^r[n++],C=e[t++]^r[n++],N=e[t++]^r[n++],T=e[t++]^r[n++],_=l,S=u,O=f,$=x,z=p,W=g,U=y,I=b,G=w,k=v,M=B,q=j,K=F,H=C,Q=N,D=T;for(let Y=0;Y<8;Y+=2)z^=rotl(_+K|0,7),G^=rotl(z+_|0,9),K^=rotl(G+z|0,13),_^=rotl(K+G|0,18),k^=rotl(W+S|0,7),H^=rotl(k+W|0,9),S^=rotl(H+k|0,13),W^=rotl(S+H|0,18),Q^=rotl(M+U|0,7),O^=rotl(Q+M|0,9),U^=rotl(O+Q|0,13),M^=rotl(U+O|0,18),$^=rotl(D+q|0,7),I^=rotl($+D|0,9),q^=rotl(I+$|0,13),D^=rotl(q+I|0,18),S^=rotl(_+$|0,7),O^=rotl(S+_|0,9),$^=rotl(O+S|0,13),_^=rotl($+O|0,18),U^=rotl(W+z|0,7),I^=rotl(U+W|0,9),z^=rotl(I+U|0,13),W^=rotl(z+I|0,18),q^=rotl(M+k|0,7),G^=rotl(q+M|0,9),k^=rotl(G+q|0,13),M^=rotl(k+G|0,18),K^=rotl(D+Q|0,7),H^=rotl(K+D|0,9),Q^=rotl(H+K|0,13),D^=rotl(Q+H|0,18);o[a++]=l+_|0,o[a++]=u+S|0,o[a++]=f+O|0,o[a++]=x+$|0,o[a++]=p+z|0,o[a++]=g+W|0,o[a++]=y+U|0,o[a++]=b+I|0,o[a++]=w+G|0,o[a++]=v+k|0,o[a++]=B+M|0,o[a++]=j+q|0,o[a++]=F+K|0,o[a++]=C+H|0,o[a++]=N+Q|0,o[a++]=T+D|0}function BlockMix(e,t,r,n,o){let a=n+0,l=n+16*o;for(let u=0;u<16;u++)r[l+u]=e[t+(2*o-1)*16+u];for(let u=0;u<o;u++,a+=16,t+=16)XorAndSalsa(r,l,e,t,r,a),u>0&&(l+=16),XorAndSalsa(r,a,e,t+=16,r,l)}function scryptInit(e,t,r){const n=checkOpts$1({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:o,r:a,p:l,dkLen:u,asyncTick:f,maxmem:x,onProgress:p}=n;if(assert$3.number(o),assert$3.number(a),assert$3.number(l),assert$3.number(u),assert$3.number(f),assert$3.number(x),p!==void 0&&typeof p!="function")throw new Error("progressCb should be function");const g=128*a,y=g/4;if(o<=1||(o&o-1)!==0||o>=2**(g/8)||o>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(l<0||l>(2**32-1)*32/g)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(u<0||u>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const b=g*(o+l);if(b>x)throw new Error(`Scrypt: parameters too large, ${b} (128 * r * (N + p)) > ${x} (maxmem)`);const w=pbkdf2(sha256$3,e,t,{c:1,dkLen:g*l}),v=u32$1(w),B=u32$1(new Uint8Array(g*o)),j=u32$1(new Uint8Array(g));let F=()=>{};if(p){const C=2*o*l,N=Math.max(Math.floor(C/1e4),1);let T=0;F=()=>{T++,p&&(!(T%N)||T===C)&&p(T/C)}}return{N:o,r:a,p:l,dkLen:u,blockSize32:y,V:B,B32:v,B:w,tmp:j,blockMixCb:F,asyncTick:f}}function scryptOutput(e,t,r,n,o){const a=pbkdf2(sha256$3,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),o.fill(0),a}function scrypt(e,t,r){const{N:n,r:o,p:a,dkLen:l,blockSize32:u,V:f,B32:x,B:p,tmp:g,blockMixCb:y}=scryptInit(e,t,r);for(let b=0;b<a;b++){const w=u*b;for(let v=0;v<u;v++)f[v]=x[w+v];for(let v=0,B=0;v<n-1;v++)BlockMix(f,B,f,B+=u,o),y();BlockMix(f,(n-1)*u,x,w,o),y();for(let v=0;v<n;v++){const B=x[w+u-16]%n;for(let j=0;j<u;j++)g[j]=x[w+j]^f[B*u+j];BlockMix(g,0,x,w,o),y()}}return scryptOutput(e,l,p,f,g)}var Bech32MaxSize$1=5e3;function encodeBech32$1(e,t){let r=bech32.toWords(t);return bech32.encode(e,r,Bech32MaxSize$1)}function encodeBytes$1(e,t){return encodeBech32$1(e,t)}function encrypt$1(e,t,r=16,n=2){let o=randomBytes$1(16),a=2**r,l=scrypt(t.normalize("NFKC"),o,{N:a,r:8,p:1,dkLen:32}),u=randomBytes$1(24),f=Uint8Array.from([n]),p=xchacha20poly1305(l,u,f).encrypt(e),g=concatBytes$1(Uint8Array.from([2]),Uint8Array.from([r]),o,u,f,p);return encodeBytes$1("ncryptsec",g)}function decrypt$1(e,t){let{prefix:r,words:n}=bech32.decode(e,Bech32MaxSize$1);if(r!=="ncryptsec")throw new Error(`invalid prefix ${r}, expected 'ncryptsec'`);let o=new Uint8Array(bech32.fromWords(n)),a=o[0];if(a!==2)throw new Error(`invalid version ${a}, expected 0x02`);let u=2**o[1],f=o.slice(2,18),x=o.slice(18,42),p=o[42],g=Uint8Array.from([p]),y=o.slice(43),b=scrypt(t.normalize("NFKC"),f,{N:u,r:8,p:1,dkLen:32});return xchacha20poly1305(b,x,g).decrypt(y)}const nip49_star=Object.freeze(Object.defineProperty({__proto__:null,decrypt:decrypt$1,encrypt:encrypt$1},Symbol.toStringTag,{value:"Module"}));var utf8Decoder=new TextDecoder("utf-8"),utf8Encoder=new TextEncoder,NostrTypeGuard={isNProfile:e=>/^nprofile1[a-z\d]+$/.test(e||""),isNEvent:e=>/^nevent1[a-z\d]+$/.test(e||""),isNAddr:e=>/^naddr1[a-z\d]+$/.test(e||""),isNSec:e=>/^nsec1[a-z\d]{58}$/.test(e||""),isNPub:e=>/^npub1[a-z\d]{58}$/.test(e||""),isNote:e=>/^note1[a-z\d]+$/.test(e||""),isNcryptsec:e=>/^ncryptsec1[a-z\d]+$/.test(e||"")},Bech32MaxSize=5e3,BECH32_REGEX$1=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function decodeNostrURI(e){try{return e.startsWith("nostr:")&&(e=e.substring(6)),decode$i(e)}catch{return{type:"invalid",data:null}}}function decode$i(e){let{prefix:t,words:r}=bech32.decode(e,Bech32MaxSize),n=new Uint8Array(bech32.fromWords(r));switch(t){case"nprofile":{let o=parseTLV(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$2(o[0][0]),relays:o[1]?o[1].map(a=>utf8Decoder.decode(a)):[]}}}case"nevent":{let o=parseTLV(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$2(o[0][0]),relays:o[1]?o[1].map(a=>utf8Decoder.decode(a)):[],author:o[2]?.[0]?bytesToHex$2(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(bytesToHex$2(o[3][0]),16):void 0}}}case"naddr":{let o=parseTLV(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder.decode(o[0][0]),pubkey:bytesToHex$2(o[2][0]),kind:parseInt(bytesToHex$2(o[3][0]),16),relays:o[1]?o[1].map(a=>utf8Decoder.decode(a)):[]}}}case"nsec":return{type:t,data:n};case"npub":case"note":return{type:t,data:bytesToHex$2(n)};default:throw new Error(`unknown prefix ${t}`)}}function parseTLV(e){let t={},r=e;for(;r.length>0;){let n=r[0],o=r[1],a=r.slice(2,2+o);if(r=r.slice(2+o),a.length<o)throw new Error(`not enough data to read on TLV ${n}`);t[n]=t[n]||[],t[n].push(a)}return t}function nsecEncode(e){return encodeBytes("nsec",e)}function npubEncode(e){return encodeBytes("npub",hexToBytes$4(e))}function noteEncode(e){return encodeBytes("note",hexToBytes$4(e))}function encodeBech32(e,t){let r=bech32.toWords(t);return bech32.encode(e,r,Bech32MaxSize)}function encodeBytes(e,t){return encodeBech32(e,t)}function nprofileEncode(e){let t=encodeTLV({0:[hexToBytes$4(e.pubkey)],1:(e.relays||[]).map(r=>utf8Encoder.encode(r))});return encodeBech32("nprofile",t)}function neventEncode(e){let t;e.kind!==void 0&&(t=integerToUint8Array(e.kind));let r=encodeTLV({0:[hexToBytes$4(e.id)],1:(e.relays||[]).map(n=>utf8Encoder.encode(n)),2:e.author?[hexToBytes$4(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return encodeBech32("nevent",r)}function naddrEncode(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let r=encodeTLV({0:[utf8Encoder.encode(e.identifier)],1:(e.relays||[]).map(n=>utf8Encoder.encode(n)),2:[hexToBytes$4(e.pubkey)],3:[new Uint8Array(t)]});return encodeBech32("naddr",r)}function encodeTLV(e){let t=[];return Object.entries(e).reverse().forEach(([r,n])=>{n.forEach(o=>{let a=new Uint8Array(o.length+2);a.set([parseInt(r)],0),a.set([o.length],1),a.set(o,2),t.push(a)})}),concatBytes$1(...t)}const nip19_star=Object.freeze(Object.defineProperty({__proto__:null,BECH32_REGEX:BECH32_REGEX$1,Bech32MaxSize,NostrTypeGuard,decode:decode$i,decodeNostrURI,encodeBytes,naddrEncode,neventEncode,noteEncode,nprofileEncode,npubEncode,nsecEncode},Symbol.toStringTag,{value:"Module"}));var lib={},hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0;function t(W){if(!Number.isSafeInteger(W))throw new Error(`Wrong integer: ${W}`)}e.assertNumber=t;function r(...W){const U=(k,M)=>q=>k(M(q)),I=Array.from(W).reverse().reduce((k,M)=>k?U(k,M.encode):M.encode,void 0),G=W.reduce((k,M)=>k?U(k,M.decode):M.decode,void 0);return{encode:I,decode:G}}function n(W){return{encode:U=>{if(!Array.isArray(U)||U.length&&typeof U[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return U.map(I=>{if(t(I),I<0||I>=W.length)throw new Error(`Digit index outside alphabet: ${I} (alphabet: ${W.length})`);return W[I]})},decode:U=>{if(!Array.isArray(U)||U.length&&typeof U[0]!="string")throw new Error("alphabet.decode input should be array of strings");return U.map(I=>{if(typeof I!="string")throw new Error(`alphabet.decode: not string element=${I}`);const G=W.indexOf(I);if(G===-1)throw new Error(`Unknown letter: "${I}". Allowed: ${W}`);return G})}}}function o(W=""){if(typeof W!="string")throw new Error("join separator should be string");return{encode:U=>{if(!Array.isArray(U)||U.length&&typeof U[0]!="string")throw new Error("join.encode input should be array of strings");for(let I of U)if(typeof I!="string")throw new Error(`join.encode: non-string input=${I}`);return U.join(W)},decode:U=>{if(typeof U!="string")throw new Error("join.decode input should be string");return U.split(W)}}}function a(W,U="="){if(t(W),typeof U!="string")throw new Error("padding chr should be string");return{encode(I){if(!Array.isArray(I)||I.length&&typeof I[0]!="string")throw new Error("padding.encode input should be array of strings");for(let G of I)if(typeof G!="string")throw new Error(`padding.encode: non-string input=${G}`);for(;I.length*W%8;)I.push(U);return I},decode(I){if(!Array.isArray(I)||I.length&&typeof I[0]!="string")throw new Error("padding.encode input should be array of strings");for(let k of I)if(typeof k!="string")throw new Error(`padding.decode: non-string input=${k}`);let G=I.length;if(G*W%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;G>0&&I[G-1]===U;G--)if(!((G-1)*W%8))throw new Error("Invalid padding: string has too much padding");return I.slice(0,G)}}}function l(W){if(typeof W!="function")throw new Error("normalize fn should be function");return{encode:U=>U,decode:U=>W(U)}}function u(W,U,I){if(U<2)throw new Error(`convertRadix: wrong from=${U}, base cannot be less than 2`);if(I<2)throw new Error(`convertRadix: wrong to=${I}, base cannot be less than 2`);if(!Array.isArray(W))throw new Error("convertRadix: data should be array");if(!W.length)return[];let G=0;const k=[],M=Array.from(W);for(M.forEach(q=>{if(t(q),q<0||q>=U)throw new Error(`Wrong integer: ${q}`)});;){let q=0,K=!0;for(let H=G;H<M.length;H++){const Q=M[H],D=U*q+Q;if(!Number.isSafeInteger(D)||U*q/U!==q||D-Q!==U*q)throw new Error("convertRadix: carry overflow");if(q=D%I,M[H]=Math.floor(D/I),!Number.isSafeInteger(M[H])||M[H]*I+q!==D)throw new Error("convertRadix: carry overflow");if(K)M[H]?K=!1:G=H;else continue}if(k.push(q),K)break}for(let q=0;q<W.length-1&&W[q]===0;q++)k.push(0);return k.reverse()}const f=(W,U)=>U?f(U,W%U):W,x=(W,U)=>W+(U-f(W,U));function p(W,U,I,G){if(!Array.isArray(W))throw new Error("convertRadix2: data should be array");if(U<=0||U>32)throw new Error(`convertRadix2: wrong from=${U}`);if(I<=0||I>32)throw new Error(`convertRadix2: wrong to=${I}`);if(x(U,I)>32)throw new Error(`convertRadix2: carry overflow from=${U} to=${I} carryBits=${x(U,I)}`);let k=0,M=0;const q=2**I-1,K=[];for(const H of W){if(t(H),H>=2**U)throw new Error(`convertRadix2: invalid data word=${H} from=${U}`);if(k=k<<U|H,M+U>32)throw new Error(`convertRadix2: carry overflow pos=${M} from=${U}`);for(M+=U;M>=I;M-=I)K.push((k>>M-I&q)>>>0);k&=2**M-1}if(k=k<<I-M&q,!G&&M>=U)throw new Error("Excess padding");if(!G&&k)throw new Error(`Non-zero padding: ${k}`);return G&&M>0&&K.push(k>>>0),K}function g(W){return t(W),{encode:U=>{if(!(U instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return u(Array.from(U),2**8,W)},decode:U=>{if(!Array.isArray(U)||U.length&&typeof U[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(u(U,W,2**8))}}}function y(W,U=!1){if(t(W),W<=0||W>32)throw new Error("radix2: bits should be in (0..32]");if(x(8,W)>32||x(W,8)>32)throw new Error("radix2: carry overflow");return{encode:I=>{if(!(I instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return p(Array.from(I),8,W,!U)},decode:I=>{if(!Array.isArray(I)||I.length&&typeof I[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(p(I,W,8,U))}}}function b(W){if(typeof W!="function")throw new Error("unsafeWrapper fn should be function");return function(...U){try{return W.apply(null,U)}catch{}}}function w(W,U){if(t(W),typeof U!="function")throw new Error("checksum fn should be function");return{encode(I){if(!(I instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const G=U(I).slice(0,W),k=new Uint8Array(I.length+W);return k.set(I),k.set(G,I.length),k},decode(I){if(!(I instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const G=I.slice(0,-W),k=U(G).slice(0,W),M=I.slice(-W);for(let q=0;q<W;q++)if(k[q]!==M[q])throw new Error("Invalid checksum");return G}}}e.utils={alphabet:n,chain:r,checksum:w,radix:g,radix2:y,join:o,padding:a},e.base16=r(y(4),n("0123456789ABCDEF"),o("")),e.base32=r(y(5),n("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),a(5),o("")),e.base32hex=r(y(5),n("0123456789ABCDEFGHIJKLMNOPQRSTUV"),a(5),o("")),e.base32crockford=r(y(5),n("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),o(""),l(W=>W.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),e.base64=r(y(6),n("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),a(6),o("")),e.base64url=r(y(6),n("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),a(6),o(""));const v=W=>r(g(58),n(W),o(""));e.base58=v("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=v("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=v("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const B=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(W){let U="";for(let I=0;I<W.length;I+=8){const G=W.subarray(I,I+8);U+=e.base58.encode(G).padStart(B[G.length],"1")}return U},decode(W){let U=[];for(let I=0;I<W.length;I+=11){const G=W.slice(I,I+11),k=B.indexOf(G.length),M=e.base58.decode(G);for(let q=0;q<M.length-k;q++)if(M[q]!==0)throw new Error("base58xmr: wrong padding");U=U.concat(Array.from(M.slice(M.length-k)))}return Uint8Array.from(U)}};const j=W=>r(w(4,U=>W(W(U))),e.base58);e.base58check=j;const F=r(n("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),o("")),C=[996825010,642813549,513874426,1027748829,705979059];function N(W){const U=W>>25;let I=(W&33554431)<<5;for(let G=0;G<C.length;G++)(U>>G&1)===1&&(I^=C[G]);return I}function T(W,U,I=1){const G=W.length;let k=1;for(let M=0;M<G;M++){const q=W.charCodeAt(M);if(q<33||q>126)throw new Error(`Invalid prefix (${W})`);k=N(k)^q>>5}k=N(k);for(let M=0;M<G;M++)k=N(k)^W.charCodeAt(M)&31;for(let M of U)k=N(k)^M;for(let M=0;M<6;M++)k=N(k);return k^=I,F.encode(p([k%2**30],30,5,!1))}function _(W){const U=W==="bech32"?1:734539939,I=y(5),G=I.decode,k=I.encode,M=b(G);function q(D,Y,J=90){if(typeof D!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof D}`);if(!Array.isArray(Y)||Y.length&&typeof Y[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof Y}`);const L=D.length+7+Y.length;if(J!==!1&&L>J)throw new TypeError(`Length ${L} exceeds limit ${J}`);return D=D.toLowerCase(),`${D}1${F.encode(Y)}${T(D,Y,U)}`}function K(D,Y=90){if(typeof D!="string")throw new Error(`bech32.decode input should be string, not ${typeof D}`);if(D.length<8||Y!==!1&&D.length>Y)throw new TypeError(`Wrong string length: ${D.length} (${D}). Expected (8..${Y})`);const J=D.toLowerCase();if(D!==J&&D!==D.toUpperCase())throw new Error("String must be lowercase or uppercase");D=J;const L=D.lastIndexOf("1");if(L===0||L===-1)throw new Error('Letter "1" must be present between prefix and data only');const Z=D.slice(0,L),oe=D.slice(L+1);if(oe.length<6)throw new Error("Data must be at least 6 characters long");const ce=F.decode(oe).slice(0,-6),de=T(Z,ce,U);if(!oe.endsWith(de))throw new Error(`Invalid checksum in ${D}: expected "${de}"`);return{prefix:Z,words:ce}}const H=b(K);function Q(D){const{prefix:Y,words:J}=K(D,!1);return{prefix:Y,words:J,bytes:G(J)}}return{encode:q,decode:K,decodeToBytes:Q,decodeUnsafe:H,fromWords:G,fromWordsUnsafe:M,toWords:k}}e.bech32=_("bech32"),e.bech32m=_("bech32m"),e.utf8={encode:W=>new TextDecoder().decode(W),decode:W=>new TextEncoder().encode(W)},e.hex=r(y(4),n("0123456789abcdef"),o(""),l(W=>{if(typeof W!="string"||W.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof W} with length ${W.length}`);return W.toLowerCase()}));const S={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},O=`Invalid encoding type. Available types: ${Object.keys(S).join(", ")}`,$=(W,U)=>{if(typeof W!="string"||!S.hasOwnProperty(W))throw new TypeError(O);if(!(U instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return S[W].encode(U)};e.bytesToString=$,e.str=e.bytesToString;const z=(W,U)=>{if(!S.hasOwnProperty(W))throw new TypeError(O);if(typeof U!="string")throw new TypeError("stringToBytes() expects string");return S[W].decode(U)};e.stringToBytes=z,e.bytes=e.stringToBytes})(lib)),lib}var bolt11,hasRequiredBolt11;function requireBolt11(){if(hasRequiredBolt11)return bolt11;hasRequiredBolt11=1;const{bech32:e,hex:t,utf8:r}=requireLib(),n={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},o={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},a={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},l={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},u={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},f=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],x={m:BigInt(1e3),u:BigInt(1e6),n:BigInt(1e9),p:BigInt(1e12)},p=BigInt("2100000000000000000"),g=BigInt(1e11),y={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},b={};for(let T=0,_=Object.keys(y);T<_.length;T++){const S=_[T],O=y[_[T]].toString();b[O]=S}const w={1:T=>t.encode(e.fromWordsUnsafe(T)),16:T=>t.encode(e.fromWordsUnsafe(T)),13:T=>r.encode(e.fromWordsUnsafe(T)),19:T=>t.encode(e.fromWordsUnsafe(T)),23:T=>t.encode(e.fromWordsUnsafe(T)),27:T=>t.encode(e.fromWordsUnsafe(T)),6:B,24:B,3:j,5:F};function v(T){return _=>({tagCode:parseInt(T),words:e.encode("unknown",_,Number.MAX_SAFE_INTEGER)})}function B(T){return T.reverse().reduce((_,S,O)=>_+S*Math.pow(32,O),0)}function j(T){const _=[];let S,O,$,z,W,U=e.fromWordsUnsafe(T);for(;U.length>0;)S=t.encode(U.slice(0,33)),O=t.encode(U.slice(33,41)),$=parseInt(t.encode(U.slice(41,45)),16),z=parseInt(t.encode(U.slice(45,49)),16),W=parseInt(t.encode(U.slice(49,51)),16),U=U.slice(51),_.push({pubkey:S,short_channel_id:O,fee_base_msat:$,fee_proportional_millionths:z,cltv_expiry_delta:W});return _}function F(T){const _=T.slice().reverse().map($=>[!!($&1),!!($&2),!!($&4),!!($&8),!!($&16)]).reduce(($,z)=>$.concat(z),[]);for(;_.length<f.length*2;)_.push(!1);const S={};f.forEach(($,z)=>{let W;_[z*2]?W="required":_[z*2+1]?W="supported":W="unsupported",S[$]=W});const O=_.slice(f.length*2);return S.extra_bits={start_bit:f.length*2,bits:O,has_required:O.reduce(($,z,W)=>W%2!==0?$||!1:$||z,!1)},S}function C(T,_){let S,O;if(T.slice(-1).match(/^[munp]$/))S=T.slice(-1),O=T.slice(0,-1);else{if(T.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");O=T}if(!O.match(/^\d+$/))throw new Error("Not a valid human readable amount");const $=BigInt(O),z=S?$*g/x[S]:$*g;if(S==="p"&&$%BigInt(10)!==BigInt(0)||z>p)throw new Error("Amount is outside of valid range");return _?z.toString():z}function N(T,_){if(typeof T!="string")throw new Error("Lightning Payment Request must be string");if(T.slice(0,2).toLowerCase()!=="ln")throw new Error("Not a proper lightning payment request");const S=[],O=e.decode(T,Number.MAX_SAFE_INTEGER);T=T.toLowerCase();const $=O.prefix;let z=O.words,W=T.slice($.length+1),U=z.slice(-104);z=z.slice(0,-104);let I=$.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(I&&!I[2]&&(I=$.match(/^ln(\S+)$/)),!I)throw new Error("Not a proper lightning payment request");S.push({name:"lightning_network",letters:"ln"});const G=I[1];let k;if(_){if(_.bech32===void 0||_.pubKeyHash===void 0||_.scriptHash===void 0||!Array.isArray(_.validWitnessVersions))throw new Error("Invalid network");k=_}else switch(G){case n.bech32:k=n;break;case o.bech32:k=o;break;case a.bech32:k=a;break;case l.bech32:k=l;break;case u.bech32:k=u;break}if(!k||k.bech32!==G)throw new Error("Unknown coin bech32 prefix");S.push({name:"coin_network",letters:G,value:k});const M=I[2];let q;if(M){const Z=I[3];q=C(M+Z,!0),S.push({name:"amount",letters:I[2]+I[3],value:q})}else q=null;S.push({name:"separator",letters:"1"});const K=B(z.slice(0,7));z=z.slice(7),S.push({name:"timestamp",letters:W.slice(0,7),value:K}),W=W.slice(7);let H,Q,D,Y;for(;z.length>0;){const Z=z[0].toString();H=b[Z]||"unknown_tag",Q=w[Z]||v(Z),z=z.slice(1),D=B(z.slice(0,2)),z=z.slice(2),Y=z.slice(0,D),z=z.slice(D),S.push({name:H,tag:W[0],letters:W.slice(0,3+D),value:Q(Y)}),W=W.slice(3+D)}S.push({name:"signature",letters:W.slice(0,104),value:t.encode(e.fromWordsUnsafe(U))}),W=W.slice(104),S.push({name:"checksum",letters:W});let J={paymentRequest:T,sections:S,get expiry(){let Z=S.find(oe=>oe.name==="expiry");if(Z)return L("timestamp")+Z.value},get route_hints(){return S.filter(Z=>Z.name==="route_hint").map(Z=>Z.value)}};for(let Z in y)Z!=="route_hint"&&Object.defineProperty(J,Z,{get(){return L(Z)}});return J;function L(Z){let oe=S.find(ce=>ce.name===Z);return oe?oe.value:void 0}}return bolt11={decode:N,hrpToMillisat:C},bolt11}requireBolt11();var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__copyProps=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of __getOwnPropNames(t))!__hasOwnProp.call(e,o)&&o!==r&&__defProp(e,o,{get:()=>t[o],enumerable:!(n=__getOwnPropDesc(t,o))||n.enumerable});return e},__reExport=(e,t,r)=>(__copyProps(e,t,"default"),r);function getRelaysForSync(e,t,r="write"){if(!e.outboxTracker)return;const n=e.outboxTracker.data.get(t);if(n)return r==="write"?n.writeRelays:n.readRelays}async function getWriteRelaysFor(e,t,r="write"){if(e.outboxTracker)return e.outboxTracker.data.has(t)||await e.outboxTracker.trackUsers([t]),getRelaysForSync(e,t,r)}function getTopRelaysForAuthors(e,t){const r=new Map;return t.forEach(o=>{const a=getRelaysForSync(e,o);a&&a.forEach(l=>{const u=r.get(l)||0;r.set(l,u+1)})}),Array.from(r.entries()).sort((o,a)=>a[1]-o[1]).map(o=>o[0])}function getAllRelaysForAllPubkeys(e,t,r="read"){const n=new Map,o=new Set;return t.forEach(a=>{const l=getRelaysForSync(e,a,r);l&&l.size>0?(l.forEach(u=>{(n.get(u)||new Set).add(a)}),n.set(a,l)):o.add(a)}),{pubkeysToRelays:n,authorsMissingRelays:o}}function chooseRelayCombinationForPubkeys(e,t,r,{count:n,preferredRelays:o}={}){n??=2,o??=new Set;const a=e.pool,l=a.connectedRelays();l.forEach(y=>{o?.add(y.url)});const u=new Map,{pubkeysToRelays:f,authorsMissingRelays:x}=getAllRelaysForAllPubkeys(e,t,r),p=getTopRelaysForAuthors(e,t),g=(y,b)=>{const w=u.get(b)||[];w.push(y),u.set(b,w)};for(const[y,b]of f.entries()){let w=n;const v=new Set;for(const B of l)b.has(B.url)&&(g(y,B.url),v.add(B.url),w--);for(const B of b)v.has(B)||u.has(B)&&(g(y,B),v.add(B),w--);if(!(w<=0))for(const B of p){if(w<=0)break;v.has(B)||b.has(B)&&(g(y,B),v.add(B),w--)}}for(const y of x)a.permanentAndConnectedRelays().forEach(b=>{const w=u.get(b.url)||[];w.push(y),u.set(b.url,w)});return u}function getRelaysForFilterWithAuthors(e,t,r=2){return chooseRelayCombinationForPubkeys(e,t,"write",{count:r})}function tryNormalizeRelayUrl(e){try{return normalizeRelayUrl(e)}catch{return}}function normalizeRelayUrl(e){let t=normalizeUrl(e,{stripAuthentication:!1,stripWWW:!1,stripHash:!0});return t.endsWith("/")||(t+="/"),t}function normalize(e){const t=new Set;for(const r of e)try{t.add(normalizeRelayUrl(r))}catch{}return Array.from(t)}var DATA_URL_DEFAULT_MIME_TYPE="text/plain",DATA_URL_DEFAULT_CHARSET="us-ascii",testParameter=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),supportedProtocols=new Set(["https:","http:","file:"]),hasCustomProtocol=e=>{try{const{protocol:t}=new URL(e);return t.endsWith(":")&&!t.includes(".")&&!supportedProtocols.has(t)}catch{return!1}},normalizeDataURL=(e,{stripHash:t})=>{const r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);const n=r.groups?.type??"",o=r.groups?.data??"";let a=r.groups?.hash??"";const l=n.split(";");a=t?"":a;let u=!1;l[l.length-1]==="base64"&&(l.pop(),u=!0);const f=l.shift()?.toLowerCase()??"",p=[...l.map(g=>{let[y,b=""]=g.split("=").map(w=>w.trim());return y==="charset"&&(b=b.toLowerCase(),b===DATA_URL_DEFAULT_CHARSET)?"":`${y}${b?`=${b}`:""}`}).filter(Boolean)];return u&&p.push("base64"),(p.length>0||f&&f!==DATA_URL_DEFAULT_MIME_TYPE)&&p.unshift(f),`data:${p.join(";")},${u?o.trim():o}${a?`#${a}`:""}`};function normalizeUrl(e,t={}){if(t={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...t},typeof t.defaultProtocol=="string"&&!t.defaultProtocol.endsWith(":")&&(t.defaultProtocol=`${t.defaultProtocol}:`),e=e.trim(),/^data:/i.test(e))return normalizeDataURL(e,t);if(hasCustomProtocol(e))return e;const r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));const o=new URL(e);if(o.hostname=o.hostname.toLowerCase(),t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&o.protocol==="https:"&&(o.protocol="http:"),t.forceHttps&&o.protocol==="http:"&&(o.protocol="https:"),t.stripAuthentication&&(o.username="",o.password=""),t.stripHash?o.hash="":t.stripTextFragment&&(o.hash=o.hash.replace(/#?:~:text.*?$/i,"")),o.pathname){const l=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let u=0,f="";for(;;){const p=l.exec(o.pathname);if(!p)break;const g=p[0],y=p.index,b=o.pathname.slice(u,y);f+=b.replace(/\/{2,}/g,"/"),f+=g,u=y+g.length}const x=o.pathname.slice(u,o.pathname.length);f+=x.replace(/\/{2,}/g,"/"),o.pathname=f}if(o.pathname)try{o.pathname=decodeURI(o.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let l=o.pathname.split("/");const u=l[l.length-1];testParameter(u,t.removeDirectoryIndex)&&(l=l.slice(0,-1),o.pathname=`${l.slice(1).join("/")}/`)}if(o.hostname&&(o.hostname=o.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(o.hostname)&&(o.hostname=o.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(const l of[...o.searchParams.keys()])testParameter(l,t.removeQueryParameters)&&o.searchParams.delete(l);if(!Array.isArray(t.keepQueryParameters)&&t.removeQueryParameters===!0&&(o.search=""),Array.isArray(t.keepQueryParameters)&&t.keepQueryParameters.length>0)for(const l of[...o.searchParams.keys()])testParameter(l,t.keepQueryParameters)||o.searchParams.delete(l);if(t.sortQueryParameters){o.searchParams.sort();try{o.search=decodeURIComponent(o.search)}catch{}}t.removeTrailingSlash&&(o.pathname=o.pathname.replace(/\/$/,"")),t.removeExplicitPort&&o.port&&(o.port="");const a=e;return e=o.toString(),!t.removeSingleSlash&&o.pathname==="/"&&!a.endsWith("/")&&o.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||o.pathname==="/")&&o.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var NDKRelayKeepalive=class{constructor(e=3e4,t){this.onSilenceDetected=t,this.timeout=e}lastActivity=Date.now();timer;timeout;isRunning=!1;recordActivity(){this.lastActivity=Date.now(),this.isRunning&&this.resetTimer()}start(){this.isRunning||(this.isRunning=!0,this.lastActivity=Date.now(),this.resetTimer())}stop(){this.isRunning=!1,this.timer&&(clearTimeout(this.timer),this.timer=void 0)}resetTimer(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{const e=Date.now()-this.lastActivity;if(e>=this.timeout)this.onSilenceDetected();else{const t=this.timeout-e;this.timer=setTimeout(()=>{this.onSilenceDetected()},t)}},this.timeout)}};async function probeRelayConnection(e){const t=`probe-${Math.random().toString(36).substring(7)}`;return new Promise(r=>{let n=!1;const o=setTimeout(()=>{n||(n=!0,e.send(["CLOSE",t]),r(!1))},5e3),a=()=>{n||(n=!0,clearTimeout(o),e.send(["CLOSE",t]),r(!0))};e.once("message",a),e.send(["REQ",t,{kinds:[99999],limit:0}])})}var MAX_RECONNECT_ATTEMPTS=5,FLAPPING_THRESHOLD_MS=1e3,NDKRelayConnectivity=class{ndkRelay;ws;_status;timeoutMs;connectedAt;_connectionStats={attempts:0,success:0,durations:[]};debug;netDebug;connectTimeout;reconnectTimeout;ndk;openSubs=new Map;openCountRequests=new Map;openEventPublishes=new Map;pendingAuthPublishes=new Map;serial=0;baseEoseTimeout=4400;keepalive;wsStateMonitor;sleepDetector;lastSleepCheck=Date.now();lastMessageSent=Date.now();wasIdle=!1;constructor(e,t){this.ndkRelay=e,this._status=1;const r=Math.floor(Math.random()*1e3);this.debug=this.ndkRelay.debug.extend(`connectivity${r}`),this.ndk=t,this.setupMonitoring()}setupMonitoring(){this.keepalive=new NDKRelayKeepalive(12e4,async()=>{this.debug("Relay silence detected, probing connection"),await probeRelayConnection({send:t=>this.send(JSON.stringify(t)),once:(t,r)=>{const n=o=>{try{const a=JSON.parse(o.data);(a[0]==="EOSE"||a[0]==="EVENT"||a[0]==="NOTICE")&&(r(),this.ws?.removeEventListener("message",n))}catch{}};this.ws?.addEventListener("message",n)}})||(this.debug("Probe failed, connection is stale"),this.handleStaleConnection())}),this.wsStateMonitor=setInterval(()=>{this._status===5&&(!this.ws||this.ws.readyState!==WebSocket.OPEN)&&(this.debug("WebSocket died silently, reconnecting"),this.handleStaleConnection())},5e3),this.sleepDetector=setInterval(()=>{const e=Date.now(),t=e-this.lastSleepCheck;t>15e3&&(this.debug(`Detected possible sleep/wake (${t}ms gap)`),this.handlePossibleWake()),this.lastSleepCheck=e},1e4)}handleStaleConnection(){this._status=1,this.wasIdle=!0,this.onDisconnect()}handlePossibleWake(){this.debug("System wake detected, checking all connections"),this.wasIdle=!0,this._status>=5&&(!this.ws||this.ws.readyState!==WebSocket.OPEN?this.handleStaleConnection():probeRelayConnection({send:e=>this.send(JSON.stringify(e)),once:(e,t)=>{const r=n=>{try{const o=JSON.parse(n.data);(o[0]==="EOSE"||o[0]==="EVENT"||o[0]==="NOTICE")&&(t(),this.ws?.removeEventListener("message",r))}catch{}};this.ws?.addEventListener("message",r)}}).then(e=>{e||this.handleStaleConnection()}))}resetReconnectionState(){this.wasIdle=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0)}async connect(e,t=!0){if(this.ws&&this.ws.readyState!==WebSocket.OPEN&&this.ws.readyState!==WebSocket.CONNECTING){this.debug("Cleaning up stale WebSocket connection");try{this.ws.close()}catch{}this.ws=void 0,this._status=1}if(this._status!==2&&this._status!==1||this.reconnectTimeout){this.debug("Relay requested to be connected but was in state %s or it had a reconnect timeout",this._status);return}this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),e??=this.timeoutMs,!this.timeoutMs&&e&&(this.timeoutMs=e),this.timeoutMs&&(this.connectTimeout=setTimeout(()=>this.onConnectionError(t),this.timeoutMs));try{this.updateConnectionStats.attempt(),this._status===1?this._status=4:this._status=2,this.ws=new WebSocket(this.ndkRelay.url),this.ws.onopen=this.onConnect.bind(this),this.ws.onclose=this.onDisconnect.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onerror=this.onError.bind(this)}catch(r){throw this.debug(`Failed to connect to ${this.ndkRelay.url}`,r),this._status=1,t?this.handleReconnection():this.ndkRelay.emit("delayed-connect",2880*60*1e3),r}}disconnect(){this._status=0,this.keepalive?.stop(),this.wsStateMonitor&&(clearInterval(this.wsStateMonitor),this.wsStateMonitor=void 0),this.sleepDetector&&(clearInterval(this.sleepDetector),this.sleepDetector=void 0);try{this.ws?.close()}catch(e){this.debug("Failed to disconnect",e),this._status=1}}onConnectionError(e){this.debug(`Error connecting to ${this.ndkRelay.url}`,this.timeoutMs),e&&!this.reconnectTimeout&&this.handleReconnection()}onConnect(){this.netDebug?.("connected",this.ndkRelay),this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.updateConnectionStats.connected(),this._status=5,this.keepalive?.start(),this.wasIdle=!1,this.ndkRelay.emit("connect"),this.ndkRelay.emit("ready")}onDisconnect(){this.netDebug?.("disconnected",this.ndkRelay),this.updateConnectionStats.disconnected(),this.keepalive?.stop(),this.clearPendingPublishes(new Error(`Relay ${this.ndkRelay.url} disconnected`)),this._status===5&&this.handleReconnection(),this._status=1,this.ndkRelay.emit("disconnect")}onMessage(e){this.netDebug?.(e.data,this.ndkRelay,"recv"),this.keepalive?.recordActivity();try{const t=JSON.parse(e.data),[r,n,...o]=t,a=this.ndkRelay.getProtocolHandler(r);if(a){a(this.ndkRelay,t);return}switch(r){case"EVENT":{const l=this.openSubs.get(n),u=t[2];if(!l){this.debug(`Received event for unknown subscription ${n}`);return}l.onevent(u);return}case"COUNT":{const l=t[2],u=this.openCountRequests.get(n);u&&(u.resolve(l.count),this.openCountRequests.delete(n));return}case"EOSE":{const l=this.openSubs.get(n);if(!l)return;l.oneose(n);return}case"OK":{const l=t[2],u=t[3],f=this.openEventPublishes.get(n),x=f?.pop();if(!f||!x){this.debug("Received OK for unknown event publish",n);return}l?(x.resolve(u),this.pendingAuthPublishes.delete(n)):u&&(u.toLowerCase().includes("auth-required")||u.toLowerCase().includes("not authorized")||u.toLowerCase().includes("blocked: not authorized"))?this.pendingAuthPublishes.get(n)?(this.debug("Publish failed due to auth-required, will retry after auth",n),f.push(x),this.openEventPublishes.set(n,f)):x.reject(new Error(u)):(x.reject(new Error(u)),this.pendingAuthPublishes.delete(n)),f.length===0?this.openEventPublishes.delete(n):!l&&!(u?.toLowerCase().includes("auth-required")||u?.toLowerCase().includes("not authorized")||u?.toLowerCase().includes("blocked: not authorized"))&&this.openEventPublishes.set(n,f);return}case"CLOSED":{const l=this.openSubs.get(n);if(!l)return;l.onclosed(t[2]);return}case"NOTICE":this.onNotice(t[1]);return;case"AUTH":{this.onAuthRequested(t[1]);return}}}catch(t){this.debug(`Error parsing message from ${this.ndkRelay.url}: ${t.message}`,t?.stack);return}}async onAuthRequested(e){const t=this.ndkRelay.authPolicy??this.ndk?.relayAuthDefaultPolicy;if(this.debug("Relay requested authentication",{havePolicy:!!t}),this._status===7){this.debug("Already authenticating, ignoring");return}if(this._status=6,t){if(this._status>=5){this._status=7;let r;try{r=await t(this.ndkRelay,e)}catch(n){this.debug("Authentication policy threw an error",n),r=!1}if(this.debug("Authentication policy returned",!!r),r instanceof NDKEvent||r===!0){r instanceof NDKEvent&&await this.auth(r);const n=async()=>{if(this._status>=5&&this._status<8){const o=new NDKEvent(this.ndk);o.kind=22242,o.tags=[["relay",this.ndkRelay.url],["challenge",e]],await o.sign(),this.auth(o).then(()=>{this._status=8,this.ndkRelay.emit("authed"),this.debug("Authentication successful"),this.retryPendingAuthPublishes()}).catch(a=>{this._status=6,this.ndkRelay.emit("auth:failed",a),this.debug("Authentication failed",a),this.rejectPendingAuthPublishes(a)})}else this.debug("Authentication failed, it changed status, status is %d",this._status)};r===!0&&(this.ndk?.signer?n().catch(o=>{console.error("Error authenticating",o)}):(this.debug("No signer available for authentication localhost"),this.ndk?.once("signer:ready",n))),this._status=5,this.ndkRelay.emit("authed")}}}else this.ndkRelay.emit("auth",e)}onError(e){this.debug(`WebSocket error on ${this.ndkRelay.url}:`,e)}get status(){return this._status}isAvailable(){return this._status===5}isFlapping(){const e=this._connectionStats.durations;if(e.length%3!==0)return!1;const r=e.reduce((l,u)=>l+u,0)/e.length,n=e.map(l=>(l-r)**2).reduce((l,u)=>l+u,0)/e.length;return Math.sqrt(n)<FLAPPING_THRESHOLD_MS}async onNotice(e){this.ndkRelay.emit("notice",e)}handleReconnection(e=0){if(this.reconnectTimeout)return;if(this.isFlapping()){this.ndkRelay.emit("flapping",this._connectionStats),this._status=3;return}let t;if(this.wasIdle){const r=[0,1e3,2e3,5e3,1e4,3e4];t=r[Math.min(e,r.length-1)],this.debug(`Using aggressive reconnect after idle, attempt ${e}, delay ${t}ms`)}else this.connectedAt?t=Math.max(0,6e4-(Date.now()-this.connectedAt)):(t=Math.min(1e3*2**e,3e4),this.debug(`Using standard backoff, attempt ${e}, delay ${t}ms`));this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=void 0,this._status=2,this.connect().catch(r=>{e<MAX_RECONNECT_ATTEMPTS?this.handleReconnection(e+1):(this.debug("Max reconnect attempts reached"),this.wasIdle=!1)})},t),this.ndkRelay.emit("delayed-connect",t),this.debug("Reconnecting in",t),this._connectionStats.nextReconnectAt=Date.now()+t}async send(e){Date.now()-this.lastMessageSent>12e4&&(this.wasIdle=!0),this._status>=5&&this.ws?.readyState===WebSocket.OPEN?(this.ws?.send(e),this.netDebug?.(e,this.ndkRelay,"send"),this.lastMessageSent=Date.now()):(this.debug(`Not connected to ${this.ndkRelay.url} (%d), not sending message ${e}`,this._status),this._status>=5&&this.ws?.readyState!==WebSocket.OPEN&&(this.debug(`Stale connection detected, WebSocket state: ${this.ws?.readyState}`),this.handleStaleConnection()))}async auth(e){const t=new Promise((r,n)=>{const o=this.openEventPublishes.get(e.id)??[];o.push({resolve:r,reject:n}),this.openEventPublishes.set(e.id,o)});return this.send(`["AUTH",${JSON.stringify(e.rawEvent())}]`),t}clearPendingPublishes(e){this.rejectPendingAuthPublishes(e);for(const[t,r]of this.openEventPublishes.entries()){for(;r.length>0;){const n=r.shift();n&&n.reject(e)}this.openEventPublishes.delete(t)}}retryPendingAuthPublishes(){if(this.pendingAuthPublishes.size!==0){this.debug(`Retrying ${this.pendingAuthPublishes.size} pending publishes after auth`);for(const[e,t]of this.pendingAuthPublishes.entries())this.debug(`Retrying publish for event ${e}`),this.send(`["EVENT",${JSON.stringify(t)}]`);this.pendingAuthPublishes.clear()}}rejectPendingAuthPublishes(e){if(this.pendingAuthPublishes.size!==0){this.debug(`Rejecting ${this.pendingAuthPublishes.size} pending publishes due to auth failure`);for(const[t]of this.pendingAuthPublishes.entries()){const r=this.openEventPublishes.get(t);if(r&&r.length>0){const n=r.pop();n&&n.reject(new Error(`Authentication failed: ${e.message}`)),r.length===0&&this.openEventPublishes.delete(t)}}this.pendingAuthPublishes.clear()}}async publish(e){const t=new Promise((r,n)=>{const o=this.openEventPublishes.get(e.id)??[];o.length>0&&console.warn(`Duplicate event publishing detected, you are publishing event ${e.id} twice`),o.push({resolve:r,reject:n}),this.openEventPublishes.set(e.id,o)});return this.pendingAuthPublishes.set(e.id,e),this.send(`["EVENT",${JSON.stringify(e)}]`),t}async count(e,t){this.serial++;const r=t?.id||`count:${this.serial}`,n=new Promise((o,a)=>{this.openCountRequests.set(r,{resolve:o,reject:a})});return this.send(`["COUNT","${r}",${JSON.stringify(e).substring(1)}`),n}close(e,t){this.send(`["CLOSE","${e}"]`);const r=this.openSubs.get(e);this.openSubs.delete(e),r&&r.onclose(t)}req(e){`${this.send(`["REQ","${e.subId}",${JSON.stringify(e.executeFilters).substring(1)}`)}`,this.openSubs.set(e.subId,e)}updateConnectionStats={connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++,this._connectionStats.connectedAt=Date.now()}};get connectionStats(){return this._connectionStats}get url(){return this.ndkRelay.url}get connected(){return this._status>=5&&this.ws?.readyState===WebSocket.OPEN}};async function fetchRelayInformation(e){const t=e.replace(/^wss:\/\//,"https://").replace(/^ws:\/\//,"http://"),r=await fetch(t,{headers:{Accept:"application/nostr+json"}});if(!r.ok)throw new Error(`Failed to fetch relay information: ${r.status} ${r.statusText}`);return await r.json()}var NDKRelayPublisher=class{ndkRelay;debug;constructor(e){this.ndkRelay=e,this.debug=e.debug.extend("publisher")}async publish(e,t=2500){let r;const n=()=>new Promise((p,g)=>{try{this.publishEvent(e).then(y=>{this.ndkRelay.emit("published",e),e.emit("relay:published",this.ndkRelay),p(!0)}).catch(g)}catch(y){g(y)}}),o=new Promise((p,g)=>{r=setTimeout(()=>{r=void 0,g(new Error(`Timeout: ${t}ms`))},t)}),a=()=>{n().then(p=>l(p)).catch(p=>u(p))};let l,u;const f=p=>{throw this.ndkRelay.debug("Publish failed",p,e.id),this.ndkRelay.emit("publish:failed",e,p),e.emit("relay:publish:failed",this.ndkRelay,p),p},x=()=>{r&&clearTimeout(r),this.ndkRelay.removeListener("connect",a)};return this.ndkRelay.status>=5?Promise.race([n(),o]).catch(f).finally(x):(this.ndkRelay.status<=1?(console.warn("Relay is disconnected, trying to connect to publish an event",this.ndkRelay.url),this.ndkRelay.connect()):console.warn("Relay not connected, waiting for connection to publish an event",this.ndkRelay.url),Promise.race([new Promise((p,g)=>{l=p,u=g,this.ndkRelay.on("connect",a)}),o]).catch(f).finally(x))}async publishEvent(e){return this.ndkRelay.connectivity.publish(e.rawEvent())}};function filterFingerprint(e,t){const r=[];for(const o of e){const a=Object.entries(o||{}).map(([l,u])=>["since","until"].includes(l)?`${l}:${u}`:l).sort().join("-");r.push(a)}let n=t?"+":"";return n+=r.join("|"),n}function mergeFilters(e){const t=[],r={};return e.filter(n=>!!n.limit).forEach(n=>t.push(n)),e=e.filter(n=>!n.limit),e.length===0?t:(e.forEach(n=>{Object.entries(n).forEach(([o,a])=>{Array.isArray(a)?r[o]===void 0?r[o]=[...a]:r[o]=Array.from(new Set([...r[o],...a])):r[o]=a})}),[...t,r])}var MAX_ITEMS=3;function formatArray(e,t){const n=(t?e.slice(0,MAX_ITEMS).map(t):e.slice(0,MAX_ITEMS)).join(",");return e.length>MAX_ITEMS?`${n}+${e.length-MAX_ITEMS}`:n}function formatFilters(e){return e.map(t=>{const r=[];t.ids?.length&&r.push(`ids:[${formatArray(t.ids,n=>String(n).slice(0,8))}]`),t.kinds?.length&&r.push(`kinds:[${formatArray(t.kinds)}]`),t.authors?.length&&r.push(`authors:[${formatArray(t.authors,n=>String(n).slice(0,8))}]`),t.since&&r.push(`since:${t.since}`),t.until&&r.push(`until:${t.until}`),t.limit&&r.push(`limit:${t.limit}`),t.search&&r.push(`search:"${String(t.search).slice(0,20)}"`);for(const[n,o]of Object.entries(t))n.startsWith("#")&&Array.isArray(o)&&o.length>0&&r.push(`${n}:[${formatArray(o,a=>String(a).slice(0,8))}]`);return`{${r.join(" ")}}`}).join(", ")}var NDKRelaySubscription=class{fingerprint;items=new Map;topSubManager;debug;status=0;onClose;relay;eosed=!1;executionTimer;fireTime;delayType;executeFilters;id=Math.random().toString(36).substring(7);constructor(e,t,r){this.relay=e,this.topSubManager=r,this.debug=e.debug.extend(`sub[${this.id}]`),this.fingerprint=t||Math.random().toString(36).substring(7)}_subId;get subId(){return this._subId?this._subId:(this._subId=this.fingerprint.slice(0,15),this._subId)}subIdParts=new Set;addSubIdPart(e){this.subIdParts.add(e)}addItem(e,t){if(this.debug("Adding item",{filters:formatFilters(t),internalId:e.internalId,status:this.status,fingerprint:this.fingerprint,id:this.subId,itemsSize:this.items.size}),!this.items.has(e.internalId))switch(e.on("close",this.removeItem.bind(this,e)),this.items.set(e.internalId,{subscription:e,filters:t}),this.status!==3&&e.subId&&(!this._subId||this._subId.length<25)&&(this.status===0||this.status===1)&&this.addSubIdPart(e.subId),this.status){case 0:this.evaluateExecutionPlan(e);break;case 3:break;case 1:this.evaluateExecutionPlan(e);break;case 4:throw this.debug("Subscription is closed, cannot add new items",{filters:formatFilters(t),subId:e.subId,internalId:e.internalId}),new Error("Cannot add new items to a closed subscription")}}removeItem(e){if(this.items.delete(e.internalId),this.items.size===0){if(!this.eosed)return;this.close(),this.cleanup()}}close(){if(this.status===4)return;const e=this.status;if(this.status=4,e===3)try{this.relay.close(this.subId)}catch(t){this.debug("Error closing subscription",t,this)}else this.debug("Subscription wanted to close but it wasn't running, this is probably ok",{subId:this.subId,prevStatus:e,sub:this});this.cleanup()}cleanup(){this.executionTimer&&clearTimeout(this.executionTimer),this.relay.off("ready",this.executeOnRelayReady),this.relay.off("authed",this.reExecuteAfterAuth),this.onClose&&this.onClose(this)}evaluateExecutionPlan(e){if(!e.isGroupable()){this.status=1,this.execute();return}if(e.filters.find(n=>!!n.limit)&&(this.executeFilters=this.compileFilters(),this.executeFilters.length>=10)){this.status=1,this.execute();return}const t=e.groupableDelay,r=e.groupableDelayType;if(!t)throw new Error("Cannot group a subscription without a delay");if(this.status===0)this.schedule(t,r);else{const n=this.delayType,o=this.fireTime-Date.now();if(n==="at-least"&&r==="at-least")o<t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,r));else if(n==="at-least"&&r==="at-most")o>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,r));else if(n==="at-most"&&r==="at-most")o>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,r));else if(n==="at-most"&&r==="at-least")o>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,r));else throw new Error(`Unknown delay type combination ${n} ${r}`)}}schedule(e,t){this.status=1;const r=Date.now();this.fireTime=r+e,this.delayType=t;const n=setTimeout(this.execute.bind(this),e);t==="at-least"&&(this.executionTimer=n)}executeOnRelayReady=()=>{if(this.status===2){if(this.items.size===0){this.debug("No items to execute; this relay was probably too slow to respond and the caller gave up",{status:this.status,fingerprint:this.fingerprint,id:this.id,subId:this.subId}),this.cleanup();return}this.debug("Executing on relay ready",{status:this.status,fingerprint:this.fingerprint,itemsSize:this.items.size,filters:formatFilters(this.compileFilters())}),this.status=1,this.execute()}};finalizeSubId(){if(this.subIdParts.size>0){let t=Array.from(this.subIdParts).map(r=>r.substring(0,10)).join("-");t.length>20&&(t=t.substring(0,20)),this._subId=t}else this._subId=this.fingerprint.slice(0,15);this._subId+=`-${Math.random().toString(36).substring(2,7)}`}reExecuteAfterAuth=(()=>{const e=this.subId;this.debug("Re-executing after auth",this.items.size),this.eosed?this.relay.close(this.subId):this.debug("We are abandoning an opened subscription, once it EOSE's, the handler will close it",{oldSubId:e}),this._subId=void 0,this.status=1,this.execute(),this.debug("Re-executed after auth %s  %s",e,this.subId)}).bind(this);execute(){if(this.status===1){if(!this.relay.connected){this.status=2,this.debug("Waiting for relay to be ready",{status:this.status,id:this.subId,fingerprint:this.fingerprint,itemsSize:this.items.size}),this.relay.once("ready",this.executeOnRelayReady);return}this.relay.status<8&&this.relay.once("authed",this.reExecuteAfterAuth),this.status=3,this.finalizeSubId(),this.executeFilters=this.compileFilters(),this.relay.req(this)}}onstart(){}onevent(e){this.topSubManager.dispatchEvent(e,this.relay)}oneose(e){if(this.eosed=!0,e!==this.subId){this.debug("Received EOSE for an abandoned subscription",e,this.subId),this.relay.close(e);return}this.items.size===0&&this.close();for(const{subscription:t}of this.items.values())t.eoseReceived(this.relay),t.closeOnEose&&(this.debug("Removing item because of EOSE",{filters:formatFilters(t.filters),internalId:t.internalId,status:this.status,fingerprint:this.fingerprint,itemsSize:this.items.size}),this.removeItem(t))}onclose(e){this.status=4}onclosed(e){if(e)for(const{subscription:t}of this.items.values())t.closedReceived(this.relay,e)}compileFilters(){const e=[],t=Array.from(this.items.values()).map(n=>n.filters);if(!t[0])return this.debug(" No filters to merge",{itemsSize:this.items.size}),[];const r=t[0].length;for(let n=0;n<r;n++){const o=t.map(l=>l[n]),a=mergeFilters(o);e.push(...a)}return e}},NDKRelaySubscriptionManager=class{relay;subscriptions;generalSubManager;constructor(e,t){this.relay=e,this.subscriptions=new Map,this.generalSubManager=t}addSubscription(e,t){let r;if(!e.isGroupable())r=this.createSubscription(e,t);else{const n=filterFingerprint(t,e.closeOnEose);n&&(r=(this.subscriptions.get(n)||[]).find(a=>a.status<3)),r??=this.createSubscription(e,t,n)}r.addItem(e,t)}createSubscription(e,t,r){const n=new NDKRelaySubscription(this.relay,r||null,this.generalSubManager);n.onClose=this.onRelaySubscriptionClose.bind(this);const o=this.subscriptions.get(n.fingerprint)??[];return this.subscriptions.set(n.fingerprint,[...o,n]),n}onRelaySubscriptionClose(e){let t=this.subscriptions.get(e.fingerprint)??[];t?t.length===1?this.subscriptions.delete(e.fingerprint):(t=t.filter(r=>r.id!==e.id),this.subscriptions.set(e.fingerprint,t)):console.warn("Unexpectedly did not find a subscription with fingerprint",e.fingerprint)}},NDKRelayStatus=(e=>(e[e.DISCONNECTING=0]="DISCONNECTING",e[e.DISCONNECTED=1]="DISCONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.FLAPPING=3]="FLAPPING",e[e.CONNECTING=4]="CONNECTING",e[e.CONNECTED=5]="CONNECTED",e[e.AUTH_REQUESTED=6]="AUTH_REQUESTED",e[e.AUTHENTICATING=7]="AUTHENTICATING",e[e.AUTHENTICATED=8]="AUTHENTICATED",e))(NDKRelayStatus||{}),NDKRelay=class Fx extends libExports.EventEmitter{url;scores;connectivity;subs;publisher;authPolicy;protocolHandlers=new Map;_relayInfo;lowestValidationRatio;targetValidationRatio;validationRatioFn;validatedEventCount=0;nonValidatedEventCount=0;trusted=!1;complaining=!1;debug;static defaultValidationRatioUpdateFn=(t,r,n)=>{if(t.lowestValidationRatio===void 0||t.targetValidationRatio===void 0)return 1;let o=t.validationRatio;if(t.validationRatio>t.targetValidationRatio){const a=r/100;o=Math.max(t.lowestValidationRatio,t.validationRatio-a)}return o<t.validationRatio?o:t.validationRatio};constructor(t,r,n){super(),this.url=normalizeRelayUrl(t),this.scores=new Map,this.debug=createDebug5(`ndk:relay:${t}`),this.connectivity=new NDKRelayConnectivity(this,n),this.connectivity.netDebug=n?.netDebug,this.req=this.connectivity.req.bind(this.connectivity),this.close=this.connectivity.close.bind(this.connectivity),this.subs=new NDKRelaySubscriptionManager(this,n.subManager),this.publisher=new NDKRelayPublisher(this),this.authPolicy=r,this.targetValidationRatio=n?.initialValidationRatio,this.lowestValidationRatio=n?.lowestValidationRatio,this.validationRatioFn=(n?.validationRatioFn??Fx.defaultValidationRatioUpdateFn).bind(this),this.updateValidationRatio(),n||console.trace("relay created without ndk")}updateValidationRatio(){if(this.validationRatioFn&&this.validatedEventCount>0){const t=this.validationRatioFn(this,this.validatedEventCount,this.nonValidatedEventCount);this.targetValidationRatio=t}setTimeout(()=>{this.updateValidationRatio()},3e4)}get status(){return this.connectivity.status}get connectionStats(){return this.connectivity.connectionStats}async connect(t,r=!0){return this.connectivity.connect(t,r)}disconnect(){this.status!==1&&this.connectivity.disconnect()}subscribe(t,r){this.subs.addSubscription(t,r)}async publish(t,r=2500){return this.publisher.publish(t,r)}referenceTags(){return[["r",this.url]]}addValidatedEvent(){this.validatedEventCount++}addNonValidatedEvent(){this.nonValidatedEventCount++}get validationRatio(){return this.nonValidatedEventCount===0?1:this.validatedEventCount/(this.validatedEventCount+this.nonValidatedEventCount)}shouldValidateEvent(){return this.trusted?!1:this.targetValidationRatio===void 0||this.targetValidationRatio>=1?!0:Math.random()<this.targetValidationRatio}get connected(){return this.connectivity.connected}req;close;registerProtocolHandler(t,r){this.protocolHandlers.set(t,r)}unregisterProtocolHandler(t){this.protocolHandlers.delete(t)}getProtocolHandler(t){return this.protocolHandlers.get(t)}async fetchInfo(t=!1){const n=this.connectivity.ndk;if(!t&&n?.cacheAdapter?.getRelayStatus){const o=await n.cacheAdapter.getRelayStatus(this.url);if(o?.nip11&&Date.now()-o.nip11.fetchedAt<864e5)return this._relayInfo=o.nip11.data,o.nip11.data}return!t&&this._relayInfo?this._relayInfo:(this._relayInfo=await fetchRelayInformation(this.url),n?.cacheAdapter?.updateRelayStatus&&await n.cacheAdapter.updateRelayStatus(this.url,{nip11:{data:this._relayInfo,fetchedAt:Date.now()}}),this._relayInfo)}get info(){return this._relayInfo}},NDKPublishError=class extends Error{errors;publishedToRelays;intendedRelaySet;constructor(e,t,r,n){super(e),this.errors=t,this.publishedToRelays=r,this.intendedRelaySet=n}get relayErrors(){const e=[];for(const[t,r]of this.errors)e.push(`${t.url}: ${r}`);return e.join(`
`)}},NDKRelaySet=class Nx{relays;debug;ndk;pool;constructor(t,r,n){this.relays=t,this.ndk=r,this.pool=n??r.pool,this.debug=r.debug.extend("relayset")}addRelay(t){this.relays.add(t)}get relayUrls(){return Array.from(this.relays).map(t=>t.url)}static fromRelayUrls(t,r,n=!0,o){if(o=o??r.pool,!o)throw new Error("No pool provided");const a=new Set;for(const l of t){const u=o.relays.get(normalizeRelayUrl(l));if(u)u.status<5&&n&&u.connect(),a.add(u);else{const f=new NDKRelay(normalizeRelayUrl(l),r?.relayAuthDefaultPolicy,r);o.useTemporaryRelay(f,void 0,`requested from fromRelayUrls ${t}`),a.add(f)}}return new Nx(new Set(a),r,o)}async publish(t,r,n=1){const o=new Set,a=new Map,l=t.isEphemeral();t.publishStatus="pending";const u=f=>{o.add(f)};t.on("relay:published",u);try{const f=Array.from(this.relays).map(x=>new Promise(p=>{const g=r?setTimeout(()=>{o.has(x)||(a.set(x,new Error(`Publish timeout after ${r}ms`)),p(!1))},r):null;x.publish(t,r).then(y=>{g&&clearTimeout(g),y?(o.add(x),p(!0)):p(!1)}).catch(y=>{g&&clearTimeout(g),l||a.set(x,y),p(!1)})}));if(await Promise.all(f),o.size<n){if(!l){const x=new NDKPublishError("Not enough relays received the event ("+o.size+" published, "+n+" required)",a,o,this);throw t.publishStatus="error",t.publishError=x,this.ndk?.emit("event:publish-failed",t,x,this.relayUrls),x}}else t.publishStatus="success",t.emit("published",{relaySet:this,publishedToRelays:o});return o}finally{t.off("relay:published",u)}}get size(){return this.relays.size}},d=createDebug5("ndk:outbox:calculate");async function calculateRelaySetFromEvent(e,t,r){const n=new Set,o=await getWriteRelaysFor(e,t.pubkey);o&&o.forEach(u=>{const f=e.pool?.getRelay(u);f&&n.add(f)});let a=t.tags.filter(u=>["a","e"].includes(u[0])).map(u=>u[2]).filter(u=>u?.startsWith("wss://")).filter(u=>{try{return new URL(u),!0}catch{return!1}}).map(u=>normalizeRelayUrl(u));a=Array.from(new Set(a)).slice(0,5),a.forEach(u=>{const f=e.pool?.getRelay(u,!0,!0);f&&(d("Adding relay hint %s",u),n.add(f))});const l=t.getMatchingTags("p").map(u=>u[1]);return l.length<5?Array.from(chooseRelayCombinationForPubkeys(e,l,"read",{preferredRelays:new Set(o)}).keys()).forEach(f=>{const x=e.pool?.getRelay(f,!1,!0);x&&(d("Adding p-tagged relay %s",f),n.add(x))}):d("Too many p-tags to consider %d",l.length),e.pool?.permanentAndConnectedRelays().forEach(u=>n.add(u)),r&&n.size<r&&e.explicitRelayUrls?.filter(f=>!Array.from(n).some(x=>x.url===f)).slice(0,r-n.size)?.forEach(f=>{const x=e.pool?.getRelay(f,!1,!0);x&&(d("Adding explicit relay %s",f),n.add(x))}),new NDKRelaySet(n,e)}function calculateRelaySetsFromFilter(e,t,r,n){const o=new Map,a=new Set;if(t.forEach(l=>{l.authors&&l.authors.forEach(u=>a.add(u))}),a.size>0){const l=getRelaysForFilterWithAuthors(e,Array.from(a),n);for(const u of l.keys())o.set(u,[]);for(const u of t)if(u.authors)for(const[f,x]of l.entries()){const p=u.authors.filter(g=>x.includes(g));o.set(f,[...o.get(f),{...u,authors:p}])}else for(const f of l.keys())o.set(f,[...o.get(f),u])}else e.explicitRelayUrls&&e.explicitRelayUrls.forEach(l=>{o.set(l,t)});return o.size===0&&r.permanentAndConnectedRelays().slice(0,5).forEach(l=>{o.set(l.url,t)}),o}function calculateRelaySetsFromFilters(e,t,r,n){return calculateRelaySetsFromFilter(e,t,r,n)}function isValidHex64(e){if(typeof e!="string"||e.length!==64)return!1;for(let t=0;t<64;t++){const r=e.charCodeAt(t);if(!(r>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70))return!1}return!0}function isValidPubkey(e){return isValidHex64(e)}function isValidNip05(e){if(typeof e!="string")return!1;for(let t=0;t<e.length;t++)if(e.charCodeAt(t)===46)return!0;return!1}function mergeTags(e,t){const r=new Map,n=l=>l.join(","),o=(l,u)=>l.every((f,x)=>f===u[x]),a=l=>{for(const[u,f]of r)if(o(f,l)||o(l,f)){l.length>=f.length&&r.set(u,l);return}r.set(n(l),l)};return e.concat(t).forEach(a),Array.from(r.values())}var hashtagRegex=new RegExp(`(?<=\\s|^)(#[^\\s!@#$%^&*()=+./,[{\\]};:'"?><]+)`,"g");function generateHashtags(e){const t=e.match(hashtagRegex),r=new Set,n=new Set;if(t)for(const o of t)r.has(o.slice(1))||(n.add(o.slice(1)),r.add(o.slice(1)));return Array.from(n)}async function generateContentTags(e,t=[],r,n){if(r?.skipContentTagging)return{content:e,tags:t};const o=/(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g,a=[],l=u=>{t.find(f=>["q",u[0]].includes(f[0])&&f[1]===u[1])||t.push(u)};if(e=e.replace(o,u=>{try{const f=u.split(/(@|nostr:)/)[2],{type:x,data:p}=nip19_exports$1.decode(f);let g;if(r?.filters){const y=!r.filters.includeTypes||r.filters.includeTypes.includes(x),b=r.filters.excludeTypes?.includes(x);if(!y||b)return u}switch(x){case"npub":r?.pTags!==!1&&(g=["p",p]);break;case"nprofile":r?.pTags!==!1&&(g=["p",p.pubkey]);break;case"note":a.push(new Promise(async y=>{const b=await maybeGetEventRelayUrl(f);l(["q",p,b]),y()}));break;case"nevent":a.push(new Promise(async y=>{const{id:b,author:w}=p;let{relays:v}=p;(!v||v.length===0)&&(v=[await maybeGetEventRelayUrl(f)]),l(["q",b,v[0]]),w&&r?.pTags!==!1&&r?.pTagOnQTags!==!1&&l(["p",w]),y()}));break;case"naddr":a.push(new Promise(async y=>{const b=[p.kind,p.pubkey,p.identifier].join(":");let w=p.relays??[];w.length===0&&(w=[await maybeGetEventRelayUrl(f)]),l(["q",b,w[0]]),r?.pTags!==!1&&r?.pTagOnQTags!==!1&&r?.pTagOnATags!==!1&&l(["p",p.pubkey]),y()}));break;default:return u}return g&&l(g),`nostr:${f}`}catch{return u}}),await Promise.all(a),!r?.filters?.excludeTypes?.includes("hashtag")){const u=generateHashtags(e).map(f=>["t",f]);t=mergeTags(t,u)}if(r?.pTags!==!1&&r?.copyPTagsFromTarget&&n){const u=n.getMatchingTags("p");for(const f of u)!f[1]||!isValidPubkey(f[1])||t.find(x=>x[0]==="p"&&x[1]===f[1])||t.push(f)}return{content:e,tags:t}}async function maybeGetEventRelayUrl(e){return""}async function encrypt(e,t,r="nip44"){let n;if(!this.ndk)throw new Error("No NDK instance found!");let o=t;if(o||(this.ndk.assertSigner(),o=this.ndk.signer),!o)throw new Error("no NDK signer");const a=e||(()=>{const l=this.getMatchingTags("p");if(l.length!==1)throw new Error("No recipient could be determined and no explicit recipient was provided");return this.ndk.getUser({pubkey:l[0][1]})})();if(r==="nip44"&&await isEncryptionEnabled(o,"nip44")&&(n=await o.encrypt(a,this.content,"nip44")),(!n||r==="nip04")&&await isEncryptionEnabled(o,"nip04")&&(n=await o.encrypt(a,this.content,"nip04")),!n)throw new Error("Failed to encrypt event.");this.content=n}async function decrypt(e,t,r){if(this.ndk?.cacheAdapter?.getDecryptedEvent){const u=await this.ndk.cacheAdapter.getDecryptedEvent(this.id);if(u){this.content=u.content;return}}let n;if(!this.ndk)throw new Error("No NDK instance found!");let o=t;if(o||(this.ndk.assertSigner(),o=this.ndk.signer),!o)throw new Error("no NDK signer");const a=e||this.author;if(!a)throw new Error("No sender provided and no author available");const l=r||(this.content.match(/\\?iv=/)?"nip04":"nip44");if((l==="nip04"||this.kind===4)&&await isEncryptionEnabled(o,"nip04")&&this.content.search("\\?iv=")&&(n=await o.decrypt(a,this.content,"nip04")),!n&&l==="nip44"&&await isEncryptionEnabled(o,"nip44")&&(n=await o.decrypt(a,this.content,"nip44")),!n)throw new Error("Failed to decrypt event.");this.content=n,this.ndk?.cacheAdapter?.addDecryptedEvent&&this.ndk.cacheAdapter.addDecryptedEvent(this.id,this)}async function isEncryptionEnabled(e,t){return e.encryptionEnabled?t?!!await e.encryptionEnabled(t):!0:!1}function eventHasETagMarkers(e){for(const t of e.tags)if(t[0]==="e"&&(t[3]??"").length>0)return!0;return!1}function getRootTag(e,t){t??=e.tagType();const r=e.tags.find(isTagRootTag);if(!r){if(eventHasETagMarkers(e))return;const n=e.getMatchingTags(t);if(n.length<3)return n[0]}return r}var nip22RootTags=new Set(["A","E","I"]),nip22ReplyTags=new Set(["a","e","i"]);function getReplyTag(e,t){if(e.kind===1111){let o;for(const a of e.tags)if(nip22RootTags.has(a[0]))o=a;else if(nip22ReplyTags.has(a[0])){o=a;break}return o}t??=e.tagType();let r=!1,n;for(const o of e.tags)if(o[0]===t){if((o[3]??"").length>0&&(r=!0),r&&o[3]==="reply")return o;r&&o[3]==="root"&&(n=o),r||(n=o)}return n}function isTagRootTag(e){return e[0]==="E"||e[3]==="root"}async function fetchTaggedEvent(e,t){if(!this.ndk)throw new Error("NDK instance not found");const r=this.getMatchingTags(e,t);if(r.length===0)return;const[n,o,a]=r[0],l=a!==""?this.ndk.pool.getRelay(a):void 0;return await this.ndk.fetchEvent(o,{},l)}async function fetchRootEvent(e){if(!this.ndk)throw new Error("NDK instance not found");const t=getRootTag(this);if(t)return this.ndk.fetchEventFromTag(t,this,e)}async function fetchReplyEvent(e){if(!this.ndk)throw new Error("NDK instance not found");const t=getReplyTag(this);if(t)return this.ndk.fetchEventFromTag(t,this,e)}function isReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return[0,3].includes(this.kind)||this.kind>=1e4&&this.kind<2e4||this.kind>=3e4&&this.kind<4e4}function isEphemeral(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=2e4&&this.kind<3e4}function isParamReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}var DEFAULT_RELAY_COUNT=2;function encode$k(e=DEFAULT_RELAY_COUNT){let t=[];return this.onRelays.length>0?t=this.onRelays.map(r=>r.url):this.relay&&(t=[this.relay.url]),t.length>e&&(t=t.slice(0,e)),this.isParamReplaceable()?nip19_exports$1.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag(),relays:t}):t.length>0?nip19_exports$1.neventEncode({id:this.tagId(),relays:t,author:this.pubkey}):nip19_exports$1.noteEncode(this.tagId())}async function repost(e=!0,t){if(!t&&e){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),t=this.ndk.signer}const r=new NDKEvent(this.ndk,{kind:getKind(this)});return this.isProtected||(r.content=JSON.stringify(this.rawEvent())),r.tag(this),this.kind!==1&&r.tags.push(["k",`${this.kind}`]),t&&await r.sign(t),e&&await r.publish(),r}function getKind(e){return e.kind===1?6:16}function getEventDetails(e){return"inspect"in e&&typeof e.inspect=="string"?e.inspect:JSON.stringify(e)}function validateForSerialization(e){if(typeof e.kind!="number")throw new Error(`Can't serialize event with invalid properties: kind (must be number, got ${typeof e.kind}). Event: ${getEventDetails(e)}`);if(typeof e.content!="string")throw new Error(`Can't serialize event with invalid properties: content (must be string, got ${typeof e.content}). Event: ${getEventDetails(e)}`);if(typeof e.created_at!="number")throw new Error(`Can't serialize event with invalid properties: created_at (must be number, got ${typeof e.created_at}). Event: ${getEventDetails(e)}`);if(typeof e.pubkey!="string")throw new Error(`Can't serialize event with invalid properties: pubkey (must be string, got ${typeof e.pubkey}). Event: ${getEventDetails(e)}`);if(!Array.isArray(e.tags))throw new Error(`Can't serialize event with invalid properties: tags (must be array, got ${typeof e.tags}). Event: ${getEventDetails(e)}`);for(let t=0;t<e.tags.length;t++){const r=e.tags[t];if(!Array.isArray(r))throw new Error(`Can't serialize event with invalid properties: tags[${t}] (must be array, got ${typeof r}). Event: ${getEventDetails(e)}`);for(let n=0;n<r.length;n++)if(typeof r[n]!="string")throw new Error(`Can't serialize event with invalid properties: tags[${t}][${n}] (must be string, got ${typeof r[n]}). Event: ${getEventDetails(e)}`)}}function serialize(e=!1,t=!1){validateForSerialization(this);const r=[0,this.pubkey,this.created_at,this.kind,this.tags,this.content];return e&&r.push(this.sig),t&&r.push(this.id),JSON.stringify(r)}function deserialize(e){const t=JSON.parse(e),r={pubkey:t[1],created_at:t[2],kind:t[3],tags:t[4],content:t[5]};if(t.length>=7){const n=t[6],o=t[7];n&&n.length===128?(r.sig=n,o&&o.length===64&&(r.id=o)):n&&n.length===64&&(r.id=n,o&&o.length===128&&(r.sig=o))}return r}var worker,processingQueue={};function signatureVerificationInit(e){worker=e,worker.onmessage=t=>{if(!Array.isArray(t.data)||t.data.length!==2){console.error("[NDK]  Signature verification worker received incompatible message format.",`

 Expected format: [eventId, boolean]`,`
 Received:`,t.data,`

 This likely means:`,`
  1. You have a STALE worker.js file that needs updating`,`
  2. Version mismatch between @nostr-dev-kit/ndk and deployed worker`,`
  3. Wrong worker is being used for signature verification`,`

 Solution: Update your worker files:`,`
  cp node_modules/@nostr-dev-kit/ndk/dist/workers/sig-verification.js public/`,`
  cp node_modules/@nostr-dev-kit/cache-sqlite-wasm/dist/worker.js public/`,`

 Or use Vite/bundler imports instead of static files:`,`
  import SigWorker from "@nostr-dev-kit/ndk/workers/sig-verification?worker"`);return}const[r,n]=t.data,o=processingQueue[r];if(!o){console.error("No record found for event",r);return}delete processingQueue[r];for(const a of o.resolves)a(n)}}async function verifySignatureAsync(e,t,r){const n=e.ndk,o=Date.now();let a;return n.signatureVerificationFunction?a=await n.signatureVerificationFunction(e):a=await new Promise(l=>{const u=e.serialize();let f=!1;processingQueue[e.id]||(processingQueue[e.id]={event:e,resolves:[],relay:r},f=!0),processingQueue[e.id].resolves.push(l),f&&worker?.postMessage({serialized:u,id:e.id,sig:e.sig,pubkey:e.pubkey})}),n.signatureVerificationTimeMs+=Date.now()-o,a}var PUBKEY_REGEX=/^[a-f0-9]{64}$/;function validate(){if(typeof this.kind!="number"||typeof this.content!="string"||typeof this.created_at!="number"||typeof this.pubkey!="string"||!this.pubkey.match(PUBKEY_REGEX)||!Array.isArray(this.tags))return!1;for(let e=0;e<this.tags.length;e++){const t=this.tags[e];if(!Array.isArray(t))return!1;for(let r=0;r<t.length;r++)if(typeof t[r]=="object")return!1}return!0}var verifiedSignatures=new distExports$2.LRUCache({maxSize:1e3,entryExpirationTimeInMS:6e4});function verifySignature(e){if(typeof this.signatureVerified=="boolean")return this.signatureVerified;const t=verifiedSignatures.get(this.id);if(t!==null)return this.signatureVerified=!!t,this.signatureVerified;try{if(this.ndk?.asyncSigVerification){const r=this.relay;verifySignatureAsync(this,e,r).then(n=>{e&&(this.signatureVerified=n,n&&verifiedSignatures.set(this.id,this.sig)),n?r&&r.addValidatedEvent():(r?this.ndk?.reportInvalidSignature(this,r):this.ndk?.reportInvalidSignature(this),verifiedSignatures.set(this.id,!1))}).catch(n=>{console.error("signature verification error",this.id,n)})}else{const r=sha256(new TextEncoder().encode(this.serialize())),n=schnorr.verify(this.sig,r,this.pubkey);return n?verifiedSignatures.set(this.id,this.sig):verifiedSignatures.set(this.id,!1),this.signatureVerified=n,n}}catch{return this.signatureVerified=!1,!1}}function getEventHash(){return getEventHashFromSerializedEvent(this.serialize())}function getEventHashFromSerializedEvent(e){const t=sha256(new TextEncoder().encode(e));return bytesToHex(t)}var skipClientTagOnKinds=new Set([0,4,1059,13,3,9734,5]),NDKEvent=class Un extends libExports.EventEmitter{ndk;created_at;content="";tags=[];kind;id="";sig;pubkey="";signatureVerified;_author=void 0;relay;get onRelays(){let t=[];return this.ndk?t=this.ndk.subManager.seenEvents.get(this.id)||[]:this.relay&&t.push(this.relay),t}publishStatus="success";publishError;constructor(t,r){super(),this.ndk=t,this.created_at=r?.created_at,this.content=r?.content||"",this.tags=r?.tags||[],this.id=r?.id||"",this.sig=r?.sig,this.pubkey=r?.pubkey||"",this.kind=r?.kind,r instanceof Un&&(this.relay&&(this.relay=r.relay,this.ndk?.subManager.seenEvent(r.id,this.relay)),this.publishStatus=r.publishStatus,this.publishError=r.publishError)}static deserialize(t,r){return new Un(t,deserialize(r))}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author(t){this.pubkey=t.pubkey,this._author=t,this._author.ndk??=this.ndk}get author(){if(this._author)return this._author;if(!this.ndk)throw new Error("No NDK instance found");const t=this.ndk.getUser({pubkey:this.pubkey});return this._author=t,t}tagExternal(t,r,n){const o=["i"],a=["k"];switch(r){case"url":{const l=new URL(t);l.hash="",o.push(l.toString()),a.push(`${l.protocol}//${l.host}`);break}case"hashtag":o.push(`#${t.toLowerCase()}`),a.push("#");break;case"geohash":o.push(`geo:${t.toLowerCase()}`),a.push("geo");break;case"isbn":o.push(`isbn:${t.replace(/-/g,"")}`),a.push("isbn");break;case"podcast:guid":o.push(`podcast:guid:${t}`),a.push("podcast:guid");break;case"podcast:item:guid":o.push(`podcast:item:guid:${t}`),a.push("podcast:item:guid");break;case"podcast:publisher:guid":o.push(`podcast:publisher:guid:${t}`),a.push("podcast:publisher:guid");break;case"isan":o.push(`isan:${t.split("-").slice(0,4).join("-")}`),a.push("isan");break;case"doi":o.push(`doi:${t.toLowerCase()}`),a.push("doi");break;default:throw new Error(`Unsupported NIP-73 entity type: ${r}`)}n&&o.push(n),this.tags.push(o),this.tags.push(a)}tag(t,r,n,o,a){let l=[];if(t.fetchProfile!==void 0){if(o??="p",o==="p"&&a?.pTags===!1)return;const f=[o,t.pubkey];r&&f.push("",r),l.push(f)}else if(t instanceof Un){const f=t;if(n??=f?.pubkey===this.pubkey,l=f.referenceTags(r,n,o,a),a?.pTags!==!1)for(const x of f.getMatchingTags("p"))!x[1]||!isValidPubkey(x[1])||x[1]!==this.pubkey&&(this.tags.find(p=>p[0]==="p"&&p[1]===x[1])||this.tags.push(["p",x[1]]))}else if(Array.isArray(t))l=[t];else throw new Error("Invalid argument",t);this.tags=mergeTags(this.tags,l)}async toNostrEvent(t,r){if(!t&&this.pubkey===""){const a=await this.ndk?.signer?.user();this.pubkey=a?.pubkey||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const{content:n,tags:o}=await this.generateTags(r);this.content=n||"",this.tags=o;try{this.id=this.getEventHash()}catch{}return this.rawEvent()}serialize=serialize.bind(this);getEventHash=getEventHash.bind(this);validate=validate.bind(this);verifySignature=verifySignature.bind(this);isReplaceable=isReplaceable.bind(this);isEphemeral=isEphemeral.bind(this);isDvm=()=>this.kind&&this.kind>=5e3&&this.kind<=7e3;isParamReplaceable=isParamReplaceable.bind(this);encode=encode$k.bind(this);encrypt=encrypt.bind(this);decrypt=decrypt.bind(this);getMatchingTags(t,r){const n=this.tags.filter(o=>o[0]===t);return r===void 0?n:n.filter(o=>o[3]===r)}hasTag(t,r){return this.tags.some(n=>n[0]===t&&(!r||n[3]===r))}tagValue(t,r){const n=this.getMatchingTags(t,r);if(n.length!==0)return n[0][1]}get alt(){return this.tagValue("alt")}set alt(t){this.removeTag("alt"),t&&this.tags.push(["alt",t])}get dTag(){return this.tagValue("d")}set dTag(t){this.removeTag("d"),t&&this.tags.push(["d",t])}removeTag(t,r){const n=Array.isArray(t)?t:[t];this.tags=this.tags.filter(o=>{const a=n.includes(o[0]),l=r?o[3]===r:!0;return!(a&&l)})}replaceTag(t){this.removeTag(t[0]),this.tags.push(t)}async sign(t,r){this.ndk?.aiGuardrails?.event?.signing(this),t?this.author=await t.user():(this.ndk?.assertSigner(),t=this.ndk?.signer);const n=await this.toNostrEvent(void 0,r);return this.sig=await t.sign(n),this.sig}async publishReplaceable(t,r,n){return this.id="",this.created_at=Math.floor(Date.now()/1e3),this.sig="",this.publish(t,r,n)}async publish(t,r,n,o){if(n||(n=1),this.sig||await this.sign(void 0,o),!this.ndk)throw new Error("NDKEvent must be associated with an NDK instance to publish");if(this.ndk.aiGuardrails?.event?.publishing(this),(!t||t.size===0)&&(t=this.ndk.devWriteRelaySet||await calculateRelaySetFromEvent(this.ndk,this,n)),this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds){const u=this.getMatchingTags("e").map(f=>f[1]);this.ndk.cacheAdapter.deleteEventIds(u)}const a=this.rawEvent();if(this.ndk.cacheAdapter?.addUnpublishedEvent&&shouldTrackUnpublishedEvent(this))try{this.ndk.cacheAdapter.addUnpublishedEvent(this,t.relayUrls)}catch(u){console.error("Error adding unpublished event to cache",u)}this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds&&this.ndk.cacheAdapter.deleteEventIds(this.getMatchingTags("e").map(u=>u[1])),this.ndk.subManager.dispatchEvent(a,void 0,!0);const l=await t.publish(this,r,n);return l.forEach(u=>this.ndk?.subManager.seenEvent(this.id,u)),l}async generateTags(t){let r=[];const n=await generateContentTags(this.content,this.tags,t,this),o=n.content;if(r=n.tags,this.kind&&this.isParamReplaceable()&&!this.getMatchingTags("d")[0]){const l=this.tagValue("title");let f=[...Array(l?6:16)].map(()=>Math.random().toString(36)[2]).join("");l&&l.length>0&&(f=`${l.replace(/[^a-z0-9]+/gi,"-").replace(/^-|-$/g,"")}-${f}`),r.push(["d",f])}if(this.shouldAddClientTag){const a=["client",this.ndk?.clientName??""];this.ndk?.clientNip89&&a.push(this.ndk?.clientNip89),r.push(a)}else this.shouldStripClientTag&&(r=r.filter(a=>a[0]!=="client"));return{content:o||"",tags:r}}get shouldAddClientTag(){return!(!this.ndk?.clientName&&!this.ndk?.clientNip89||skipClientTagOnKinds.has(this.kind)||this.isEphemeral()||this.isReplaceable()&&!this.isParamReplaceable()||this.isDvm()||this.hasTag("client"))}get shouldStripClientTag(){return skipClientTagOnKinds.has(this.kind)}muted(){return this.ndk?.muteFilter&&this.ndk.muteFilter(this)?"muted":null}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const t=this.getMatchingTags("d")[0];return t?t[1]:""}throw new Error("Event is not a parameterized replaceable event")}deduplicationKey(){return this.kind===0||this.kind===3||this.kind&&this.kind>=1e4&&this.kind<2e4?`${this.kind}:${this.pubkey}`:this.tagId()}tagId(){return this.isParamReplaceable()?this.tagAddress():this.id}tagAddress(){if(this.isParamReplaceable()){const t=this.dTag??"";return`${this.kind}:${this.pubkey}:${t}`}if(this.isReplaceable())return`${this.kind}:${this.pubkey}:`;throw new Error("Event is not a replaceable event")}tagType(){return this.isParamReplaceable()?"a":"e"}tagReference(t){let r;return this.isParamReplaceable()?r=["a",this.tagAddress()]:r=["e",this.tagId()],this.relay?r.push(this.relay.url):r.push(""),r.push(t??""),this.isParamReplaceable()||r.push(this.pubkey),r}referenceTags(t,r,n,o){let a=[];return this.isParamReplaceable()?a=[[n??"a",this.tagAddress()],[n??"e",this.id]]:a=[[n??"e",this.id]],a=a.map(l=>(l[0]==="e"||t?l.push(this.relay?.url??""):this.relay?.url&&l.push(this.relay?.url),l)),a.forEach(l=>{l[0]==="e"?(l.push(t??""),l.push(this.pubkey)):t&&l.push(t)}),a=[...a,...this.getMatchingTags("h")],!r&&o?.pTags!==!1&&a.push(...this.author.referenceTags()),a}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}nip22Filter(){return this.isParamReplaceable()?{"#A":[this.tagId()]}:{"#E":[this.tagId()]}}async delete(t,r=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const n=new Un(this.ndk,{kind:5,content:t||""});return n.tag(this,void 0,!0),n.tags.push(["k",this.kind?.toString()]),r&&(this.emit("deleted"),await n.publish()),n}set isProtected(t){this.removeTag("-"),t&&this.tags.push(["-"])}get isProtected(){return this.hasTag("-")}fetchTaggedEvent=fetchTaggedEvent.bind(this);fetchRootEvent=fetchRootEvent.bind(this);fetchReplyEvent=fetchReplyEvent.bind(this);repost=repost.bind(this);async react(t,r=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const n=new Un(this.ndk,{kind:7,content:t});return n.tag(this),this.kind!==1&&n.tags.push(["k",`${this.kind}`]),r&&await n.publish(),n}get isValid(){return this.validate()}get inspect(){return JSON.stringify(this.rawEvent(),null,4)}dump(){console.debug(JSON.stringify(this.rawEvent(),null,4)),console.debug("Event on relays:",this.onRelays.map(t=>t.url).join(", "))}reply(t,r){const n=new Un(this.ndk);if(this.ndk?.aiGuardrails?.event?.creatingReply(n),this.kind===1&&!t)n.kind=1,this.hasTag("e")?n.tags=[...n.tags,...this.getMatchingTags("e"),...this.getMatchingTags("p"),...this.getMatchingTags("a"),...this.referenceTags("reply",!1,void 0,r)]:n.tag(this,"root",!1,void 0,r);else{n.kind=1111;const o=["A","E","I","P"],a=this.tags.filter(l=>o.includes(l[0]));if(a.length>0){const l=this.tagValue("K");n.tags.push(...a),l&&n.tags.push(["K",l]);let u;if(this.isParamReplaceable()){u=["a",this.tagAddress()];const f=this.relay?.url??"";f&&u.push(f)}else{u=["e",this.tagId()];const f=this.relay?.url??"";u.push(f),u.push(this.pubkey)}n.tags.push(u)}else{let l,u;const f=this.relay?.url??"";this.isParamReplaceable()?(l=["a",this.tagAddress(),f],u=["A",this.tagAddress(),f]):(l=["e",this.tagId(),f,this.pubkey],u=["E",this.tagId(),f,this.pubkey]),n.tags.push(l),n.tags.push(u),n.tags.push(["K",this.kind?.toString()]),r?.pTags!==!1&&r?.pTagOnATags!==!1&&n.tags.push(["P",this.pubkey])}n.tags.push(["k",this.kind?.toString()]),r?.pTags!==!1&&(n.tags.push(...this.getMatchingTags("p")),n.tags.push(["p",this.pubkey]))}return n}},untrackedUnpublishedEvents=new Set([24133,13194,23194,23195]);function shouldTrackUnpublishedEvent(e){return!untrackedUnpublishedEvents.has(e.kind)}var NDKPool=class extends libExports.EventEmitter{_relays=new Map;status="idle";autoConnectRelays=new Set;debug;temporaryRelayTimers=new Map;flappingRelays=new Set;backoffTimes=new Map;ndk;disconnectionTimes=new Map;systemEventDetector;constructor(e,t,{debug:r,name:n}={}){super(),this.debug=r??t.debug.extend("pool"),n&&(this._name=n),this.ndk=t,this.relayUrls=e,this.ndk.pools&&this.ndk.pools.push(this)}get relays(){return this._relays}set relayUrls(e){this._relays.clear();for(const t of e){const r=new NDKRelay(t,void 0,this.ndk);r.connectivity.netDebug=this.ndk.netDebug,this.addRelay(r)}}_name="unnamed";get name(){return this._name}set name(e){this._name=e,this.debug=this.debug.extend(e)}useTemporaryRelay(e,t=3e4,r){const n=this.relays.has(e.url);n||(this.addRelay(e),this.debug("Adding temporary relay %s for filters %o",e.url,r));const o=this.temporaryRelayTimers.get(e.url);if(o&&clearTimeout(o),!n||o){const a=setTimeout(()=>{this.ndk.explicitRelayUrls?.includes(e.url)||this.removeRelay(e.url)},t);this.temporaryRelayTimers.set(e.url,a)}}addRelay(e,t=!0){const r=this.relays.has(e.url),n=e.url.includes("/npub1");let o=!0;const a=e.url;if(r)return;if(this.ndk.relayConnectionFilter&&!this.ndk.relayConnectionFilter(a)){this.debug(`Refusing to add relay ${a}: blocked by relayConnectionFilter`);return}if(n){this.debug(`Refusing to add relay ${a}: is a filter relay`);return}if(this.ndk.cacheAdapter?.getRelayStatus){const b=this.ndk.cacheAdapter.getRelayStatus(a),w=b instanceof Promise?void 0:b;if(w?.dontConnectBefore){if(w.dontConnectBefore>Date.now()){const v=w.dontConnectBefore-Date.now();this.debug(`Refusing to add relay ${a}: delayed connect for ${v}ms`),setTimeout(()=>{this.addRelay(e,t)},v);return}o=!1}}const l=b=>this.emit("notice",e,b),u=()=>this.handleRelayConnect(a),f=()=>this.handleRelayReady(e),x=()=>{this.recordDisconnection(e),this.emit("relay:disconnect",e)},p=()=>this.handleFlapping(e),g=b=>this.emit("relay:auth",e,b),y=()=>this.emit("relay:authed",e);e.off("notice",l),e.off("connect",u),e.off("ready",f),e.off("disconnect",x),e.off("flapping",p),e.off("auth",g),e.off("authed",y),e.on("notice",l),e.on("connect",u),e.on("ready",f),e.on("disconnect",x),e.on("flapping",p),e.on("auth",g),e.on("authed",y),e.on("delayed-connect",b=>{this.ndk.cacheAdapter?.updateRelayStatus&&this.ndk.cacheAdapter.updateRelayStatus(e.url,{dontConnectBefore:Date.now()+b})}),this._relays.set(a,e),t&&this.autoConnectRelays.add(a),t&&this.status==="active"&&(this.emit("relay:connecting",e),e.connect(void 0,o).catch(b=>{this.debug(`Failed to connect to relay ${a}`,b)}))}removeRelay(e){const t=this.relays.get(e);if(t)return t.disconnect(),this.relays.delete(e),this.autoConnectRelays.delete(e),this.emit("relay:disconnect",t),!0;const r=this.temporaryRelayTimers.get(e);return r&&(clearTimeout(r),this.temporaryRelayTimers.delete(e)),!1}isRelayConnected(e){const t=normalizeRelayUrl(e),r=this.relays.get(t);return r?r.status===5:!1}getRelay(e,t=!0,r=!1,n){let o=this.relays.get(normalizeRelayUrl(e));return o||(o=new NDKRelay(e,void 0,this.ndk),o.connectivity.netDebug=this.ndk.netDebug,r?this.useTemporaryRelay(o,3e4,n):this.addRelay(o,t)),o}handleRelayConnect(e){const t=this.relays.get(e);if(!t){console.error("NDK BUG: relay not found in pool",{relayUrl:e});return}this.emit("relay:connect",t),this.stats().connected===this.relays.size&&this.emit("connect")}handleRelayReady(e){this.emit("relay:ready",e)}async connect(e){this.status="active",this.debug(`Connecting to ${this.relays.size} relays${e?`, timeout ${e}ms`:""}...`);const t=Array.from(this.autoConnectRelays.keys()).map(a=>this.relays.get(a)).filter(a=>!!a);for(const a of t)a.status!==5&&a.status!==4&&(this.emit("relay:connecting",a),a.connect().catch(l=>{this.debug(`Failed to connect to relay ${a.url}: ${l??"No reason specified"}`)}));const r=()=>t.every(a=>a.status===5),n=new Promise(a=>{if(r()){a();return}const l=[];for(const u of t){const f=()=>{if(r()){for(let x=0;x<t.length;x++)t[x].off("connect",l[x]);a()}};l.push(f),u.on("connect",f)}}),o=typeof e=="number"?new Promise(a=>setTimeout(a,e)):new Promise(()=>{});await Promise.race([n,o])}checkOnFlappingRelays(){const e=this.flappingRelays.size,t=this.relays.size;if(e/t>=.8)for(const r of this.flappingRelays)this.backoffTimes.set(r,0)}recordDisconnection(e){const t=Date.now();this.disconnectionTimes.set(e.url,t);for(const[r,n]of this.disconnectionTimes.entries())t-n>1e4&&this.disconnectionTimes.delete(r);this.checkForSystemWideDisconnection()}checkForSystemWideDisconnection(){const e=Date.now(),t=[];for(const r of this.disconnectionTimes.values())e-r<5e3&&t.push(r);t.length>this.relays.size/2&&this.relays.size>1&&(this.debug(`System-wide disconnection detected: ${t.length}/${this.relays.size} relays disconnected`),this.handleSystemWideReconnection())}handleSystemWideReconnection(){if(this.systemEventDetector){this.debug("System-wide reconnection already in progress, skipping");return}this.debug("Initiating system-wide reconnection with reset backoff"),this.systemEventDetector=setTimeout(()=>{this.systemEventDetector=void 0},1e4);for(const e of this.relays.values())e.connectivity&&(e.connectivity.resetReconnectionState(),e.status!==5&&e.status!==4&&e.connect().catch(t=>{this.debug(`Failed to reconnect relay ${e.url} after system event: ${t}`)}));this.disconnectionTimes.clear()}handleFlapping(e){this.debug(`Relay ${e.url} is flapping`);let t=this.backoffTimes.get(e.url)||5e3;t=t*2,this.backoffTimes.set(e.url,t),this.debug(`Backoff time for ${e.url} is ${t}ms`),setTimeout(()=>{this.debug(`Attempting to reconnect to ${e.url}`),this.emit("relay:connecting",e),e.connect(),this.checkOnFlappingRelays()},t),e.disconnect(),this.emit("flapping",e)}size(){return this.relays.size}stats(){const e={total:0,connected:0,disconnected:0,connecting:0};for(const t of this.relays.values())e.total++,t.status===5?e.connected++:t.status===1?e.disconnected++:t.status===4&&e.connecting++;return e}connectedRelays(){return Array.from(this.relays.values()).filter(e=>e.status>=5)}permanentAndConnectedRelays(){return Array.from(this.relays.values()).filter(e=>e.status>=5&&!this.temporaryRelayTimers.has(e.url))}urls(){return Array.from(this.relays.keys())}},NDKDVMJobFeedback=class Tx extends NDKEvent{static kinds=[7e3];constructor(t,r){super(t,r),this.kind??=7e3}static async from(t){const r=new Tx(t.ndk,t.rawEvent());return r.encrypted&&await r.dvmDecrypt(),r}get status(){return this.tagValue("status")}set status(t){this.removeTag("status"),t!==void 0&&this.tags.push(["status",t])}get encrypted(){return!!this.getMatchingTags("encrypted")[0]}async dvmDecrypt(){await this.decrypt();const t=JSON.parse(this.content);this.tags.push(...t)}},NDKCashuMintList=class jx extends NDKEvent{static kind=10019;static kinds=[10019];_p2pk;constructor(t,r){super(t,r),this.kind??=10019}static from(t){return new jx(t.ndk,t)}set relays(t){this.tags=this.tags.filter(r=>r[0]!=="relay");for(const r of t)this.tags.push(["relay",r])}get relays(){const t=[];for(const r of this.tags)r[0]==="relay"&&t.push(r[1]);return t}set mints(t){this.tags=this.tags.filter(r=>r[0]!=="mint");for(const r of t)this.tags.push(["mint",r])}get mints(){const t=[];for(const r of this.tags)r[0]==="mint"&&t.push(r[1]);return Array.from(new Set(t))}get p2pk(){return this._p2pk?this._p2pk:(this._p2pk=this.tagValue("pubkey")??this.pubkey,this._p2pk)}set p2pk(t){this._p2pk=t,this.removeTag("pubkey"),t&&this.tags.push(["pubkey",t])}get relaySet(){return NDKRelaySet.fromRelayUrls(this.relays,this.ndk)}},NDKArticle=class $x extends NDKEvent{static kind=30023;static kinds=[30023];constructor(t,r){super(t,r),this.kind??=30023}static from(t){return new $x(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}get summary(){return this.tagValue("summary")}set summary(t){this.removeTag("summary"),t&&this.tags.push(["summary",t])}get published_at(){const t=this.tagValue("published_at");if(t){let r=Number.parseInt(t);return r>1e12&&(r=Math.floor(r/1e3)),r}}set published_at(t){this.removeTag("published_at"),t!==void 0&&this.tags.push(["published_at",t.toString()])}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}get url(){return this.tagValue("url")}set url(t){t?this.tags.push(["url",t]):this.removeTag("url")}},NDKBlossomList=class Ix extends NDKEvent{static kinds=[10063];constructor(t,r){super(t,r),this.kind??=10063}static from(t){return new Ix(t.ndk,t.rawEvent())}get servers(){return this.tags.filter(t=>t[0]==="server").map(t=>t[1])}set servers(t){this.tags=this.tags.filter(r=>r[0]!=="server");for(const r of t)this.tags.push(["server",r])}get default(){const t=this.servers;return t.length>0?t[0]:void 0}set default(t){if(!t)return;const n=this.servers.filter(o=>o!==t);this.servers=[t,...n]}addServer(t){if(!t)return;const r=this.servers;r.includes(t)||(this.servers=[...r,t])}removeServer(t){if(!t)return;const r=this.servers;this.servers=r.filter(n=>n!==t)}},NDKFedimintMint=class Ox extends NDKEvent{static kind=38173;static kinds=[38173];constructor(t,r){super(t,r),this.kind??=38173}static async from(t){return new Ox(t.ndk,t)}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get inviteCodes(){return this.getMatchingTags("u").map(t=>t[1])}set inviteCodes(t){this.removeTag("u");for(const r of t)this.tags.push(["u",r])}get modules(){return this.getMatchingTags("modules").map(t=>t[1])}set modules(t){this.removeTag("modules");for(const r of t)this.tags.push(["modules",r])}get network(){return this.tagValue("n")}set network(t){this.removeTag("n"),t&&this.tags.push(["n",t])}get metadata(){if(this.content)try{return JSON.parse(this.content)}catch{return}}set metadata(t){t?this.content=JSON.stringify(t):this.content=""}},NDKCashuMintAnnouncement=class Ux extends NDKEvent{static kind=38172;static kinds=[38172];constructor(t,r){super(t,r),this.kind??=38172}static async from(t){return new Ux(t.ndk,t)}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get url(){return this.tagValue("u")}set url(t){this.removeTag("u"),t&&this.tags.push(["u",t])}get nuts(){return this.getMatchingTags("nuts").map(t=>t[1])}set nuts(t){this.removeTag("nuts");for(const r of t)this.tags.push(["nuts",r])}get network(){return this.tagValue("n")}set network(t){this.removeTag("n"),t&&this.tags.push(["n",t])}get metadata(){if(this.content)try{return JSON.parse(this.content)}catch{return}}set metadata(t){t?this.content=JSON.stringify(t):this.content=""}},NDKMintRecommendation=class Px extends NDKEvent{static kind=38e3;static kinds=[38e3];constructor(t,r){super(t,r),this.kind??=38e3}static async from(t){return new Px(t.ndk,t)}get recommendedKind(){const t=this.tagValue("k");return t?Number(t):void 0}set recommendedKind(t){this.removeTag("k"),t&&this.tags.push(["k",t.toString()])}get identifier(){return this.tagValue("d")}set identifier(t){this.removeTag("d"),t&&this.tags.push(["d",t])}get urls(){return this.getMatchingTags("u").map(t=>t[1])}set urls(t){this.removeTag("u");for(const r of t)this.tags.push(["u",r])}get mintEventPointers(){return this.getMatchingTags("a").map(t=>({kind:Number(t[1].split(":")[0]),identifier:t[1].split(":")[2],relay:t[2]}))}addMintEventPointer(t,r,n,o){const a=["a",`${t}:${r}:${n}`];o&&a.push(o),this.tags.push(a)}get review(){return this.content}set review(t){this.content=t}},NDKClassified=class Mx extends NDKEvent{static kinds=[30402];constructor(t,r){super(t,r),this.kind??=30402}static from(t){return new Mx(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get summary(){return this.tagValue("summary")}set summary(t){this.removeTag("summary"),t&&this.tags.push(["summary",t])}get published_at(){const t=this.tagValue("published_at");if(t)return Number.parseInt(t)}set published_at(t){this.removeTag("published_at"),t!==void 0&&this.tags.push(["published_at",t.toString()])}get location(){return this.tagValue("location")}set location(t){this.removeTag("location"),t&&this.tags.push(["location",t])}get price(){const t=this.tags.find(r=>r[0]==="price");if(t)return{amount:Number.parseFloat(t[1]),currency:t[2],frequency:t[3]}}set price(t){if(typeof t=="string"&&(t={amount:Number.parseFloat(t)}),t?.amount){const r=["price",t.amount.toString()];t.currency&&r.push(t.currency),t.frequency&&r.push(t.frequency),this.tags.push(r)}else this.removeTag("price")}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}},NDKDraft=class Lx extends NDKEvent{_event;static kind=31234;static kinds=[31234,1234];counterparty;constructor(t,r){super(t,r),this.kind??=31234}static from(t){return new Lx(t.ndk,t)}set identifier(t){this.removeTag("d"),this.tags.push(["d",t])}get identifier(){return this.dTag}set event(t){t instanceof NDKEvent?this._event=t:this._event=new NDKEvent(void 0,t),this.prepareEvent()}set checkpoint(t){t?(this.tags.push(t.tagReference()),this.kind=1234):(this.removeTag("a"),this.kind=31234)}get isCheckpoint(){return this.kind===1234}get isProposal(){const t=this.tagValue("p");return!!t&&t!==this.pubkey}async getEvent(t){if(this._event)return this._event;if(t??=this.ndk?.signer,!t)throw new Error("No signer available");if(this.content&&this.content.length>0)try{const r=t.pubkey,o=[this.tagValue("p"),this.pubkey].filter(Boolean).find(u=>u!==r);let a;a=new NDKUser({pubkey:o??r}),await this.decrypt(a,t);const l=JSON.parse(this.content);return this._event=await wrapEvent(new NDKEvent(this.ndk,l)),this._event}catch(r){console.error(r);return}else return null}prepareEvent(){if(!this._event)throw new Error("No event has been provided");this.removeTag("k"),this._event.kind&&this.tags.push(["k",this._event.kind.toString()]),this.content=JSON.stringify(this._event.rawEvent())}async save({signer:t,publish:r,relaySet:n}){if(t??=this.ndk?.signer,!t)throw new Error("No signer available");const o=this.counterparty||await t.user();if(await this.encrypt(o,t),this.counterparty){const a=this.counterparty.pubkey;this.removeTag("p"),this.tags.push(["p",a])}if(r!==!1)return this.publishReplaceable(n)}};function mapImetaTag(e){const t={};if(e.length===2){const n=e[1].split(" ");for(let o=0;o<n.length;o+=2){const a=n[o],l=n[o+1];a==="fallback"?(t.fallback||(t.fallback=[]),t.fallback.push(l)):t[a]=l}return t}const r=e.slice(1);for(const n of r){const o=n.split(" "),a=o[0],l=o.slice(1).join(" ");a==="fallback"?(t.fallback||(t.fallback=[]),t.fallback.push(l)):t[a]=l}return t}function imetaTagToTag(e){const t=["imeta"];for(const[r,n]of Object.entries(e))if(Array.isArray(n))for(const o of n)t.push(`${r} ${o}`);else n&&t.push(`${r} ${n}`);return t}var NDKFollowPack=class Hx extends NDKEvent{static kind=39089;static kinds=[39089,39092];constructor(t,r){super(t,r),this.kind??=39089}static from(t){return new Hx(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get image(){const t=this.tags.find(r=>r[0]==="imeta");if(t){const r=mapImetaTag(t);if(r.url)return r.url}return this.tagValue("image")}set image(t){this.tags=this.tags.filter(r=>r[0]!=="imeta"&&r[0]!=="image"),typeof t=="string"?t!==void 0&&this.tags.push(["image",t]):t&&typeof t=="object"&&(this.tags.push(imetaTagToTag(t)),t.url&&this.tags.push(["image",t.url]))}get pubkeys(){return Array.from(new Set(this.tags.filter(t=>t[0]==="p"&&t[1]&&isValidPubkey(t[1])).map(t=>t[1])))}set pubkeys(t){this.tags=this.tags.filter(r=>r[0]!=="p");for(const r of t)this.tags.push(["p",r])}get description(){return this.tagValue("description")}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}},NDKHighlight=class qx extends NDKEvent{_article;static kind=9802;static kinds=[9802];constructor(t,r){super(t,r),this.kind??=9802}static from(t){return new qx(t.ndk,t)}get url(){return this.tagValue("r")}set context(t){t===void 0?this.tags=this.tags.filter(([r,n])=>r!=="context"):(this.tags=this.tags.filter(([r,n])=>r!=="context"),this.tags.push(["context",t]))}get context(){return this.tags.find(([t,r])=>t==="context")?.[1]??void 0}get article(){return this._article}set article(t){this._article=t,typeof t=="string"?this.tags.push(["r",t]):this.tag(t)}getArticleTag(){return this.getMatchingTags("a")[0]||this.getMatchingTags("e")[0]||this.getMatchingTags("r")[0]}async getArticle(){if(this._article!==void 0)return this._article;let t;const r=this.getArticleTag();if(r){switch(r[0]){case"a":{const[n,o,a]=r[1].split(":");t=nip19_exports$1.naddrEncode({kind:Number.parseInt(n),pubkey:o,identifier:a});break}case"e":t=nip19_exports$1.noteEncode(r[1]);break;case"r":this._article=r[1];break}if(t){let n=await this.ndk?.fetchEvent(t);n&&(n.kind===30023&&(n=NDKArticle.from(n)),this._article=n)}return this._article}}},NDKImage=class Kx extends NDKEvent{static kind=20;static kinds=[20];_imetas;constructor(t,r){super(t,r),this.kind??=20}static from(t){return new Kx(t.ndk,t.rawEvent())}get isValid(){return this.imetas.length>0}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(t=>t[0]==="imeta").map(mapImetaTag).filter(t=>!!t.url),this._imetas)}set imetas(t){this._imetas=t,this.tags=this.tags.filter(r=>r[0]!=="imeta"),this.tags.push(...t.map(imetaTagToTag))}},NDKList=class zx extends NDKEvent{_encryptedTags;static kinds=[30001,10004,10050,10030,10015,10001,10002,10007,10006,10003];encryptedTagsLength;constructor(t,r){super(t,r),this.kind??=30001}static from(t){return new zx(t.ndk,t)}get title(){const t=this.tagValue("title")||this.tagValue("name");return t||(this.kind===3?"Contacts":this.kind===1e4?"Mute":this.kind===10001?"Pinned Notes":this.kind===10002?"Relay Metadata":this.kind===10003?"Bookmarks":this.kind===10004?"Communities":this.kind===10005?"Public Chats":this.kind===10006?"Blocked Relays":this.kind===10007?"Search Relays":this.kind===10050?"Direct Message Receive Relays":this.kind===10015?"Interests":this.kind===10030?"Emojis":this.tagValue("d"))}set title(t){this.removeTag(["title","name"]),t&&this.tags.push(["title",t])}get name(){return this.title}set name(t){this.title=t}get description(){return this.tagValue("description")}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}isEncryptedTagsCacheValid(){return!!(this._encryptedTags&&this.encryptedTagsLength===this.content.length)}async encryptedTags(t=!0){if(t&&this.isEncryptedTagsCacheValid())return this._encryptedTags;if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const r=await this.ndk.signer.user();try{if(this.content.length>0)try{const n=await this.ndk.signer.decrypt(r,this.content),o=JSON.parse(n);return o?.[0]?(this.encryptedTagsLength=this.content.length,this._encryptedTags=o):(this.encryptedTagsLength=this.content.length,this._encryptedTags=[])}catch{}}catch{}return[]}validateTag(t){return!0}getItems(t){return this.tags.filter(r=>r[0]===t)}get items(){return this.tags.filter(t=>!["d","L","l","title","name","description","published_at","summary","image","thumb","alt","expiration","subject","client"].includes(t[0]))}async addItem(t,r=void 0,n=!1,o="bottom"){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");let a;if(t instanceof NDKEvent)a=[t.tagReference(r)];else if(t instanceof NDKUser)a=t.referenceTags();else if(t instanceof NDKRelay)a=t.referenceTags();else if(Array.isArray(t))a=[t];else throw new Error("Invalid object type");if(r&&a[0].push(r),n){const l=await this.ndk.signer.user(),u=await this.encryptedTags();o==="top"?u.unshift(...a):u.push(...a),this._encryptedTags=u,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(u),await this.encrypt(l)}else o==="top"?this.tags.unshift(...a):this.tags.push(...a);this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItemByValue(t,r=!0){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const n=this.tags.findIndex(u=>u[1]===t);n>=0&&this.tags.splice(n,1);const o=await this.ndk.signer.user(),a=await this.encryptedTags(),l=a.findIndex(u=>u[1]===t);if(l>=0&&(a.splice(l,1),this._encryptedTags=a,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(a),await this.encrypt(o)),r)return this.publishReplaceable();this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItem(t,r){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");if(r){const n=await this.ndk.signer.user(),o=await this.encryptedTags();o.splice(t,1),this._encryptedTags=o,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(o),await this.encrypt(n)}else this.tags.splice(t,1);return this.created_at=Math.floor(Date.now()/1e3),this.emit("change"),this}has(t){return this.items.some(r=>r[1]===t)}filterForItems(){const t=new Set,r=new Map,n=[];for(const o of this.items)if(o[0]==="e"&&o[1])t.add(o[1]);else if(o[0]==="a"&&o[1]){const[a,l,u]=o[1].split(":");if(!a||!l)continue;const f=`${a}:${l}`,x=r.get(f)||[];x.push(u||""),r.set(f,x)}if(t.size>0&&n.push({ids:Array.from(t)}),r.size>0)for(const[o,a]of r.entries()){const[l,u]=o.split(":");n.push({kinds:[Number.parseInt(l)],authors:[u],"#d":a})}return n}},NDKAppHandlerEvent=class Vx extends NDKEvent{profile;static kinds=[31990];constructor(t,r){super(t,r),this.kind??=31990}static from(t){const r=new Vx(t.ndk,t.rawEvent());return r.isValid?r:null}get isValid(){const t=new Map,r=o=>[o[0],o[2]].join(":").toLowerCase(),n=["web","android","ios"];for(const o of this.tags)if(n.includes(o[0])){const a=r(o);if(t.has(a)&&t.get(a)!==o[1].toLowerCase())return!1;t.set(a,o[1].toLowerCase())}return!0}async fetchProfile(){if(this.profile===void 0&&this.content.length>0)try{const t=JSON.parse(this.content);if(t?.name)return t;this.profile=null}catch{this.profile=null}return new Promise((t,r)=>{const n=this.author;n.fetchProfile().then(()=>{t(n.profile)}).catch(r)})}},NDKNutzap=class Mc extends NDKEvent{debug;_proofs=[];static kind=9321;static kinds=[Mc.kind];constructor(t,r){super(t,r),this.kind??=9321,this.debug=t?.debug.extend("nutzap")??createDebug5("ndk:nutzap"),this.alt||(this.alt="This is a nutzap");try{const n=this.getMatchingTags("proof");n.length?this._proofs=n.map(o=>JSON.parse(o[1])):this._proofs=JSON.parse(this.content)}catch{return}}static from(t){const r=new Mc(t.ndk,t);if(!(!r._proofs||!r._proofs.length))return r}set comment(t){this.content=t??""}get comment(){const t=this.tagValue("comment");return t||this.content}set proofs(t){this._proofs=t,this.tags=this.tags.filter(r=>r[0]!=="proof");for(const r of t)this.tags.push(["proof",JSON.stringify(r)])}get proofs(){return this._proofs}get rawP2pk(){const t=this.proofs[0];try{const r=JSON.parse(t.secret);let n;if(typeof r=="string"?(n=JSON.parse(r),this.debug("stringified payload",t.secret)):typeof r=="object"&&(n=r),Array.isArray(n)&&n[0]==="P2PK"&&n.length>1&&typeof n[1]=="object"&&n[1]!==null||typeof n=="object"&&n!==null&&typeof n[1]?.data=="string")return n[1].data}catch(r){this.debug("error parsing p2pk pubkey",r,this.proofs[0])}}get p2pk(){const t=this.rawP2pk;if(t)return t.startsWith("02")?t.slice(2):t}get mint(){return this.tagValue("u")}set mint(t){this.replaceTag(["u",t])}get unit(){let t=this.tagValue("unit")??"sat";return t?.startsWith("msat")&&(t="sat"),t}set unit(t){if(this.removeTag("unit"),t?.startsWith("msat"))throw new Error("msat is not allowed, use sat denomination instead");t&&this.tag(["unit",t])}get amount(){return this.proofs.reduce((r,n)=>r+n.amount,0)}sender=this.author;set target(t){this.tags=this.tags.filter(r=>r[0]!=="p"),t instanceof NDKEvent&&this.tags.push(t.tagReference())}set recipientPubkey(t){this.removeTag("p"),this.tag(["p",t])}get recipientPubkey(){return this.tagValue("p")}get recipient(){const t=this.recipientPubkey;return this.ndk?this.ndk.getUser({pubkey:t}):new NDKUser({pubkey:t})}async toNostrEvent(){this.unit==="msat"&&(this.unit="sat"),this.removeTag("amount"),this.tags.push(["amount",this.amount.toString()]);const t=await super.toNostrEvent();return t.content=this.comment,t}get isValid(){let t=0,r=0,n=0;for(const o of this.tags)o[0]==="e"&&t++,o[0]==="p"&&r++,o[0]==="u"&&n++;return r===1&&n===1&&t<=1&&this.proofs.length>0}},NDKProject=class Gx extends NDKEvent{static kind=31933;static kinds=[31933];_signer;constructor(t,r){super(t,r),this.kind=31933}static from(t){return new Gx(t.ndk,t.rawEvent())}set repo(t){this.removeTag("repo"),t&&this.tags.push(["repo",t])}set hashtags(t){this.removeTag("hashtags"),t.filter(r=>r.length>0).length&&this.tags.push(["hashtags",...t])}get hashtags(){const t=this.tags.find(r=>r[0]==="hashtags");return t?t.slice(1):[]}get repo(){return this.tagValue("repo")}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get picture(){return this.tagValue("picture")}set picture(t){this.removeTag("picture"),t&&this.tags.push(["picture",t])}set description(t){this.content=t}get description(){return this.content}get slug(){return this.dTag??"empty-dtag"}async getSigner(){if(this._signer)return this._signer;const t=this.tagValue("key");if(!t)this._signer=NDKPrivateKeySigner.generate(),await this.encryptAndSaveNsec();else{const r=await this.ndk?.signer?.decrypt(this.ndk.activeUser,t);if(!r)throw new Error("Failed to decrypt project key or missing signer context.");this._signer=new NDKPrivateKeySigner(r)}return this._signer}async getNsec(){return(await this.getSigner()).privateKey}async setNsec(t){this._signer=new NDKPrivateKeySigner(t),await this.encryptAndSaveNsec()}async encryptAndSaveNsec(){if(!this._signer)throw new Error("Signer is not set.");const t=this._signer.privateKey,r=await this.ndk?.signer?.encrypt(this.ndk.activeUser,t);r&&(this.removeTag("key"),this.tags.push(["key",r]))}},NDKProjectTemplate=class Wx extends NDKEvent{static kind=30717;static kinds=[30717];constructor(t,r){super(t,r),this.kind=30717}static from(t){return new Wx(t.ndk,t.rawEvent())}get templateId(){return this.dTag??""}set templateId(t){this.dTag=t}get name(){return this.tagValue("title")??""}set name(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get description(){return this.tagValue("description")??""}set description(t){this.removeTag("description"),t&&this.tags.push(["description",t])}get repoUrl(){return this.tagValue("uri")??""}set repoUrl(t){this.removeTag("uri"),t&&this.tags.push(["uri",t])}get image(){return this.tagValue("image")}set image(t){this.removeTag("image"),t&&this.tags.push(["image",t])}get command(){return this.tagValue("command")}set command(t){this.removeTag("command"),t&&this.tags.push(["command",t])}get agentConfig(){const t=this.tagValue("agent");if(t)try{return JSON.parse(t)}catch{return}}set agentConfig(t){this.removeTag("agent"),t&&this.tags.push(["agent",JSON.stringify(t)])}get templateTags(){return this.getMatchingTags("t").map(t=>t[1]).filter(Boolean)}set templateTags(t){this.tags=this.tags.filter(r=>r[0]!=="t"),t.forEach(r=>{r&&this.tags.push(["t",r])})}},READ_MARKER="read",WRITE_MARKER="write",NDKRelayList=class Xx extends NDKEvent{static kinds=[10002];constructor(t,r){super(t,r),this.kind??=10002}static from(t){return new Xx(t.ndk,t.rawEvent())}get readRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]||t[2]&&t[2]===READ_MARKER).map(t=>tryNormalizeRelayUrl(t[1])).filter(t=>!!t)}set readRelayUrls(t){for(const r of t)this.tags.push(["r",r,READ_MARKER])}get writeRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]||t[2]&&t[2]===WRITE_MARKER).map(t=>tryNormalizeRelayUrl(t[1])).filter(t=>!!t)}set writeRelayUrls(t){for(const r of t)this.tags.push(["r",r,WRITE_MARKER])}get bothRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]).map(t=>t[1])}set bothRelayUrls(t){for(const r of t)this.tags.push(["r",r])}get relays(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").map(t=>t[1])}get relaySet(){if(!this.ndk)throw new Error("NDKRelayList has no NDK instance");return new NDKRelaySet(new Set(this.relays.map(t=>this.ndk?.pool.getRelay(t)).filter(t=>!!t)),this.ndk)}};function relayListFromKind3(e,t){try{const r=JSON.parse(t.content),n=new NDKRelayList(e),o=new Set,a=new Set;for(let[l,u]of Object.entries(r)){try{l=normalizeRelayUrl(l)}catch{continue}if(!u)o.add(l),a.add(l);else{const f=u;f.write&&a.add(l),f.read&&o.add(l)}}return n.readRelayUrls=Array.from(o),n.writeRelayUrls=Array.from(a),n}catch{}}var NDKRepost=class Yx extends NDKEvent{_repostedEvents;static kinds=[6,16];static from(t){return new Yx(t.ndk,t.rawEvent())}async repostedEvents(t,r){const n=[];if(!this.ndk)throw new Error("NDK instance not set");if(this._repostedEvents!==void 0)return this._repostedEvents;for(const o of this.repostedEventIds()){const a=filterForId(o),l=await this.ndk.fetchEvent(a,r);l&&n.push(t?t.from(l):l)}return n}repostedEventIds(){return this.tags.filter(t=>t[0]==="e"||t[0]==="a").map(t=>t[1])}};function filterForId(e){if(e.match(/:/)){const[t,r,n]=e.split(":");return{kinds:[Number.parseInt(t)],authors:[r],"#d":[n]}}return{ids:[e]}}var NDKSimpleGroupMemberList=class Zx extends NDKEvent{relaySet;memberSet=new Set;static kind=39002;static kinds=[39002];constructor(t,r){super(t,r),this.kind??=39002,this.memberSet=new Set(this.members)}static from(t){return new Zx(t.ndk,t)}get members(){return this.getMatchingTags("p").map(t=>t[1])}hasMember(t){return this.memberSet.has(t)}async publish(t,r,n){return t??=this.relaySet,super.publishReplaceable(t,r,n)}},NDKSimpleGroupMetadata=class Qx extends NDKEvent{static kind=39e3;static kinds=[39e3];constructor(t,r){super(t,r),this.kind??=39e3}static from(t){return new Qx(t.ndk,t)}get name(){return this.tagValue("name")}get picture(){return this.tagValue("picture")}get about(){return this.tagValue("about")}get scope(){if(this.getMatchingTags("public").length>0)return"public";if(this.getMatchingTags("public").length>0)return"private"}set scope(t){this.removeTag("public"),this.removeTag("private"),t==="public"?this.tags.push(["public",""]):t==="private"&&this.tags.push(["private",""])}get access(){if(this.getMatchingTags("open").length>0)return"open";if(this.getMatchingTags("closed").length>0)return"closed"}set access(t){this.removeTag("open"),this.removeTag("closed"),t==="open"?this.tags.push(["open",""]):t==="closed"&&this.tags.push(["closed",""])}};function strToPosition(e){const[t,r]=e.split(",").map(Number);return{x:t,y:r}}function strToDimension(e){const[t,r]=e.split("x").map(Number);return{width:t,height:r}}var NDKStorySticker=class Jx{static Text="text";static Pubkey="pubkey";static Event="event";static Prompt="prompt";static Countdown="countdown";type;value;position;dimension;properties;constructor(t){if(Array.isArray(t)){const r=t;if(r[0]!=="sticker"||r.length<5)throw new Error("Invalid sticker tag");this.type=r[1],this.value=r[2],this.position=strToPosition(r[3]),this.dimension=strToDimension(r[4]);const n={};for(let o=5;o<r.length;o++){const[a,...l]=r[o].split(" ");n[a]=l.join(" ")}Object.keys(n).length>0&&(this.properties=n)}else this.type=t,this.value=void 0,this.position={x:0,y:0},this.dimension={width:0,height:0}}static fromTag(t){try{return new Jx(t)}catch{return null}}get style(){return this.properties?.style}set style(t){t?this.properties={...this.properties,style:t}:delete this.properties?.style}get rotation(){return this.properties?.rot?Number.parseFloat(this.properties.rot):void 0}set rotation(t){t!==void 0?this.properties={...this.properties,rot:t.toString()}:delete this.properties?.rot}get isValid(){return this.hasValidDimensions()&&this.hasValidPosition()}hasValidDimensions=()=>typeof this.dimension.width=="number"&&typeof this.dimension.height=="number"&&!Number.isNaN(this.dimension.width)&&!Number.isNaN(this.dimension.height);hasValidPosition=()=>typeof this.position.x=="number"&&typeof this.position.y=="number"&&!Number.isNaN(this.position.x)&&!Number.isNaN(this.position.y);toTag(){if(!this.isValid){const n=[this.hasValidDimensions()?void 0:"dimensions is invalid",this.hasValidPosition()?void 0:"position is invalid"].filter(Boolean);throw new Error(`Invalid sticker: ${n.join(", ")}`)}let t;switch(this.type){case"event":t=this.value.tagId();break;case"pubkey":t=this.value.pubkey;break;default:t=this.value}const r=["sticker",this.type,t,coordinates(this.position),dimension(this.dimension)];if(this.properties)for(const[n,o]of Object.entries(this.properties))r.push(`${n} ${o}`);return r}},NDKStory=class ef extends NDKEvent{static kind=23;static kinds=[23];_imeta;_dimensions;constructor(t,r){if(super(t,r),this.kind??=23,r)for(const n of r.tags)switch(n[0]){case"imeta":this._imeta=mapImetaTag(n);break;case"dim":this.dimensions=strToDimension(n[1]);break}}static from(t){return new ef(t.ndk,t)}get isValid(){return!!this.imeta}get imeta(){return this._imeta}set imeta(t){this._imeta=t,this.tags=this.tags.filter(r=>r[0]!=="imeta"),t&&this.tags.push(imetaTagToTag(t))}get dimensions(){const t=this.tagValue("dim");if(t)return strToDimension(t)}set dimensions(t){this.removeTag("dim"),t&&this.tags.push(["dim",`${t.width}x${t.height}`])}get duration(){const t=this.tagValue("dur");if(t)return Number.parseInt(t)}set duration(t){this.removeTag("dur"),t!==void 0&&this.tags.push(["dur",t.toString()])}get stickers(){const t=[];for(const r of this.tags){if(r[0]!=="sticker"||r.length<5)continue;const n=NDKStorySticker.fromTag(r);n&&t.push(n)}return t}addSticker(t){let r;if(t instanceof NDKStorySticker)r=t;else{const n=["sticker",t.type,typeof t.value=="string"?t.value:"",coordinates(t.position),dimension(t.dimension)];if(t.properties)for(const[o,a]of Object.entries(t.properties))n.push(`${o} ${a}`);r=new NDKStorySticker(n),r.value=t.value}r.type==="pubkey"?this.tag(r.value):r.type==="event"&&this.tag(r.value),this.tags.push(r.toTag())}removeSticker(t){const r=this.stickers;if(t<0||t>=r.length)return;let n=0;for(let o=0;o<this.tags.length;o++)if(this.tags[o][0]==="sticker"){if(n===t){this.tags.splice(o,1);break}n++}}},coordinates=e=>`${e.x},${e.y}`,dimension=e=>`${e.width}x${e.height}`,NDKSubscriptionReceipt=class tf extends NDKEvent{debug;static kinds=[7003];constructor(t,r){super(t,r),this.kind??=7003,this.debug=t?.debug.extend("subscription-start")??createDebug5("ndk:subscription-start")}static from(t){return new tf(t.ndk,t.rawEvent())}get recipient(){const t=this.getMatchingTags("p")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set recipient(t){this.removeTag("p"),t&&this.tags.push(["p",t.pubkey])}get subscriber(){const t=this.getMatchingTags("P")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set subscriber(t){this.removeTag("P"),t&&this.tags.push(["P",t.pubkey])}set subscriptionStart(t){this.debug(`before setting subscription start: ${this.rawEvent}`),this.removeTag("e"),this.tag(t,"subscription",!0),this.debug(`after setting subscription start: ${this.rawEvent}`)}get tierName(){return this.getMatchingTags("tier")?.[0]?.[1]}get isValid(){const t=this.validPeriod;if(!t||t.start>t.end)return!1;const r=this.getMatchingTags("p"),n=this.getMatchingTags("P");return!(r.length!==1||n.length!==1)}get validPeriod(){const t=this.getMatchingTags("valid")?.[0];if(t)try{return{start:new Date(Number.parseInt(t[1])*1e3),end:new Date(Number.parseInt(t[2])*1e3)}}catch{return}}set validPeriod(t){this.removeTag("valid"),t&&this.tags.push(["valid",Math.floor(t.start.getTime()/1e3).toString(),Math.floor(t.end.getTime()/1e3).toString()])}get startPeriod(){return this.validPeriod?.start}get endPeriod(){return this.validPeriod?.end}isActive(t){t??=new Date;const r=this.validPeriod;return!(!r||t<r.start||t>r.end)}},possibleIntervalFrequencies=["daily","weekly","monthly","quarterly","yearly"];function newAmount(e,t,r){return["amount",e.toString(),t,r]}function parseTagToSubscriptionAmount(e){const t=Number.parseInt(e[1]);if(Number.isNaN(t)||t===void 0||t===null||t<=0)return;const r=e[2];if(r===void 0||r==="")return;const n=e[3];if(n!==void 0&&possibleIntervalFrequencies.includes(n))return{amount:t,currency:r,term:n}}var NDKSubscriptionTier=class rf extends NDKArticle{static kind=37001;static kinds=[37001];constructor(t,r){const n=r?.kind??37001;super(t,r),this.kind=n}static from(t){return new rf(t.ndk,t)}get perks(){return this.getMatchingTags("perk").map(t=>t[1]).filter(t=>t!==void 0)}addPerk(t){this.tags.push(["perk",t])}get amounts(){return this.getMatchingTags("amount").map(t=>parseTagToSubscriptionAmount(t)).filter(t=>t!==void 0)}addAmount(t,r,n){this.tags.push(newAmount(t,r,n))}set relayUrl(t){this.tags.push(["r",t])}get relayUrls(){return this.getMatchingTags("r").map(t=>t[1]).filter(t=>t!==void 0)}get verifierPubkey(){return this.tagValue("p")}set verifierPubkey(t){this.removeTag("p"),t&&this.tags.push(["p",t])}get isValid(){return this.title!==void 0&&this.amounts.length>0}},NDKSubscriptionStart=class nf extends NDKEvent{debug;static kinds=[7001];constructor(t,r){super(t,r),this.kind??=7001,this.debug=t?.debug.extend("subscription-start")??createDebug5("ndk:subscription-start")}static from(t){return new nf(t.ndk,t.rawEvent())}get recipient(){const t=this.getMatchingTags("p")?.[0];return t?new NDKUser({pubkey:t[1]}):void 0}set recipient(t){this.removeTag("p"),t&&this.tags.push(["p",t.pubkey])}get amount(){const t=this.getMatchingTags("amount")?.[0];if(t)return parseTagToSubscriptionAmount(t)}set amount(t){this.removeTag("amount"),t&&this.tags.push(newAmount(t.amount,t.currency,t.term))}get tierId(){const t=this.getMatchingTags("e")?.[0],r=this.getMatchingTags("a")?.[0];if(!(!t||!r))return t[1]??r[1]}set tier(t){this.removeTag("e"),this.removeTag("a"),this.removeTag("event"),t&&(this.tag(t),this.removeTag("p"),this.tags.push(["p",t.pubkey]),this.tags.push(["event",JSON.stringify(t.rawEvent())]))}async fetchTier(){const t=this.tagValue("event");if(t)try{const o=JSON.parse(t);return new NDKSubscriptionTier(this.ndk,o)}catch{this.debug("Failed to parse event tag")}const r=this.tierId;if(!r)return;const n=await this.ndk?.fetchEvent(r);if(n)return NDKSubscriptionTier.from(n)}get isValid(){return this.getMatchingTags("amount").length!==1?(this.debug("Invalid # of amount tag"),!1):this.amount?this.getMatchingTags("p").length!==1?(this.debug("Invalid # of p tag"),!1):this.recipient?!0:(this.debug("Invalid p tag"),!1):(this.debug("Invalid amount tag"),!1)}},NDKTask=class sf extends NDKEvent{static kind=1934;static kinds=[1934];constructor(t,r){super(t,r),this.kind=1934}static from(t){return new sf(t.ndk,t.rawEvent())}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get title(){return this.tagValue("title")}set project(t){this.removeTag("a"),this.tags.push(t.tagReference())}get projectSlug(){const t=this.getMatchingTags("a")[0];return t?t[1].split(/:/)?.[2]:void 0}},NDKThread=class of extends NDKEvent{static kind=11;static kinds=[11];constructor(t,r){super(t,r),this.kind??=11}static from(t){return new of(t.ndk,t)}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}},NDKVideo=class af extends NDKEvent{static kind=21;static kinds=[34235,34236,22,21];_imetas;static from(t){return new af(t.ndk,t.rawEvent())}get title(){return this.tagValue("title")}set title(t){this.removeTag("title"),t&&this.tags.push(["title",t])}get thumbnail(){let t;return this.imetas&&this.imetas.length>0&&(t=this.imetas[0].image?.[0]),t??this.tagValue("thumb")}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(t=>t[0]==="imeta").map(mapImetaTag),this._imetas)}set imetas(t){this._imetas=t,this.tags=this.tags.filter(r=>r[0]!=="imeta"),this.tags.push(...t.map(imetaTagToTag))}get url(){return this.imetas&&this.imetas.length>0?this.imetas[0].url:this.tagValue("url")}get published_at(){const t=this.tagValue("published_at");if(t)return Number.parseInt(t)}async generateTags(){if(super.generateTags(),!this.kind&&this.imetas?.[0]?.dim){const[t,r]=this.imetas[0].dim.split("x"),n=t&&r&&Number.parseInt(t)<Number.parseInt(r);this.duration&&this.duration<120&&n?this.kind=22:this.kind=21}return super.generateTags()}get duration(){const t=this.tagValue("duration");if(t)return Number.parseInt(t)}set duration(t){this.removeTag("duration"),t!==void 0&&this.tags.push(["duration",Math.floor(t).toString()])}},NDKWiki=class cf extends NDKArticle{static kind=30818;static kinds=[30818];static from(t){return new cf(t.ndk,t.rawEvent())}get isDefered(){return this.hasTag("a","defer")}get deferedId(){return this.tagValue("a","defer")}set defer(t){this.removeTag("a","defer"),this.tag(t,"defer")}},NDKWikiMergeRequest=class lf extends NDKEvent{static kinds=[818];static from(t){return new lf(t.ndk,t.rawEvent())}get targetId(){return this.tagValue("a")}set target(t){this.tags=this.tags.filter(r=>{if(r[0]==="a"||r[0]==="e"&&r[3]!=="source")return!0}),this.tag(t)}get sourceId(){return this.tagValue("e","source")}set source(t){this.removeTag("e","source"),this.tag(t,"source",!1,"e")}},registeredEventClasses=new Set;function wrapEvent(e){const t=new Map,n=[...[NDKImage,NDKVideo,NDKCashuMintList,NDKArticle,NDKHighlight,NDKDraft,NDKWiki,NDKWikiMergeRequest,NDKNutzap,NDKProject,NDKTask,NDKProjectTemplate,NDKSimpleGroupMemberList,NDKSimpleGroupMetadata,NDKSubscriptionTier,NDKSubscriptionStart,NDKSubscriptionReceipt,NDKList,NDKRelayList,NDKStory,NDKBlossomList,NDKFollowPack,NDKThread,NDKRepost,NDKClassified,NDKAppHandlerEvent,NDKDVMJobFeedback,NDKCashuMintAnnouncement,NDKFedimintMint,NDKMintRecommendation],...registeredEventClasses];for(const a of n)for(const l of a.kinds)t.set(l,a);const o=t.get(e.kind);return o?o.from(e):e}function checkMissingKind(e,t){(e.kind===void 0||e.kind===null)&&t("event-missing-kind",`Cannot sign event without 'kind'.

 Event data:
    content: ${e.content?`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`:"(empty)"}
    tags: ${e.tags.length} tag${e.tags.length!==1?"s":""}
    kind: ${e.kind} 

Set event.kind before signing.`,"Example: event.kind = 1; // for text note",!1)}function checkContentIsObject(e,t){if(typeof e.content=="object"){const r=JSON.stringify(e.content,null,2).substring(0,200);t("event-content-is-object",`Event content is an object. Content must be a string.

 Your content (${typeof e.content}):
${r}${JSON.stringify(e.content).length>200?"...":""}

 event.content = { ... }  // WRONG
 event.content = JSON.stringify({ ... })  // CORRECT`,"Use JSON.stringify() for structured data: event.content = JSON.stringify(data)",!1)}}function checkCreatedAtMilliseconds(e,t){if(e.created_at&&e.created_at>1e10){const r=Math.floor(e.created_at/1e3),n=new Date(e.created_at).toISOString();t("event-created-at-milliseconds",`Event created_at is in milliseconds, not seconds.

 Your value:
    created_at: ${e.created_at} 
    Interpreted as: ${n}
    Should be: ${r} 

Nostr timestamps MUST be in seconds since Unix epoch.`,"Use Math.floor(Date.now() / 1000) instead of Date.now()",!1)}}function checkInvalidPTags(e,t){e.getMatchingTags("p").forEach((n,o)=>{if(n[1]&&!/^[0-9a-f]{64}$/i.test(n[1])){const a=JSON.stringify(n);t("tag-invalid-p-tag",`p-tag[${o}] has invalid pubkey.

 Your tag:
   ${a}

 Invalid value: "${n[1]}"
    Length: ${n[1].length} (expected 64)
    Format: ${n[1].startsWith("npub")?"bech32 (npub)":"unknown"}

p-tags MUST contain 64-character hex pubkeys.`,n[1].startsWith("npub")?`Use ndkUser.pubkey instead of npub:
    event.tags.push(['p', ndkUser.pubkey])
    event.tags.push(['p', 'npub1...'])`:"p-tags must contain valid hex pubkeys (64 characters, 0-9a-f)",!1)}})}function checkInvalidETags(e,t){e.getMatchingTags("e").forEach((n,o)=>{if(n[1]&&!/^[0-9a-f]{64}$/i.test(n[1])){const a=JSON.stringify(n),l=n[1].startsWith("note")||n[1].startsWith("nevent");t("tag-invalid-e-tag",`e-tag[${o}] has invalid event ID.

 Your tag:
   ${a}

 Invalid value: "${n[1]}"
    Length: ${n[1].length} (expected 64)
    Format: ${l?"bech32 (note/nevent)":"unknown"}

e-tags MUST contain 64-character hex event IDs.`,l?`Use event.id instead of bech32:
    event.tags.push(['e', referencedEvent.id])
    event.tags.push(['e', 'note1...'])`:"e-tags must contain valid hex event IDs (64 characters, 0-9a-f)",!1)}})}function checkManualReplyMarkers(e,t,r){if(e.kind!==1||r.has(e))return;const n=e.tags.filter(o=>o[0]==="e"&&(o[3]==="reply"||o[3]==="root"));if(n.length>0){const o=n.map((a,l)=>`   ${l+1}. ${JSON.stringify(a)}`).join(`
`);t("event-manual-reply-markers",`Event has ${n.length} e-tag(s) with manual reply/root markers.

 Your tags with markers:
${o}

  Manual reply markers detected! This will cause incorrect threading.`,`Reply events MUST be created using .reply():

    CORRECT:
   const replyEvent = originalEvent.reply();
   replyEvent.content = 'good point!';
   await replyEvent.publish();

    WRONG:
   event.tags.push(['e', eventId, '', 'reply']);

NDK handles all reply threading automatically - never add reply/root markers manually.`)}}function checkHashtagsWithPrefix(e,t){e.getMatchingTags("t").forEach((n,o)=>{if(n[1]&&n[1].startsWith("#")){const a=JSON.stringify(n);t("tag-hashtag-with-prefix",`t-tag[${o}] contains hashtag with # prefix.

 Your tag:
   ${a}

 Invalid value: "${n[1]}"

Hashtag tags should NOT include the # symbol.`,`Remove the # prefix from hashtag tags:
    event.tags.push(['t', 'nostr'])
    event.tags.push(['t', '#nostr'])`,!1)}})}function checkReplaceableWithOldTimestamp(e,t){if(e.kind===void 0||e.kind===null||!e.created_at||!e.isReplaceable())return;const r=Math.floor(Date.now()/1e3),n=r-e.created_at;if(n>10){const a=Math.floor(n/60),l=a>0?`${a} minute${a!==1?"s":""}`:`${n} seconds`;t("event-replaceable-old-timestamp",`Publishing a replaceable event with an old created_at timestamp.

 Event details:
    kind: ${e.kind} (replaceable)
    created_at: ${e.created_at}
    age: ${l} old
    current time: ${r}

  This is wrong and will be rejected by relays.`,`For replaceable events, use publishReplaceable():

    CORRECT:
   await event.publishReplaceable();
   // Automatically updates created_at to now

    WRONG:
   await event.publish();
   // Uses old created_at`)}}function signing(e,t,r,n){checkMissingKind(e,t),checkContentIsObject(e,t),checkCreatedAtMilliseconds(e,t),checkInvalidPTags(e,t),checkInvalidETags(e,t),checkHashtagsWithPrefix(e,t),checkManualReplyMarkers(e,r,n)}function publishing(e,t){checkReplaceableWithOldTimestamp(e,t)}function isNip33Pattern(e){const t=Array.isArray(e)?e:[e];if(t.length!==1)return!1;const r=t[0];return r.kinds&&Array.isArray(r.kinds)&&r.kinds.length===1&&r.authors&&Array.isArray(r.authors)&&r.authors.length===1&&r["#d"]&&Array.isArray(r["#d"])&&r["#d"].length===1}function isReplaceableEventFilter(e){const t=Array.isArray(e)?e:[e];return t.length===0?!1:t.every(r=>!r.kinds||!Array.isArray(r.kinds)||r.kinds.length===0||!r.authors||!Array.isArray(r.authors)||r.authors.length===0?!1:r.kinds.every(o=>o===0||o===3||o>=1e4&&o<=19999))}function formatFilter(e){return JSON.stringify(e,null,2).split(`
`).map((r,n)=>n===0?r:`   ${r}`).join(`
`)}function fetchingEvents(e,t,r,n,o){if(o(),t?.cacheUsage==="ONLY_CACHE")return;const a=Array.isArray(e)?e:[e],l=a.map(formatFilter).join(`

   ---

   `);if(isNip33Pattern(e))a[0],r("fetch-events-usage",`For fetching a NIP-33 addressable event, use fetchEvent() with the naddr directly.

 Your filter:
   `+l+`

   BAD:  const decoded = nip19.decode(naddr);
           const events = await ndk.fetchEvents({
             kinds: [decoded.data.kind],
             authors: [decoded.data.pubkey],
             "#d": [decoded.data.identifier]
           });
           const event = Array.from(events)[0];

   GOOD: const event = await ndk.fetchEvent(naddr);
   GOOD: const event = await ndk.fetchEvent('naddr1...');

fetchEvent() handles naddr decoding automatically and returns the event directly.`);else{if(isReplaceableEventFilter(e))return;{if(!n())return;let u="";const f=a.some(g=>g.limit!==void 0),x=new Set(a.flatMap(g=>g.kinds||[])).size,p=new Set(a.flatMap(g=>g.authors||[])).size;if(f){const g=Math.max(...a.map(y=>y.limit||0));u+=`
    Limit: ${g} event${g!==1?"s":""}`}x>0&&(u+=`
    Kinds: ${x} type${x!==1?"s":""}`),p>0&&(u+=`
    Authors: ${p} author${p!==1?"s":""}`),r("fetch-events-usage",`fetchEvents() is a BLOCKING operation that waits for EOSE.
In most cases, you should use subscribe() instead.

 Your filter`+(a.length>1?"s":"")+`:
   `+l+(u?`

 Filter analysis:`+u:"")+`

   BAD:  const events = await ndk.fetchEvents(filter);
   GOOD: ndk.subscribe(filter, { onEvent: (e) => ... });

Only use fetchEvents() when you MUST block until data arrives.`,"For one-time queries, use fetchEvent() instead of fetchEvents() when expecting a single result.")}}}var GuardrailCheckId={NDK_NO_CACHE:"ndk-no-cache",FILTER_BECH32_IN_ARRAY:"filter-bech32-in-array",FILTER_INVALID_HEX:"filter-invalid-hex",FILTER_ONLY_LIMIT:"filter-only-limit",FILTER_EMPTY:"filter-empty",FILTER_SINCE_AFTER_UNTIL:"filter-since-after-until",FILTER_INVALID_A_TAG:"filter-invalid-a-tag",FILTER_HASHTAG_WITH_PREFIX:"filter-hashtag-with-prefix"};function checkCachePresence(e,t){t(GuardrailCheckId.NDK_NO_CACHE)&&setTimeout(()=>{if(!e.cacheAdapter){const o=`
 AI_GUARDRAILS WARNING: NDK initialized without a cache adapter. Apps perform significantly better with caching.

 ${typeof window<"u"?"Consider using @nostr-dev-kit/ndk-cache-dexie or @nostr-dev-kit/ndk-cache-sqlite-wasm":"Consider using @nostr-dev-kit/ndk-cache-redis or @nostr-dev-kit/ndk-cache-sqlite"}

 To disable this check:
   ndk.aiGuardrails.skip('${GuardrailCheckId.NDK_NO_CACHE}')
   or set: ndk.aiGuardrails = { skip: new Set(['${GuardrailCheckId.NDK_NO_CACHE}']) }`;console.warn(o)}},2500)}var AIGuardrails=class{enabled=!1;skipSet=new Set;extensions=new Map;_nextCallDisabled=null;_replyEvents=new WeakSet;_fetchEventsCount=0;_subscribeCount=0;constructor(e=!1){this.setMode(e)}register(e,t){this.extensions.has(e)&&console.warn(`AIGuardrails: Extension '${e}' already registered, overwriting`);const r={};for(const[n,o]of Object.entries(t))typeof o=="function"&&(r[n]=(...a)=>{this.enabled&&o(...a,this.shouldCheck.bind(this),this.error.bind(this),this.warn.bind(this))});this.extensions.set(e,r),this[e]=r}setMode(e){typeof e=="boolean"?(this.enabled=e,this.skipSet.clear()):e&&typeof e=="object"&&(this.enabled=!0,this.skipSet=e.skip||new Set)}isEnabled(){return this.enabled}shouldCheck(e){return!(!this.enabled||this.skipSet.has(e)||this._nextCallDisabled==="all"||this._nextCallDisabled&&this._nextCallDisabled.has(e))}skip(e){this.skipSet.add(e)}enable(e){this.skipSet.delete(e)}getSkipped(){return Array.from(this.skipSet)}captureAndClearNextCallDisabled(){const e=this._nextCallDisabled;return this._nextCallDisabled=null,e}incrementFetchEventsCount(){this._fetchEventsCount++}incrementSubscribeCount(){this._subscribeCount++}shouldWarnAboutFetchEventsRatio(){const e=this._fetchEventsCount+this._subscribeCount;return e<=6?!1:this._fetchEventsCount/e>.5}error(e,t,r,n=!0){if(!this.shouldCheck(e))return;const o=this.formatMessage(e,"ERROR",t,r,n);throw console.error(o),new Error(o)}warn(e,t,r){if(!this.shouldCheck(e))return;const n=this.formatMessage(e,"WARNING",t,r,!0);throw console.error(n),new Error(n)}formatMessage(e,t,r,n,o=!0){let a=`
 AI_GUARDRAILS ${t}: ${r}`;return n&&(a+=`

 ${n}`),o&&(a+=`

 To disable this check:
   ndk.guardrailOff('${e}').yourMethod()  // For one call`,a+=`
   ndk.aiGuardrails.skip('${e}')  // Permanently`,a+=`
   or set: ndk.aiGuardrails = { skip: new Set(['${e}']) }`),a}ndkInstantiated(e){this.enabled&&checkCachePresence(e,this.shouldCheck.bind(this))}ndk={fetchingEvents:(e,t)=>{this.enabled&&fetchingEvents(e,t,this.warn.bind(this),this.shouldWarnAboutFetchEventsRatio.bind(this),this.incrementFetchEventsCount.bind(this))}};event={signing:e=>{this.enabled&&signing(e,this.error.bind(this),this.warn.bind(this),this._replyEvents)},publishing:e=>{this.enabled&&publishing(e,this.warn.bind(this))},received:(e,t)=>{this.enabled},creatingReply:e=>{this.enabled&&this._replyEvents.add(e)}};subscription={created:(e,t)=>{this.enabled&&this.incrementSubscribeCount()}};relay={connected:e=>{this.enabled}}};function processFilters(e,t="validate",r,n){if(t==="ignore")return e;const o=[],a=e.map((l,u)=>(n?.aiGuardrails.isEnabled()&&runAIGuardrailsForFilter(l,u,n),processFilter(l,t,u,o,r)));if(t==="validate"&&o.length>0)throw new Error(`Invalid filter(s) detected:
${o.join(`
`)}`);return a}function processFilter(e,t,r,n,o){const a=t==="validate",l=a?e:{...e};if(e.ids){const u=[];e.ids.forEach((f,x)=>{f===void 0?a?n.push(`Filter[${r}].ids[${x}] is undefined`):o?.(`Fixed: Removed undefined value at ids[${x}]`):typeof f!="string"?a?n.push(`Filter[${r}].ids[${x}] is not a string (got ${typeof f})`):o?.(`Fixed: Removed non-string value at ids[${x}] (was ${typeof f})`):isValidHex64(f)?u.push(f):a?n.push(`Filter[${r}].ids[${x}] is not a valid 64-char hex string: "${f}"`):o?.(`Fixed: Removed invalid hex string at ids[${x}]`)}),a||(l.ids=u.length>0?u:void 0)}if(e.authors){const u=[];e.authors.forEach((f,x)=>{f===void 0?a?n.push(`Filter[${r}].authors[${x}] is undefined`):o?.(`Fixed: Removed undefined value at authors[${x}]`):typeof f!="string"?a?n.push(`Filter[${r}].authors[${x}] is not a string (got ${typeof f})`):o?.(`Fixed: Removed non-string value at authors[${x}] (was ${typeof f})`):isValidHex64(f)?u.push(f):a?n.push(`Filter[${r}].authors[${x}] is not a valid 64-char hex pubkey: "${f}"`):o?.(`Fixed: Removed invalid hex pubkey at authors[${x}]`)}),a||(l.authors=u.length>0?u:void 0)}if(e.kinds){const u=[];e.kinds.forEach((f,x)=>{f===void 0?a?n.push(`Filter[${r}].kinds[${x}] is undefined`):o?.(`Fixed: Removed undefined value at kinds[${x}]`):typeof f!="number"?a?n.push(`Filter[${r}].kinds[${x}] is not a number (got ${typeof f})`):o?.(`Fixed: Removed non-number value at kinds[${x}] (was ${typeof f})`):Number.isInteger(f)?f<0||f>65535?a?n.push(`Filter[${r}].kinds[${x}] is out of valid range (0-65535): ${f}`):o?.(`Fixed: Removed out-of-range kind at kinds[${x}]: ${f}`):u.push(f):a?n.push(`Filter[${r}].kinds[${x}] is not an integer: ${f}`):o?.(`Fixed: Removed non-integer value at kinds[${x}]: ${f}`)}),a||(l.kinds=u.length>0?u:void 0)}for(const u in e)if(u.startsWith("#")&&u.length===2){const f=e[u];if(Array.isArray(f)){const x=[];f.forEach((p,g)=>{p===void 0?a?n.push(`Filter[${r}].${u}[${g}] is undefined`):o?.(`Fixed: Removed undefined value at ${u}[${g}]`):typeof p!="string"?a?n.push(`Filter[${r}].${u}[${g}] is not a string (got ${typeof p})`):o?.(`Fixed: Removed non-string value at ${u}[${g}] (was ${typeof p})`):(u==="#e"||u==="#p")&&!isValidHex64(p)?a?n.push(`Filter[${r}].${u}[${g}] is not a valid 64-char hex string: "${p}"`):o?.(`Fixed: Removed invalid hex string at ${u}[${g}]`):x.push(p)}),a||(l[u]=x.length>0?x:void 0)}}return a||Object.keys(l).forEach(u=>{l[u]===void 0&&delete l[u]}),l}function runAIGuardrailsForFilter(e,t,r){const n=r.aiGuardrails,o=JSON.stringify(e,null,2);if(Object.keys(e).length===1&&e.limit!==void 0&&n.error(GuardrailCheckId.FILTER_ONLY_LIMIT,`Filter[${t}] contains only 'limit' without any filtering criteria.

 Your filter:
${o}

  This will fetch random events from relays without any criteria.`,`Add filtering criteria:
    { kinds: [1], limit: 10 }
    { authors: [pubkey], limit: 10 }
    { limit: 10 }`),Object.keys(e).length===0&&n.error(GuardrailCheckId.FILTER_EMPTY,`Filter[${t}] is empty.

 Your filter:
${o}

  This will request ALL events from relays, which is never what you want.`,"Add filtering criteria like 'kinds', 'authors', or tags.",!1),e.since!==void 0&&e.until!==void 0&&e.since>e.until){const l=new Date(e.since*1e3).toISOString(),u=new Date(e.until*1e3).toISOString();n.error(GuardrailCheckId.FILTER_SINCE_AFTER_UNTIL,`Filter[${t}] has 'since' AFTER 'until'.

 Your filter:
${o}

 since: ${e.since} (${l})
 until: ${e.until} (${u})

No events can match this time range!`,"'since' must be BEFORE 'until'. Both are Unix timestamps in seconds.",!1)}const a=/^n(addr|event|ote|pub|profile)1/;e.ids&&e.ids.forEach((l,u)=>{typeof l=="string"&&(a.test(l)?n.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].ids[${u}] contains bech32: "${l}". IDs must be hex, not bech32.`,'Use filterFromId() to decode bech32 first: import { filterFromId } from "@nostr-dev-kit/ndk"',!1):isValidHex64(l)||n.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].ids[${u}] is not a valid 64-char hex string: "${l}"`,`Event IDs must be 64-character hexadecimal strings. Invalid IDs often come from corrupted data in user-generated lists. Always validate hex strings before using them in filters:

   const validIds = ids.filter(id => /^[0-9a-f]{64}$/i.test(id));`,!1))}),e.authors&&e.authors.forEach((l,u)=>{typeof l=="string"&&(a.test(l)?n.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].authors[${u}] contains bech32: "${l}". Authors must be hex pubkeys, not npub.`,"Use ndkUser.pubkey instead. Example: { authors: [ndkUser.pubkey] }",!1):isValidHex64(l)||n.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].authors[${u}] is not a valid 64-char hex pubkey: "${l}"`,`Kind:3 follow lists can contain invalid entries like labels ("Follow List"), partial strings ("highlig"), or other corrupted data. You MUST validate all pubkeys before using them in filters.

   Example:
   const validPubkeys = pubkeys.filter(p => /^[0-9a-f]{64}$/i.test(p));
   ndk.subscribe({ authors: validPubkeys, kinds: [1] });`,!1))});for(const l in e)if(l.startsWith("#")&&l.length===2){const u=e[l];Array.isArray(u)&&u.forEach((f,x)=>{typeof f=="string"&&(l==="#e"||l==="#p")&&(a.test(f)?n.error(GuardrailCheckId.FILTER_BECH32_IN_ARRAY,`Filter[${t}].${l}[${x}] contains bech32: "${f}". Tag values must be decoded.`,"Use filterFromId() or nip19.decode() to get the hex value first.",!1):isValidHex64(f)||n.error(GuardrailCheckId.FILTER_INVALID_HEX,`Filter[${t}].${l}[${x}] is not a valid 64-char hex string: "${f}"`,`${l==="#e"?"Event IDs":"Public keys"} in tag filters must be 64-character hexadecimal strings. Kind:3 follow lists and other user-generated content can contain invalid data. Always filter before using:

   const validValues = values.filter(v => /^[0-9a-f]{64}$/i.test(v));`,!1))})}e["#a"]&&e["#a"]?.forEach((u,f)=>{if(typeof u=="string")if(!/^\d+:[0-9a-f]{64}:.*$/.test(u))n.error(GuardrailCheckId.FILTER_INVALID_A_TAG,`Filter[${t}].#a[${f}] has invalid format: "${u}". Must be "kind:pubkey:d-tag".`,'Example: "30023:fa984bd7dbb282f07e16e7ae87b26a2a7b9b90b7246a44771f0cf5ae58018f52:my-article"',!1);else{const x=Number.parseInt(u.split(":")[0],10);(x<3e4||x>39999)&&n.error(GuardrailCheckId.FILTER_INVALID_A_TAG,`Filter[${t}].#a[${f}] uses non-addressable kind ${x}: "${u}". #a filters are only for addressable events (kinds 30000-39999).`,`Addressable events include:
    30000-30039: Parameterized Replaceable Events (profiles, settings, etc.)
    30040-39999: Other addressable events

For regular events (kind ${x}), use:
    #e filter for specific event IDs
    kinds + authors filters for event queries`,!1)}}),e["#t"]&&e["#t"]?.forEach((u,f)=>{typeof u=="string"&&u.startsWith("#")&&n.error(GuardrailCheckId.FILTER_HASHTAG_WITH_PREFIX,`Filter[${t}].#t[${f}] contains hashtag with # prefix: "${u}". Hashtag values should NOT include the # symbol.`,`Remove the # prefix from hashtag filters:
    { "#t": ["nostr"] }
    { "#t": ["#nostr"] }`,!1)})}function queryFullyFilled(e){return!!(filterIncludesIds(e.filter)&&resultHasAllRequestedIds(e))}function filterIncludesIds(e){return!!e.ids}function resultHasAllRequestedIds(e){const t=e.filter.ids;return!!t&&t.length===e.eventFirstSeen.size}function filterFromId(e){let t;if(e.match(NIP33_A_REGEX)){const[r,n,o]=e.split(":"),a={authors:[n],kinds:[Number.parseInt(r)]};return o&&(a["#d"]=[o]),a}if(e.match(BECH32_REGEX))try{switch(t=nip19_exports$1.decode(e),t.type){case"nevent":{const r={ids:[t.data.id]};return t.data.author&&(r.authors=[t.data.author]),t.data.kind&&(r.kinds=[t.data.kind]),r}case"note":return{ids:[t.data]};case"naddr":{const r={authors:[t.data.pubkey],kinds:[t.data.kind]};return t.data.identifier&&(r["#d"]=[t.data.identifier]),r}}}catch(r){console.error("Error decoding",e,r)}return{ids:[e]}}function isNip33AValue(e){return e.match(NIP33_A_REGEX)!==null}var NIP33_A_REGEX=/^(\d+):([0-9A-Fa-f]+)(?::(.*))?$/,BECH32_REGEX=/^n(event|ote|profile|pub|addr)1[\d\w]+$/;function relaysFromBech32(e,t){try{const r=nip19_exports$1.decode(e);if(["naddr","nevent"].includes(r?.type)){const n=r.data;if(n?.relays)return n.relays.map(o=>new NDKRelay(o,t.relayAuthDefaultPolicy,t))}}catch{}return[]}var defaultOpts={closeOnEose:!1,cacheUsage:"CACHE_FIRST",dontSaveToCache:!1,groupable:!0,groupableDelay:100,groupableDelayType:"at-most",cacheUnconstrainFilter:["limit","since","until"],includeMuted:!1},NDKSubscription=class extends libExports.EventEmitter{subId;filters;opts;pool;skipVerification=!1;skipValidation=!1;exclusiveRelay=!1;relayFilters;relaySet;ndk;debug;eventFirstSeen=new Map;eosesSeen=new Set;lastEventReceivedAt;mostRecentCacheEventTimestamp;internalId;closeOnEose;poolMonitor;skipOptimisticPublishEvent=!1;cacheUnconstrainFilter;constructor(e,t,r,n){super(),this.ndk=e,this.opts={...defaultOpts,...r||{}},this.pool=this.opts.pool||e.pool;const o=Array.isArray(t)?t:[t],a=e.filterValidationMode==="validate"?"validate":e.filterValidationMode==="fix"?"fix":"ignore";if(this.filters=processFilters(o,a,e.debug,e),this.filters.length===0)throw new Error("Subscription must have at least one filter");this.subId=n||this.opts.subId,this.internalId=Math.random().toString(36).substring(7),this.debug=e.debug.extend(`subscription[${this.opts.subId??this.internalId}]`),this.opts.relaySet?this.relaySet=this.opts.relaySet:this.opts.relayUrls&&(this.relaySet=NDKRelaySet.fromRelayUrls(this.opts.relayUrls,this.ndk)),this.skipVerification=this.opts.skipVerification||!1,this.skipValidation=this.opts.skipValidation||!1,this.closeOnEose=this.opts.closeOnEose||!1,this.skipOptimisticPublishEvent=this.opts.skipOptimisticPublishEvent||!1,this.cacheUnconstrainFilter=this.opts.cacheUnconstrainFilter,this.exclusiveRelay=this.opts.exclusiveRelay||!1,this.opts.onEvent&&this.on("event",this.opts.onEvent),this.opts.onEose&&this.on("eose",this.opts.onEose),this.opts.onClose&&this.on("close",this.opts.onClose)}relaysMissingEose(){return this.relayFilters?Array.from(this.relayFilters?.keys()).filter(t=>!this.eosesSeen.has(this.pool.getRelay(t,!1,!1))):[]}get filter(){return this.filters[0]}get groupableDelay(){if(this.isGroupable())return this.opts?.groupableDelay}get groupableDelayType(){return this.opts?.groupableDelayType||"at-most"}isGroupable(){return this.opts?.groupable||!1}shouldQueryCache(){return this.opts.addSinceFromCache?!0:this.opts?.cacheUsage==="ONLY_RELAY"?!1:(this.filters.some(t=>t.kinds?.some(r=>kindIsEphemeral(r))),!0)}shouldQueryRelays(){return this.opts?.cacheUsage!=="ONLY_CACHE"}shouldWaitForCache(){return this.opts.addSinceFromCache?!0:!!this.opts.closeOnEose&&!!this.ndk.cacheAdapter?.locking&&this.opts.cacheUsage!=="PARALLEL"}start(e=!0){let t;const r=o=>{for(const a of o)a.created_at&&(!this.mostRecentCacheEventTimestamp||a.created_at>this.mostRecentCacheEventTimestamp)&&(this.mostRecentCacheEventTimestamp=a.created_at),this.eventReceived(a,void 0,!0,!1);e||(t=o)},n=()=>{this.shouldQueryRelays()?(this.startWithRelays(),this.startPoolMonitor()):this.emit("eose",this)};return this.shouldQueryCache()?(t=this.startWithCache(),t instanceof Promise?this.shouldWaitForCache()?(t.then(o=>{if(r(o),queryFullyFilled(this)){this.emit("eose",this);return}n()}),null):(t.then(o=>{r(o),this.shouldQueryRelays()||this.emit("eose",this)}),this.shouldQueryRelays()&&n(),null):(r(t),queryFullyFilled(this)?this.emit("eose",this):n(),t)):(n(),null)}startPoolMonitor(){this.debug.extend("pool-monitor"),this.poolMonitor=e=>{if(this.relayFilters?.has(e.url))return;calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool,this.opts.relayGoalPerAuthor).get(e.url)&&(this.relayFilters?.set(e.url,this.filters),e.subscribe(this,this.filters))},this.pool.on("relay:connect",this.poolMonitor)}onStopped;stop(){this.emit("close",this),this.poolMonitor&&this.pool.off("relay:connect",this.poolMonitor),this.onStopped?.()}hasAuthorsFilter(){return this.filters.some(e=>e.authors?.length)}startWithCache(){return this.ndk.cacheAdapter?.query?this.ndk.cacheAdapter.query(this):[]}startWithRelays(){let e=this.filters;if(this.opts.addSinceFromCache&&this.mostRecentCacheEventTimestamp){const t=this.mostRecentCacheEventTimestamp+1;e=e.map(r=>({...r,since:Math.max(r.since||0,t)}))}if(!this.relaySet||this.relaySet.relays.size===0)this.relayFilters=calculateRelaySetsFromFilters(this.ndk,e,this.pool,this.opts.relayGoalPerAuthor);else{this.relayFilters=new Map;for(const t of this.relaySet.relays)this.relayFilters.set(t.url,e)}for(const[t,r]of this.relayFilters)this.pool.getRelay(t,!0,!0,r).subscribe(this,r)}refreshRelayConnections(){if(this.relaySet&&this.relaySet.relays.size>0)return;const e=calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool,this.opts.relayGoalPerAuthor);for(const[t,r]of e)this.relayFilters?.has(t)||(this.relayFilters?.set(t,r),this.pool.getRelay(t,!0,!0,r).subscribe(this,r))}eventReceived(e,t,r=!1,n=!1){const o=e.id,a=this.eventFirstSeen.has(o);let l;if(e instanceof NDKEvent&&(l=e),a){const u=Date.now()-(this.eventFirstSeen.get(o)||0);if(this.emit("event:dup",e,t,u,this,r,n),this.opts?.onEventDup&&this.opts.onEventDup(e,t,u,this,r,n),!r&&!n&&t&&this.ndk.cacheAdapter?.setEventDup&&!this.opts.dontSaveToCache&&(l??=e instanceof NDKEvent?e:new NDKEvent(this.ndk,e),this.ndk.cacheAdapter.setEventDup(l,t)),t){const f=verifiedSignatures.get(o);if(f&&typeof f=="string")if(e.sig===f)t.addValidatedEvent();else{const x=e instanceof NDKEvent?e:new NDKEvent(this.ndk,e);this.ndk.reportInvalidSignature(x,t)}}}else{if(l??=new NDKEvent(this.ndk,e),l.ndk=this.ndk,l.relay=t,!r&&!n){if(!this.skipValidation&&!l.isValid){this.debug("Event failed validation %s from relay %s",o,t?.url);return}if(t)if(t.shouldValidateEvent()&&!this.skipVerification)if(l.relay=t,this.ndk.asyncSigVerification)l.verifySignature(!0);else{if(!l.verifySignature(!0)){this.debug("Event failed signature validation",e),this.ndk.reportInvalidSignature(l,t);return}t.addValidatedEvent()}else t.addNonValidatedEvent();this.ndk.cacheAdapter&&!this.opts.dontSaveToCache&&this.ndk.cacheAdapter.setEvent(l,this.filters,t)}if(!this.opts.includeMuted&&this.ndk.muteFilter&&this.ndk.muteFilter(l)){this.debug("Event muted, skipping");return}(!n||this.skipOptimisticPublishEvent!==!0)&&(this.emitEvent(this.opts?.wrap??!1,l,t,r,n),this.eventFirstSeen.set(o,Date.now()))}this.lastEventReceivedAt=Date.now()}emitEvent(e,t,r,n,o){const a=e?wrapEvent(t):t;a instanceof Promise?a.then(l=>this.emitEvent(!1,l,r,n,o)):a&&this.emit("event",a,r,this,n,o)}closedReceived(e,t){this.emit("closed",e,t)}eoseTimeout;eosed=!1;eoseReceived(e){this.debug("EOSE received from %s",e.url),this.eosesSeen.add(e);let t=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0;const r=this.eosesSeen.size===this.relayFilters?.size,n=queryFullyFilled(this),o=a=>{this.debug("Performing EOSE: %s %d",a,this.eosed),!this.eosed&&(this.eoseTimeout&&clearTimeout(this.eoseTimeout),this.emit("eose",this),this.eosed=!0,this.opts?.closeOnEose&&this.stop())};if(n||r)o("query filled or seen all");else if(this.relayFilters){let a=1e3;const l=new Set(this.pool.connectedRelays().map(x=>x.url)),u=Array.from(this.relayFilters.keys()).filter(x=>l.has(x));if(u.length===0){this.debug("No connected relays, waiting for all relays to connect",Array.from(this.relayFilters.keys()).join(", "));return}const f=this.eosesSeen.size/u.length;if(this.debug("Percentage of relays that have sent EOSE",{subId:this.subId,percentageOfRelaysThatHaveSentEose:f,seen:this.eosesSeen.size,total:u.length}),this.eosesSeen.size>=2&&f>=.5){if(a=a*(1-f),a===0){o("time to wait was 0");return}this.eoseTimeout&&clearTimeout(this.eoseTimeout);const x=()=>{t=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0,t!==void 0&&t<20?this.eoseTimeout=setTimeout(x,a):o(`send eose timeout: ${a}`)};this.eoseTimeout=setTimeout(x,a)}}}},kindIsEphemeral=e=>e>=2e4&&e<3e4;async function follows(e,t,r=3){if(!this.ndk)throw new Error("NDK not set");const n=await this.ndk.fetchEvent({kinds:[r],authors:[this.pubkey]},e||{groupable:!1});if(n){const o=new Set;return n.tags.forEach(a=>{a[0]==="p"&&a[1]&&isValidPubkey(a[1])&&o.add(a[1])}),t&&this.ndk?.outboxTracker?.trackUsers(Array.from(o)),[...o].reduce((a,l)=>{const u=new NDKUser({pubkey:l});return u.ndk=this.ndk,a.add(u),a},new Set)}return new Set}var NIP05_REGEX=/^(?:([\w.+-]+)@)?([\w.-]+)$/;async function getNip05For(e,t,r=fetch,n={}){return await e.queuesNip05.add({id:t,func:async()=>{if(e.cacheAdapter?.loadNip05){const f=await e.cacheAdapter.loadNip05(t);if(f!=="missing"){if(f){const x=new NDKUser({pubkey:f.pubkey,relayUrls:f.relays,nip46Urls:f.nip46});return x.ndk=e,x}if(n.cache!=="no-cache")return null}}const o=t.match(NIP05_REGEX);if(!o)return null;const[a,l="_",u]=o;try{const f=await r(`https://${u}/.well-known/nostr.json?name=${l}`,n),{names:x,relays:p,nip46:g}=parseNIP05Result(await f.json()),y=x[l.toLowerCase()];let b=null;return y&&(b={pubkey:y,relays:p?.[y],nip46:g?.[y]}),e?.cacheAdapter?.saveNip05&&e.cacheAdapter.saveNip05(t,b),b}catch(f){return e?.cacheAdapter?.saveNip05&&e?.cacheAdapter.saveNip05(t,null),console.error("Failed to fetch NIP05 for",t,f),null}}})}function parseNIP05Result(e){const t={names:{}};for(const[r,n]of Object.entries(e.names))typeof r=="string"&&typeof n=="string"&&(t.names[r.toLowerCase()]=n);if(e.relays){t.relays={};for(const[r,n]of Object.entries(e.relays))typeof r=="string"&&Array.isArray(n)&&(t.relays[r]=n.filter(o=>typeof o=="string"))}if(e.nip46){t.nip46={};for(const[r,n]of Object.entries(e.nip46))typeof r=="string"&&Array.isArray(n)&&(t.nip46[r]=n.filter(o=>typeof o=="string"))}return t}function profileFromEvent(e){const t={};let r;try{r=JSON.parse(e.content)}catch(n){throw new Error(`Failed to parse profile event: ${n}`)}t.profileEvent=JSON.stringify(e.rawEvent());for(const n of Object.keys(r))switch(n){case"name":t.name=r.name;break;case"display_name":t.displayName=r.display_name;break;case"image":case"picture":t.picture=r.picture||r.image,t.image=t.picture;break;case"banner":t.banner=r.banner;break;case"bio":t.bio=r.bio;break;case"nip05":t.nip05=r.nip05;break;case"lud06":t.lud06=r.lud06;break;case"lud16":t.lud16=r.lud16;break;case"about":t.about=r.about;break;case"website":t.website=r.website;break;default:t[n]=r[n];break}return t.created_at=e.created_at,t}function serializeProfile(e){const t={};for(const[r,n]of Object.entries(e))switch(r){case"username":case"name":t.name=n;break;case"displayName":t.display_name=n;break;case"image":case"picture":t.picture=n;break;case"bio":case"about":t.about=n;break;default:t[r]=n;break}return JSON.stringify(t)}var NDKUser=class uf{ndk;profile;profileEvent;_npub;_pubkey;relayUrls=[];nip46Urls=[];constructor(t){if(t.npub&&(this._npub=t.npub),t.hexpubkey&&(this._pubkey=t.hexpubkey),t.pubkey&&(this._pubkey=t.pubkey),t.relayUrls&&(this.relayUrls=t.relayUrls),t.nip46Urls&&(this.nip46Urls=t.nip46Urls),t.nprofile)try{const r=nip19_exports$1.decode(t.nprofile);r.type==="nprofile"&&(this._pubkey=r.data.pubkey,r.data.relays&&r.data.relays.length>0&&this.relayUrls.push(...r.data.relays))}catch(r){console.error("Failed to decode nprofile",r)}}get npub(){if(!this._npub){if(!this._pubkey)throw new Error("pubkey not set");this._npub=nip19_exports$1.npubEncode(this.pubkey)}return this._npub}get nprofile(){const t=this.profileEvent?.onRelays?.map(r=>r.url);return nip19_exports$1.nprofileEncode({pubkey:this.pubkey,relays:t})}set npub(t){this._npub=t}get pubkey(){if(!this._pubkey){if(!this._npub)throw new Error("npub not set");this._pubkey=nip19_exports$1.decode(this.npub).data}return this._pubkey}set pubkey(t){this._pubkey=t}filter(){return{"#p":[this.pubkey]}}async getZapInfo(t){if(!this.ndk)throw new Error("No NDK instance found");const r=async l=>{if(!t)return l;let u;const f=new Promise((x,p)=>{u=setTimeout(()=>p(new Error("Timeout")),t)});try{const x=await Promise.race([l,f]);return u&&clearTimeout(u),x}catch(x){if(x instanceof Error&&x.message==="Timeout")try{return await l}catch{return}return}},[n,o]=await Promise.all([r(this.fetchProfile()),r(this.ndk.fetchEvent({kinds:[10019],authors:[this.pubkey]}))]),a=new Map;if(o){const l=NDKCashuMintList.from(o);l.mints.length>0&&a.set("nip61",{mints:l.mints,relays:l.relays,p2pk:l.p2pk})}if(n){const{lud06:l,lud16:u}=n;a.set("nip57",{lud06:l,lud16:u})}return a}static async fromNip05(t,r,n=!1){if(!r)throw new Error("No NDK instance found");const o={};n&&(o.cache="no-cache");const a=await getNip05For(r,t,r?.httpFetch,o);if(a){const l=new uf({pubkey:a.pubkey,relayUrls:a.relays,nip46Urls:a.nip46});return l.ndk=r,l}}async fetchProfile(t,r=!1){if(!this.ndk)throw new Error("NDK not set");let n=null;if(this.ndk.cacheAdapter&&(this.ndk.cacheAdapter.fetchProfile||this.ndk.cacheAdapter.fetchProfileSync)&&t?.cacheUsage!=="ONLY_RELAY"){let o=null;if(this.ndk.cacheAdapter.fetchProfileSync?o=this.ndk.cacheAdapter.fetchProfileSync(this.pubkey):this.ndk.cacheAdapter.fetchProfile&&(o=await this.ndk.cacheAdapter.fetchProfile(this.pubkey)),o)return this.profile=o,o}return t??={},t.cacheUsage??="ONLY_RELAY",t.closeOnEose??=!0,t.groupable??=!0,t.groupableDelay??=250,n||(n=await this.ndk.fetchEvent({kinds:[0],authors:[this.pubkey]},t)),n?(this.profile=profileFromEvent(n),r&&this.profile&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.saveProfile&&this.ndk.cacheAdapter.saveProfile(this.pubkey,this.profile),this.profile):null}follows=follows.bind(this);async followSet(t,r,n=3){const o=await this.follows(t,r,n);return new Set(Array.from(o).map(a=>a.pubkey))}tagReference(){return["p",this.pubkey]}referenceTags(t){const r=[["p",this.pubkey]];return t&&r[0].push("",t),r}async publish(){if(!this.ndk)throw new Error("No NDK instance found");if(!this.profile)throw new Error("No profile available");this.ndk.assertSigner(),await new NDKEvent(this.ndk,{kind:0,content:serializeProfile(this.profile)}).publish()}async follow(t,r,n=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),r||(r=await this.follows(void 0,void 0,n));const o=typeof t=="string"?t:t.pubkey;if(Array.from(r).some(u=>typeof u=="string"?u===o:u.pubkey===o))return!1;r.add(t);const l=new NDKEvent(this.ndk,{kind:n});for(const u of r)typeof u=="string"?l.tags.push(["p",u]):l.tag(u);return await l.publish(),!0}async unfollow(t,r,n=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),r||(r=await this.follows(void 0,void 0,n));const o=typeof t=="string"?t:t.pubkey,a=new Set;let l=!1;for(const f of r)(typeof f=="string"?f:f.pubkey)!==o?a.add(f):l=!0;if(!l)return!1;const u=new NDKEvent(this.ndk,{kind:n});for(const f of a)typeof f=="string"?u.tags.push(["p",f]):u.tag(f);return await u.publish()}async validateNip05(t){if(!this.ndk)throw new Error("No NDK instance found");const r=await getNip05For(this.ndk,t);return r===null?null:r.pubkey===this.pubkey}},signerRegistry=new Map;function registerSigner(e,t){signerRegistry.set(e,t)}var NDKPrivateKeySigner=class Ro{_user;_privateKey;_pubkey;constructor(t,r){if(typeof t=="string")if(t.startsWith("nsec1")){const{type:n,data:o}=nip19_exports$1.decode(t);if(n==="nsec")this._privateKey=o;else throw new Error("Invalid private key provided.")}else if(t.length===64)this._privateKey=hexToBytes$2(t);else throw new Error("Invalid private key provided.");else this._privateKey=t;this._pubkey=getPublicKey(this._privateKey),r&&(this._user=r.getUser({pubkey:this._pubkey})),this._user??=new NDKUser({pubkey:this._pubkey})}get privateKey(){if(!this._privateKey)throw new Error("Not ready");return bytesToHex(this._privateKey)}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}get nsec(){if(!this._privateKey)throw new Error("Not ready");return nip19_exports$1.nsecEncode(this._privateKey)}get npub(){if(!this._pubkey)throw new Error("Not ready");return nip19_exports$1.npubEncode(this._pubkey)}encryptToNcryptsec(t,r=16,n=2){if(!this._privateKey)throw new Error("Private key not available");return encrypt$1(this._privateKey,t,r,n)}static generate(){const t=generateSecretKey();return new Ro(t)}static fromNcryptsec(t,r,n){const o=decrypt$1(t,r);return new Ro(o,n)}async blockUntilReady(){return this._user}async user(){return this._user}get userSync(){return this._user}async sign(t){if(!this._privateKey)throw Error("Attempted to sign without a private key");return finalizeEvent(t,this._privateKey).sig}async encryptionEnabled(t){const r=[];return(!t||t==="nip04")&&r.push("nip04"),(!t||t==="nip44")&&r.push("nip44"),r}async encrypt(t,r,n){if(!this._privateKey||!this.privateKey)throw Error("Attempted to encrypt without a private key");const o=t.pubkey;if(n==="nip44"){const a=nip44_exports.v2.utils.getConversationKey(this._privateKey,o);return await nip44_exports.v2.encrypt(r,a)}return await nip04_exports.encrypt(this._privateKey,o,r)}async decrypt(t,r,n){if(!this._privateKey||!this.privateKey)throw Error("Attempted to decrypt without a private key");const o=t.pubkey;if(n==="nip44"){const a=nip44_exports.v2.utils.getConversationKey(this._privateKey,o);return await nip44_exports.v2.decrypt(r,a)}return await nip04_exports.decrypt(this._privateKey,o,r)}toPayload(){if(!this._privateKey)throw new Error("Private key not available");const t={type:"private-key",payload:this.privateKey};return JSON.stringify(t)}static async fromPayload(t,r){const n=JSON.parse(t);if(n.type!=="private-key")throw new Error(`Invalid payload type: expected 'private-key', got ${n.type}`);if(!n.payload||typeof n.payload!="string")throw new Error("Invalid payload content for private-key signer");return new Ro(n.payload,r)}};registerSigner("private-key",NDKPrivateKeySigner);function dedup(e,t){return e.created_at>t.created_at?e:t}async function getRelayListForUser(e,t){return(await getRelayListForUsers([e],t)).get(e)}async function getRelayListForUsers(e,t,r=!1,n=1e3,o){const a=t.outboxPool||t.pool,l=new Set;for(const y of a.relays.values())l.add(y);if(o)for(const y of o.values())for(const b of y){const w=a.getRelay(b,!0,!0);w&&l.add(w)}const u=new Map,f=new Map,x=new NDKRelaySet(l,t);if(t.cacheAdapter?.locking&&!r){const y=await t.fetchEvents({kinds:[3,10002],authors:Array.from(new Set(e))},{cacheUsage:"ONLY_CACHE",subId:"ndk-relay-list-fetch"});for(const b of y)b.kind===10002&&u.set(b.pubkey,NDKRelayList.from(b));for(const b of y)if(b.kind===3){if(u.has(b.pubkey))continue;const w=relayListFromKind3(t,b);w&&f.set(b.pubkey,w)}e=e.filter(b=>!u.has(b)&&!f.has(b))}if(e.length===0)return u;const p=new Map,g=new Map;return new Promise(y=>{let b=!1;(async()=>{const v={closeOnEose:!0,pool:a,groupable:!0,subId:"ndk-relay-list-fetch",addSinceFromCache:!0,relaySet:x};x&&(v.relaySet=x),t.subscribe({kinds:[3,10002],authors:e},v,{onEvent:C=>{if(C.kind===10002){const N=p.get(C.pubkey);if(N&&N.created_at>C.created_at)return;p.set(C.pubkey,C)}else if(C.kind===3){const N=g.get(C.pubkey);if(N&&N.created_at>C.created_at)return;g.set(C.pubkey,C)}},onEose:()=>{if(!b){b=!0,t.debug(`[getRelayListForUsers] EOSE - relayListEvents: ${p.size}, contactListEvents: ${g.size}`);for(const C of p.values())u.set(C.pubkey,NDKRelayList.from(C));for(const C of e){if(u.has(C))continue;const N=g.get(C);if(!N)continue;const T=relayListFromKind3(t,N);T&&u.set(C,T)}t.debug(`[getRelayListForUsers] Returning ${u.size} relay lists for ${e.length} pubkeys`),y(u)}}});const B=Array.from(l).some(C=>C.status<=2),j=Array.from(l).some(C=>C.status===4);let F=n;(B||j)&&(F=n+3e3),t.debug(`[getRelayListForUsers] Setting fallback timeout to ${F}ms (disconnected: ${B}, connecting: ${j})`,{pubkeys:e}),setTimeout(()=>{b||(b=!0,t.debug(`[getRelayListForUsers] Timeout reached, returning ${u.size} relay lists`),y(u))},F)})()})}var OutboxItem=class{type;relayUrlScores;readRelays;writeRelays;constructor(e){this.type=e,this.relayUrlScores=new Map,this.readRelays=new Set,this.writeRelays=new Set}},OutboxTracker=class extends libExports.EventEmitter{data;ndk;debug;constructor(e){super(),this.ndk=e,this.debug=e.debug.extend("outbox-tracker"),this.data=new distExports$2.LRUCache({maxSize:1e5,entryExpirationTimeInMS:120*1e3})}async trackUsers(e,t=!1){const r=[];for(let n=0;n<e.length;n+=400){const o=e.slice(n,n+400),a=o.map(u=>getKeyFromItem(u)).filter(u=>!this.data.has(u));if(a.length===0)continue;for(const u of a)this.data.set(u,new OutboxItem("user"));const l=new Map;for(const u of o)u instanceof NDKUser&&u.relayUrls.length>0&&l.set(u.pubkey,u.relayUrls);r.push(new Promise(u=>{getRelayListForUsers(a,this.ndk,t,1e3,l).then(f=>{this.debug(`Received relay lists for ${f.size} pubkeys out of ${a.length} requested`);for(const[x,p]of f){let g=this.data.get(x);if(g??=new OutboxItem("user"),p){if(g.readRelays=new Set(normalize(p.readRelayUrls)),g.writeRelays=new Set(normalize(p.writeRelayUrls)),this.ndk.relayConnectionFilter){for(const y of g.readRelays)this.ndk.relayConnectionFilter(y)||g.readRelays.delete(y);for(const y of g.writeRelays)this.ndk.relayConnectionFilter(y)||g.writeRelays.delete(y)}this.data.set(x,g),this.emit("user:relay-list-updated",x,g),this.debug(`Adding ${g.readRelays.size} read relays and ${g.writeRelays.size} write relays for ${x}`,p?.rawEvent())}}}).finally(u)}))}return Promise.all(r)}track(e,t,r=!0){const n=getKeyFromItem(e);t??=getTypeFromItem(e);let o=this.data.get(n);return o||(o=new OutboxItem(t),e instanceof NDKUser&&this.trackUsers([e])),o}};function getKeyFromItem(e){return e instanceof NDKUser?e.pubkey:e}function getTypeFromItem(e){return e instanceof NDKUser?"user":"kind"}function correctRelaySet(e,t){const r=t.connectedRelays();if(!Array.from(e.relays).some(o=>r.map(a=>a.url).includes(o.url)))for(const o of r)e.addRelay(o);if(r.length===0)for(const o of t.relays.values())e.addRelay(o);return e}var NDKSubscriptionManager=class{subscriptions;seenEvents=new distExports$2.LRUCache({maxSize:1e4,entryExpirationTimeInMS:300*1e3});constructor(){this.subscriptions=new Map}add(e){this.subscriptions.set(e.internalId,e),e.onStopped,e.onStopped=()=>{this.subscriptions.delete(e.internalId)},e.on("close",()=>{this.subscriptions.delete(e.internalId)})}seenEvent(e,t){const r=this.seenEvents.get(e)||[];r.some(n=>n.url===t.url)||r.push(t),this.seenEvents.set(e,r)}dispatchEvent(e,t,r=!1){t&&this.seenEvent(e.id,t);const n=this.subscriptions.values(),o=[];for(const a of n)matchFilters(a.filters,e)&&o.push(a);for(const a of o){if(a.exclusiveRelay&&a.relaySet){let l=!1;if(r?l=!a.skipOptimisticPublishEvent:t?l=a.relaySet.relays.has(t):l=(this.seenEvents.get(e.id)||[]).some(f=>a.relaySet.relays.has(f)),!l){a.debug.extend("exclusive-relay")("Rejected event %s from %s (relay not in exclusive set)",e.id,t?.url||(r?"optimistic":"cache"));continue}}a.eventReceived(e,t,!1,r)}}},debug6=createDebug5("ndk:active-user");async function getUserRelayList(e){if(!this.autoConnectUserRelays)return;const t=await getRelayListForUser(e.pubkey,this);if(t){for(const r of t.relays){let n=this.pool.relays.get(r);n||(n=new NDKRelay(r,this.relayAuthDefaultPolicy,this),this.pool.addRelay(n))}return debug6("Connected to %d user relays",t.relays.length),t}}async function setActiveUser(e){if(!this.autoConnectUserRelays)return;const t=this.outboxPool||this.pool;t.connectedRelays.length>0?await getUserRelayList.call(this,e):t.once("connect",async()=>{await getUserRelayList.call(this,e)})}function getEntity(e){try{const t=nip19_exports$1.decode(e);return t.type==="npub"?npub(this,t.data):t.type==="nprofile"?nprofile(this,t.data):t}catch{return null}}function npub(e,t){return e.getUser({pubkey:t})}function nprofile(e,t){const r=e.getUser({pubkey:t.pubkey});return t.relays&&(r.relayUrls=t.relays),r}function isValidHint(e){if(!e||e==="")return!1;try{return new URL(e),!0}catch{return!1}}async function fetchEventFromTag(e,t,r,n={type:"timeout"}){const o=this.debug.extend("fetch-event-from-tag"),[a,l,u]=e;r={},o("fetching event from tag",e,r,n);const f=getRelaysForSync(this,t.pubkey);if(f&&f.size>0){o("fetching event from author relays %o",Array.from(f));const v=NDKRelaySet.fromRelayUrls(Array.from(f),this),B=await this.fetchEvent(l,r,v);if(B)return B}else o("no author relays found for %s",t.pubkey,t);const x=calculateRelaySetsFromFilters(this,[{ids:[l]}],this.pool);o("fetching event without relay hint",x);const p=await this.fetchEvent(l,r);if(p)return p;if(u&&u!==""){const v=await this.fetchEvent(l,r,this.pool.getRelay(u,!0,!0,[{ids:[l]}]));if(v)return v}let g;const y=isValidHint(u)?this.pool.getRelay(u,!1,!0,[{ids:[l]}]):void 0,b=new Promise(v=>{this.fetchEvent(l,r,y).then(v)});if(!isValidHint(u)||n.type==="none")return b;const w=new Promise(async v=>{const B=n.relaySet,j=n.timeout??1500,F=new Promise(C=>setTimeout(C,j));if(n.type==="timeout"&&await F,g)v(g);else{o("fallback fetch triggered");const C=await this.fetchEvent(l,r,B);v(C)}});switch(n.type){case"timeout":return Promise.race([b,w]);case"eose":return g=await b,g||w}}var Queue=class{queue=[];maxConcurrency;processing=new Set;promises=new Map;constructor(e,t){this.maxConcurrency=t}add(e){if(this.promises.has(e.id))return this.promises.get(e.id);const t=new Promise((r,n)=>{this.queue.push({...e,func:()=>e.func().then(o=>(r(o),o),o=>{throw n(o),o})}),this.process()});return this.promises.set(e.id,t),t.finally(()=>{this.promises.delete(e.id),this.processing.delete(e.id),this.process()}),t}process(){if(this.processing.size>=this.maxConcurrency||this.queue.length===0)return;const e=this.queue.shift();!e||this.processing.has(e.id)||(this.processing.add(e.id),e.func())}clear(){this.queue=[]}clearProcessing(){this.processing.clear()}clearAll(){this.clear(),this.clearProcessing()}length(){return this.queue.length}},DEFAULT_OUTBOX_RELAYS=["wss://purplepag.es/","wss://nos.lol/"],NDK=class extends libExports.EventEmitter{_explicitRelayUrls;pool;outboxPool;_signer;_activeUser;cacheAdapter;debug;devWriteRelaySet;outboxTracker;muteFilter;relayConnectionFilter;clientName;clientNip89;queuesZapConfig;queuesNip05;asyncSigVerification=!1;initialValidationRatio=1;lowestValidationRatio=.1;validationRatioFn;filterValidationMode="validate";subManager;aiGuardrails;_signatureVerificationFunction;_signatureVerificationWorker;signatureVerificationTimeMs=0;publishingFailureHandled=!1;pools=[];relayAuthDefaultPolicy;httpFetch;netDebug;autoConnectUserRelays=!0;_wallet;walletConfig;constructor(e={}){super(),this.debug=e.debug||createDebug5("ndk"),this.netDebug=e.netDebug,this._explicitRelayUrls=e.explicitRelayUrls||[],this.subManager=new NDKSubscriptionManager,this.pool=new NDKPool(e.explicitRelayUrls||[],this),this.pool.name="Main",this.pool.on("relay:auth",async(t,r)=>{this.relayAuthDefaultPolicy&&await this.relayAuthDefaultPolicy(t,r)}),this.autoConnectUserRelays=e.autoConnectUserRelays??!0,this.clientName=e.clientName,this.clientNip89=e.clientNip89,this.relayAuthDefaultPolicy=e.relayAuthDefaultPolicy,e.enableOutboxModel!==!1&&(this.outboxPool=new NDKPool(e.outboxRelayUrls||DEFAULT_OUTBOX_RELAYS,this,{debug:this.debug.extend("outbox-pool"),name:"Outbox Pool"}),this.outboxTracker=new OutboxTracker(this),this.outboxTracker.on("user:relay-list-updated",(t,r)=>{this.debug(`Outbox relay list updated for ${t}`);for(const n of this.subManager.subscriptions.values())n.filters.some(a=>a.authors?.includes(t))&&typeof n.refreshRelayConnections=="function"&&(this.debug(`Refreshing relay connections for subscription ${n.internalId}`),n.refreshRelayConnections())})),this.signer=e.signer,this.cacheAdapter=e.cacheAdapter,this.muteFilter=e.muteFilter,this.relayConnectionFilter=e.relayConnectionFilter,e.devWriteRelayUrls&&(this.devWriteRelaySet=NDKRelaySet.fromRelayUrls(e.devWriteRelayUrls,this)),this.queuesZapConfig=new Queue("zaps",3),this.queuesNip05=new Queue("nip05",10),e.signatureVerificationWorker&&(this.signatureVerificationWorker=e.signatureVerificationWorker),e.signatureVerificationFunction&&(this.signatureVerificationFunction=e.signatureVerificationFunction),this.initialValidationRatio=e.initialValidationRatio||1,this.lowestValidationRatio=e.lowestValidationRatio||.1,this.validationRatioFn=e.validationRatioFn||this.defaultValidationRatioFn,this.filterValidationMode=e.filterValidationMode||"validate",this.aiGuardrails=new AIGuardrails(e.aiGuardrails||!1),this.aiGuardrails.ndkInstantiated(this);try{this.httpFetch=fetch}catch{}}set explicitRelayUrls(e){this._explicitRelayUrls=e.map(normalizeRelayUrl),this.pool.relayUrls=e}get explicitRelayUrls(){return this._explicitRelayUrls||[]}set signatureVerificationWorker(e){this._signatureVerificationWorker=e,e?(signatureVerificationInit(e),this.asyncSigVerification=!0):this.asyncSigVerification=!1}set signatureVerificationFunction(e){this._signatureVerificationFunction=e,this.asyncSigVerification=!!e}get signatureVerificationFunction(){return this._signatureVerificationFunction}addExplicitRelay(e,t,r=!0){let n;return typeof e=="string"?n=new NDKRelay(e,t,this):n=e,this.pool.addRelay(n,r),this.explicitRelayUrls?.push(n.url),n}toJSON(){return{relayCount:this.pool.relays.size}.toString()}get activeUser(){return this._activeUser}set activeUser(e){const t=this._activeUser?.pubkey!==e?.pubkey;this._activeUser=e,t&&this.emit("activeUser:change",e),e&&t&&setActiveUser.call(this,e)}get signer(){return this._signer}set signer(e){this._signer=e,e&&this.emit("signer:ready",e),e?.user().then(t=>{t.ndk=this,this.activeUser=t})}async connect(e){this._signer&&this.autoConnectUserRelays&&(this.debug("Attempting to connect to user relays specified by signer %o",await this._signer.relays?.(this)),this._signer.relays&&(await this._signer.relays(this)).forEach(n=>this.pool.addRelay(n)));const t=[this.pool.connect(e)];return this.outboxPool&&t.push(this.outboxPool.connect(e)),this.cacheAdapter?.initializeAsync&&t.push(this.cacheAdapter.initializeAsync(this)),Promise.allSettled(t).then(()=>{})}reportInvalidSignature(e,t){this.debug(`Invalid signature detected for event ${e.id}${t?` from relay ${t.url}`:""}`),this.emit("event:invalid-sig",e,t)}defaultValidationRatioFn(e,t,r){if(t<10)return this.initialValidationRatio;const n=Math.min(t/100,1),o=this.initialValidationRatio*(1-n)+this.lowestValidationRatio*n;return Math.max(o,this.lowestValidationRatio)}getUser(e){if(typeof e=="string")if(e.startsWith("npub1")){const{type:r,data:n}=nip19_exports$1.decode(e);if(r!=="npub")throw new Error(`Invalid npub: ${e}`);return this.getUser({pubkey:n})}else if(e.startsWith("nprofile1")){const{type:r,data:n}=nip19_exports$1.decode(e);if(r!=="nprofile")throw new Error(`Invalid nprofile: ${e}`);return this.getUser({pubkey:n.pubkey,relayUrls:n.relays})}else return this.getUser({pubkey:e});const t=new NDKUser(e);return t.ndk=this,t}async getUserFromNip05(e,t=!1){return NDKUser.fromNip05(e,this,t)}async fetchUser(e,t=!1){if(isValidNip05(e))return NDKUser.fromNip05(e,this,t);if(e.startsWith("npub1")){const{type:r,data:n}=nip19_exports$1.decode(e);if(r!=="npub")throw new Error(`Invalid npub: ${e}`);const o=new NDKUser({pubkey:n});return o.ndk=this,o}else if(e.startsWith("nprofile1")){const{type:r,data:n}=nip19_exports$1.decode(e);if(r!=="nprofile")throw new Error(`Invalid nprofile: ${e}`);const o=new NDKUser({pubkey:n.pubkey,relayUrls:n.relays});return o.ndk=this,o}else{const r=new NDKUser({pubkey:e});return r.ndk=this,r}}subscribe(e,t,r=!0,n=!0){let o=t?.relaySet,a=n;r instanceof NDKRelaySet?(console.warn("relaySet is deprecated, use opts.relaySet instead. This will be removed in version v2.14.0"),o=r,a=n):(typeof r=="boolean"||typeof r=="object")&&(a=r);let l;const u={relaySet:o,...t};a&&typeof a=="object"&&(a.onEvent&&(u.onEvent=a.onEvent),a.onEose&&(u.onEose=a.onEose),a.onClose&&(u.onClose=a.onClose),a.onEvents&&(l=a.onEvents));const f=new NDKSubscription(this,e,u);this.subManager.add(f),this.aiGuardrails?.subscription?.created(Array.isArray(e)?e:[e],u);const x=f.pool;if(f.relaySet)for(const p of f.relaySet.relays)x.useTemporaryRelay(p,void 0,f.filters);if(this.outboxPool&&f.hasAuthorsFilter()){const p=f.filters.filter(g=>g.authors&&g.authors?.length>0).flatMap(g=>g.authors);this.outboxTracker?.trackUsers(p)}return a&&setTimeout(async()=>{this.cacheAdapter?.initializeAsync&&!this.cacheAdapter.ready&&await this.cacheAdapter.initializeAsync(this);const p=f.start(!l);p&&p.length>0&&l&&l(p)},0),f}fetchEventFromTag=fetchEventFromTag.bind(this);fetchEventSync(e){if(!this.cacheAdapter)throw new Error("Cache adapter not set");let t;typeof e=="string"?t=[filterFromId(e)]:t=e;const r=new NDKSubscription(this,t),n=this.cacheAdapter.query(r);if(n instanceof Promise)throw new Error("Cache adapter is async");return n.map(o=>(o.ndk=this,o))}async fetchEvent(e,t,r){let n,o;if(r instanceof NDKRelay?o=new NDKRelaySet(new Set([r]),this):r instanceof NDKRelaySet&&(o=r),!r&&typeof e=="string"&&!isNip33AValue(e)){const a=relaysFromBech32(e,this);a.length>0&&(o=new NDKRelaySet(new Set(a),this),o=correctRelaySet(o,this.pool))}if(typeof e=="string"?n=[filterFromId(e)]:Array.isArray(e)?n=e:n=[e],typeof e!="string"&&this.aiGuardrails?.ndk?.fetchingEvents(n),n.length===0)throw new Error(`Invalid filter: ${JSON.stringify(e)}`);return new Promise((a,l)=>{let u=null;const f={...t||{},closeOnEose:!0};o&&(f.relaySet=o);const x=setTimeout(()=>{p.stop(),this.aiGuardrails._nextCallDisabled=null,a(u)},1e4),p=this.subscribe(n,f,{onEvent:g=>{g.ndk=this,g.isReplaceable()?(!u||u.created_at<g.created_at)&&(u=g):(clearTimeout(x),this.aiGuardrails._nextCallDisabled=null,a(g))},onEose:()=>{clearTimeout(x),this.aiGuardrails._nextCallDisabled=null,a(u)}})})}async fetchEvents(e,t,r){return this.aiGuardrails?.ndk?.fetchingEvents(e,t),new Promise(n=>{const o=new Map,a={...t||{},closeOnEose:!0};r&&(a.relaySet=r);const l=u=>{let f;u instanceof NDKEvent?f=u:f=new NDKEvent(void 0,u);const x=f.deduplicationKey(),p=o.get(x);p&&(f=dedup(p,f)),f.ndk=this,o.set(x,f)};this.subscribe(e,{...a,onEvent:l,onEose:()=>{this.aiGuardrails._nextCallDisabled=null,n(new Set(o.values()))}})})}assertSigner(){if(!this.signer)throw this.emit("signer:required"),new Error("Signer required")}getEntity=getEntity.bind(this);guardrailOff(e){return e?typeof e=="string"?this.aiGuardrails._nextCallDisabled=new Set([e]):this.aiGuardrails._nextCallDisabled=new Set(e):this.aiGuardrails._nextCallDisabled="all",this}set wallet(e){if(!e){this._wallet=void 0,this.walletConfig=void 0;return}this._wallet=e,this.walletConfig??={},this.walletConfig.lnPay=e?.lnPay?.bind(e),this.walletConfig.cashuPay=e?.cashuPay?.bind(e)}get wallet(){return this._wallet}},nip19_exports={};__reExport(nip19_exports,nip19_star);var nip49_exports={};__reExport(nip49_exports,nip49_star);function disconnect(e,t){return t??=createDebug5("ndk:relay:auth-policies:disconnect"),async r=>{t?.(`Relay ${r.url} requested authentication, disconnecting`),e.removeRelay(r.url)}}async function signAndAuth(e,t,r,n,o,a){try{await e.sign(r),o(e)}catch(l){n?.(`Failed to publish auth event to relay ${t.url}`,l),a(e)}}function signIn({ndk:e,signer:t,debug:r}={}){return r??=createDebug5("ndk:auth-policies:signIn"),async(n,o)=>{r?.(`Relay ${n.url} requested authentication, signing in`);const a=new NDKEvent(e);return a.kind=22242,a.tags=[["relay",n.url],["challenge",o]],t??=e?.signer,new Promise(async(l,u)=>{t?await signAndAuth(a,n,t,r,l,u):e?.once("signer:ready",async f=>{await signAndAuth(a,n,f,r,l,u)})})}}var NDKRelayAuthPolicies={disconnect,signIn};async function ndkSignerFromPayload(e,t){let r;try{r=JSON.parse(e)}catch(o){console.error("Failed to parse signer payload string",e,o);return}if(!r||typeof r.type!="string"){console.error("Failed to parse signer payload string",e,new Error("Missing type field"));return}const n=signerRegistry.get(r.type);if(!n)throw new Error(`Unknown signer type: ${r.type}`);try{return await n.fromPayload(e,t)}catch(o){const a=o instanceof Error?o.message:String(o);throw new Error(`Failed to deserialize signer type ${r.type}: ${a}`)}}var NDKNip07Signer=class xf{_userPromise;encryptionQueue=[];encryptionProcessing=!1;debug;waitTimeout;_pubkey;ndk;_user;constructor(t=1e3,r){this.debug=createDebug5("ndk:nip07"),this.waitTimeout=t,this.ndk=r}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}async blockUntilReady(){await this.waitForExtension();const t=await window.nostr?.getPublicKey();if(!t)throw new Error("User rejected access");this._pubkey=t;let r;return this.ndk?r=this.ndk.getUser({pubkey:t}):r=new NDKUser({pubkey:t}),this._user=r,r}async user(){return this._userPromise||(this._userPromise=this.blockUntilReady()),this._userPromise}get userSync(){if(!this._user)throw new Error("User not ready");return this._user}async sign(t){await this.waitForExtension();const r=await window.nostr?.signEvent(t);if(!r)throw new Error("Failed to sign event");return r.sig}async relays(t){await this.waitForExtension();const r=await window.nostr?.getRelays?.()||{},n=[];for(const o of Object.keys(r))r[o].read&&r[o].write&&n.push(o);return n.map(o=>new NDKRelay(o,t?.relayAuthDefaultPolicy,t))}async encryptionEnabled(t){const r=[];return(!t||t==="nip04")&&window.nostr?.nip04&&r.push("nip04"),(!t||t==="nip44")&&window.nostr?.nip44&&r.push("nip44"),r}async encrypt(t,r,n="nip04"){if(!await this.encryptionEnabled(n))throw new Error(`${n}encryption is not available from your browser extension`);await this.waitForExtension();const o=t.pubkey;return this.queueEncryption(n,"encrypt",o,r)}async decrypt(t,r,n="nip04"){if(!await this.encryptionEnabled(n))throw new Error(`${n}encryption is not available from your browser extension`);await this.waitForExtension();const o=t.pubkey;return this.queueEncryption(n,"decrypt",o,r)}async queueEncryption(t,r,n,o){return new Promise((a,l)=>{this.encryptionQueue.push({scheme:t,method:r,counterpartyHexpubkey:n,value:o,resolve:a,reject:l}),this.encryptionProcessing||this.processEncryptionQueue()})}async processEncryptionQueue(t,r=0){if(!t&&this.encryptionQueue.length===0){this.encryptionProcessing=!1;return}this.encryptionProcessing=!0;const n=t||this.encryptionQueue.shift();if(!n){this.encryptionProcessing=!1;return}const{scheme:o,method:a,counterpartyHexpubkey:l,value:u,resolve:f,reject:x}=n;this.debug("Processing encryption queue item",{method:a,counterpartyHexpubkey:l,value:u});try{const p=await window.nostr?.[o]?.[a](l,u);if(!p)throw new Error("Failed to encrypt/decrypt");f(p)}catch(p){const g=p instanceof Error?p.message:String(p);if(g.includes("call already executing")&&r<5){this.debug("Retrying encryption queue item",{method:a,counterpartyHexpubkey:l,value:u,retries:r}),setTimeout(()=>{this.processEncryptionQueue(n,r+1)},50*r);return}x(p instanceof Error?p:new Error(g))}this.processEncryptionQueue()}waitForExtension(){return new Promise((t,r)=>{if(window.nostr){t();return}let n;const o=setInterval(()=>{window.nostr&&(clearTimeout(n),clearInterval(o),t())},100);n=setTimeout(()=>{clearInterval(o),r(new Error("NIP-07 extension not available"))},this.waitTimeout)})}toPayload(){return JSON.stringify({type:"nip07",payload:""})}static async fromPayload(t,r){const n=JSON.parse(t);if(n.type!=="nip07")throw new Error(`Invalid payload type: expected 'nip07', got ${n.type}`);return new xf(void 0,r)}};registerSigner("nip07",NDKNip07Signer);var NDKNostrRpc=class extends libExports.EventEmitter{ndk;signer;relaySet;debug;encryptionType="nip04";pool;constructor(e,t,r,n){if(super(),this.ndk=e,this.signer=t,n){this.pool=new NDKPool(n,e,{debug:r.extend("rpc-pool"),name:"Nostr RPC"}),this.relaySet=new NDKRelaySet(new Set,e,this.pool);for(const o of n){const a=this.pool.getRelay(o,!1,!1);a.authPolicy=NDKRelayAuthPolicies.signIn({ndk:e,signer:t,debug:r}),this.relaySet.addRelay(a),a.connect()}}this.debug=r.extend("rpc")}subscribe(e){return new Promise(t=>{const r=this.ndk.subscribe(e,{closeOnEose:!1,groupable:!1,cacheUsage:"ONLY_RELAY",pool:this.pool,relaySet:this.relaySet,onEvent:async n=>{try{const o=await this.parseEvent(n);o.method?this.emit("request",o):(this.emit(`response-${o.id}`,o),this.emit("response",o))}catch(o){this.debug("error parsing event",o,n.rawEvent())}},onEose:()=>{this.debug("eosed"),t(r)}})})}async parseEvent(e){this.encryptionType==="nip44"&&e.content.includes("?iv=")?this.encryptionType="nip04":this.encryptionType==="nip04"&&!e.content.includes("?iv=")&&(this.encryptionType="nip44");const t=this.ndk.getUser({pubkey:e.pubkey});t.ndk=this.ndk;let r;try{r=await this.signer.decrypt(t,e.content,this.encryptionType)}catch{const p=this.encryptionType==="nip04"?"nip44":"nip04";r=await this.signer.decrypt(t,e.content,p),this.encryptionType=p}const n=JSON.parse(r),{id:o,method:a,params:l,result:u,error:f}=n;return a?{id:o,pubkey:e.pubkey,method:a,params:l,event:e}:{id:o,result:u,error:f,event:e}}async sendResponse(e,t,r,n=24133,o){const a={id:e,result:r};o&&(a.error=o);const l=await this.signer.user(),u=this.ndk.getUser({pubkey:t}),f=new NDKEvent(this.ndk,{kind:n,content:JSON.stringify(a),tags:[["p",t]],pubkey:l.pubkey});f.content=await this.signer.encrypt(u,f.content,this.encryptionType),await f.sign(this.signer),await f.publish(this.relaySet)}async sendRequest(e,t,r=[],n=24133,o){const a=Math.random().toString(36).substring(7),l=await this.signer.user(),u=this.ndk.getUser({pubkey:e}),f={id:a,method:t,params:r},x=new Promise(()=>{const g=y=>{y.result==="auth_url"?(this.once(`response-${a}`,g),this.emit("authUrl",y.error)):o&&o(y)};this.once(`response-${a}`,g)}),p=new NDKEvent(this.ndk,{kind:n,content:JSON.stringify(f),tags:[["p",e]],pubkey:l.pubkey});return p.content=await this.signer.encrypt(u,p.content,this.encryptionType),await p.sign(this.signer),await p.publish(this.relaySet),x}};function nostrConnectGenerateSecret(){return Math.random().toString(36).substring(2,15)}function generateNostrConnectUri(e,t,r,n){const o={name:n?.name?encodeURIComponent(n.name):"",url:n?.url?encodeURIComponent(n.url):"",image:n?.image?encodeURIComponent(n.image):"",perms:n?.perms?encodeURIComponent(n.perms):""};let a=`nostrconnect://${e}?image=${o.image}&url=${o.url}&name=${o.name}&perms=${o.perms}&secret=${encodeURIComponent(t)}`;return r&&(a+=`&relay=${encodeURIComponent(r)}`),a}var NDKNip46Signer=class Do extends libExports.EventEmitter{ndk;_user;bunkerPubkey;userPubkey;get pubkey(){if(!this.userPubkey)throw new Error("Not ready");return this.userPubkey}secret;localSigner;nip05;rpc;debug;relayUrls;subscription;nostrConnectUri;nostrConnectSecret;constructor(t,r,n,o,a){super(),this.ndk=t,this.debug=t.debug.extend("nip46:signer"),this.relayUrls=o,n?typeof n=="string"?this.localSigner=new NDKPrivateKeySigner(n):this.localSigner=n:this.localSigner=NDKPrivateKeySigner.generate(),r===!1||(r?r.startsWith("bunker://")?this.bunkerFlowInit(r):this.nip05Init(r):this.nostrconnectFlowInit(a)),this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls)}static bunker(t,r,n){return new Do(t,r,n)}static nostrconnect(t,r,n,o){return new Do(t,void 0,n,[r],o)}nostrconnectFlowInit(t){this.nostrConnectSecret=nostrConnectGenerateSecret();const r=this.localSigner.pubkey;this.nostrConnectUri=generateNostrConnectUri(r,this.nostrConnectSecret,this.relayUrls?.[0],t)}bunkerFlowInit(t){const r=new URL(t),n=r.hostname||r.pathname.replace(/^\/\//,""),o=r.searchParams.get("pubkey"),a=r.searchParams.getAll("relay"),l=r.searchParams.get("secret");this.bunkerPubkey=n,this.userPubkey=o,this.relayUrls=a,this.secret=l}nip05Init(t){this.nip05=t}async startListening(){if(this.subscription)return;const t=await this.localSigner.user();if(!t)throw new Error("Local signer not ready");this.subscription=await this.rpc.subscribe({kinds:[24133],"#p":[t.pubkey]})}async user(){return this._user?this._user:this.blockUntilReady()}get userSync(){if(!this._user)throw new Error("Remote user not ready synchronously");return this._user}async blockUntilReadyNostrConnect(){return new Promise((t,r)=>{const n=o=>{o.result===this.nostrConnectSecret&&(this._user=o.event.author,this.userPubkey=o.event.pubkey,this.bunkerPubkey=o.event.pubkey,this.rpc.off("response",n),t(this._user))};this.startListening(),this.rpc.on("response",n)})}async blockUntilReady(){if(!this.bunkerPubkey&&!this.nostrConnectSecret&&!this.nip05)throw new Error("Bunker pubkey not set");if(this.nostrConnectSecret)return this.blockUntilReadyNostrConnect();if(this.nip05&&!this.userPubkey){const t=await NDKUser.fromNip05(this.nip05,this.ndk);t&&(this._user=t,this.userPubkey=t.pubkey,this.relayUrls=t.nip46Urls,this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls))}if(!this.bunkerPubkey&&this.userPubkey)this.bunkerPubkey=this.userPubkey;else if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");return await this.startListening(),this.rpc.on("authUrl",(...t)=>{this.emit("authUrl",...t)}),new Promise((t,r)=>{const n=[this.userPubkey??""];if(this.secret&&n.push(this.secret),!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"connect",n,24133,o=>{o.result==="ack"?this.getPublicKey().then(a=>{this.userPubkey=a,this._user=this.ndk.getUser({pubkey:a}),t(this._user)}):r(o.error)})})}stop(){this.subscription?.stop(),this.subscription=void 0}async getPublicKey(){return this.userPubkey?this.userPubkey:new Promise((t,r)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"get_public_key",[],24133,n=>{t(n.result)})})}async encryptionEnabled(t){return t?[t]:Promise.resolve(["nip04","nip44"])}async encrypt(t,r,n="nip04"){return this.encryption(t,r,n,"encrypt")}async decrypt(t,r,n="nip04"){return this.encryption(t,r,n,"decrypt")}async encryption(t,r,n,o){return new Promise((l,u)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,`${n}_${o}`,[t.pubkey,r],24133,f=>{f.error?u(f.error):l(f.result)})})}async sign(t){return new Promise((n,o)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"sign_event",[JSON.stringify(t)],24133,a=>{if(a.error)o(a.error);else{const l=JSON.parse(a.result);n(l.sig)}})})}async createAccount(t,r,n){await this.startListening();const o=[];return t&&o.push(t),r&&o.push(r),n&&o.push(n),new Promise((a,l)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"create_account",o,24133,u=>{if(u.error)l(u.error);else{const f=u.result;a(f)}})})}toPayload(){if(!this.bunkerPubkey||!this.userPubkey)throw new Error("NIP-46 signer is not fully initialized for serialization");const t={type:"nip46",payload:{bunkerPubkey:this.bunkerPubkey,userPubkey:this.userPubkey,relayUrls:this.relayUrls,secret:this.secret,localSignerPayload:this.localSigner.toPayload(),nip05:this.nip05||null}};return JSON.stringify(t)}static async fromPayload(t,r){if(!r)throw new Error("NDK instance is required to deserialize NIP-46 signer");const n=JSON.parse(t);if(n.type!=="nip46")throw new Error(`Invalid payload type: expected 'nip46', got ${n.type}`);const o=n.payload;if(!o||typeof o!="object"||!o.localSignerPayload)throw new Error("Invalid payload content for nip46 signer");const a=await ndkSignerFromPayload(o.localSignerPayload,r);if(!a)throw new Error("Failed to deserialize local signer for NIP-46");if(!(a instanceof NDKPrivateKeySigner))throw new Error("Local signer must be an instance of NDKPrivateKeySigner");let l;return l=new Do(r,!1,a,o.relayUrls),l.userPubkey=o.userPubkey,l.bunkerPubkey=o.bunkerPubkey,l.relayUrls=o.relayUrls,l.secret=o.secret,o.userPubkey&&(l._user=new NDKUser({pubkey:o.userPubkey}),l._user&&(l._user.ndk=r)),l}};registerSigner("nip46",NDKNip46Signer);createDebug5("ndk:zapper:ln");createDebug5("ndk:zapper");const DEFAULT_RELAYS=[{url:"wss://relay.primal.net",status:"disconnected",failedAttempts:0},{url:"wss://relay.damus.io",status:"disconnected",failedAttempts:0},{url:"wss://nos.lol",status:"disconnected",failedAttempts:0}],useRelayStore=create()(persist((e,t)=>({relays:DEFAULT_RELAYS,addRelay:r=>{const n=r.trim();if(!n.startsWith("wss://")&&!n.startsWith("ws://")){console.error("[RelayStore] Invalid relay URL:",r);return}if(t().relays.find(a=>a.url===n)){console.warn("[RelayStore] Relay already exists:",n);return}e(a=>({relays:[...a.relays,{url:n,status:"disconnected",failedAttempts:0}]}))},removeRelay:r=>{e(n=>({relays:n.relays.filter(o=>o.url!==r)}))},updateRelayStatus:(r,n)=>{e(o=>({relays:o.relays.map(a=>a.url===r?{...a,status:n,lastConnected:n==="connected"?Date.now():a.lastConnected}:a)}))},incrementFailedAttempts:r=>{e(n=>({relays:n.relays.map(o=>o.url===r?{...o,failedAttempts:o.failedAttempts+1}:o)}))},resetFailedAttempts:r=>{e(n=>({relays:n.relays.map(o=>o.url===r?{...o,failedAttempts:0}:o)}))},getRelay:r=>t().relays.find(n=>n.url===r),isOnline:()=>t().relays.some(r=>r.status==="connected")}),{name:"amber-relays",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-Bra1CBZx.js");return{storage:r}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:r}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-Bra1CBZx.js");return{storage:n}},[],import.meta.url);return r.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-Bra1CBZx.js");return{storage:r}},[],import.meta.url);return t.removeItem(e)}}))})),BroadcastModal=({eventJson:e,onClose:t,onBroadcast:r})=>{const[n,o]=reactExports.useState(!1),[a,l]=reactExports.useState(!1),[u,f]=reactExports.useState(null),[x,p]=reactExports.useState(null),[g,y]=reactExports.useState(!1),[b,w]=reactExports.useState(!1),v=()=>{try{const j=nip19_exports$1.npubEncode(e.pubkey);navigator.clipboard.writeText(j),w(!0),setTimeout(()=>w(!1),2e3)}catch(j){console.error(j)}};React.useEffect(()=>{(async()=>{if(e.pubkey){y(!0);try{const F=useRelayStore.getState().relays.map(C=>C.url);if(F.length>0){const C=new NDK({explicitRelayUrls:F});await C.connect();const N=C.getUser({hexpubkey:e.pubkey});await N.fetchProfile(),N.profile&&p(N.profile)}}catch(F){console.error("Failed to fetch profile",F)}finally{y(!1)}}})()},[e.pubkey]);const B=async()=>{o(!0),f(null);try{await r(),l(!0),setTimeout(t,2e3)}catch(j){f(j.message),o(!1)}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl my-8 animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-slate-800 rounded-full",children:jsxRuntimeExports.jsx(Radio,{className:"w-6 h-6 text-green-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Broadcast Event"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Publish to relays"})]})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-lg text-slate-500 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800 mb-6 space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-800 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-800 overflow-hidden shrink-0 border border-slate-700 flex items-center justify-center",children:g?jsxRuntimeExports.jsx(Loader,{className:"w-5 h-5 text-slate-500 animate-spin"}):x?.image?jsxRuntimeExports.jsx("img",{src:x.image,alt:x.name,className:"w-full h-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500",children:jsxRuntimeExports.jsx(User,{className:"w-6 h-6"})})}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[g?jsxRuntimeExports.jsx("div",{className:"h-4 w-24 bg-slate-800 rounded animate-pulse mb-1"}):x?.displayName?jsxRuntimeExports.jsx("p",{className:"text-white font-bold text-sm truncate",children:x.displayName}):null,jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[g?jsxRuntimeExports.jsx("div",{className:"h-3 w-32 bg-slate-800 rounded animate-pulse"}):jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-400 truncate font-mono",children:[x?.name?`@${x.name}`:"",jsxRuntimeExports.jsx("span",{className:x?.name?"ml-2 opacity-70":"",children:(()=>{try{const j=nip19_exports$1.npubEncode(e.pubkey);return`${j.slice(0,5)}...${j.slice(-5)}`}catch{return e.pubkey.slice(0,10)+"..."}})()})]}),!g&&jsxRuntimeExports.jsx("button",{onClick:v,className:"text-slate-500 hover:text-white transition-colors",title:"Copy Npub",children:b?jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]}),!g&&x?.nip05&&jsxRuntimeExports.jsx("p",{className:"text-[10px] text-amber-500 truncate",children:x.nip05})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Kind"}),jsxRuntimeExports.jsx("span",{className:"text-amber-500 font-mono text-sm",children:e.kind})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider block mb-2",children:"Content"}),jsxRuntimeExports.jsx("div",{className:"bg-slate-900 rounded p-2 text-xs text-slate-300 font-mono whitespace-pre-wrap break-words max-h-32 overflow-y-auto border border-slate-800",children:e.content||"<No Content>"})]}),jsxRuntimeExports.jsxs("div",{className:"pt-2 border-t border-slate-800 flex items-center gap-2 text-green-400 text-xs font-mono",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3 h-3"}),"Valid Signature"]})]}),u&&jsxRuntimeExports.jsxs("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg flex items-center gap-2 text-red-400 text-sm",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4"}),u]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:t,disabled:n||a,className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 disabled:opacity-50 text-white font-bold rounded-xl transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:B,disabled:n||a,className:`flex-1 py-3 font-bold rounded-xl transition-colors flex items-center justify-center gap-2 ${a?"bg-green-500 text-slate-950":"bg-green-600 hover:bg-green-700 text-white"}`,children:n?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Broadcasting..."]}):a?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),"Sent!"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Send,{className:"w-4 h-4"}),"Broadcast"]})})]})]})})},DEFAULT_EVENT={kind:1,created_at:Math.floor(Date.now()/1e3),tags:[],content:"This is a test event for offline signing. You can edit this text to make it larger and test animated QRs.",pubkey:""},EventCreator=({onClose:e})=>{const[t,r]=reactExports.useState(JSON.stringify(DEFAULT_EVENT,null,2)),[n,o]=reactExports.useState(!1),[a,l]=reactExports.useState(null),[u,f]=reactExports.useState(null),x=reactExports.useRef(null);reactExports.useEffect(()=>{const F={...DEFAULT_EVENT,created_at:Math.floor(Date.now()/1e3)};r(JSON.stringify(F,null,2))},[]);const p=(F,C,N,T,_)=>{try{JSON.parse(F);const{currentKeypairId:S,wallets:O,currentWalletId:$}=useWalletStore.getState(),W=O.find(k=>k.id===$)?.keypairs.find(k=>k.id===S);let U="";try{if(W?.npub){const{data:k}=nip19_exports$1.decode(W.npub);U=k}}catch(k){console.error("Failed to decode npub",k)}if(!U){l("No active keypair found");return}const I=Math.random().toString(36).substring(7),G=useRequestStore.getState();G.requests.forEach(k=>{k.internal&&G.removeRequest(k.id)}),useRequestStore.getState().addRequest({id:I,requestEventId:"internal-"+I,requestorPubkey:U,method:"sign_event",params:[F],timestamp:Date.now()/1e3,source:"client",internal:!0,title:N,description:_,confirmLabel:T,onSuccess:k=>{C(k),l(null)},onError:k=>{l("Signing failed: "+k.message)}})}catch{l("Invalid JSON")}},g=()=>{const F=JSON.parse(t);F.created_at=Math.floor(Date.now()/1e3);const C=JSON.stringify(F,null,2);p(C,N=>{r(JSON.stringify(JSON.parse(N),null,2));const T=new Blob([N],{type:"application/json"}),_=URL.createObjectURL(T),S=document.createElement("a");S.href=_,S.download=`nostr-event-${Date.now()}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(_),document.body.removeChild(S),URL.revokeObjectURL(_)},"Export Event","Sign & Export","You are opting to sign this event and export it as a JSON file.")},y=()=>{if(n){o(!1);return}const F=JSON.parse(t);F.created_at=Math.floor(Date.now()/1e3);const C=JSON.stringify(F,null,2);p(C,N=>{r(JSON.stringify(JSON.parse(N),null,2)),o(!0)},"Generate QR","Sign & Generate QR","You are opting to sign this event to display it as a QR code.")},b=()=>{try{const F=JSON.parse(t),{wallets:C,currentWalletId:N,currentKeypairId:T}=useWalletStore.getState(),S=C.find(z=>z.id===N)?.keypairs.find(z=>z.id===T);let O="";if(S?.npub)try{const{data:z}=nip19_exports$1.decode(S.npub);O=z}catch(z){console.error(z)}if(!O){l("No active keypair found to sign with");return}F.pubkey=O,F.created_at=Math.floor(Date.now()/1e3),delete F.id,delete F.sig;const $=JSON.stringify(F,null,2);r($),p($,z=>{const W=JSON.parse(z);r(JSON.stringify(W,null,2)),f(W)},"Broadcast","Sign & Broadcast","You are opting to sign this event with YOUR key and broadcast it to the network.")}catch{l("Invalid JSON")}},w=F=>{r(F.target.value),n&&o(!1),l(null)},v=()=>{x.current?.click()},B=F=>{const C=F.target.files?.[0];if(!C)return;const N=new FileReader;N.onload=T=>{try{const _=T.target?.result,S=JSON.parse(_);if(S.sig){f(S),r(JSON.stringify(S,null,2)),l(null),x.current&&(x.current.value="");return}r(JSON.stringify(S,null,2)),l(null),n&&o(!1)}catch{l("Failed to parse JSON file")}x.current&&(x.current.value="")},N.readAsText(C)},j=async()=>{if(!u)return;const F=useRelayStore.getState().relays.map(N=>N.url);if(F.length===0)throw new Error("No relays connected");const C=new NDK({explicitRelayUrls:F});try{await Promise.race([C.connect(),new Promise((N,T)=>setTimeout(()=>T(new Error("Broadcast connection timed out")),5e3))])}catch(N){console.warn("Broadcast connection timed out/failed, checking for partial connections...",N);let T=0;if(C.pool.relays.forEach(_=>{(_.status===1||_.status===5)&&T++}),T===0)throw console.error("No relays connected for broadcast"),N;console.log(`Proceeding with broadcast via ${T} relays`)}try{const N=new NDKEvent(C,u);await N.publish(),console.log("Published event:",N.id)}catch(N){throw console.error("Broadcast failed:",N),N}};return jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 border border-slate-800 shadow-xl mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-bold text-amber-500 flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:""})," Event Creator"]}),e&&jsxRuntimeExports.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-300",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("textarea",{value:t,onChange:w,className:"w-full h-48 bg-slate-950 text-slate-300 font-mono text-xs p-4 rounded-xl border border-slate-800 focus:border-amber-500/50 outline-none resize-none",spellCheck:!1}),a&&jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 right-4 text-red-500 text-xs font-bold bg-slate-900/90 px-2 py-1 rounded",children:a})]}),jsxRuntimeExports.jsx("input",{type:"file",ref:x,className:"hidden",accept:".json",onChange:B}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:v,className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Upload,{className:"w-4 h-4 text-emerald-500"}),"Import JSON"]}),jsxRuntimeExports.jsxs("button",{onClick:g,className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4 text-blue-500"}),"Sign & Export"]})]}),jsxRuntimeExports.jsxs("button",{onClick:b,className:"w-full py-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 border-2 border-slate-700 hover:border-green-500/50",children:[jsxRuntimeExports.jsx(Radio,{className:"w-5 h-5 text-green-500"}),"Sign & Broadcast"]}),jsxRuntimeExports.jsxs("button",{onClick:y,className:"w-full py-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 border-2 border-slate-700 hover:border-amber-500/50",children:[jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5 text-amber-500"}),n?"Hide QR Code":"Sign & Generate QR"]})]}),n&&jsxRuntimeExports.jsxs("div",{className:"bg-white p-4 rounded-xl flex flex-col items-center gap-2 animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsx("div",{className:"w-full max-w-[300px]",children:jsxRuntimeExports.jsx(AnimatedQRCode,{data:t,type:"bytes"})}),jsxRuntimeExports.jsx("p",{className:"text-slate-900 text-xs font-bold mt-4",children:"Scan with Offline Device"})]})]}),u&&jsxRuntimeExports.jsx(BroadcastModal,{eventJson:u,onClose:()=>f(null),onBroadcast:j})]})},useConnectionsStore=create()(persist((e,t)=>({connections:[],autoApprovalRules:[],addConnection:r=>e(n=>({connections:[...n.connections,r]})),updateConnectionStatus:(r,n)=>e(o=>({connections:o.connections.map(a=>a.id===r?{...a,status:n}:a)})),updateConnection:(r,n)=>e(o=>({connections:o.connections.map(a=>a.id===r?{...a,...n}:a)})),removeConnection:r=>e(n=>({connections:n.connections.filter(o=>o.id!==r),autoApprovalRules:n.autoApprovalRules.filter(o=>o.connectionId!==r)})),getConnection:r=>t().connections.find(n=>n.id===r),addRule:r=>e(n=>{console.log("[ConnectionsStore] addRule called with:",r),console.log("[ConnectionsStore] Current rules before add:",n.autoApprovalRules);const o=[...n.autoApprovalRules,r];return console.log("[ConnectionsStore] New rules after add:",o),{autoApprovalRules:o}}),removeRule:r=>e(n=>({autoApprovalRules:n.autoApprovalRules.filter(o=>o.id!==r)})),getRulesForConnection:r=>t().autoApprovalRules.filter(n=>n.connectionId===r)}),{name:"amber-connections",storage:createJSONStorage(()=>({getItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-Bra1CBZx.js");return{storage:r}},[],import.meta.url);return t.getItem(e)},setItem:async(e,t)=>{const{storage:r}=await __vitePreload(async()=>{const{storage:n}=await import("./storage-Bra1CBZx.js");return{storage:n}},[],import.meta.url);return r.setItem(e,t)},removeItem:async e=>{const{storage:t}=await __vitePreload(async()=>{const{storage:r}=await import("./storage-Bra1CBZx.js");return{storage:r}},[],import.meta.url);return t.removeItem(e)}}))})),useActivityLogStore=create()(persist(e=>({entries:[],maxEntries:100,addEntry:t=>e(r=>{const o=[{...t,id:crypto.randomUUID(),timestamp:Date.now()},...r.entries];return o.length>r.maxEntries&&o.splice(r.maxEntries),{entries:o}}),clearLog:()=>e({entries:[]})}),{name:"amber-activity-log"})),hexToBytes$1=e=>{const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++)t[r]=parseInt(e.substr(r*2,2),16);return t};class SignerService{ndk;signer;privateKey;sub;lastEventTime=0;constructor(t){this.privateKey=t,this.signer=new NDKPrivateKeySigner(t),this.initializeNDK()}initializeNDK(){const t=useRelayStore.getState().relays.map(n=>n.url),r=["wss://relay.nsec.app","wss://relay.primal.net","wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band"];this.ndk=new NDK({explicitRelayUrls:t.length>0?t:r}),this.ndk.signer=this.signer}async connect(t=!1){if(this.sub&&(console.log("[SignerService] Stopping existing subscription before reconnecting..."),this.sub.stop(),this.sub=null),t){console.log("[SignerService] FORCE connecting: DESTROYING and RECREATING NDK instance...");try{this.ndk.pool.relays.forEach(n=>{try{n.disconnect()}catch(o){console.error("Error disconnecting relay:",o)}})}catch(n){console.error("[SignerService] Error during pool cleanup:",n)}await new Promise(n=>setTimeout(n,500)),this.initializeNDK(),console.log("[SignerService] NDK instance recreated.")}console.log("[SignerService] Attempting to connect to relays...");const r=useRelayStore.getState().relays.map(n=>n.url);r.forEach(n=>{useRelayStore.getState().updateRelayStatus(n,"connecting")});try{await new Promise(o=>setTimeout(o,500));try{await Promise.race([this.ndk.connect(),new Promise((o,a)=>setTimeout(()=>a(new Error("Connection timeout")),1e4))]),console.log("[SignerService] NDK connected successfully!")}catch(o){console.warn("[SignerService] NDK connect failed/timed out:",o);let a=0;if(this.ndk.pool.relays.forEach(l=>{l.status===NDKRelayStatus.CONNECTED&&a++}),a===0)throw console.error("[SignerService] No connected relays. Aborting."),o;console.log(`[SignerService] Proceeding with partial connection (${a} relays connected).`)}r.forEach(o=>{const a=Array.from(this.ndk.pool.relays.values()).find(l=>l.url.includes(o)||o.includes(l.url));a&&a.status===NDKRelayStatus.CONNECTED&&(useRelayStore.getState().updateRelayStatus(o,"connected"),useRelayStore.getState().resetFailedAttempts(o))}),this.ndk.pool.relays.forEach(o=>{o.status===NDKRelayStatus.CONNECTED&&(useRelayStore.getState().updateRelayStatus(o.url,"connected"),useRelayStore.getState().resetFailedAttempts(o.url))});const n=await this.signer.user();console.log("[SignerService] Listening for NIP-46 requests to:",n.pubkey),this.sub=this.ndk.subscribe({kinds:[24133],"#p":[n.pubkey],since:Math.floor(Date.now()/1e3)-60},{closeOnEose:!1}),this.sub.on("event",async o=>{this.lastEventTime=Date.now(),console.log("[SignerService] Received NIP-46 event (Health Updated):",o.id);try{let a;try{console.log("[SignerService] Trying NIP-44 decryption...");const y=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),o.pubkey);a=nip44_exports.v2.decrypt(o.content,y),console.log("[SignerService] NIP-44 decryption successful!")}catch(y){console.log("[SignerService] NIP-46 failed, trying NIP-04...",y),a=await nip04_exports.decrypt(this.privateKey,o.pubkey,o.content),console.log("[SignerService] NIP-04 decryption successful!")}console.log("[SignerService] Decrypted content:",a);const l=JSON.parse(a),{id:u,method:f,params:x}=l;console.log("[SignerService] Parsed request:",{id:u,method:f,params:x});const p={id:u,requestEventId:o.id,requestorPubkey:o.pubkey,method:f,params:x,timestamp:o.created_at||Date.now()/1e3};let g=!1;if(f==="sign_event")try{const y=x[0],w=JSON.parse(y).kind,v=useConnectionsStore.getState(),B=v.connections.find(j=>j.signerPubkey===o.pubkey);if(B&&v.getRulesForConnection(B.id).find(C=>C.kinds.includes(w))){console.log(`[SignerService] Auto-approving kind ${w} for ${B.name||"app"}`),g=!0,await this.approveRequest(u,o.id,o.pubkey,f,x);return}}catch(y){console.error("[SignerService] Error checking auto-approval:",y)}else if(f==="get_public_key")try{const b=useConnectionsStore.getState().connections.find(w=>w.signerPubkey===o.pubkey);if(b){console.log(`[SignerService] Auto-approving get_public_key for ${b.name||"app"}`),g=!0,await this.approveRequest(u,o.id,o.pubkey,f,x);return}}catch(y){console.error("[SignerService] Error checking get_public_key auto-approval:",y)}g||(console.log("[SignerService] Adding request to store and showing notification"),useRequestStore.getState().addRequest(p))}catch(a){console.error("Failed to parse NIP-46 request",a)}})}catch(n){throw console.error("[SignerService] Connection failed:",n),r.forEach(o=>{useRelayStore.getState().updateRelayStatus(o,"error"),useRelayStore.getState().incrementFailedAttempts(o)}),n}}async signEventInternal(t){const r=new NDKEvent(this.ndk,JSON.parse(t));return await r.sign(this.signer),JSON.stringify(r.rawEvent())}async approveRequest(t,r,n,o,a){try{let l=null;switch(o){case"connect":l="ack";break;case"get_public_key":l=(await this.signer.user()).pubkey;break;case"sign_event":const y=a[0],b=new NDKEvent(this.ndk,JSON.parse(y));await b.sign(this.signer),l=JSON.stringify(b.rawEvent());break;case"nip04_decrypt":const w=a[0],v=a[1];l=await nip04_exports.decrypt(this.privateKey,w,v);break;case"nip04_encrypt":const B=a[0],j=a[1];l=await nip04_exports.encrypt(this.privateKey,B,j);break;default:throw new Error(`Unknown method: ${o}`)}const u=JSON.stringify({id:t,result:l,error:null}),f=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),n),x=nip44_exports.v2.encrypt(u,f),p=new NDKEvent(this.ndk);p.kind=24133,p.tags=[["p",n],["e",r]],p.content=x,await p.sign(this.signer),console.log("[SignerService]  About to publish response for:",o),console.log("[SignerService]  Response triggered from:",new Error().stack?.split(`
`)[2]?.trim()),await p.publish(),console.log("[SignerService] Sent encrypted response for:",o),useActivityLogStore.getState().addEntry({action:"approved",method:o,appName:"Bunker Client",appPubkey:n,event:o==="sign_event"&&a[0]?typeof a[0]=="string"?JSON.parse(a[0]):a[0]:void 0}),useRequestStore.getState().removeRequest(t)}catch(l){console.error("Error approving request:",l),this.rejectRequest(t,r,n,l.message)}}async rejectRequest(t,r,n,o="User rejected"){const a=JSON.stringify({id:t,result:null,error:o}),l=nip44_exports.v2.utils.getConversationKey(hexToBytes$1(this.privateKey),n),u=nip44_exports.v2.encrypt(a,l),f=new NDKEvent(this.ndk);f.kind=24133,f.tags=[["p",n],["e",r]],f.content=u,await f.sign(this.signer),console.log(`[SignerService]  ABOUT TO SEND REJECTION for ${t}:`,{error:o,to:n.slice(0,8),stackTrace:new Error().stack?.split(`
`).slice(1,4).join(`
`)}),await f.publish(),console.log("[SignerService] Sent encrypted rejection"),useRequestStore.getState().removeRequest(t)}async getBunkerURI(){return`bunker://${(await this.signer.user()).pubkey}?relay=wss://relay.damus.io`}disconnect(){this.sub&&this.sub.stop()}async addRelay(t){console.log("[SignerService] Adding new relay:",t);const r=this.ndk.addExplicitRelay(t);useRelayStore.getState().updateRelayStatus(t,"connecting");try{await r.connect(),console.log("[SignerService] New relay connected:",t),useRelayStore.getState().updateRelayStatus(t,"connected"),useRelayStore.getState().resetFailedAttempts(t)}catch(n){console.error("[SignerService] Failed to connect to new relay:",n),useRelayStore.getState().updateRelayStatus(t,"error"),useRelayStore.getState().incrementFailedAttempts(t)}}hasActiveSubscription(){return this.sub!==null&&this.sub!==void 0}isSubscriptionHealthy(){if(Date.now()-this.lastEventTime<6e4)return!0;let t=0;const r=[];return this.ndk.pool.relays.forEach(n=>{r.push(`${n.url}: ${n.status}`),(n.status===NDKRelayStatus.CONNECTED||n.status===1)&&t++}),t===0&&console.log("[SignerService] Health Check Details:",r,"Enum CONNECTED:",NDKRelayStatus.CONNECTED),t>0}async reconnectSubscription(t=!1){console.log(`[SignerService] Attempting to reconnect subscription... (Force: ${t})`);try{return await this.connect(t),!0}catch(r){return console.error("[SignerService] Failed to reconnect subscription:",r),!1}}}const parseRequestForUI=(e,t)=>{const{method:r,params:n}=e,o=t||"The app",a=l=>e.description||l;if(r==="get_public_key")return{title:e.title||"Connection Request",description:a(`${o} wants to connect to your signer. It will be able to read your public key.`),primaryAction:"Connect",riskLevel:"low",icon:"connect"};if(r==="nip04_encrypt")return{title:"Send Private Message",description:`${o} wants to encrypt a private message.`,contentPreview:typeof n[1]=="string"?n[1]:"Unknown content",primaryAction:"Encrypt",riskLevel:"medium",icon:"encrypt"};if(r==="nip04_decrypt")return{title:"Read Private Message",description:`${o} wants to decrypt a private message sent to you.`,primaryAction:"Decrypt",riskLevel:"medium",icon:"decrypt"};if(r==="sign_event")try{const l=JSON.parse(n[0]),u=l.kind,f=l.content||"";if(u===1)return{title:e.title||"Post a Note",description:a(`${o} wants to publish a public note to your profile.`),contentPreview:f,primaryAction:"Post",riskLevel:"low",icon:"post"};if(u===7){let x="";return f==="+"?x="":f==="-"?x="":f&&(x=f),{title:"React to Post",description:`${o} wants to react with ${x} to a post.`,primaryAction:"React",riskLevel:"low",icon:"reaction"}}if(u===0)return{title:"Update Profile",description:`${o} wants to update your public profile (name, picture, etc).`,contentPreview:"Profile Data Update",primaryAction:"Update",riskLevel:"medium",icon:"profile"};if(u===3){const x=l.tags.filter(p=>p[0]==="p").length;return{title:"Update Follow List",description:`${o} wants to update your following list (${x} people).`,primaryAction:"Update",riskLevel:"medium",icon:"profile"}}return u===6?{title:"Repost",description:`${o} wants to share a post to your profile.`,primaryAction:"Repost",riskLevel:"low",icon:"post"}:u===9734?{title:"Send Zap",description:`${o} wants to request a Zap (Tip) payment.`,primaryAction:"Zap",riskLevel:"medium",icon:"zap"}:{title:e.title||`Publish Event (Kind ${u})`,description:a(`${o} wants to publish a standard Nostr event.`),contentPreview:f?f.length>100?f.slice(0,100)+"...":f:"No content",primaryAction:"Sign",riskLevel:"medium",icon:"unknown"}}catch(l){return console.error("Failed to parse event for UI",l),{title:"Sign Malformed Event",description:"The app wants to sign a specific event, but the data seems invalid.",primaryAction:"Sign",riskLevel:"high",icon:"unknown"}}return{title:"Unknown Request",description:`Request method: ${r}`,primaryAction:"Approve",riskLevel:"high",icon:"unknown"}},RequestModal=({request:e,onApprove:t,onReject:r})=>{const[n,o]=reactExports.useState(!1),[a,l]=reactExports.useState(!1),[u,f]=reactExports.useState(!1);React.useEffect(()=>{o(!1),l(!1),f(!1)},[e.id]);const g=useConnectionsStore(B=>B.connections).find(B=>B.signerPubkey===e.requestorPubkey)?.name,y=parseRequestForUI(e,g),b=()=>{switch(y.icon){case"post":return jsxRuntimeExports.jsx(MessageSquare,{className:"w-6 h-6 text-amber-500"});case"reaction":return jsxRuntimeExports.jsx(MessageSquare,{className:"w-6 h-6 text-red-500"});case"zap":return jsxRuntimeExports.jsx(Zap,{className:"w-6 h-6 text-yellow-500"});case"profile":return jsxRuntimeExports.jsx(User,{className:"w-6 h-6 text-blue-500"});case"connect":return jsxRuntimeExports.jsx(Link,{className:"w-6 h-6 text-green-500"});case"encrypt":return jsxRuntimeExports.jsx(Lock,{className:"w-6 h-6 text-indigo-500"});case"decrypt":return jsxRuntimeExports.jsx(Lock,{className:"w-6 h-6 text-indigo-500"});default:return jsxRuntimeExports.jsx(FileText,{className:"w-6 h-6 text-slate-400"})}},w=B=>{o(!0),t(B)},v=()=>{l(!0),r()};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl my-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-slate-800 rounded-full",children:b()}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:e.title||y.title}),!e.internal&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-slate-400",children:["from ",e.requestorPubkey.slice(0,8),"..."]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>f(!u),className:"p-2 hover:bg-slate-800 rounded-lg text-slate-500 hover:text-white transition-colors",title:u?"Show Simple View":"Show Advanced Details",children:u?jsxRuntimeExports.jsx(Code,{className:"w-5 h-5 text-amber-500"}):jsxRuntimeExports.jsx(Code,{className:"w-5 h-5"})})]}),!u&&jsxRuntimeExports.jsx("div",{className:"space-y-6",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800",children:[jsxRuntimeExports.jsx("p",{className:"text-slate-300 text-sm leading-relaxed mb-3",children:y.description}),y.contentPreview&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-lg p-3 border border-slate-800",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase mb-1",children:"Preview"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-white font-mono whitespace-pre-wrap break-words max-h-32 overflow-y-auto",children:y.contentPreview})]})]})}),u&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 mb-6 border border-slate-800 animate-in fade-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Method"}),jsxRuntimeExports.jsx("p",{className:"text-amber-400 font-mono text-sm",children:e.method})]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Request ID"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 font-mono text-xs",children:e.id})]}),e.method==="sign_event"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Raw Event JSON"}),jsxRuntimeExports.jsx("pre",{className:"text-xs text-slate-300 overflow-auto max-h-48 mt-1 p-2 bg-slate-900 rounded border border-slate-800 font-mono",children:JSON.stringify(JSON.parse(e.params[0]),null,2)})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3 mt-6",children:[jsxRuntimeExports.jsx("button",{onClick:v,disabled:n||a,className:"w-full bg-slate-800 hover:bg-slate-700 disabled:bg-slate-700 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:a?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),e.internal?"Cancelling...":"Rejecting..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(X,{className:"w-4 h-4"}),e.cancelLabel||(e.internal?"Cancel":"Block Request")]})}),(e.method==="sign_event"||e.method==="nip04_decrypt"||e.method==="nip04_encrypt")&&!e.internal&&jsxRuntimeExports.jsx("button",{onClick:()=>w(!0),disabled:n||a,className:"w-full bg-amber-600 hover:bg-amber-700 disabled:bg-amber-700 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:n?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Approving..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ShieldAlert,{className:"w-4 h-4"}),"Trust & Auto-Approve"]})}),jsxRuntimeExports.jsx("button",{onClick:()=>w(!1),disabled:n||a,className:"w-full bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:n?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),e.internal?"Signing...":"Approving..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),e.confirmLabel||`${y.primaryAction} Once`]})})]})]})})},OfflineSigner=({event:e,onClose:t})=>{const{decryptedKey:r}=useAuthStore(),[n,o]=reactExports.useState(null),[a,l]=reactExports.useState(null),u={id:"offline",pubkey:e.pubkey,method:"sign_event",params:[JSON.stringify(e)],encryptedNsec:"",requestorPubkey:e.pubkey},f=parseRequestForUI(u,"Offline Request"),x=async()=>{if(!r){l("Wallet is locked. Please unlock it first.");return}try{const p=new NDKPrivateKeySigner(r),g=new NDKEvent(void 0,e);await g.sign(p);const y=JSON.stringify(g.rawEvent());o(y)}catch(p){console.error("Signing failed:",p),l("Failed to sign event: "+p.message)}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl max-w-lg w-full border border-slate-800 shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-800 flex justify-between items-center bg-slate-900/50 backdrop-blur-md",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(ShieldCheck,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h2",{className:"font-bold text-white",children:"Offline Signer"})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-full transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:n?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center animate-in fade-in zoom-in duration-300",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-bold text-green-400 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Check,{className:"w-5 h-5"}),"Signed Successfully"]}),jsxRuntimeExports.jsx("div",{className:"w-full mb-6",children:jsxRuntimeExports.jsx(AnimatedQRCode,{data:n})}),jsxRuntimeExports.jsx("p",{className:"text-center text-slate-500 text-sm mb-6",children:"Scan this animated QR code with your watch-only app to broadcast the event."}),jsxRuntimeExports.jsx("button",{onClick:t,className:"w-full py-3 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors",children:"Done"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"mb-6 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-xl font-bold text-white mb-2",children:f.title}),jsxRuntimeExports.jsx("div",{className:"text-slate-400 text-sm",children:f.description})]}),jsxRuntimeExports.jsx("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800 mb-6 font-mono text-xs text-slate-300 overflow-x-auto",children:jsxRuntimeExports.jsx("pre",{children:JSON.stringify(e,null,2)})}),a&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-3 bg-red-500/10 border border-red-500/20 rounded-lg flex items-center gap-2 text-red-400 text-sm",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4"}),a]}),jsxRuntimeExports.jsxs("button",{onClick:x,className:"w-full py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-all shadow-lg shadow-amber-500/20 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Check,{className:"w-5 h-5"}),"Sign & Display QR"]})]})})]})})},hexToBytes=e=>{const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++)t[r]=parseInt(e.substr(r*2,2),16);return t};class ClientService{ndk;signer;privateKey;sub;connectionId;signerPubkey;secret;startedVia;constructor(t,r,n){if(t.startsWith("nsec"))try{console.log("[ClientService] Detected nsec, converting to hex...");const{data:o}=nip19_exports$1.decode(t);this.privateKey=Buffer.from(o).toString("hex"),console.log("[ClientService] Converted nsec to hex successfully")}catch(o){console.error("[ClientService] Failed to decode nsec key:",o),this.privateKey=t}else this.privateKey=t;this.connectionId=r,this.signerPubkey=n.signerPubkey,this.secret=n.secret,this.startedVia=n.startedVia,this.signer=new NDKPrivateKeySigner(this.privateKey),this.ndk=new NDK({explicitRelayUrls:n.relays}),this.ndk.signer=this.signer}static parseNostrConnectURI(t){try{const r=new URL(t),n=r.hostname||r.pathname.replace("//",""),o=r.searchParams.getAll("relay").map(decodeURIComponent),a=r.searchParams.get("secret")||void 0,l=r.searchParams.get("name")||void 0,u=r.searchParams.get("url")?decodeURIComponent(r.searchParams.get("url")):void 0;if(!n||o.length===0)throw new Error("Invalid nostrconnect URI: missing pubkey or relays");return{signerPubkey:n,relays:o,secret:a,name:l,appUrl:u}}catch(r){throw new Error(`Failed to parse nostrconnect URI: ${r}`)}}async connect(){console.log("[ClientService] Connecting as signer for app..."),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connecting");try{try{await Promise.race([this.ndk.connect(),new Promise((n,o)=>setTimeout(()=>o(new Error("Connection timeout")),1e4))])}catch(n){console.warn("[ClientService] Main connect failed, checking for partial connection...",n);let o=0;if(this.ndk.pool.relays.forEach(a=>{(a.status===1||a.status===5)&&o++}),o===0)throw n;console.log(`[ClientService] Proceeding with partial connection (${o} relays).`)}const t=await this.signer.user();console.log("[ClientService] Connected! Our pubkey:",t.pubkey),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connected");const r={kinds:[24133],"#p":[t.pubkey],since:Math.floor(Date.now()/1e3)};if(console.log("[ClientService] Subscription filter:",JSON.stringify(r)),this.sub=this.ndk.subscribe(r,{closeOnEose:!1}),console.log("[ClientService] Listening for requests from:",this.signerPubkey),console.log("[ClientService] Our pubkey (receiving events tagged with):",t.pubkey),this.secret&&this.startedVia==="nostrconnect"){console.log("[ClientService] Sending proactive connect RESPONSE with secret:",this.secret),console.log("[ClientService] User agent:",navigator.userAgent),console.log("[ClientService] Is mobile:",/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));try{const n=JSON.stringify({id:"connect_"+Math.random().toString(36).substring(7),result:this.secret,error:null}),o=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),this.signerPubkey),a=nip44_exports.v2.encrypt(n,o),l=new NDKEvent(this.ndk);l.kind=24133,l.tags=[["p",this.signerPubkey]],l.content=a,await l.sign(this.signer);const u=await l.publish();console.log("[ClientService]  Proactive connect RESPONSE sent to:",Array.from(u).map(f=>f.url))}catch(n){console.error("[ClientService] Failed to send proactive connect RESPONSE:",n)}}this.sub.on("event",async n=>{console.log("[ClientService]  EVENT RECEIVED!"),console.log("[ClientService] Event from:",n.pubkey),console.log("[ClientService] Event kind:",n.kind),console.log("[ClientService] Event tags:",n.tags),console.log("[ClientService] Event content (encrypted):",n.content.substring(0,50)+"..."),console.log("[ClientService] Event created_at:",n.created_at,"Current time:",Math.floor(Date.now()/1e3));const o=n.created_at||0,a=Math.floor(Date.now()/1e3);if(a-o>60){console.log(`[ClientService]  Ignoring stale event from ${a-o}s ago`);return}const l=n.pubkey===this.signerPubkey;l||console.warn(`[ClientService] Event from unknown pubkey: ${n.pubkey} (expected ${this.signerPubkey}). Attempting to decrypt and verify...`);try{let u,f="nip44";try{const b=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n.pubkey);u=nip44_exports.v2.decrypt(n.content,b),console.log("[ClientService]  Decrypted with NIP-44")}catch{u=await nip04_exports.decrypt(this.privateKey,n.pubkey,n.content),f="nip04",console.log("[ClientService]  Decrypted with NIP-04")}const x=JSON.parse(u),{id:p,method:g,params:y}=x;if(!l)if(console.log(`[ClientService]  Request from different pubkey: method=${g}, params=${JSON.stringify(y?.slice(0,1))}`),g==="connect"&&y[0]===this.secret){console.log("[ClientService]  Key rotation detected! Updating signer pubkey to:",n.pubkey),this.signerPubkey=n.pubkey;const{updateConnection:b}=useConnectionsStore.getState();b(this.connectionId,{signerPubkey:n.pubkey})}else console.warn(`[ClientService]  Accepting request from alternate pubkey (method: ${g})`);if(console.log(`[ClientService]  Processing request: method=${g}, id=${p}, from=${l?"expected key":"alternate key"}`),g==="connect"||g==="get_public_key"||g==="ping"){console.log(`[ClientService] Auto-approving ${g} request`),await this.approveRequest(p,n.id,n.pubkey,g,y||[],f);return}if(g==="sign_event")try{const b=y[0],v=JSON.parse(b).kind;console.log("[ClientService] Checking auto-approval for kind:",v),console.log("[ClientService] Connection ID:",this.connectionId);const B=useConnectionsStore.getState(),j=B.connections.find(F=>F.id===this.connectionId);if(console.log("[ClientService] Found connection:",j?{id:j.id,name:j.name}:"NOT FOUND"),j){const F=B.getRulesForConnection(j.id);console.log("[ClientService] Rules for this connection:",F);const C=F.find(N=>N.kinds.includes(v));if(console.log("[ClientService] Matching rule:",C),C){console.log(`[ClientService]  Auto-approving kind ${v} for ${j.name||"app"}`),await this.approveRequest(p,n.id,n.pubkey,g,y,f);return}else console.log("[ClientService]  No matching rule found, showing modal")}else console.log("[ClientService]  Connection not found in store")}catch(b){console.error("[ClientService] Error checking auto-approval:",b)}if(g==="nip04_decrypt"||g==="nip04_encrypt")try{const b=g==="nip04_decrypt"?-4:-5;console.log(`[ClientService] Checking auto-approval for ${g} (kind: ${b})`),console.log("[ClientService] Connection ID:",this.connectionId);const w=useConnectionsStore.getState(),v=w.connections.find(B=>B.id===this.connectionId);if(console.log("[ClientService] Found connection:",v?{id:v.id,name:v.name}:"NOT FOUND"),v){const B=w.getRulesForConnection(v.id);console.log("[ClientService] Rules for this connection:",B);const j=B.find(F=>F.kinds.includes(b));if(console.log("[ClientService] Matching rule:",j),j){console.log(`[ClientService]  Auto-approving ${g} for ${v.name||"app"}`),await this.approveRequest(p,n.id,n.pubkey,g,y,f);return}else console.log(`[ClientService]  No matching rule found for ${g}, showing modal`)}else console.log("[ClientService]  Connection not found in store")}catch(b){console.error("[ClientService] Error checking auto-approval:",b)}useRequestStore.getState().addRequest({id:p,requestEventId:n.id,requestorPubkey:n.pubkey,method:g,params:y,timestamp:n.created_at||Date.now()/1e3,source:"client",connectionId:this.connectionId,encryptionMethod:f}),console.log("[ClientService] Added request to queue:",g)}catch(u){console.error("[ClientService] Failed to process:",u)}}),console.log("[ClientService]  Subscription created and event handler attached"),console.log("[ClientService] Connected and listening for requests"),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"connected")}catch(t){throw console.error("[ClientService] Connection failed:",t),useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"error"),t}}async approveRequest(t,r,n,o,a,l="nip04"){if(console.log(`[ClientService]  approveRequest called for ${o} (id: ${t}) using ${l}`),!useConnectionsStore.getState().connections.find(f=>f.id===this.connectionId)){console.error(`[ClientService]  Connection ${this.connectionId} no longer exists! Aborting response to prevent orphaned reply.`);return}try{if(o==="connect"){const w=this.secret||a[0];console.log(`[ClientService]  Sending connect RESPONSE. Stored secret: ${this.secret?"YES":"NO"}, Param secret: ${a[0]?"YES":"NO"}, Using: ${w||"ack"}`);const v=JSON.stringify({id:t,result:w||"ack",error:null});console.log("[ClientService] Connect Response content:",v);let B;if(l==="nip04")B=await nip04_exports.encrypt(this.privateKey,n,v);else{const C=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n);B=nip44_exports.v2.encrypt(v,C)}const j=new NDKEvent(this.ndk);j.kind=24133,j.tags=[["p",n]],j.content=B,console.log("[ClientService] Sending connect response event to:",n),await j.sign(this.signer),console.log("[ClientService]  PUBLISHING PROACTIVE CONNECT:",{to:this.signerPubkey.slice(0,8),secret:this.secret});const F=await j.publish();console.log("[ClientService]  Sent connect response to relays:",Array.from(F).map(C=>C.url)),useRequestStore.getState().removeRequest(t);return}let f;if(o==="get_public_key")f=(await this.signer.user()).pubkey;else if(o==="sign_event"){console.log("[ClientService] Signing event:",a[0]);const w=typeof a[0]=="string"?JSON.parse(a[0]):a[0],v=new NDKEvent(this.ndk,w);await v.sign(this.signer),f=JSON.stringify(v.rawEvent()),console.log("[ClientService] Event signed successfully")}else if(o==="nip04_decrypt"){const w=a[0],v=a[1];f=await nip04_exports.decrypt(this.privateKey,w,v)}else if(o==="nip04_encrypt"){const w=a[0],v=a[1];f=await nip04_exports.encrypt(this.privateKey,w,v)}else throw new Error(`Unknown method: ${o}`);const x=JSON.stringify({id:t,result:f,error:null});console.log("[ClientService] Response content:",x);let p;if(l==="nip04")p=await nip04_exports.encrypt(this.privateKey,n,x);else{const w=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n);p=nip44_exports.v2.encrypt(x,w)}const g=new NDKEvent(this.ndk);g.kind=24133,g.tags=r?[["p",n],["e",r]]:[["p",n]],g.content=p,console.log("[ClientService] Sending response event:",{kind:g.kind,tags:g.tags,to:n}),console.log("[ClientService]  Response triggered from:",new Error().stack?.split(`
`)[2]?.trim()),await g.sign(this.signer),console.log("[ClientService]  PUBLISHING APPROVAL RESPONSE:",{requestId:t,method:o,to:n.slice(0,8),hasError:x.includes('"error":null')?"NO":"YES",contentPreview:x.slice(0,100)});const y=await g.publish();console.log("[ClientService] Published response to relays:",Array.from(y).map(w=>w.url)),console.log("[ClientService]  Sent approval for:",o);const b=useConnectionsStore.getState().connections.find(w=>w.id===this.connectionId);useActivityLogStore.getState().addEntry({action:"approved",method:o,appName:b?.name,appPubkey:n,event:o==="sign_event"&&a[0]?typeof a[0]=="string"?JSON.parse(a[0]):a[0]:void 0}),useRequestStore.getState().removeRequest(t)}catch(f){console.error("[ClientService] Error approving:",f);try{const x=JSON.stringify({id:t,result:null,error:f.message||"Unknown error"});let p;if(l==="nip04")p=await nip04_exports.encrypt(this.privateKey,n,x);else{const y=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n);p=nip44_exports.v2.encrypt(x,y)}const g=new NDKEvent(this.ndk);g.kind=24133,g.tags=[["p",n]],g.content=p,await g.sign(this.signer),await g.publish(),console.log("[ClientService] Error response published")}catch(x){console.error("[ClientService] Failed to send error response:",x)}}}async rejectRequest(t,r,n,o="User rejected"){console.log(`[ClientService]  rejectRequest called for (id: ${t})`);const a=JSON.stringify({id:t,result:null,error:o}),l=nip44_exports.v2.utils.getConversationKey(hexToBytes(this.privateKey),n),u=nip44_exports.v2.encrypt(a,l),f=new NDKEvent(this.ndk);f.kind=24133,f.tags=r?[["p",n],["e",r]]:[["p",n]],f.content=u,await f.sign(this.signer),console.log(`[ClientService]  ABOUT TO SEND REJECTION for ${t}:`,{error:o,to:n.slice(0,8),stackTrace:new Error().stack?.split(`
`).slice(1,4).join(`
`)}),await f.publish(),console.log("[ClientService] Sent rejection");const x=useConnectionsStore.getState().connections.find(p=>p.id===this.connectionId);useActivityLogStore.getState().addEntry({action:"rejected",method:"unknown",appName:x?.name,appPubkey:n,error:o}),useRequestStore.getState().removeRequest(t)}disconnect(){this.sub&&this.sub.stop();try{this.ndk.pool&&this.ndk.pool.close()}catch(t){console.warn("[ClientService] Failed to close NDK pool:",t)}useConnectionsStore.getState().updateConnectionStatus(this.connectionId,"disconnected"),console.log("[ClientService] Disconnected")}}var jsQR$2={exports:{}},jsQR$1=jsQR$2.exports,hasRequiredJsQR;function requireJsQR(){return hasRequiredJsQR||(hasRequiredJsQR=1,(function(e,t){(function(n,o){e.exports=o()})(typeof self<"u"?self:jsQR$1,function(){return(function(r){var n={};function o(a){if(n[a])return n[a].exports;var l=n[a]={i:a,l:!1,exports:{}};return r[a].call(l.exports,l,l.exports,o),l.l=!0,l.exports}return o.m=r,o.c=n,o.d=function(a,l,u){o.o(a,l)||Object.defineProperty(a,l,{configurable:!1,enumerable:!0,get:u})},o.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(l,"a",l),l},o.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},o.p="",o(o.s=3)})([(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function l(u,f){this.width=f,this.height=u.length/f,this.data=u}return l.createEmpty=function(u,f){return new l(new Uint8ClampedArray(u*f),u)},l.prototype.get=function(u,f){return u<0||u>=this.width||f<0||f>=this.height?!1:!!this.data[f*this.width+u]},l.prototype.set=function(u,f,x){this.data[f*this.width+u]=x?1:0},l.prototype.setRegion=function(u,f,x,p,g){for(var y=f;y<f+p;y++)for(var b=u;b<u+x;b++)this.set(b,y,!!g)},l})();n.BitMatrix=a}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=o(2);function l(f,x){return f^x}n.addOrSubtractGF=l;var u=(function(){function f(x,p,g){this.primitive=x,this.size=p,this.generatorBase=g,this.expTable=new Array(this.size),this.logTable=new Array(this.size);for(var y=1,b=0;b<this.size;b++)this.expTable[b]=y,y=y*2,y>=this.size&&(y=(y^this.primitive)&this.size-1);for(var b=0;b<this.size-1;b++)this.logTable[this.expTable[b]]=b;this.zero=new a.default(this,Uint8ClampedArray.from([0])),this.one=new a.default(this,Uint8ClampedArray.from([1]))}return f.prototype.multiply=function(x,p){return x===0||p===0?0:this.expTable[(this.logTable[x]+this.logTable[p])%(this.size-1)]},f.prototype.inverse=function(x){if(x===0)throw new Error("Can't invert 0");return this.expTable[this.size-this.logTable[x]-1]},f.prototype.buildMonomial=function(x,p){if(x<0)throw new Error("Invalid monomial degree less than 0");if(p===0)return this.zero;var g=new Uint8ClampedArray(x+1);return g[0]=p,new a.default(this,g)},f.prototype.log=function(x){if(x===0)throw new Error("Can't take log(0)");return this.logTable[x]},f.prototype.exp=function(x){return this.expTable[x]},f})();n.default=u}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=o(1),l=(function(){function u(f,x){if(x.length===0)throw new Error("No coefficients.");this.field=f;var p=x.length;if(p>1&&x[0]===0){for(var g=1;g<p&&x[g]===0;)g++;if(g===p)this.coefficients=f.zero.coefficients;else{this.coefficients=new Uint8ClampedArray(p-g);for(var y=0;y<this.coefficients.length;y++)this.coefficients[y]=x[g+y]}}else this.coefficients=x}return u.prototype.degree=function(){return this.coefficients.length-1},u.prototype.isZero=function(){return this.coefficients[0]===0},u.prototype.getCoefficient=function(f){return this.coefficients[this.coefficients.length-1-f]},u.prototype.addOrSubtract=function(f){var x;if(this.isZero())return f;if(f.isZero())return this;var p=this.coefficients,g=f.coefficients;p.length>g.length&&(x=[g,p],p=x[0],g=x[1]);for(var y=new Uint8ClampedArray(g.length),b=g.length-p.length,w=0;w<b;w++)y[w]=g[w];for(var w=b;w<g.length;w++)y[w]=a.addOrSubtractGF(p[w-b],g[w]);return new u(this.field,y)},u.prototype.multiply=function(f){if(f===0)return this.field.zero;if(f===1)return this;for(var x=this.coefficients.length,p=new Uint8ClampedArray(x),g=0;g<x;g++)p[g]=this.field.multiply(this.coefficients[g],f);return new u(this.field,p)},u.prototype.multiplyPoly=function(f){if(this.isZero()||f.isZero())return this.field.zero;for(var x=this.coefficients,p=x.length,g=f.coefficients,y=g.length,b=new Uint8ClampedArray(p+y-1),w=0;w<p;w++)for(var v=x[w],B=0;B<y;B++)b[w+B]=a.addOrSubtractGF(b[w+B],this.field.multiply(v,g[B]));return new u(this.field,b)},u.prototype.multiplyByMonomial=function(f,x){if(f<0)throw new Error("Invalid degree less than 0");if(x===0)return this.field.zero;for(var p=this.coefficients.length,g=new Uint8ClampedArray(p+f),y=0;y<p;y++)g[y]=this.field.multiply(this.coefficients[y],x);return new u(this.field,g)},u.prototype.evaluateAt=function(f){var x=0;if(f===0)return this.getCoefficient(0);var p=this.coefficients.length;if(f===1)return this.coefficients.forEach(function(y){x=a.addOrSubtractGF(x,y)}),x;x=this.coefficients[0];for(var g=1;g<p;g++)x=a.addOrSubtractGF(this.field.multiply(f,x),this.coefficients[g]);return x},u})();n.default=l}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=o(4),l=o(5),u=o(11),f=o(12);function x(y){var b=f.locate(y);if(!b)return null;for(var w=0,v=b;w<v.length;w++){var B=v[w],j=u.extract(y,B),F=l.decode(j.matrix);if(F)return{binaryData:F.bytes,data:F.text,chunks:F.chunks,version:F.version,location:{topRightCorner:j.mappingFunction(B.dimension,0),topLeftCorner:j.mappingFunction(0,0),bottomRightCorner:j.mappingFunction(B.dimension,B.dimension),bottomLeftCorner:j.mappingFunction(0,B.dimension),topRightFinderPattern:B.topRight,topLeftFinderPattern:B.topLeft,bottomLeftFinderPattern:B.bottomLeft,bottomRightAlignmentPattern:B.alignmentPattern}}}return null}var p={inversionAttempts:"attemptBoth"};function g(y,b,w,v){v===void 0&&(v={});var B=p;Object.keys(B||{}).forEach(function(S){B[S]=v[S]||B[S]});var j=B.inversionAttempts==="attemptBoth"||B.inversionAttempts==="invertFirst",F=B.inversionAttempts==="onlyInvert"||B.inversionAttempts==="invertFirst",C=a.binarize(y,b,w,j),N=C.binarized,T=C.inverted,_=x(F?T:N);return!_&&(B.inversionAttempts==="attemptBoth"||B.inversionAttempts==="invertFirst")&&(_=x(F?N:T)),_}g.default=g,n.default=g}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=o(0),l=8,u=24;function f(g,y,b){return g<y?y:g>b?b:g}var x=(function(){function g(y,b){this.width=y,this.data=new Uint8ClampedArray(y*b)}return g.prototype.get=function(y,b){return this.data[b*this.width+y]},g.prototype.set=function(y,b,w){this.data[b*this.width+y]=w},g})();function p(g,y,b,w){if(g.length!==y*b*4)throw new Error("Malformed data passed to binarizer.");for(var v=new x(y,b),B=0;B<y;B++)for(var j=0;j<b;j++){var F=g[(j*y+B)*4+0],C=g[(j*y+B)*4+1],N=g[(j*y+B)*4+2];v.set(B,j,.2126*F+.7152*C+.0722*N)}for(var T=Math.ceil(y/l),_=Math.ceil(b/l),S=new x(T,_),O=0;O<_;O++)for(var $=0;$<T;$++){for(var z=0,W=1/0,U=0,j=0;j<l;j++)for(var B=0;B<l;B++){var I=v.get($*l+B,O*l+j);z+=I,W=Math.min(W,I),U=Math.max(U,I)}var G=z/Math.pow(l,2);if(U-W<=u&&(G=W/2,O>0&&$>0)){var k=(S.get($,O-1)+2*S.get($-1,O)+S.get($-1,O-1))/4;W<k&&(G=k)}S.set($,O,G)}var M=a.BitMatrix.createEmpty(y,b),q=null;w&&(q=a.BitMatrix.createEmpty(y,b));for(var O=0;O<_;O++)for(var $=0;$<T;$++){for(var K=f($,2,T-3),H=f(O,2,_-3),z=0,Q=-2;Q<=2;Q++)for(var D=-2;D<=2;D++)z+=S.get(K+Q,H+D);for(var Y=z/25,Q=0;Q<l;Q++)for(var D=0;D<l;D++){var B=$*l+Q,j=O*l+D,J=v.get(B,j);M.set(B,j,J<=Y),w&&q.set(B,j,!(J<=Y))}}return w?{binarized:M,inverted:q}:{binarized:M}}n.binarize=p}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=o(0),l=o(6),u=o(9),f=o(10);function x(N,T){for(var _=N^T,S=0;_;)S++,_&=_-1;return S}function p(N,T){return T<<1|N}var g=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,dataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,formatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,dataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],y=[function(N){return(N.y+N.x)%2===0},function(N){return N.y%2===0},function(N){return N.x%3===0},function(N){return(N.y+N.x)%3===0},function(N){return(Math.floor(N.y/2)+Math.floor(N.x/3))%2===0},function(N){return N.x*N.y%2+N.x*N.y%3===0},function(N){return(N.y*N.x%2+N.y*N.x%3)%2===0},function(N){return((N.y+N.x)%2+N.y*N.x%3)%2===0}];function b(N){var T=17+4*N.versionNumber,_=a.BitMatrix.createEmpty(T,T);_.setRegion(0,0,9,9,!0),_.setRegion(T-8,0,8,9,!0),_.setRegion(0,T-8,9,8,!0);for(var S=0,O=N.alignmentPatternCenters;S<O.length;S++)for(var $=O[S],z=0,W=N.alignmentPatternCenters;z<W.length;z++){var U=W[z];$===6&&U===6||$===6&&U===T-7||$===T-7&&U===6||_.setRegion($-2,U-2,5,5,!0)}return _.setRegion(6,9,1,T-17,!0),_.setRegion(9,6,T-17,1,!0),N.versionNumber>6&&(_.setRegion(T-11,0,3,6,!0),_.setRegion(0,T-11,6,3,!0)),_}function w(N,T,_){for(var S=y[_.dataMask],O=N.height,$=b(T),z=[],W=0,U=0,I=!0,G=O-1;G>0;G-=2){G===6&&G--;for(var k=0;k<O;k++)for(var M=I?O-1-k:k,q=0;q<2;q++){var K=G-q;if(!$.get(K,M)){U++;var H=N.get(K,M);S({y:M,x:K})&&(H=!H),W=p(H,W),U===8&&(z.push(W),U=0,W=0)}}I=!I}return z}function v(N){var T=N.height,_=Math.floor((T-17)/4);if(_<=6)return f.VERSIONS[_-1];for(var S=0,O=5;O>=0;O--)for(var $=T-9;$>=T-11;$--)S=p(N.get($,O),S);for(var z=0,$=5;$>=0;$--)for(var O=T-9;O>=T-11;O--)z=p(N.get($,O),z);for(var W=1/0,U,I=0,G=f.VERSIONS;I<G.length;I++){var k=G[I];if(k.infoBits===S||k.infoBits===z)return k;var M=x(S,k.infoBits);M<W&&(U=k,W=M),M=x(z,k.infoBits),M<W&&(U=k,W=M)}if(W<=3)return U}function B(N){for(var T=0,_=0;_<=8;_++)_!==6&&(T=p(N.get(_,8),T));for(var S=7;S>=0;S--)S!==6&&(T=p(N.get(8,S),T));for(var O=N.height,$=0,S=O-1;S>=O-7;S--)$=p(N.get(8,S),$);for(var _=O-8;_<O;_++)$=p(N.get(_,8),$);for(var z=1/0,W=null,U=0,I=g;U<I.length;U++){var G=I[U],k=G.bits,M=G.formatInfo;if(k===T||k===$)return M;var q=x(T,k);q<z&&(W=M,z=q),T!==$&&(q=x($,k),q<z&&(W=M,z=q))}return z<=3?W:null}function j(N,T,_){var S=T.errorCorrectionLevels[_],O=[],$=0;if(S.ecBlocks.forEach(function(H){for(var Q=0;Q<H.numBlocks;Q++)O.push({numDataCodewords:H.dataCodewordsPerBlock,codewords:[]}),$+=H.dataCodewordsPerBlock+S.ecCodewordsPerBlock}),N.length<$)return null;N=N.slice(0,$);for(var z=S.ecBlocks[0].dataCodewordsPerBlock,W=0;W<z;W++)for(var U=0,I=O;U<I.length;U++){var G=I[U];G.codewords.push(N.shift())}if(S.ecBlocks.length>1)for(var k=S.ecBlocks[0].numBlocks,M=S.ecBlocks[1].numBlocks,W=0;W<M;W++)O[k+W].codewords.push(N.shift());for(;N.length>0;)for(var q=0,K=O;q<K.length;q++){var G=K[q];G.codewords.push(N.shift())}return O}function F(N){var T=v(N);if(!T)return null;var _=B(N);if(!_)return null;var S=w(N,T,_),O=j(S,T,_.errorCorrectionLevel);if(!O)return null;for(var $=O.reduce(function(q,K){return q+K.numDataCodewords},0),z=new Uint8ClampedArray($),W=0,U=0,I=O;U<I.length;U++){var G=I[U],k=u.decode(G.codewords,G.codewords.length-G.numDataCodewords);if(!k)return null;for(var M=0;M<G.numDataCodewords;M++)z[W++]=k[M]}try{return l.decode(z,T.versionNumber)}catch{return null}}function C(N){if(N==null)return null;var T=F(N);if(T)return T;for(var _=0;_<N.width;_++)for(var S=_+1;S<N.height;S++)N.get(_,S)!==N.get(S,_)&&(N.set(_,S,!N.get(_,S)),N.set(S,_,!N.get(S,_)));return F(N)}n.decode=C}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=o(7),l=o(8),u;(function(v){v.Numeric="numeric",v.Alphanumeric="alphanumeric",v.Byte="byte",v.Kanji="kanji",v.ECI="eci"})(u=n.Mode||(n.Mode={}));var f;(function(v){v[v.Terminator=0]="Terminator",v[v.Numeric=1]="Numeric",v[v.Alphanumeric=2]="Alphanumeric",v[v.Byte=4]="Byte",v[v.Kanji=8]="Kanji",v[v.ECI=7]="ECI"})(f||(f={}));function x(v,B){for(var j=[],F="",C=[10,12,14][B],N=v.readBits(C);N>=3;){var T=v.readBits(10);if(T>=1e3)throw new Error("Invalid numeric value above 999");var _=Math.floor(T/100),S=Math.floor(T/10)%10,O=T%10;j.push(48+_,48+S,48+O),F+=_.toString()+S.toString()+O.toString(),N-=3}if(N===2){var T=v.readBits(7);if(T>=100)throw new Error("Invalid numeric value above 99");var _=Math.floor(T/10),S=T%10;j.push(48+_,48+S),F+=_.toString()+S.toString()}else if(N===1){var T=v.readBits(4);if(T>=10)throw new Error("Invalid numeric value above 9");j.push(48+T),F+=T.toString()}return{bytes:j,text:F}}var p=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function g(v,B){for(var j=[],F="",C=[9,11,13][B],N=v.readBits(C);N>=2;){var T=v.readBits(11),_=Math.floor(T/45),S=T%45;j.push(p[_].charCodeAt(0),p[S].charCodeAt(0)),F+=p[_]+p[S],N-=2}if(N===1){var _=v.readBits(6);j.push(p[_].charCodeAt(0)),F+=p[_]}return{bytes:j,text:F}}function y(v,B){for(var j=[],F="",C=[8,16,16][B],N=v.readBits(C),T=0;T<N;T++){var _=v.readBits(8);j.push(_)}try{F+=decodeURIComponent(j.map(function(S){return"%"+("0"+S.toString(16)).substr(-2)}).join(""))}catch{}return{bytes:j,text:F}}function b(v,B){for(var j=[],F="",C=[8,10,12][B],N=v.readBits(C),T=0;T<N;T++){var _=v.readBits(13),S=Math.floor(_/192)<<8|_%192;S<7936?S+=33088:S+=49472,j.push(S>>8,S&255),F+=String.fromCharCode(l.shiftJISTable[S])}return{bytes:j,text:F}}function w(v,B){for(var j,F,C,N,T=new a.BitStream(v),_=B<=9?0:B<=26?1:2,S={text:"",bytes:[],chunks:[],version:B};T.available()>=4;){var O=T.readBits(4);if(O===f.Terminator)return S;if(O===f.ECI)T.readBits(1)===0?S.chunks.push({type:u.ECI,assignmentNumber:T.readBits(7)}):T.readBits(1)===0?S.chunks.push({type:u.ECI,assignmentNumber:T.readBits(14)}):T.readBits(1)===0?S.chunks.push({type:u.ECI,assignmentNumber:T.readBits(21)}):S.chunks.push({type:u.ECI,assignmentNumber:-1});else if(O===f.Numeric){var $=x(T,_);S.text+=$.text,(j=S.bytes).push.apply(j,$.bytes),S.chunks.push({type:u.Numeric,text:$.text})}else if(O===f.Alphanumeric){var z=g(T,_);S.text+=z.text,(F=S.bytes).push.apply(F,z.bytes),S.chunks.push({type:u.Alphanumeric,text:z.text})}else if(O===f.Byte){var W=y(T,_);S.text+=W.text,(C=S.bytes).push.apply(C,W.bytes),S.chunks.push({type:u.Byte,bytes:W.bytes,text:W.text})}else if(O===f.Kanji){var U=b(T,_);S.text+=U.text,(N=S.bytes).push.apply(N,U.bytes),S.chunks.push({type:u.Kanji,bytes:U.bytes,text:U.text})}}if(T.available()===0||T.readBits(T.available())===0)return S}n.decode=w}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function l(u){this.byteOffset=0,this.bitOffset=0,this.bytes=u}return l.prototype.readBits=function(u){if(u<1||u>32||u>this.available())throw new Error("Cannot read "+u.toString()+" bits");var f=0;if(this.bitOffset>0){var x=8-this.bitOffset,p=u<x?u:x,g=x-p,y=255>>8-p<<g;f=(this.bytes[this.byteOffset]&y)>>g,u-=p,this.bitOffset+=p,this.bitOffset===8&&(this.bitOffset=0,this.byteOffset++)}if(u>0){for(;u>=8;)f=f<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,u-=8;if(u>0){var g=8-u,y=255>>g<<g;f=f<<u|(this.bytes[this.byteOffset]&y)>>g,this.bitOffset+=u}}return f},l.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},l})();n.BitStream=a}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.shiftJISTable={32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:165,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:8254,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:92,33120:12316,33121:8214,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:8722,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:162,33170:163,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:172,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081}}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=o(1),l=o(2);function u(g,y,b,w){var v;y.degree()<b.degree()&&(v=[b,y],y=v[0],b=v[1]);for(var B=y,j=b,F=g.zero,C=g.one;j.degree()>=w/2;){var N=B,T=F;if(B=j,F=C,B.isZero())return null;j=N;for(var _=g.zero,S=B.getCoefficient(B.degree()),O=g.inverse(S);j.degree()>=B.degree()&&!j.isZero();){var $=j.degree()-B.degree(),z=g.multiply(j.getCoefficient(j.degree()),O);_=_.addOrSubtract(g.buildMonomial($,z)),j=j.addOrSubtract(B.multiplyByMonomial($,z))}if(C=_.multiplyPoly(F).addOrSubtract(T),j.degree()>=B.degree())return null}var W=C.getCoefficient(0);if(W===0)return null;var U=g.inverse(W);return[C.multiply(U),j.multiply(U)]}function f(g,y){var b=y.degree();if(b===1)return[y.getCoefficient(1)];for(var w=new Array(b),v=0,B=1;B<g.size&&v<b;B++)y.evaluateAt(B)===0&&(w[v]=g.inverse(B),v++);return v!==b?null:w}function x(g,y,b){for(var w=b.length,v=new Array(w),B=0;B<w;B++){for(var j=g.inverse(b[B]),F=1,C=0;C<w;C++)B!==C&&(F=g.multiply(F,a.addOrSubtractGF(1,g.multiply(b[C],j))));v[B]=g.multiply(y.evaluateAt(j),g.inverse(F)),g.generatorBase!==0&&(v[B]=g.multiply(v[B],j))}return v}function p(g,y){var b=new Uint8ClampedArray(g.length);b.set(g);for(var w=new a.default(285,256,0),v=new l.default(w,b),B=new Uint8ClampedArray(y),j=!1,F=0;F<y;F++){var C=v.evaluateAt(w.exp(F+w.generatorBase));B[B.length-1-F]=C,C!==0&&(j=!0)}if(!j)return b;var N=new l.default(w,B),T=u(w,w.buildMonomial(y,1),N,y);if(T===null)return null;var _=f(w,T[0]);if(_==null)return null;for(var S=x(w,T[1],_),O=0;O<_.length;O++){var $=b.length-1-w.log(_[O]);if($<0)return null;b[$]=a.addOrSubtractGF(b[$],S[O])}return b}n.decode=p}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0}),n.VERSIONS=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,versionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,dataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,versionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},{numBlocks:61,dataCodewordsPerBlock:16}]}]}]}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=o(0);function l(p,g,y,b){var w=p.x-g.x+y.x-b.x,v=p.y-g.y+y.y-b.y;if(w===0&&v===0)return{a11:g.x-p.x,a12:g.y-p.y,a13:0,a21:y.x-g.x,a22:y.y-g.y,a23:0,a31:p.x,a32:p.y,a33:1};var B=g.x-y.x,j=b.x-y.x,F=g.y-y.y,C=b.y-y.y,N=B*C-j*F,T=(w*C-j*v)/N,_=(B*v-w*F)/N;return{a11:g.x-p.x+T*g.x,a12:g.y-p.y+T*g.y,a13:T,a21:b.x-p.x+_*b.x,a22:b.y-p.y+_*b.y,a23:_,a31:p.x,a32:p.y,a33:1}}function u(p,g,y,b){var w=l(p,g,y,b);return{a11:w.a22*w.a33-w.a23*w.a32,a12:w.a13*w.a32-w.a12*w.a33,a13:w.a12*w.a23-w.a13*w.a22,a21:w.a23*w.a31-w.a21*w.a33,a22:w.a11*w.a33-w.a13*w.a31,a23:w.a13*w.a21-w.a11*w.a23,a31:w.a21*w.a32-w.a22*w.a31,a32:w.a12*w.a31-w.a11*w.a32,a33:w.a11*w.a22-w.a12*w.a21}}function f(p,g){return{a11:p.a11*g.a11+p.a21*g.a12+p.a31*g.a13,a12:p.a12*g.a11+p.a22*g.a12+p.a32*g.a13,a13:p.a13*g.a11+p.a23*g.a12+p.a33*g.a13,a21:p.a11*g.a21+p.a21*g.a22+p.a31*g.a23,a22:p.a12*g.a21+p.a22*g.a22+p.a32*g.a23,a23:p.a13*g.a21+p.a23*g.a22+p.a33*g.a23,a31:p.a11*g.a31+p.a21*g.a32+p.a31*g.a33,a32:p.a12*g.a31+p.a22*g.a32+p.a32*g.a33,a33:p.a13*g.a31+p.a23*g.a32+p.a33*g.a33}}function x(p,g){for(var y=u({x:3.5,y:3.5},{x:g.dimension-3.5,y:3.5},{x:g.dimension-6.5,y:g.dimension-6.5},{x:3.5,y:g.dimension-3.5}),b=l(g.topLeft,g.topRight,g.alignmentPattern,g.bottomLeft),w=f(b,y),v=a.BitMatrix.createEmpty(g.dimension,g.dimension),B=function(_,S){var O=w.a13*_+w.a23*S+w.a33;return{x:(w.a11*_+w.a21*S+w.a31)/O,y:(w.a12*_+w.a22*S+w.a32)/O}},j=0;j<g.dimension;j++)for(var F=0;F<g.dimension;F++){var C=F+.5,N=j+.5,T=B(C,N);v.set(F,j,p.get(Math.floor(T.x),Math.floor(T.y)))}return{matrix:v,mappingFunction:B}}n.extract=x}),(function(r,n,o){Object.defineProperty(n,"__esModule",{value:!0});var a=4,l=.5,u=1.5,f=function(C,N){return Math.sqrt(Math.pow(N.x-C.x,2)+Math.pow(N.y-C.y,2))};function x(C){return C.reduce(function(N,T){return N+T})}function p(C,N,T){var _,S,O,$,z=f(C,N),W=f(N,T),U=f(C,T),I,G,k;return W>=z&&W>=U?(_=[N,C,T],I=_[0],G=_[1],k=_[2]):U>=W&&U>=z?(S=[C,N,T],I=S[0],G=S[1],k=S[2]):(O=[C,T,N],I=O[0],G=O[1],k=O[2]),(k.x-G.x)*(I.y-G.y)-(k.y-G.y)*(I.x-G.x)<0&&($=[k,I],I=$[0],k=$[1]),{bottomLeft:I,topLeft:G,topRight:k}}function g(C,N,T,_){var S=(x(b(C,T,_,5))/7+x(b(C,N,_,5))/7+x(b(T,C,_,5))/7+x(b(N,C,_,5))/7)/4;if(S<1)throw new Error("Invalid module size");var O=Math.round(f(C,N)/S),$=Math.round(f(C,T)/S),z=Math.floor((O+$)/2)+7;switch(z%4){case 0:z++;break;case 2:z--;break}return{dimension:z,moduleSize:S}}function y(C,N,T,_){var S=[{x:Math.floor(C.x),y:Math.floor(C.y)}],O=Math.abs(N.y-C.y)>Math.abs(N.x-C.x),$,z,W,U;O?($=Math.floor(C.y),z=Math.floor(C.x),W=Math.floor(N.y),U=Math.floor(N.x)):($=Math.floor(C.x),z=Math.floor(C.y),W=Math.floor(N.x),U=Math.floor(N.y));for(var I=Math.abs(W-$),G=Math.abs(U-z),k=Math.floor(-I/2),M=$<W?1:-1,q=z<U?1:-1,K=!0,H=$,Q=z;H!==W+M;H+=M){var D=O?Q:H,Y=O?H:Q;if(T.get(D,Y)!==K&&(K=!K,S.push({x:D,y:Y}),S.length===_+1))break;if(k+=G,k>0){if(Q===U)break;Q+=q,k-=I}}for(var J=[],L=0;L<_;L++)S[L]&&S[L+1]?J.push(f(S[L],S[L+1])):J.push(0);return J}function b(C,N,T,_){var S,O=N.y-C.y,$=N.x-C.x,z=y(C,N,T,Math.ceil(_/2)),W=y(C,{x:C.x-$,y:C.y-O},T,Math.ceil(_/2)),U=z.shift()+W.shift()-1;return(S=W.concat(U)).concat.apply(S,z)}function w(C,N){var T=x(C)/x(N),_=0;return N.forEach(function(S,O){_+=Math.pow(C[O]-S*T,2)}),{averageSize:T,error:_}}function v(C,N,T){try{var _=b(C,{x:-1,y:C.y},T,N.length),S=b(C,{x:C.x,y:-1},T,N.length),O={x:Math.max(0,C.x-C.y)-1,y:Math.max(0,C.y-C.x)-1},$=b(C,O,T,N.length),z={x:Math.min(T.width,C.x+C.y)+1,y:Math.min(T.height,C.y+C.x)+1},W=b(C,z,T,N.length),U=w(_,N),I=w(S,N),G=w($,N),k=w(W,N),M=Math.sqrt(U.error*U.error+I.error*I.error+G.error*G.error+k.error*k.error),q=(U.averageSize+I.averageSize+G.averageSize+k.averageSize)/4,K=(Math.pow(U.averageSize-q,2)+Math.pow(I.averageSize-q,2)+Math.pow(G.averageSize-q,2)+Math.pow(k.averageSize-q,2))/q;return M+K}catch{return 1/0}}function B(C,N){for(var T=Math.round(N.x);C.get(T,Math.round(N.y));)T--;for(var _=Math.round(N.x);C.get(_,Math.round(N.y));)_++;for(var S=(T+_)/2,O=Math.round(N.y);C.get(Math.round(S),O);)O--;for(var $=Math.round(N.y);C.get(Math.round(S),$);)$++;var z=(O+$)/2;return{x:S,y:z}}function j(C){for(var N=[],T=[],_=[],S=[],O=function(D){for(var Y=0,J=!1,L=[0,0,0,0,0],Z=function(ce){var de=C.get(ce,D);if(de===J)Y++;else{L=[L[1],L[2],L[3],L[4],Y],Y=1,J=de;var xe=x(L)/7,te=Math.abs(L[0]-xe)<xe&&Math.abs(L[1]-xe)<xe&&Math.abs(L[2]-3*xe)<3*xe&&Math.abs(L[3]-xe)<xe&&Math.abs(L[4]-xe)<xe&&!de,ae=x(L.slice(-3))/3,le=Math.abs(L[2]-ae)<ae&&Math.abs(L[3]-ae)<ae&&Math.abs(L[4]-ae)<ae&&de;if(te){var ue=ce-L[3]-L[4],be=ue-L[2],Be={startX:be,endX:ue,y:D},Ce=T.filter(function(we){return be>=we.bottom.startX&&be<=we.bottom.endX||ue>=we.bottom.startX&&be<=we.bottom.endX||be<=we.bottom.startX&&ue>=we.bottom.endX&&L[2]/(we.bottom.endX-we.bottom.startX)<u&&L[2]/(we.bottom.endX-we.bottom.startX)>l});Ce.length>0?Ce[0].bottom=Be:T.push({top:Be,bottom:Be})}if(le){var Se=ce-L[4],ke=Se-L[3],Be={startX:ke,y:D,endX:Se},Ce=S.filter(function(Pe){return ke>=Pe.bottom.startX&&ke<=Pe.bottom.endX||Se>=Pe.bottom.startX&&ke<=Pe.bottom.endX||ke<=Pe.bottom.startX&&Se>=Pe.bottom.endX&&L[2]/(Pe.bottom.endX-Pe.bottom.startX)<u&&L[2]/(Pe.bottom.endX-Pe.bottom.startX)>l});Ce.length>0?Ce[0].bottom=Be:S.push({top:Be,bottom:Be})}}},oe=-1;oe<=C.width;oe++)Z(oe);N.push.apply(N,T.filter(function(ce){return ce.bottom.y!==D&&ce.bottom.y-ce.top.y>=2})),T=T.filter(function(ce){return ce.bottom.y===D}),_.push.apply(_,S.filter(function(ce){return ce.bottom.y!==D})),S=S.filter(function(ce){return ce.bottom.y===D})},$=0;$<=C.height;$++)O($);N.push.apply(N,T.filter(function(D){return D.bottom.y-D.top.y>=2})),_.push.apply(_,S);var z=N.filter(function(D){return D.bottom.y-D.top.y>=2}).map(function(D){var Y=(D.top.startX+D.top.endX+D.bottom.startX+D.bottom.endX)/4,J=(D.top.y+D.bottom.y+1)/2;if(C.get(Math.round(Y),Math.round(J))){var L=[D.top.endX-D.top.startX,D.bottom.endX-D.bottom.startX,D.bottom.y-D.top.y+1],Z=x(L)/L.length,oe=v({x:Math.round(Y),y:Math.round(J)},[1,1,3,1,1],C);return{score:oe,x:Y,y:J,size:Z}}}).filter(function(D){return!!D}).sort(function(D,Y){return D.score-Y.score}).map(function(D,Y,J){if(Y>a)return null;var L=J.filter(function(oe,ce){return Y!==ce}).map(function(oe){return{x:oe.x,y:oe.y,score:oe.score+Math.pow(oe.size-D.size,2)/D.size,size:oe.size}}).sort(function(oe,ce){return oe.score-ce.score});if(L.length<2)return null;var Z=D.score+L[0].score+L[1].score;return{points:[D].concat(L.slice(0,2)),score:Z}}).filter(function(D){return!!D}).sort(function(D,Y){return D.score-Y.score});if(z.length===0)return null;var W=p(z[0].points[0],z[0].points[1],z[0].points[2]),U=W.topRight,I=W.topLeft,G=W.bottomLeft,k=F(C,_,U,I,G),M=[];k&&M.push({alignmentPattern:{x:k.alignmentPattern.x,y:k.alignmentPattern.y},bottomLeft:{x:G.x,y:G.y},dimension:k.dimension,topLeft:{x:I.x,y:I.y},topRight:{x:U.x,y:U.y}});var q=B(C,U),K=B(C,I),H=B(C,G),Q=F(C,_,q,K,H);return Q&&M.push({alignmentPattern:{x:Q.alignmentPattern.x,y:Q.alignmentPattern.y},bottomLeft:{x:H.x,y:H.y},topLeft:{x:K.x,y:K.y},topRight:{x:q.x,y:q.y},dimension:Q.dimension}),M.length===0?null:M}n.locate=j;function F(C,N,T,_,S){var O,$,z;try{O=g(_,T,S,C),$=O.dimension,z=O.moduleSize}catch{return null}var W={x:T.x-_.x+S.x,y:T.y-_.y+S.y},U=(f(_,S)+f(_,T))/2/z,I=1-3/U,G={x:_.x+I*(W.x-_.x),y:_.y+I*(W.y-_.y)},k=N.map(function(q){var K=(q.top.startX+q.top.endX+q.bottom.startX+q.bottom.endX)/4,H=(q.top.y+q.bottom.y+1)/2;if(C.get(Math.floor(K),Math.floor(H))){var Q=[q.top.endX-q.top.startX,q.bottom.endX-q.bottom.startX,q.bottom.y-q.top.y+1];x(Q)/Q.length;var D=v({x:Math.floor(K),y:Math.floor(H)},[1,1,1],C),Y=D+f({x:K,y:H},G);return{x:K,y:H,score:Y}}}).filter(function(q){return!!q}).sort(function(q,K){return q.score-K.score}),M=U>=15&&k.length?k[0]:G;return{alignmentPattern:M,dimension:$}}})]).default})})(jsQR$2)),jsQR$2.exports}var jsQRExports=requireJsQR();const jsQR=getDefaultExportFromCjs$1(jsQRExports),ConnectSigner=()=>{const{decryptedKey:e}=useAuthStore(),{addConnection:t,removeConnection:r}=useConnectionsStore(),{currentKeypairId:n}=useWalletStore(),[o,a]=reactExports.useState(""),[l,u]=reactExports.useState(null),[f,x]=reactExports.useState(!1),[p,g]=reactExports.useState(null),[y,b]=reactExports.useState(null),[w,v]=reactExports.useState(!1),[B,j]=reactExports.useState(""),[F,C]=reactExports.useState(!0),[N,T]=reactExports.useState(!1),_=reactExports.useRef(null),S=reactExports.useRef(null),[O,$]=reactExports.useState(""),[z,W]=reactExports.useState(null),[U,I]=reactExports.useState(null),[G,k]=reactExports.useState(null),M=reactExports.useRef(null),q=async Z=>{if(!e){u("Please unlock your vault first");return}if(!n){u("No active address selected");return}u(null),x(!0);try{const oe=Z||o,ce=ClientService.parseNostrConnectURI(oe);console.log("Parsed URI:",ce);const xe=useConnectionsStore.getState().connections.find(te=>te.keypairId!==n?!1:!!(te.appUrl&&ce.appUrl&&te.appUrl===ce.appUrl||!te.appUrl&&!ce.appUrl&&te.name&&ce.name&&te.name===ce.name));if(xe){x(!1),j(oe),b({connectionId:xe.id,name:xe.name||xe.appUrl||"Unknown App"});return}x(!1),g({uri:oe,name:ce.name||"Unknown App",pubkey:ce.signerPubkey,appUrl:ce.appUrl})}catch(oe){x(!1),u(oe.message)}},K=()=>{if(p)try{const Z=ClientService.parseNostrConnectURI(p.uri),oe=Math.random().toString(36).substring(7),ce={id:oe,keypairId:n,signerPubkey:Z.signerPubkey,relays:Z.relays,secret:Z.secret,name:Z.name,appUrl:Z.appUrl,status:"connecting",startedVia:"nostrconnect",connectedAt:Date.now()};t(ce),p.rulesToCopy&&p.rulesToCopy.length>0&&(console.log("[ConnectSigner] Copying",p.rulesToCopy.length,"rules to new connection"),p.rulesToCopy.forEach(de=>{useConnectionsStore.getState().addRule({...de,id:Math.random().toString(36).substring(7),connectionId:oe,createdAt:Date.now()})}),console.log("[ConnectSigner]  Rules copied successfully")),a(""),g(null)}catch(Z){u(Z.message)}},H=async()=>{if(!G)return;const Z=useRelayStore.getState().relays.map(ce=>ce.url);if(Z.length===0)throw new Error("No relays connected");const oe=new NDK({explicitRelayUrls:Z});try{await Promise.race([oe.connect(),new Promise((ce,de)=>setTimeout(()=>de(new Error("Broadcast connection timed out")),5e3))])}catch(ce){console.warn("Broadcast connection timed out/failed, checking for partial connections...",ce);let de=0;if(oe.pool.relays.forEach(xe=>{(xe.status===1||xe.status===5)&&de++}),de===0)throw console.error("No relays connected for broadcast"),ce;console.log(`Proceeding with broadcast via ${de} relays`)}try{const ce=new NDKEvent(oe,G);await ce.publish(),console.log("Published event:",ce.id)}catch(ce){throw console.error("Broadcast failed:",ce),ce}},Q=async()=>{if(y){v(!0);try{const Z=F?useConnectionsStore.getState().getRulesForConnection(y.connectionId):[];console.log("[ConnectSigner] Replacing connection, preserve rules:",F,"Old rules count:",Z.length),r(y.connectionId),await new Promise(de=>setTimeout(de,100));const oe=B||o,ce=ClientService.parseNostrConnectURI(oe);b(null),j(""),g({uri:oe,name:ce.name||"Unknown App",pubkey:ce.signerPubkey,appUrl:ce.appUrl,rulesToCopy:Z})}finally{v(!1),C(!0)}}},D=Z=>{Z.sig?(console.log("[Offline] Signed Event detected, showing broadcast modal"),k(Z)):(console.log("[Offline] Unsigned Event detected, showing offline signer"),I(Z)),T(!1)},Y=async Z=>{const oe=Z.target.files?.[0];if(!oe){console.log("[QR Upload] No file selected"),$("No file selected");return}if(oe.type==="application/json"||oe.name.endsWith(".json")){console.log("[Offline] JSON file detected:",oe.name);const ce=new FileReader;ce.onload=de=>{try{const xe=de.target?.result,te=JSON.parse(xe);te.kind!==void 0&&te.content!==void 0?(console.log("[Offline] JSON Event Found via file:",te),D(te),T(!1)):u("File is valid JSON but not a Nostr event")}catch{u("Invalid JSON file")}},ce.readAsText(oe);return}console.log("[QR Upload] File selected:",oe.name,oe.type),u(null),$(`File selected: ${oe.name} (${(oe.size/1024).toFixed(1)}KB)`);try{const ce=new Image,de=new FileReader;de.onload=xe=>{if(xe.target?.result){console.log("[QR Upload] File loaded, setting image source"),$("File loaded, processing image...");const te=xe.target.result;ce.src=te,W(te)}},de.onerror=()=>{console.error("[QR Upload] FileReader error"),u("Failed to read image file"),$("ERROR: Failed to read file")},ce.onload=async()=>{console.log("[QR Upload] Image loaded, dimensions:",ce.width,"x",ce.height),$(`Image loaded: ${ce.width}x${ce.height}px`);const xe=document.createElement("canvas"),te=xe.getContext("2d",{willReadFrequently:!0});if(!te){u("Canvas not supported"),$("ERROR: Canvas not supported");return}const ae=(ue,be,Be=!1)=>{xe.width=ue,xe.height=be,te.drawImage(ce,0,0,ue,be);const Ce=te.getImageData(0,0,ue,be),Se=jsQR(Ce.data,ue,be,{inversionAttempts:Be?"invertFirst":"dontInvert"});return Se?Se.data:null};let le=ae(ce.width,ce.height);if(!le&&(ce.width>800||ce.height>800)){const ue=800/Math.max(ce.width,ce.height);console.log("[QR Upload] Retrying with scale:",ue),le=ae(Math.floor(ce.width*ue),Math.floor(ce.height*ue))}if(le||(console.log("[QR Upload] Retrying with inversion"),le=ae(ce.width,ce.height,!0)),le)if(console.log("[QR Upload] QR code found:",le),$(`QR code found! Data: ${le.substring(0,50)}...`),le.startsWith("nostrconnect://")||le.startsWith("bunker://"))a(le),T(!1),await q(le);else if(le.toLowerCase().startsWith("ur:"))try{if(M.current||(M.current=new distExports$3.URDecoder),M.current.receivePart(le),M.current.isComplete()){const be=M.current.resultUR().decodeCBOR();let Be;Buffer$1.isBuffer(be)?Be=JSON.parse(be.toString("utf8")):Be=be,console.log("[Offline] UR Decode Complete:",Be),D(Be),T(!1),M.current=null}else $(`Scanning... ${Math.floor(M.current.estimatedPercentComplete()*100)}%`)}catch(ue){console.error("[Offline] UR Decode Error:",ue),$("UR Error: "+ue.message)}else if(le.trim().startsWith("{"))try{const ue=JSON.parse(le);ue.kind!==void 0&&ue.content!==void 0?(console.log("[Offline] JSON Event Found:",ue),D(ue),T(!1)):u("QR is JSON but not a valid Nostr event")}catch{u("Invalid QR format")}else u("QR code found but not a valid nostrconnect://, bunker://, or Event"),$(`ERROR: Invalid URI format. Found: ${le.substring(0,30)}...`),console.log("[QR Upload] Invalid format:",le);else u("No QR code detected. Try cropping the image to just the QR code."),$("ERROR: No QR code detected after multiple attempts"),console.log("[QR Upload] No QR code found")},ce.onerror=()=>{console.error("[QR Upload] Image load error"),u("Failed to load image"),$("ERROR: Failed to load image")},de.readAsDataURL(oe)}catch(ce){console.error("[QR Upload] Error:",ce);const de="Failed to process image: "+ce.message;u(de),$("ERROR: "+de)}},J=async()=>{M.current=new distExports$3.URDecoder,T(!0),u(null)};reactExports.useEffect(()=>{(N||p||y)&&window.history.pushState({modal:"connect-signer"},"");const oe=()=>{N&&T(!1),p&&g(null),y&&b(null)};return window.addEventListener("popstate",oe),()=>{window.removeEventListener("popstate",oe)}},[N,p,y]);const L=(Z,oe)=>{if(!N){console.log("[Camera] Stopping scan loop"),oe.getTracks().forEach(te=>te.stop());return}const ce=document.createElement("canvas"),de=ce.getContext("2d",{willReadFrequently:!0}),xe=async()=>{if(Z.readyState===Z.HAVE_ENOUGH_DATA&&de){ce.height=Z.videoHeight,ce.width=Z.videoWidth,de.drawImage(Z,0,0,ce.width,ce.height);const te=de.getImageData(0,0,ce.width,ce.height),ae=jsQR(te.data,te.width,te.height,{inversionAttempts:"dontInvert"});if(ae){console.log("[Camera] QR Found:",ae.data);const le=ae.data;if(le.startsWith("nostrconnect://")||le.startsWith("bunker://")){oe.getTracks().forEach(ue=>ue.stop()),T(!1),a(le),await q(le);return}else if(le.toLowerCase().startsWith("ur:"))try{if(M.current||(M.current=new distExports$3.URDecoder),M.current.receivePart(le),M.current.isComplete()){const be=M.current.resultUR().decodeCBOR();let Be;Buffer$1.isBuffer(be)?Be=JSON.parse(be.toString("utf8")):Be=be,console.log("[Camera] UR Decode Complete:",Be),oe.getTracks().forEach(Ce=>Ce.stop()),T(!1),D(Be),M.current=null;return}else $(`Scanning... ${Math.floor(M.current.estimatedPercentComplete()*100)}%`)}catch(ue){console.error("[Camera] UR Decode Error:",ue);try{if(M.current=new distExports$3.URDecoder,M.current.receivePart(le),M.current.isComplete()){const Be=M.current.resultUR().decodeCBOR();let Ce;Buffer$1.isBuffer(Be)?Ce=JSON.parse(Be.toString("utf8")):Ce=Be,console.log("[Camera] UR Decode Complete (Recovery):",Ce),oe.getTracks().forEach(Se=>Se.stop()),T(!1),D(Ce),M.current=null;return}$("New QR Detected...")}catch(be){console.error("[Camera] Retry failed:",be),$(`Frame Error: ${be.message}`)}}else if(le.trim().startsWith("{"))try{const ue=JSON.parse(le);if(ue.kind!==void 0&&ue.content!==void 0){console.log("[Camera] JSON Event Found:",ue),oe.getTracks().forEach(be=>be.stop()),T(!1),D(ue);return}}catch{}}}document.getElementById("qr-modal")?requestAnimationFrame(xe):(console.log("[Camera] Modal closed, stopping tracks"),oe.getTracks().forEach(te=>te.stop()))};requestAnimationFrame(xe)};return reactExports.useEffect(()=>{let Z=null,oe=!0;return N&&(async()=>{if(N){console.log("[Camera] Starting camera initialization..."),$("Requesting camera access...");try{const de=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!oe){de.getTracks().forEach(te=>te.stop());return}Z=de,console.log("[Camera] Stream obtained:",de.id,de.active),$("Camera access granted. Starting video...");const xe=S.current;if(xe){console.log("[Camera] Video element found"),xe.srcObject=de,xe.setAttribute("playsinline","true"),xe.onloadedmetadata=()=>{console.log("[Camera] Video metadata loaded:",xe.videoWidth,"x",xe.videoHeight),$(`Video ready: ${xe.videoWidth}x${xe.videoHeight}`)},xe.onplay=()=>{console.log("[Camera] Video playing")};try{await xe.play(),console.log("[Camera] Video play promise resolved"),L(xe,de)}catch(te){console.error("[Camera] Play failed:",te),$("ERROR: Video play failed: "+te.message)}}else console.error("[Camera] Video element NOT found in ref"),$("ERROR: Video element not found")}catch(de){console.error("[Camera] Access failed:",de),$("ERROR: Camera access failed: "+de.message)}}})(),()=>{oe=!1,Z&&(console.log("[Camera] Cleaning up stream"),Z.getTracks().forEach(de=>de.stop()))}},[N]),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Paste a nostrconnect:// URI from an app to act as its remote signer"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"nostrconnect:// URI"}),jsxRuntimeExports.jsx("input",{type:"text",value:o,onChange:Z=>a(Z.target.value),placeholder:"nostrconnect://...",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm"})]}),l&&jsxRuntimeExports.jsx("div",{className:"text-red-400 text-sm bg-red-400/10 p-3 rounded-lg",children:l}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>q(),disabled:f||!o,className:"flex-1 bg-slate-800 hover:bg-slate-700 text-slate-200 font-bold py-3 px-4 rounded-xl border border-slate-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:f?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-5 h-5 animate-spin"}),"Connecting..."]}):"Connect"}),jsxRuntimeExports.jsx("button",{onClick:J,disabled:f,className:"bg-amber-500 hover:bg-amber-400 text-slate-950 p-3 rounded-xl transition-colors shadow-lg disabled:opacity-50",title:"Scan QR & Connect",children:jsxRuntimeExports.jsx(QrCode,{className:"w-6 h-6"})})]})]}),p&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-amber-500/10 rounded-full",children:jsxRuntimeExports.jsx(QrCode,{className:"w-6 h-6 text-amber-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Approve Connection"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:"Do you want to connect to this app?"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 mb-6 border border-slate-800 space-y-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"App Name"}),jsxRuntimeExports.jsx("p",{className:"text-white font-medium",children:p.name})]}),p.appUrl&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Website"}),jsxRuntimeExports.jsx("p",{className:"text-amber-400 truncate",children:p.appUrl})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"App Pubkey"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 font-mono text-xs break-all",children:p.pubkey})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>window.history.back(),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsxs("button",{onClick:K,className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),"Connect"]})]})]})}),y&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Replace Existing Connection?"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-4",children:["You already have a connection to ",jsxRuntimeExports.jsx("span",{className:"text-amber-400 font-semibold",children:y.name}),". Do you want to replace it with this new connection?"]}),jsxRuntimeExports.jsx("div",{className:"mb-6",children:jsxRuntimeExports.jsx("button",{onClick:()=>C(!F),className:"w-full p-4 bg-slate-800/50 hover:bg-slate-800/70 rounded-lg border border-slate-700/50 transition-colors",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-4",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-300 text-left flex-1",children:"Keep existing auto-approval rules"}),jsxRuntimeExports.jsx("div",{className:`relative w-14 h-7 rounded-md transition-all duration-300 ${F?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:jsxRuntimeExports.jsx("div",{className:`absolute top-0.5 left-0.5 w-6 h-6 bg-white rounded-md shadow-lg transition-all duration-300 flex items-center justify-center ${F?"translate-x-7":"translate-x-0"}`,children:F?jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]})})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>window.history.back(),disabled:w,className:"flex-1 bg-slate-800 hover:bg-slate-700 disabled:bg-slate-700 disabled:opacity-50 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:Q,disabled:w,className:"flex-1 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:w?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Replacing..."]}):"Replace"})]})]})}),N&&jsxRuntimeExports.jsx("div",{id:"qr-modal",className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-50 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 rounded-xl p-4 border border-slate-800 my-auto",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-4 text-center",children:"Scan QR Code"}),jsxRuntimeExports.jsxs("div",{className:"relative aspect-square bg-black rounded-lg overflow-hidden mb-4",children:[jsxRuntimeExports.jsx("video",{ref:S,id:"qr-video",className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 border-2 border-amber-500/50 rounded-lg pointer-events-none"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("p",{className:"text-center text-slate-400 text-sm",children:"Camera not working? Upload an image instead."}),O&&jsxRuntimeExports.jsx("div",{className:`p-3 rounded-lg text-sm font-mono break-all ${O.startsWith("ERROR")?"bg-red-500/10 text-red-400":"bg-blue-500/10 text-blue-400"}`,children:O}),z&&jsxRuntimeExports.jsxs("div",{className:"relative max-h-48 overflow-hidden rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Uploaded Image:"}),jsxRuntimeExports.jsx("img",{src:z,alt:"Uploaded QR",className:"w-full object-contain bg-black/50"})]}),jsxRuntimeExports.jsx("input",{type:"file",ref:_,onChange:Y,accept:"image/*,application/json,.json",capture:"environment",className:"hidden"}),jsxRuntimeExports.jsxs("button",{onClick:()=>_.current?.click(),className:"w-full bg-slate-800 hover:bg-slate-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(QrCode,{className:"w-5 h-5"}),"Upload QR Image / JSON File"]}),jsxRuntimeExports.jsx("button",{onClick:()=>window.history.back(),className:"w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 font-medium py-3 px-4 rounded-lg transition-colors",children:"Cancel"})]})]})}),U&&jsxRuntimeExports.jsx(OfflineSigner,{event:U,onClose:()=>I(null)}),G&&jsxRuntimeExports.jsx(BroadcastModal,{eventJson:G,onClose:()=>k(null),onBroadcast:H})]})};class ProfileService{static ndk=null;static connecting=null;static getNDK(){return this.ndk||(this.ndk=new NDK({explicitRelayUrls:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io","wss://purplepag.es","wss://relay.snort.social","wss://eden.nostr.land"]})),this.ndk}static async ensureConnection(){const t=this.getNDK();if(this.connecting)console.log("[ProfileService] Waiting for existing connection...");else{if(t.pool.connectedRelays().length>0){console.log("[ProfileService] Already connected to",t.pool.connectedRelays().length,"relays");return}console.log("[ProfileService] Initiating new NDK connection..."),this.connecting=t.connect().then(()=>{console.log("[ProfileService] NDK connection established"),this.connecting=null}).catch(n=>{console.warn("[ProfileService] Connection promise failed:",n),this.connecting=null})}const r=new Promise((n,o)=>setTimeout(()=>o(new Error("Connection timeout")),5e3));try{this.connecting&&await Promise.race([this.connecting,r]),console.log("[ProfileService] NDK ready for use")}catch{console.warn("[ProfileService] Connection timed out or failed, attempting to fetch anyway...")}}static async fetchProfile(t){try{console.log("[ProfileService] Starting fetchProfile for",t);const r=this.getNDK();await this.ensureConnection();const o=new NDKUser({npub:t}).pubkey;console.log("[ProfileService] Pubkey:",o),console.log("[ProfileService] Fetching Kind 0 events...");const a=r.fetchEvents({kinds:[0],authors:[o],limit:1}),l=new Promise((b,w)=>setTimeout(()=>w(new Error("Fetch timeout after 10 seconds")),1e4)),u=await Promise.race([a,l]);if(console.log("[ProfileService] Received",u.size,"events"),u.size===0)return console.log("[ProfileService] No Kind 0 event found for",t),null;const f=Array.from(u)[0];console.log("[ProfileService] Raw event:",f),console.log("[ProfileService] Event content:",f.content);const x=JSON.parse(f.content);console.log("[ProfileService] Parsed content:",x);const p=x.display_name||x.displayName||x.name||void 0,g=x.picture||x.image||void 0,y={name:p,picture:g,about:x.about,banner:x.banner,lud16:x.lud16,nip05:x.nip05,website:x.website,npub:t};return console.log("[ProfileService] Returning profile:",y),y}catch(r){return console.error("[ProfileService] Failed to fetch profile:",r),console.error("[ProfileService] Error stack:",r instanceof Error?r.stack:"No stack"),this.connecting=null,null}}static async fetchContacts(t){try{console.log("[ProfileService] Fetching contacts for:",t);const r=this.getNDK();await this.ensureConnection(),console.log("[ProfileService] NDK connected");const o=await r.getUser({npub:t}).follows();if(console.log("[ProfileService] Found",o.size,"follows"),o.size===0)return[];const l=Array.from(o).map(p=>p.pubkey).slice(0,100);if(console.log("[ProfileService] Fetching profiles for",l.length,"contacts"),l.length===0)return[];const u=await r.fetchEvents({kinds:[0],authors:l});console.log("[ProfileService] Received",u.size,"profile events");const f=new Map;for(const p of u)try{const g=JSON.parse(p.content),y=new NDKUser({pubkey:p.pubkey}).npub;f.set(y,{name:g.name,picture:g.picture||g.image,about:g.about,nip05:g.nip05,lud16:g.lud16,banner:g.banner,website:g.website,npub:y})}catch{}const x=Array.from(f.values());return console.log("[ProfileService] Returning",x.length,"contacts"),x}catch(r){return console.error("[ProfileService] Error fetching contacts:",r),[]}}static async publishProfile(t,r){try{const n=new NDKPrivateKeySigner(t),o=new NDK({explicitRelayUrls:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io"],signer:n});await o.connect();const a=new NDKEvent(o);a.kind=0,a.content=JSON.stringify({name:r.name||"",picture:r.picture||"",about:r.about||"",banner:r.banner||"",lud16:r.lud16||"",nip05:r.nip05||"",website:r.website||""}),await a.sign(n),await a.publish(),console.log("Profile published successfully")}catch(n){throw console.error("Failed to publish profile:",n),n}}}const profile=Object.freeze(Object.defineProperty({__proto__:null,ProfileService},Symbol.toStringTag,{value:"Module"})),ViewPrivateKeyModal=({encryptedNsec:e,onClose:t})=>{const[r,n]=reactExports.useState(""),[o,a]=reactExports.useState(null),[l,u]=reactExports.useState(null),[f,x]=reactExports.useState(!1),[p,g]=reactExports.useState(!1),[y,b]=reactExports.useState(!1),w=async B=>{B.preventDefault(),u(null),x(!0);try{const j=await CryptoService.decrypt(e,r);a(j),n("")}catch{u("Incorrect password")}finally{x(!1)}},v=()=>{o&&(navigator.clipboard.writeText(o),g(!0),setTimeout(()=>g(!1),2e3))};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:t,children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",onClick:B=>B.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"View Private Key"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),o?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Private Key (nsec)"}),jsxRuntimeExports.jsx("button",{onClick:()=>b(!y),className:"text-slate-400 hover:text-white transition-colors",children:y?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("div",{className:"font-mono text-sm break-all text-white",children:y?o:"".repeat(63)})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:v,className:"flex-1 flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:p?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),"Copied!"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),"Copy"]})}),jsxRuntimeExports.jsx("button",{onClick:t,className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors",children:"Close"})]})]}):jsxRuntimeExports.jsxs("form",{onSubmit:w,className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:" Never share your private key with anyone. Anyone with this key can control this account."})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Enter your password to reveal the private key"}),jsxRuntimeExports.jsx("input",{type:"password",inputMode:"numeric",value:r,onChange:B=>n(B.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Password",required:!0,autoFocus:!0})]}),l&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:l}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:f,className:"flex-1 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 font-bold py-3 px-4 rounded-lg transition-colors",children:f?"Decrypting...":"Reveal"})]})]})]})})},ProfileEditor=({keypair:e,walletId:t,onBack:r})=>{const{updateKeypair:n,getWallet:o}=useWalletStore(),[a,l]=reactExports.useState({name:e.profile?.name||"",picture:e.profile?.picture||"",about:e.profile?.about||"",banner:e.profile?.banner||"",lud16:e.profile?.lud16||"",nip05:e.profile?.nip05||"",website:e.profile?.website||""}),[u,f]=reactExports.useState(""),[x,p]=reactExports.useState(!1),[g,y]=reactExports.useState(!1),[b,w]=reactExports.useState(null),[v,B]=reactExports.useState(!1),j=o(t);reactExports.useEffect(()=>{(async()=>{y(!0);try{const N=await ProfileService.fetchProfile(e.npub);N&&l(N)}catch(N){console.error("Failed to fetch profile:",N)}finally{y(!1)}})()},[e.npub]);const F=async C=>{C.preventDefault(),w(null),B(!1),p(!0);try{if(!j)throw new Error("Wallet not found");const N=await CryptoService.decrypt(e.encryptedNsec,u),T=CryptoService.nsecToHex(N);await ProfileService.publishProfile(T,a),n(t,e.id,{profile:{...a,lastFetched:Date.now()}}),B(!0),f(""),setTimeout(()=>{r()},1500)}catch(N){console.error("Failed to publish profile:",N),w("Failed to publish profile. Please check your password and try again.")}finally{p(!1)}};return jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:r,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold flex items-center gap-2 mb-2",children:"Edit Profile"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-400 text-sm",children:["Update your Nostr profile (kind:0) for ",e.npub.slice(0,12),"..."]})]}),g&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-4 bg-slate-900 rounded-xl border border-slate-800 flex items-center gap-3",children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-300",children:"Fetching latest profile from relays..."})]}),jsxRuntimeExports.jsxs("form",{onSubmit:F,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-900 rounded-xl border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"w-16 h-16 rounded-lg bg-slate-800 flex items-center justify-center overflow-hidden flex-shrink-0",children:[a.picture?jsxRuntimeExports.jsx("img",{src:a.picture,alt:"Profile",className:"w-full h-full object-cover",onError:C=>{C.currentTarget.style.display="none",C.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx(User,{className:`w-8 h-8 text-slate-600 ${a.picture?"hidden":""}`})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-slate-300",children:"Profile Preview"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 truncate",children:a.name||"No name set"})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Display Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:a.name||"",onChange:C=>l({...a,name:C.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Your name"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Bio"}),jsxRuntimeExports.jsx("textarea",{value:a.about||"",onChange:C=>l({...a,about:C.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all resize-none",placeholder:"Tell us about yourself",rows:3})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Profile Picture URL"}),jsxRuntimeExports.jsx("input",{type:"url",value:a.picture||"",onChange:C=>l({...a,picture:C.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://example.com/avatar.jpg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Banner Image URL"}),jsxRuntimeExports.jsx("input",{type:"url",value:a.banner||"",onChange:C=>l({...a,banner:C.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://example.com/banner.jpg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Lightning Address"}),jsxRuntimeExports.jsx("input",{type:"text",value:a.lud16||"",onChange:C=>l({...a,lud16:C.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"you@getalby.com"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"NIP-05 Identifier"}),jsxRuntimeExports.jsx("input",{type:"text",value:a.nip05||"",onChange:C=>l({...a,nip05:C.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"you@example.com"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Website"}),jsxRuntimeExports.jsx("input",{type:"url",value:a.website||"",onChange:C=>l({...a,website:C.target.value}),className:"w-full bg-slate-900 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"https://yourwebsite.com"})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Wallet Password"}),jsxRuntimeExports.jsx("input",{type:"password",value:u,onChange:C=>f(C.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all",placeholder:"Enter password to publish",required:!0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Your password is required to sign and publish the profile update."})]}),b&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:b}),v&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-green-400 text-sm",children:"Profile published successfully! Redirecting..."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:x||!u,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-600 disabled:opacity-50 text-slate-950 rounded-lg transition-colors font-bold",children:x?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 animate-spin"}),"Publishing..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Save,{className:"w-4 h-4"}),"Save Profile"]})})]})]})]})},PasswordModal=({isOpen:e,onClose:t,onSubmit:r,title:n,description:o,submitLabel:a="Confirm",error:l})=>{const[u,f]=reactExports.useState("");reactExports.useEffect(()=>{e&&f("")},[e]);const x=p=>{p.preventDefault(),u&&r(u)};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-800 max-w-md w-full p-6 shadow-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Lock,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:n})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),o&&jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:o}),jsxRuntimeExports.jsxs("form",{onSubmit:x,children:[jsxRuntimeExports.jsx("input",{type:"password",value:u,onChange:p=>f(p.target.value),placeholder:"Enter password",inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 mb-3 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",autoFocus:!0,required:!0}),l&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm mb-3",children:l}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:a})]})]})]})}):null},InputModal=({isOpen:e,onClose:t,onSubmit:r,title:n,description:o,placeholder:a="Enter value",initialValue:l="",submitLabel:u="Save"})=>{const[f,x]=reactExports.useState(l);reactExports.useEffect(()=>{e&&x(l)},[e,l]);const p=g=>{g.preventDefault(),f.trim()&&r(f.trim())};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-800 max-w-md w-full p-6 shadow-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Pen,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:n})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),o&&jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:o}),jsxRuntimeExports.jsxs("form",{onSubmit:p,children:[jsxRuntimeExports.jsx("input",{type:"text",value:f,onChange:g=>x(g.target.value),placeholder:a,className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 mb-4 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",autoFocus:!0,required:!0}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:u})]})]})]})}):null},BackupModal=({isOpen:e,onClose:t,mnemonic:r,onDownload:n})=>{const[o,a]=reactExports.useState(!1),[l,u]=reactExports.useState(!1);if(!e)return null;const f=()=>{navigator.clipboard.writeText(r),a(!0),setTimeout(()=>a(!1),2e3)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Wallet Backup"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"These are your recovery words. Write them down and keep them safe."})}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 relative group",children:[jsxRuntimeExports.jsx("div",{className:`grid grid-cols-3 gap-2 ${l?"":"blur-sm select-none"}`,children:r.split(" ").map((x,p)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 p-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500 text-xs w-4",children:[p+1,"."]}),jsxRuntimeExports.jsx("span",{className:"font-mono font-medium text-amber-50",children:x})]},p))}),jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>u(!l),className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:l?"Hide seed phrase":"Show seed phrase",children:l?jsxRuntimeExports.jsx(EyeOff,{className:"w-4 h-4 text-slate-400"}):jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("button",{onClick:f,className:"p-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors",title:"Copy to clipboard",children:o?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 flex items-start gap-3",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-200/80",children:"Anyone with these words can access your funds. Never share them."})]}),jsxRuntimeExports.jsxs("button",{onClick:n,className:"w-full py-3 px-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-xl transition-colors border border-slate-700 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),"Download Encrypted Backup"]})]})]})})},KeypairManager=({walletId:e,onBack:t})=>{const{getWallet:r,addKeypair:n,updateKeypair:o,removeKeypair:a,setCurrentKeypair:l,currentKeypairId:u,updateWallet:f,removeWallet:x,currentWalletId:p,setCurrentWallet:g,wallets:y}=useWalletStore(),{unlock:b}=useAuthStore(),[w,v]=reactExports.useState(""),[B,j]=reactExports.useState(!1),[F,C]=reactExports.useState(null),[N,T]=reactExports.useState(null),[_,S]=reactExports.useState(null),[O,$]=reactExports.useState(null),[z,W]=reactExports.useState(null),[U,I]=reactExports.useState(!1),[G,k]=reactExports.useState(null),[M,q]=reactExports.useState(!1),[K,H]=reactExports.useState(null),[Q,D]=reactExports.useState(!1),[Y,J]=reactExports.useState(!1),[L,Z]=reactExports.useState(!1),[oe,ce]=reactExports.useState(""),[de,xe]=reactExports.useState(null),[te,ae]=reactExports.useState(!1),[le,ue]=reactExports.useState(null),[be,Be]=reactExports.useState(null),Ce=r(e);if(!Ce)return jsxRuntimeExports.jsx("div",{children:"Wallet not found"});reactExports.useEffect(()=>{(async()=>{for(const ye of Ce.keypairs){if(ye.profile?.lastFetched&&Date.now()-ye.profile.lastFetched<1e4){console.log("[KeypairManager] Skipping profile fetch for",ye.npub,"- fetched recently");continue}try{console.log("[KeypairManager] Fetching profile for",ye.npub);const Ne=await ProfileService.fetchProfile(ye.npub);Ne&&o(Ce.id,ye.id,{profile:{...Ne,lastFetched:Date.now()}})}catch(Ne){console.error(`Failed to fetch profile for ${ye.npub}:`,Ne)}}})()},[Ce.id]);const Se=async Re=>{Re.preventDefault(),W(null),I(!0);try{if(F==="add"){if(Ce.type==="imported")throw new Error("Cannot derive new addresses for imported wallets");const ye=await CryptoService.decrypt(Ce.encryptedSeed,w);let Ne=0;Ce.keypairs.forEach(je=>{if(je.derivationPath){const Ie=je.derivationPath.match(/(\d+)$/);if(Ie){const Ze=parseInt(Ie[1]);Ze>=Ne&&(Ne=Ze+1)}}});const{nsec:ie,npub:P,path:V}=CryptoService.deriveKeypair(ye,Ne),he=await CryptoService.encrypt(ie,w),_e={id:crypto.randomUUID(),walletId:Ce.id,name:`Address ${Ne+1}`,derivationPath:V,encryptedNsec:he,npub:P,createdAt:Date.now(),connections:[]};n(Ce.id,_e),j(!1),v(""),C(null),setTimeout(async()=>{try{const je=await ProfileService.fetchProfile(P);je&&o(Ce.id,_e.id,{profile:{...je,lastFetched:Date.now()}})}catch(je){console.error("Failed to fetch profile for new keypair:",je)}},100)}else if(F==="switch"&&N){const ye=await CryptoService.decrypt(N.encryptedNsec,w),Ne=CryptoService.nsecToHex(ye);Ce.id!==p&&g(Ce.id),l(N.id),b(Ne,w),j(!1),v(""),C(null),T(null)}}catch{W("Incorrect password or operation failed")}finally{I(!1)}},ke=()=>{C("add"),j(!0),W(null)},we=async Re=>{try{console.log("[KeypairManager] Manually refreshing profile for",Re.npub);const ye=await ProfileService.fetchProfile(Re.npub);ye?(o(Ce.id,Re.id,{profile:{...ye,lastFetched:Date.now()}}),Be({message:"Profile refreshed!",type:"success"})):Be({message:"No profile found",type:"error"})}catch(ye){console.error("Failed to refresh profile:",ye),Be({message:"Failed to refresh profile",type:"error"})}},Fe=async Re=>{const{password:ye}=useAuthStore.getState();if(ye)try{const Ne=await CryptoService.decrypt(Re.encryptedNsec,ye),ie=CryptoService.nsecToHex(Ne);l(Re.id),b(ie,ye);return}catch{console.error("[KeypairManager] Cached password failed, prompting for password")}T(Re),C("switch"),j(!0),W(null)},Pe=(Re,ye)=>{navigator.clipboard.writeText(Re),k(ye),setTimeout(()=>k(null),2e3)},Ye=Re=>{Re&&Re!==Ce.name&&(f(Ce.id,{name:Re}),Be({message:"Address Book renamed successfully!",type:"success"})),D(!1)},Ve=Re=>{Re&&K&&(o(Ce.id,K.id,{name:Re}),Be({message:"Address renamed successfully!",type:"success"})),q(!1),H(null)},Ee=async Re=>{try{const{CryptoService:ye}=await __vitePreload(async()=>{const{CryptoService:ie}=await Promise.resolve().then(()=>crypto$3);return{CryptoService:ie}},void 0,import.meta.url),Ne=await ye.decrypt(Ce.encryptedSeed,Re);ce(Ne),v(Re),J(!1),Z(!0),xe(null)}catch(ye){console.error("Failed to export backup:",ye),xe("Failed to decrypt wallet. Incorrect password.")}},ve=async()=>{try{const{CryptoService:Re}=await __vitePreload(async()=>{const{CryptoService:he}=await Promise.resolve().then(()=>crypto$3);return{CryptoService:he}},void 0,import.meta.url),ye=await Re.encrypt(oe,w),Ne=JSON.stringify({wallet:Ce.name,encrypted:ye,timestamp:Date.now()},null,2),ie=new Blob([Ne],{type:"application/json"}),P=URL.createObjectURL(ie),V=document.createElement("a");V.href=P,V.download=`${Ce.name.toLowerCase().replace(/\s+/g,"-")}-backup-encrypted.json`,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(P),Be({message:"Encrypted backup downloaded successfully!",type:"success"})}catch(Re){console.error("Failed to download backup:",Re),Be({message:"Failed to generate backup file",type:"error"})}},Te=async Re=>{try{const{CryptoService:ye}=await __vitePreload(async()=>{const{CryptoService:P}=await Promise.resolve().then(()=>crypto$3);return{CryptoService:P}},void 0,import.meta.url);Ce.type==="mnemonic"&&Ce.encryptedSeed?await ye.decrypt(Ce.encryptedSeed,Re):Ce.keypairs.length>0&&await ye.decrypt(Ce.keypairs[0].encryptedNsec,Re);const{lock:Ne}=useAuthStore.getState(),ie=y.filter(P=>P.id!==Ce.id);x(Ce.id),ie.length===0?Ne():t()}catch(ye){console.error("Failed to delete wallet:",ye),ue("Incorrect password. Cannot delete wallet.")}};return O?jsxRuntimeExports.jsx(ProfileEditor,{keypair:O,walletId:e,onBack:()=>$(null)}):jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[jsxRuntimeExports.jsxs("button",{onClick:t,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Address Books"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold",children:Ce.name}),jsxRuntimeExports.jsx("button",{onClick:()=>D(!0),className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Rename address book",children:jsxRuntimeExports.jsx(Pen,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm",children:"Manage your addresses"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[Ce.id!==p&&jsxRuntimeExports.jsxs("button",{onClick:()=>{j(!0),C("switch"),T(Ce.keypairs[0])},className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Activate Wallet"})]}),Ce.type==="mnemonic"&&Ce.encryptedSeed&&jsxRuntimeExports.jsxs("button",{onClick:()=>{xe(null),J(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Export Backup"})]}),Ce.type==="mnemonic"&&jsxRuntimeExports.jsxs("button",{onClick:ke,className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Add Address"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{ue(null),ae(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-red-500/10 hover:text-red-500 text-slate-400 rounded-lg transition-colors text-sm font-medium",title:"Delete Wallet",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]}),B&&jsxRuntimeExports.jsx("div",{className:"mb-6 p-4 bg-slate-900 rounded-xl border border-slate-800",children:jsxRuntimeExports.jsxs("form",{onSubmit:Se,children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:F==="add"?"Enter wallet password to add new address":"Enter wallet password to switch address"}),jsxRuntimeExports.jsx("input",{type:"password",value:w,onChange:Re=>v(Re.target.value),inputMode:"numeric",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 mb-3 focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none",placeholder:"Password",required:!0,autoFocus:!0}),z&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm mb-3",children:z}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{j(!1),v(""),W(null),C(null),T(null)},className:"flex-1 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:U,className:"flex-1 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold disabled:opacity-50",children:U?"Processing...":"Confirm"})]})]})}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:Ce.keypairs.map(Re=>{const ye=Re.npub.length>16?`${Re.npub.slice(0,8)}...${Re.npub.slice(-6)}`:Re.npub;return jsxRuntimeExports.jsxs("div",{className:`p-4 rounded-xl border transition-all ${u===Re.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[jsxRuntimeExports.jsxs("div",{className:`relative rounded-lg flex-shrink-0 cursor-pointer group ${u===Re.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,onClick:Ne=>{Ne.stopPropagation();const ie=Ne.currentTarget;ie.classList.add("opacity-50"),we(Re).finally(()=>ie.classList.remove("opacity-50"))},title:"Click to refresh profile",children:[Re.profile?.picture?jsxRuntimeExports.jsx("img",{src:Re.profile.picture,alt:Re.profile.name||"Profile",className:"w-10 h-10 rounded-lg object-cover",onError:Ne=>{Ne.currentTarget.style.display="none",Ne.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx("div",{className:`w-10 h-10 flex items-center justify-center ${Re.profile?.picture?"hidden":""}`,children:jsxRuntimeExports.jsx(User,{className:"w-6 h-6"})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100 rounded-lg",children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 text-white"})})]}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg truncate",children:Re.profile?.name||Re.name}),jsxRuntimeExports.jsx("button",{onClick:()=>{H(Re),q(!0)},className:"p-1 text-slate-500 hover:text-white hover:bg-slate-800 rounded transition-colors",title:"Rename address",children:jsxRuntimeExports.jsx(Pen,{className:"w-3 h-3"})}),u===Re.id&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex-shrink-0",children:"Active"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400 mt-1",children:[jsxRuntimeExports.jsx("span",{className:"font-mono bg-slate-950 px-2 py-0.5 rounded text-xs",children:ye}),jsxRuntimeExports.jsx("button",{onClick:()=>Pe(Re.npub,Re.id),className:"text-slate-500 hover:text-white transition-colors flex-shrink-0 p-1 hover:bg-slate-800 rounded",title:"Copy npub",children:G===Re.id?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:()=>S(Re),className:"text-slate-500 hover:text-white transition-colors flex-shrink-0 p-1 hover:bg-slate-800 rounded",title:"View private key",children:jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"})})]}),Re.derivationPath&&jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mt-1 font-mono truncate",children:Re.derivationPath})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-slate-800",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>$(Re),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors text-sm",children:[jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Edit Profile"})]}),u!==Re.id&&Ce.id===p&&jsxRuntimeExports.jsxs("button",{onClick:()=>Fe(Re),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-slate-800 hover:bg-slate-700 text-slate-300 text-sm font-medium rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Switch"})]}),Ce.keypairs.length>1&&jsxRuntimeExports.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this address?")&&a(Ce.id,Re.id)},className:"px-3 py-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete address",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]},Re.id)})}),_&&jsxRuntimeExports.jsx(ViewPrivateKeyModal,{encryptedNsec:_.encryptedNsec,onClose:()=>S(null)}),jsxRuntimeExports.jsx(InputModal,{isOpen:M,onClose:()=>{q(!1),H(null)},onSubmit:Ve,title:"Rename Address",description:"Enter a new name for this address",placeholder:"Address name",initialValue:K?.name||"",submitLabel:"Rename"}),jsxRuntimeExports.jsx(InputModal,{isOpen:Q,onClose:()=>D(!1),onSubmit:Ye,title:"Rename Address Book",description:"Enter a new name for your address book",placeholder:"Address book name",initialValue:Ce.name,submitLabel:"Rename"}),jsxRuntimeExports.jsx(PasswordModal,{isOpen:Y,onClose:()=>{J(!1),xe(null)},onSubmit:Ee,title:"Export Encrypted Backup",description:"Enter your wallet password to export an encrypted backup file",submitLabel:"Export",error:de}),jsxRuntimeExports.jsx(BackupModal,{isOpen:L,onClose:()=>{Z(!1),ce(""),v("")},mnemonic:oe,onDownload:ve}),jsxRuntimeExports.jsx(PasswordModal,{isOpen:te,onClose:()=>{ae(!1),ue(null)},onSubmit:Te,title:"Delete Address Book",description:`Are you sure you want to delete "${Ce.name}"? This action cannot be undone. Enter your password to confirm.`,submitLabel:"Delete Address Book",error:le}),be&&jsxRuntimeExports.jsx(Toast,{message:be.message,type:be.type,isOpen:!!be,onClose:()=>Be(null)})]})},WalletManager=({onBack:e})=>{const[t,r]=reactExports.useState("list"),[n,o]=reactExports.useState(null),{wallets:a,currentWalletId:l,setCurrentWallet:u}=useWalletStore(),{lock:f}=useAuthStore(),x=()=>{t==="list"&&e?e():(r("list"),o(null))},p=y=>{u(y),f()},g=y=>{o(y),r("keypairs")};return t==="create"?jsxRuntimeExports.jsx(CreateWallet,{onBack:x,onComplete:x}):t==="import"?jsxRuntimeExports.jsx(ImportWallet,{onBack:x,onComplete:x}):t==="keypairs"&&n?jsxRuntimeExports.jsx(KeypairManager,{walletId:n,onBack:x}):jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e&&t==="list"&&jsxRuntimeExports.jsxs("button",{onClick:e,className:"flex items-center text-slate-400 hover:text-white mb-6 transition-colors",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Connections"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-6 h-6 text-amber-500"}),"Address Books"]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>r("import"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors text-sm font-medium",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"sm:inline",children:"Import"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>r("create"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg transition-colors text-sm font-bold",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"sm:inline",children:"Create"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:a.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12 bg-slate-900/50 rounded-xl border border-slate-800 border-dashed",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No Address Books Found"}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 max-w-xs mx-auto mb-6",children:"Create a new address book or import an existing one to get started."}),jsxRuntimeExports.jsxs("div",{className:"flex justify-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>r("create"),className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg font-bold transition-colors",children:"Create New"}),jsxRuntimeExports.jsx("button",{onClick:()=>r("import"),className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors",children:"Import"})]})]}):a.map(y=>jsxRuntimeExports.jsx("div",{className:`p-4 rounded-xl border transition-all ${l===y.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg ${l===y.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:y.type==="imported"?jsxRuntimeExports.jsx(Key,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(Notebook,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[y.name,l===y.id&&jsxRuntimeExports.jsxs("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex items-center gap-1",children:[jsxRuntimeExports.jsx(Check,{className:"w-3 h-3"})," Active"]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3 text-sm text-slate-400 mt-1",children:jsxRuntimeExports.jsxs("span",{children:[y.keypairs.length," address",y.keypairs.length!==1?"es":""]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>g(y.id),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Manage Keys",children:jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"})}),l!==y.id&&jsxRuntimeExports.jsx("button",{onClick:()=>p(y.id),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Switch to this wallet",children:jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"})})]})]})},y.id))})]})},RelayManager=({onClose:e})=>{const{relays:t,addRelay:r,removeRelay:n}=useRelayStore(),[o,a]=reactExports.useState(""),[l,u]=reactExports.useState(null),f=async()=>{if(u(null),!o.trim()){u("Please enter a relay URL");return}if(!o.startsWith("wss://")&&!o.startsWith("ws://")){u("Relay URL must start with wss:// or ws://");return}const b=o.trim();r(b),a(""),window.dispatchEvent(new CustomEvent("add-relay",{detail:{url:b}}))},x=b=>{if(t.length<=1){u("Cannot remove the last relay");return}n(b)},p=b=>{switch(b.status){case"connected":return jsxRuntimeExports.jsx(Wifi,{className:"w-4 h-4 text-green-500"});case"connecting":return jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 text-yellow-500 animate-spin"});case"disconnected":case"error":return jsxRuntimeExports.jsx(WifiOff,{className:"w-4 h-4 text-red-500"})}},g=b=>{switch(b.status){case"connected":return"Connected";case"connecting":return"Connecting...";case"disconnected":return"Disconnected";case"error":return"Error"}},y=b=>{switch(b.status){case"connected":return"text-green-500";case"connecting":return"text-yellow-500";case"disconnected":case"error":return"text-red-500"}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:e,children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-2xl w-full border border-slate-800 shadow-2xl max-h-[80vh] flex flex-col",onClick:b=>b.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white",children:"Relay Management"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Manage your Nostr relay connections"})]}),jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",title:"Close",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Add New Relay"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsx("input",{type:"text",value:o,onChange:b=>a(b.target.value),onKeyDown:b=>b.key==="Enter"&&f(),placeholder:"wss://relay.example.com",className:"w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none"}),jsxRuntimeExports.jsxs("button",{onClick:f,className:"w-full px-4 py-2 bg-amber-500 hover:bg-amber-600 text-slate-950 rounded-lg font-bold transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),"Add Relay"]})]}),l&&jsxRuntimeExports.jsx("p",{className:"text-red-400 text-sm mt-2",children:l})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-slate-400 mb-3",children:["Active Relays (",t.length,")"]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:t.map(b=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-950 rounded-xl border border-slate-800 hover:border-slate-700 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[p(b),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"font-mono text-sm text-white truncate",children:b.url}),jsxRuntimeExports.jsxs("div",{className:`text-xs ${y(b)} mt-0.5`,children:[g(b),b.lastConnected&&b.status==="connected"&&jsxRuntimeExports.jsxs("span",{className:"text-slate-500 ml-2",children:[" Last: ",new Date(b.lastConnected).toLocaleTimeString()]}),b.failedAttempts>0&&jsxRuntimeExports.jsxs("span",{className:"text-slate-500 ml-2",children:[" Failed attempts: ",b.failedAttempts]})]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>x(b.url),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors ml-2",title:"Remove relay",disabled:t.length<=1,children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]},b.url))})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 p-4 bg-slate-950 rounded-lg border border-slate-800",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-400",children:[jsxRuntimeExports.jsx("strong",{className:"text-slate-300",children:"Note:"})," Relays are used to communicate with Nostr apps. The PWA will automatically attempt to reconnect to disconnected relays every 5 seconds."]})})]})})};class NotificationService{static instance;enabled=!0;constructor(){"Notification"in window||(console.warn("[NotificationService] Notifications not supported"),this.enabled=!1),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{t.data.type==="FOCUS_REQUEST"&&this.handleNotificationClick(t.data.requestId)})}static getInstance(){return NotificationService.instance||(NotificationService.instance=new NotificationService),NotificationService.instance}async requestPermission(){if(!this.enabled)return console.warn("[NotificationService] Notifications not enabled/supported"),"denied";if(!("Notification"in window))throw console.error("[NotificationService] Notification API not available"),new Error("Notifications not supported on this browser");if(!window.isSecureContext)throw console.error("[NotificationService] Not in secure context (HTTPS required)"),new Error("Notifications require HTTPS");try{console.log("[NotificationService] Requesting permission...");const t=await Notification.requestPermission();return console.log("[NotificationService] Permission result:",t),t}catch(t){throw console.error("[NotificationService] Permission request failed:",t),t}}getPermission(){return this.enabled?Notification.permission:"denied"}async showSigningRequest(t){if(console.log("[NotificationService] showSigningRequest called",{enabled:this.enabled,permission:Notification.permission,request:t.id}),!this.enabled){console.warn("[NotificationService] Service is disabled");return}if(Notification.permission!=="granted"){console.warn("[NotificationService] Permission not granted:",Notification.permission);return}if(document.visibilityState==="visible"){console.log("[NotificationService] App is visible, skipping system notification.");return}console.log("[NotificationService] Proceeding to show notification...");try{const o=useConnectionsStore.getState().connections.find(u=>u.signerPubkey===t.requestorPubkey)?.name||"Unknown App";let a="Request",l="";if(t.method==="sign_event")try{a=`Sign Event (Kind ${JSON.parse(t.params[0]).kind})`,l=`${o} wants to sign an event`}catch{a="Sign Event",l=`${o} wants to sign an event`}else t.method==="nip04_decrypt"?(a="Decrypt Message",l=`${o} wants to decrypt a message`):t.method==="nip04_encrypt"?(a="Encrypt Message",l=`${o} wants to encrypt a message`):t.method==="get_public_key"?(a="Get Public Key",l=`${o} wants your public key`):l=`${o} sent a ${t.method} request`;try{if("serviceWorker"in navigator){const u=await navigator.serviceWorker.ready;navigator.serviceWorker.controller||(console.log("[NotificationService] Waiting for SW controller..."),await new Promise(f=>{if(navigator.serviceWorker.controller)return f();navigator.serviceWorker.addEventListener("controllerchange",()=>f(),{once:!0})})),await u.showNotification(` ${a}`,{body:l,icon:"/pwa-192x192.png",badge:"/pwa-192x192.png",tag:`signing-request-${t.id}`,requireInteraction:!1,silent:!1,data:{requestId:t.id,requestEventId:t.requestEventId,requestorPubkey:t.requestorPubkey,method:t.method,params:t.params,url:window.location.origin}}),console.log("[NotificationService] Service Worker notification shown for request:",t.id)}else{const u=new Notification(` ${a}`,{body:l,icon:"/pwa-192x192.png",badge:"/pwa-192x192.png",tag:`signing-request-${t.id}`,requireInteraction:!1,silent:!1,data:{requestId:t.id,requestEventId:t.requestEventId,requestorPubkey:t.requestorPubkey,method:t.method,params:t.params}});u.onclick=()=>{window.focus(),this.handleNotificationClick(t.id),u.close()},console.log("[NotificationService] Direct notification shown for request:",t.id)}}catch(u){console.error("[NotificationService] Failed to show notification:",u)}}catch(r){console.error("[NotificationService] Failed to show notification:",r)}}handleNotificationClick(t){console.log("[NotificationService] Notification clicked for request:",t),window.dispatchEvent(new CustomEvent("focus-request",{detail:{requestId:t}}))}setEnabled(t){this.enabled=t,localStorage.setItem("notifications-enabled",t.toString())}isEnabled(){const t=localStorage.getItem("notifications-enabled");return t!==null&&(this.enabled=t==="true"),this.enabled}}const notificationService=NotificationService.getInstance(),NotificationBanner=()=>{const[e,t]=reactExports.useState(!1),[r,n]=reactExports.useState(!1);reactExports.useEffect(()=>{const l=notificationService.getPermission();t(l==="default")},[]);const o=async()=>{n(!0);try{const l=await notificationService.requestPermission();n(!1),l==="granted"?(t(!1),alert(" Notifications enabled! You'll be alerted when signing requests arrive.")):l==="denied"?(alert(" Notifications blocked. Please enable them in your browser settings if you change your mind."),t(!1)):alert(" Notification permission not granted. You can enable them later in settings.")}catch(l){console.error("Notification permission error:",l),n(!1),alert(" Notifications may not be supported on this device/browser. Try installing the PWA to your home screen first.")}},a=()=>{t(!1),sessionStorage.setItem("notification-banner-dismissed","true")};return sessionStorage.getItem("notification-banner-dismissed")||!e?null:jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:a,children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-amber-500/30 shadow-2xl",onClick:l=>l.stopPropagation(),children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-4",children:jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-amber-500/20 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(Bell,{className:"w-8 h-8 text-amber-500"})})}),jsxRuntimeExports.jsx("h3",{className:"text-white font-bold text-xl mb-2 text-center",children:"Enable Notifications"}),jsxRuntimeExports.jsx("p",{className:"text-slate-300 text-sm mb-6 text-center",children:"Get notified when apps request signatures, even when PWANS is in the background. You can approve or reject directly from notifications."}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:o,disabled:r,className:"w-full px-4 py-3 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-500/50 text-slate-950 rounded-lg font-bold transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Bell,{className:"w-5 h-5"}),r?"Requesting...":"Enable Notifications"]}),jsxRuntimeExports.jsx("button",{onClick:a,className:"w-full px-4 py-3 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg font-medium transition-colors",children:"Maybe Later"})]})]})})},BottomNav=({currentView:e,onChange:t})=>jsxRuntimeExports.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-900 border-t border-slate-800 pb-safe",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-around items-center h-16 max-w-md mx-auto",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>t("connections"),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${e==="connections"?"text-amber-500":"text-slate-500 hover:text-slate-400"}`,children:[jsxRuntimeExports.jsx(FilePenLine,{className:"w-6 h-6 mb-1"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:"Connections"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>t("wallet"),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${e==="wallet"?"text-amber-500":"text-slate-500 hover:text-slate-400"}`,children:[jsxRuntimeExports.jsx(Wallet,{className:"w-6 h-6 mb-1"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:"Wallet"})]})]})}),bitcoin$1={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};function check$d(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;const t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return!1;const r=e[5+t];return!(r===0||6+t+r!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||r>1&&e[t+6]===0&&!(e[t+7]&128))}function decode$h(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");const t=e[3];if(t===0)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(e[4+t]!==2)throw new Error("Expected DER integer (2)");const r=e[5+t];if(r===0)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(t>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[t+6]&128)throw new Error("S value is negative");if(r>1&&e[t+6]===0&&!(e[t+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}function encode$j(e,t){const r=e.length,n=t.length;if(r===0)throw new Error("R length is zero");if(n===0)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(n>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(t[0]&128)throw new Error("S value is negative");if(r>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(n>1&&t[0]===0&&!(t[1]&128))throw new Error("S value excessively padded");const o=new Uint8Array(6+r+n);return o[0]=48,o[1]=o.length-2,o[2]=2,o[3]=e.length,o.set(e,4),o[4+r]=2,o[5+r]=t.length,o.set(t,6+r),o}var OPS$7;(function(e){e[e.OP_FALSE=0]="OP_FALSE",e[e.OP_0=0]="OP_0",e[e.OP_PUSHDATA1=76]="OP_PUSHDATA1",e[e.OP_PUSHDATA2=77]="OP_PUSHDATA2",e[e.OP_PUSHDATA4=78]="OP_PUSHDATA4",e[e.OP_1NEGATE=79]="OP_1NEGATE",e[e.OP_RESERVED=80]="OP_RESERVED",e[e.OP_TRUE=81]="OP_TRUE",e[e.OP_1=81]="OP_1",e[e.OP_2=82]="OP_2",e[e.OP_3=83]="OP_3",e[e.OP_4=84]="OP_4",e[e.OP_5=85]="OP_5",e[e.OP_6=86]="OP_6",e[e.OP_7=87]="OP_7",e[e.OP_8=88]="OP_8",e[e.OP_9=89]="OP_9",e[e.OP_10=90]="OP_10",e[e.OP_11=91]="OP_11",e[e.OP_12=92]="OP_12",e[e.OP_13=93]="OP_13",e[e.OP_14=94]="OP_14",e[e.OP_15=95]="OP_15",e[e.OP_16=96]="OP_16",e[e.OP_NOP=97]="OP_NOP",e[e.OP_VER=98]="OP_VER",e[e.OP_IF=99]="OP_IF",e[e.OP_NOTIF=100]="OP_NOTIF",e[e.OP_VERIF=101]="OP_VERIF",e[e.OP_VERNOTIF=102]="OP_VERNOTIF",e[e.OP_ELSE=103]="OP_ELSE",e[e.OP_ENDIF=104]="OP_ENDIF",e[e.OP_VERIFY=105]="OP_VERIFY",e[e.OP_RETURN=106]="OP_RETURN",e[e.OP_TOALTSTACK=107]="OP_TOALTSTACK",e[e.OP_FROMALTSTACK=108]="OP_FROMALTSTACK",e[e.OP_2DROP=109]="OP_2DROP",e[e.OP_2DUP=110]="OP_2DUP",e[e.OP_3DUP=111]="OP_3DUP",e[e.OP_2OVER=112]="OP_2OVER",e[e.OP_2ROT=113]="OP_2ROT",e[e.OP_2SWAP=114]="OP_2SWAP",e[e.OP_IFDUP=115]="OP_IFDUP",e[e.OP_DEPTH=116]="OP_DEPTH",e[e.OP_DROP=117]="OP_DROP",e[e.OP_DUP=118]="OP_DUP",e[e.OP_NIP=119]="OP_NIP",e[e.OP_OVER=120]="OP_OVER",e[e.OP_PICK=121]="OP_PICK",e[e.OP_ROLL=122]="OP_ROLL",e[e.OP_ROT=123]="OP_ROT",e[e.OP_SWAP=124]="OP_SWAP",e[e.OP_TUCK=125]="OP_TUCK",e[e.OP_CAT=126]="OP_CAT",e[e.OP_SUBSTR=127]="OP_SUBSTR",e[e.OP_LEFT=128]="OP_LEFT",e[e.OP_RIGHT=129]="OP_RIGHT",e[e.OP_SIZE=130]="OP_SIZE",e[e.OP_INVERT=131]="OP_INVERT",e[e.OP_AND=132]="OP_AND",e[e.OP_OR=133]="OP_OR",e[e.OP_XOR=134]="OP_XOR",e[e.OP_EQUAL=135]="OP_EQUAL",e[e.OP_EQUALVERIFY=136]="OP_EQUALVERIFY",e[e.OP_RESERVED1=137]="OP_RESERVED1",e[e.OP_RESERVED2=138]="OP_RESERVED2",e[e.OP_1ADD=139]="OP_1ADD",e[e.OP_1SUB=140]="OP_1SUB",e[e.OP_2MUL=141]="OP_2MUL",e[e.OP_2DIV=142]="OP_2DIV",e[e.OP_NEGATE=143]="OP_NEGATE",e[e.OP_ABS=144]="OP_ABS",e[e.OP_NOT=145]="OP_NOT",e[e.OP_0NOTEQUAL=146]="OP_0NOTEQUAL",e[e.OP_ADD=147]="OP_ADD",e[e.OP_SUB=148]="OP_SUB",e[e.OP_MUL=149]="OP_MUL",e[e.OP_DIV=150]="OP_DIV",e[e.OP_MOD=151]="OP_MOD",e[e.OP_LSHIFT=152]="OP_LSHIFT",e[e.OP_RSHIFT=153]="OP_RSHIFT",e[e.OP_BOOLAND=154]="OP_BOOLAND",e[e.OP_BOOLOR=155]="OP_BOOLOR",e[e.OP_NUMEQUAL=156]="OP_NUMEQUAL",e[e.OP_NUMEQUALVERIFY=157]="OP_NUMEQUALVERIFY",e[e.OP_NUMNOTEQUAL=158]="OP_NUMNOTEQUAL",e[e.OP_LESSTHAN=159]="OP_LESSTHAN",e[e.OP_GREATERTHAN=160]="OP_GREATERTHAN",e[e.OP_LESSTHANOREQUAL=161]="OP_LESSTHANOREQUAL",e[e.OP_GREATERTHANOREQUAL=162]="OP_GREATERTHANOREQUAL",e[e.OP_MIN=163]="OP_MIN",e[e.OP_MAX=164]="OP_MAX",e[e.OP_WITHIN=165]="OP_WITHIN",e[e.OP_RIPEMD160=166]="OP_RIPEMD160",e[e.OP_SHA1=167]="OP_SHA1",e[e.OP_SHA256=168]="OP_SHA256",e[e.OP_HASH160=169]="OP_HASH160",e[e.OP_HASH256=170]="OP_HASH256",e[e.OP_CODESEPARATOR=171]="OP_CODESEPARATOR",e[e.OP_CHECKSIG=172]="OP_CHECKSIG",e[e.OP_CHECKSIGVERIFY=173]="OP_CHECKSIGVERIFY",e[e.OP_CHECKMULTISIG=174]="OP_CHECKMULTISIG",e[e.OP_CHECKMULTISIGVERIFY=175]="OP_CHECKMULTISIGVERIFY",e[e.OP_NOP1=176]="OP_NOP1",e[e.OP_CHECKLOCKTIMEVERIFY=177]="OP_CHECKLOCKTIMEVERIFY",e[e.OP_NOP2=177]="OP_NOP2",e[e.OP_CHECKSEQUENCEVERIFY=178]="OP_CHECKSEQUENCEVERIFY",e[e.OP_NOP3=178]="OP_NOP3",e[e.OP_NOP4=179]="OP_NOP4",e[e.OP_NOP5=180]="OP_NOP5",e[e.OP_NOP6=181]="OP_NOP6",e[e.OP_NOP7=182]="OP_NOP7",e[e.OP_NOP8=183]="OP_NOP8",e[e.OP_NOP9=184]="OP_NOP9",e[e.OP_NOP10=185]="OP_NOP10",e[e.OP_CHECKSIGADD=186]="OP_CHECKSIGADD",e[e.OP_PUBKEYHASH=253]="OP_PUBKEYHASH",e[e.OP_PUBKEY=254]="OP_PUBKEY",e[e.OP_INVALIDOPCODE=255]="OP_INVALIDOPCODE"})(OPS$7||(OPS$7={}));const HEX_STRINGS$2="0123456789abcdefABCDEF",HEX_CODES=HEX_STRINGS$2.split("").map(e=>e.codePointAt(0)),HEX_CODEPOINTS=Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=HEX_STRINGS$2.indexOf(r);return n<0?void 0:n<16?n:n-6}),ENCODER=new TextEncoder,DECODER=new TextDecoder;function toUtf8(e){return DECODER.decode(e)}function fromUtf8(e){return ENCODER.encode(e)}function concat$1(e){const t=e.reduce((o,a)=>o+a.length,0),r=new Uint8Array(t);let n=0;for(const o of e)r.set(o,n),n+=o.length;return r}function toHex(e){const t=e||new Uint8Array;return t.length>512?_toHexLengthPerf(t):_toHexIterPerf(t)}function _toHexIterPerf(e){let t="";for(let r=0;r<e.length;++r)t+=HEX_STRINGS$2[HEX_CODEPOINTS[HEX_CODES[e[r]>>4]]],t+=HEX_STRINGS$2[HEX_CODEPOINTS[HEX_CODES[e[r]&15]]];return t}function _toHexLengthPerf(e){const t=new Uint8Array(e.length*2);for(let r=0;r<e.length;++r)t[r*2]=HEX_CODES[e[r]>>4],t[r*2+1]=HEX_CODES[e[r]&15];return DECODER.decode(t)}function fromHex(e){const t=ENCODER.encode(e||""),r=new Uint8Array(Math.floor(t.length/2));let n;for(n=0;n<r.length;n++){const o=HEX_CODEPOINTS[t[n*2]],a=HEX_CODEPOINTS[t[n*2+1]];if(o===void 0||a===void 0)break;r[n]=o<<4|a}return n===r.length?r:r.slice(0,n)}function toBase64(e){return btoa(String.fromCharCode(...e))}function fromBase64(e){const t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}function compare(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return e.length===t.length?0:e.length>t.length?1:-1}function writeUInt8(e,t,r){if(t+1>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r>255)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 255. Received ${r}`);return e[t]=r,t+1}function writeUInt16$1(e,t,r,n){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>65535)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${r}`);return n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255):(e[t]=r>>8&255,e[t+1]=r&255),t+2}function writeUInt32$2(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${r}`);return n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255),t+4}function writeUInt64$1(e,t,r,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>0xffffffffffffffffn)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${r}`);return n==="LE"?(e[t]=Number(r&0xffn),e[t+1]=Number(r>>8n&0xffn),e[t+2]=Number(r>>16n&0xffn),e[t+3]=Number(r>>24n&0xffn),e[t+4]=Number(r>>32n&0xffn),e[t+5]=Number(r>>40n&0xffn),e[t+6]=Number(r>>48n&0xffn),e[t+7]=Number(r>>56n&0xffn)):(e[t]=Number(r>>56n&0xffn),e[t+1]=Number(r>>48n&0xffn),e[t+2]=Number(r>>40n&0xffn),e[t+3]=Number(r>>32n&0xffn),e[t+4]=Number(r>>24n&0xffn),e[t+5]=Number(r>>16n&0xffn),e[t+6]=Number(r>>8n&0xffn),e[t+7]=Number(r&0xffn)),t+8}function readUInt8(e,t){if(t+1>e.length)throw new Error("Offset is outside the bounds of Uint8Array");return e[t]}function readUInt16$1(e,t,r){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+1],n=(n<<8)+e[t],n}else{let n=0;return n=(n<<8)+e[t],n=(n<<8)+e[t+1],n}}function readUInt32$1(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+3]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t]>>>0,n}else{let n=0;return n=(n<<8)+e[t]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+3]>>>0,n}}function writeInt32(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r>2147483647||r<-2147483648)throw new Error(`The value of "value" is out of range. It must be >= -2147483648 and <= 2147483647. Received ${r}`);return n=n.toUpperCase(),n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255),t+4}function writeInt64(e,t,r,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r>0x7fffffffffffffffn||r<-0x8000000000000000n)throw new Error(`The value of "value" is out of range. It must be >= ${-0x8000000000000000n} and <= ${0x7fffffffffffffffn}. Received ${r}`);return n=n.toUpperCase(),n==="LE"?(e[t]=Number(r&0xffn),e[t+1]=Number(r>>8n&0xffn),e[t+2]=Number(r>>16n&0xffn),e[t+3]=Number(r>>24n&0xffn),e[t+4]=Number(r>>32n&0xffn),e[t+5]=Number(r>>40n&0xffn),e[t+6]=Number(r>>48n&0xffn),e[t+7]=Number(r>>56n&0xffn)):(e[t]=Number(r>>56n&0xffn),e[t+1]=Number(r>>48n&0xffn),e[t+2]=Number(r>>40n&0xffn),e[t+3]=Number(r>>32n&0xffn),e[t+4]=Number(r>>24n&0xffn),e[t+5]=Number(r>>16n&0xffn),e[t+6]=Number(r>>8n&0xffn),e[t+7]=Number(r&0xffn)),t+8}function readInt32(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){const n=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24>>>0);return e[t+3]<=127?n:n-4294967296}else{const n=(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];return e[t]<=127?n:n-4294967296}}function readInt64(e,t,r){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");r=r.toUpperCase();let n=0n;if(r==="LE")return n=(n<<8n)+BigInt(e[t+7]),n=(n<<8n)+BigInt(e[t+6]),n=(n<<8n)+BigInt(e[t+5]),n=(n<<8n)+BigInt(e[t+4]),n=(n<<8n)+BigInt(e[t+3]),n=(n<<8n)+BigInt(e[t+2]),n=(n<<8n)+BigInt(e[t+1]),n=(n<<8n)+BigInt(e[t]),e[t+7]<=127?n:n-0x10000000000000000n;{let o=0n;return o=(o<<8n)+BigInt(e[t]),o=(o<<8n)+BigInt(e[t+1]),o=(o<<8n)+BigInt(e[t+2]),o=(o<<8n)+BigInt(e[t+3]),o=(o<<8n)+BigInt(e[t+4]),o=(o<<8n)+BigInt(e[t+5]),o=(o<<8n)+BigInt(e[t+6]),o=(o<<8n)+BigInt(e[t+7]),e[t]<=127?o:o-0x10000000000000000n}}function encodingLength$1(e){return e<OPS$7.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}function encode$i(e,t,r){const n=encodingLength$1(t);return n===1?writeUInt8(e,r,t):n===2?(writeUInt8(e,r,OPS$7.OP_PUSHDATA1),writeUInt8(e,r+1,t)):n===3?(writeUInt8(e,r,OPS$7.OP_PUSHDATA2),writeUInt16$1(e,r+1,t,"LE")):(writeUInt8(e,r,OPS$7.OP_PUSHDATA4),writeUInt32$2(e,r+1,t,"LE")),n}function decode$g(e,t){const r=readUInt8(e,t);let n,o;if(r<OPS$7.OP_PUSHDATA1)n=r,o=1;else if(r===OPS$7.OP_PUSHDATA1){if(t+2>e.length)return null;n=readUInt8(e,t+1),o=2}else if(r===OPS$7.OP_PUSHDATA2){if(t+3>e.length)return null;n=readUInt16$1(e,t+1,"LE"),o=3}else{if(t+5>e.length)return null;if(r!==OPS$7.OP_PUSHDATA4)throw new Error("Unexpected opcode");n=readUInt32$1(e,t+1,"LE"),o=5}return{opcode:r,number:n,size:o}}function scriptNumSize(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function encode$h(e){let t=Math.abs(e);const r=scriptNumSize(t),n=new Uint8Array(r),o=e<0;for(let a=0;a<r;++a)writeUInt8(n,a,t&255),t>>=8;return n[r-1]&128?writeUInt8(n,r-1,o?128:0):o&&(n[r-1]|=128),n}var store$1;function getGlobalConfig$1(e){return{lang:e?.lang??store$1?.lang,message:e?.message,abortEarly:e?.abortEarly??store$1?.abortEarly,abortPipeEarly:e?.abortPipeEarly??store$1?.abortPipeEarly}}var store2$1;function getGlobalMessage$1(e){return store2$1?.get(e)}var store3$1;function getSchemaMessage$1(e){return store3$1?.get(e)}var store4$1;function getSpecificMessage$1(e,t){return store4$1?.get(e)?.get(t)}function _stringify$1(e){const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function _addIssue$1(e,t,r,n,o){const a=o&&"input"in o?o.input:r.value,l=o?.expected??e.expects??null,u=o?.received??_stringify$1(a),f={kind:e.kind,type:e.type,input:a,expected:l,received:u,message:`Invalid ${t}: ${l?`Expected ${l} but r`:"R"}eceived ${u}`,requirement:e.requirement,path:o?.path,issues:o?.issues,lang:n.lang,abortEarly:n.abortEarly,abortPipeEarly:n.abortPipeEarly},x=e.kind==="schema",p=o?.message??e.message??getSpecificMessage$1(e.reference,f.lang)??(x?getSchemaMessage$1(f.lang):null)??n.message??getGlobalMessage$1(f.lang);p&&(f.message=typeof p=="function"?p(f):p),x&&(r.typed=!1),r.issues?r.issues.push(f):r.issues=[f]}function _joinExpects(e,t){const r=[...new Set(e)];return r.length>1?`(${r.join(` ${t} `)})`:r[0]??"never"}var ValiError$1=class extends Error{issues;constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function everyItem(e,t){return{kind:"validation",type:"every_item",reference:everyItem,async:!1,expects:null,requirement:e,message:t,_run(r,n){return r.typed&&!r.value.every(this.requirement)&&_addIssue$1(this,"item",r,n),r}}}function integer$1(e){return{kind:"validation",type:"integer",reference:integer$1,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(t,r){return t.typed&&!this.requirement(t.value)&&_addIssue$1(this,"integer",t,r),t}}}function length$1(e,t){return{kind:"validation",type:"length",reference:length$1,async:!1,expects:`${e}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value.length!==this.requirement&&_addIssue$1(this,"length",r,n,{received:`${r.value.length}`}),r}}}function maxValue$1(e,t){return{kind:"validation",type:"max_value",reference:maxValue$1,async:!1,expects:`<=${e instanceof Date?e.toJSON():_stringify$1(e)}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value>this.requirement&&_addIssue$1(this,"value",r,n,{received:r.value instanceof Date?r.value.toJSON():_stringify$1(r.value)}),r}}}function minValue$1(e,t){return{kind:"validation",type:"min_value",reference:minValue$1,async:!1,expects:`>=${e instanceof Date?e.toJSON():_stringify$1(e)}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value<this.requirement&&_addIssue$1(this,"value",r,n,{received:r.value instanceof Date?r.value.toJSON():_stringify$1(r.value)}),r}}}function regex$1(e,t){return{kind:"validation",type:"regex",reference:regex$1,async:!1,expects:`${e}`,requirement:e,message:t,_run(r,n){return r.typed&&!this.requirement.test(r.value)&&_addIssue$1(this,"format",r,n),r}}}function getDefault$1(e,t,r){return typeof e.default=="function"?e.default(t,r):e.default}function is(e,t){return!e._run({typed:!1,value:t},{abortEarly:!0}).issues}function any(){return{kind:"schema",type:"any",reference:any,expects:"any",async:!1,_run(e){return e.typed=!0,e}}}function array(e,t){return{kind:"schema",type:"array",reference:array,expects:"Array",async:!1,item:e,message:t,_run(r,n){const o=r.value;if(Array.isArray(o)){r.typed=!0,r.value=[];for(let a=0;a<o.length;a++){const l=o[a],u=this.item._run({typed:!1,value:l},n);if(u.issues){const f={type:"array",origin:"value",input:o,key:a,value:l};for(const x of u.issues)x.path?x.path.unshift(f):x.path=[f],r.issues?.push(x);if(r.issues||(r.issues=u.issues),n.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),r.value.push(u.value)}}else _addIssue$1(this,"type",r,n);return r}}}function bigint(e){return{kind:"schema",type:"bigint",reference:bigint,expects:"bigint",async:!1,message:e,_run(t,r){return typeof t.value=="bigint"?t.typed=!0:_addIssue$1(this,"type",t,r),t}}}function custom(e,t){return{kind:"schema",type:"custom",reference:custom,expects:"unknown",async:!1,check:e,message:t,_run(r,n){return this.check(r.value)?r.typed=!0:_addIssue$1(this,"type",r,n),r}}}function instance$1(e,t){return{kind:"schema",type:"instance",reference:instance$1,expects:e.name,async:!1,class:e,message:t,_run(r,n){return r.value instanceof this.class?r.typed=!0:_addIssue$1(this,"type",r,n),r}}}function nullable(e,...t){const r={kind:"schema",type:"nullable",reference:nullable,expects:`(${e.expects} | null)`,async:!1,wrapped:e,_run(n,o){return n.value===null&&("default"in this&&(n.value=getDefault$1(this,n,o)),n.value===null)?(n.typed=!0,n):this.wrapped._run(n,o)}};return 0 in t&&(r.default=t[0]),r}function nullish(e,...t){const r={kind:"schema",type:"nullish",reference:nullish,expects:`(${e.expects} | null | undefined)`,async:!1,wrapped:e,_run(n,o){return(n.value===null||n.value===void 0)&&("default"in this&&(n.value=getDefault$1(this,n,o)),n.value===null||n.value===void 0)?(n.typed=!0,n):this.wrapped._run(n,o)}};return 0 in t&&(r.default=t[0]),r}function number$1(e){return{kind:"schema",type:"number",reference:number$1,expects:"number",async:!1,message:e,_run(t,r){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:_addIssue$1(this,"type",t,r),t}}}function object$1(e,t){return{kind:"schema",type:"object",reference:object$1,expects:"Object",async:!1,entries:e,message:t,_run(r,n){const o=r.value;if(o&&typeof o=="object"){r.typed=!0,r.value={};for(const a in this.entries){const l=o[a],u=this.entries[a]._run({typed:!1,value:l},n);if(u.issues){const f={type:"object",origin:"value",input:o,key:a,value:l};for(const x of u.issues)x.path?x.path.unshift(f):x.path=[f],r.issues?.push(x);if(r.issues||(r.issues=u.issues),n.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),(u.value!==void 0||a in o)&&(r.value[a]=u.value)}}else _addIssue$1(this,"type",r,n);return r}}}function optional$1(e,...t){const r={kind:"schema",type:"optional",reference:optional$1,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,_run(n,o){return n.value===void 0&&("default"in this&&(n.value=getDefault$1(this,n,o)),n.value===void 0)?(n.typed=!0,n):this.wrapped._run(n,o)}};return 0 in t&&(r.default=t[0]),r}function string$1(e){return{kind:"schema",type:"string",reference:string$1,expects:"string",async:!1,message:e,_run(t,r){return typeof t.value=="string"?t.typed=!0:_addIssue$1(this,"type",t,r),t}}}function tuple(e,t){return{kind:"schema",type:"tuple",reference:tuple,expects:"Array",async:!1,items:e,message:t,_run(r,n){const o=r.value;if(Array.isArray(o)){r.typed=!0,r.value=[];for(let a=0;a<this.items.length;a++){const l=o[a],u=this.items[a]._run({typed:!1,value:l},n);if(u.issues){const f={type:"array",origin:"value",input:o,key:a,value:l};for(const x of u.issues)x.path?x.path.unshift(f):x.path=[f],r.issues?.push(x);if(r.issues||(r.issues=u.issues),n.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),r.value.push(u.value)}}else _addIssue$1(this,"type",r,n);return r}}}function _subIssues$1(e){let t;if(e)for(const r of e)t?t.push(...r.issues):t=r.issues;return t}function union$1(e,t){return{kind:"schema",type:"union",reference:union$1,expects:_joinExpects(e.map(r=>r.expects),"|"),async:!1,options:e,message:t,_run(r,n){let o,a,l;for(const u of this.options){const f=u._run({typed:!1,value:r.value},n);if(f.typed)if(f.issues)a?a.push(f):a=[f];else{o=f;break}else l?l.push(f):l=[f]}if(o)return o;if(a){if(a.length===1)return a[0];_addIssue$1(this,"type",r,n,{issues:_subIssues$1(a)}),r.typed=!0}else{if(l?.length===1)return l[0];_addIssue$1(this,"type",r,n,{issues:_subIssues$1(l)})}return r}}}function parse$1(e,t,r){const n=e._run({typed:!1,value:t},getGlobalConfig$1(r));if(n.issues)throw new ValiError$1(n.issues);return n.value}function partial(e,t){const r={};for(const n in e.entries)r[n]=optional$1(e.entries[n]);return{...e,entries:r}}function pipe$1(...e){return{...e[0],pipe:e,_run(t,r){for(const n of e)if(n.kind!=="metadata"){if(t.issues&&(n.kind==="schema"||n.kind==="transformation")){t.typed=!1;break}(!t.issues||!r.abortEarly&&!r.abortPipeEarly)&&(t=n._run(t,r))}return t}}}const ZERO32=new Uint8Array(32),EC_P=fromHex("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),NBufferSchemaFactory=e=>pipe$1(instance$1(Uint8Array),length$1(e));function stacksEqual(e,t){return e.length!==t.length?!1:e.every((r,n)=>compare(r,t[n])===0)}function isPoint(e){if(!(e instanceof Uint8Array)||e.length<33)return!1;const t=e[0],r=e.slice(1,33);if(compare(ZERO32,r)===0||compare(r,EC_P)>=0)return!1;if((t===2||t===3)&&e.length===33)return!0;const n=e.slice(33);return compare(ZERO32,n)===0||compare(n,EC_P)>=0?!1:t===4&&e.length===65}const TAPLEAF_VERSION_MASK=254;function isTapleaf(e){return!e||!("output"in e)||!(e.output instanceof Uint8Array)?!1:e.version!==void 0?(e.version&TAPLEAF_VERSION_MASK)===e.version:!0}function isTaptree(e){return Array.isArray(e)?e.length!==2?!1:e.every(t=>isTaptree(t)):isTapleaf(e)}const Buffer256bitSchema=NBufferSchemaFactory(32),Hash160bitSchema=NBufferSchemaFactory(20),Hash256bitSchema=NBufferSchemaFactory(32),BufferSchema=instance$1(Uint8Array);pipe$1(string$1(),regex$1(/^([0-9a-f]{2})+$/i));const UInt8Schema=pipe$1(number$1(),integer$1(),minValue$1(0),maxValue$1(255)),UInt32Schema=pipe$1(number$1(),integer$1(),minValue$1(0),maxValue$1(4294967295)),SatoshiSchema=pipe$1(bigint(),minValue$1(0n),maxValue$1(0x7fffffffffffffffn)),NullablePartial=e=>object$1(Object.entries(e).reduce((t,r)=>({...t,[r[0]]:nullish(r[1])}),{})),ZERO$1=new Uint8Array(1);function toDER(e){let t=0;for(;e[t]===0;)++t;return t===e.length?ZERO$1:(e=e.slice(t),e[0]&128?concat$1([ZERO$1,e]):e)}function fromDER(e){e[0]===0&&(e=e.slice(1));const t=new Uint8Array(32),r=Math.max(0,32-e.length);return t.set(e,r),t}function decode$f(e){const t=readUInt8(e,e.length-1);if(!isDefinedHashType(t))throw new Error("Invalid hashType "+t);const r=decode$h(e.subarray(0,-1)),n=fromDER(r.r),o=fromDER(r.s);return{signature:concat$1([n,o]),hashType:t}}function encode$g(e,t){if(parse$1(object$1({signature:NBufferSchemaFactory(64),hashType:UInt8Schema}),{signature:e,hashType:t}),!isDefinedHashType(t))throw new Error("Invalid hashType "+t);const r=new Uint8Array(1);writeUInt8(r,0,t);const n=toDER(e.slice(0,32)),o=toDER(e.slice(32,64));return concat$1([encode$j(n,o),r])}const scriptSignature=Object.freeze(Object.defineProperty({__proto__:null,decode:decode$f,encode:encode$g},Symbol.toStringTag,{value:"Module"})),OP_INT_BASE$1=OPS$7.OP_RESERVED,StackSchema=array(union$1([instance$1(Uint8Array),number$1()]));function isOPInt(e){return is(number$1(),e)&&(e===OPS$7.OP_0||e>=OPS$7.OP_1&&e<=OPS$7.OP_16||e===OPS$7.OP_1NEGATE)}function isPushOnlyChunk(e){return is(BufferSchema,e)||isOPInt(e)}function isPushOnly(e){return is(pipe$1(any(),everyItem(isPushOnlyChunk)),e)}function countNonPushOnlyOPs(e){return e.length-e.filter(isPushOnlyChunk).length}function asMinimalOP(e){if(e.length===0)return OPS$7.OP_0;if(e.length===1){if(e[0]>=1&&e[0]<=16)return OP_INT_BASE$1+e[0];if(e[0]===129)return OPS$7.OP_1NEGATE}}function chunksIsBuffer(e){return e instanceof Uint8Array}function chunksIsArray(e){return is(StackSchema,e)}function singleChunkIsBuffer(e){return e instanceof Uint8Array}function compile(e){if(chunksIsBuffer(e))return e;parse$1(StackSchema,e);const t=e.reduce((o,a)=>singleChunkIsBuffer(a)?a.length===1&&asMinimalOP(a)!==void 0?o+1:o+encodingLength$1(a.length)+a.length:o+1,0),r=new Uint8Array(t);let n=0;if(e.forEach(o=>{if(singleChunkIsBuffer(o)){const a=asMinimalOP(o);if(a!==void 0){writeUInt8(r,n,a),n+=1;return}n+=encode$i(r,o.length,n),r.set(o,n),n+=o.length}else writeUInt8(r,n,o),n+=1}),n!==r.length)throw new Error("Could not decode chunks");return r}function decompile(e){if(chunksIsArray(e))return e;parse$1(BufferSchema,e);const t=[];let r=0;for(;r<e.length;){const n=e[r];if(n>OPS$7.OP_0&&n<=OPS$7.OP_PUSHDATA4){const o=decode$g(e,r);if(o===null||(r+=o.size,r+o.number>e.length))return null;const a=e.slice(r,r+o.number);r+=o.number;const l=asMinimalOP(a);l!==void 0?t.push(l):t.push(a)}else t.push(n),r+=1}return t}function toASM(e){if(chunksIsBuffer(e)&&(e=decompile(e)),!e)throw new Error("Could not convert invalid chunks to ASM");return e.map(t=>{if(singleChunkIsBuffer(t)){const r=asMinimalOP(t);if(r===void 0)return toHex(t);t=r}return OPS$7[t]}).join(" ")}function toStack(e){return e=decompile(e),parse$1(custom(isPushOnly),e),e.map(t=>singleChunkIsBuffer(t)?t:t===OPS$7.OP_0?new Uint8Array(0):encode$h(t-OP_INT_BASE$1))}function isCanonicalPubKey(e){return isPoint(e)}function isDefinedHashType(e){const t=e&-129;return t>0&&t<4}function isCanonicalScriptSignature(e){return!(e instanceof Uint8Array)||!isDefinedHashType(e[e.length-1])?!1:check$d(e.slice(0,-1))}const signature=scriptSignature;function prop(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){const n=r.call(this);return this[t]=n,n},set(n){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:n,writable:!0})}})}function value(e){let t;return()=>(t!==void 0||(t=e()),t)}const OPS$6=OPS$7,OP_INT_BASE=OPS$6.OP_RESERVED;function p2ms(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&e.m!==void 0)&&!e.signatures)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{});function r(f){return isCanonicalScriptSignature(f)||(t.allowIncomplete&&f===OPS$6.OP_0)!==void 0}parse$1(partial(object$1({network:object$1({}),m:number$1(),n:number$1(),output:BufferSchema,pubkeys:array(custom(isPoint),"Received invalid pubkey"),signatures:array(custom(r),"Expected signature to be of type isAcceptableSignature"),input:BufferSchema})),e);const o={network:e.network||bitcoin$1};let a=[],l=!1;function u(f){l||(l=!0,a=decompile(f),o.m=a[0]-OP_INT_BASE,o.n=a[a.length-2]-OP_INT_BASE,o.pubkeys=a.slice(1,-2))}if(prop(o,"output",()=>{if(e.m&&o.n&&e.pubkeys)return compile([].concat(OP_INT_BASE+e.m,e.pubkeys,OP_INT_BASE+o.n,OPS$6.OP_CHECKMULTISIG))}),prop(o,"m",()=>{if(o.output)return u(o.output),o.m}),prop(o,"n",()=>{if(o.pubkeys)return o.pubkeys.length}),prop(o,"pubkeys",()=>{if(e.output)return u(e.output),o.pubkeys}),prop(o,"signatures",()=>{if(e.input)return decompile(e.input).slice(1)}),prop(o,"input",()=>{if(e.signatures)return compile([OPS$6.OP_0].concat(e.signatures))}),prop(o,"witness",()=>{if(o.input)return[]}),prop(o,"name",()=>{if(!(!o.m||!o.n))return`p2ms(${o.m} of ${o.n})`}),t.validate){if(e.output){if(u(e.output),parse$1(number$1(),a[0],{message:"Output is invalid"}),parse$1(number$1(),a[a.length-2],{message:"Output is invalid"}),a[a.length-1]!==OPS$6.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(o.m<=0||o.n>16||o.m>o.n||o.n!==a.length-3)throw new TypeError("Output is invalid");if(!o.pubkeys.every(f=>isPoint(f)))throw new TypeError("Output is invalid");if(e.m!==void 0&&e.m!==o.m)throw new TypeError("m mismatch");if(e.n!==void 0&&e.n!==o.n)throw new TypeError("n mismatch");if(e.pubkeys&&!stacksEqual(e.pubkeys,o.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(e.n!==void 0&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(o.n=e.pubkeys.length,o.n<o.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<o.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>o.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==OPS$6.OP_0)throw new TypeError("Input is invalid");if(o.signatures.length===0||!o.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!stacksEqual(e.signatures,o.signatures))throw new TypeError("Signature mismatch");if(e.m!==void 0&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(o,e)}const OPS$5=OPS$7;function p2pk(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),output:BufferSchema,pubkey:custom(isPoint,"invalid pubkey"),signature:custom(isCanonicalScriptSignature,"Expected signature to be of type isCanonicalScriptSignature"),input:BufferSchema})),e);const r=value(()=>decompile(e.input)),o={name:"p2pk",network:e.network||bitcoin$1};if(prop(o,"output",()=>{if(e.pubkey)return compile([e.pubkey,OPS$5.OP_CHECKSIG])}),prop(o,"pubkey",()=>{if(e.output)return e.output.slice(1,-1)}),prop(o,"signature",()=>{if(e.input)return r()[0]}),prop(o,"input",()=>{if(e.signature)return compile([e.signature])}),prop(o,"witness",()=>{if(o.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==OPS$5.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!isPoint(o.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&compare(e.pubkey,o.pubkey)!==0)throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&compare(e.input,o.input)!==0)throw new TypeError("Signature mismatch");if(e.input){if(r().length!==1)throw new TypeError("Input is invalid");if(!isCanonicalScriptSignature(o.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(o,e)}const Rho160=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Id160=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),Pi160=Id160.map(e=>(9*e+5)%16),idxLR=(()=>{const r=[[Id160],[Pi160]];for(let n=0;n<4;n++)for(let o of r)o.push(o[n].map(a=>Rho160[a]));return r})(),idxL=idxLR[0],idxR=idxLR[1],shifts160=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),shiftsL160=idxL.map((e,t)=>e.map(r=>shifts160[t][r])),shiftsR160=idxR.map((e,t)=>e.map(r=>shifts160[t][r])),Kl160=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Kr160=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ripemd_f(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}const BUF_160=new Uint32Array(16);class RIPEMD160 extends HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:r,h2:n,h3:o,h4:a}=this;return[t,r,n,o,a]}set(t,r,n,o,a){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=o|0,this.h4=a|0}process(t,r){for(let b=0;b<16;b++,r+=4)BUF_160[b]=t.getUint32(r,!0);let n=this.h0|0,o=n,a=this.h1|0,l=a,u=this.h2|0,f=u,x=this.h3|0,p=x,g=this.h4|0,y=g;for(let b=0;b<5;b++){const w=4-b,v=Kl160[b],B=Kr160[b],j=idxL[b],F=idxR[b],C=shiftsL160[b],N=shiftsR160[b];for(let T=0;T<16;T++){const _=rotl$1(n+ripemd_f(b,a,u,x)+BUF_160[j[T]]+v,C[T])+g|0;n=g,g=x,x=rotl$1(u,10)|0,u=a,a=_}for(let T=0;T<16;T++){const _=rotl$1(o+ripemd_f(w,l,f,p)+BUF_160[F[T]]+B,N[T])+y|0;o=y,y=p,p=rotl$1(f,10)|0,f=l,l=_}}this.set(this.h1+u+p|0,this.h2+x+y|0,this.h3+g+o|0,this.h4+n+l|0,this.h0+a+f|0)}roundClean(){clean(BUF_160)}destroy(){this.destroyed=!0,clean(this.buffer),this.set(0,0,0,0,0)}}const ripemd160$1=createHasher(()=>new RIPEMD160),ripemd160=ripemd160$1;function hash160(e){return ripemd160(sha256(e))}function hash256(e){return sha256(sha256(e))}const TAGGED_HASH_PREFIXES={"BIP0340/challenge":Uint8Array.from([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":Uint8Array.from([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":Uint8Array.from([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:Uint8Array.from([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:Uint8Array.from([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:Uint8Array.from([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:Uint8Array.from([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":Uint8Array.from([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":Uint8Array.from([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])};function taggedHash(e,t){return sha256(concat$1([TAGGED_HASH_PREFIXES[e],t]))}function base(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let x=0;x<t.length;x++)t[x]=255;for(let x=0;x<e.length;x++){const p=e.charAt(x),g=p.charCodeAt(0);if(t[g]!==255)throw new TypeError(p+" is ambiguous");t[g]=x}const r=e.length,n=e.charAt(0),o=Math.log(r)/Math.log(256),a=Math.log(256)/Math.log(r);function l(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";let p=0,g=0,y=0;const b=x.length;for(;y!==b&&x[y]===0;)y++,p++;const w=(b-y)*a+1>>>0,v=new Uint8Array(w);for(;y!==b;){let F=x[y],C=0;for(let N=w-1;(F!==0||C<g)&&N!==-1;N--,C++)F+=256*v[N]>>>0,v[N]=F%r>>>0,F=F/r>>>0;if(F!==0)throw new Error("Non-zero carry");g=C,y++}let B=w-g;for(;B!==w&&v[B]===0;)B++;let j=n.repeat(p);for(;B<w;++B)j+=e.charAt(v[B]);return j}function u(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;let p=0,g=0,y=0;for(;x[p]===n;)g++,p++;const b=(x.length-p)*o+1>>>0,w=new Uint8Array(b);for(;p<x.length;){const F=x.charCodeAt(p);if(F>255)return;let C=t[F];if(C===255)return;let N=0;for(let T=b-1;(C!==0||N<y)&&T!==-1;T--,N++)C+=r*w[T]>>>0,w[T]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");y=N,p++}let v=b-y;for(;v!==b&&w[v]===0;)v++;const B=new Uint8Array(g+(b-v));let j=g;for(;v!==b;)B[j++]=w[v++];return B}function f(x){const p=u(x);if(p)return p;throw new Error("Non-base"+r+" character")}return{encode:l,decodeUnsafe:u,decode:f}}var ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const base58=base(ALPHABET);function bs58checkBase(e){function t(a){var l=Uint8Array.from(a),u=e(l),f=l.length+4,x=new Uint8Array(f);return x.set(l,0),x.set(u.subarray(0,4),l.length),base58.encode(x)}function r(a){var l=a.slice(0,-4),u=a.slice(-4),f=e(l);if(!(u[0]^f[0]|u[1]^f[1]|u[2]^f[2]|u[3]^f[3]))return l}function n(a){var l=base58.decodeUnsafe(a);if(l!=null)return r(l)}function o(a){var l=base58.decode(a),u=r(l);if(u==null)throw new Error("Invalid checksum");return u}return{encode:t,decode:o,decodeUnsafe:n}}function sha256x2(e){return sha256(sha256(e))}const bs58Check=bs58checkBase(sha256x2),OPS$4=OPS$7;function p2pkh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),address:string$1(),hash:Hash160bitSchema,output:NBufferSchemaFactory(25),pubkey:custom(isPoint),signature:custom(isCanonicalScriptSignature),input:BufferSchema})),e);const r=value(()=>{const l=bs58Check.decode(e.address),u=readUInt8(l,0),f=l.slice(1);return{version:u,hash:f}}),n=value(()=>decompile(e.input)),o=e.network||bitcoin$1,a={name:"p2pkh",network:o};if(prop(a,"address",()=>{if(!a.hash)return;const l=new Uint8Array(21);return writeUInt8(l,0,o.pubKeyHash),l.set(a.hash,1),bs58Check.encode(l)}),prop(a,"hash",()=>{if(e.output)return e.output.slice(3,23);if(e.address)return r().hash;if(e.pubkey||a.pubkey)return hash160(e.pubkey||a.pubkey)}),prop(a,"output",()=>{if(a.hash)return compile([OPS$4.OP_DUP,OPS$4.OP_HASH160,a.hash,OPS$4.OP_EQUALVERIFY,OPS$4.OP_CHECKSIG])}),prop(a,"pubkey",()=>{if(e.input)return n()[1]}),prop(a,"signature",()=>{if(e.input)return n()[0]}),prop(a,"input",()=>{if(e.pubkey&&e.signature)return compile([e.signature,e.pubkey])}),prop(a,"witness",()=>{if(a.input)return[]}),t.validate){let l=Uint8Array.from([]);if(e.address){if(r().version!==o.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(r().hash.length!==20)throw new TypeError("Invalid address");l=r().hash}if(e.hash){if(l.length>0&&compare(l,e.hash)!==0)throw new TypeError("Hash mismatch");l=e.hash}if(e.output){if(e.output.length!==25||e.output[0]!==OPS$4.OP_DUP||e.output[1]!==OPS$4.OP_HASH160||e.output[2]!==20||e.output[23]!==OPS$4.OP_EQUALVERIFY||e.output[24]!==OPS$4.OP_CHECKSIG)throw new TypeError("Output is invalid");const u=e.output.slice(3,23);if(l.length>0&&compare(l,u)!==0)throw new TypeError("Hash mismatch");l=u}if(e.pubkey){const u=hash160(e.pubkey);if(l.length>0&&compare(l,u)!==0)throw new TypeError("Hash mismatch");l=u}if(e.input){const u=n();if(u.length!==2)throw new TypeError("Input is invalid");if(!isCanonicalScriptSignature(u[0]))throw new TypeError("Input has invalid signature");if(!isPoint(u[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&compare(e.signature,u[0])!==0)throw new TypeError("Signature mismatch");if(e.pubkey&&compare(e.pubkey,u[1])!==0)throw new TypeError("Pubkey mismatch");const f=hash160(u[1]);if(l.length>0&&compare(l,f)!==0)throw new TypeError("Hash mismatch")}}return Object.assign(a,e)}const OPS$3=OPS$7;function p2sh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({network:object$1({}),address:string$1(),hash:NBufferSchemaFactory(20),output:NBufferSchemaFactory(23),redeem:partial(object$1({network:object$1({}),output:BufferSchema,input:BufferSchema,witness:array(BufferSchema)})),input:BufferSchema,witness:array(BufferSchema)})),e);let r=e.network;r||(r=e.redeem&&e.redeem.network||bitcoin$1);const n={network:r},o=value(()=>{const u=bs58Check.decode(e.address),f=readUInt8(u,0),x=u.slice(1);return{version:f,hash:x}}),a=value(()=>decompile(e.input)),l=value(()=>{const u=a(),f=u[u.length-1];return{network:r,output:f===OPS$3.OP_FALSE?Uint8Array.from([]):f,input:compile(u.slice(0,-1)),witness:e.witness||[]}});if(prop(n,"address",()=>{if(!n.hash)return;const u=new Uint8Array(21);return writeUInt8(u,0,n.network.scriptHash),u.set(n.hash,1),bs58Check.encode(u)}),prop(n,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return o().hash;if(n.redeem&&n.redeem.output)return hash160(n.redeem.output)}),prop(n,"output",()=>{if(n.hash)return compile([OPS$3.OP_HASH160,n.hash,OPS$3.OP_EQUAL])}),prop(n,"redeem",()=>{if(e.input)return l()}),prop(n,"input",()=>{if(!(!e.redeem||!e.redeem.input||!e.redeem.output))return compile([].concat(decompile(e.redeem.input),e.redeem.output))}),prop(n,"witness",()=>{if(n.redeem&&n.redeem.witness)return n.redeem.witness;if(n.input)return[]}),prop(n,"name",()=>{const u=["p2sh"];return n.redeem!==void 0&&n.redeem.name!==void 0&&u.push(n.redeem.name),u.join("-")}),t.validate){let u=Uint8Array.from([]);if(e.address){if(o().version!==r.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(o().hash.length!==20)throw new TypeError("Invalid address");u=o().hash}if(e.hash){if(u.length>0&&compare(u,e.hash)!==0)throw new TypeError("Hash mismatch");u=e.hash}if(e.output){if(e.output.length!==23||e.output[0]!==OPS$3.OP_HASH160||e.output[1]!==20||e.output[22]!==OPS$3.OP_EQUAL)throw new TypeError("Output is invalid");const x=e.output.slice(2,22);if(u.length>0&&compare(u,x)!==0)throw new TypeError("Hash mismatch");u=x}const f=x=>{if(x.output){const p=decompile(x.output);if(!p||p.length<1)throw new TypeError("Redeem.output too short");if(x.output.byteLength>520)throw new TypeError("Redeem.output unspendable if larger than 520 bytes");if(countNonPushOnlyOPs(p)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const g=hash160(x.output);if(u.length>0&&compare(u,g)!==0)throw new TypeError("Hash mismatch");u=g}if(x.input){const p=x.input.length>0,g=x.witness&&x.witness.length>0;if(!p&&!g)throw new TypeError("Empty input");if(p&&g)throw new TypeError("Input and witness provided");if(p){const y=decompile(x.input);if(!isPushOnly(y))throw new TypeError("Non push-only scriptSig")}}};if(e.input){const x=a();if(!x||x.length<1)throw new TypeError("Input too short");if(!(l().output instanceof Uint8Array))throw new TypeError("Input is invalid");f(l())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==r)throw new TypeError("Network mismatch");if(e.input){const x=l();if(e.redeem.output&&compare(e.redeem.output,x.output)!==0)throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&compare(e.redeem.input,x.input)!==0)throw new TypeError("Redeem.input mismatch")}f(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!stacksEqual(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(n,e)}var dist$1={},hasRequiredDist$1;function requireDist$1(){if(hasRequiredDist$1)return dist$1;hasRequiredDist$1=1,Object.defineProperty(dist$1,"__esModule",{value:!0}),dist$1.bech32m=dist$1.bech32=void 0;const e="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={};for(let x=0;x<e.length;x++){const p=e.charAt(x);t[p]=x}function r(x){const p=x>>25;return(x&33554431)<<5^-(p>>0&1)&996825010^-(p>>1&1)&642813549^-(p>>2&1)&513874426^-(p>>3&1)&1027748829^-(p>>4&1)&705979059}function n(x){let p=1;for(let g=0;g<x.length;++g){const y=x.charCodeAt(g);if(y<33||y>126)return"Invalid prefix ("+x+")";p=r(p)^y>>5}p=r(p);for(let g=0;g<x.length;++g){const y=x.charCodeAt(g);p=r(p)^y&31}return p}function o(x,p,g,y){let b=0,w=0;const v=(1<<g)-1,B=[];for(let j=0;j<x.length;++j)for(b=b<<p|x[j],w+=p;w>=g;)w-=g,B.push(b>>w&v);if(y)w>0&&B.push(b<<g-w&v);else{if(w>=p)return"Excess padding";if(b<<g-w&v)return"Non-zero padding"}return B}function a(x){return o(x,8,5,!0)}function l(x){const p=o(x,5,8,!1);if(Array.isArray(p))return p}function u(x){const p=o(x,5,8,!1);if(Array.isArray(p))return p;throw new Error(p)}function f(x){let p;x==="bech32"?p=1:p=734539939;function g(v,B,j){if(j=j||90,v.length+7+B.length>j)throw new TypeError("Exceeds length limit");v=v.toLowerCase();let F=n(v);if(typeof F=="string")throw new Error(F);let C=v+"1";for(let N=0;N<B.length;++N){const T=B[N];if(T>>5!==0)throw new Error("Non 5-bit word");F=r(F)^T,C+=e.charAt(T)}for(let N=0;N<6;++N)F=r(F);F^=p;for(let N=0;N<6;++N){const T=F>>(5-N)*5&31;C+=e.charAt(T)}return C}function y(v,B){if(B=B||90,v.length<8)return v+" too short";if(v.length>B)return"Exceeds length limit";const j=v.toLowerCase(),F=v.toUpperCase();if(v!==j&&v!==F)return"Mixed-case string "+v;v=j;const C=v.lastIndexOf("1");if(C===-1)return"No separator character for "+v;if(C===0)return"Missing prefix for "+v;const N=v.slice(0,C),T=v.slice(C+1);if(T.length<6)return"Data too short";let _=n(N);if(typeof _=="string")return _;const S=[];for(let O=0;O<T.length;++O){const $=T.charAt(O),z=t[$];if(z===void 0)return"Unknown character "+$;_=r(_)^z,!(O+6>=T.length)&&S.push(z)}return _!==p?"Invalid checksum for "+v:{prefix:N,words:S}}function b(v,B){const j=y(v,B);if(typeof j=="object")return j}function w(v,B){const j=y(v,B);if(typeof j=="object")return j;throw new Error(j)}return{decodeUnsafe:b,decode:w,encode:g,toWords:a,fromWordsUnsafe:l,fromWords:u}}return dist$1.bech32=f("bech32"),dist$1.bech32m=f("bech32m"),dist$1}var distExports$1=requireDist$1();const OPS$2=OPS$7,EMPTY_BUFFER$2=new Uint8Array(0);function p2wpkh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({address:string$1(),hash:NBufferSchemaFactory(20),input:NBufferSchemaFactory(0),network:object$1({}),output:NBufferSchemaFactory(22),pubkey:custom(isPoint,"Not a valid pubkey"),signature:custom(isCanonicalScriptSignature),witness:array(BufferSchema)})),e);const r=value(()=>{const a=distExports$1.bech32.decode(e.address),l=a.words.shift(),u=distExports$1.bech32.fromWords(a.words);return{version:l,prefix:a.prefix,data:Uint8Array.from(u)}}),n=e.network||bitcoin$1,o={name:"p2wpkh",network:n};if(prop(o,"address",()=>{if(!o.hash)return;const a=distExports$1.bech32.toWords(o.hash);return a.unshift(0),distExports$1.bech32.encode(n.bech32,a)}),prop(o,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return r().data;if(e.pubkey||o.pubkey)return hash160(e.pubkey||o.pubkey)}),prop(o,"output",()=>{if(o.hash)return compile([OPS$2.OP_0,o.hash])}),prop(o,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.witness)return e.witness[1]}),prop(o,"signature",()=>{if(e.witness)return e.witness[0]}),prop(o,"input",()=>{if(o.witness)return EMPTY_BUFFER$2}),prop(o,"witness",()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]}),t.validate){let a=Uint8Array.from([]);if(e.address){if(n&&n.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==20)throw new TypeError("Invalid address data");a=r().data}if(e.hash){if(a.length>0&&compare(a,e.hash)!==0)throw new TypeError("Hash mismatch");a=e.hash}if(e.output){if(e.output.length!==22||e.output[0]!==OPS$2.OP_0||e.output[1]!==20)throw new TypeError("Output is invalid");if(a.length>0&&compare(a,e.output.slice(2))!==0)throw new TypeError("Hash mismatch");a=e.output.slice(2)}if(e.pubkey){const l=hash160(e.pubkey);if(a.length>0&&compare(a,l)!==0)throw new TypeError("Hash mismatch");if(a=l,!isPoint(e.pubkey)||e.pubkey.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(e.witness.length!==2)throw new TypeError("Witness is invalid");if(!isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!isPoint(e.witness[1])||e.witness[1].length!==33)throw new TypeError("Witness has invalid pubkey");if(e.signature&&compare(e.signature,e.witness[0])!==0)throw new TypeError("Signature mismatch");if(e.pubkey&&compare(e.pubkey,e.witness[1])!==0)throw new TypeError("Pubkey mismatch");const l=hash160(e.witness[1]);if(a.length>0&&compare(a,l)!==0)throw new TypeError("Hash mismatch")}}return Object.assign(o,e)}const OPS$1=OPS$7,EMPTY_BUFFER$1=new Uint8Array(0);function chunkHasUncompressedPubkey(e){return!!(e instanceof Uint8Array&&e.length===65&&e[0]===4&&isPoint(e))}function p2wsh(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(NullablePartial({network:object$1({}),address:string$1(),hash:Buffer256bitSchema,output:NBufferSchemaFactory(34),redeem:NullablePartial({input:BufferSchema,network:object$1({}),output:BufferSchema,witness:array(BufferSchema)}),input:NBufferSchemaFactory(0),witness:array(BufferSchema)}),e);const r=value(()=>{const l=distExports$1.bech32.decode(e.address),u=l.words.shift(),f=distExports$1.bech32.fromWords(l.words);return{version:u,prefix:l.prefix,data:Uint8Array.from(f)}}),n=value(()=>decompile(e.redeem.input));let o=e.network;o||(o=e.redeem&&e.redeem.network||bitcoin$1);const a={network:o};if(prop(a,"address",()=>{if(!a.hash)return;const l=distExports$1.bech32.toWords(a.hash);return l.unshift(0),distExports$1.bech32.encode(o.bech32,l)}),prop(a,"hash",()=>{if(e.output)return e.output.slice(2);if(e.address)return r().data;if(a.redeem&&a.redeem.output)return sha256(a.redeem.output)}),prop(a,"output",()=>{if(a.hash)return compile([OPS$1.OP_0,a.hash])}),prop(a,"redeem",()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:EMPTY_BUFFER$1,witness:e.witness.slice(0,-1)}}),prop(a,"input",()=>{if(a.witness)return EMPTY_BUFFER$1}),prop(a,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){const l=toStack(n());return a.redeem=Object.assign({witness:l},e.redeem),a.redeem.input=EMPTY_BUFFER$1,[].concat(l,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),prop(a,"name",()=>{const l=["p2wsh"];return a.redeem!==void 0&&a.redeem.name!==void 0&&l.push(a.redeem.name),l.join("-")}),t.validate){let l=Uint8Array.from([]);if(e.address){if(r().prefix!==o.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");l=r().data}if(e.hash){if(l.length>0&&compare(l,e.hash)!==0)throw new TypeError("Hash mismatch");l=e.hash}if(e.output){if(e.output.length!==34||e.output[0]!==OPS$1.OP_0||e.output[1]!==32)throw new TypeError("Output is invalid");const u=e.output.slice(2);if(l.length>0&&compare(l,u)!==0)throw new TypeError("Hash mismatch");l=u}if(e.redeem){if(e.redeem.network&&e.redeem.network!==o)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){const u=decompile(e.redeem.output);if(!u||u.length<1)throw new TypeError("Redeem.output is invalid");if(e.redeem.output.byteLength>3600)throw new TypeError("Redeem.output unspendable if larger than 3600 bytes");if(countNonPushOnlyOPs(u)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const f=sha256(e.redeem.output);if(l.length>0&&compare(l,f)!==0)throw new TypeError("Hash mismatch");l=f}if(e.redeem.input&&!isPushOnly(n()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!stacksEqual(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&n().some(chunkHasUncompressedPubkey)||e.redeem.output&&(decompile(e.redeem.output)||[]).some(chunkHasUncompressedPubkey))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){const u=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&compare(e.redeem.output,u)!==0)throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(chunkHasUncompressedPubkey)||(decompile(u)||[]).some(chunkHasUncompressedPubkey))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(a,e)}const _ECCLIB_CACHE={};function initEccLib(e,t){e?e!==_ECCLIB_CACHE.eccLib&&(verifyEcc(e),_ECCLIB_CACHE.eccLib=e):_ECCLIB_CACHE.eccLib=e}function getEccLib(){if(!_ECCLIB_CACHE.eccLib)throw new Error("No ECC Library provided. You must call initEccLib() with a valid TinySecp256k1Interface instance");return _ECCLIB_CACHE.eccLib}const h$1=e=>fromHex(e);function verifyEcc(e){assert$1(typeof e.isXOnlyPoint=="function"),assert$1(e.isXOnlyPoint(h$1("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert$1(e.isXOnlyPoint(h$1("fffffffffffffffffffffffffffffffffffffffffffffffffffffffeeffffc2e"))),assert$1(e.isXOnlyPoint(h$1("f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9"))),assert$1(e.isXOnlyPoint(h$1("0000000000000000000000000000000000000000000000000000000000000001"))),assert$1(!e.isXOnlyPoint(h$1("0000000000000000000000000000000000000000000000000000000000000000"))),assert$1(!e.isXOnlyPoint(h$1("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"))),assert$1(typeof e.xOnlyPointAddTweak=="function"),tweakAddVectors.forEach(t=>{const r=e.xOnlyPointAddTweak(h$1(t.pubkey),h$1(t.tweak));t.result===null?assert$1(r===null):(assert$1(r!==null),assert$1(r.parity===t.parity),assert$1(compare(r.xOnlyPubkey,h$1(t.result))===0))})}function assert$1(e){if(!e)throw new Error("ecc library invalid")}const tweakAddVectors=[{pubkey:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",tweak:"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140",parity:-1,result:null},{pubkey:"1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b",tweak:"a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac",parity:1,result:"e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"},{pubkey:"2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",tweak:"823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47",parity:0,result:"9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"}],HEX_STRINGS$1="0123456789abcdefABCDEF";HEX_STRINGS$1.split("").map(e=>e.codePointAt(0));Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=HEX_STRINGS$1.indexOf(r);return n<0?void 0:n<16?n:n-6});new TextEncoder;new TextDecoder;function writeUInt16(e,t,r,n){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>65535)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${r}`);n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255):(e[t]=r>>8&255,e[t+1]=r&255)}function writeUInt32$1(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${r}`);n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255)}function writeUInt64(e,t,r,n){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>0xffffffffffffffffn)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${r}`);n==="LE"?(e[t]=Number(r&0xffn),e[t+1]=Number(r>>8n&0xffn),e[t+2]=Number(r>>16n&0xffn),e[t+3]=Number(r>>24n&0xffn),e[t+4]=Number(r>>32n&0xffn),e[t+5]=Number(r>>40n&0xffn),e[t+6]=Number(r>>48n&0xffn),e[t+7]=Number(r>>56n&0xffn)):(e[t]=Number(r>>56n&0xffn),e[t+1]=Number(r>>48n&0xffn),e[t+2]=Number(r>>40n&0xffn),e[t+3]=Number(r>>32n&0xffn),e[t+4]=Number(r>>24n&0xffn),e[t+5]=Number(r>>16n&0xffn),e[t+6]=Number(r>>8n&0xffn),e[t+7]=Number(r&0xffn))}function readUInt16(e,t,r){if(t+2>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+1],n=(n<<8)+e[t],n}else{let n=0;return n=(n<<8)+e[t],n=(n<<8)+e[t+1],n}}function readUInt32(e,t,r){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0;return n=(n<<8)+e[t+3]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t]>>>0,n}else{let n=0;return n=(n<<8)+e[t]>>>0,n=(n<<8)+e[t+1]>>>0,n=(n<<8)+e[t+2]>>>0,n=(n<<8)+e[t+3]>>>0,n}}function readUInt64(e,t,r){if(t+8>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),r==="LE"){let n=0n;return n=(n<<8n)+BigInt(e[t+7]),n=(n<<8n)+BigInt(e[t+6]),n=(n<<8n)+BigInt(e[t+5]),n=(n<<8n)+BigInt(e[t+4]),n=(n<<8n)+BigInt(e[t+3]),n=(n<<8n)+BigInt(e[t+2]),n=(n<<8n)+BigInt(e[t+1]),n=(n<<8n)+BigInt(e[t]),n}else{let n=0n;return n=(n<<8n)+BigInt(e[t]),n=(n<<8n)+BigInt(e[t+1]),n=(n<<8n)+BigInt(e[t+2]),n=(n<<8n)+BigInt(e[t+3]),n=(n<<8n)+BigInt(e[t+4]),n=(n<<8n)+BigInt(e[t+5]),n=(n<<8n)+BigInt(e[t+6]),n=(n<<8n)+BigInt(e[t+7]),n}}const checkUInt64=e=>{if(e<0||e>0xffffffffffffffffn)throw new RangeError("value out of range")};function checkUInt53(e){if(e<0||e>Number.MAX_SAFE_INTEGER||e%1!==0)throw new RangeError("value out of range")}function checkUint53OrUint64(e){typeof e=="number"?checkUInt53(e):checkUInt64(e)}function encode$f(e,t,r){checkUint53OrUint64(e),r===void 0&&(r=0),t===void 0&&(t=new Uint8Array(encodingLength(e)));let n=0;return e<253?(t.set([Number(e)],r),n=1):e<=65535?(t.set([253],r),writeUInt16(t,r+1,Number(e),"LE"),n=3):e<=4294967295?(t.set([254],r),writeUInt32$1(t,r+1,Number(e),"LE"),n=5):(t.set([255],r),writeUInt64(t,r+1,BigInt(e),"LE"),n=9),{buffer:t,bytes:n}}function decode$e(e,t){t===void 0&&(t=0);const r=e.at(t);if(r===void 0)throw new Error("buffer too small");if(r<253)return{numberValue:r,bigintValue:BigInt(r),bytes:1};if(r===253){const n=readUInt16(e,t+1,"LE");return{numberValue:n,bigintValue:BigInt(n),bytes:3}}else if(r===254){const n=readUInt32(e,t+1,"LE");return{numberValue:n,bigintValue:BigInt(n),bytes:5}}else{const n=readUInt64(e,t+1,"LE");return{numberValue:n<=Number.MAX_SAFE_INTEGER?Number(n):null,bigintValue:n,bytes:9}}}function encodingLength(e){return checkUint53OrUint64(e),e<253?1:e<=65535?3:e<=4294967295?5:9}const MAX_JS_NUMBER=9007199254740991;function verifuint(e,t){if(typeof e!="number"&&typeof e!="bigint")throw new Error("cannot write a non-number as a number");if(e<0&&e<BigInt(0))throw new Error("specified a negative value for writing an unsigned value");if(e>t&&e>BigInt(t))throw new Error("RangeError: value out of range");if(Math.floor(Number(e))!==Number(e))throw new Error("value has a fractional component")}function reverseBuffer(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}function cloneBuffer(e){const t=new Uint8Array(e.length);return t.set(e),t}class BufferWriter{buffer;offset;static withCapacity(t){return new BufferWriter(new Uint8Array(t))}constructor(t,r=0){this.buffer=t,this.offset=r,parse$1(tuple([BufferSchema,UInt32Schema]),[t,r])}writeUInt8(t){this.offset=writeUInt8(this.buffer,this.offset,t)}writeInt32(t){this.offset=writeInt32(this.buffer,this.offset,t,"LE")}writeInt64(t){this.offset=writeInt64(this.buffer,this.offset,BigInt(t),"LE")}writeUInt32(t){this.offset=writeUInt32$2(this.buffer,this.offset,t,"LE")}writeUInt64(t){this.offset=writeUInt64$1(this.buffer,this.offset,BigInt(t),"LE")}writeVarInt(t){const{bytes:r}=encode$f(t,this.buffer,this.offset);this.offset+=r}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw new Error("Cannot write slice out of bounds");this.buffer.set(t,this.offset),this.offset+=t.length}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(r=>this.writeVarSlice(r))}end(){if(this.buffer.length===this.offset)return this.buffer;throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}}class BufferReader{buffer;offset;constructor(t,r=0){this.buffer=t,this.offset=r,parse$1(tuple([BufferSchema,UInt32Schema]),[t,r])}readUInt8(){const t=readUInt8(this.buffer,this.offset);return this.offset++,t}readInt32(){const t=readInt32(this.buffer,this.offset,"LE");return this.offset+=4,t}readUInt32(){const t=readUInt32$1(this.buffer,this.offset,"LE");return this.offset+=4,t}readInt64(){const t=readInt64(this.buffer,this.offset,"LE");return this.offset+=8,t}readVarInt(){const{bigintValue:t,bytes:r}=decode$e(this.buffer,this.offset);return this.offset+=r,t}readSlice(t){verifuint(t,MAX_JS_NUMBER);const r=Number(t);if(this.buffer.length<this.offset+r)throw new Error("Cannot read slice out of bounds");const n=this.buffer.slice(this.offset,this.offset+r);return this.offset+=r,n}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const t=this.readVarInt(),r=[];for(let n=0;n<t;n++)r.push(this.readVarSlice());return r}}const LEAF_VERSION_TAPSCRIPT=192,MAX_TAPTREE_DEPTH=128,isHashBranch=e=>"left"in e&&"right"in e;function rootHashFromPath(e,t){if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);const r=(e.length-33)/32;let n=t;for(let o=0;o<r;o++){const a=e.slice(33+32*o,65+32*o);compare(n,a)<0?n=tapBranchHash(n,a):n=tapBranchHash(a,n)}return n}function toHashTree(e){if(isTapleaf(e))return{hash:tapleafHash(e)};const t=[toHashTree(e[0]),toHashTree(e[1])];t.sort((o,a)=>compare(o.hash,a.hash));const[r,n]=t;return{hash:tapBranchHash(r.hash,n.hash),left:r,right:n}}function findScriptPath(e,t){if(isHashBranch(e)){const r=findScriptPath(e.left,t);if(r!==void 0)return[...r,e.right.hash];const n=findScriptPath(e.right,t);if(n!==void 0)return[...n,e.left.hash]}else if(compare(e.hash,t)===0)return[]}function tapleafHash(e){const t=e.version||LEAF_VERSION_TAPSCRIPT;return taggedHash("TapLeaf",concat$1([Uint8Array.from([t]),serializeScript(e.output)]))}function tapTweakHash(e,t){return taggedHash("TapTweak",concat$1(t?[e,t]:[e]))}function tweakKey(e,t){if(!(e instanceof Uint8Array)||e.length!==32||t&&t.length!==32)return null;const r=tapTweakHash(e,t),n=getEccLib().xOnlyPointAddTweak(e,r);return!n||n.xOnlyPubkey===null?null:{parity:n.parity,x:Uint8Array.from(n.xOnlyPubkey)}}function tapBranchHash(e,t){return taggedHash("TapBranch",concat$1([e,t]))}function serializeScript(e){const t=encodingLength(e.length),r=new Uint8Array(t);return encode$f(e.length,r),concat$1([r,e])}const OPS=OPS$7,TAPROOT_WITNESS_VERSION=1,ANNEX_PREFIX=80;function p2tr(e,t){if(!e.address&&!e.output&&!e.pubkey&&!e.internalPubkey&&!(e.witness&&e.witness.length>1))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),parse$1(partial(object$1({address:string$1(),input:NBufferSchemaFactory(0),network:object$1({}),output:NBufferSchemaFactory(34),internalPubkey:NBufferSchemaFactory(32),hash:NBufferSchemaFactory(32),pubkey:NBufferSchemaFactory(32),signature:union$1([NBufferSchemaFactory(64),NBufferSchemaFactory(65)]),witness:array(BufferSchema),scriptTree:custom(isTaptree,"Taptree is not of type isTaptree"),redeem:partial(object$1({output:BufferSchema,redeemVersion:number$1(),witness:array(BufferSchema)})),redeemVersion:number$1()})),e);const r=value(()=>fromBech32(e.address)),n=value(()=>{if(!(!e.witness||!e.witness.length))return e.witness.length>=2&&e.witness[e.witness.length-1][0]===ANNEX_PREFIX?e.witness.slice(0,-1):e.witness.slice()}),o=value(()=>{if(e.scriptTree)return toHashTree(e.scriptTree);if(e.hash)return{hash:e.hash}}),a=e.network||bitcoin$1,l={name:"p2tr",network:a};if(prop(l,"address",()=>{if(!l.pubkey)return;const u=distExports$1.bech32m.toWords(l.pubkey);return u.unshift(TAPROOT_WITNESS_VERSION),distExports$1.bech32m.encode(a.bech32,u)}),prop(l,"hash",()=>{const u=o();if(u)return u.hash;const f=n();if(f&&f.length>1){const x=f[f.length-1],p=x[0]&TAPLEAF_VERSION_MASK,g=f[f.length-2],y=tapleafHash({output:g,version:p});return rootHashFromPath(x,y)}return null}),prop(l,"output",()=>{if(l.pubkey)return compile([OPS.OP_1,l.pubkey])}),prop(l,"redeemVersion",()=>e.redeemVersion?e.redeemVersion:e.redeem&&e.redeem.redeemVersion!==void 0&&e.redeem.redeemVersion!==null?e.redeem.redeemVersion:LEAF_VERSION_TAPSCRIPT),prop(l,"redeem",()=>{const u=n();if(!(!u||u.length<2))return{output:u[u.length-2],witness:u.slice(0,-2),redeemVersion:u[u.length-1][0]&TAPLEAF_VERSION_MASK}}),prop(l,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.output)return e.output.slice(2);if(e.address)return r().data;if(l.internalPubkey){const u=tweakKey(l.internalPubkey,l.hash);if(u)return u.x}}),prop(l,"internalPubkey",()=>{if(e.internalPubkey)return e.internalPubkey;const u=n();if(u&&u.length>1)return u[u.length-1].slice(1,33)}),prop(l,"signature",()=>{if(e.signature)return e.signature;const u=n();if(!(!u||u.length!==1))return u[0]}),prop(l,"witness",()=>{if(e.witness)return e.witness;const u=o();if(u&&e.redeem&&e.redeem.output&&e.internalPubkey){const f=tapleafHash({output:e.redeem.output,version:l.redeemVersion}),x=findScriptPath(u,f);if(!x)return;const p=tweakKey(e.internalPubkey,u.hash);if(!p)return;const g=concat$1([Uint8Array.from([l.redeemVersion|p.parity]),e.internalPubkey].concat(x));return[e.redeem.output,g]}if(e.signature)return[e.signature]}),t.validate){let u=Uint8Array.from([]);if(e.address){if(a&&a.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==TAPROOT_WITNESS_VERSION)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");u=r().data}if(e.pubkey){if(u.length>0&&compare(u,e.pubkey)!==0)throw new TypeError("Pubkey mismatch");u=e.pubkey}if(e.output){if(e.output.length!==34||e.output[0]!==OPS.OP_1||e.output[1]!==32)throw new TypeError("Output is invalid");if(u.length>0&&compare(u,e.output.slice(2))!==0)throw new TypeError("Pubkey mismatch");u=e.output.slice(2)}if(e.internalPubkey){const p=tweakKey(e.internalPubkey,l.hash);if(u.length>0&&compare(u,p.x)!==0)throw new TypeError("Pubkey mismatch");u=p.x}if(u&&u.length&&!getEccLib().isXOnlyPoint(u))throw new TypeError("Invalid pubkey for p2tr");const f=o();if(e.hash&&f&&compare(e.hash,f.hash)!==0)throw new TypeError("Hash mismatch");if(e.redeem&&e.redeem.output&&f){const p=tapleafHash({output:e.redeem.output,version:l.redeemVersion});if(!findScriptPath(f,p))throw new TypeError("Redeem script not in tree")}const x=n();if(e.redeem&&l.redeem){if(e.redeem.redeemVersion&&e.redeem.redeemVersion!==l.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(e.redeem.output){if(decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");if(l.redeem.output&&compare(e.redeem.output,l.redeem.output)!==0)throw new TypeError("Redeem.output and witness mismatch")}if(e.redeem.witness&&l.redeem.witness&&!stacksEqual(e.redeem.witness,l.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(x&&x.length)if(x.length===1){if(e.signature&&compare(e.signature,x[0])!==0)throw new TypeError("Signature mismatch")}else{const p=x[x.length-1];if(p.length<33)throw new TypeError(`The control-block length is too small. Got ${p.length}, expected min 33.`);if((p.length-33)%32!==0)throw new TypeError(`The control-block length of ${p.length} is incorrect!`);const g=(p.length-33)/32;if(g>128)throw new TypeError(`The script path is too long. Got ${g}, expected max 128.`);const y=p.slice(1,33);if(e.internalPubkey&&compare(e.internalPubkey,y)!==0)throw new TypeError("Internal pubkey mismatch");if(!getEccLib().isXOnlyPoint(y))throw new TypeError("Invalid internalPubkey for p2tr witness");const b=p[0]&TAPLEAF_VERSION_MASK,w=x[x.length-2],v=tapleafHash({output:w,version:b}),B=rootHashFromPath(p,v),j=tweakKey(y,B);if(!j)throw new TypeError("Invalid outputKey for p2tr witness");if(u.length&&compare(u,j.x)!==0)throw new TypeError("Pubkey mismatch for p2tr witness");if(j.parity!==(p[0]&1))throw new Error("Incorrect parity")}}return Object.assign(l,e)}const FUTURE_SEGWIT_MAX_SIZE=40,FUTURE_SEGWIT_MIN_SIZE=2,FUTURE_SEGWIT_MAX_VERSION=16,FUTURE_SEGWIT_MIN_VERSION=2,FUTURE_SEGWIT_VERSION_DIFF=80,FUTURE_SEGWIT_VERSION_WARNING="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.",WARNING_STATES=[!1,!1];function _toFutureSegwitAddress(e,t){const r=e.slice(2);if(r.length<FUTURE_SEGWIT_MIN_SIZE||r.length>FUTURE_SEGWIT_MAX_SIZE)throw new TypeError("Invalid program length for segwit address");const n=e[0]-FUTURE_SEGWIT_VERSION_DIFF;if(n<FUTURE_SEGWIT_MIN_VERSION||n>FUTURE_SEGWIT_MAX_VERSION)throw new TypeError("Invalid version for segwit address");if(e[1]!==r.length)throw new TypeError("Invalid script for segwit address");return WARNING_STATES[0]===!1&&(console.warn(FUTURE_SEGWIT_VERSION_WARNING),WARNING_STATES[0]=!0),toBech32(r,n,t.bech32)}function fromBase58Check(e){const t=bs58Check.decode(e);if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");const r=readUInt8(t,0),n=t.slice(1);return{version:r,hash:n}}function fromBech32(e){let t,r;try{t=distExports$1.bech32.decode(e)}catch{}if(t){if(r=t.words[0],r!==0)throw new TypeError(e+" uses wrong encoding")}else if(t=distExports$1.bech32m.decode(e),r=t.words[0],r===0)throw new TypeError(e+" uses wrong encoding");const n=distExports$1.bech32.fromWords(t.words.slice(1));return{version:r,prefix:t.prefix,data:Uint8Array.from(n)}}function toBech32(e,t,r){const n=distExports$1.bech32.toWords(e);return n.unshift(t),t===0?distExports$1.bech32.encode(r,n):distExports$1.bech32m.encode(r,n)}function fromOutputScript(e,t){t=t||bitcoin$1;try{return p2pkh({output:e,network:t}).address}catch{}try{return p2sh({output:e,network:t}).address}catch{}try{return p2wpkh({output:e,network:t}).address}catch{}try{return p2wsh({output:e,network:t}).address}catch{}try{return p2tr({output:e,network:t}).address}catch{}try{return _toFutureSegwitAddress(e,t)}catch{}throw new Error(toASM(e)+" has no matching Address")}function toOutputScript(e,t){t=t||bitcoin$1;let r,n;try{r=fromBase58Check(e)}catch{}if(r){if(r.version===t.pubKeyHash)return p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return p2sh({hash:r.hash}).output}else{try{n=fromBech32(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0){if(n.data.length===20)return p2wpkh({hash:n.data}).output;if(n.data.length===32)return p2wsh({hash:n.data}).output}else if(n.version===1){if(n.data.length===32)return p2tr({pubkey:n.data}).output}else if(n.version>=FUTURE_SEGWIT_MIN_VERSION&&n.version<=FUTURE_SEGWIT_MAX_VERSION&&n.data.length>=FUTURE_SEGWIT_MIN_SIZE&&n.data.length<=FUTURE_SEGWIT_MAX_SIZE)return WARNING_STATES[1]===!1&&(console.warn(FUTURE_SEGWIT_VERSION_WARNING),WARNING_STATES[1]=!0),compile([n.version+FUTURE_SEGWIT_VERSION_DIFF,n.data])}}throw new Error(e+" has no matching Script")}function varSliceSize(e){const t=e.length;return encodingLength(t)+t}function vectorSize(e){const t=e.length;return encodingLength(t)+e.reduce((r,n)=>r+varSliceSize(n),0)}const EMPTY_BUFFER=new Uint8Array(0),EMPTY_WITNESS=[],ZERO=fromHex("0000000000000000000000000000000000000000000000000000000000000000"),ONE=fromHex("0000000000000000000000000000000000000000000000000000000000000001"),VALUE_UINT64_MAX=fromHex("ffffffffffffffff"),BLANK_OUTPUT={script:EMPTY_BUFFER,valueBuffer:VALUE_UINT64_MAX};function isOutput(e){return e.value!==void 0}class Transaction{static DEFAULT_SEQUENCE=4294967295;static SIGHASH_DEFAULT=0;static SIGHASH_ALL=1;static SIGHASH_NONE=2;static SIGHASH_SINGLE=3;static SIGHASH_ANYONECANPAY=128;static SIGHASH_OUTPUT_MASK=3;static SIGHASH_INPUT_MASK=128;static ADVANCED_TRANSACTION_MARKER=0;static ADVANCED_TRANSACTION_FLAG=1;static fromBuffer(t,r){const n=new BufferReader(t),o=new Transaction;o.version=n.readUInt32();const a=n.readUInt8(),l=n.readUInt8();let u=!1;a===Transaction.ADVANCED_TRANSACTION_MARKER&&l===Transaction.ADVANCED_TRANSACTION_FLAG?u=!0:n.offset-=2;const f=n.readVarInt();for(let p=0;p<f;++p)o.ins.push({hash:n.readSlice(32),index:n.readUInt32(),script:n.readVarSlice(),sequence:n.readUInt32(),witness:EMPTY_WITNESS});const x=n.readVarInt();for(let p=0;p<x;++p)o.outs.push({value:n.readInt64(),script:n.readVarSlice()});if(u){for(let p=0;p<f;++p)o.ins[p].witness=n.readVector();if(!o.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(o.locktime=n.readUInt32(),r)return o;if(n.offset!==t.length)throw new Error("Transaction has unexpected data");return o}static fromHex(t){return Transaction.fromBuffer(fromHex(t),!1)}static isCoinbaseHash(t){parse$1(Hash256bitSchema,t);for(let r=0;r<32;++r)if(t[r]!==0)return!1;return!0}version=1;locktime=0;ins=[];outs=[];isCoinbase(){return this.ins.length===1&&Transaction.isCoinbaseHash(this.ins[0].hash)}addInput(t,r,n,o){return parse$1(tuple([Hash256bitSchema,UInt32Schema,nullable(optional$1(UInt32Schema)),nullable(optional$1(BufferSchema))]),[t,r,n,o]),n==null&&(n=Transaction.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:r,script:o||EMPTY_BUFFER,sequence:n,witness:EMPTY_WITNESS})-1}addOutput(t,r){return parse$1(tuple([BufferSchema,SatoshiSchema]),[t,r]),this.outs.push({script:t,value:r})-1}hasWitnesses(){return this.ins.some(t=>t.witness.length!==0)}stripWitnesses(){this.ins.forEach(t=>{t.witness=EMPTY_WITNESS})}weight(){const t=this.byteLength(!1),r=this.byteLength(!0);return t*3+r}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(t=!0){const r=t&&this.hasWitnesses();return(r?10:8)+encodingLength(this.ins.length)+encodingLength(this.outs.length)+this.ins.reduce((n,o)=>n+40+varSliceSize(o.script),0)+this.outs.reduce((n,o)=>n+8+varSliceSize(o.script),0)+(r?this.ins.reduce((n,o)=>n+vectorSize(o.witness),0):0)}clone(){const t=new Transaction;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(r=>({hash:r.hash,index:r.index,script:r.script,sequence:r.sequence,witness:r.witness})),t.outs=this.outs.map(r=>({script:r.script,value:r.value})),t}hashForSignature(t,r,n){if(parse$1(tuple([UInt32Schema,BufferSchema,number$1()]),[t,r,n]),t>=this.ins.length)return ONE;const o=compile(decompile(r).filter(u=>u!==OPS$7.OP_CODESEPARATOR)),a=this.clone();if((n&31)===Transaction.SIGHASH_NONE)a.outs=[],a.ins.forEach((u,f)=>{f!==t&&(u.sequence=0)});else if((n&31)===Transaction.SIGHASH_SINGLE){if(t>=this.outs.length)return ONE;a.outs.length=t+1;for(let u=0;u<t;u++)a.outs[u]=BLANK_OUTPUT;a.ins.forEach((u,f)=>{f!==t&&(u.sequence=0)})}n&Transaction.SIGHASH_ANYONECANPAY?(a.ins=[a.ins[t]],a.ins[0].script=o):(a.ins.forEach(u=>{u.script=EMPTY_BUFFER}),a.ins[t].script=o);const l=new Uint8Array(a.byteLength(!1)+4);return writeInt32(l,l.length-4,n,"LE"),a.__toBuffer(l,0,!1),hash256(l)}hashForWitnessV1(t,r,n,o,a,l){if(parse$1(tuple([UInt32Schema,array(BufferSchema),array(SatoshiSchema),UInt32Schema]),[t,r,n,o]),n.length!==this.ins.length||r.length!==this.ins.length)throw new Error("Must supply prevout script and value for all inputs");const u=o===Transaction.SIGHASH_DEFAULT?Transaction.SIGHASH_ALL:o&Transaction.SIGHASH_OUTPUT_MASK,x=(o&Transaction.SIGHASH_INPUT_MASK)===Transaction.SIGHASH_ANYONECANPAY,p=u===Transaction.SIGHASH_NONE,g=u===Transaction.SIGHASH_SINGLE;let y=EMPTY_BUFFER,b=EMPTY_BUFFER,w=EMPTY_BUFFER,v=EMPTY_BUFFER,B=EMPTY_BUFFER;if(!x){let N=BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(T=>{N.writeSlice(T.hash),N.writeUInt32(T.index)}),y=sha256(N.end()),N=BufferWriter.withCapacity(8*this.ins.length),n.forEach(T=>N.writeInt64(T)),b=sha256(N.end()),N=BufferWriter.withCapacity(r.map(varSliceSize).reduce((T,_)=>T+_)),r.forEach(T=>N.writeVarSlice(T)),w=sha256(N.end()),N=BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(T=>N.writeUInt32(T.sequence)),v=sha256(N.end())}if(p||g){if(g&&t<this.outs.length){const N=this.outs[t],T=BufferWriter.withCapacity(8+varSliceSize(N.script));T.writeInt64(N.value),T.writeVarSlice(N.script),B=sha256(T.end())}}else{if(!this.outs.length)throw new Error("Add outputs to the transaction before signing.");const N=this.outs.map(_=>8+varSliceSize(_.script)).reduce((_,S)=>_+S),T=BufferWriter.withCapacity(N);this.outs.forEach(_=>{T.writeInt64(_.value),T.writeVarSlice(_.script)}),B=sha256(T.end())}const j=(a?2:0)+(l?1:0),F=174-(x?49:0)-(p?32:0)+(l?32:0)+(a?37:0),C=BufferWriter.withCapacity(F);if(C.writeUInt8(o),C.writeUInt32(this.version),C.writeUInt32(this.locktime),C.writeSlice(y),C.writeSlice(b),C.writeSlice(w),C.writeSlice(v),p||g||C.writeSlice(B),C.writeUInt8(j),x){const N=this.ins[t];C.writeSlice(N.hash),C.writeUInt32(N.index),C.writeInt64(n[t]),C.writeVarSlice(r[t]),C.writeUInt32(N.sequence)}else C.writeUInt32(t);if(l){const N=BufferWriter.withCapacity(varSliceSize(l));N.writeVarSlice(l),C.writeSlice(sha256(N.end()))}return g&&C.writeSlice(B),a&&(C.writeSlice(a),C.writeUInt8(0),C.writeUInt32(4294967295)),taggedHash("TapSighash",concat$1([Uint8Array.from([0]),C.end()]))}hashForWitnessV0(t,r,n,o){parse$1(tuple([UInt32Schema,BufferSchema,SatoshiSchema,UInt32Schema]),[t,r,n,o]);let a=Uint8Array.from([]),l,u=ZERO,f=ZERO,x=ZERO;if(o&Transaction.SIGHASH_ANYONECANPAY||(a=new Uint8Array(36*this.ins.length),l=new BufferWriter(a,0),this.ins.forEach(g=>{l.writeSlice(g.hash),l.writeUInt32(g.index)}),f=hash256(a)),!(o&Transaction.SIGHASH_ANYONECANPAY)&&(o&31)!==Transaction.SIGHASH_SINGLE&&(o&31)!==Transaction.SIGHASH_NONE&&(a=new Uint8Array(4*this.ins.length),l=new BufferWriter(a,0),this.ins.forEach(g=>{l.writeUInt32(g.sequence)}),x=hash256(a)),(o&31)!==Transaction.SIGHASH_SINGLE&&(o&31)!==Transaction.SIGHASH_NONE){const g=this.outs.reduce((y,b)=>y+8+varSliceSize(b.script),0);a=new Uint8Array(g),l=new BufferWriter(a,0),this.outs.forEach(y=>{l.writeInt64(y.value),l.writeVarSlice(y.script)}),u=hash256(a)}else if((o&31)===Transaction.SIGHASH_SINGLE&&t<this.outs.length){const g=this.outs[t];a=new Uint8Array(8+varSliceSize(g.script)),l=new BufferWriter(a,0),l.writeInt64(g.value),l.writeVarSlice(g.script),u=hash256(a)}a=new Uint8Array(156+varSliceSize(r)),l=new BufferWriter(a,0);const p=this.ins[t];return l.writeUInt32(this.version),l.writeSlice(f),l.writeSlice(x),l.writeSlice(p.hash),l.writeUInt32(p.index),l.writeVarSlice(r),l.writeInt64(n),l.writeUInt32(p.sequence),l.writeSlice(u),l.writeUInt32(this.locktime),l.writeUInt32(o),hash256(a)}getHash(t){return t&&this.isCoinbase()?new Uint8Array(32):hash256(this.__toBuffer(void 0,void 0,t))}getId(){return toHex(reverseBuffer(this.getHash(!1)))}toBuffer(t,r){return this.__toBuffer(t,r,!0)}toHex(){return toHex(this.toBuffer(void 0,void 0))}setInputScript(t,r){parse$1(tuple([number$1(),BufferSchema]),[t,r]),this.ins[t].script=r}setWitness(t,r){parse$1(tuple([number$1(),array(BufferSchema)]),[t,r]),this.ins[t].witness=r}__toBuffer(t,r,n=!1){t||(t=new Uint8Array(this.byteLength(n)));const o=new BufferWriter(t,r||0);o.writeUInt32(this.version);const a=n&&this.hasWitnesses();return a&&(o.writeUInt8(Transaction.ADVANCED_TRANSACTION_MARKER),o.writeUInt8(Transaction.ADVANCED_TRANSACTION_FLAG)),o.writeVarInt(this.ins.length),this.ins.forEach(l=>{o.writeSlice(l.hash),o.writeUInt32(l.index),o.writeVarSlice(l.script),o.writeUInt32(l.sequence)}),o.writeVarInt(this.outs.length),this.outs.forEach(l=>{isOutput(l)?o.writeInt64(l.value):o.writeSlice(l.valueBuffer),o.writeVarSlice(l.script)}),a&&this.ins.forEach(l=>{o.writeVector(l.witness)}),o.writeUInt32(this.locktime),r!==void 0?t.slice(r,o.offset):t}}var GlobalTypes;(function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"})(GlobalTypes||(GlobalTypes={}));var InputTypes;(function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT",e[e.TAP_KEY_SIG=19]="TAP_KEY_SIG",e[e.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",e[e.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",e[e.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",e[e.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"})(InputTypes||(InputTypes={}));var OutputTypes;(function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",e[e.TAP_TREE=6]="TAP_TREE",e[e.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"})(OutputTypes||(OutputTypes={}));const range$3=e=>[...Array(e).keys()];function decode$d(e){if(e.key[0]!==GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+toHex(e.key));if(e.key.length!==79||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+toHex(e.key));if(e.value.length/4%1!==0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");const t=e.key.slice(1),r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(const n of range$3(e.value.length/4-1)){const o=readUInt32$1(e.value,n*4+4,"LE"),a=!!(o&2147483648),l=o&2147483647;r.path+="/"+l.toString(10)+(a?"'":"")}return r}function encode$e(e){const t=new Uint8Array([GlobalTypes.GLOBAL_XPUB]),r=concat$1([t,e.extendedPubkey]),n=e.path.split("/"),o=new Uint8Array(n.length*4);o.set(e.masterFingerprint,0);let a=4;return n.slice(1).forEach(l=>{const u=l.slice(-1)==="'";let f=2147483647&parseInt(u?l.slice(0,-1):l,10);u&&(f+=2147483648),writeUInt32$2(o,a,f,"LE"),a+=4}),{key:r,value:o}}const expected$c="{ masterFingerprint: Uint8Array; extendedPubkey: Uint8Array; path: string; }";function check$c(e){const t=e.extendedPubkey,r=e.masterFingerprint,n=e.path;return t instanceof Uint8Array&&t.length===78&&[2,3].indexOf(t[45])>-1&&r instanceof Uint8Array&&r.length===4&&typeof n=="string"&&!!n.match(/^m(\/\d+'?)*$/)}function canAddToArray$3(e,t,r){const n=toHex(t.extendedPubkey);return r.has(n)?!1:(r.add(n),e.filter(o=>compare(o.extendedPubkey,t.extendedPubkey)).length===0)}const globalXpub=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$3,check:check$c,decode:decode$d,encode:encode$e,expected:expected$c},Symbol.toStringTag,{value:"Module"}));function encode$d(e){return{key:new Uint8Array([GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}const unsignedTx=Object.freeze(Object.defineProperty({__proto__:null,encode:encode$d},Symbol.toStringTag,{value:"Module"}));function decode$c(e){if(e.key[0]!==InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+toHex(e.key));return e.value}function encode$c(e){return{key:new Uint8Array([InputTypes.FINAL_SCRIPTSIG]),value:e}}const expected$b="Uint8Array";function check$b(e){return e instanceof Uint8Array}function canAdd$8(e,t){return!!e&&!!t&&e.finalScriptSig===void 0}const finalScriptSig=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$8,check:check$b,decode:decode$c,encode:encode$c,expected:expected$b},Symbol.toStringTag,{value:"Module"}));function decode$b(e){if(e.key[0]!==InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+toHex(e.key));return e.value}function encode$b(e){return{key:new Uint8Array([InputTypes.FINAL_SCRIPTWITNESS]),value:e}}const expected$a="Uint8Array";function check$a(e){return e instanceof Uint8Array}function canAdd$7(e,t){return!!e&&!!t&&e.finalScriptWitness===void 0}const finalScriptWitness=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$7,check:check$a,decode:decode$b,encode:encode$b,expected:expected$a},Symbol.toStringTag,{value:"Module"}));function decode$a(e){if(e.key[0]!==InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+toHex(e.key));return e.value}function encode$a(e){return{key:new Uint8Array([InputTypes.NON_WITNESS_UTXO]),value:e}}const expected$9="Uint8Array";function check$9(e){return e instanceof Uint8Array}function canAdd$6(e,t){return!!e&&!!t&&e.nonWitnessUtxo===void 0}const nonWitnessUtxo=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$6,check:check$9,decode:decode$a,encode:encode$a,expected:expected$9},Symbol.toStringTag,{value:"Module"}));function decode$9(e){if(e.key[0]!==InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+toHex(e.key));if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+toHex(e.key));return{pubkey:e.key.slice(1),signature:e.value}}function encode$9(e){const t=new Uint8Array([InputTypes.PARTIAL_SIG]);return{key:concat$1([t,e.pubkey]),value:e.signature}}const expected$8="{ pubkey: Uint8Array; signature: Uint8Array; }";function check$8(e){return e.pubkey instanceof Uint8Array&&e.signature instanceof Uint8Array&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&isDerSigWithSighash(e.signature)}function isDerSigWithSighash(e){if(!(e instanceof Uint8Array)||e.length<9||e[0]!==48||e.length!==e[1]+3||e[2]!==2)return!1;const t=e[3];if(t>33||t<1||e[3+t+1]!==2)return!1;const r=e[3+t+2];return!(r>33||r<1||e.length!==3+t+2+r+2)}function canAddToArray$2(e,t,r){const n=toHex(t.pubkey);return r.has(n)?!1:(r.add(n),e.filter(o=>compare(o.pubkey,t.pubkey)===0).length===0)}const partialSig=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$2,check:check$8,decode:decode$9,encode:encode$9,expected:expected$8},Symbol.toStringTag,{value:"Module"}));function decode$8(e){if(e.key[0]!==InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+toHex(e.key));return toUtf8(e.value)}function encode$8(e){return{key:new Uint8Array([InputTypes.POR_COMMITMENT]),value:fromUtf8(e)}}const expected$7="string";function check$7(e){return typeof e=="string"}function canAdd$5(e,t){return!!e&&!!t&&e.porCommitment===void 0}const porCommitment=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$5,check:check$7,decode:decode$8,encode:encode$8,expected:expected$7},Symbol.toStringTag,{value:"Module"}));function decode$7(e){if(e.key[0]!==InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+toHex(e.key));return Number(readUInt32$1(e.value,0,"LE"))}function encode$7(e){const t=Uint8Array.from([InputTypes.SIGHASH_TYPE]),r=new Uint8Array(4);return writeUInt32$2(r,0,e,"LE"),{key:t,value:r}}const expected$6="number";function check$6(e){return typeof e=="number"}function canAdd$4(e,t){return!!e&&!!t&&e.sighashType===void 0}const sighashType=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$4,check:check$6,decode:decode$7,encode:encode$7,expected:expected$6},Symbol.toStringTag,{value:"Module"}));function decode$6(e){if(e.key[0]!==InputTypes.TAP_KEY_SIG||e.key.length!==1)throw new Error("Decode Error: could not decode tapKeySig with key 0x"+toHex(e.key));if(!check$5(e.value))throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value}function encode$6(e){return{key:Uint8Array.from([InputTypes.TAP_KEY_SIG]),value:e}}const expected$5="Uint8Array";function check$5(e){return e instanceof Uint8Array&&(e.length===64||e.length===65)}function canAdd$3(e,t){return!!e&&!!t&&e.tapKeySig===void 0}const tapKeySig=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$3,check:check$5,decode:decode$6,encode:encode$6,expected:expected$5},Symbol.toStringTag,{value:"Module"}));function decode$5(e){if(e.key[0]!==InputTypes.TAP_LEAF_SCRIPT)throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+toHex(e.key));if((e.key.length-2)%32!==0)throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+toHex(e.key));const t=e.value[e.value.length-1];if((e.key[1]&254)!==t)throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+toHex(e.key));const r=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:r,leafVersion:t}}function encode$5(e){const t=Uint8Array.from([InputTypes.TAP_LEAF_SCRIPT]),r=Uint8Array.from([e.leafVersion]);return{key:concat$1([t,e.controlBlock]),value:concat$1([e.script,r])}}const expected$4="{ controlBlock: Uint8Array; leafVersion: number, script: Uint8Array; }";function check$4(e){return e.controlBlock instanceof Uint8Array&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&e.script instanceof Uint8Array}function canAddToArray$1(e,t,r){const n=toHex(t.controlBlock);return r.has(n)?!1:(r.add(n),e.filter(o=>compare(o.controlBlock,t.controlBlock)===0).length===0)}const tapLeafScript=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray:canAddToArray$1,check:check$4,decode:decode$5,encode:encode$5,expected:expected$4},Symbol.toStringTag,{value:"Module"}));function decode$4(e){if(e.key[0]!==InputTypes.TAP_MERKLE_ROOT||e.key.length!==1)throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+toHex(e.key));if(!check$3(e.value))throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value}function encode$4(e){return{key:Uint8Array.from([InputTypes.TAP_MERKLE_ROOT]),value:e}}const expected$3="Uint8Array";function check$3(e){return e instanceof Uint8Array&&e.length===32}function canAdd$2(e,t){return!!e&&!!t&&e.tapMerkleRoot===void 0}const tapMerkleRoot=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$2,check:check$3,decode:decode$4,encode:encode$4,expected:expected$3},Symbol.toStringTag,{value:"Module"}));function decode$3(e){if(e.key[0]!==InputTypes.TAP_SCRIPT_SIG)throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+toHex(e.key));if(e.key.length!==65)throw new Error("Decode Error: tapScriptSig has invalid key 0x"+toHex(e.key));if(e.value.length!==64&&e.value.length!==65)throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+toHex(e.key));const t=e.key.slice(1,33),r=e.key.slice(33);return{pubkey:t,leafHash:r,signature:e.value}}function encode$3(e){const t=Uint8Array.from([InputTypes.TAP_SCRIPT_SIG]);return{key:concat$1([t,e.pubkey,e.leafHash]),value:e.signature}}const expected$2="{ pubkey: Uint8Array; leafHash: Uint8Array; signature: Uint8Array; }";function check$2(e){return e.pubkey instanceof Uint8Array&&e.leafHash instanceof Uint8Array&&e.signature instanceof Uint8Array&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}function canAddToArray(e,t,r){const n=toHex(t.pubkey)+toHex(t.leafHash);return r.has(n)?!1:(r.add(n),e.filter(o=>compare(o.pubkey,t.pubkey)===0&&compare(o.leafHash,t.leafHash)===0).length===0)}const tapScriptSig=Object.freeze(Object.defineProperty({__proto__:null,canAddToArray,check:check$2,decode:decode$3,encode:encode$3,expected:expected$2},Symbol.toStringTag,{value:"Module"}));function decode$2(e){if(e.key[0]!==InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+toHex(e.key));const t=readInt64(e.value,0,"LE");let r=8;const{numberValue:n,bytes:o}=decode$e(e.value,r);r+=o;const a=e.value.slice(r);if(a.length!==n)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:a,value:t}}function encode$2(e){const{script:t,value:r}=e,n=encodingLength(t.length),o=new Uint8Array(8+n+t.length);return writeInt64(o,0,BigInt(r),"LE"),encode$f(t.length,o,8),o.set(t,8+n),{key:Uint8Array.from([InputTypes.WITNESS_UTXO]),value:o}}const expected$1="{ script: Uint8Array; value: bigint; }";function check$1(e){return e.script instanceof Uint8Array&&typeof e.value=="bigint"}function canAdd$1(e,t){return!!e&&!!t&&e.witnessUtxo===void 0}const witnessUtxo=Object.freeze(Object.defineProperty({__proto__:null,canAdd:canAdd$1,check:check$1,decode:decode$2,encode:encode$2,expected:expected$1},Symbol.toStringTag,{value:"Module"}));function decode$1(e){if(e.key[0]!==OutputTypes.TAP_TREE||e.key.length!==1)throw new Error("Decode Error: could not decode tapTree with key 0x"+toHex(e.key));let t=0;const r=[];for(;t<e.value.length;){const n=e.value[t++],o=e.value[t++],{numberValue:a,bytes:l}=decode$e(e.value,t);t+=l,r.push({depth:n,leafVersion:o,script:e.value.slice(t,t+a)}),t+=a}return{leaves:r}}function encode$1(e){const t=Uint8Array.from([OutputTypes.TAP_TREE]),r=[].concat(...e.leaves.map(n=>[Uint8Array.of(n.depth,n.leafVersion),encode$f(BigInt(n.script.length)).buffer,n.script]));return{key:t,value:concat$1(r)}}const expected="{ leaves: [{ depth: number; leafVersion: number, script: Uint8Array; }] }";function check(e){return Array.isArray(e.leaves)&&e.leaves.every(t=>t.depth>=0&&t.depth<=128&&(t.leafVersion&254)===t.leafVersion&&t.script instanceof Uint8Array)}function canAdd(e,t){return!!e&&!!t&&e.tapTree===void 0}const tapTree=Object.freeze(Object.defineProperty({__proto__:null,canAdd,check,decode:decode$1,encode:encode$1,expected},Symbol.toStringTag,{value:"Module"})),range$2=e=>[...Array(e).keys()],isValidDERKey=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&e[0]===4;function makeConverter$4(e,t=isValidDERKey){function r(u){if(u.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+toHex(u.key));const f=u.key.slice(1);if(!t(f))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+toHex(u.key));if(u.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");const x={masterFingerprint:u.value.slice(0,4),pubkey:f,path:"m"};for(const p of range$2(u.value.length/4-1)){const g=readUInt32$1(u.value,p*4+4,"LE"),y=!!(g&2147483648),b=g&2147483647;x.path+="/"+b.toString(10)+(y?"'":"")}return x}function n(u){const f=Uint8Array.from([e]),x=concat$1([f,u.pubkey]),p=u.path.split("/"),g=new Uint8Array(p.length*4);g.set(u.masterFingerprint,0);let y=4;return p.slice(1).forEach(b=>{const w=b.slice(-1)==="'";let v=2147483647&parseInt(w?b.slice(0,-1):b,10);w&&(v+=2147483648),writeUInt32$2(g,y,v,"LE"),y+=4}),{key:x,value:g}}const o="{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; }";function a(u){return u.pubkey instanceof Uint8Array&&u.masterFingerprint instanceof Uint8Array&&typeof u.path=="string"&&t(u.pubkey)&&u.masterFingerprint.length===4}function l(u,f,x){const p=toHex(f.pubkey);return x.has(p)?!1:(x.add(p),u.filter(g=>compare(g.pubkey,f.pubkey)===0).length===0)}return{decode:r,encode:n,check:a,expected:o,canAddToArray:l}}function makeChecker(e){return t;function t(r){let n;if(e.includes(r.key[0])&&(n=r.key.slice(1),!(n.length===33||n.length===65)||![2,3,4].includes(n[0])))throw new Error("Format Error: invalid pubkey in key 0x"+toHex(r.key));return n}}function makeConverter$3(e){function t(l){if(l.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+toHex(l.key));return l.value}function r(l){return{key:Uint8Array.from([e]),value:l}}const n="Uint8Array";function o(l){return l instanceof Uint8Array}function a(l,u){return!!l&&!!u&&l.redeemScript===void 0}return{decode:t,encode:r,check:o,expected:n,canAdd:a}}const isValidBIP340Key=e=>e.length===32;function makeConverter$2(e){const t=makeConverter$4(e,isValidBIP340Key);function r(l){const{numberValue:u,bytes:f}=decode$e(l.value),x=t.decode({key:l.key,value:l.value.slice(f+Number(u)*32)}),p=new Array(Number(u));for(let g=0,y=f;g<u;g++,y+=32)p[g]=l.value.slice(y,y+32);return{...x,leafHashes:p}}function n(l){const u=t.encode(l),f=encodingLength(l.leafHashes.length),x=new Uint8Array(f);encode$f(l.leafHashes.length,x);const p=concat$1([x,...l.leafHashes,u.value]);return{...u,value:p}}const o="{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; leafHashes: Uint8Array[]; }";function a(l){return Array.isArray(l.leafHashes)&&l.leafHashes.every(u=>u instanceof Uint8Array&&u.length===32)&&t.check(l)}return{decode:r,encode:n,check:a,expected:o,canAddToArray:t.canAddToArray}}function makeConverter$1(e){function t(l){if(l.key[0]!==e||l.key.length!==1)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+toHex(l.key));if(l.value.length!==32)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return l.value}function r(l){return{key:Uint8Array.from([e]),value:l}}const n="Uint8Array";function o(l){return l instanceof Uint8Array&&l.length===32}function a(l,u){return!!l&&!!u&&l.tapInternalKey===void 0}return{decode:t,encode:r,check:o,expected:n,canAdd:a}}function makeConverter(e){function t(l){if(l.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+toHex(l.key));return l.value}function r(l){return{key:Uint8Array.from([e]),value:l}}const n="Uint8Array";function o(l){return l instanceof Uint8Array}function a(l,u){return!!l&&!!u&&l.witnessScript===void 0}return{decode:t,encode:r,check:o,expected:n,canAdd:a}}const globals={unsignedTx,globalXpub,checkPubkey:makeChecker([])},inputs={nonWitnessUtxo,partialSig,sighashType,finalScriptSig,finalScriptWitness,porCommitment,witnessUtxo,bip32Derivation:makeConverter$4(InputTypes.BIP32_DERIVATION),redeemScript:makeConverter$3(InputTypes.REDEEM_SCRIPT),witnessScript:makeConverter(InputTypes.WITNESS_SCRIPT),checkPubkey:makeChecker([InputTypes.PARTIAL_SIG,InputTypes.BIP32_DERIVATION]),tapKeySig,tapScriptSig,tapLeafScript,tapBip32Derivation:makeConverter$2(InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:makeConverter$1(InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot},outputs={bip32Derivation:makeConverter$4(OutputTypes.BIP32_DERIVATION),redeemScript:makeConverter$3(OutputTypes.REDEEM_SCRIPT),witnessScript:makeConverter(OutputTypes.WITNESS_SCRIPT),checkPubkey:makeChecker([OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:makeConverter$2(OutputTypes.TAP_BIP32_DERIVATION),tapTree,tapInternalKey:makeConverter$1(OutputTypes.TAP_INTERNAL_KEY)},converter=Object.freeze(Object.defineProperty({__proto__:null,globals,inputs,outputs},Symbol.toStringTag,{value:"Module"})),range$1=e=>[...Array(e).keys()];function keyValsToBuffer(e){const t=e.map(keyValToBuffer);return t.push(Uint8Array.from([0])),concat$1(t)}function keyValToBuffer(e){const t=e.key.length,r=e.value.length,n=encodingLength(t),o=encodingLength(r),a=new Uint8Array(n+t+o+r);return encode$f(t,a,0),a.set(e.key,n),encode$f(r,a,n+t),a.set(e.value,n+t+o),a}function psbtFromBuffer(e,t){let r=0;function n(){const{numberValue:B,bytes:j}=decode$e(e,r);r+=j;const F=e.slice(r,r+Number(B));return r+=Number(B),F}function o(){const B=readUInt32$1(e,r,"BE");return r+=4,B}function a(){const B=readUInt8(e,r);return r+=1,B}function l(){const B=n(),j=n();return{key:B,value:j}}function u(){if(r>=e.length)throw new Error("Format Error: Unexpected End of PSBT");const B=readUInt8(e,r)===0;return B&&r++,B}if(o()!==1886610036)throw new Error("Format Error: Invalid Magic Number");if(a()!==255)throw new Error("Format Error: Magic Number must be followed by 0xff separator");const f=[],x={};for(;!u();){const B=l(),j=toHex(B.key);if(x[j])throw new Error("Format Error: Keys must be unique for global keymap: key "+j);x[j]=1,f.push(B)}const p=f.filter(B=>B.key[0]===GlobalTypes.UNSIGNED_TX);if(p.length!==1)throw new Error("Format Error: Only one UNSIGNED_TX allowed");const g=t(p[0].value),{inputCount:y,outputCount:b}=g.getInputOutputCounts(),w=[],v=[];for(const B of range$1(y)){const j={},F=[];for(;!u();){const C=l(),N=toHex(C.key);if(j[N])throw new Error("Format Error: Keys must be unique for each input: input index "+B+" key "+N);j[N]=1,F.push(C)}w.push(F)}for(const B of range$1(b)){const j={},F=[];for(;!u();){const C=l(),N=toHex(C.key);if(j[N])throw new Error("Format Error: Keys must be unique for each output: output index "+B+" key "+N);j[N]=1,F.push(C)}v.push(F)}return psbtFromKeyVals(g,{globalMapKeyVals:f,inputKeyVals:w,outputKeyVals:v})}function checkKeyBuffer(e,t,r){if(compare(t,Uint8Array.from([r])))throw new Error(`Format Error: Invalid ${e} key: ${toHex(t)}`)}function psbtFromKeyVals(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){const o={unsignedTx:e};let a=0;for(const p of t)switch(p.key[0]){case GlobalTypes.UNSIGNED_TX:if(checkKeyBuffer("global",p.key,GlobalTypes.UNSIGNED_TX),a>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");a++;break;case GlobalTypes.GLOBAL_XPUB:o.globalXpub===void 0&&(o.globalXpub=[]),o.globalXpub.push(globals.globalXpub.decode(p));break;default:o.unknownKeyVals||(o.unknownKeyVals=[]),o.unknownKeyVals.push(p)}const l=r.length,u=n.length,f=[],x=[];for(const p of range$1(l)){const g={};for(const y of r[p])switch(inputs.checkPubkey(y),y.key[0]){case InputTypes.NON_WITNESS_UTXO:if(checkKeyBuffer("input",y.key,InputTypes.NON_WITNESS_UTXO),g.nonWitnessUtxo!==void 0)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");g.nonWitnessUtxo=inputs.nonWitnessUtxo.decode(y);break;case InputTypes.WITNESS_UTXO:if(checkKeyBuffer("input",y.key,InputTypes.WITNESS_UTXO),g.witnessUtxo!==void 0)throw new Error("Format Error: Input has multiple WITNESS_UTXO");g.witnessUtxo=inputs.witnessUtxo.decode(y);break;case InputTypes.PARTIAL_SIG:g.partialSig===void 0&&(g.partialSig=[]),g.partialSig.push(inputs.partialSig.decode(y));break;case InputTypes.SIGHASH_TYPE:if(checkKeyBuffer("input",y.key,InputTypes.SIGHASH_TYPE),g.sighashType!==void 0)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");g.sighashType=inputs.sighashType.decode(y);break;case InputTypes.REDEEM_SCRIPT:if(checkKeyBuffer("input",y.key,InputTypes.REDEEM_SCRIPT),g.redeemScript!==void 0)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");g.redeemScript=inputs.redeemScript.decode(y);break;case InputTypes.WITNESS_SCRIPT:if(checkKeyBuffer("input",y.key,InputTypes.WITNESS_SCRIPT),g.witnessScript!==void 0)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");g.witnessScript=inputs.witnessScript.decode(y);break;case InputTypes.BIP32_DERIVATION:g.bip32Derivation===void 0&&(g.bip32Derivation=[]),g.bip32Derivation.push(inputs.bip32Derivation.decode(y));break;case InputTypes.FINAL_SCRIPTSIG:checkKeyBuffer("input",y.key,InputTypes.FINAL_SCRIPTSIG),g.finalScriptSig=inputs.finalScriptSig.decode(y);break;case InputTypes.FINAL_SCRIPTWITNESS:checkKeyBuffer("input",y.key,InputTypes.FINAL_SCRIPTWITNESS),g.finalScriptWitness=inputs.finalScriptWitness.decode(y);break;case InputTypes.POR_COMMITMENT:checkKeyBuffer("input",y.key,InputTypes.POR_COMMITMENT),g.porCommitment=inputs.porCommitment.decode(y);break;case InputTypes.TAP_KEY_SIG:checkKeyBuffer("input",y.key,InputTypes.TAP_KEY_SIG),g.tapKeySig=inputs.tapKeySig.decode(y);break;case InputTypes.TAP_SCRIPT_SIG:g.tapScriptSig===void 0&&(g.tapScriptSig=[]),g.tapScriptSig.push(inputs.tapScriptSig.decode(y));break;case InputTypes.TAP_LEAF_SCRIPT:g.tapLeafScript===void 0&&(g.tapLeafScript=[]),g.tapLeafScript.push(inputs.tapLeafScript.decode(y));break;case InputTypes.TAP_BIP32_DERIVATION:g.tapBip32Derivation===void 0&&(g.tapBip32Derivation=[]),g.tapBip32Derivation.push(inputs.tapBip32Derivation.decode(y));break;case InputTypes.TAP_INTERNAL_KEY:checkKeyBuffer("input",y.key,InputTypes.TAP_INTERNAL_KEY),g.tapInternalKey=inputs.tapInternalKey.decode(y);break;case InputTypes.TAP_MERKLE_ROOT:checkKeyBuffer("input",y.key,InputTypes.TAP_MERKLE_ROOT),g.tapMerkleRoot=inputs.tapMerkleRoot.decode(y);break;default:g.unknownKeyVals||(g.unknownKeyVals=[]),g.unknownKeyVals.push(y)}f.push(g)}for(const p of range$1(u)){const g={};for(const y of n[p])switch(outputs.checkPubkey(y),y.key[0]){case OutputTypes.REDEEM_SCRIPT:if(checkKeyBuffer("output",y.key,OutputTypes.REDEEM_SCRIPT),g.redeemScript!==void 0)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");g.redeemScript=outputs.redeemScript.decode(y);break;case OutputTypes.WITNESS_SCRIPT:if(checkKeyBuffer("output",y.key,OutputTypes.WITNESS_SCRIPT),g.witnessScript!==void 0)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");g.witnessScript=outputs.witnessScript.decode(y);break;case OutputTypes.BIP32_DERIVATION:g.bip32Derivation===void 0&&(g.bip32Derivation=[]),g.bip32Derivation.push(outputs.bip32Derivation.decode(y));break;case OutputTypes.TAP_INTERNAL_KEY:checkKeyBuffer("output",y.key,OutputTypes.TAP_INTERNAL_KEY),g.tapInternalKey=outputs.tapInternalKey.decode(y);break;case OutputTypes.TAP_TREE:checkKeyBuffer("output",y.key,OutputTypes.TAP_TREE),g.tapTree=outputs.tapTree.decode(y);break;case OutputTypes.TAP_BIP32_DERIVATION:g.tapBip32Derivation===void 0&&(g.tapBip32Derivation=[]),g.tapBip32Derivation.push(outputs.tapBip32Derivation.decode(y));break;default:g.unknownKeyVals||(g.unknownKeyVals=[]),g.unknownKeyVals.push(y)}x.push(g)}return{globalMap:o,inputs:f,outputs:x}}function psbtToBuffer({globalMap:e,inputs:t,outputs:r}){const{globalKeyVals:n,inputKeyVals:o,outputKeyVals:a}=psbtToKeyVals({globalMap:e,inputs:t,outputs:r}),l=keyValsToBuffer(n),u=g=>g.length===0?[Uint8Array.from([0])]:g.map(keyValsToBuffer),f=u(o),x=u(a),p=new Uint8Array(5);return p.set([112,115,98,116,255],0),concat$1([p,l].concat(f,x))}const sortKeyVals=(e,t)=>compare(e.key,t.key);function keyValsFromMap(e,t){const r=new Set,n=Object.entries(e).reduce((a,[l,u])=>{if(l==="unknownKeyVals")return a;const f=t[l];if(f===void 0)return a;const x=(Array.isArray(u)?u:[u]).map(f.encode);return x.map(g=>toHex(g.key)).forEach(g=>{if(r.has(g))throw new Error("Serialize Error: Duplicate key: "+g);r.add(g)}),a.concat(x)},[]),o=e.unknownKeyVals?e.unknownKeyVals.filter(a=>!r.has(toHex(a.key))):[];return n.concat(o).sort(sortKeyVals)}function psbtToKeyVals({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:keyValsFromMap(e,globals),inputKeyVals:t.map(n=>keyValsFromMap(n,inputs)),outputKeyVals:r.map(n=>keyValsFromMap(n,outputs))}}function combine(e){const t=e[0],r=psbtToKeyVals(t),n=e.slice(1);if(n.length===0)throw new Error("Combine: Nothing to combine");const o=getTx(t);if(o===void 0)throw new Error("Combine: Self missing transaction");const a=getKeySet(r.globalKeyVals),l=r.inputKeyVals.map(getKeySet),u=r.outputKeyVals.map(getKeySet);for(const f of n){const x=getTx(f);if(x===void 0||compare(x.toBuffer(),o.toBuffer())!==0)throw new Error("Combine: One of the Psbts does not have the same transaction.");const p=psbtToKeyVals(f);getKeySet(p.globalKeyVals).forEach(keyPusher(a,r.globalKeyVals,p.globalKeyVals)),p.inputKeyVals.map(getKeySet).forEach((w,v)=>w.forEach(keyPusher(l[v],r.inputKeyVals[v],p.inputKeyVals[v]))),p.outputKeyVals.map(getKeySet).forEach((w,v)=>w.forEach(keyPusher(u[v],r.outputKeyVals[v],p.outputKeyVals[v])))}return psbtFromKeyVals(o,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}function keyPusher(e,t,r){return n=>{if(e.has(n))return;const o=r.filter(a=>toHex(a.key)===n)[0];t.push(o),e.add(n)}}function getTx(e){return e.globalMap.unsignedTx}function getKeySet(e){const t=new Set;return e.forEach(r=>{const n=toHex(r.key);if(t.has(n))throw new Error("Combine: KeyValue Map keys should be unique");t.add(n)}),t}function checkForInput(e,t){const r=e[t];if(r===void 0)throw new Error(`No input #${t}`);return r}function checkForOutput(e,t){const r=e[t];if(r===void 0)throw new Error(`No output #${t}`);return r}function checkHasKey(e,t,r){if(e.key[0]<r)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&t.filter(n=>compare(n.key,e.key)===0).length!==0)throw new Error(`Duplicate Key: ${toHex(e.key)}`)}function getEnumLength(e){let t=0;return Object.keys(e).forEach(r=>{Number(isNaN(Number(r)))&&t++}),t}function inputCheckUncleanFinalized(e,t){let r=!1;if(t.nonWitnessUtxo||t.witnessUtxo){const n=!!t.redeemScript,o=!!t.witnessScript,a=!n||!!t.finalScriptSig,l=!o||!!t.finalScriptWitness,u=!!t.finalScriptSig||!!t.finalScriptWitness;r=a&&l&&u}if(r===!1)throw new Error(`Input #${e} has too much or too little data to clean`)}function throwForUpdateMaker(e,t,r,n){throw new Error(`Data for ${e} key ${t} is incorrect: Expected ${r} and got ${JSON.stringify(n)}`)}function updateMaker(e){return(t,r)=>{for(const n of Object.keys(t)){const o=t[n],{canAdd:a,canAddToArray:l,check:u,expected:f}=converter[e+"s"][n]||{},x=!!l;if(u)if(x){if(!Array.isArray(o)||r[n]&&!Array.isArray(r[n]))throw new Error(`Key type ${n} must be an array`);o.every(u)||throwForUpdateMaker(e,n,f,o);const p=r[n]||[],g=new Set;if(!o.every(y=>l(p,y,g)))throw new Error("Can not add duplicate data to array");r[n]=p.concat(o)}else{if(u(o)||throwForUpdateMaker(e,n,f,o),!a(r,o))throw new Error(`Can not add duplicate data to ${e}`);r[n]=o}}}}const updateGlobal=updateMaker("global"),updateInput=updateMaker("input"),updateOutput=updateMaker("output");function addInputAttributes(e,t){const r=e.length-1,n=checkForInput(e,r);updateInput(t,n)}function addOutputAttributes(e,t){const r=e.length-1,n=checkForOutput(e,r);updateOutput(t,n)}let Psbt$1=class{constructor(t){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:t}}static fromBase64(t,r){const n=fromBase64(t);return this.fromBuffer(n,r)}static fromHex(t,r){const n=fromHex(t);return this.fromBuffer(n,r)}static fromBuffer(t,r){const n=psbtFromBuffer(t,r),o=new this(n.globalMap.unsignedTx);return Object.assign(o,n),o}toBase64(){const t=this.toBuffer();return toBase64(t)}toHex(){const t=this.toBuffer();return toHex(t)}toBuffer(){return psbtToBuffer(this)}updateGlobal(t){return updateGlobal(t,this.globalMap),this}updateInput(t,r){const n=checkForInput(this.inputs,t);return updateInput(r,n),this}updateOutput(t,r){const n=checkForOutput(this.outputs,t);return updateOutput(r,n),this}addUnknownKeyValToGlobal(t){return checkHasKey(t,this.globalMap.unknownKeyVals,getEnumLength(GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(t),this}addUnknownKeyValToInput(t,r){const n=checkForInput(this.inputs,t);return checkHasKey(r,n.unknownKeyVals,getEnumLength(InputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addUnknownKeyValToOutput(t,r){const n=checkForOutput(this.outputs,t);return checkHasKey(r,n.unknownKeyVals,getEnumLength(OutputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addInput(t){this.globalMap.unsignedTx.addInput(t),this.inputs.push({unknownKeyVals:[]});const r=t.unknownKeyVals||[],n=this.inputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(o=>this.addUnknownKeyValToInput(n,o)),addInputAttributes(this.inputs,t),this}addOutput(t){this.globalMap.unsignedTx.addOutput(t),this.outputs.push({unknownKeyVals:[]});const r=t.unknownKeyVals||[],n=this.outputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(o=>this.addUnknownKeyValToOutput(n,o)),addOutputAttributes(this.outputs,t),this}clearFinalizedInput(t){const r=checkForInput(this.inputs,t);inputCheckUncleanFinalized(t,r);for(const n of Object.keys(r))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(n)||delete r[n];return this}combine(...t){const r=combine([this].concat(t));return Object.assign(this,r),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}};function isPaymentFactory(e){return t=>{try{return e({output:t}),!0}catch{return!1}}}const isP2MS=isPaymentFactory(p2ms),isP2PK=isPaymentFactory(p2pk),isP2PKH=isPaymentFactory(p2pkh),isP2WPKH=isPaymentFactory(p2wpkh),isP2WSHScript=isPaymentFactory(p2wsh),isP2SHScript=isPaymentFactory(p2sh),isP2TR=isPaymentFactory(p2tr);function witnessStackToScriptWitness(e){let t=new Uint8Array(0);function r(l){t=concat$1([t,l])}function n(l){const u=t.length,f=encodingLength(l);t=concat$1([t,new Uint8Array(f)]),encode$f(l,t,u)}function o(l){n(l.length),r(l)}function a(l){n(l.length),l.forEach(o)}return a(e),t}function pubkeyPositionInScript(e,t){const r=hash160(e),n=e.slice(1,33),o=decompile(t);if(o===null)throw new Error("Unknown script error");return o.findIndex(a=>typeof a=="number"?!1:compare(e,a)===0||compare(r,a)===0||compare(n,a)===0)}function pubkeyInScript(e,t){return pubkeyPositionInScript(e,t)!==-1}function checkInputForSig(e,t){return extractPartialSigs(e).some(n=>signatureBlocksAction(n,signature.decode,t))}function signatureBlocksAction(e,t,r){const{hashType:n}=t(e),o=[];switch(n&Transaction.SIGHASH_ANYONECANPAY&&o.push("addInput"),n&31){case Transaction.SIGHASH_ALL:break;case Transaction.SIGHASH_SINGLE:case Transaction.SIGHASH_NONE:o.push("addOutput"),o.push("setInputSequence");break}return o.indexOf(r)===-1}function extractPartialSigs(e){let t=[];if((e.partialSig||[]).length===0){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=getPsigsFromInputFinalScripts(e)}else t=e.partialSig;return t.map(r=>r.signature)}function getPsigsFromInputFinalScripts(e){const t=e.finalScriptSig?decompile(e.finalScriptSig)||[]:[],r=e.finalScriptWitness?decompile(e.finalScriptWitness)||[]:[];return t.concat(r).filter(n=>n instanceof Uint8Array&&isCanonicalScriptSignature(n)).map(n=>({signature:n}))}const toXOnly$1=e=>e.length===32?e:e.slice(1,33);function tapScriptFinalizer(e,t,r){const n=findTapLeafToFinalize(t,e,r);try{const a=sortSignatures(t,n).concat(n.script).concat(n.controlBlock);return{finalScriptWitness:witnessStackToScriptWitness(a)}}catch(o){throw new Error(`Can not finalize taproot input #${e}: ${o}`)}}function serializeTaprootSignature(e,t){const r=Uint8Array.from(t?[t]:[]);return concat$1([e,r])}function isTaprootInput(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&isP2TR(e.witnessUtxo.script))}function isTaprootOutput(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t)}function checkTaprootInputFields(e,t,r){checkMixedTaprootAndNonTaprootInputFields(e,t,r),checkIfTapLeafInTree(e,t,r)}function checkTaprootOutputFields(e,t,r){checkMixedTaprootAndNonTaprootOutputFields(e,t,r),checkTaprootScriptPubkey(e,t)}function checkTaprootScriptPubkey(e,t){if(!t.tapTree&&!t.tapInternalKey)return;const r=t.tapInternalKey||e.tapInternalKey,n=t.tapTree||e.tapTree;if(r){const{script:o}=e,a=getTaprootScripPubkey(r,n);if(o&&compare(a,o)!==0)throw new Error("Error adding output. Script or address mismatch.")}}function getTaprootScripPubkey(e,t){const r=t&&tapTreeFromList(t.leaves),{output:n}=p2tr({internalPubkey:e,scriptTree:r});return n}function tapTreeFromList(e=[]){return e.length===1&&e[0].depth===0?{output:e[0].script,version:e[0].leafVersion}:instertLeavesInTree(e)}function checkTaprootInputForSigs(e,t){return extractTaprootSigs(e).some(n=>signatureBlocksAction(n,decodeSchnorrSignature,t))}function decodeSchnorrSignature(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||Transaction.SIGHASH_DEFAULT}}function extractTaprootSigs(e){const t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(r=>r.signature)),!t.length){const r=getTapKeySigFromWitness(e.finalScriptWitness);r&&t.push(r)}return t}function getTapKeySigFromWitness(e){if(!e)return;const t=e.slice(2);if(t.length===64||t.length===65)return t}function instertLeavesInTree(e){let t;for(const r of e)if(t=instertLeafInTree(r,t),!t)throw new Error("No room left to insert tapleaf in tree");return t}function instertLeafInTree(e,t,r=0){if(r>MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===r)return t?void 0:{output:e.script,version:e.leafVersion};if(isTapleaf(t))return;const n=instertLeafInTree(e,t&&t[0],r+1);if(n)return[n,t&&t[1]];const o=instertLeafInTree(e,t&&t[1],r+1);if(o)return[t&&t[0],o]}function checkMixedTaprootAndNonTaprootInputFields(e,t,r){const n=isTaprootInput(e)&&hasNonTaprootFields(t),o=hasNonTaprootFields(e)&&isTaprootInput(t),a=e===t&&isTaprootInput(t)&&hasNonTaprootFields(t);if(n||o||a)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function checkMixedTaprootAndNonTaprootOutputFields(e,t,r){const n=isTaprootOutput(e)&&hasNonTaprootFields(t),o=hasNonTaprootFields(e)&&isTaprootOutput(t),a=e===t&&isTaprootOutput(t)&&hasNonTaprootFields(t);if(n||o||a)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function checkIfTapLeafInTree(e,t,r){if(t.tapMerkleRoot){const n=(t.tapLeafScript||[]).every(a=>isTapLeafInTree(a,t.tapMerkleRoot)),o=(e.tapLeafScript||[]).every(a=>isTapLeafInTree(a,t.tapMerkleRoot));if(!n||!o)throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(o=>isTapLeafInTree(o,e.tapMerkleRoot)))throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}function isTapLeafInTree(e,t){if(!t)return!0;const r=tapleafHash({output:e.script,version:e.leafVersion}),n=rootHashFromPath(e.controlBlock,r);return compare(n,t)===0}function sortSignatures(e,t){const r=tapleafHash({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(n=>compare(n.leafHash,r)===0).map(n=>addPubkeyPositionInScript(t.script,n)).sort((n,o)=>o.positionInScript-n.positionInScript).map(n=>n.signature)}function addPubkeyPositionInScript(e,t){return Object.assign({positionInScript:pubkeyPositionInScript(t.pubkey,e)},t)}function findTapLeafToFinalize(e,t,r){if(!e.tapScriptSig||!e.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);const n=(e.tapLeafScript||[]).sort((o,a)=>o.controlBlock.length-a.controlBlock.length).find(o=>canFinalizeLeaf(o,e.tapScriptSig,r));if(!n)throw new Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return n}function canFinalizeLeaf(e,t,r){const n=tapleafHash({output:e.script,version:e.leafVersion});return(!r||compare(n,r)===0)&&t.find(a=>compare(a.leafHash,n)===0)!==void 0}function hasNonTaprootFields(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}const DEFAULT_OPTS={network:bitcoin$1,maximumFeeRate:5e3};class Psbt{data;static fromBase64(t,r={}){const n=fromBase64(t);return this.fromBuffer(n,r)}static fromHex(t,r={}){const n=fromHex(t);return this.fromBuffer(n,r)}static fromBuffer(t,r={}){const n=Psbt$1.fromBuffer(t,transactionFromBuffer),o=new Psbt(r,n);return checkTxForDupeIns(o.__CACHE.__TX,o.__CACHE),o}__CACHE;opts;constructor(t={},r=new Psbt$1(new PsbtTransaction)){this.data=r,this.opts=Object.assign({},DEFAULT_OPTS,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},this.data.inputs.length===0&&this.setVersion(2);const n=(o,a,l,u)=>Object.defineProperty(o,a,{enumerable:l,writable:u});n(this,"__CACHE",!1,!0),n(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:cloneBuffer(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let r;try{r=fromOutputScript(t.script,this.opts.network)}catch{}return{script:cloneBuffer(t.script),value:t.value,address:r}})}combine(...t){return this.data.combine(...t.map(r=>r.data)),this}clone(){const t=Psbt.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){check32Bit(t),this.opts.maximumFeeRate=t}setVersion(t){check32Bit(t),checkInputsForPartialSig(this.data.inputs,"setVersion");const r=this.__CACHE;return r.__TX.version=t,r.__EXTRACTED_TX=void 0,this}setLocktime(t){check32Bit(t),checkInputsForPartialSig(this.data.inputs,"setLocktime");const r=this.__CACHE;return r.__TX.locktime=t,r.__EXTRACTED_TX=void 0,this}setInputSequence(t,r){check32Bit(r),checkInputsForPartialSig(this.data.inputs,"setInputSequence");const n=this.__CACHE;if(n.__TX.ins.length<=t)throw new Error("Input index too high");return n.__TX.ins[t].sequence=r,n.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(r=>this.addInput(r)),this}addInput(t){if(arguments.length>1||!t||t.hash===void 0||t.index===void 0)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");checkTaprootInputFields(t,t,"addInput"),checkInputsForPartialSig(this.data.inputs,"addInput"),t.witnessScript&&checkInvalidP2WSH(t.witnessScript);const r=this.__CACHE;this.data.addInput(t);const n=r.__TX.ins[r.__TX.ins.length-1];checkTxInputCache(r,n);const o=this.data.inputs.length-1,a=this.data.inputs[o];return a.nonWitnessUtxo&&addNonWitnessTxCache(this.__CACHE,a,o),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(r=>this.addOutput(r)),this}addOutput(t){if(arguments.length>1||!t||t.value===void 0||t.address===void 0&&t.script===void 0)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");checkInputsForPartialSig(this.data.inputs,"addOutput");const{address:r}=t;if(typeof r=="string"){const{network:o}=this.opts,a=toOutputScript(r,o);t=Object.assign({},t,{script:a})}checkTaprootOutputFields(t,t,"addOutput");const n=this.__CACHE;return this.data.addOutput(t),n.__FEE=void 0,n.__FEE_RATE=void 0,n.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(isFinalized))throw new Error("Not finalized");const r=this.__CACHE;if(t||checkFees(this,r,this.opts),r.__EXTRACTED_TX)return r.__EXTRACTED_TX;const n=r.__TX.clone();return inputFinalizeGetAmts(this.data.inputs,n,r,!0),n}getFeeRate(){return getTxCacheValue("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return getTxCacheValue("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return checkForInput(this.data.inputs,0),range(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,r){const n=checkForInput(this.data.inputs,t);return isTaprootInput(n)?this._finalizeTaprootInput(t,n,void 0,r):this._finalizeInput(t,n,r)}finalizeTaprootInput(t,r,n=tapScriptFinalizer){const o=checkForInput(this.data.inputs,t);if(isTaprootInput(o))return this._finalizeTaprootInput(t,o,r,n);throw new Error(`Cannot finalize input #${t}. Not Taproot.`)}_finalizeInput(t,r,n=getFinalScripts){const{script:o,isP2SH:a,isP2WSH:l,isSegwit:u}=getScriptFromInput(t,r,this.__CACHE);if(!o)throw new Error(`No script found for input #${t}`);checkPartialSigSighashes(r);const{finalScriptSig:f,finalScriptWitness:x}=n(t,r,o,u,a,l);if(f&&this.data.updateInput(t,{finalScriptSig:f}),x&&this.data.updateInput(t,{finalScriptWitness:x}),!f&&!x)throw new Error(`Unknown error finalizing input #${t}`);return this.data.clearFinalizedInput(t),this}_finalizeTaprootInput(t,r,n,o=tapScriptFinalizer){if(!r.witnessUtxo)throw new Error(`Cannot finalize input #${t}. Missing withness utxo.`);if(r.tapKeySig){const a=p2tr({output:r.witnessUtxo.script,signature:r.tapKeySig}),l=witnessStackToScriptWitness(a.witness);this.data.updateInput(t,{finalScriptWitness:l})}else{const{finalScriptWitness:a}=o(t,r,n);this.data.updateInput(t,{finalScriptWitness:a})}return this.data.clearFinalizedInput(t),this}getInputType(t){const r=checkForInput(this.data.inputs,t),n=getScriptFromUtxo(t,r,this.__CACHE),o=getMeaningfulScript(n,t,"input",r.redeemScript||redeemFromFinalScriptSig(r.finalScriptSig),r.witnessScript||redeemFromFinalWitnessScript(r.finalScriptWitness)),a=o.type==="raw"?"":o.type+"-",l=classifyScript(o.meaningfulScript);return a+l}inputHasPubkey(t,r){const n=checkForInput(this.data.inputs,t);return pubkeyInInput(r,n,t,this.__CACHE)}inputHasHDKey(t,r){const n=checkForInput(this.data.inputs,t),o=bip32DerivationIsMine(r);return!!n.bip32Derivation&&n.bip32Derivation.some(o)}outputHasPubkey(t,r){const n=checkForOutput(this.data.outputs,t);return pubkeyInOutput(r,n,t,this.__CACHE)}outputHasHDKey(t,r){const n=checkForOutput(this.data.outputs,t),o=bip32DerivationIsMine(r);return!!n.bip32Derivation&&n.bip32Derivation.some(o)}validateSignaturesOfAllInputs(t){return checkForInput(this.data.inputs,0),range(this.data.inputs.length).map(n=>this.validateSignaturesOfInput(n,t)).reduce((n,o)=>o===!0&&n,!0)}validateSignaturesOfInput(t,r,n){const o=this.data.inputs[t];return isTaprootInput(o)?this.validateSignaturesOfTaprootInput(t,r,n):this._validateSignaturesOfInput(t,r,n)}_validateSignaturesOfInput(t,r,n){const o=this.data.inputs[t],a=(o||{}).partialSig;if(!o||!a||a.length<1)throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");const l=n?a.filter(g=>compare(g.pubkey,n)===0):a;if(l.length<1)throw new Error("No signatures for this pubkey");const u=[];let f,x,p;for(const g of l){const y=signature.decode(g.signature),{hash:b,script:w}=p!==y.hashType?getHashForSig(t,Object.assign({},o,{sighashType:y.hashType}),this.__CACHE,!0):{hash:f,script:x};p=y.hashType,f=b,x=w,checkScriptForPubkey(g.pubkey,w,"verify"),u.push(r(g.pubkey,b,y.signature))}return u.every(g=>g===!0)}validateSignaturesOfTaprootInput(t,r,n){const o=this.data.inputs[t],a=(o||{}).tapKeySig,l=(o||{}).tapScriptSig;if(!o&&!a&&!(l&&!l.length))throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");n=n&&toXOnly$1(n);const u=n?getTaprootHashesForSig(t,o,this.data.inputs,n,this.__CACHE):getAllTaprootHashesForSig(t,o,this.data.inputs,this.__CACHE);if(!u.length)throw new Error("No signatures for this pubkey");const f=u.find(p=>!p.leafHash);let x=0;if(a&&f){if(!r(f.pubkey,f.hash,trimTaprootSig(a)))return!1;x++}if(l)for(const p of l){const g=u.find(y=>compare(y.pubkey,p.pubkey)===0);if(g){if(!r(p.pubkey,g.hash,trimTaprootSig(p.signature)))return!1;x++}}return x>0}signAllInputsHD(t,r=[Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");const n=[];for(const o of range(this.data.inputs.length))try{this.signInputHD(o,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(o=>o===!1))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(t,r=[Transaction.SIGHASH_ALL]){return new Promise((n,o)=>{if(!t||!t.publicKey||!t.fingerprint)return o(new Error("Need HDSigner to sign input"));const a=[],l=[];for(const u of range(this.data.inputs.length))l.push(this.signInputHDAsync(u,t,r).then(()=>{a.push(!0)},()=>{a.push(!1)}));return Promise.all(l).then(()=>{if(a.every(u=>u===!1))return o(new Error("No inputs were signed"));n()})})}signInputHD(t,r,n=[Transaction.SIGHASH_ALL]){if(!r||!r.publicKey||!r.fingerprint)throw new Error("Need HDSigner to sign input");return getSignersFromHD(t,this.data.inputs,r).forEach(a=>this.signInput(t,a,n)),this}signInputHDAsync(t,r,n=[Transaction.SIGHASH_ALL]){return new Promise((o,a)=>{if(!r||!r.publicKey||!r.fingerprint)return a(new Error("Need HDSigner to sign input"));const u=getSignersFromHD(t,this.data.inputs,r).map(f=>this.signInputAsync(t,f,n));return Promise.all(u).then(()=>{o()}).catch(a)})}signAllInputs(t,r){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const n=[];for(const o of range(this.data.inputs.length))try{this.signInput(o,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(o=>o===!1))throw new Error("No inputs were signed");return this}signAllInputsAsync(t,r){return new Promise((n,o)=>{if(!t||!t.publicKey)return o(new Error("Need Signer to sign input"));const a=[],l=[];for(const[u]of this.data.inputs.entries())l.push(this.signInputAsync(u,t,r).then(()=>{a.push(!0)},()=>{a.push(!1)}));return Promise.all(l).then(()=>{if(a.every(u=>u===!1))return o(new Error("No inputs were signed"));n()})})}signInput(t,r,n){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const o=checkForInput(this.data.inputs,t);return isTaprootInput(o)?this._signTaprootInput(t,o,r,void 0,n):this._signInput(t,r,n)}signTaprootInput(t,r,n,o){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const a=checkForInput(this.data.inputs,t);if(isTaprootInput(a))return this._signTaprootInput(t,a,r,n,o);throw new Error(`Input #${t} is not of type Taproot.`)}_signInput(t,r,n=[Transaction.SIGHASH_ALL]){const{hash:o,sighashType:a}=getHashAndSighashType(this.data.inputs,t,r.publicKey,this.__CACHE,n),l=[{pubkey:r.publicKey,signature:signature.encode(r.sign(o),a)}];return this.data.updateInput(t,{partialSig:l}),this}_signTaprootInput(t,r,n,o,a=[Transaction.SIGHASH_DEFAULT]){const l=this.checkTaprootHashesForSig(t,r,n,o,a),u=l.filter(x=>!x.leafHash).map(x=>serializeTaprootSignature(n.signSchnorr(x.hash),r.sighashType))[0],f=l.filter(x=>!!x.leafHash).map(x=>({pubkey:toXOnly$1(n.publicKey),signature:serializeTaprootSignature(n.signSchnorr(x.hash),r.sighashType),leafHash:x.leafHash}));return u&&this.data.updateInput(t,{tapKeySig:u}),f.length&&this.data.updateInput(t,{tapScriptSig:f}),this}signInputAsync(t,r,n){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const o=checkForInput(this.data.inputs,t);return isTaprootInput(o)?this._signTaprootInputAsync(t,o,r,void 0,n):this._signInputAsync(t,r,n)})}signTaprootInputAsync(t,r,n,o){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const a=checkForInput(this.data.inputs,t);if(isTaprootInput(a))return this._signTaprootInputAsync(t,a,r,n,o);throw new Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(t,r,n=[Transaction.SIGHASH_ALL]){const{hash:o,sighashType:a}=getHashAndSighashType(this.data.inputs,t,r.publicKey,this.__CACHE,n);return Promise.resolve(r.sign(o)).then(l=>{const u=[{pubkey:r.publicKey,signature:signature.encode(l,a)}];this.data.updateInput(t,{partialSig:u})})}async _signTaprootInputAsync(t,r,n,o,a=[Transaction.SIGHASH_DEFAULT]){const l=this.checkTaprootHashesForSig(t,r,n,o,a),u=[],f=l.filter(p=>!p.leafHash)[0];if(f){const p=Promise.resolve(n.signSchnorr(f.hash)).then(g=>({tapKeySig:serializeTaprootSignature(g,r.sighashType)}));u.push(p)}const x=l.filter(p=>!!p.leafHash);if(x.length){const p=x.map(g=>Promise.resolve(n.signSchnorr(g.hash)).then(y=>({tapScriptSig:[{pubkey:toXOnly$1(n.publicKey),signature:serializeTaprootSignature(y,r.sighashType),leafHash:g.leafHash}]})));u.push(...p)}return Promise.all(u).then(p=>{p.forEach(g=>this.data.updateInput(t,g))})}checkTaprootHashesForSig(t,r,n,o,a){if(typeof n.signSchnorr!="function")throw new Error(`Need Schnorr Signer to sign taproot input #${t}.`);const l=getTaprootHashesForSig(t,r,this.data.inputs,n.publicKey,this.__CACHE,o,a);if(!l||!l.length)throw new Error(`Can not sign for input #${t} with the key ${toHex(n.publicKey)}`);return l}toBuffer(){return checkCache(this.__CACHE),this.data.toBuffer()}toHex(){return checkCache(this.__CACHE),this.data.toHex()}toBase64(){return checkCache(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,r){return r.witnessScript&&checkInvalidP2WSH(r.witnessScript),checkTaprootInputFields(this.data.inputs[t],r,"updateInput"),this.data.updateInput(t,r),r.nonWitnessUtxo&&addNonWitnessTxCache(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,r){const n=this.data.outputs[t];return checkTaprootOutputFields(n,r,"updateOutput"),this.data.updateOutput(t,r),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,r){return this.data.addUnknownKeyValToInput(t,r),this}addUnknownKeyValToOutput(t,r){return this.data.addUnknownKeyValToOutput(t,r),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}}const transactionFromBuffer=e=>new PsbtTransaction(e);class PsbtTransaction{tx;constructor(t=Uint8Array.from([2,0,0,0,0,0,0,0,0,0])){this.tx=Transaction.fromBuffer(t),checkTxEmpty(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(t.hash===void 0||t.index===void 0||!(t.hash instanceof Uint8Array)&&typeof t.hash!="string"||typeof t.index!="number")throw new Error("Error adding input.");const r=typeof t.hash=="string"?reverseBuffer(fromHex(t.hash)):t.hash;this.tx.addInput(r,t.index,t.sequence)}addOutput(t){if(t.script===void 0||t.value===void 0||!(t.script instanceof Uint8Array)||typeof t.value!="bigint")throw new Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}}function canFinalize(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return hasSigs(1,e.partialSig);case"multisig":const n=p2ms({output:t});return hasSigs(n.m,e.partialSig,n.pubkeys);default:return!1}}function checkCache(e){if(e.__UNSAFE_SIGN_NONSEGWIT!==!1)throw new Error("Not BIP174 compliant, can not export")}function hasSigs(e,t,r){if(!t)return!1;let n;if(r?n=r.map(o=>{const a=compressPubkey(o);return t.find(l=>compare(l.pubkey,a)===0)}).filter(o=>!!o):n=t,n.length>e)throw new Error("Too many signatures");return n.length===e}function isFinalized(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function bip32DerivationIsMine(e){return t=>!(compare(e.fingerprint,t.masterFingerprint)||compare(e.derivePath(t.path).publicKey,t.pubkey))}function check32Bit(e){if(typeof e!="number"||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function checkFees(e,t,r){const n=t.__FEE_RATE||e.getFeeRate(),o=t.__EXTRACTED_TX.virtualSize(),a=n*o;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(a/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${o} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}function checkInputsForPartialSig(e,t){e.forEach(r=>{if(isTaprootInput(r)?checkTaprootInputForSigs(r,t):checkInputForSig(r,t))throw new Error("Can not modify transaction, signatures exist.")})}function checkPartialSigSighashes(e){if(!e.sighashType||!e.partialSig)return;const{partialSig:t,sighashType:r}=e;t.forEach(n=>{const{hashType:o}=signature.decode(n.signature);if(r!==o)throw new Error("Signature sighash does not match input sighash type")})}function checkScriptForPubkey(e,t,r){if(!pubkeyInScript(e,t))throw new Error(`Can not ${r} for this input with the key ${toHex(e)}`)}function checkTxEmpty(e){if(!e.ins.every(r=>r.script&&r.script.length===0&&r.witness&&r.witness.length===0))throw new Error("Format Error: Transaction ScriptSigs are not empty")}function checkTxForDupeIns(e,t){e.ins.forEach(r=>{checkTxInputCache(t,r)})}function checkTxInputCache(e,t){const r=toHex(reverseBuffer(Uint8Array.from(t.hash)))+":"+t.index;if(e.__TX_IN_CACHE[r])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function scriptCheckerFactory(e,t){return(r,n,o,a)=>{const l=e({redeem:{output:o}}).output;if(compare(n,l))throw new Error(`${t} for ${a} #${r} doesn't match the scriptPubKey in the prevout`)}}const checkRedeemScript=scriptCheckerFactory(p2sh,"Redeem script"),checkWitnessScript=scriptCheckerFactory(p2wsh,"Witness script");function getTxCacheValue(e,t,r,n){if(!r.every(isFinalized))throw new Error(`PSBT must be finalized to calculate ${t}`);if(e==="__FEE_RATE"&&n.__FEE_RATE)return n.__FEE_RATE;if(e==="__FEE"&&n.__FEE)return n.__FEE;let o,a=!0;if(n.__EXTRACTED_TX?(o=n.__EXTRACTED_TX,a=!1):o=n.__TX.clone(),inputFinalizeGetAmts(r,o,n,a),e==="__FEE_RATE")return n.__FEE_RATE;if(e==="__FEE")return n.__FEE}function getFinalScripts(e,t,r,n,o,a){const l=classifyScript(r);if(!canFinalize(t,r,l))throw new Error(`Can not finalize input #${e}`);return prepareFinalScripts(r,l,t.partialSig,n,o,a)}function prepareFinalScripts(e,t,r,n,o,a){let l,u;const f=getPayment(e,t,r),x=a?p2wsh({redeem:f}):null,p=o?p2sh({redeem:x||f}):null;return n?(x?u=witnessStackToScriptWitness(x.witness):u=witnessStackToScriptWitness(f.witness),p&&(l=p.input)):p?l=p.input:l=f.input,{finalScriptSig:l,finalScriptWitness:u}}function getHashAndSighashType(e,t,r,n,o){const a=checkForInput(e,t),{hash:l,sighashType:u,script:f}=getHashForSig(t,a,n,!1,o);return checkScriptForPubkey(r,f,"sign"),{hash:l,sighashType:u}}function getHashForSig(e,t,r,n,o){const a=r.__TX,l=t.sighashType||Transaction.SIGHASH_ALL;checkSighashTypeAllowed(l,o);let u,f;if(t.nonWitnessUtxo){const g=nonWitnessUtxoTxFromCache(r,t,e),y=a.ins[e].hash,b=g.getHash();if(compare(y,b)!==0)throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);const w=a.ins[e].index;f=g.outs[w]}else if(t.witnessUtxo)f=t.witnessUtxo;else throw new Error("Need a Utxo input item for signing");const{meaningfulScript:x,type:p}=getMeaningfulScript(f.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(p)>=0)u=a.hashForWitnessV0(e,x,f.value,l);else if(isP2WPKH(x)){const g=p2pkh({hash:x.slice(2)}).output;u=a.hashForWitnessV0(e,g,f.value,l)}else{if(t.nonWitnessUtxo===void 0&&r.__UNSAFE_SIGN_NONSEGWIT===!1)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${toHex(x)}`);!n&&r.__UNSAFE_SIGN_NONSEGWIT!==!1&&console.warn(`Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecessor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.
*********************
PROCEED WITH CAUTION!
*********************`),u=a.hashForSignature(e,x,l)}return{script:x,sighashType:l,hash:u}}function getAllTaprootHashesForSig(e,t,r,n){const o=[];if(t.tapInternalKey){const l=getPrevoutTaprootKey(e,t,n);l&&o.push(l)}if(t.tapScriptSig){const l=t.tapScriptSig.map(u=>u.pubkey);o.push(...l)}return o.map(l=>getTaprootHashesForSig(e,t,r,l,n)).flat()}function getPrevoutTaprootKey(e,t,r){const{script:n}=getScriptAndAmountFromUtxo(e,t,r);return isP2TR(n)?n.subarray(2,34):null}function trimTaprootSig(e){return e.length===64?e:e.subarray(0,64)}function getTaprootHashesForSig(e,t,r,n,o,a,l){const u=o.__TX,f=t.sighashType||Transaction.SIGHASH_DEFAULT;checkSighashTypeAllowed(f,l);const x=r.map((w,v)=>getScriptAndAmountFromUtxo(v,w,o)),p=x.map(w=>w.script),g=x.map(w=>w.value),y=[];if(t.tapInternalKey&&!a){const w=getPrevoutTaprootKey(e,t,o)||Uint8Array.from([]);if(compare(toXOnly$1(n),w)===0){const v=u.hashForWitnessV1(e,p,g,f);y.push({pubkey:n,hash:v})}}const b=(t.tapLeafScript||[]).filter(w=>pubkeyInScript(n,w.script)).map(w=>{const v=tapleafHash({output:w.script,version:w.leafVersion});return Object.assign({hash:v},w)}).filter(w=>!a||compare(a,w.hash)===0).map(w=>{const v=u.hashForWitnessV1(e,p,g,f,w.hash);return{pubkey:n,hash:v,leafHash:w.hash}});return y.concat(b)}function checkSighashTypeAllowed(e,t){if(t&&t.indexOf(e)<0){const r=sighashTypeToString(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${r}`)}}function getPayment(e,t,r){let n;switch(t){case"multisig":const o=getSortedSigs(e,r);n=p2ms({output:e,signatures:o});break;case"pubkey":n=p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break}return n}function getScriptFromInput(e,t,r){const n=r.__TX,o={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(o.isP2SH=!!t.redeemScript,o.isP2WSH=!!t.witnessScript,t.witnessScript)o.script=t.witnessScript;else if(t.redeemScript)o.script=t.redeemScript;else if(t.nonWitnessUtxo){const a=nonWitnessUtxoTxFromCache(r,t,e),l=n.ins[e].index;o.script=a.outs[l].script}else t.witnessUtxo&&(o.script=t.witnessUtxo.script);return(t.witnessScript||isP2WPKH(o.script))&&(o.isSegwit=!0),o}function getSignersFromHD(e,t,r){const n=checkForInput(t,e);if(!n.bip32Derivation||n.bip32Derivation.length===0)throw new Error("Need bip32Derivation to sign with HD");const o=n.bip32Derivation.map(l=>{if(compare(l.masterFingerprint,r.fingerprint)===0)return l}).filter(l=>!!l);if(o.length===0)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return o.map(l=>{const u=r.derivePath(l.path);if(compare(l.pubkey,u.publicKey)!==0)throw new Error("pubkey did not match bip32Derivation");return u})}function getSortedSigs(e,t){return p2ms({output:e}).pubkeys.map(n=>(t.filter(o=>compare(o.pubkey,n)===0)[0]||{}).signature).filter(n=>!!n)}function scriptWitnessToWitnessStack(e){let t=0;function r(l){return t+=l,e.slice(t-l,t)}function n(){const l=decode$e(e,t);return t+=encodingLength(l.bigintValue),l.numberValue}function o(){return r(n())}function a(){const l=n(),u=[];for(let f=0;f<l;f++)u.push(o());return u}return a()}function sighashTypeToString(e){let t=e&Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(e&31){case Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case Transaction.SIGHASH_NONE:t+="SIGHASH_NONE";break}return t}function addNonWitnessTxCache(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;const n=Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;const o=e,a=r;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){const l=o.__NON_WITNESS_UTXO_BUF_CACHE[a],u=o.__NON_WITNESS_UTXO_TX_CACHE[a];if(l!==void 0)return l;{const f=u.toBuffer();return o.__NON_WITNESS_UTXO_BUF_CACHE[a]=f,f}},set(l){o.__NON_WITNESS_UTXO_BUF_CACHE[a]=l}})}function inputFinalizeGetAmts(e,t,r,n){let o=0n;e.forEach((f,x)=>{if(n&&f.finalScriptSig&&(t.ins[x].script=f.finalScriptSig),n&&f.finalScriptWitness&&(t.ins[x].witness=scriptWitnessToWitnessStack(f.finalScriptWitness)),f.witnessUtxo)o+=f.witnessUtxo.value;else if(f.nonWitnessUtxo){const p=nonWitnessUtxoTxFromCache(r,f,x),g=t.ins[x].index,y=p.outs[g];o+=y.value}});const a=t.outs.reduce((f,x)=>f+x.value,0n),l=o-a;if(l<0)throw new Error("Outputs are spending more than Inputs");const u=t.virtualSize();r.__FEE=l,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(Number(l/BigInt(u)))}function nonWitnessUtxoTxFromCache(e,t,r){const n=e.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||addNonWitnessTxCache(e,t,r),n[r]}function getScriptFromUtxo(e,t,r){const{script:n}=getScriptAndAmountFromUtxo(e,t,r);return n}function getScriptAndAmountFromUtxo(e,t,r){if(t.witnessUtxo!==void 0)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(t.nonWitnessUtxo!==void 0){const o=nonWitnessUtxoTxFromCache(r,t,e).outs[r.__TX.ins[e].index];return{script:o.script,value:o.value}}else throw new Error("Can't find pubkey in input without Utxo data")}function pubkeyInInput(e,t,r,n){const o=getScriptFromUtxo(r,t,n),{meaningfulScript:a}=getMeaningfulScript(o,r,"input",t.redeemScript,t.witnessScript);return pubkeyInScript(e,a)}function pubkeyInOutput(e,t,r,n){const o=n.__TX.outs[r].script,{meaningfulScript:a}=getMeaningfulScript(o,r,"output",t.redeemScript,t.witnessScript);return pubkeyInScript(e,a)}function redeemFromFinalScriptSig(e){if(!e)return;const t=decompile(e);if(!t)return;const r=t[t.length-1];if(!(!(r instanceof Uint8Array)||isPubkeyLike(r)||isSigLike(r)||!decompile(r)))return r}function redeemFromFinalWitnessScript(e){if(!e)return;const t=scriptWitnessToWitnessStack(e),r=t[t.length-1];if(!(isPubkeyLike(r)||!decompile(r)))return r}function compressPubkey(e){if(e.length===65){const t=e[64]&1,r=e.slice(0,33);return r[0]=2|t,r}return e.slice()}function isPubkeyLike(e){return e.length===33&&isCanonicalPubKey(e)}function isSigLike(e){return isCanonicalScriptSignature(e)}function getMeaningfulScript(e,t,r,n,o){const a=isP2SHScript(e),l=a&&n&&isP2WSHScript(n),u=isP2WSHScript(e);if(a&&n===void 0)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((u||l)&&o===void 0)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let f;return l?(f=o,checkRedeemScript(t,e,n,r),checkWitnessScript(t,n,o,r),checkInvalidP2WSH(f)):u?(f=o,checkWitnessScript(t,e,o,r),checkInvalidP2WSH(f)):a?(f=n,checkRedeemScript(t,e,n,r)):f=e,{meaningfulScript:f,type:l?"p2sh-p2wsh":a?"p2sh":u?"p2wsh":"raw"}}function checkInvalidP2WSH(e){if(isP2WPKH(e)||isP2SHScript(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function classifyScript(e){return isP2WPKH(e)?"witnesspubkeyhash":isP2PKH(e)?"pubkeyhash":isP2MS(e)?"multisig":isP2PK(e)?"pubkey":"nonstandard"}function range(e){return[...Array(e).keys()]}var dist={},secp256k1={},sha2={},_md={},utils$4={},crypto$1={},hasRequiredCrypto;function requireCrypto(){return hasRequiredCrypto||(hasRequiredCrypto=1,Object.defineProperty(crypto$1,"__esModule",{value:!0}),crypto$1.crypto=void 0,crypto$1.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0),crypto$1}var hasRequiredUtils$4;function requireUtils$4(){return hasRequiredUtils$4||(hasRequiredUtils$4=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.Hash=e.nextTick=e.swap32IfBE=e.byteSwapIfBE=e.swap8IfBE=e.isLE=void 0,e.isBytes=r,e.anumber=n,e.abytes=o,e.ahash=a,e.aexists=l,e.aoutput=u,e.u8=f,e.u32=x,e.clean=p,e.createView=g,e.rotr=y,e.rotl=b,e.byteSwap=w,e.byteSwap32=v,e.bytesToHex=F,e.hexToBytes=T,e.asyncLoop=S,e.utf8ToBytes=O,e.bytesToUtf8=$,e.toBytes=z,e.kdfInputToBytes=W,e.concatBytes=U,e.checkOpts=I,e.createHasher=k,e.createOptHasher=M,e.createXOFer=q,e.randomBytes=K;const t=requireCrypto();function r(H){return H instanceof Uint8Array||ArrayBuffer.isView(H)&&H.constructor.name==="Uint8Array"}function n(H){if(!Number.isSafeInteger(H)||H<0)throw new Error("positive integer expected, got "+H)}function o(H,...Q){if(!r(H))throw new Error("Uint8Array expected");if(Q.length>0&&!Q.includes(H.length))throw new Error("Uint8Array expected of length "+Q+", got length="+H.length)}function a(H){if(typeof H!="function"||typeof H.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");n(H.outputLen),n(H.blockLen)}function l(H,Q=!0){if(H.destroyed)throw new Error("Hash instance has been destroyed");if(Q&&H.finished)throw new Error("Hash#digest() has already been called")}function u(H,Q){o(H);const D=Q.outputLen;if(H.length<D)throw new Error("digestInto() expects output buffer of length at least "+D)}function f(H){return new Uint8Array(H.buffer,H.byteOffset,H.byteLength)}function x(H){return new Uint32Array(H.buffer,H.byteOffset,Math.floor(H.byteLength/4))}function p(...H){for(let Q=0;Q<H.length;Q++)H[Q].fill(0)}function g(H){return new DataView(H.buffer,H.byteOffset,H.byteLength)}function y(H,Q){return H<<32-Q|H>>>Q}function b(H,Q){return H<<Q|H>>>32-Q>>>0}e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function w(H){return H<<24&4278190080|H<<8&16711680|H>>>8&65280|H>>>24&255}e.swap8IfBE=e.isLE?H=>H:H=>w(H),e.byteSwapIfBE=e.swap8IfBE;function v(H){for(let Q=0;Q<H.length;Q++)H[Q]=w(H[Q]);return H}e.swap32IfBE=e.isLE?H=>H:v;const B=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",j=Array.from({length:256},(H,Q)=>Q.toString(16).padStart(2,"0"));function F(H){if(o(H),B)return H.toHex();let Q="";for(let D=0;D<H.length;D++)Q+=j[H[D]];return Q}const C={_0:48,_9:57,A:65,F:70,a:97,f:102};function N(H){if(H>=C._0&&H<=C._9)return H-C._0;if(H>=C.A&&H<=C.F)return H-(C.A-10);if(H>=C.a&&H<=C.f)return H-(C.a-10)}function T(H){if(typeof H!="string")throw new Error("hex string expected, got "+typeof H);if(B)return Uint8Array.fromHex(H);const Q=H.length,D=Q/2;if(Q%2)throw new Error("hex string expected, got unpadded hex of length "+Q);const Y=new Uint8Array(D);for(let J=0,L=0;J<D;J++,L+=2){const Z=N(H.charCodeAt(L)),oe=N(H.charCodeAt(L+1));if(Z===void 0||oe===void 0){const ce=H[L]+H[L+1];throw new Error('hex string expected, got non-hex character "'+ce+'" at index '+L)}Y[J]=Z*16+oe}return Y}const _=async()=>{};e.nextTick=_;async function S(H,Q,D){let Y=Date.now();for(let J=0;J<H;J++){D(J);const L=Date.now()-Y;L>=0&&L<Q||(await(0,e.nextTick)(),Y+=L)}}function O(H){if(typeof H!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(H))}function $(H){return new TextDecoder().decode(H)}function z(H){return typeof H=="string"&&(H=O(H)),o(H),H}function W(H){return typeof H=="string"&&(H=O(H)),o(H),H}function U(...H){let Q=0;for(let Y=0;Y<H.length;Y++){const J=H[Y];o(J),Q+=J.length}const D=new Uint8Array(Q);for(let Y=0,J=0;Y<H.length;Y++){const L=H[Y];D.set(L,J),J+=L.length}return D}function I(H,Q){if(Q!==void 0&&{}.toString.call(Q)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(H,Q)}class G{}e.Hash=G;function k(H){const Q=Y=>H().update(z(Y)).digest(),D=H();return Q.outputLen=D.outputLen,Q.blockLen=D.blockLen,Q.create=()=>H(),Q}function M(H){const Q=(Y,J)=>H(J).update(z(Y)).digest(),D=H({});return Q.outputLen=D.outputLen,Q.blockLen=D.blockLen,Q.create=Y=>H(Y),Q}function q(H){const Q=(Y,J)=>H(J).update(z(Y)).digest(),D=H({});return Q.outputLen=D.outputLen,Q.blockLen=D.blockLen,Q.create=Y=>H(Y),Q}e.wrapConstructor=k,e.wrapConstructorWithOpts=M,e.wrapXOFConstructorWithOpts=q;function K(H=32){if(t.crypto&&typeof t.crypto.getRandomValues=="function")return t.crypto.getRandomValues(new Uint8Array(H));if(t.crypto&&typeof t.crypto.randomBytes=="function")return Uint8Array.from(t.crypto.randomBytes(H));throw new Error("crypto.getRandomValues must be defined")}})(utils$4)),utils$4}var hasRequired_md;function require_md(){if(hasRequired_md)return _md;hasRequired_md=1,Object.defineProperty(_md,"__esModule",{value:!0}),_md.SHA512_IV=_md.SHA384_IV=_md.SHA224_IV=_md.SHA256_IV=_md.HashMD=void 0,_md.setBigUint64=t,_md.Chi=r,_md.Maj=n;const e=requireUtils$4();function t(a,l,u,f){if(typeof a.setBigUint64=="function")return a.setBigUint64(l,u,f);const x=BigInt(32),p=BigInt(4294967295),g=Number(u>>x&p),y=Number(u&p),b=f?4:0,w=f?0:4;a.setUint32(l+b,g,f),a.setUint32(l+w,y,f)}function r(a,l,u){return a&l^~a&u}function n(a,l,u){return a&l^a&u^l&u}class o extends e.Hash{constructor(l,u,f,x){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=l,this.outputLen=u,this.padOffset=f,this.isLE=x,this.buffer=new Uint8Array(l),this.view=(0,e.createView)(this.buffer)}update(l){(0,e.aexists)(this),l=(0,e.toBytes)(l),(0,e.abytes)(l);const{view:u,buffer:f,blockLen:x}=this,p=l.length;for(let g=0;g<p;){const y=Math.min(x-this.pos,p-g);if(y===x){const b=(0,e.createView)(l);for(;x<=p-g;g+=x)this.process(b,g);continue}f.set(l.subarray(g,g+y),this.pos),this.pos+=y,g+=y,this.pos===x&&(this.process(u,0),this.pos=0)}return this.length+=l.length,this.roundClean(),this}digestInto(l){(0,e.aexists)(this),(0,e.aoutput)(l,this),this.finished=!0;const{buffer:u,view:f,blockLen:x,isLE:p}=this;let{pos:g}=this;u[g++]=128,(0,e.clean)(this.buffer.subarray(g)),this.padOffset>x-g&&(this.process(f,0),g=0);for(let B=g;B<x;B++)u[B]=0;t(f,x-8,BigInt(this.length*8),p),this.process(f,0);const y=(0,e.createView)(l),b=this.outputLen;if(b%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const w=b/4,v=this.get();if(w>v.length)throw new Error("_sha2: outputLen bigger than state");for(let B=0;B<w;B++)y.setUint32(4*B,v[B],p)}digest(){const{buffer:l,outputLen:u}=this;this.digestInto(l);const f=l.slice(0,u);return this.destroy(),f}_cloneInto(l){l||(l=new this.constructor),l.set(...this.get());const{blockLen:u,buffer:f,length:x,finished:p,destroyed:g,pos:y}=this;return l.destroyed=g,l.finished=p,l.length=x,l.pos=y,x%u&&l.buffer.set(f),l}clone(){return this._cloneInto()}}return _md.HashMD=o,_md.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),_md.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),_md.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),_md.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),_md}var _u64={},hasRequired_u64;function require_u64(){if(hasRequired_u64)return _u64;hasRequired_u64=1,Object.defineProperty(_u64,"__esModule",{value:!0}),_u64.toBig=_u64.shrSL=_u64.shrSH=_u64.rotrSL=_u64.rotrSH=_u64.rotrBL=_u64.rotrBH=_u64.rotr32L=_u64.rotr32H=_u64.rotlSL=_u64.rotlSH=_u64.rotlBL=_u64.rotlBH=_u64.add5L=_u64.add5H=_u64.add4L=_u64.add4H=_u64.add3L=_u64.add3H=void 0,_u64.add=j,_u64.fromBig=r,_u64.split=n;const e=BigInt(2**32-1),t=BigInt(32);function r($,z=!1){return z?{h:Number($&e),l:Number($>>t&e)}:{h:Number($>>t&e)|0,l:Number($&e)|0}}function n($,z=!1){const W=$.length;let U=new Uint32Array(W),I=new Uint32Array(W);for(let G=0;G<W;G++){const{h:k,l:M}=r($[G],z);[U[G],I[G]]=[k,M]}return[U,I]}const o=($,z)=>BigInt($>>>0)<<t|BigInt(z>>>0);_u64.toBig=o;const a=($,z,W)=>$>>>W;_u64.shrSH=a;const l=($,z,W)=>$<<32-W|z>>>W;_u64.shrSL=l;const u=($,z,W)=>$>>>W|z<<32-W;_u64.rotrSH=u;const f=($,z,W)=>$<<32-W|z>>>W;_u64.rotrSL=f;const x=($,z,W)=>$<<64-W|z>>>W-32;_u64.rotrBH=x;const p=($,z,W)=>$>>>W-32|z<<64-W;_u64.rotrBL=p;const g=($,z)=>z;_u64.rotr32H=g;const y=($,z)=>$;_u64.rotr32L=y;const b=($,z,W)=>$<<W|z>>>32-W;_u64.rotlSH=b;const w=($,z,W)=>z<<W|$>>>32-W;_u64.rotlSL=w;const v=($,z,W)=>z<<W-32|$>>>64-W;_u64.rotlBH=v;const B=($,z,W)=>$<<W-32|z>>>64-W;_u64.rotlBL=B;function j($,z,W,U){const I=(z>>>0)+(U>>>0);return{h:$+W+(I/2**32|0)|0,l:I|0}}const F=($,z,W)=>($>>>0)+(z>>>0)+(W>>>0);_u64.add3L=F;const C=($,z,W,U)=>z+W+U+($/2**32|0)|0;_u64.add3H=C;const N=($,z,W,U)=>($>>>0)+(z>>>0)+(W>>>0)+(U>>>0);_u64.add4L=N;const T=($,z,W,U,I)=>z+W+U+I+($/2**32|0)|0;_u64.add4H=T;const _=($,z,W,U,I)=>($>>>0)+(z>>>0)+(W>>>0)+(U>>>0)+(I>>>0);_u64.add5L=_;const S=($,z,W,U,I,G)=>z+W+U+I+G+($/2**32|0)|0;_u64.add5H=S;const O={fromBig:r,split:n,toBig:o,shrSH:a,shrSL:l,rotrSH:u,rotrSL:f,rotrBH:x,rotrBL:p,rotr32H:g,rotr32L:y,rotlSH:b,rotlSL:w,rotlBH:v,rotlBL:B,add:j,add3L:F,add3H:C,add4L:N,add4H:T,add5H:S,add5L:_};return _u64.default=O,_u64}var hasRequiredSha2;function requireSha2(){if(hasRequiredSha2)return sha2;hasRequiredSha2=1,Object.defineProperty(sha2,"__esModule",{value:!0}),sha2.sha512_224=sha2.sha512_256=sha2.sha384=sha2.sha512=sha2.sha224=sha2.sha256=sha2.SHA512_256=sha2.SHA512_224=sha2.SHA384=sha2.SHA512=sha2.SHA224=sha2.SHA256=void 0;const e=require_md(),t=require_u64(),r=requireUtils$4(),n=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),o=new Uint32Array(64);class a extends e.HashMD{constructor(C=32){super(64,C,8,!1),this.A=e.SHA256_IV[0]|0,this.B=e.SHA256_IV[1]|0,this.C=e.SHA256_IV[2]|0,this.D=e.SHA256_IV[3]|0,this.E=e.SHA256_IV[4]|0,this.F=e.SHA256_IV[5]|0,this.G=e.SHA256_IV[6]|0,this.H=e.SHA256_IV[7]|0}get(){const{A:C,B:N,C:T,D:_,E:S,F:O,G:$,H:z}=this;return[C,N,T,_,S,O,$,z]}set(C,N,T,_,S,O,$,z){this.A=C|0,this.B=N|0,this.C=T|0,this.D=_|0,this.E=S|0,this.F=O|0,this.G=$|0,this.H=z|0}process(C,N){for(let I=0;I<16;I++,N+=4)o[I]=C.getUint32(N,!1);for(let I=16;I<64;I++){const G=o[I-15],k=o[I-2],M=(0,r.rotr)(G,7)^(0,r.rotr)(G,18)^G>>>3,q=(0,r.rotr)(k,17)^(0,r.rotr)(k,19)^k>>>10;o[I]=q+o[I-7]+M+o[I-16]|0}let{A:T,B:_,C:S,D:O,E:$,F:z,G:W,H:U}=this;for(let I=0;I<64;I++){const G=(0,r.rotr)($,6)^(0,r.rotr)($,11)^(0,r.rotr)($,25),k=U+G+(0,e.Chi)($,z,W)+n[I]+o[I]|0,q=((0,r.rotr)(T,2)^(0,r.rotr)(T,13)^(0,r.rotr)(T,22))+(0,e.Maj)(T,_,S)|0;U=W,W=z,z=$,$=O+k|0,O=S,S=_,_=T,T=k+q|0}T=T+this.A|0,_=_+this.B|0,S=S+this.C|0,O=O+this.D|0,$=$+this.E|0,z=z+this.F|0,W=W+this.G|0,U=U+this.H|0,this.set(T,_,S,O,$,z,W,U)}roundClean(){(0,r.clean)(o)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,r.clean)(this.buffer)}}sha2.SHA256=a;class l extends a{constructor(){super(28),this.A=e.SHA224_IV[0]|0,this.B=e.SHA224_IV[1]|0,this.C=e.SHA224_IV[2]|0,this.D=e.SHA224_IV[3]|0,this.E=e.SHA224_IV[4]|0,this.F=e.SHA224_IV[5]|0,this.G=e.SHA224_IV[6]|0,this.H=e.SHA224_IV[7]|0}}sha2.SHA224=l;const u=t.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(F=>BigInt(F))),f=u[0],x=u[1],p=new Uint32Array(80),g=new Uint32Array(80);class y extends e.HashMD{constructor(C=64){super(128,C,16,!1),this.Ah=e.SHA512_IV[0]|0,this.Al=e.SHA512_IV[1]|0,this.Bh=e.SHA512_IV[2]|0,this.Bl=e.SHA512_IV[3]|0,this.Ch=e.SHA512_IV[4]|0,this.Cl=e.SHA512_IV[5]|0,this.Dh=e.SHA512_IV[6]|0,this.Dl=e.SHA512_IV[7]|0,this.Eh=e.SHA512_IV[8]|0,this.El=e.SHA512_IV[9]|0,this.Fh=e.SHA512_IV[10]|0,this.Fl=e.SHA512_IV[11]|0,this.Gh=e.SHA512_IV[12]|0,this.Gl=e.SHA512_IV[13]|0,this.Hh=e.SHA512_IV[14]|0,this.Hl=e.SHA512_IV[15]|0}get(){const{Ah:C,Al:N,Bh:T,Bl:_,Ch:S,Cl:O,Dh:$,Dl:z,Eh:W,El:U,Fh:I,Fl:G,Gh:k,Gl:M,Hh:q,Hl:K}=this;return[C,N,T,_,S,O,$,z,W,U,I,G,k,M,q,K]}set(C,N,T,_,S,O,$,z,W,U,I,G,k,M,q,K){this.Ah=C|0,this.Al=N|0,this.Bh=T|0,this.Bl=_|0,this.Ch=S|0,this.Cl=O|0,this.Dh=$|0,this.Dl=z|0,this.Eh=W|0,this.El=U|0,this.Fh=I|0,this.Fl=G|0,this.Gh=k|0,this.Gl=M|0,this.Hh=q|0,this.Hl=K|0}process(C,N){for(let D=0;D<16;D++,N+=4)p[D]=C.getUint32(N),g[D]=C.getUint32(N+=4);for(let D=16;D<80;D++){const Y=p[D-15]|0,J=g[D-15]|0,L=t.rotrSH(Y,J,1)^t.rotrSH(Y,J,8)^t.shrSH(Y,J,7),Z=t.rotrSL(Y,J,1)^t.rotrSL(Y,J,8)^t.shrSL(Y,J,7),oe=p[D-2]|0,ce=g[D-2]|0,de=t.rotrSH(oe,ce,19)^t.rotrBH(oe,ce,61)^t.shrSH(oe,ce,6),xe=t.rotrSL(oe,ce,19)^t.rotrBL(oe,ce,61)^t.shrSL(oe,ce,6),te=t.add4L(Z,xe,g[D-7],g[D-16]),ae=t.add4H(te,L,de,p[D-7],p[D-16]);p[D]=ae|0,g[D]=te|0}let{Ah:T,Al:_,Bh:S,Bl:O,Ch:$,Cl:z,Dh:W,Dl:U,Eh:I,El:G,Fh:k,Fl:M,Gh:q,Gl:K,Hh:H,Hl:Q}=this;for(let D=0;D<80;D++){const Y=t.rotrSH(I,G,14)^t.rotrSH(I,G,18)^t.rotrBH(I,G,41),J=t.rotrSL(I,G,14)^t.rotrSL(I,G,18)^t.rotrBL(I,G,41),L=I&k^~I&q,Z=G&M^~G&K,oe=t.add5L(Q,J,Z,x[D],g[D]),ce=t.add5H(oe,H,Y,L,f[D],p[D]),de=oe|0,xe=t.rotrSH(T,_,28)^t.rotrBH(T,_,34)^t.rotrBH(T,_,39),te=t.rotrSL(T,_,28)^t.rotrBL(T,_,34)^t.rotrBL(T,_,39),ae=T&S^T&$^S&$,le=_&O^_&z^O&z;H=q|0,Q=K|0,q=k|0,K=M|0,k=I|0,M=G|0,{h:I,l:G}=t.add(W|0,U|0,ce|0,de|0),W=$|0,U=z|0,$=S|0,z=O|0,S=T|0,O=_|0;const ue=t.add3L(de,te,le);T=t.add3H(ue,ce,xe,ae),_=ue|0}({h:T,l:_}=t.add(this.Ah|0,this.Al|0,T|0,_|0)),{h:S,l:O}=t.add(this.Bh|0,this.Bl|0,S|0,O|0),{h:$,l:z}=t.add(this.Ch|0,this.Cl|0,$|0,z|0),{h:W,l:U}=t.add(this.Dh|0,this.Dl|0,W|0,U|0),{h:I,l:G}=t.add(this.Eh|0,this.El|0,I|0,G|0),{h:k,l:M}=t.add(this.Fh|0,this.Fl|0,k|0,M|0),{h:q,l:K}=t.add(this.Gh|0,this.Gl|0,q|0,K|0),{h:H,l:Q}=t.add(this.Hh|0,this.Hl|0,H|0,Q|0),this.set(T,_,S,O,$,z,W,U,I,G,k,M,q,K,H,Q)}roundClean(){(0,r.clean)(p,g)}destroy(){(0,r.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}sha2.SHA512=y;class b extends y{constructor(){super(48),this.Ah=e.SHA384_IV[0]|0,this.Al=e.SHA384_IV[1]|0,this.Bh=e.SHA384_IV[2]|0,this.Bl=e.SHA384_IV[3]|0,this.Ch=e.SHA384_IV[4]|0,this.Cl=e.SHA384_IV[5]|0,this.Dh=e.SHA384_IV[6]|0,this.Dl=e.SHA384_IV[7]|0,this.Eh=e.SHA384_IV[8]|0,this.El=e.SHA384_IV[9]|0,this.Fh=e.SHA384_IV[10]|0,this.Fl=e.SHA384_IV[11]|0,this.Gh=e.SHA384_IV[12]|0,this.Gl=e.SHA384_IV[13]|0,this.Hh=e.SHA384_IV[14]|0,this.Hl=e.SHA384_IV[15]|0}}sha2.SHA384=b;const w=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),v=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class B extends y{constructor(){super(28),this.Ah=w[0]|0,this.Al=w[1]|0,this.Bh=w[2]|0,this.Bl=w[3]|0,this.Ch=w[4]|0,this.Cl=w[5]|0,this.Dh=w[6]|0,this.Dl=w[7]|0,this.Eh=w[8]|0,this.El=w[9]|0,this.Fh=w[10]|0,this.Fl=w[11]|0,this.Gh=w[12]|0,this.Gl=w[13]|0,this.Hh=w[14]|0,this.Hl=w[15]|0}}sha2.SHA512_224=B;class j extends y{constructor(){super(32),this.Ah=v[0]|0,this.Al=v[1]|0,this.Bh=v[2]|0,this.Bl=v[3]|0,this.Ch=v[4]|0,this.Cl=v[5]|0,this.Dh=v[6]|0,this.Dl=v[7]|0,this.Eh=v[8]|0,this.El=v[9]|0,this.Fh=v[10]|0,this.Fl=v[11]|0,this.Gh=v[12]|0,this.Gl=v[13]|0,this.Hh=v[14]|0,this.Hl=v[15]|0}}return sha2.SHA512_256=j,sha2.sha256=(0,r.createHasher)(()=>new a),sha2.sha224=(0,r.createHasher)(()=>new l),sha2.sha512=(0,r.createHasher)(()=>new y),sha2.sha384=(0,r.createHasher)(()=>new b),sha2.sha512_256=(0,r.createHasher)(()=>new j),sha2.sha512_224=(0,r.createHasher)(()=>new B),sha2}var _shortw_utils={},weierstrass={},hmac={},hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;const t=requireUtils$4();class r extends t.Hash{constructor(a,l){super(),this.finished=!1,this.destroyed=!1,(0,t.ahash)(a);const u=(0,t.toBytes)(l);if(this.iHash=a.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const f=this.blockLen,x=new Uint8Array(f);x.set(u.length>f?a.create().update(u).digest():u);for(let p=0;p<x.length;p++)x[p]^=54;this.iHash.update(x),this.oHash=a.create();for(let p=0;p<x.length;p++)x[p]^=106;this.oHash.update(x),(0,t.clean)(x)}update(a){return(0,t.aexists)(this),this.iHash.update(a),this}digestInto(a){(0,t.aexists)(this),(0,t.abytes)(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){const a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));const{oHash:l,iHash:u,finished:f,destroyed:x,blockLen:p,outputLen:g}=this;return a=a,a.finished=f,a.destroyed=x,a.blockLen=p,a.outputLen=g,a.oHash=l._cloneInto(a.oHash),a.iHash=u._cloneInto(a.iHash),a}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.HMAC=r;const n=(o,a,l)=>new r(o,a).update(l).digest();e.hmac=n,e.hmac.create=(o,a)=>new r(o,a)})(hmac)),hmac}var utils$3={},hasRequiredUtils$3;function requireUtils$3(){return hasRequiredUtils$3||(hasRequiredUtils$3=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.notImplemented=e.bitMask=e.utf8ToBytes=e.randomBytes=e.isBytes=e.hexToBytes=e.concatBytes=e.bytesToUtf8=e.bytesToHex=e.anumber=e.abytes=void 0,e.abool=a,e._abool2=l,e._abytes2=u,e.numberToHexUnpadded=f,e.hexToNumber=x,e.bytesToNumberBE=p,e.bytesToNumberLE=g,e.numberToBytesBE=y,e.numberToBytesLE=b,e.numberToVarBytesBE=w,e.ensureBytes=v,e.equalBytes=B,e.copyBytes=j,e.asciiToBytes=F,e.inRange=N,e.aInRange=T,e.bitLen=_,e.bitGet=S,e.bitSet=O,e.createHmacDrbg=z,e.validateObject=U,e.isHash=I,e._validateObject=G,e.memoized=M;const t=requireUtils$4();var r=requireUtils$4();Object.defineProperty(e,"abytes",{enumerable:!0,get:function(){return r.abytes}}),Object.defineProperty(e,"anumber",{enumerable:!0,get:function(){return r.anumber}}),Object.defineProperty(e,"bytesToHex",{enumerable:!0,get:function(){return r.bytesToHex}}),Object.defineProperty(e,"bytesToUtf8",{enumerable:!0,get:function(){return r.bytesToUtf8}}),Object.defineProperty(e,"concatBytes",{enumerable:!0,get:function(){return r.concatBytes}}),Object.defineProperty(e,"hexToBytes",{enumerable:!0,get:function(){return r.hexToBytes}}),Object.defineProperty(e,"isBytes",{enumerable:!0,get:function(){return r.isBytes}}),Object.defineProperty(e,"randomBytes",{enumerable:!0,get:function(){return r.randomBytes}}),Object.defineProperty(e,"utf8ToBytes",{enumerable:!0,get:function(){return r.utf8ToBytes}});const n=BigInt(0),o=BigInt(1);function a(q,K){if(typeof K!="boolean")throw new Error(q+" boolean expected, got "+K)}function l(q,K=""){if(typeof q!="boolean"){const H=K&&`"${K}"`;throw new Error(H+"expected boolean, got type="+typeof q)}return q}function u(q,K,H=""){const Q=(0,t.isBytes)(q),D=q?.length,Y=K!==void 0;if(!Q||Y&&D!==K){const J=H&&`"${H}" `,L=Y?` of length ${K}`:"",Z=Q?`length=${D}`:`type=${typeof q}`;throw new Error(J+"expected Uint8Array"+L+", got "+Z)}return q}function f(q){const K=q.toString(16);return K.length&1?"0"+K:K}function x(q){if(typeof q!="string")throw new Error("hex string expected, got "+typeof q);return q===""?n:BigInt("0x"+q)}function p(q){return x((0,t.bytesToHex)(q))}function g(q){return(0,t.abytes)(q),x((0,t.bytesToHex)(Uint8Array.from(q).reverse()))}function y(q,K){return(0,t.hexToBytes)(q.toString(16).padStart(K*2,"0"))}function b(q,K){return y(q,K).reverse()}function w(q){return(0,t.hexToBytes)(f(q))}function v(q,K,H){let Q;if(typeof K=="string")try{Q=(0,t.hexToBytes)(K)}catch(Y){throw new Error(q+" must be hex string or Uint8Array, cause: "+Y)}else if((0,t.isBytes)(K))Q=Uint8Array.from(K);else throw new Error(q+" must be hex string or Uint8Array");const D=Q.length;if(typeof H=="number"&&D!==H)throw new Error(q+" of length "+H+" expected, got "+D);return Q}function B(q,K){if(q.length!==K.length)return!1;let H=0;for(let Q=0;Q<q.length;Q++)H|=q[Q]^K[Q];return H===0}function j(q){return Uint8Array.from(q)}function F(q){return Uint8Array.from(q,(K,H)=>{const Q=K.charCodeAt(0);if(K.length!==1||Q>127)throw new Error(`string contains non-ASCII character "${q[H]}" with code ${Q} at position ${H}`);return Q})}const C=q=>typeof q=="bigint"&&n<=q;function N(q,K,H){return C(q)&&C(K)&&C(H)&&K<=q&&q<H}function T(q,K,H,Q){if(!N(K,H,Q))throw new Error("expected valid "+q+": "+H+" <= n < "+Q+", got "+K)}function _(q){let K;for(K=0;q>n;q>>=o,K+=1);return K}function S(q,K){return q>>BigInt(K)&o}function O(q,K,H){return q|(H?o:n)<<BigInt(K)}const $=q=>(o<<BigInt(q))-o;e.bitMask=$;function z(q,K,H){if(typeof q!="number"||q<2)throw new Error("hashLen must be a number");if(typeof K!="number"||K<2)throw new Error("qByteLen must be a number");if(typeof H!="function")throw new Error("hmacFn must be a function");const Q=te=>new Uint8Array(te),D=te=>Uint8Array.of(te);let Y=Q(q),J=Q(q),L=0;const Z=()=>{Y.fill(1),J.fill(0),L=0},oe=(...te)=>H(J,Y,...te),ce=(te=Q(0))=>{J=oe(D(0),te),Y=oe(),te.length!==0&&(J=oe(D(1),te),Y=oe())},de=()=>{if(L++>=1e3)throw new Error("drbg: tried 1000 values");let te=0;const ae=[];for(;te<K;){Y=oe();const le=Y.slice();ae.push(le),te+=Y.length}return(0,t.concatBytes)(...ae)};return(te,ae)=>{Z(),ce(te);let le;for(;!(le=ae(de()));)ce();return Z(),le}}const W={bigint:q=>typeof q=="bigint",function:q=>typeof q=="function",boolean:q=>typeof q=="boolean",string:q=>typeof q=="string",stringOrUint8Array:q=>typeof q=="string"||(0,t.isBytes)(q),isSafeInteger:q=>Number.isSafeInteger(q),array:q=>Array.isArray(q),field:(q,K)=>K.Fp.isValid(q),hash:q=>typeof q=="function"&&Number.isSafeInteger(q.outputLen)};function U(q,K,H={}){const Q=(D,Y,J)=>{const L=W[Y];if(typeof L!="function")throw new Error("invalid validator function");const Z=q[D];if(!(J&&Z===void 0)&&!L(Z,q))throw new Error("param "+String(D)+" is invalid. Expected "+Y+", got "+Z)};for(const[D,Y]of Object.entries(K))Q(D,Y,!1);for(const[D,Y]of Object.entries(H))Q(D,Y,!0);return q}function I(q){return typeof q=="function"&&Number.isSafeInteger(q.outputLen)}function G(q,K,H={}){if(!q||typeof q!="object")throw new Error("expected valid options object");function Q(D,Y,J){const L=q[D];if(J&&L===void 0)return;const Z=typeof L;if(Z!==Y||L===null)throw new Error(`param "${D}" is invalid: expected ${Y}, got ${Z}`)}Object.entries(K).forEach(([D,Y])=>Q(D,Y,!1)),Object.entries(H).forEach(([D,Y])=>Q(D,Y,!0))}const k=()=>{throw new Error("not implemented")};e.notImplemented=k;function M(q){const K=new WeakMap;return(H,...Q)=>{const D=K.get(H);if(D!==void 0)return D;const Y=q(H,...Q);return K.set(H,Y),Y}}})(utils$3)),utils$3}var curve={},modular={},hasRequiredModular;function requireModular(){if(hasRequiredModular)return modular;hasRequiredModular=1,Object.defineProperty(modular,"__esModule",{value:!0}),modular.isNegativeLE=void 0,modular.mod=g,modular.pow=y,modular.pow2=b,modular.invert=w,modular.tonelliShanks=C,modular.FpSqrt=N,modular.validateField=S,modular.FpPow=O,modular.FpInvertBatch=$,modular.FpDiv=z,modular.FpLegendre=W,modular.FpIsSquare=U,modular.nLength=I,modular.Field=G,modular.FpSqrtOdd=k,modular.FpSqrtEven=M,modular.hashToPrivateScalar=q,modular.getFieldBytesLength=K,modular.getMinHashLength=H,modular.mapHashToField=Q;const e=requireUtils$3(),t=BigInt(0),r=BigInt(1),n=BigInt(2),o=BigInt(3),a=BigInt(4),l=BigInt(5),u=BigInt(7),f=BigInt(8),x=BigInt(9),p=BigInt(16);function g(D,Y){const J=D%Y;return J>=t?J:Y+J}function y(D,Y,J){return O(G(J),D,Y)}function b(D,Y,J){let L=D;for(;Y-- >t;)L*=L,L%=J;return L}function w(D,Y){if(D===t)throw new Error("invert: expected non-zero number");if(Y<=t)throw new Error("invert: expected positive modulus, got "+Y);let J=g(D,Y),L=Y,Z=t,oe=r;for(;J!==t;){const de=L/J,xe=L%J,te=Z-oe*de;L=J,J=xe,Z=oe,oe=te}if(L!==r)throw new Error("invert: does not exist");return g(Z,Y)}function v(D,Y,J){if(!D.eql(D.sqr(Y),J))throw new Error("Cannot find square root")}function B(D,Y){const J=(D.ORDER+r)/a,L=D.pow(Y,J);return v(D,L,Y),L}function j(D,Y){const J=(D.ORDER-l)/f,L=D.mul(Y,n),Z=D.pow(L,J),oe=D.mul(Y,Z),ce=D.mul(D.mul(oe,n),Z),de=D.mul(oe,D.sub(ce,D.ONE));return v(D,de,Y),de}function F(D){const Y=G(D),J=C(D),L=J(Y,Y.neg(Y.ONE)),Z=J(Y,L),oe=J(Y,Y.neg(L)),ce=(D+u)/p;return(de,xe)=>{let te=de.pow(xe,ce),ae=de.mul(te,L);const le=de.mul(te,Z),ue=de.mul(te,oe),be=de.eql(de.sqr(ae),xe),Be=de.eql(de.sqr(le),xe);te=de.cmov(te,ae,be),ae=de.cmov(ue,le,Be);const Ce=de.eql(de.sqr(ae),xe),Se=de.cmov(te,ae,Ce);return v(de,Se,xe),Se}}function C(D){if(D<o)throw new Error("sqrt is not defined for small field");let Y=D-r,J=0;for(;Y%n===t;)Y/=n,J++;let L=n;const Z=G(D);for(;W(Z,L)===1;)if(L++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(J===1)return B;let oe=Z.pow(L,Y);const ce=(Y+r)/n;return function(xe,te){if(xe.is0(te))return te;if(W(xe,te)!==1)throw new Error("Cannot find square root");let ae=J,le=xe.mul(xe.ONE,oe),ue=xe.pow(te,Y),be=xe.pow(te,ce);for(;!xe.eql(ue,xe.ONE);){if(xe.is0(ue))return xe.ZERO;let Be=1,Ce=xe.sqr(ue);for(;!xe.eql(Ce,xe.ONE);)if(Be++,Ce=xe.sqr(Ce),Be===ae)throw new Error("Cannot find square root");const Se=r<<BigInt(ae-Be-1),ke=xe.pow(le,Se);ae=Be,le=xe.sqr(ke),ue=xe.mul(ue,le),be=xe.mul(be,ke)}return be}}function N(D){return D%a===o?B:D%f===l?j:D%p===x?F(D):C(D)}const T=(D,Y)=>(g(D,Y)&r)===r;modular.isNegativeLE=T;const _=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function S(D){const Y={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},J=_.reduce((L,Z)=>(L[Z]="function",L),Y);return(0,e._validateObject)(D,J),D}function O(D,Y,J){if(J<t)throw new Error("invalid exponent, negatives unsupported");if(J===t)return D.ONE;if(J===r)return Y;let L=D.ONE,Z=Y;for(;J>t;)J&r&&(L=D.mul(L,Z)),Z=D.sqr(Z),J>>=r;return L}function $(D,Y,J=!1){const L=new Array(Y.length).fill(J?D.ZERO:void 0),Z=Y.reduce((ce,de,xe)=>D.is0(de)?ce:(L[xe]=ce,D.mul(ce,de)),D.ONE),oe=D.inv(Z);return Y.reduceRight((ce,de,xe)=>D.is0(de)?ce:(L[xe]=D.mul(ce,L[xe]),D.mul(ce,de)),oe),L}function z(D,Y,J){return D.mul(Y,typeof J=="bigint"?w(J,D.ORDER):D.inv(J))}function W(D,Y){const J=(D.ORDER-r)/n,L=D.pow(Y,J),Z=D.eql(L,D.ONE),oe=D.eql(L,D.ZERO),ce=D.eql(L,D.neg(D.ONE));if(!Z&&!oe&&!ce)throw new Error("invalid Legendre symbol result");return Z?1:oe?0:-1}function U(D,Y){return W(D,Y)===1}function I(D,Y){Y!==void 0&&(0,e.anumber)(Y);const J=Y!==void 0?Y:D.toString(2).length,L=Math.ceil(J/8);return{nBitLength:J,nByteLength:L}}function G(D,Y,J=!1,L={}){if(D<=t)throw new Error("invalid field: expected ORDER > 0, got "+D);let Z,oe,ce=!1,de;if(typeof Y=="object"&&Y!=null){if(L.sqrt||J)throw new Error("cannot specify opts in two arguments");const ue=Y;ue.BITS&&(Z=ue.BITS),ue.sqrt&&(oe=ue.sqrt),typeof ue.isLE=="boolean"&&(J=ue.isLE),typeof ue.modFromBytes=="boolean"&&(ce=ue.modFromBytes),de=ue.allowedLengths}else typeof Y=="number"&&(Z=Y),L.sqrt&&(oe=L.sqrt);const{nBitLength:xe,nByteLength:te}=I(D,Z);if(te>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let ae;const le=Object.freeze({ORDER:D,isLE:J,BITS:xe,BYTES:te,MASK:(0,e.bitMask)(xe),ZERO:t,ONE:r,allowedLengths:de,create:ue=>g(ue,D),isValid:ue=>{if(typeof ue!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof ue);return t<=ue&&ue<D},is0:ue=>ue===t,isValidNot0:ue=>!le.is0(ue)&&le.isValid(ue),isOdd:ue=>(ue&r)===r,neg:ue=>g(-ue,D),eql:(ue,be)=>ue===be,sqr:ue=>g(ue*ue,D),add:(ue,be)=>g(ue+be,D),sub:(ue,be)=>g(ue-be,D),mul:(ue,be)=>g(ue*be,D),pow:(ue,be)=>O(le,ue,be),div:(ue,be)=>g(ue*w(be,D),D),sqrN:ue=>ue*ue,addN:(ue,be)=>ue+be,subN:(ue,be)=>ue-be,mulN:(ue,be)=>ue*be,inv:ue=>w(ue,D),sqrt:oe||(ue=>(ae||(ae=N(D)),ae(le,ue))),toBytes:ue=>J?(0,e.numberToBytesLE)(ue,te):(0,e.numberToBytesBE)(ue,te),fromBytes:(ue,be=!0)=>{if(de){if(!de.includes(ue.length)||ue.length>te)throw new Error("Field.fromBytes: expected "+de+" bytes, got "+ue.length);const Ce=new Uint8Array(te);Ce.set(ue,J?0:Ce.length-ue.length),ue=Ce}if(ue.length!==te)throw new Error("Field.fromBytes: expected "+te+" bytes, got "+ue.length);let Be=J?(0,e.bytesToNumberLE)(ue):(0,e.bytesToNumberBE)(ue);if(ce&&(Be=g(Be,D)),!be&&!le.isValid(Be))throw new Error("invalid field element: outside of range 0..ORDER");return Be},invertBatch:ue=>$(le,ue),cmov:(ue,be,Be)=>Be?be:ue});return Object.freeze(le)}function k(D,Y){if(!D.isOdd)throw new Error("Field doesn't have isOdd");const J=D.sqrt(Y);return D.isOdd(J)?J:D.neg(J)}function M(D,Y){if(!D.isOdd)throw new Error("Field doesn't have isOdd");const J=D.sqrt(Y);return D.isOdd(J)?D.neg(J):J}function q(D,Y,J=!1){D=(0,e.ensureBytes)("privateHash",D);const L=D.length,Z=I(Y).nByteLength+8;if(Z<24||L<Z||L>1024)throw new Error("hashToPrivateScalar: expected "+Z+"-1024 bytes of input, got "+L);const oe=J?(0,e.bytesToNumberLE)(D):(0,e.bytesToNumberBE)(D);return g(oe,Y-r)+r}function K(D){if(typeof D!="bigint")throw new Error("field order must be bigint");const Y=D.toString(2).length;return Math.ceil(Y/8)}function H(D){const Y=K(D);return Y+Math.ceil(Y/2)}function Q(D,Y,J=!1){const L=D.length,Z=K(Y),oe=H(Y);if(L<16||L<oe||L>1024)throw new Error("expected "+oe+"-1024 bytes of input, got "+L);const ce=J?(0,e.bytesToNumberLE)(D):(0,e.bytesToNumberBE)(D),de=g(ce,Y-r)+r;return J?(0,e.numberToBytesLE)(de,Z):(0,e.numberToBytesBE)(de,Z)}return modular}var hasRequiredCurve;function requireCurve(){if(hasRequiredCurve)return curve;hasRequiredCurve=1,Object.defineProperty(curve,"__esModule",{value:!0}),curve.wNAF=void 0,curve.negateCt=o,curve.normalizeZ=a,curve.mulEndoUnsafe=B,curve.pippenger=j,curve.precomputeMSMUnsafe=F,curve.validateBasic=C,curve._createCurveFields=T;const e=requireUtils$3(),t=requireModular(),r=BigInt(0),n=BigInt(1);function o(_,S){const O=S.negate();return _?O:S}function a(_,S){const O=(0,t.FpInvertBatch)(_.Fp,S.map($=>$.Z));return S.map(($,z)=>_.fromAffine($.toAffine(O[z])))}function l(_,S){if(!Number.isSafeInteger(_)||_<=0||_>S)throw new Error("invalid window size, expected [1.."+S+"], got W="+_)}function u(_,S){l(_,S);const O=Math.ceil(S/_)+1,$=2**(_-1),z=2**_,W=(0,e.bitMask)(_),U=BigInt(_);return{windows:O,windowSize:$,mask:W,maxNumber:z,shiftBy:U}}function f(_,S,O){const{windowSize:$,mask:z,maxNumber:W,shiftBy:U}=O;let I=Number(_&z),G=_>>U;I>$&&(I-=W,G+=n);const k=S*$,M=k+Math.abs(I)-1,q=I===0,K=I<0,H=S%2!==0;return{nextN:G,offset:M,isZero:q,isNeg:K,isNegF:H,offsetF:k}}function x(_,S){if(!Array.isArray(_))throw new Error("array expected");_.forEach((O,$)=>{if(!(O instanceof S))throw new Error("invalid point at index "+$)})}function p(_,S){if(!Array.isArray(_))throw new Error("array of scalars expected");_.forEach((O,$)=>{if(!S.isValid(O))throw new Error("invalid scalar at index "+$)})}const g=new WeakMap,y=new WeakMap;function b(_){return y.get(_)||1}function w(_){if(_!==r)throw new Error("invalid wNAF")}class v{constructor(S,O){this.BASE=S.BASE,this.ZERO=S.ZERO,this.Fn=S.Fn,this.bits=O}_unsafeLadder(S,O,$=this.ZERO){let z=S;for(;O>r;)O&n&&($=$.add(z)),z=z.double(),O>>=n;return $}precomputeWindow(S,O){const{windows:$,windowSize:z}=u(O,this.bits),W=[];let U=S,I=U;for(let G=0;G<$;G++){I=U,W.push(I);for(let k=1;k<z;k++)I=I.add(U),W.push(I);U=I.double()}return W}wNAF(S,O,$){if(!this.Fn.isValid($))throw new Error("invalid scalar");let z=this.ZERO,W=this.BASE;const U=u(S,this.bits);for(let I=0;I<U.windows;I++){const{nextN:G,offset:k,isZero:M,isNeg:q,isNegF:K,offsetF:H}=f($,I,U);$=G,M?W=W.add(o(K,O[H])):z=z.add(o(q,O[k]))}return w($),{p:z,f:W}}wNAFUnsafe(S,O,$,z=this.ZERO){const W=u(S,this.bits);for(let U=0;U<W.windows&&$!==r;U++){const{nextN:I,offset:G,isZero:k,isNeg:M}=f($,U,W);if($=I,!k){const q=O[G];z=z.add(M?q.negate():q)}}return w($),z}getPrecomputes(S,O,$){let z=g.get(O);return z||(z=this.precomputeWindow(O,S),S!==1&&(typeof $=="function"&&(z=$(z)),g.set(O,z))),z}cached(S,O,$){const z=b(S);return this.wNAF(z,this.getPrecomputes(z,S,$),O)}unsafe(S,O,$,z){const W=b(S);return W===1?this._unsafeLadder(S,O,z):this.wNAFUnsafe(W,this.getPrecomputes(W,S,$),O,z)}createCache(S,O){l(O,this.bits),y.set(S,O),g.delete(S)}hasCache(S){return b(S)!==1}}curve.wNAF=v;function B(_,S,O,$){let z=S,W=_.ZERO,U=_.ZERO;for(;O>r||$>r;)O&n&&(W=W.add(z)),$&n&&(U=U.add(z)),z=z.double(),O>>=n,$>>=n;return{p1:W,p2:U}}function j(_,S,O,$){x(O,_),p($,S);const z=O.length,W=$.length;if(z!==W)throw new Error("arrays of points and scalars must have equal length");const U=_.ZERO,I=(0,e.bitLen)(BigInt(z));let G=1;I>12?G=I-3:I>4?G=I-2:I>0&&(G=2);const k=(0,e.bitMask)(G),M=new Array(Number(k)+1).fill(U),q=Math.floor((S.BITS-1)/G)*G;let K=U;for(let H=q;H>=0;H-=G){M.fill(U);for(let D=0;D<W;D++){const Y=$[D],J=Number(Y>>BigInt(H)&k);M[J]=M[J].add(O[D])}let Q=U;for(let D=M.length-1,Y=U;D>0;D--)Y=Y.add(M[D]),Q=Q.add(Y);if(K=K.add(Q),H!==0)for(let D=0;D<G;D++)K=K.double()}return K}function F(_,S,O,$){l($,S.BITS),x(O,_);const z=_.ZERO,W=2**$-1,U=Math.ceil(S.BITS/$),I=(0,e.bitMask)($),G=O.map(k=>{const M=[];for(let q=0,K=k;q<W;q++)M.push(K),K=K.add(k);return M});return k=>{if(p(k,S),k.length>O.length)throw new Error("array of scalars must be smaller than array of points");let M=z;for(let q=0;q<U;q++){if(M!==z)for(let H=0;H<$;H++)M=M.double();const K=BigInt(U*$-(q+1)*$);for(let H=0;H<k.length;H++){const Q=k[H],D=Number(Q>>K&I);D&&(M=M.add(G[H][D-1]))}}return M}}function C(_){return(0,t.validateField)(_.Fp),(0,e.validateObject)(_,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,t.nLength)(_.n,_.nBitLength),..._,p:_.Fp.ORDER})}function N(_,S,O){if(S){if(S.ORDER!==_)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,t.validateField)(S),S}else return(0,t.Field)(_,{isLE:O})}function T(_,S,O={},$){if($===void 0&&($=_==="edwards"),!S||typeof S!="object")throw new Error(`expected valid ${_} CURVE object`);for(const G of["p","n","h"]){const k=S[G];if(!(typeof k=="bigint"&&k>r))throw new Error(`CURVE.${G} must be positive bigint`)}const z=N(S.p,O.Fp,$),W=N(S.n,O.Fn,$),I=["Gx","Gy","a",_==="weierstrass"?"b":"d"];for(const G of I)if(!z.isValid(S[G]))throw new Error(`CURVE.${G} must be valid field element of CURVE.Fp`);return S=Object.freeze(Object.assign({},S)),{CURVE:S,Fp:z,Fn:W}}return curve}var hasRequiredWeierstrass;function requireWeierstrass(){return hasRequiredWeierstrass||(hasRequiredWeierstrass=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DER=e.DERErr=void 0,e._splitEndoScalar=u,e._normFnElement=B,e.weierstrassN=j,e.SWUFpSqrtRatio=C,e.mapToCurveSimpleSWU=N,e.ecdh=_,e.ecdsa=S,e.weierstrassPoints=O,e._legacyHelperEquat=W,e.weierstrass=G;const t=requireHmac(),r=requireUtils$4(),n=requireUtils$3(),o=requireCurve(),a=requireModular(),l=(k,M)=>(k+(k>=0?M:-M)/b)/M;function u(k,M,q){const[[K,H],[Q,D]]=M,Y=l(D*k,q),J=l(-H*k,q);let L=k-Y*K-J*Q,Z=-Y*H-J*D;const oe=L<g,ce=Z<g;oe&&(L=-L),ce&&(Z=-Z);const de=(0,n.bitMask)(Math.ceil((0,n.bitLen)(q)/2))+y;if(L<g||L>=de||Z<g||Z>=de)throw new Error("splitScalar (endomorphism): failed, k="+k);return{k1neg:oe,k1:L,k2neg:ce,k2:Z}}function f(k){if(!["compact","recovered","der"].includes(k))throw new Error('Signature format must be "compact", "recovered", or "der"');return k}function x(k,M){const q={};for(let K of Object.keys(M))q[K]=k[K]===void 0?M[K]:k[K];return(0,n._abool2)(q.lowS,"lowS"),(0,n._abool2)(q.prehash,"prehash"),q.format!==void 0&&f(q.format),q}class p extends Error{constructor(M=""){super(M)}}e.DERErr=p,e.DER={Err:p,_tlv:{encode:(k,M)=>{const{Err:q}=e.DER;if(k<0||k>256)throw new q("tlv.encode: wrong tag");if(M.length&1)throw new q("tlv.encode: unpadded data");const K=M.length/2,H=(0,n.numberToHexUnpadded)(K);if(H.length/2&128)throw new q("tlv.encode: long form length too big");const Q=K>127?(0,n.numberToHexUnpadded)(H.length/2|128):"";return(0,n.numberToHexUnpadded)(k)+Q+H+M},decode(k,M){const{Err:q}=e.DER;let K=0;if(k<0||k>256)throw new q("tlv.encode: wrong tag");if(M.length<2||M[K++]!==k)throw new q("tlv.decode: wrong tlv");const H=M[K++],Q=!!(H&128);let D=0;if(!Q)D=H;else{const J=H&127;if(!J)throw new q("tlv.decode(long): indefinite length not supported");if(J>4)throw new q("tlv.decode(long): byte length is too big");const L=M.subarray(K,K+J);if(L.length!==J)throw new q("tlv.decode: length bytes not complete");if(L[0]===0)throw new q("tlv.decode(long): zero leftmost byte");for(const Z of L)D=D<<8|Z;if(K+=J,D<128)throw new q("tlv.decode(long): not minimal encoding")}const Y=M.subarray(K,K+D);if(Y.length!==D)throw new q("tlv.decode: wrong value length");return{v:Y,l:M.subarray(K+D)}}},_int:{encode(k){const{Err:M}=e.DER;if(k<g)throw new M("integer: negative integers are not allowed");let q=(0,n.numberToHexUnpadded)(k);if(Number.parseInt(q[0],16)&8&&(q="00"+q),q.length&1)throw new M("unexpected DER parsing assertion: unpadded hex");return q},decode(k){const{Err:M}=e.DER;if(k[0]&128)throw new M("invalid signature integer: negative");if(k[0]===0&&!(k[1]&128))throw new M("invalid signature integer: unnecessary leading zero");return(0,n.bytesToNumberBE)(k)}},toSig(k){const{Err:M,_int:q,_tlv:K}=e.DER,H=(0,n.ensureBytes)("signature",k),{v:Q,l:D}=K.decode(48,H);if(D.length)throw new M("invalid signature: left bytes after parsing");const{v:Y,l:J}=K.decode(2,Q),{v:L,l:Z}=K.decode(2,J);if(Z.length)throw new M("invalid signature: left bytes after parsing");return{r:q.decode(Y),s:q.decode(L)}},hexFromSig(k){const{_tlv:M,_int:q}=e.DER,K=M.encode(2,q.encode(k.r)),H=M.encode(2,q.encode(k.s)),Q=K+H;return M.encode(48,Q)}};const g=BigInt(0),y=BigInt(1),b=BigInt(2),w=BigInt(3),v=BigInt(4);function B(k,M){const{BYTES:q}=k;let K;if(typeof M=="bigint")K=M;else{let H=(0,n.ensureBytes)("private key",M);try{K=k.fromBytes(H)}catch{throw new Error(`invalid private key: expected ui8a of size ${q}, got ${typeof M}`)}}if(!k.isValidNot0(K))throw new Error("invalid private key: out of range [1..N-1]");return K}function j(k,M={}){const q=(0,o._createCurveFields)("weierstrass",k,M),{Fp:K,Fn:H}=q;let Q=q.CURVE;const{h:D,n:Y}=Q;(0,n._validateObject)(M,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:J}=M;if(J&&(!K.is0(Q.a)||typeof J.beta!="bigint"||!Array.isArray(J.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const L=T(K,H);function Z(){if(!K.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function oe(Ve,Ee,ve){const{x:Te,y:Re}=Ee.toAffine(),ye=K.toBytes(Te);if((0,n._abool2)(ve,"isCompressed"),ve){Z();const Ne=!K.isOdd(Re);return(0,n.concatBytes)(F(Ne),ye)}else return(0,n.concatBytes)(Uint8Array.of(4),ye,K.toBytes(Re))}function ce(Ve){(0,n._abytes2)(Ve,void 0,"Point");const{publicKey:Ee,publicKeyUncompressed:ve}=L,Te=Ve.length,Re=Ve[0],ye=Ve.subarray(1);if(Te===Ee&&(Re===2||Re===3)){const Ne=K.fromBytes(ye);if(!K.isValid(Ne))throw new Error("bad point: is not on curve, wrong x");const ie=te(Ne);let P;try{P=K.sqrt(ie)}catch(_e){const je=_e instanceof Error?": "+_e.message:"";throw new Error("bad point: is not on curve, sqrt error"+je)}Z();const V=K.isOdd(P);return(Re&1)===1!==V&&(P=K.neg(P)),{x:Ne,y:P}}else if(Te===ve&&Re===4){const Ne=K.BYTES,ie=K.fromBytes(ye.subarray(0,Ne)),P=K.fromBytes(ye.subarray(Ne,Ne*2));if(!ae(ie,P))throw new Error("bad point: is not on curve");return{x:ie,y:P}}else throw new Error(`bad point: got length ${Te}, expected compressed=${Ee} or uncompressed=${ve}`)}const de=M.toBytes||oe,xe=M.fromBytes||ce;function te(Ve){const Ee=K.sqr(Ve),ve=K.mul(Ee,Ve);return K.add(K.add(ve,K.mul(Ve,Q.a)),Q.b)}function ae(Ve,Ee){const ve=K.sqr(Ee),Te=te(Ve);return K.eql(ve,Te)}if(!ae(Q.Gx,Q.Gy))throw new Error("bad curve params: generator point");const le=K.mul(K.pow(Q.a,w),v),ue=K.mul(K.sqr(Q.b),BigInt(27));if(K.is0(K.add(le,ue)))throw new Error("bad curve params: a or b");function be(Ve,Ee,ve=!1){if(!K.isValid(Ee)||ve&&K.is0(Ee))throw new Error(`bad point coordinate ${Ve}`);return Ee}function Be(Ve){if(!(Ve instanceof Fe))throw new Error("ProjectivePoint expected")}function Ce(Ve){if(!J||!J.basises)throw new Error("no endo");return u(Ve,J.basises,H.ORDER)}const Se=(0,n.memoized)((Ve,Ee)=>{const{X:ve,Y:Te,Z:Re}=Ve;if(K.eql(Re,K.ONE))return{x:ve,y:Te};const ye=Ve.is0();Ee==null&&(Ee=ye?K.ONE:K.inv(Re));const Ne=K.mul(ve,Ee),ie=K.mul(Te,Ee),P=K.mul(Re,Ee);if(ye)return{x:K.ZERO,y:K.ZERO};if(!K.eql(P,K.ONE))throw new Error("invZ was invalid");return{x:Ne,y:ie}}),ke=(0,n.memoized)(Ve=>{if(Ve.is0()){if(M.allowInfinityPoint&&!K.is0(Ve.Y))return;throw new Error("bad point: ZERO")}const{x:Ee,y:ve}=Ve.toAffine();if(!K.isValid(Ee)||!K.isValid(ve))throw new Error("bad point: x or y not field elements");if(!ae(Ee,ve))throw new Error("bad point: equation left != right");if(!Ve.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function we(Ve,Ee,ve,Te,Re){return ve=new Fe(K.mul(ve.X,Ve),ve.Y,ve.Z),Ee=(0,o.negateCt)(Te,Ee),ve=(0,o.negateCt)(Re,ve),Ee.add(ve)}class Fe{constructor(Ee,ve,Te){this.X=be("x",Ee),this.Y=be("y",ve,!0),this.Z=be("z",Te),Object.freeze(this)}static CURVE(){return Q}static fromAffine(Ee){const{x:ve,y:Te}=Ee||{};if(!Ee||!K.isValid(ve)||!K.isValid(Te))throw new Error("invalid affine point");if(Ee instanceof Fe)throw new Error("projective point not allowed");return K.is0(ve)&&K.is0(Te)?Fe.ZERO:new Fe(ve,Te,K.ONE)}static fromBytes(Ee){const ve=Fe.fromAffine(xe((0,n._abytes2)(Ee,void 0,"point")));return ve.assertValidity(),ve}static fromHex(Ee){return Fe.fromBytes((0,n.ensureBytes)("pointHex",Ee))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(Ee=8,ve=!0){return Ye.createCache(this,Ee),ve||this.multiply(w),this}assertValidity(){ke(this)}hasEvenY(){const{y:Ee}=this.toAffine();if(!K.isOdd)throw new Error("Field doesn't support isOdd");return!K.isOdd(Ee)}equals(Ee){Be(Ee);const{X:ve,Y:Te,Z:Re}=this,{X:ye,Y:Ne,Z:ie}=Ee,P=K.eql(K.mul(ve,ie),K.mul(ye,Re)),V=K.eql(K.mul(Te,ie),K.mul(Ne,Re));return P&&V}negate(){return new Fe(this.X,K.neg(this.Y),this.Z)}double(){const{a:Ee,b:ve}=Q,Te=K.mul(ve,w),{X:Re,Y:ye,Z:Ne}=this;let ie=K.ZERO,P=K.ZERO,V=K.ZERO,he=K.mul(Re,Re),_e=K.mul(ye,ye),je=K.mul(Ne,Ne),Ie=K.mul(Re,ye);return Ie=K.add(Ie,Ie),V=K.mul(Re,Ne),V=K.add(V,V),ie=K.mul(Ee,V),P=K.mul(Te,je),P=K.add(ie,P),ie=K.sub(_e,P),P=K.add(_e,P),P=K.mul(ie,P),ie=K.mul(Ie,ie),V=K.mul(Te,V),je=K.mul(Ee,je),Ie=K.sub(he,je),Ie=K.mul(Ee,Ie),Ie=K.add(Ie,V),V=K.add(he,he),he=K.add(V,he),he=K.add(he,je),he=K.mul(he,Ie),P=K.add(P,he),je=K.mul(ye,Ne),je=K.add(je,je),he=K.mul(je,Ie),ie=K.sub(ie,he),V=K.mul(je,_e),V=K.add(V,V),V=K.add(V,V),new Fe(ie,P,V)}add(Ee){Be(Ee);const{X:ve,Y:Te,Z:Re}=this,{X:ye,Y:Ne,Z:ie}=Ee;let P=K.ZERO,V=K.ZERO,he=K.ZERO;const _e=Q.a,je=K.mul(Q.b,w);let Ie=K.mul(ve,ye),Ze=K.mul(Te,Ne),et=K.mul(Re,ie),st=K.add(ve,Te),rt=K.add(ye,Ne);st=K.mul(st,rt),rt=K.add(Ie,Ze),st=K.sub(st,rt),rt=K.add(ve,Re);let nt=K.add(ye,ie);return rt=K.mul(rt,nt),nt=K.add(Ie,et),rt=K.sub(rt,nt),nt=K.add(Te,Re),P=K.add(Ne,ie),nt=K.mul(nt,P),P=K.add(Ze,et),nt=K.sub(nt,P),he=K.mul(_e,rt),P=K.mul(je,et),he=K.add(P,he),P=K.sub(Ze,he),he=K.add(Ze,he),V=K.mul(P,he),Ze=K.add(Ie,Ie),Ze=K.add(Ze,Ie),et=K.mul(_e,et),rt=K.mul(je,rt),Ze=K.add(Ze,et),et=K.sub(Ie,et),et=K.mul(_e,et),rt=K.add(rt,et),Ie=K.mul(Ze,rt),V=K.add(V,Ie),Ie=K.mul(nt,rt),P=K.mul(st,P),P=K.sub(P,Ie),Ie=K.mul(st,Ze),he=K.mul(nt,he),he=K.add(he,Ie),new Fe(P,V,he)}subtract(Ee){return this.add(Ee.negate())}is0(){return this.equals(Fe.ZERO)}multiply(Ee){const{endo:ve}=M;if(!H.isValidNot0(Ee))throw new Error("invalid scalar: out of range");let Te,Re;const ye=Ne=>Ye.cached(this,Ne,ie=>(0,o.normalizeZ)(Fe,ie));if(ve){const{k1neg:Ne,k1:ie,k2neg:P,k2:V}=Ce(Ee),{p:he,f:_e}=ye(ie),{p:je,f:Ie}=ye(V);Re=_e.add(Ie),Te=we(ve.beta,he,je,Ne,P)}else{const{p:Ne,f:ie}=ye(Ee);Te=Ne,Re=ie}return(0,o.normalizeZ)(Fe,[Te,Re])[0]}multiplyUnsafe(Ee){const{endo:ve}=M,Te=this;if(!H.isValid(Ee))throw new Error("invalid scalar: out of range");if(Ee===g||Te.is0())return Fe.ZERO;if(Ee===y)return Te;if(Ye.hasCache(this))return this.multiply(Ee);if(ve){const{k1neg:Re,k1:ye,k2neg:Ne,k2:ie}=Ce(Ee),{p1:P,p2:V}=(0,o.mulEndoUnsafe)(Fe,Te,ye,ie);return we(ve.beta,P,V,Re,Ne)}else return Ye.unsafe(Te,Ee)}multiplyAndAddUnsafe(Ee,ve,Te){const Re=this.multiplyUnsafe(ve).add(Ee.multiplyUnsafe(Te));return Re.is0()?void 0:Re}toAffine(Ee){return Se(this,Ee)}isTorsionFree(){const{isTorsionFree:Ee}=M;return D===y?!0:Ee?Ee(Fe,this):Ye.unsafe(this,Y).is0()}clearCofactor(){const{clearCofactor:Ee}=M;return D===y?this:Ee?Ee(Fe,this):this.multiplyUnsafe(D)}isSmallOrder(){return this.multiplyUnsafe(D).is0()}toBytes(Ee=!0){return(0,n._abool2)(Ee,"isCompressed"),this.assertValidity(),de(Fe,this,Ee)}toHex(Ee=!0){return(0,n.bytesToHex)(this.toBytes(Ee))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(Ee=!0){return this.toBytes(Ee)}_setWindowSize(Ee){this.precompute(Ee)}static normalizeZ(Ee){return(0,o.normalizeZ)(Fe,Ee)}static msm(Ee,ve){return(0,o.pippenger)(Fe,H,Ee,ve)}static fromPrivateKey(Ee){return Fe.BASE.multiply(B(H,Ee))}}Fe.BASE=new Fe(Q.Gx,Q.Gy,K.ONE),Fe.ZERO=new Fe(K.ZERO,K.ONE,K.ZERO),Fe.Fp=K,Fe.Fn=H;const Pe=H.BITS,Ye=new o.wNAF(Fe,M.endo?Math.ceil(Pe/2):Pe);return Fe.BASE.precompute(8),Fe}function F(k){return Uint8Array.of(k?2:3)}function C(k,M){const q=k.ORDER;let K=g;for(let xe=q-y;xe%b===g;xe/=b)K+=y;const H=K,Q=b<<H-y-y,D=Q*b,Y=(q-y)/D,J=(Y-y)/b,L=D-y,Z=Q,oe=k.pow(M,Y),ce=k.pow(M,(Y+y)/b);let de=(xe,te)=>{let ae=oe,le=k.pow(te,L),ue=k.sqr(le);ue=k.mul(ue,te);let be=k.mul(xe,ue);be=k.pow(be,J),be=k.mul(be,le),le=k.mul(be,te),ue=k.mul(be,xe);let Be=k.mul(ue,le);be=k.pow(Be,Z);let Ce=k.eql(be,k.ONE);le=k.mul(ue,ce),be=k.mul(Be,ae),ue=k.cmov(le,ue,Ce),Be=k.cmov(be,Be,Ce);for(let Se=H;Se>y;Se--){let ke=Se-b;ke=b<<ke-y;let we=k.pow(Be,ke);const Fe=k.eql(we,k.ONE);le=k.mul(ue,ae),ae=k.mul(ae,ae),we=k.mul(Be,ae),ue=k.cmov(le,ue,Fe),Be=k.cmov(we,Be,Fe)}return{isValid:Ce,value:ue}};if(k.ORDER%v===w){const xe=(k.ORDER-w)/v,te=k.sqrt(k.neg(M));de=(ae,le)=>{let ue=k.sqr(le);const be=k.mul(ae,le);ue=k.mul(ue,be);let Be=k.pow(ue,xe);Be=k.mul(Be,be);const Ce=k.mul(Be,te),Se=k.mul(k.sqr(Be),le),ke=k.eql(Se,ae);let we=k.cmov(Ce,Be,ke);return{isValid:ke,value:we}}}return de}function N(k,M){(0,a.validateField)(k);const{A:q,B:K,Z:H}=M;if(!k.isValid(q)||!k.isValid(K)||!k.isValid(H))throw new Error("mapToCurveSimpleSWU: invalid opts");const Q=C(k,H);if(!k.isOdd)throw new Error("Field does not have .isOdd()");return D=>{let Y,J,L,Z,oe,ce,de,xe;Y=k.sqr(D),Y=k.mul(Y,H),J=k.sqr(Y),J=k.add(J,Y),L=k.add(J,k.ONE),L=k.mul(L,K),Z=k.cmov(H,k.neg(J),!k.eql(J,k.ZERO)),Z=k.mul(Z,q),J=k.sqr(L),ce=k.sqr(Z),oe=k.mul(ce,q),J=k.add(J,oe),J=k.mul(J,L),ce=k.mul(ce,Z),oe=k.mul(ce,K),J=k.add(J,oe),de=k.mul(Y,L);const{isValid:te,value:ae}=Q(J,ce);xe=k.mul(Y,D),xe=k.mul(xe,ae),de=k.cmov(de,L,te),xe=k.cmov(xe,ae,te);const le=k.isOdd(D)===k.isOdd(xe);xe=k.cmov(k.neg(xe),xe,le);const ue=(0,a.FpInvertBatch)(k,[Z],!0)[0];return de=k.mul(de,ue),{x:de,y:xe}}}function T(k,M){return{secretKey:M.BYTES,publicKey:1+k.BYTES,publicKeyUncompressed:1+2*k.BYTES,publicKeyHasPrefix:!0,signature:2*M.BYTES}}function _(k,M={}){const{Fn:q}=k,K=M.randomBytes||n.randomBytes,H=Object.assign(T(k.Fp,q),{seed:(0,a.getMinHashLength)(q.ORDER)});function Q(de){try{return!!B(q,de)}catch{return!1}}function D(de,xe){const{publicKey:te,publicKeyUncompressed:ae}=H;try{const le=de.length;return xe===!0&&le!==te||xe===!1&&le!==ae?!1:!!k.fromBytes(de)}catch{return!1}}function Y(de=K(H.seed)){return(0,a.mapHashToField)((0,n._abytes2)(de,H.seed,"seed"),q.ORDER)}function J(de,xe=!0){return k.BASE.multiply(B(q,de)).toBytes(xe)}function L(de){const xe=Y(de);return{secretKey:xe,publicKey:J(xe)}}function Z(de){if(typeof de=="bigint")return!1;if(de instanceof k)return!0;const{secretKey:xe,publicKey:te,publicKeyUncompressed:ae}=H;if(q.allowedLengths||xe===te)return;const le=(0,n.ensureBytes)("key",de).length;return le===te||le===ae}function oe(de,xe,te=!0){if(Z(de)===!0)throw new Error("first arg must be private key");if(Z(xe)===!1)throw new Error("second arg must be public key");const ae=B(q,de);return k.fromHex(xe).multiply(ae).toBytes(te)}return Object.freeze({getPublicKey:J,getSharedSecret:oe,keygen:L,Point:k,utils:{isValidSecretKey:Q,isValidPublicKey:D,randomSecretKey:Y,isValidPrivateKey:Q,randomPrivateKey:Y,normPrivateKeyToScalar:de=>B(q,de),precompute(de=8,xe=k.BASE){return xe.precompute(de,!1)}},lengths:H})}function S(k,M,q={}){(0,r.ahash)(M),(0,n._validateObject)(q,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const K=q.randomBytes||n.randomBytes,H=q.hmac||((ve,...Te)=>(0,t.hmac)(M,ve,(0,n.concatBytes)(...Te))),{Fp:Q,Fn:D}=k,{ORDER:Y,BITS:J}=D,{keygen:L,getPublicKey:Z,getSharedSecret:oe,utils:ce,lengths:de}=_(k,q),xe={prehash:!1,lowS:typeof q.lowS=="boolean"?q.lowS:!1,format:void 0,extraEntropy:!1},te="compact";function ae(ve){const Te=Y>>y;return ve>Te}function le(ve,Te){if(!D.isValidNot0(Te))throw new Error(`invalid signature ${ve}: out of range 1..Point.Fn.ORDER`);return Te}function ue(ve,Te){f(Te);const Re=de.signature,ye=Te==="compact"?Re:Te==="recovered"?Re+1:void 0;return(0,n._abytes2)(ve,ye,`${Te} signature`)}class be{constructor(Te,Re,ye){this.r=le("r",Te),this.s=le("s",Re),ye!=null&&(this.recovery=ye),Object.freeze(this)}static fromBytes(Te,Re=te){ue(Te,Re);let ye;if(Re==="der"){const{r:V,s:he}=e.DER.toSig((0,n._abytes2)(Te));return new be(V,he)}Re==="recovered"&&(ye=Te[0],Re="compact",Te=Te.subarray(1));const Ne=D.BYTES,ie=Te.subarray(0,Ne),P=Te.subarray(Ne,Ne*2);return new be(D.fromBytes(ie),D.fromBytes(P),ye)}static fromHex(Te,Re){return this.fromBytes((0,n.hexToBytes)(Te),Re)}addRecoveryBit(Te){return new be(this.r,this.s,Te)}recoverPublicKey(Te){const Re=Q.ORDER,{r:ye,s:Ne,recovery:ie}=this;if(ie==null||![0,1,2,3].includes(ie))throw new Error("recovery id invalid");if(Y*b<Re&&ie>1)throw new Error("recovery id is ambiguous for h>1 curve");const V=ie===2||ie===3?ye+Y:ye;if(!Q.isValid(V))throw new Error("recovery id 2 or 3 invalid");const he=Q.toBytes(V),_e=k.fromBytes((0,n.concatBytes)(F((ie&1)===0),he)),je=D.inv(V),Ie=Ce((0,n.ensureBytes)("msgHash",Te)),Ze=D.create(-Ie*je),et=D.create(Ne*je),st=k.BASE.multiplyUnsafe(Ze).add(_e.multiplyUnsafe(et));if(st.is0())throw new Error("point at infinify");return st.assertValidity(),st}hasHighS(){return ae(this.s)}toBytes(Te=te){if(f(Te),Te==="der")return(0,n.hexToBytes)(e.DER.hexFromSig(this));const Re=D.toBytes(this.r),ye=D.toBytes(this.s);if(Te==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return(0,n.concatBytes)(Uint8Array.of(this.recovery),Re,ye)}return(0,n.concatBytes)(Re,ye)}toHex(Te){return(0,n.bytesToHex)(this.toBytes(Te))}assertValidity(){}static fromCompact(Te){return be.fromBytes((0,n.ensureBytes)("sig",Te),"compact")}static fromDER(Te){return be.fromBytes((0,n.ensureBytes)("sig",Te),"der")}normalizeS(){return this.hasHighS()?new be(this.r,D.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,n.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,n.bytesToHex)(this.toBytes("compact"))}}const Be=q.bits2int||function(Te){if(Te.length>8192)throw new Error("input is too large");const Re=(0,n.bytesToNumberBE)(Te),ye=Te.length*8-J;return ye>0?Re>>BigInt(ye):Re},Ce=q.bits2int_modN||function(Te){return D.create(Be(Te))},Se=(0,n.bitMask)(J);function ke(ve){return(0,n.aInRange)("num < 2^"+J,ve,g,Se),D.toBytes(ve)}function we(ve,Te){return(0,n._abytes2)(ve,void 0,"message"),Te?(0,n._abytes2)(M(ve),void 0,"prehashed message"):ve}function Fe(ve,Te,Re){if(["recovered","canonical"].some(Ze=>Ze in Re))throw new Error("sign() legacy options not supported");const{lowS:ye,prehash:Ne,extraEntropy:ie}=x(Re,xe);ve=we(ve,Ne);const P=Ce(ve),V=B(D,Te),he=[ke(V),ke(P)];if(ie!=null&&ie!==!1){const Ze=ie===!0?K(de.secretKey):ie;he.push((0,n.ensureBytes)("extraEntropy",Ze))}const _e=(0,n.concatBytes)(...he),je=P;function Ie(Ze){const et=Be(Ze);if(!D.isValidNot0(et))return;const st=D.inv(et),rt=k.BASE.multiply(et).toAffine(),nt=D.create(rt.x);if(nt===g)return;const Yt=D.create(st*D.create(je+nt*V));if(Yt===g)return;let $t=(rt.x===nt?0:2)|Number(rt.y&y),vr=Yt;return ye&&ae(Yt)&&(vr=D.neg(Yt),$t^=1),new be(nt,vr,$t)}return{seed:_e,k2sig:Ie}}function Pe(ve,Te,Re={}){ve=(0,n.ensureBytes)("message",ve);const{seed:ye,k2sig:Ne}=Fe(ve,Te,Re);return(0,n.createHmacDrbg)(M.outputLen,D.BYTES,H)(ye,Ne)}function Ye(ve){let Te;const Re=typeof ve=="string"||(0,n.isBytes)(ve),ye=!Re&&ve!==null&&typeof ve=="object"&&typeof ve.r=="bigint"&&typeof ve.s=="bigint";if(!Re&&!ye)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(ye)Te=new be(ve.r,ve.s);else if(Re){try{Te=be.fromBytes((0,n.ensureBytes)("sig",ve),"der")}catch(Ne){if(!(Ne instanceof e.DER.Err))throw Ne}if(!Te)try{Te=be.fromBytes((0,n.ensureBytes)("sig",ve),"compact")}catch{return!1}}return Te||!1}function Ve(ve,Te,Re,ye={}){const{lowS:Ne,prehash:ie,format:P}=x(ye,xe);if(Re=(0,n.ensureBytes)("publicKey",Re),Te=we((0,n.ensureBytes)("message",Te),ie),"strict"in ye)throw new Error("options.strict was renamed to lowS");const V=P===void 0?Ye(ve):be.fromBytes((0,n.ensureBytes)("sig",ve),P);if(V===!1)return!1;try{const he=k.fromBytes(Re);if(Ne&&V.hasHighS())return!1;const{r:_e,s:je}=V,Ie=Ce(Te),Ze=D.inv(je),et=D.create(Ie*Ze),st=D.create(_e*Ze),rt=k.BASE.multiplyUnsafe(et).add(he.multiplyUnsafe(st));return rt.is0()?!1:D.create(rt.x)===_e}catch{return!1}}function Ee(ve,Te,Re={}){const{prehash:ye}=x(Re,xe);return Te=we(Te,ye),be.fromBytes(ve,"recovered").recoverPublicKey(Te).toBytes()}return Object.freeze({keygen:L,getPublicKey:Z,getSharedSecret:oe,utils:ce,lengths:de,Point:k,sign:Pe,verify:Ve,recoverPublicKey:Ee,Signature:be,hash:M})}function O(k){const{CURVE:M,curveOpts:q}=$(k),K=j(M,q);return U(k,K)}function $(k){const M={a:k.a,b:k.b,p:k.Fp.ORDER,n:k.n,h:k.h,Gx:k.Gx,Gy:k.Gy},q=k.Fp;let K=k.allowedPrivateKeyLengths?Array.from(new Set(k.allowedPrivateKeyLengths.map(D=>Math.ceil(D/2)))):void 0;const H=(0,a.Field)(M.n,{BITS:k.nBitLength,allowedLengths:K,modFromBytes:k.wrapPrivateKey}),Q={Fp:q,Fn:H,allowInfinityPoint:k.allowInfinityPoint,endo:k.endo,isTorsionFree:k.isTorsionFree,clearCofactor:k.clearCofactor,fromBytes:k.fromBytes,toBytes:k.toBytes};return{CURVE:M,curveOpts:Q}}function z(k){const{CURVE:M,curveOpts:q}=$(k),K={hmac:k.hmac,randomBytes:k.randomBytes,lowS:k.lowS,bits2int:k.bits2int,bits2int_modN:k.bits2int_modN};return{CURVE:M,curveOpts:q,hash:k.hash,ecdsaOpts:K}}function W(k,M,q){function K(H){const Q=k.sqr(H),D=k.mul(Q,H);return k.add(k.add(D,k.mul(H,M)),q)}return K}function U(k,M){const{Fp:q,Fn:K}=M;function H(D){return(0,n.inRange)(D,y,K.ORDER)}const Q=W(q,k.a,k.b);return Object.assign({},{CURVE:k,Point:M,ProjectivePoint:M,normPrivateKeyToScalar:D=>B(K,D),weierstrassEquation:Q,isWithinCurveOrder:H})}function I(k,M){const q=M.Point;return Object.assign({},M,{ProjectivePoint:q,CURVE:Object.assign({},k,(0,a.nLength)(q.Fn.ORDER,q.Fn.BITS))})}function G(k){const{CURVE:M,curveOpts:q,hash:K,ecdsaOpts:H}=z(k),Q=j(M,q),D=S(Q,K,H);return I(k,D)}})(weierstrass)),weierstrass}var hasRequired_shortw_utils;function require_shortw_utils(){if(hasRequired_shortw_utils)return _shortw_utils;hasRequired_shortw_utils=1,Object.defineProperty(_shortw_utils,"__esModule",{value:!0}),_shortw_utils.getHash=t,_shortw_utils.createCurve=r;const e=requireWeierstrass();function t(n){return{hash:n}}function r(n,o){const a=l=>(0,e.weierstrass)({...n,hash:l});return{...a(o),create:a}}return _shortw_utils}var hashToCurve={},hasRequiredHashToCurve;function requireHashToCurve(){return hasRequiredHashToCurve||(hasRequiredHashToCurve=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._DST_scalar=void 0,e.expand_message_xmd=f,e.expand_message_xof=x,e.hash_to_field=p,e.isogenyMap=g,e.createHasher=y;const t=requireUtils$3(),r=requireModular(),n=t.bytesToNumberBE;function o(b,w){if(l(b),l(w),b<0||b>=1<<8*w)throw new Error("invalid I2OSP input: "+b);const v=Array.from({length:w}).fill(0);for(let B=w-1;B>=0;B--)v[B]=b&255,b>>>=8;return new Uint8Array(v)}function a(b,w){const v=new Uint8Array(b.length);for(let B=0;B<b.length;B++)v[B]=b[B]^w[B];return v}function l(b){if(!Number.isSafeInteger(b))throw new Error("number expected")}function u(b){if(!(0,t.isBytes)(b)&&typeof b!="string")throw new Error("DST must be Uint8Array or string");return typeof b=="string"?(0,t.utf8ToBytes)(b):b}function f(b,w,v,B){(0,t.abytes)(b),l(v),w=u(w),w.length>255&&(w=B((0,t.concatBytes)((0,t.utf8ToBytes)("H2C-OVERSIZE-DST-"),w)));const{outputLen:j,blockLen:F}=B,C=Math.ceil(v/j);if(v>65535||C>255)throw new Error("expand_message_xmd: invalid lenInBytes");const N=(0,t.concatBytes)(w,o(w.length,1)),T=o(0,F),_=o(v,2),S=new Array(C),O=B((0,t.concatBytes)(T,b,_,o(0,1),N));S[0]=B((0,t.concatBytes)(O,o(1,1),N));for(let z=1;z<=C;z++){const W=[a(O,S[z-1]),o(z+1,1),N];S[z]=B((0,t.concatBytes)(...W))}return(0,t.concatBytes)(...S).slice(0,v)}function x(b,w,v,B,j){if((0,t.abytes)(b),l(v),w=u(w),w.length>255){const F=Math.ceil(2*B/8);w=j.create({dkLen:F}).update((0,t.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(w).digest()}if(v>65535||w.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return j.create({dkLen:v}).update(b).update(o(v,2)).update(w).update(o(w.length,1)).digest()}function p(b,w,v){(0,t._validateObject)(v,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:B,k:j,m:F,hash:C,expand:N,DST:T}=v;if(!(0,t.isHash)(v.hash))throw new Error("expected valid hash");(0,t.abytes)(b),l(w);const _=B.toString(2).length,S=Math.ceil((_+j)/8),O=w*F*S;let $;if(N==="xmd")$=f(b,T,O,C);else if(N==="xof")$=x(b,T,O,j,C);else if(N==="_internal_pass")$=b;else throw new Error('expand must be "xmd" or "xof"');const z=new Array(w);for(let W=0;W<w;W++){const U=new Array(F);for(let I=0;I<F;I++){const G=S*(I+W*F),k=$.subarray(G,G+S);U[I]=(0,r.mod)(n(k),B)}z[W]=U}return z}function g(b,w){const v=w.map(B=>Array.from(B).reverse());return(B,j)=>{const[F,C,N,T]=v.map(O=>O.reduce(($,z)=>b.add(b.mul($,B),z))),[_,S]=(0,r.FpInvertBatch)(b,[C,T],!0);return B=b.mul(F,_),j=b.mul(j,b.mul(N,S)),{x:B,y:j}}}e._DST_scalar=(0,t.utf8ToBytes)("HashToScalar-");function y(b,w,v){if(typeof w!="function")throw new Error("mapToCurve() must be defined");function B(F){return b.fromAffine(w(F))}function j(F){const C=F.clearCofactor();return C.equals(b.ZERO)?b.ZERO:(C.assertValidity(),C)}return{defaults:v,hashToCurve(F,C){const N=Object.assign({},v,C),T=p(F,2,N),_=B(T[0]),S=B(T[1]);return j(_.add(S))},encodeToCurve(F,C){const N=v.encodeDST?{DST:v.encodeDST}:{},T=Object.assign({},v,N,C),_=p(F,1,T),S=B(_[0]);return j(S)},mapToCurve(F){if(!Array.isArray(F))throw new Error("expected array of bigints");for(const C of F)if(typeof C!="bigint")throw new Error("expected array of bigints");return j(B(F))},hashToScalar(F,C){const N=b.Fn.ORDER,T=Object.assign({},v,{p:N,m:1,DST:e._DST_scalar},C);return p(F,1,T)[0][0]}}}})(hashToCurve)),hashToCurve}var hasRequiredSecp256k1;function requireSecp256k1(){return hasRequiredSecp256k1||(hasRequiredSecp256k1=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.encodeToCurve=e.hashToCurve=e.secp256k1_hasher=e.schnorr=e.secp256k1=void 0;const t=requireSha2(),r=requireUtils$4(),n=require_shortw_utils(),o=requireHashToCurve(),a=requireModular(),l=requireWeierstrass(),u=requireUtils$3(),f={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},x={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},p=BigInt(0),g=BigInt(1),y=BigInt(2);function b(I){const G=f.p,k=BigInt(3),M=BigInt(6),q=BigInt(11),K=BigInt(22),H=BigInt(23),Q=BigInt(44),D=BigInt(88),Y=I*I*I%G,J=Y*Y*I%G,L=(0,a.pow2)(J,k,G)*J%G,Z=(0,a.pow2)(L,k,G)*J%G,oe=(0,a.pow2)(Z,y,G)*Y%G,ce=(0,a.pow2)(oe,q,G)*oe%G,de=(0,a.pow2)(ce,K,G)*ce%G,xe=(0,a.pow2)(de,Q,G)*de%G,te=(0,a.pow2)(xe,D,G)*xe%G,ae=(0,a.pow2)(te,Q,G)*de%G,le=(0,a.pow2)(ae,k,G)*J%G,ue=(0,a.pow2)(le,H,G)*ce%G,be=(0,a.pow2)(ue,M,G)*Y%G,Be=(0,a.pow2)(be,y,G);if(!w.eql(w.sqr(Be),I))throw new Error("Cannot find square root");return Be}const w=(0,a.Field)(f.p,{sqrt:b});e.secp256k1=(0,n.createCurve)({...f,Fp:w,lowS:!0,endo:x},t.sha256);const v={};function B(I,...G){let k=v[I];if(k===void 0){const M=(0,t.sha256)((0,u.utf8ToBytes)(I));k=(0,u.concatBytes)(M,M),v[I]=k}return(0,t.sha256)((0,u.concatBytes)(k,...G))}const j=I=>I.toBytes(!0).slice(1),F=e.secp256k1.Point,C=I=>I%y===p;function N(I){const{Fn:G,BASE:k}=F,M=(0,l._normFnElement)(G,I),q=k.multiply(M);return{scalar:C(q.y)?M:G.neg(M),bytes:j(q)}}function T(I){const G=w;if(!G.isValidNot0(I))throw new Error("invalid x: Fail if x  p");const k=G.create(I*I),M=G.create(k*I+BigInt(7));let q=G.sqrt(M);C(q)||(q=G.neg(q));const K=F.fromAffine({x:I,y:q});return K.assertValidity(),K}const _=u.bytesToNumberBE;function S(...I){return F.Fn.create(_(B("BIP0340/challenge",...I)))}function O(I){return N(I).bytes}function $(I,G,k=(0,r.randomBytes)(32)){const{Fn:M}=F,q=(0,u.ensureBytes)("message",I),{bytes:K,scalar:H}=N(G),Q=(0,u.ensureBytes)("auxRand",k,32),D=M.toBytes(H^_(B("BIP0340/aux",Q))),Y=B("BIP0340/nonce",D,K,q),{bytes:J,scalar:L}=N(Y),Z=S(J,K,q),oe=new Uint8Array(64);if(oe.set(J,0),oe.set(M.toBytes(M.create(L+Z*H)),32),!z(oe,q,K))throw new Error("sign: Invalid signature produced");return oe}function z(I,G,k){const{Fn:M,BASE:q}=F,K=(0,u.ensureBytes)("signature",I,64),H=(0,u.ensureBytes)("message",G),Q=(0,u.ensureBytes)("publicKey",k,32);try{const D=T(_(Q)),Y=_(K.subarray(0,32));if(!(0,u.inRange)(Y,g,f.p))return!1;const J=_(K.subarray(32,64));if(!(0,u.inRange)(J,g,f.n))return!1;const L=S(M.toBytes(Y),j(D),H),Z=q.multiplyUnsafe(J).add(D.multiplyUnsafe(M.neg(L))),{x:oe,y:ce}=Z.toAffine();return!(Z.is0()||!C(ce)||oe!==Y)}catch{return!1}}e.schnorr=(()=>{const k=(q=(0,r.randomBytes)(48))=>(0,a.mapHashToField)(q,f.n);e.secp256k1.utils.randomSecretKey;function M(q){const K=k(q);return{secretKey:K,publicKey:O(K)}}return{keygen:M,getPublicKey:O,sign:$,verify:z,Point:F,utils:{randomSecretKey:k,randomPrivateKey:k,taggedHash:B,lift_x:T,pointToBytes:j,numberToBytesBE:u.numberToBytesBE,bytesToNumberBE:u.bytesToNumberBE,mod:a.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})();const W=(0,o.isogenyMap)(w,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(I=>I.map(G=>BigInt(G)))),U=(0,l.mapToCurveSimpleSWU)(w,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:w.create(BigInt("-11"))});e.secp256k1_hasher=(0,o.createHasher)(e.secp256k1.Point,I=>{const{x:G,y:k}=U(w.create(I[0]));return W(G,k)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:w.ORDER,m:1,k:128,expand:"xmd",hash:t.sha256}),e.hashToCurve=e.secp256k1_hasher.hashToCurve,e.encodeToCurve=e.secp256k1_hasher.encodeToCurve})(secp256k1)),secp256k1}var utils$2={},hasRequiredUtils$2;function requireUtils$2(){if(hasRequiredUtils$2)return utils$2;hasRequiredUtils$2=1,Object.defineProperty(utils$2,"__esModule",{value:!0}),utils$2.isHash=utils$2.validateObject=utils$2.memoized=utils$2.notImplemented=utils$2.createHmacDrbg=utils$2.bitMask=utils$2.bitSet=utils$2.bitGet=utils$2.bitLen=utils$2.aInRange=utils$2.inRange=utils$2.asciiToBytes=utils$2.copyBytes=utils$2.equalBytes=utils$2.ensureBytes=utils$2.numberToVarBytesBE=utils$2.numberToBytesLE=utils$2.numberToBytesBE=utils$2.bytesToNumberLE=utils$2.bytesToNumberBE=utils$2.hexToNumber=utils$2.numberToHexUnpadded=utils$2.abool=utils$2.utf8ToBytes=utils$2.randomBytes=utils$2.isBytes=utils$2.hexToBytes=utils$2.concatBytes=utils$2.bytesToUtf8=utils$2.bytesToHex=utils$2.anumber=utils$2.abytes=void 0;const e=requireUtils$3();return utils$2.abytes=e.abytes,utils$2.anumber=e.anumber,utils$2.bytesToHex=e.bytesToHex,utils$2.bytesToUtf8=e.bytesToUtf8,utils$2.concatBytes=e.concatBytes,utils$2.hexToBytes=e.hexToBytes,utils$2.isBytes=e.isBytes,utils$2.randomBytes=e.randomBytes,utils$2.utf8ToBytes=e.utf8ToBytes,utils$2.abool=e.abool,utils$2.numberToHexUnpadded=e.numberToHexUnpadded,utils$2.hexToNumber=e.hexToNumber,utils$2.bytesToNumberBE=e.bytesToNumberBE,utils$2.bytesToNumberLE=e.bytesToNumberLE,utils$2.numberToBytesBE=e.numberToBytesBE,utils$2.numberToBytesLE=e.numberToBytesLE,utils$2.numberToVarBytesBE=e.numberToVarBytesBE,utils$2.ensureBytes=e.ensureBytes,utils$2.equalBytes=e.equalBytes,utils$2.copyBytes=e.copyBytes,utils$2.asciiToBytes=e.asciiToBytes,utils$2.inRange=e.inRange,utils$2.aInRange=e.aInRange,utils$2.bitLen=e.bitLen,utils$2.bitGet=e.bitGet,utils$2.bitSet=e.bitSet,utils$2.bitMask=e.bitMask,utils$2.createHmacDrbg=e.createHmacDrbg,utils$2.notImplemented=e.notImplemented,utils$2.memoized=e.memoized,utils$2.validateObject=e.validateObject,utils$2.isHash=e.isHash,utils$2}var hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1;var e=requireSecp256k1(),t=requireModular(),r=requireUtils$2();function n(ye){var Ne=Object.create(null);return ye&&Object.keys(ye).forEach(function(ie){if(ie!=="default"){var P=Object.getOwnPropertyDescriptor(ye,ie);Object.defineProperty(Ne,ie,P.get?P:{enumerable:!0,get:function(){return ye[ie]}})}}),Ne.default=ye,Object.freeze(Ne)}var o=n(t),a=n(r);const l=e.secp256k1.ProjectivePoint,u="Expected Private",f="Expected Point",x="Expected Tweak",p="Expected Hash",g="Expected Signature",y="Expected Extra Data (32 bytes)",b="Expected Scalar",w="Bad Recovery Id",v=32,B=32,j=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65]),F=32,C=new Uint8Array(32),N=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,69,81,35,25,80,183,95,196,64,45,161,114,47,201,186,238]),T=BigInt(1);function _(ye){return ye instanceof Uint8Array}function S(ye,Ne){for(let ie=0;ie<32;++ie)if(ye[ie]!==Ne[ie])return ye[ie]<Ne[ie]?-1:1;return 0}function O(ye){return S(ye,C)===0}function $(ye){return!(!(ye instanceof Uint8Array)||ye.length!==B||S(ye,j)>=0)}function z(ye){return ye instanceof Uint8Array&&ye.length===64&&S(ye.subarray(0,32),j)<0&&S(ye.subarray(32,64),j)<0}function W(ye){return _(ye)&&ye.length===64&&S(ye.subarray(0,32),N)<0}function U(ye){return!(O(ye.subarray(0,32))||O(ye.subarray(32,64)))}function I(ye){return ye instanceof Uint8Array&&ye.length===v}function G(ye){return ye===void 0||ye instanceof Uint8Array&&ye.length===F}function k(ye){let Ne;if(typeof ye=="bigint")Ne=ye;else if(typeof ye=="number"&&Number.isSafeInteger(ye)&&ye>=0)Ne=BigInt(ye);else if(typeof ye=="string"){if(ye.length!==64)throw new Error("Expected 32 bytes of private scalar");Ne=a.hexToNumber(ye)}else if(ye instanceof Uint8Array){if(ye.length!==32)throw new Error("Expected 32 bytes of private scalar");Ne=a.bytesToNumberBE(ye)}else throw new TypeError("Expected valid private scalar");if(Ne<0)throw new Error("Expected private scalar >= 0");return Ne}function M(ye){return e.secp256k1.utils.normPrivateKeyToScalar(ye)}function q(ye,Ne){const ie=M(ye),P=k(Ne),V=a.numberToBytesBE(o.mod(ie+P,e.secp256k1.CURVE.n),32);return e.secp256k1.utils.isValidPrivateKey(V)?V:null}function K(ye,Ne){const ie=M(ye),P=k(Ne),V=a.numberToBytesBE(o.mod(ie-P,e.secp256k1.CURVE.n),32);return e.secp256k1.utils.isValidPrivateKey(V)?V:null}function H(ye){const Ne=M(ye),ie=a.numberToBytesBE(e.secp256k1.CURVE.n-Ne,32);return e.secp256k1.utils.isValidPrivateKey(ie)?ie:null}function Q(ye,Ne,ie){const P=Z(ye),V=k(Ne),he=l.BASE.multiplyAndAddUnsafe(P,V,T);if(!he)throw new Error("Tweaked point at infinity");return he.toRawBytes(ie)}function D(ye,Ne,ie){const P=Z(ye),V=typeof Ne=="string"?Ne:a.bytesToHex(Ne),he=a.hexToNumber(V);return P.multiply(he).toRawBytes(ie)}function Y(ye,Ne){return ye===void 0?Ne!==void 0?de(Ne):!0:!!ye}function J(ye){try{return ye()}catch{return null}}function L(ye){return e.schnorr.utils.lift_x(a.bytesToNumberBE(ye))}function Z(ye){return ye.length===32?L(ye):l.fromHex(ye)}function oe(ye,Ne){if(ye.length===32!==Ne)return!1;try{return Ne?!!L(ye):!!l.fromHex(ye)}catch{return!1}}function ce(ye){return oe(ye,!1)}function de(ye){return oe(ye,!1)&&ye.length===33}function xe(ye){return e.secp256k1.utils.isValidPrivateKey(ye)}function te(ye){return oe(ye,!0)}function ae(ye,Ne){if(!te(ye))throw new Error(f);if(!$(Ne))throw new Error(x);return J(()=>{const ie=Q(ye,Ne,!0);return{parity:ie[0]%2===1?1:0,xOnlyPubkey:ie.slice(1)}})}function le(ye){if(!ce(ye))throw new Error(f);return ye.slice(1,33)}function ue(ye,Ne){if(!xe(ye))throw new Error(u);return J(()=>e.secp256k1.getPublicKey(ye,Y(Ne)))}function be(ye){if(!xe(ye))throw new Error(u);return le(ue(ye))}function Be(ye,Ne){if(!ce(ye))throw new Error(f);return Z(ye).toRawBytes(Y(Ne,ye))}function Ce(ye,Ne,ie){if(!ce(ye))throw new Error(f);if(!$(Ne))throw new Error(x);return J(()=>D(ye,Ne,Y(ie,ye)))}function Se(ye,Ne,ie){if(!ce(ye)||!ce(Ne))throw new Error(f);return J(()=>{const P=Z(ye),V=Z(Ne);return P.equals(V.negate())?null:P.add(V).toRawBytes(Y(ie,ye))})}function ke(ye,Ne,ie){if(!ce(ye))throw new Error(f);if(!$(Ne))throw new Error(x);return J(()=>Q(ye,Ne,Y(ie,ye)))}function we(ye,Ne){if(!xe(ye))throw new Error(u);if(!$(Ne))throw new Error(x);return J(()=>q(ye,Ne))}function Fe(ye,Ne){if(!xe(ye))throw new Error(u);if(!$(Ne))throw new Error(x);return J(()=>K(ye,Ne))}function Pe(ye){if(!xe(ye))throw new Error(u);return H(ye)}function Ye(ye,Ne,ie){if(!xe(Ne))throw new Error(u);if(!I(ye))throw new Error(b);if(!G(ie))throw new Error(y);return e.secp256k1.sign(ye,Ne,{extraEntropy:ie}).toCompactRawBytes()}function Ve(ye,Ne,ie){if(!xe(Ne))throw new Error(u);if(!I(ye))throw new Error(b);if(!G(ie))throw new Error(y);const P=e.secp256k1.sign(ye,Ne,{extraEntropy:ie});return{signature:P.toCompactRawBytes(),recoveryId:P.recovery}}function Ee(ye,Ne,ie){if(!xe(Ne))throw new Error(u);if(!I(ye))throw new Error(b);if(!G(ie))throw new Error(y);return e.schnorr.sign(ye,Ne,ie)}function ve(ye,Ne,ie,P){if(!I(ye))throw new Error(p);if(!z(Ne)||!U(Ne))throw new Error(g);if(ie&2&&!W(Ne))throw new Error(w);if(!te(Ne.subarray(0,32)))throw new Error(g);const he=e.secp256k1.Signature.fromCompact(Ne).addRecoveryBit(ie).recoverPublicKey(ye);if(!he)throw new Error(g);return he.toRawBytes(Y(P))}function Te(ye,Ne,ie,P){if(!ce(Ne))throw new Error(f);if(!z(ie))throw new Error(g);if(!I(ye))throw new Error(b);return e.secp256k1.verify(ie,ye,Ne,{lowS:P})}function Re(ye,Ne,ie){if(!te(Ne))throw new Error(f);if(!z(ie))throw new Error(g);if(!I(ye))throw new Error(b);return e.schnorr.verify(ie,ye,Ne)}return dist.isPoint=ce,dist.isPointCompressed=de,dist.isPrivate=xe,dist.isXOnlyPoint=te,dist.pointAdd=Se,dist.pointAddScalar=ke,dist.pointCompress=Be,dist.pointFromScalar=ue,dist.pointMultiply=Ce,dist.privateAdd=we,dist.privateNegate=Pe,dist.privateSub=Fe,dist.recover=ve,dist.sign=Ye,dist.signRecoverable=Ve,dist.signSchnorr=Ee,dist.verify=Te,dist.verifySchnorr=Re,dist.xOnlyPointAddTweak=ae,dist.xOnlyPointFromPoint=le,dist.xOnlyPointFromScalar=be,dist}var distExports=requireDist();const index=getDefaultExportFromCjs$1(distExports),ecc=_mergeNamespaces({__proto__:null,default:index},[distExports]),bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};var store;function getGlobalConfig(e){return{lang:e?.lang??store?.lang,message:e?.message,abortEarly:e?.abortEarly??store?.abortEarly,abortPipeEarly:e?.abortPipeEarly??store?.abortPipeEarly}}var store2;function getGlobalMessage(e){return store2?.get(e)}var store3;function getSchemaMessage(e){return store3?.get(e)}var store4;function getSpecificMessage(e,t){return store4?.get(e)?.get(t)}function _stringify(e){const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function _addIssue(e,t,r,n,o){const a=o&&"input"in o?o.input:r.value,l=o?.expected??e.expects??null,u=o?.received??_stringify(a),f={kind:e.kind,type:e.type,input:a,expected:l,received:u,message:`Invalid ${t}: ${l?`Expected ${l} but r`:"R"}eceived ${u}`,requirement:e.requirement,path:o?.path,issues:o?.issues,lang:n.lang,abortEarly:n.abortEarly,abortPipeEarly:n.abortPipeEarly},x=e.kind==="schema",p=o?.message??e.message??getSpecificMessage(e.reference,f.lang)??(x?getSchemaMessage(f.lang):null)??n.message??getGlobalMessage(f.lang);p&&(f.message=typeof p=="function"?p(f):p),x&&(r.typed=!1),r.issues?r.issues.push(f):r.issues=[f]}var ValiError=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function integer(e){return{kind:"validation",type:"integer",reference:integer,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(t,r){return t.typed&&!this.requirement(t.value)&&_addIssue(this,"integer",t,r),t}}}function length(e,t){return{kind:"validation",type:"length",reference:length,async:!1,expects:`${e}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value.length!==this.requirement&&_addIssue(this,"length",r,n,{received:`${r.value.length}`}),r}}}function maxValue(e,t){return{kind:"validation",type:"max_value",reference:maxValue,async:!1,expects:`<=${e instanceof Date?e.toJSON():_stringify(e)}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value>this.requirement&&_addIssue(this,"value",r,n,{received:r.value instanceof Date?r.value.toJSON():_stringify(r.value)}),r}}}function minValue(e,t){return{kind:"validation",type:"min_value",reference:minValue,async:!1,expects:`>=${e instanceof Date?e.toJSON():_stringify(e)}`,requirement:e,message:t,_run(r,n){return r.typed&&r.value<this.requirement&&_addIssue(this,"value",r,n,{received:r.value instanceof Date?r.value.toJSON():_stringify(r.value)}),r}}}function transform(e){return{kind:"transformation",type:"transform",reference:transform,async:!1,operation:e,_run(t){return t.value=this.operation(t.value),t}}}function getDefault(e,t,r){return typeof e.default=="function"?e.default(t,r):e.default}function boolean(e){return{kind:"schema",type:"boolean",reference:boolean,expects:"boolean",async:!1,message:e,_run(t,r){return typeof t.value=="boolean"?t.typed=!0:_addIssue(this,"type",t,r),t}}}function instance(e,t){return{kind:"schema",type:"instance",reference:instance,expects:e.name,async:!1,class:e,message:t,_run(r,n){return r.value instanceof this.class?r.typed=!0:_addIssue(this,"type",r,n),r}}}function number(e){return{kind:"schema",type:"number",reference:number,expects:"number",async:!1,message:e,_run(t,r){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:_addIssue(this,"type",t,r),t}}}function object(e,t){return{kind:"schema",type:"object",reference:object,expects:"Object",async:!1,entries:e,message:t,_run(r,n){const o=r.value;if(o&&typeof o=="object"){r.typed=!0,r.value={};for(const a in this.entries){const l=o[a],u=this.entries[a]._run({typed:!1,value:l},n);if(u.issues){const f={type:"object",origin:"value",input:o,key:a,value:l};for(const x of u.issues)x.path?x.path.unshift(f):x.path=[f],r.issues?.push(x);if(r.issues||(r.issues=u.issues),n.abortEarly){r.typed=!1;break}}u.typed||(r.typed=!1),(u.value!==void 0||a in o)&&(r.value[a]=u.value)}}else _addIssue(this,"type",r,n);return r}}}function optional(e,...t){const r={kind:"schema",type:"optional",reference:optional,expects:`${e.expects} | undefined`,async:!1,wrapped:e,_run(n,o){return n.value===void 0&&("default"in this&&(n.value=getDefault(this,n,o)),n.value===void 0)?(n.typed=!0,n):this.wrapped._run(n,o)}};return 0 in t&&(r.default=t[0]),r}function string(e){return{kind:"schema",type:"string",reference:string,expects:"string",async:!1,message:e,_run(t,r){return typeof t.value=="string"?t.typed=!0:_addIssue(this,"type",t,r),t}}}function _subIssues(e){let t;if(e)for(const r of e)t?t.push(...r.issues):t=r.issues;return t}function union(e,t){return{kind:"schema",type:"union",reference:union,expects:[...new Set(e.map(r=>r.expects))].join(" | ")||"never",async:!1,options:e,message:t,_run(r,n){let o,a,l;for(const u of this.options){const f=u._run({typed:!1,value:r.value},n);if(f.typed)if(f.issues)a?a.push(f):a=[f];else{o=f;break}else l?l.push(f):l=[f]}if(o)return o;if(a){if(a.length===1)return a[0];_addIssue(this,"type",r,n,{issues:_subIssues(a)}),r.typed=!0}else{if(l?.length===1)return l[0];_addIssue(this,"type",r,n,{issues:_subIssues(l)})}return r}}}function parse(e,t,r){const n=e._run({typed:!1,value:t},getGlobalConfig(r));if(n.issues)throw new ValiError(n.issues);return n.value}function pipe(...e){return{...e[0],pipe:e,_run(t,r){for(const n of e)if(n.kind!=="metadata"){if(t.issues&&(n.kind==="schema"||n.kind==="transformation")){t.typed=!1;break}(!t.issues||!r.abortEarly&&!r.abortPipeEarly)&&(t=n._run(t,r))}return t}}}const Uint32Schema=pipe(number(),integer(),minValue(0),maxValue(4294967295)),Uint8Schema=pipe(number(),integer(),minValue(0),maxValue(255)),NetworkSchema=object({messagePrefix:union([string(),instance(Uint8Array)]),bech32:string(),bip32:object({public:Uint32Schema,private:Uint32Schema}),pubKeyHash:Uint8Schema,scriptHash:Uint8Schema,wif:Uint8Schema}),Buffer256Bit=pipe(instance(Uint8Array),length(32));function decodeRaw(e,t){if(e.length===33)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(e.length!==34)throw new Error("Invalid WIF length");if(e[33]!==1)throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function encodeRaw(e,t,r){if(t.length!==32)throw new TypeError("Invalid privateKey length");var n=new Uint8Array(r?34:33),o=new DataView(n.buffer);return o.setUint8(0,e),n.set(t,1),r&&(n[33]=1),n}function decode(e,t){return decodeRaw(bs58Check.decode(e))}function encode(e){return bs58Check.encode(encodeRaw(e.version,e.privateKey,e.compressed))}const h=e=>Buffer.from(e,"hex");function testEcc(e){assert(e.isPoint(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(!e.isPoint(h("030000000000000000000000000000000000000000000000000000000000000005"))),assert(e.isPrivate(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),assert(!e.isPrivate(h("0000000000000000000000000000000000000000000000000000000000000000"))),assert(!e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),assert(!e.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),assert(Buffer.from(e.privateAdd(h("0000000000000000000000000000000000000000000000000000000000000001"),h("0000000000000000000000000000000000000000000000000000000000000000"))).equals(h("0000000000000000000000000000000000000000000000000000000000000001"))),assert(e.privateAdd(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),h("0000000000000000000000000000000000000000000000000000000000000003"))===null),assert(Buffer.from(e.privateAdd(h("e211078564db65c3ce7704f08262b1f38f1ef412ad15b5ac2d76657a63b2c500"),h("b51fbb69051255d1becbd683de5848242a89c229348dd72896a87ada94ae8665"))).equals(h("9730c2ee69edbb958d42db7460bafa18fef9d955325aec99044c81c8282b0a24"))),assert(Buffer.from(e.privateNegate(h("0000000000000000000000000000000000000000000000000000000000000001"))).equals(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),assert(Buffer.from(e.privateNegate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(h("0000000000000000000000000000000000000000000000000000000000000003"))),assert(Buffer.from(e.privateNegate(h("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(h("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792"))),assert(Buffer.from(e.pointCompress(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(Buffer.from(e.pointCompress(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),assert(Buffer.from(e.pointCompress(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(Buffer.from(e.pointCompress(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),assert(Buffer.from(e.pointFromScalar(h("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(h("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),assert(e.xOnlyPointAddTweak(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))===null);let t=e.xOnlyPointAddTweak(h("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),h("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));assert(Buffer.from(t.xOnlyPubkey).equals(h("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&t.parity===1),t=e.xOnlyPointAddTweak(h("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),h("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47")),assert(Buffer.from(t.xOnlyPubkey).equals(h("9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"))&&t.parity===0),assert(Buffer.from(e.sign(h("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(h("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),assert(e.verify(h("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),h("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),e.signSchnorr&&assert(Buffer.from(e.signSchnorr(h("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),h("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),h("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(h("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),e.verifySchnorr&&assert(e.verifySchnorr(h("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),h("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),h("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}function assert(e){if(!e)throw new Error("ecc library invalid")}const HEX_STRINGS="0123456789abcdefABCDEF";HEX_STRINGS.split("").map(e=>e.codePointAt(0));Array(256).fill(!0).map((e,t)=>{const r=String.fromCodePoint(t),n=HEX_STRINGS.indexOf(r);return n<0?void 0:n<16?n:n-6});new TextEncoder;new TextDecoder;function concat(e){const t=e.reduce((o,a)=>o+a.length,0),r=new Uint8Array(t);let n=0;for(const o of e)r.set(o,n),n+=o.length;return r}function writeUInt32(e,t,r,n){if(t+4>e.length)throw new Error("Offset is outside the bounds of Uint8Array");if(n=n.toUpperCase(),r>4294967295)throw new Error(`The value of "value" is out of range. It must be >= 0 and <= ${4294967295}. Received ${r}`);n==="LE"?(e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255):(e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r&255)}const ECPairOptionsSchema=optional(object({compressed:optional(boolean()),network:optional(NetworkSchema),rng:optional(pipe(instance(Function),transform(e=>t=>{const r=parse(optional(number()),t),n=e(r);return parse(instance(Uint8Array),n)})))})),toXOnly=e=>e.length===32?e:e.subarray(1,33);function ECPairFactory(e){testEcc(e);function t(u){return e.isPoint(u)}function r(u,f){if(parse(Buffer256Bit,u),!e.isPrivate(u))throw new TypeError("Private key not in range [1, n)");return parse(ECPairOptionsSchema,f),new l(u,void 0,f)}function n(u,f){if(!e.isPoint(u))throw new Error("Point not on the curve");return parse(ECPairOptionsSchema,f),new l(void 0,u,f)}function o(u,f){const x=decode(u),p=x.version;if(Array.isArray(f)){if(f=f.filter(g=>p===g.wif).pop(),!f)throw new Error("Unknown network version")}else if(f=f||bitcoin,p!==f.wif)throw new Error("Invalid network version");return r(x.privateKey,{compressed:x.compressed,network:f})}function a(u){parse(ECPairOptionsSchema,u),u===void 0&&(u={});const f=u.rng||(p=>crypto.getRandomValues(new Uint8Array(p)));let x;do x=f(32),parse(Buffer256Bit,x);while(!e.isPrivate(x));return r(x,u)}class l{__D;__Q;compressed;network;lowR;constructor(f,x,p){this.__D=f,this.__Q=x,this.lowR=!1,p===void 0&&(p={}),this.compressed=p.compressed===void 0?!0:p.compressed,this.network=p.network||bitcoin,x!==void 0&&(this.__Q=e.pointCompress(x,this.compressed))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){const f=e.pointFromScalar(this.__D,this.compressed);this.__Q=f}return this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return encode({compressed:this.compressed,privateKey:this.__D,version:this.network.wif})}tweak(f){return this.privateKey?this.tweakFromPrivateKey(f):this.tweakFromPublicKey(f)}sign(f,x){if(!this.__D)throw new Error("Missing private key");if(x===void 0&&(x=this.lowR),x===!1)return e.sign(f,this.__D);{let p=e.sign(f,this.__D);const g=new Uint8Array(32);let y=0;for(;p[0]>127;)y++,writeUInt32(g,0,y,"LE"),p=e.sign(f,this.__D,g);return p}}signSchnorr(f){if(!this.privateKey)throw new Error("Missing private key");if(!e.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return e.signSchnorr(f,this.privateKey)}verify(f,x){return e.verify(f,this.publicKey,x)}verifySchnorr(f,x){if(!e.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return e.verifySchnorr(f,this.publicKey.subarray(1,33),x)}tweakFromPublicKey(f){const x=toXOnly(this.publicKey),p=e.xOnlyPointAddTweak(x,f);if(!p||p.xOnlyPubkey===null)throw new Error("Cannot tweak public key!");const g=Uint8Array.from([p.parity===0?2:3]);return n(concat([g,p.xOnlyPubkey]),{network:this.network,compressed:this.compressed})}tweakFromPrivateKey(f){const p=this.publicKey[0]===3||this.publicKey[0]===4&&(this.publicKey[64]&1)===1?e.privateNegate(this.privateKey):this.privateKey,g=e.privateAdd(p,f);if(!g)throw new Error("Invalid tweaked private key!");return r(g,{network:this.network,compressed:this.compressed})}}return{isPoint:t,fromPrivateKey:r,fromPublicKey:n,fromWIF:o,makeRandom:a}}let ECPair=null;function getECPair(){return ECPair||(initEccLib(ecc),ECPair=ECPairFactory(ecc)),ECPair}function nostrPubkeyToBitcoinAddress(e){try{getECPair();const t=Buffer.from(e,"hex"),{address:r}=p2tr({internalPubkey:t,network:bitcoin$1});return r||""}catch(t){return console.error("Error generating Bitcoin address:",t),""}}function npubToBitcoinAddress(e){try{const t=nip19_exports$1.decode(e);if(t.type!=="npub")throw new Error("Invalid npub format");const r=t.data;return nostrPubkeyToBitcoinAddress(r)}catch(t){throw console.error("Error converting npub to Bitcoin address:",t),t}}async function fetchUTXOs(e){const t=await fetch(`https://blockstream.info/api/address/${e}/utxo`);if(!t.ok)throw new Error("Failed to fetch UTXOs");return t.json()}async function getFeeRates(){const e=await fetch("https://blockstream.info/api/fee-estimates");if(!e.ok)throw new Error("Failed to fetch fee estimates");const t=await e.json();return{fastestFee:Math.ceil(t[1]||1),halfHourFee:Math.ceil(t[3]||1),hourFee:Math.ceil(t[6]||1),economyFee:Math.ceil(t[144]||1),minimumFee:Math.ceil(t[504]||1)}}async function broadcastTransaction(e){const t=await fetch("https://blockstream.info/api/tx",{method:"POST",body:e});if(!t.ok){const r=await t.text();throw new Error(`Failed to broadcast transaction: ${r}`)}return t.text()}async function createBitcoinTransaction(e,t,r,n,o){const a=Buffer.from(e,"hex"),l=getECPair().fromPrivateKey(a),u=l.publicKey.slice(1,33),{address:f}=p2tr({internalPubkey:u,network:bitcoin$1});if(!f)throw new Error("Failed to generate change address");const x=new Psbt({network:bitcoin$1});let p=0;for(const j of n)x.addInput({hash:j.txid,index:j.vout,witnessUtxo:{script:p2tr({internalPubkey:u,network:bitcoin$1}).output,value:BigInt(j.value)},tapInternalKey:u}),p+=j.value;const g=n.length*57.5+86+10.5,y=Math.ceil(g*o),b=p-r-y;if(b<0)throw new Error(`Insufficient funds. Need ${r+y} sats, have ${p} sats`);x.addOutput({address:t,value:BigInt(r)}),b>546&&x.addOutput({address:f,value:BigInt(b)});const v=l.tweak(taggedHash("TapTweak",u));for(let j=0;j<n.length;j++)x.signInput(j,v);return x.finalizeAllInputs(),{txHex:x.extractTransaction().toHex(),fee:y}}function satsToBTC(e){return(e/1e8).toFixed(8)}function btcToSats(e){return Math.round(e*1e8)}async function fetchTxHistory(e){const t=await fetch(`https://blockstream.info/api/address/${e}/txs`);if(!t.ok)throw new Error("Failed to fetch transaction history");return t.json()}var browser={},canPromise,hasRequiredCanPromise;function requireCanPromise(){return hasRequiredCanPromise||(hasRequiredCanPromise=1,canPromise=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),canPromise}var qrcode={},utils$1={},hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;hasRequiredUtils$1=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return utils$1.getSymbolSize=function(n){if(!n)throw new Error('"version" cannot be null or undefined');if(n<1||n>40)throw new Error('"version" should be in range from 1 to 40');return n*4+17},utils$1.getSymbolTotalCodewords=function(n){return t[n]},utils$1.getBCHDigit=function(r){let n=0;for(;r!==0;)n++,r>>>=1;return n},utils$1.setToSJISFunction=function(n){if(typeof n!="function")throw new Error('"toSJISFunc" is not a valid function.');e=n},utils$1.isKanjiModeEnabled=function(){return typeof e<"u"},utils$1.toSJIS=function(n){return e(n)},utils$1}var errorCorrectionLevel={},hasRequiredErrorCorrectionLevel;function requireErrorCorrectionLevel(){return hasRequiredErrorCorrectionLevel||(hasRequiredErrorCorrectionLevel=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},e.from=function(n,o){if(e.isValid(n))return n;try{return t(n)}catch{return o}}})(errorCorrectionLevel)),errorCorrectionLevel}var bitBuffer,hasRequiredBitBuffer;function requireBitBuffer(){if(hasRequiredBitBuffer)return bitBuffer;hasRequiredBitBuffer=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const r=Math.floor(t/8);return(this.buffer[r]>>>7-t%8&1)===1},put:function(t,r){for(let n=0;n<r;n++)this.putBit((t>>>r-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}},bitBuffer=e,bitBuffer}var bitMatrix,hasRequiredBitMatrix;function requireBitMatrix(){if(hasRequiredBitMatrix)return bitMatrix;hasRequiredBitMatrix=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,r,n,o){const a=t*this.size+r;this.data[a]=n,o&&(this.reservedBit[a]=!0)},e.prototype.get=function(t,r){return this.data[t*this.size+r]},e.prototype.xor=function(t,r,n){this.data[t*this.size+r]^=n},e.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]},bitMatrix=e,bitMatrix}var alignmentPattern={},hasRequiredAlignmentPattern;function requireAlignmentPattern(){return hasRequiredAlignmentPattern||(hasRequiredAlignmentPattern=1,(function(e){const t=requireUtils$1().getSymbolSize;e.getRowColCoords=function(n){if(n===1)return[];const o=Math.floor(n/7)+2,a=t(n),l=a===145?26:Math.ceil((a-13)/(2*o-2))*2,u=[a-7];for(let f=1;f<o-1;f++)u[f]=u[f-1]-l;return u.push(6),u.reverse()},e.getPositions=function(n){const o=[],a=e.getRowColCoords(n),l=a.length;for(let u=0;u<l;u++)for(let f=0;f<l;f++)u===0&&f===0||u===0&&f===l-1||u===l-1&&f===0||o.push([a[u],a[f]]);return o}})(alignmentPattern)),alignmentPattern}var finderPattern={},hasRequiredFinderPattern;function requireFinderPattern(){if(hasRequiredFinderPattern)return finderPattern;hasRequiredFinderPattern=1;const e=requireUtils$1().getSymbolSize,t=7;return finderPattern.getPositions=function(n){const o=e(n);return[[0,0],[o-t,0],[0,o-t]]},finderPattern}var maskPattern={},hasRequiredMaskPattern;function requireMaskPattern(){return hasRequiredMaskPattern||(hasRequiredMaskPattern=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const a=o.size;let l=0,u=0,f=0,x=null,p=null;for(let g=0;g<a;g++){u=f=0,x=p=null;for(let y=0;y<a;y++){let b=o.get(g,y);b===x?u++:(u>=5&&(l+=t.N1+(u-5)),x=b,u=1),b=o.get(y,g),b===p?f++:(f>=5&&(l+=t.N1+(f-5)),p=b,f=1)}u>=5&&(l+=t.N1+(u-5)),f>=5&&(l+=t.N1+(f-5))}return l},e.getPenaltyN2=function(o){const a=o.size;let l=0;for(let u=0;u<a-1;u++)for(let f=0;f<a-1;f++){const x=o.get(u,f)+o.get(u,f+1)+o.get(u+1,f)+o.get(u+1,f+1);(x===4||x===0)&&l++}return l*t.N2},e.getPenaltyN3=function(o){const a=o.size;let l=0,u=0,f=0;for(let x=0;x<a;x++){u=f=0;for(let p=0;p<a;p++)u=u<<1&2047|o.get(x,p),p>=10&&(u===1488||u===93)&&l++,f=f<<1&2047|o.get(p,x),p>=10&&(f===1488||f===93)&&l++}return l*t.N3},e.getPenaltyN4=function(o){let a=0;const l=o.data.length;for(let f=0;f<l;f++)a+=o.data[f];return Math.abs(Math.ceil(a*100/l/5)-10)*t.N4};function r(n,o,a){switch(n){case e.Patterns.PATTERN000:return(o+a)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return a%3===0;case e.Patterns.PATTERN011:return(o+a)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(a/3))%2===0;case e.Patterns.PATTERN101:return o*a%2+o*a%3===0;case e.Patterns.PATTERN110:return(o*a%2+o*a%3)%2===0;case e.Patterns.PATTERN111:return(o*a%3+(o+a)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}e.applyMask=function(o,a){const l=a.size;for(let u=0;u<l;u++)for(let f=0;f<l;f++)a.isReserved(f,u)||a.xor(f,u,r(o,f,u))},e.getBestMask=function(o,a){const l=Object.keys(e.Patterns).length;let u=0,f=1/0;for(let x=0;x<l;x++){a(x),e.applyMask(x,o);const p=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(x,o),p<f&&(f=p,u=x)}return u}})(maskPattern)),maskPattern}var errorCorrectionCode={},hasRequiredErrorCorrectionCode;function requireErrorCorrectionCode(){if(hasRequiredErrorCorrectionCode)return errorCorrectionCode;hasRequiredErrorCorrectionCode=1;const e=requireErrorCorrectionLevel(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],r=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return errorCorrectionCode.getBlocksCount=function(o,a){switch(a){case e.L:return t[(o-1)*4+0];case e.M:return t[(o-1)*4+1];case e.Q:return t[(o-1)*4+2];case e.H:return t[(o-1)*4+3];default:return}},errorCorrectionCode.getTotalCodewordsCount=function(o,a){switch(a){case e.L:return r[(o-1)*4+0];case e.M:return r[(o-1)*4+1];case e.Q:return r[(o-1)*4+2];case e.H:return r[(o-1)*4+3];default:return}},errorCorrectionCode}var polynomial={},galoisField={},hasRequiredGaloisField;function requireGaloisField(){if(hasRequiredGaloisField)return galoisField;hasRequiredGaloisField=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let n=1;for(let o=0;o<255;o++)e[o]=n,t[n]=o,n<<=1,n&256&&(n^=285);for(let o=255;o<512;o++)e[o]=e[o-255]})(),galoisField.log=function(n){if(n<1)throw new Error("log("+n+")");return t[n]},galoisField.exp=function(n){return e[n]},galoisField.mul=function(n,o){return n===0||o===0?0:e[t[n]+t[o]]},galoisField}var hasRequiredPolynomial;function requirePolynomial(){return hasRequiredPolynomial||(hasRequiredPolynomial=1,(function(e){const t=requireGaloisField();e.mul=function(n,o){const a=new Uint8Array(n.length+o.length-1);for(let l=0;l<n.length;l++)for(let u=0;u<o.length;u++)a[l+u]^=t.mul(n[l],o[u]);return a},e.mod=function(n,o){let a=new Uint8Array(n);for(;a.length-o.length>=0;){const l=a[0];for(let f=0;f<o.length;f++)a[f]^=t.mul(o[f],l);let u=0;for(;u<a.length&&a[u]===0;)u++;a=a.slice(u)}return a},e.generateECPolynomial=function(n){let o=new Uint8Array([1]);for(let a=0;a<n;a++)o=e.mul(o,new Uint8Array([1,t.exp(a)]));return o}})(polynomial)),polynomial}var reedSolomonEncoder,hasRequiredReedSolomonEncoder;function requireReedSolomonEncoder(){if(hasRequiredReedSolomonEncoder)return reedSolomonEncoder;hasRequiredReedSolomonEncoder=1;const e=requirePolynomial();function t(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(n){this.degree=n,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(n){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(n.length+this.degree);o.set(n);const a=e.mod(o,this.genPoly),l=this.degree-a.length;if(l>0){const u=new Uint8Array(this.degree);return u.set(a,l),u}return a},reedSolomonEncoder=t,reedSolomonEncoder}var version={},mode={},versionCheck={},hasRequiredVersionCheck;function requireVersionCheck(){return hasRequiredVersionCheck||(hasRequiredVersionCheck=1,versionCheck.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),versionCheck}var regex={},hasRequiredRegex;function requireRegex(){if(hasRequiredRegex)return regex;hasRequiredRegex=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const n="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+`)(?:.|[\r
]))+`;regex.KANJI=new RegExp(r,"g"),regex.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),regex.BYTE=new RegExp(n,"g"),regex.NUMERIC=new RegExp(e,"g"),regex.ALPHANUMERIC=new RegExp(t,"g");const o=new RegExp("^"+r+"$"),a=new RegExp("^"+e+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return regex.testKanji=function(f){return o.test(f)},regex.testNumeric=function(f){return a.test(f)},regex.testAlphanumeric=function(f){return l.test(f)},regex}var hasRequiredMode;function requireMode(){return hasRequiredMode||(hasRequiredMode=1,(function(e){const t=requireVersionCheck(),r=requireRegex();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(a,l){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?a.ccBits[0]:l<27?a.ccBits[1]:a.ccBits[2]},e.getBestModeForData=function(a){return r.testNumeric(a)?e.NUMERIC:r.testAlphanumeric(a)?e.ALPHANUMERIC:r.testKanji(a)?e.KANJI:e.BYTE},e.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},e.isValid=function(a){return a&&a.bit&&a.ccBits};function n(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(a,l){if(e.isValid(a))return a;try{return n(a)}catch{return l}}})(mode)),mode}var hasRequiredVersion;function requireVersion(){return hasRequiredVersion||(hasRequiredVersion=1,(function(e){const t=requireUtils$1(),r=requireErrorCorrectionCode(),n=requireErrorCorrectionLevel(),o=requireMode(),a=requireVersionCheck(),l=7973,u=t.getBCHDigit(l);function f(y,b,w){for(let v=1;v<=40;v++)if(b<=e.getCapacity(v,w,y))return v}function x(y,b){return o.getCharCountIndicator(y,b)+4}function p(y,b){let w=0;return y.forEach(function(v){const B=x(v.mode,b);w+=B+v.getBitsLength()}),w}function g(y,b){for(let w=1;w<=40;w++)if(p(y,w)<=e.getCapacity(w,b,o.MIXED))return w}e.from=function(b,w){return a.isValid(b)?parseInt(b,10):w},e.getCapacity=function(b,w,v){if(!a.isValid(b))throw new Error("Invalid QR Code version");typeof v>"u"&&(v=o.BYTE);const B=t.getSymbolTotalCodewords(b),j=r.getTotalCodewordsCount(b,w),F=(B-j)*8;if(v===o.MIXED)return F;const C=F-x(v,b);switch(v){case o.NUMERIC:return Math.floor(C/10*3);case o.ALPHANUMERIC:return Math.floor(C/11*2);case o.KANJI:return Math.floor(C/13);case o.BYTE:default:return Math.floor(C/8)}},e.getBestVersionForData=function(b,w){let v;const B=n.from(w,n.M);if(Array.isArray(b)){if(b.length>1)return g(b,B);if(b.length===0)return 1;v=b[0]}else v=b;return f(v.mode,v.getLength(),B)},e.getEncodedBits=function(b){if(!a.isValid(b)||b<7)throw new Error("Invalid QR Code version");let w=b<<12;for(;t.getBCHDigit(w)-u>=0;)w^=l<<t.getBCHDigit(w)-u;return b<<12|w}})(version)),version}var formatInfo={},hasRequiredFormatInfo;function requireFormatInfo(){if(hasRequiredFormatInfo)return formatInfo;hasRequiredFormatInfo=1;const e=requireUtils$1(),t=1335,r=21522,n=e.getBCHDigit(t);return formatInfo.getEncodedBits=function(a,l){const u=a.bit<<3|l;let f=u<<10;for(;e.getBCHDigit(f)-n>=0;)f^=t<<e.getBCHDigit(f)-n;return(u<<10|f)^r},formatInfo}var segments={},numericData,hasRequiredNumericData;function requireNumericData(){if(hasRequiredNumericData)return numericData;hasRequiredNumericData=1;const e=requireMode();function t(r){this.mode=e.NUMERIC,this.data=r.toString()}return t.getBitsLength=function(n){return 10*Math.floor(n/3)+(n%3?n%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){let o,a,l;for(o=0;o+3<=this.data.length;o+=3)a=this.data.substr(o,3),l=parseInt(a,10),n.put(l,10);const u=this.data.length-o;u>0&&(a=this.data.substr(o),l=parseInt(a,10),n.put(l,u*3+1))},numericData=t,numericData}var alphanumericData,hasRequiredAlphanumericData;function requireAlphanumericData(){if(hasRequiredAlphanumericData)return alphanumericData;hasRequiredAlphanumericData=1;const e=requireMode(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function r(n){this.mode=e.ALPHANUMERIC,this.data=n}return r.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(o){let a;for(a=0;a+2<=this.data.length;a+=2){let l=t.indexOf(this.data[a])*45;l+=t.indexOf(this.data[a+1]),o.put(l,11)}this.data.length%2&&o.put(t.indexOf(this.data[a]),6)},alphanumericData=r,alphanumericData}var byteData,hasRequiredByteData;function requireByteData(){if(hasRequiredByteData)return byteData;hasRequiredByteData=1;const e=requireMode();function t(r){this.mode=e.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}return t.getBitsLength=function(n){return n*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){for(let n=0,o=this.data.length;n<o;n++)r.put(this.data[n],8)},byteData=t,byteData}var kanjiData,hasRequiredKanjiData;function requireKanjiData(){if(hasRequiredKanjiData)return kanjiData;hasRequiredKanjiData=1;const e=requireMode(),t=requireUtils$1();function r(n){this.mode=e.KANJI,this.data=n}return r.getBitsLength=function(o){return o*13},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(n){let o;for(o=0;o<this.data.length;o++){let a=t.toSJIS(this.data[o]);if(a>=33088&&a<=40956)a-=33088;else if(a>=57408&&a<=60351)a-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);a=(a>>>8&255)*192+(a&255),n.put(a,13)}},kanjiData=r,kanjiData}var dijkstra={exports:{}},hasRequiredDijkstra;function requireDijkstra(){return hasRequiredDijkstra||(hasRequiredDijkstra=1,(function(e){var t={single_source_shortest_paths:function(r,n,o){var a={},l={};l[n]=0;var u=t.PriorityQueue.make();u.push(n,0);for(var f,x,p,g,y,b,w,v,B;!u.empty();){f=u.pop(),x=f.value,g=f.cost,y=r[x]||{};for(p in y)y.hasOwnProperty(p)&&(b=y[p],w=g+b,v=l[p],B=typeof l[p]>"u",(B||v>w)&&(l[p]=w,u.push(p,w),a[p]=x))}if(typeof o<"u"&&typeof l[o]>"u"){var j=["Could not find a path from ",n," to ",o,"."].join("");throw new Error(j)}return a},extract_shortest_path_from_predecessor_list:function(r,n){for(var o=[],a=n;a;)o.push(a),r[a],a=r[a];return o.reverse(),o},find_path:function(r,n,o){var a=t.single_source_shortest_paths(r,n,o);return t.extract_shortest_path_from_predecessor_list(a,o)},PriorityQueue:{make:function(r){var n=t.PriorityQueue,o={},a;r=r||{};for(a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);return o.queue=[],o.sorter=r.sorter||n.default_sorter,o},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var o={value:r,cost:n};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(dijkstra)),dijkstra.exports}var hasRequiredSegments;function requireSegments(){return hasRequiredSegments||(hasRequiredSegments=1,(function(e){const t=requireMode(),r=requireNumericData(),n=requireAlphanumericData(),o=requireByteData(),a=requireKanjiData(),l=requireRegex(),u=requireUtils$1(),f=requireDijkstra();function x(j){return unescape(encodeURIComponent(j)).length}function p(j,F,C){const N=[];let T;for(;(T=j.exec(C))!==null;)N.push({data:T[0],index:T.index,mode:F,length:T[0].length});return N}function g(j){const F=p(l.NUMERIC,t.NUMERIC,j),C=p(l.ALPHANUMERIC,t.ALPHANUMERIC,j);let N,T;return u.isKanjiModeEnabled()?(N=p(l.BYTE,t.BYTE,j),T=p(l.KANJI,t.KANJI,j)):(N=p(l.BYTE_KANJI,t.BYTE,j),T=[]),F.concat(C,N,T).sort(function(S,O){return S.index-O.index}).map(function(S){return{data:S.data,mode:S.mode,length:S.length}})}function y(j,F){switch(F){case t.NUMERIC:return r.getBitsLength(j);case t.ALPHANUMERIC:return n.getBitsLength(j);case t.KANJI:return a.getBitsLength(j);case t.BYTE:return o.getBitsLength(j)}}function b(j){return j.reduce(function(F,C){const N=F.length-1>=0?F[F.length-1]:null;return N&&N.mode===C.mode?(F[F.length-1].data+=C.data,F):(F.push(C),F)},[])}function w(j){const F=[];for(let C=0;C<j.length;C++){const N=j[C];switch(N.mode){case t.NUMERIC:F.push([N,{data:N.data,mode:t.ALPHANUMERIC,length:N.length},{data:N.data,mode:t.BYTE,length:N.length}]);break;case t.ALPHANUMERIC:F.push([N,{data:N.data,mode:t.BYTE,length:N.length}]);break;case t.KANJI:F.push([N,{data:N.data,mode:t.BYTE,length:x(N.data)}]);break;case t.BYTE:F.push([{data:N.data,mode:t.BYTE,length:x(N.data)}])}}return F}function v(j,F){const C={},N={start:{}};let T=["start"];for(let _=0;_<j.length;_++){const S=j[_],O=[];for(let $=0;$<S.length;$++){const z=S[$],W=""+_+$;O.push(W),C[W]={node:z,lastCount:0},N[W]={};for(let U=0;U<T.length;U++){const I=T[U];C[I]&&C[I].node.mode===z.mode?(N[I][W]=y(C[I].lastCount+z.length,z.mode)-y(C[I].lastCount,z.mode),C[I].lastCount+=z.length):(C[I]&&(C[I].lastCount=z.length),N[I][W]=y(z.length,z.mode)+4+t.getCharCountIndicator(z.mode,F))}}T=O}for(let _=0;_<T.length;_++)N[T[_]].end=0;return{map:N,table:C}}function B(j,F){let C;const N=t.getBestModeForData(j);if(C=t.from(F,N),C!==t.BYTE&&C.bit<N.bit)throw new Error('"'+j+'" cannot be encoded with mode '+t.toString(C)+`.
 Suggested mode is: `+t.toString(N));switch(C===t.KANJI&&!u.isKanjiModeEnabled()&&(C=t.BYTE),C){case t.NUMERIC:return new r(j);case t.ALPHANUMERIC:return new n(j);case t.KANJI:return new a(j);case t.BYTE:return new o(j)}}e.fromArray=function(F){return F.reduce(function(C,N){return typeof N=="string"?C.push(B(N,null)):N.data&&C.push(B(N.data,N.mode)),C},[])},e.fromString=function(F,C){const N=g(F,u.isKanjiModeEnabled()),T=w(N),_=v(T,C),S=f.find_path(_.map,"start","end"),O=[];for(let $=1;$<S.length-1;$++)O.push(_.table[S[$]].node);return e.fromArray(b(O))},e.rawSplit=function(F){return e.fromArray(g(F,u.isKanjiModeEnabled()))}})(segments)),segments}var hasRequiredQrcode;function requireQrcode(){if(hasRequiredQrcode)return qrcode;hasRequiredQrcode=1;const e=requireUtils$1(),t=requireErrorCorrectionLevel(),r=requireBitBuffer(),n=requireBitMatrix(),o=requireAlignmentPattern(),a=requireFinderPattern(),l=requireMaskPattern(),u=requireErrorCorrectionCode(),f=requireReedSolomonEncoder(),x=requireVersion(),p=requireFormatInfo(),g=requireMode(),y=requireSegments();function b(_,S){const O=_.size,$=a.getPositions(S);for(let z=0;z<$.length;z++){const W=$[z][0],U=$[z][1];for(let I=-1;I<=7;I++)if(!(W+I<=-1||O<=W+I))for(let G=-1;G<=7;G++)U+G<=-1||O<=U+G||(I>=0&&I<=6&&(G===0||G===6)||G>=0&&G<=6&&(I===0||I===6)||I>=2&&I<=4&&G>=2&&G<=4?_.set(W+I,U+G,!0,!0):_.set(W+I,U+G,!1,!0))}}function w(_){const S=_.size;for(let O=8;O<S-8;O++){const $=O%2===0;_.set(O,6,$,!0),_.set(6,O,$,!0)}}function v(_,S){const O=o.getPositions(S);for(let $=0;$<O.length;$++){const z=O[$][0],W=O[$][1];for(let U=-2;U<=2;U++)for(let I=-2;I<=2;I++)U===-2||U===2||I===-2||I===2||U===0&&I===0?_.set(z+U,W+I,!0,!0):_.set(z+U,W+I,!1,!0)}}function B(_,S){const O=_.size,$=x.getEncodedBits(S);let z,W,U;for(let I=0;I<18;I++)z=Math.floor(I/3),W=I%3+O-8-3,U=($>>I&1)===1,_.set(z,W,U,!0),_.set(W,z,U,!0)}function j(_,S,O){const $=_.size,z=p.getEncodedBits(S,O);let W,U;for(W=0;W<15;W++)U=(z>>W&1)===1,W<6?_.set(W,8,U,!0):W<8?_.set(W+1,8,U,!0):_.set($-15+W,8,U,!0),W<8?_.set(8,$-W-1,U,!0):W<9?_.set(8,15-W-1+1,U,!0):_.set(8,15-W-1,U,!0);_.set($-8,8,1,!0)}function F(_,S){const O=_.size;let $=-1,z=O-1,W=7,U=0;for(let I=O-1;I>0;I-=2)for(I===6&&I--;;){for(let G=0;G<2;G++)if(!_.isReserved(z,I-G)){let k=!1;U<S.length&&(k=(S[U]>>>W&1)===1),_.set(z,I-G,k),W--,W===-1&&(U++,W=7)}if(z+=$,z<0||O<=z){z-=$,$=-$;break}}}function C(_,S,O){const $=new r;O.forEach(function(G){$.put(G.mode.bit,4),$.put(G.getLength(),g.getCharCountIndicator(G.mode,_)),G.write($)});const z=e.getSymbolTotalCodewords(_),W=u.getTotalCodewordsCount(_,S),U=(z-W)*8;for($.getLengthInBits()+4<=U&&$.put(0,4);$.getLengthInBits()%8!==0;)$.putBit(0);const I=(U-$.getLengthInBits())/8;for(let G=0;G<I;G++)$.put(G%2?17:236,8);return N($,_,S)}function N(_,S,O){const $=e.getSymbolTotalCodewords(S),z=u.getTotalCodewordsCount(S,O),W=$-z,U=u.getBlocksCount(S,O),I=$%U,G=U-I,k=Math.floor($/U),M=Math.floor(W/U),q=M+1,K=k-M,H=new f(K);let Q=0;const D=new Array(U),Y=new Array(U);let J=0;const L=new Uint8Array(_.buffer);for(let xe=0;xe<U;xe++){const te=xe<G?M:q;D[xe]=L.slice(Q,Q+te),Y[xe]=H.encode(D[xe]),Q+=te,J=Math.max(J,te)}const Z=new Uint8Array($);let oe=0,ce,de;for(ce=0;ce<J;ce++)for(de=0;de<U;de++)ce<D[de].length&&(Z[oe++]=D[de][ce]);for(ce=0;ce<K;ce++)for(de=0;de<U;de++)Z[oe++]=Y[de][ce];return Z}function T(_,S,O,$){let z;if(Array.isArray(_))z=y.fromArray(_);else if(typeof _=="string"){let k=S;if(!k){const M=y.rawSplit(_);k=x.getBestVersionForData(M,O)}z=y.fromString(_,k||40)}else throw new Error("Invalid data");const W=x.getBestVersionForData(z,O);if(!W)throw new Error("The amount of data is too big to be stored in a QR Code");if(!S)S=W;else if(S<W)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+W+`.
`);const U=C(S,O,z),I=e.getSymbolSize(S),G=new n(I);return b(G,S),w(G),v(G,S),j(G,O,0),S>=7&&B(G,S),F(G,U),isNaN($)&&($=l.getBestMask(G,j.bind(null,G,O))),l.applyMask($,G),j(G,O,$),{modules:G,version:S,errorCorrectionLevel:O,maskPattern:$,segments:z}}return qrcode.create=function(S,O){if(typeof S>"u"||S==="")throw new Error("No input text");let $=t.M,z,W;return typeof O<"u"&&($=t.from(O.errorCorrectionLevel,t.M),z=x.from(O.version),W=l.from(O.maskPattern),O.toSJISFunc&&e.setToSJISFunction(O.toSJISFunc)),T(S,z,$,W)},qrcode}var canvas={},utils={},hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(a){return[a,a]}))),n.length===6&&n.push("F","F");const o=parseInt(n.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+n.slice(0,6).join("")}}e.getOptions=function(n){n||(n={}),n.color||(n.color={});const o=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,a=n.width&&n.width>=21?n.width:void 0,l=n.scale||4;return{width:a,scale:a?4:l,margin:o,color:{dark:t(n.color.dark||"#000000ff"),light:t(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},e.getScale=function(n,o){return o.width&&o.width>=n+o.margin*2?o.width/(n+o.margin*2):o.scale},e.getImageWidth=function(n,o){const a=e.getScale(n,o);return Math.floor((n+o.margin*2)*a)},e.qrToImageData=function(n,o,a){const l=o.modules.size,u=o.modules.data,f=e.getScale(l,a),x=Math.floor((l+a.margin*2)*f),p=a.margin*f,g=[a.color.light,a.color.dark];for(let y=0;y<x;y++)for(let b=0;b<x;b++){let w=(y*x+b)*4,v=a.color.light;if(y>=p&&b>=p&&y<x-p&&b<x-p){const B=Math.floor((y-p)/f),j=Math.floor((b-p)/f);v=g[u[B*l+j]?1:0]}n[w++]=v.r,n[w++]=v.g,n[w++]=v.b,n[w]=v.a}}})(utils)),utils}var hasRequiredCanvas;function requireCanvas(){return hasRequiredCanvas||(hasRequiredCanvas=1,(function(e){const t=requireUtils();function r(o,a,l){o.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=l,a.width=l,a.style.height=l+"px",a.style.width=l+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(a,l,u){let f=u,x=l;typeof f>"u"&&(!l||!l.getContext)&&(f=l,l=void 0),l||(x=n()),f=t.getOptions(f);const p=t.getImageWidth(a.modules.size,f),g=x.getContext("2d"),y=g.createImageData(p,p);return t.qrToImageData(y.data,a,f),r(g,x,p),g.putImageData(y,0,0),x},e.renderToDataURL=function(a,l,u){let f=u;typeof f>"u"&&(!l||!l.getContext)&&(f=l,l=void 0),f||(f={});const x=e.render(a,l,f),p=f.type||"image/png",g=f.rendererOpts||{};return x.toDataURL(p,g.quality)}})(canvas)),canvas}var svgTag={},hasRequiredSvgTag;function requireSvgTag(){if(hasRequiredSvgTag)return svgTag;hasRequiredSvgTag=1;const e=requireUtils();function t(o,a){const l=o.a/255,u=a+'="'+o.hex+'"';return l<1?u+" "+a+'-opacity="'+l.toFixed(2).slice(1)+'"':u}function r(o,a,l){let u=o+a;return typeof l<"u"&&(u+=" "+l),u}function n(o,a,l){let u="",f=0,x=!1,p=0;for(let g=0;g<o.length;g++){const y=Math.floor(g%a),b=Math.floor(g/a);!y&&!x&&(x=!0),o[g]?(p++,g>0&&y>0&&o[g-1]||(u+=x?r("M",y+l,.5+b+l):r("m",f,0),f=0,x=!1),y+1<a&&o[g+1]||(u+=r("h",p),p=0)):f++}return u}return svgTag.render=function(a,l,u){const f=e.getOptions(l),x=a.modules.size,p=a.modules.data,g=x+f.margin*2,y=f.color.light.a?"<path "+t(f.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",b="<path "+t(f.color.dark,"stroke")+' d="'+n(p,x,f.margin)+'"/>',w='viewBox="0 0 '+g+" "+g+'"',B='<svg xmlns="http://www.w3.org/2000/svg" '+(f.width?'width="'+f.width+'" height="'+f.width+'" ':"")+w+' shape-rendering="crispEdges">'+y+b+`</svg>
`;return typeof u=="function"&&u(null,B),B},svgTag}var hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser;hasRequiredBrowser=1;const e=requireCanPromise(),t=requireQrcode(),r=requireCanvas(),n=requireSvgTag();function o(a,l,u,f,x){const p=[].slice.call(arguments,1),g=p.length,y=typeof p[g-1]=="function";if(!y&&!e())throw new Error("Callback required as last argument");if(y){if(g<2)throw new Error("Too few arguments provided");g===2?(x=u,u=l,l=f=void 0):g===3&&(l.getContext&&typeof x>"u"?(x=f,f=void 0):(x=f,f=u,u=l,l=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(u=l,l=f=void 0):g===2&&!l.getContext&&(f=u,u=l,l=void 0),new Promise(function(b,w){try{const v=t.create(u,f);b(a(v,l,f))}catch(v){w(v)}})}try{const b=t.create(u,f);x(null,a(b,l,f))}catch(b){x(b)}}return browser.create=t.create,browser.toCanvas=o.bind(null,r.render),browser.toDataURL=o.bind(null,r.renderToDataURL),browser.toString=o.bind(null,function(a,l,u){return n.render(a,u)}),browser}var browserExports=requireBrowser();const QRCode=getDefaultExportFromCjs$1(browserExports),ReceiveModal=({isOpen:e,onClose:t,address:r})=>{const[n,o]=reactExports.useState(""),[a,l]=reactExports.useState(!1);if(reactExports.useEffect(()=>{e&&r&&QRCode.toDataURL(r,{width:300,margin:2,color:{dark:"#000000",light:"#ffffff"}}).then(f=>o(f)).catch(f=>console.error("Error generating QR code:",f))},[e,r]),!e)return null;const u=()=>{navigator.clipboard.writeText(r),l(!0),setTimeout(()=>l(!1),2e3)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-sm overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Receive Bitcoin"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 flex flex-col items-center",children:[n&&jsxRuntimeExports.jsx("div",{className:"bg-white p-4 rounded-xl mb-6",children:jsxRuntimeExports.jsx("img",{src:n,alt:"Bitcoin Address QR Code",className:"w-48 h-48"})}),jsxRuntimeExports.jsx("div",{className:"w-full bg-slate-950 p-4 rounded-xl border border-slate-800 flex items-center justify-between gap-3 mb-2",children:jsxRuntimeExports.jsx("p",{className:"font-mono text-sm text-slate-300 break-all text-center",children:r})}),jsxRuntimeExports.jsxs("button",{onClick:u,className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors text-sm",children:[a?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"}),a?"Copied!":"Copy Address"]})]})]})})},SatoshiIcon=({className:e=""})=>jsxRuntimeExports.jsx("i",{className:`fak fa-satoshisymbol-solid ${e}`}),SendModal=({isOpen:e,onClose:t,utxos:r,onSuccess:n,initialRecipient:o=""})=>{const{decryptedKey:a}=useAuthStore(),[l,u]=reactExports.useState("details"),[f,x]=reactExports.useState(o),[p,g]=reactExports.useState(""),[y,b]=reactExports.useState(""),[w,v]=reactExports.useState("sats"),[B,j]=reactExports.useState(1),[F,C]=reactExports.useState(null),[N,T]=reactExports.useState(null),[_,S]=reactExports.useState(""),[O,$]=reactExports.useState(0),{currentKeypairId:z,wallets:W,currentWalletId:U}=useWalletStore(),G=W.find(Z=>Z.id===U)?.keypairs.find(Z=>Z.id===z),[k,M]=reactExports.useState([]),[q,K]=reactExports.useState(!1),[H,Q]=reactExports.useState(!1),[D,Y]=reactExports.useState(null);reactExports.useEffect(()=>{e&&G&&(console.log("[SendModal] Fetching contacts for keypair:",G.npub),K(!0),Y(null),ProfileService.fetchContacts(G.npub).then(Z=>{console.log("[SendModal] Received contacts:",Z.length),M(Z)}).catch(Z=>{console.error("[SendModal] Error fetching contacts:",Z),Y("Failed to fetch user follows")}).finally(()=>K(!1)))},[e,G]),reactExports.useEffect(()=>{e&&(getFeeRates().then(C).catch(console.error),u("details"),x(o),g(""),b(""),T(null))},[e]),reactExports.useEffect(()=>{const Z=f.trim();if(Z.startsWith("npub"))try{const oe=npubToBitcoinAddress(Z);g(oe)}catch{g("")}else Z.startsWith("bc1")||Z.startsWith("1")||Z.startsWith("3")?g(Z):g("")},[f]);const J=async()=>{if(T(null),!p){T("Invalid Bitcoin address or npub");return}const Z=w==="btc"?btcToSats(parseFloat(y)):parseInt(y);if(isNaN(Z)||Z<=0){T("Invalid amount");return}if(!a){T("Wallet locked");return}try{const{txHex:oe,fee:ce}=await createBitcoinTransaction(a,p,Z,r,B);S(oe),$(ce),u("confirm")}catch(oe){console.error(oe),T(oe.message||"Failed to create transaction")}},L=async()=>{u("broadcasting");try{await broadcastTransaction(_),u("success"),setTimeout(()=>{n(),t()},2e3)}catch(Z){console.error(Z),T(Z.message||"Failed to broadcast transaction"),u("confirm")}};return e?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Send Bitcoin"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[l==="details"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Recipient"}),jsxRuntimeExports.jsx("input",{type:"text",value:f,onChange:Z=>x(Z.target.value),placeholder:"Bitcoin address or npub...",className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm"}),f.startsWith("npub")&&p&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-green-500 mt-1 break-all",children:["Resolved: ",p]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[G&&jsxRuntimeExports.jsxs("button",{onClick:()=>x(G.npub),className:"px-3 py-2 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 text-xs font-medium rounded-lg transition-colors flex items-center gap-2",children:[jsxRuntimeExports.jsx(ArrowRight,{className:"w-3.5 h-3.5"}),"Send to Myself"]}),G&&jsxRuntimeExports.jsxs("button",{onClick:()=>Q(!H),className:`px-3 py-2 text-xs font-medium rounded-lg transition-colors flex items-center gap-2 ${H?"bg-amber-500/20 text-amber-400":"bg-amber-500/10 hover:bg-amber-500/20 text-amber-500"}`,children:[jsxRuntimeExports.jsx(User,{className:"w-3.5 h-3.5"}),H?"Hide Follows":"Select from Follows"]})]}),H&&jsxRuntimeExports.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto bg-slate-950 border border-slate-800 rounded-xl p-2 space-y-2 custom-scrollbar",children:q?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-slate-400 gap-2",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-5 h-5 animate-spin text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:"Currently fetching user follows..."})]}):D?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-red-400 gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:D})]}):k.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-slate-400 gap-2",children:[jsxRuntimeExports.jsx(User,{className:"w-5 h-5 opacity-50"}),jsxRuntimeExports.jsx("span",{className:"text-xs",children:"User not following anyone"})]}):k.map(Z=>{let oe="";try{oe=Z.npub?npubToBitcoinAddress(Z.npub):""}catch{return null}if(!oe)return null;const ce=Z.npub===f;return jsxRuntimeExports.jsxs("div",{onClick:()=>{x(Z.npub)},className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors group border ${ce?"bg-amber-500/10 border-amber-500/30":"hover:bg-slate-900 border-transparent"}`,children:[Z.picture?jsxRuntimeExports.jsx("img",{src:Z.picture,alt:Z.name,className:"w-8 h-8 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-slate-500"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"font-bold text-sm text-white truncate",children:Z.name||"Unknown"}),Z.nip05&&jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 truncate",children:Z.nip05})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[jsxRuntimeExports.jsxs("span",{className:"font-mono truncate",children:[Z.npub.slice(0,8),"...",Z.npub.slice(-8)]}),jsxRuntimeExports.jsx("button",{onClick:de=>{de.stopPropagation(),navigator.clipboard.writeText(Z.npub)},className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",title:"Copy npub",children:jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[jsxRuntimeExports.jsx("span",{className:"font-mono truncate text-amber-500/70",children:oe.length>16?`${oe.slice(0,8)}...${oe.slice(-8)}`:oe}),jsxRuntimeExports.jsx("button",{onClick:de=>{de.stopPropagation(),navigator.clipboard.writeText(oe)},className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",title:"Copy Bitcoin Address",children:jsxRuntimeExports.jsx(Copy,{className:"w-3 h-3"})})]})]})]},Z.npub)})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-1",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"Amount"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-slate-500",children:["Available: ",r.reduce((Z,oe)=>Z+oe.value,0).toLocaleString()," sats"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 border border-slate-800 rounded-xl p-3 focus-within:ring-2 focus-within:ring-amber-500 focus-within:border-transparent transition-all",children:[w==="sats"?jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-xl text-amber-500 flex-shrink-0"}):jsxRuntimeExports.jsx("span",{className:"text-xl text-amber-500 flex-shrink-0",children:""}),jsxRuntimeExports.jsx("input",{type:"number",value:y,onChange:Z=>b(Z.target.value),placeholder:"0.00",className:"flex-1 bg-transparent text-white outline-none font-mono text-lg min-w-0"}),jsxRuntimeExports.jsx("button",{onClick:()=>{const Z=r.reduce((oe,ce)=>oe+ce.value,0);b(w==="sats"?Z.toString():satsToBTC(Z).toString())},className:"px-2 py-1 bg-amber-500/10 hover:bg-amber-500/20 text-amber-500 text-xs font-bold rounded transition-colors",children:"MAX"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>v(w==="sats"?"btc":"sats"),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Toggle unit",children:jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4 text-slate-400"})}),jsxRuntimeExports.jsx("span",{className:"text-slate-400 font-medium text-sm flex-shrink-0",children:w==="sats"?"sats":"BTC"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Fee Rate (sat/vB)"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>F&&j(F.hourFee),className:`p-2 rounded-lg border text-xs transition-all ${B===F?.hourFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Slow"}),jsxRuntimeExports.jsxs("div",{children:[F?.hourFee||"-"," sat/vB"]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>F&&j(F.halfHourFee),className:`p-2 rounded-lg border text-xs transition-all ${B===F?.halfHourFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Normal"}),jsxRuntimeExports.jsxs("div",{children:[F?.halfHourFee||"-"," sat/vB"]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>F&&j(F.fastestFee),className:`p-2 rounded-lg border text-xs transition-all ${B===F?.fastestFee?"bg-amber-500/10 border-amber-500 text-amber-500":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"Fast"}),jsxRuntimeExports.jsxs("div",{children:[F?.fastestFee||"-"," sat/vB"]})]})]}),jsxRuntimeExports.jsx("input",{type:"number",value:B,onChange:Z=>j(parseInt(Z.target.value)||1),className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white focus:ring-2 focus:ring-amber-500 focus:border-transparent outline-none transition-all font-mono text-sm"})]}),N&&jsxRuntimeExports.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),N]}),jsxRuntimeExports.jsxs("button",{onClick:J,className:"w-full py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:["Review Transaction",jsxRuntimeExports.jsx(ArrowRight,{className:"w-4 h-4"})]})]}),l==="confirm"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 p-4 rounded-xl border border-slate-800 space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:"Amount"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("span",{className:"text-lg text-amber-500",children:""}),jsxRuntimeExports.jsxs("span",{className:"font-mono font-bold text-white",children:[w==="btc"?y:satsToBTC(parseInt(y))," BTC"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:"Fee"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"w-3.5 h-3.5 text-slate-400"}),jsxRuntimeExports.jsxs("span",{className:"font-mono text-slate-300",children:[O," sats"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-slate-800 pt-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-400 block mb-1",children:"To"}),jsxRuntimeExports.jsx("span",{className:"font-mono text-xs text-slate-300 break-all",children:p})]})]}),N&&jsxRuntimeExports.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4 flex-shrink-0"}),N]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>u("details"),className:"flex-1 py-3 px-4 bg-slate-800 hover:bg-slate-700 text-slate-300 font-medium rounded-xl transition-colors",children:"Back"}),jsxRuntimeExports.jsx("button",{onClick:L,className:"flex-1 py-3 px-4 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors",children:"Confirm Send"})]})]}),l==="broadcasting"&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-12 h-12 text-amber-500 animate-spin mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-slate-300 font-medium",children:"Broadcasting transaction..."})]}),l==="success"&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(Check,{className:"w-8 h-8 text-green-500"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Sent!"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-center",children:"Your transaction has been broadcast successfully."})]})]})]})}):null},TransactionDetailsModal=({isOpen:e,onClose:t,txid:r})=>{const[n,o]=reactExports.useState(!1);if(!e)return null;const a=()=>{navigator.clipboard.writeText(r),o(!0),setTimeout(()=>o(!1),2e3)},l=[{name:"Mempool.space",url:`https://mempool.space/tx/${r}`},{name:"Blockstream",url:`https://blockstream.info/tx/${r}`},{name:"Blockchain.com",url:`https://www.blockchain.com/explorer/transactions/btc/${r}`}];return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-800 w-full max-w-md overflow-hidden shadow-xl animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-800 flex items-center justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg text-white",children:"Transaction Details"}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Transaction ID"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-slate-950 rounded-lg p-3 border border-slate-800",children:[jsxRuntimeExports.jsx("code",{className:"text-sm text-slate-300 break-all font-mono flex-1",children:r}),jsxRuntimeExports.jsx("button",{onClick:a,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0",title:"Copy TXID",children:n?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4"})})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"View on Explorer"}),jsxRuntimeExports.jsx("div",{className:"grid gap-2",children:l.map(u=>jsxRuntimeExports.jsxs("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 bg-slate-800 hover:bg-slate-700 rounded-xl transition-colors group",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-slate-200",children:u.name}),jsxRuntimeExports.jsx(ExternalLink,{className:"w-4 h-4 text-slate-500 group-hover:text-white transition-colors"})]},u.name))})]})]})]})})},BitcoinWallet=()=>{const{currentKeypairId:e,wallets:t,currentWalletId:r}=useWalletStore(),[n,o]=reactExports.useState(""),[a,l]=reactExports.useState(0),[u,f]=reactExports.useState([]),[x,p]=reactExports.useState([]),[g,y]=reactExports.useState(!1),[b,w]=reactExports.useState(!1),[v,B]=reactExports.useState(!1),[j,F]=reactExports.useState(!1),[C,N]=reactExports.useState(null),_=t.find($=>$.id===r)?.keypairs.find($=>$.id===e),S=async()=>{if(n){y(!0);try{const[$,z]=await Promise.all([fetchUTXOs(n),fetchTxHistory(n)]);f($),p(z);const W=$.reduce((U,I)=>U+I.value,0);l(W),W>=1e6&&F(!0)}catch($){console.error("Error fetching Bitcoin data:",$)}finally{y(!1)}}};reactExports.useEffect(()=>{if(_)try{const $=npubToBitcoinAddress(_.npub);o($)}catch($){console.error("Error deriving Bitcoin address:",$)}},[_]),reactExports.useEffect(()=>{S()},[n]);const O=$=>{let z=0;return $.vin.forEach(W=>{W.prevout&&W.prevout.scriptpubkey_address===n&&(z-=W.prevout.value)}),$.vout.forEach(W=>{W.scriptpubkey_address===n&&(z+=W.value)}),{netChange:z,isReceive:z>0,absAmount:Math.abs(z)}};return _?jsxRuntimeExports.jsxs("div",{className:"pb-24",children:[jsxRuntimeExports.jsx("div",{className:"pb-4",children:jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-br from-amber-500/20 to-orange-600/20 border border-amber-500/20 rounded-2xl p-6 relative overflow-hidden",children:jsxRuntimeExports.jsxs("div",{className:"relative z-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("h2",{className:"text-slate-400 text-sm font-medium",children:"Total Balance"}),jsxRuntimeExports.jsx("button",{onClick:()=>F(!j),className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors",title:"Toggle display format",children:jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-4 h-4 text-slate-400"})})]}),j?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-3xl text-amber-500",children:""}),jsxRuntimeExports.jsx("span",{className:"text-4xl font-bold text-white",children:satsToBTC(a)}),jsxRuntimeExports.jsx("span",{className:"text-amber-500 font-bold",children:"BTC"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-sm mt-1",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"w-3.5 h-3.5"}),jsxRuntimeExports.jsxs("span",{children:[a.toLocaleString()," sats"]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-2",children:[jsxRuntimeExports.jsx(SatoshiIcon,{className:"text-3xl text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-4xl font-bold text-white",children:a.toLocaleString()}),jsxRuntimeExports.jsx("span",{className:"text-amber-500 font-bold",children:"sats"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-sm mt-1",children:[jsxRuntimeExports.jsx("span",{className:"text-base",children:""}),jsxRuntimeExports.jsxs("span",{children:[" ",satsToBTC(a)," BTC"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>w(!0),className:"flex-1 bg-slate-900/50 hover:bg-slate-900/70 text-white py-2 px-4 rounded-xl font-medium transition-colors flex items-center justify-center gap-2 border border-white/10",children:[jsxRuntimeExports.jsx(ArrowDownLeft,{className:"w-4 h-4 text-green-400"}),"Receive"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>B(!0),className:"flex-1 bg-amber-500 hover:bg-amber-600 text-slate-950 py-2 px-4 rounded-xl font-bold transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4"}),"Send"]})]})]})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"History"}),jsxRuntimeExports.jsx("button",{onClick:S,disabled:g,className:`p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors ${g?"animate-spin":""}`,children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:x.length===0?jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-slate-500",children:"No transactions found"}):x.map($=>{const{isReceive:z,absAmount:W}=O($);return jsxRuntimeExports.jsx("button",{onClick:()=>N($.txid),className:"w-full text-left bg-slate-900 border border-slate-800 rounded-xl p-4 hover:border-slate-700 transition-colors",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-full ${z?"bg-green-500/10 text-green-500":"bg-amber-500/10 text-amber-500"}`,children:z?jsxRuntimeExports.jsx(ArrowDownLeft,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-white",children:z?"Received":"Sent"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400",children:new Date(($.status.block_time||Date.now()/1e3)*1e3).toLocaleDateString()})]})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsxs("div",{className:`font-bold ${z?"text-green-500":"text-white"}`,children:[z?"+":"-",W.toLocaleString()," sats"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-end gap-1 text-xs text-slate-500",children:[jsxRuntimeExports.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${$.status.confirmed?"bg-green-500":"bg-amber-500"}`}),jsxRuntimeExports.jsx("span",{children:$.status.confirmed?"Confirmed":"Pending"})]})]})]})},$.txid)})})]}),jsxRuntimeExports.jsx(ReceiveModal,{isOpen:b,onClose:()=>w(!1),address:n}),jsxRuntimeExports.jsx(SendModal,{isOpen:v,onClose:()=>B(!1),utxos:u,onSuccess:S}),jsxRuntimeExports.jsx(TransactionDetailsModal,{isOpen:!!C,onClose:()=>N(null),txid:C||""})]}):jsxRuntimeExports.jsx("div",{className:"p-4 text-center text-slate-400",children:"No active keypair"})},About=({onBack:e,onNavigateChangelog:t})=>{const[r,n]=reactExports.useState(null),[o,a]=reactExports.useState(!1),[l,u]=reactExports.useState(""),[f,x]=reactExports.useState(!1),[p,g]=reactExports.useState(!1),[y,b]=reactExports.useState(!1),[w,v]=reactExports.useState(!1),[B,j]=reactExports.useState([]),{eventCreatorMode:F,toggleEventCreatorMode:C}=useSettingsStore(),[N,T]=reactExports.useState(0),[_,S]=reactExports.useState(0),[O,$]=reactExports.useState(()=>localStorage.getItem("dev-mode")==="true"),z="npub18n4ysp43ux5c98fs6h9c57qpr4p8r3j8f6e32v0vj8egzy878aqqyzzk9r",{currentKeypairId:W,wallets:U,currentWalletId:I}=useWalletStore(),k=U.find(H=>H.id===I)?.keypairs.find(H=>H.id===W);reactExports.useEffect(()=>{ProfileService.fetchProfile(z).then(n);try{const H=npubToBitcoinAddress(z);u(H)}catch{console.error("Failed to derive dev BTC address")}},[]),reactExports.useEffect(()=>{if(o&&k)try{const H=npubToBitcoinAddress(k.npub);fetchUTXOs(H).then(j)}catch(H){console.error(H)}},[o,k]);const M=(H,Q)=>{navigator.clipboard.writeText(H),Q(!0),setTimeout(()=>Q(!1),2e3)},q=(H,Q=8)=>H.length<=Q*2?H:`${H.slice(0,Q)}...${H.slice(-Q)}`,K=()=>{const H=Date.now();if(H-_>5e3){T(1),S(H);return}const D=N+1;if(T(D),S(H),D===5){const Y=!O;if($(Y),localStorage.setItem("dev-mode",Y.toString()),Y)__vitePreload(()=>import("./eruda-Tt1mvP7e.js").then(J=>J.e),[],import.meta.url).then(J=>{J.default.init(),console.log("[DevMode] Eruda console enabled")});else if(window.eruda){try{typeof window.eruda.destroy=="function"&&window.eruda.destroy()}catch(J){console.warn("[DevMode] Eruda destroy failed:",J)}setTimeout(()=>{const J=document.getElementById("eruda");J&&J.remove()},100),console.log("[DevMode] Eruda console disabled")}T(0)}};return reactExports.useEffect(()=>{O&&__vitePreload(()=>import("./eruda-Tt1mvP7e.js").then(H=>H.e),[],import.meta.url).then(H=>{H.default.init()})},[]),jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-md mx-auto space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-900 rounded-full transition-colors",children:jsxRuntimeExports.jsx(ArrowLeft,{className:"w-6 h-6 text-slate-400"})}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold",children:"About"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 mx-auto bg-slate-900 rounded-2xl flex items-center justify-center border border-slate-800 shadow-xl overflow-hidden",children:jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"PWANS Logo",className:"w-full h-full object-cover"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-amber-500",children:"PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Progressive Web App Nostr Signer"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800 text-center",children:[jsxRuntimeExports.jsxs("p",{className:"text-slate-300 mb-4",children:[jsxRuntimeExports.jsx("strong",{children:"PWANS"})," is a Progressive Web App Nostr Signer."]}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"It stores your nsec/keypair locally on your device and allows other Nostr applications to connect and sign events remotely via NIP-46. It also bridges Nostr to the real world with Bitcoin seamlessly"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 text-center",children:"Vibe Coded By"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-full bg-slate-800 overflow-hidden border-2 border-amber-500/20",children:r?.picture?jsxRuntimeExports.jsx("img",{src:r.picture,alt:"Dev",className:"w-full h-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-2xl font-bold",children:"?"})}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h4",{className:"font-bold text-lg text-white",children:r?.name||"Unknown Developer"}),r?.nip05&&jsxRuntimeExports.jsxs("div",{className:"text-amber-500 text-sm flex items-center justify-center gap-1",children:[jsxRuntimeExports.jsx("span",{children:r.nip05}),jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3 h-3"})]})]}),jsxRuntimeExports.jsxs("div",{className:"w-full space-y-3 mt-2",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-3 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 font-bold",children:"Nostr Public Key"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>b(!y),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(QrCode,{className:"w-3.5 h-3.5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>M(z,x),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:f?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-3.5 h-3.5"})})]})]}),y?jsxRuntimeExports.jsx("div",{className:"flex justify-center py-2 bg-white rounded-lg mb-2",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:z,size:150})}):jsxRuntimeExports.jsx("div",{className:"font-mono text-xs text-slate-300 text-center break-all",children:q(z,12)})]}),l&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-xl p-3 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-500 font-bold",children:"Bitcoin Address"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>v(!w),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(QrCode,{className:"w-3.5 h-3.5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>M(l,g),className:"p-1 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors",children:p?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-3.5 h-3.5 text-green-500"}):jsxRuntimeExports.jsx(Copy,{className:"w-3.5 h-3.5"})})]})]}),w?jsxRuntimeExports.jsx("div",{className:"flex justify-center py-2 bg-white rounded-lg mb-2",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:l,size:150})}):jsxRuntimeExports.jsx("div",{className:"font-mono text-xs text-amber-500/80 text-center break-all",children:q(l,12)})]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>a(!0),className:"w-full py-3 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white font-bold rounded-xl shadow-lg shadow-amber-500/20 transition-all flex items-center justify-center gap-2 mt-2",children:[jsxRuntimeExports.jsx(Heart,{className:"w-5 h-5 fill-white"}),"Tip Developer"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"text-center pb-8 space-y-3",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsxs("button",{onClick:()=>C(),className:"bg-slate-900 border border-slate-800 rounded-lg p-4 flex items-center gap-4 transition-colors hover:bg-slate-800",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Event Creator Mode"}),jsxRuntimeExports.jsx("div",{className:`relative w-14 h-7 rounded-md transition-all duration-300 ${F?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-slate-600 to-slate-700"}`,children:jsxRuntimeExports.jsx("div",{className:`absolute top-0.5 left-0.5 w-6 h-6 bg-white rounded-md shadow-lg transition-all duration-300 flex items-center justify-center ${F?"translate-x-7":"translate-x-0"}`,children:F?jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]})}),jsxRuntimeExports.jsxs("p",{className:"text-slate-500 text-xs max-w-xs mx-auto leading-relaxed",children:[jsxRuntimeExports.jsx("strong",{children:"Disclaimer:"})," PWANS and its creator(s) hold no responsibility for any lost or compromised accounts or funds. The user holds full responsibility for how they use this PWA."]}),jsxRuntimeExports.jsxs("p",{className:"text-slate-600 text-xs font-mono cursor-pointer select-none",onClick:K,children:["v1.0.1 ",O&&""]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"text-amber-500 text-xs hover:text-amber-400 transition-colors underline",children:"Changelog"})]})]}),o&&jsxRuntimeExports.jsx(SendModal,{isOpen:o,onClose:()=>a(!1),utxos:B,onSuccess:()=>a(!1),initialRecipient:l})]})},Changelog=({onBack:e})=>jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center gap-4 mb-8 border-b border-slate-800 pb-4",children:[jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(ArrowLeft,{className:"w-6 h-6"})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-amber-500",children:"Changelog"})]}),jsxRuntimeExports.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-amber-500",children:"v1.0.1"}),jsxRuntimeExports.jsxs("div",{className:"relative flex items-center justify-center",children:[jsxRuntimeExports.jsx("div",{className:"absolute w-3 h-3 bg-green-500 rounded-full animate-ping opacity-75"}),jsxRuntimeExports.jsx("div",{className:"relative w-2 h-2 bg-green-500 rounded-full"})]}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-400",children:"Latest"})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-xs mb-4",children:"07 December 2025"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-3 text-slate-300",children:[jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Unified Connection UI:"}),' Merged "Connect App" and "Bunker" views into a single, streamlined interface for easier access']})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Event Creator Mode:"})," Create, sign, and broadcast arbitrary events directly (enable in About page)"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Offline Cold Signing:"}),' "Sign & Show QR" flow allows fully air-gapped signing. Import/Export events via file or Animated QRs to turn any device into a cold storage signer']})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"UX Polish:"})," Improved Npub truncation, copy buttons, and general UI refinements"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Connectivity Health Check:"}),' Improved detection of network changes and relay connection status to prevent stale "online" states']})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Manual Reconnect:"})," Added a refresh button on the dashboard to force valid connection checks and clear stale sockets"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Friendly Signing UI:"}),' Redesigned the signing request modal with a "Simple View" that uses human-readable descriptions and a toggle for technical details']})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Update Notifications:"})," Implemented new version detection with a reload prompt to easily update to the latest version"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Developer Mode:"})," Added developer mode to view detailed logs - enable by tapping the version number 5 times on the About page"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Auto-Approval Rules:"})," Added option to keep auto-approval rules when replacing an existing connection from the same client"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Relay Improvements:"})," Enhanced custom relay management and improved WebSocket connectivity for better reliability"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-1",children:""}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"Bunker QR Code:"})," Added support for generating QR codes for your bunker connection string to easily connect other apps"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsx("p",{className:"text-slate-300 text-center mb-4",children:"Appreciate this release? Want to help feed the dev(s) behind it?"}),jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsxs("button",{onClick:e,className:"bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold py-3 px-6 rounded-lg transition-colors flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:""}),"Support"]})}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-xs text-center mt-3",children:"Send a tip on the About page"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-slate-400",children:"v1.0.0"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-500",children:"Initial Release"})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-xs mb-4",children:"06 December 2025"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-3 text-slate-400",children:[jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-600 mt-1",children:""}),jsxRuntimeExports.jsx("span",{children:"Initial PWA release with NIP-46 remote signing support"})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-600 mt-1",children:""}),jsxRuntimeExports.jsx("span",{children:"Multi-wallet and multi-keypair management"})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-600 mt-1",children:""}),jsxRuntimeExports.jsx("span",{children:"Connection management with auto-approval rules"})]}),jsxRuntimeExports.jsxs("li",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-600 mt-1",children:""}),jsxRuntimeExports.jsx("span",{children:"Custom relay support"})]})]})]})]})]}),ActivityLog=({onClose:e})=>{const{entries:t,clearLog:r}=useActivityLogStore(),[n,o]=reactExports.useState(new Set),[a,l]=reactExports.useState(!1),u=g=>{o(y=>{const b=new Set(y);return b.has(g)?b.delete(g):b.add(g),b})},f=()=>{r(),l(!1)},x=g=>({approved:"bg-green-500/10 text-green-400 border-green-500/20",rejected:"bg-red-500/10 text-red-400 border-red-500/20",published:"bg-blue-500/10 text-blue-400 border-blue-500/20",error:"bg-orange-500/10 text-orange-400 border-orange-500/20"})[g],p=g=>new Date(g).toLocaleString();return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl max-w-3xl w-full max-h-[80vh] border border-slate-800 shadow-2xl flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6 border-b border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(FileText,{className:"w-5 h-5 text-amber-500"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Activity Log"})]}),jsxRuntimeExports.jsx("button",{onClick:e,className:"text-slate-400 hover:text-white transition-colors","aria-label":"Close",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsx("div",{className:"px-4 sm:px-6 pt-4 pb-2",children:jsxRuntimeExports.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3 text-sm text-blue-300",children:[jsxRuntimeExports.jsx("strong",{children:"Privacy:"})," Activity logs are stored locally on your device only. They include full event details for debugging purposes."]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-3",children:t.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12",children:[jsxRuntimeExports.jsx(FileText,{className:"w-12 h-12 text-slate-700 mx-auto mb-3"}),jsxRuntimeExports.jsx("p",{className:"text-slate-500",children:"No activity yet"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Events will appear here as you use the signer"})]}):t.map(g=>{const y=n.has(g.id);return jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg border border-slate-800",children:[jsxRuntimeExports.jsx("div",{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase border ${x(g.action)}`,children:g.action}),jsxRuntimeExports.jsx("span",{className:"text-sm font-mono text-white",children:g.method})]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-slate-500",children:[g.appName||"Unknown App","  ",g.appPubkey.slice(0,8),"...",g.appPubkey.slice(-8)]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-600 mt-1",children:p(g.timestamp)}),g.error&&jsxRuntimeExports.jsxs("div",{className:"text-xs text-red-400 mt-2 font-mono",children:["Error: ",g.error]})]}),g.event&&jsxRuntimeExports.jsx("button",{onClick:()=>u(g.id),className:"p-1.5 hover:bg-slate-800 rounded text-slate-400 hover:text-white transition-colors flex-shrink-0",title:y?"Collapse":"Expand",children:y?jsxRuntimeExports.jsx(ChevronDown,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4"})})]})}),y&&g.event&&jsxRuntimeExports.jsxs("div",{className:"border-t border-slate-800 p-4 bg-slate-900/50",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400 mb-2 font-bold uppercase tracking-wider",children:"Event Data"}),jsxRuntimeExports.jsx("pre",{className:"text-xs text-slate-300 font-mono overflow-x-auto bg-slate-950 p-3 rounded border border-slate-800",children:JSON.stringify(g.event,null,2)})]})]},g.id)})}),t.length>0&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6 border-t border-slate-800 bg-slate-950/50",children:[jsxRuntimeExports.jsxs("div",{className:"text-sm text-slate-400",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:t.length})," ",t.length===1?"entry":"entries"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>l(!0),className:"px-3 py-1.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-3.5 h-3.5"}),"Clear Log"]})]}),a&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center rounded-xl",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 max-w-sm mx-4 border border-slate-700",children:[jsxRuntimeExports.jsx("h4",{className:"text-lg font-bold text-white mb-2",children:"Clear Activity Log?"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-slate-400 mb-4",children:["This will permanently delete all ",t.length," log entries. This cannot be undone."]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>l(!1),className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:f,className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors",children:"Clear Log"})]})]})})]})})},ConnectedAppsList=()=>{const{connections:e,removeConnection:t,getRulesForConnection:r,removeRule:n}=useConnectionsStore(),{currentKeypairId:o}=useWalletStore(),[a,l]=reactExports.useState(null),[u,f]=reactExports.useState(!1),x=e.filter(y=>y.keypairId===o),p=y=>{t(y)},g=y=>{switch(y){case"connected":return jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4 text-green-400"});case"connecting":return jsxRuntimeExports.jsx(Loader,{className:"w-4 h-4 text-yellow-400 animate-spin"});case"error":case"disconnected":return jsxRuntimeExports.jsx(CircleX,{className:"w-4 h-4 text-red-400"});default:return null}};return x.length===0?null:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white",children:"Active Connections"}),jsxRuntimeExports.jsx("button",{onClick:()=>f(!0),className:"p-2 hover:bg-slate-800 rounded-lg text-slate-400 hover:text-white transition-colors",title:"Activity Log",children:jsxRuntimeExports.jsx(FileText,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:x.map(y=>jsxRuntimeExports.jsxs("div",{className:"bg-slate-950 rounded-lg p-4 border border-slate-800 flex items-center justify-between group",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"font-bold text-white flex items-center gap-2",children:[y.name||"Unknown App",g(y.status)]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-slate-500 font-mono flex items-center gap-1",children:[y.signerPubkey.slice(0,8),"...",y.signerPubkey.slice(-8),y.startedVia==="nostrconnect"&&jsxRuntimeExports.jsx("span",{className:"bg-blue-500/10 text-blue-400 px-1.5 rounded text-[10px]",children:"CLIENT"}),y.startedVia==="bunker"&&jsxRuntimeExports.jsx("span",{className:"bg-purple-500/10 text-purple-400 px-1.5 rounded text-[10px]",children:"BUNKER"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>l(y.id),className:"p-2 hover:bg-slate-800 rounded-md text-slate-400 hover:text-white transition-colors",title:"Settings",children:jsxRuntimeExports.jsx(Settings,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:()=>p(y.id),className:"p-2 hover:bg-red-500/20 rounded-md text-slate-400 hover:text-red-400 transition-colors",title:"Disconnect",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"})})]})]},y.id))})]}),a&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Connection Settings"}),jsxRuntimeExports.jsx("button",{onClick:()=>l(null),className:"text-slate-400 hover:text-white",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Auto-Approval Rules"}),r(a).length===0?jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 italic",children:"No active rules"}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:r(a).map(y=>jsxRuntimeExports.jsxs("div",{className:"bg-slate-800 rounded-lg p-3 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-bold text-white",children:y.kinds.map(b=>b===-4?"Auto-Approve NIP-04 Decryption":b===-5?"Auto-Approve NIP-04 Encryption":`Auto-Approve Kind ${b}`).join(", ")}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-slate-500",children:["Created ",new Date(y.createdAt).toLocaleDateString()]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>n(y.id),className:"p-1.5 hover:bg-red-500/20 rounded text-red-400 hover:text-red-300 transition-colors",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3"})})]},y.id))})]}),jsxRuntimeExports.jsx("div",{className:"pt-4 border-t border-slate-800",children:jsxRuntimeExports.jsxs("button",{onClick:()=>{p(a),l(null)},className:"w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4"}),"Disconnect App"]})})]})]})}),u&&jsxRuntimeExports.jsx(ActivityLog,{onClose:()=>f(!1)})]})},useClientConnections=(e,t)=>{const[r,n]=reactExports.useState(new Map),o=useConnectionsStore(f=>f.connections),a=reactExports.useRef(new Map),l=reactExports.useRef(new Set),u=reactExports.useRef(new Map);return reactExports.useEffect(()=>{if(!e||!t)return;(async()=>{const x=new Map(a.current);let p=!1;const g=o.filter(y=>y.keypairId===e.id);console.log(`[useClientConnections] Found ${g.length} connections for current keypair:`,g.map(y=>({id:y.id,name:y.name,signerPubkey:y.signerPubkey.slice(0,8),status:y.status})));for(const y of g){const b=u.current.get(y.id)||0;if(!x.has(y.id)&&!l.current.has(y.id)&&y.status!=="disconnected"&&b<3){l.current.add(y.id);try{console.log(`[useClientConnections] Initializing client for: ${y.name} (Attempt ${b+1}/3)`);const w=new ClientService(t,y.id,{signerPubkey:y.signerPubkey,relays:y.relays,secret:y.secret,name:y.name,appUrl:y.appUrl,startedVia:y.startedVia});await w.connect(),useConnectionsStore.getState().connections.find(B=>B.id===y.id)?(x.set(y.id,w),p=!0,u.current.delete(y.id)):w.disconnect()}catch(w){console.error("Failed to init client:",w),u.current.set(y.id,b+1)}finally{l.current.delete(y.id)}}}for(const[y]of x.entries())o.find(b=>b.id===y)||(console.log("[useClientConnections] Removing client for:",y),x.get(y)?.disconnect(),x.delete(y),p=!0,u.current.delete(y));p&&(a.current=x,n(new Map(x)))})()},[o,e,t]),{clients:r}},useRelayMonitor=e=>{const{relays:t,updateRelayStatus:r,incrementFailedAttempts:n}=useRelayStore(),o=reactExports.useRef(null),a=reactExports.useRef(Date.now());reactExports.useEffect(()=>{if(!e)return;const l=async(p=!1,g=!1)=>{const y=t.filter(b=>b.status==="disconnected"||b.status==="error");if(y.length>0&&(console.log("[RelayMonitor] Attempting to reconnect",y.length,"relays"),y.forEach(b=>{if(!(b.failedAttempts>=10)){r(b.url,"connecting");try{e.ndk?.pool?.relays?.get(b.url)?.connect()}catch{r(b.url,"error"),n(b.url)}}})),e.hasActiveSubscription&&e.isSubscriptionHealthy){const b=e.hasActiveSubscription(),w=e.isSubscriptionHealthy();if(!b)console.warn("[RelayMonitor]  No active subscription! Reconnecting..."),await e.reconnectSubscription();else if(!w||p||g){let v=!1;if(g)console.log("[RelayMonitor] Network recovery detected - TRIGGERING FORCE RECONNECT."),v=!0;else if(p){const B=Date.now()-a.current;B<6e4?(console.log(`[RelayMonitor] App backgrounded for ${Math.round(B/1e3)}s - skipping FORCE reconnect.`),v=!1):(console.log(`[RelayMonitor] App backgrounded for ${Math.round(B/1e3)}s - TRIGGERING FORCE RECONNECT.`),v=!0)}else v=!1;(!w||v)&&(console.warn(`[RelayMonitor]  ${g?"Network Recovery":v?"Deep Sleep Wakeup":"Subscription unhealthy"}. Reconnecting... (Force: ${v})`),await e.reconnectSubscription(v))}}a.current=Date.now()};o.current=setInterval(()=>l(!1),1e4);const u=()=>{document.visibilityState==="visible"?(console.log("[RelayMonitor] App became visible..."),l(!0)):a.current=Date.now()};document.addEventListener("visibilitychange",u);const f=()=>{console.log("[RelayMonitor] Network online - triggering health check..."),l(!0,!0)},x=()=>{console.warn("[RelayMonitor] Network offline - pausing active checks (logs will be silent)")};return window.addEventListener("online",f),window.addEventListener("offline",x),()=>{o.current&&clearInterval(o.current),document.removeEventListener("visibilitychange",u),window.removeEventListener("online",f),window.removeEventListener("offline",x)}},[e,t,r,n])},Dashboard=()=>{const{logout:e,decryptedKey:t}=useAuthStore(),{currentWalletId:r,wallets:n,currentKeypairId:o}=useWalletStore(),{requests:a}=useRequestStore(),[l,u]=reactExports.useState(""),[f,x]=reactExports.useState(!1),[p,g]=reactExports.useState(!1),[y,b]=reactExports.useState(navigator.onLine);reactExports.useEffect(()=>{const Q=()=>b(!0),D=()=>b(!1);return window.addEventListener("online",Q),window.addEventListener("offline",D),()=>{window.removeEventListener("online",Q),window.removeEventListener("offline",D)}},[]);const[w,v]=reactExports.useState("connections"),[B,j]=reactExports.useState(!1),[F,C]=reactExports.useState(!1),[N,T]=reactExports.useState(!1),[_,S]=reactExports.useState(!1),O=reactExports.useRef(null),{isOnline:$,relays:z}=useRelayStore(),W=n.find(Q=>Q.id===r),U=W?.keypairs.find(Q=>Q.id===o),I=a.find(Q=>Q.source==="client")||a[0];useRelayMonitor(O.current),reactExports.useEffect(()=>{if(U)try{const{data:Q}=nip19_exports$1.decode(U.npub);u(`bunker://${Q}?relay=wss://relay.primal.net&relay=wss://relay.damus.io&relay=wss://nos.lol&relay=wss://relay.nostr.band`)}catch(Q){console.error("Invalid npub:",Q)}},[U]),reactExports.useEffect(()=>{if(t&&!O.current){console.log("[Dashboard] Creating new SignerService instance");const Q=new SignerService(t);O.current=Q,Q.connect().catch(console.error);const D=Y=>{const{url:J}=Y.detail;console.log("[Dashboard] Received add-relay event for:",J),Q.addRelay(J)};return window.addEventListener("add-relay",D),()=>{console.log("[Dashboard] Cleaning up SignerService instance"),Q.disconnect(),O.current=null,window.removeEventListener("add-relay",D)}}else!t&&O.current&&(console.log("[Dashboard] Disconnecting SignerService due to no decryptedKey"),O.current.disconnect(),O.current=null,u(""))},[t]),reactExports.useEffect(()=>{window.history.pushState({dashboard:"root"},"");const Q=D=>{if(I){H(I.id,I.requestEventId,I.requestorPubkey),window.history.pushState({dashboard:"root"},"");return}if(N){T(!1),window.history.pushState({dashboard:"root"},"");return}if(F){C(!1),window.history.pushState({dashboard:"root"},"");return}if(B){j(!1),window.history.pushState({dashboard:"root"},"");return}if(w!=="connections"){v("connections"),window.history.pushState({dashboard:"root"},"");return}D.preventDefault(),window.history.pushState({dashboard:"root"},"")};return window.addEventListener("popstate",Q),()=>window.removeEventListener("popstate",Q)},[w,B,N,F,I]);const G=()=>{navigator.clipboard.writeText(l),g(!0),setTimeout(()=>g(!1),2e3)},k=(Q,D)=>{window.history.pushState({view:Q},""),D(!0)},M=()=>{window.history.pushState({view:"wallet"},""),v("wallet")},{clients:q}=useClientConnections(U,t),K=async(Q,D,Y,J,L,Z=!1)=>{console.log("[Dashboard] handleApprove called with remember:",Z);const oe=useRequestStore.getState().requests.find(ce=>ce.id===Q);if(oe?.internal){console.log("[Dashboard] Processing INTERNAL request:",Q);try{if(J==="sign_event"&&O.current){const ce=await O.current.signEventInternal(L[0]);oe.onSuccess&&oe.onSuccess(ce)}}catch(ce){console.error("[Dashboard] Internal signing failed:",ce),oe.onError&&oe.onError(ce)}useRequestStore.getState().removeRequest(Q);return}if(Z){if(J==="sign_event")try{const ce=L[0],xe=JSON.parse(ce).kind;console.log("[Dashboard] Attempting to save auto-approval rule for kind:",xe),console.log("[Dashboard] Requestor pubkey:",Y);let te;if(I?.connectionId&&(te=useConnectionsStore.getState().connections.find(ae=>ae.id===I.connectionId)),te||(te=useConnectionsStore.getState().connections.find(ae=>ae.signerPubkey===Y)),te){console.log("[Dashboard] Found connection:",te.id,te.name);const{addRule:ae}=useConnectionsStore.getState(),le={id:Math.random().toString(36).substring(7),connectionId:te.id,kinds:[xe],createdAt:Date.now()};console.log("[Dashboard] Calling addRule with:",le),ae(le),console.log(`[Dashboard]  Rule saved for kind ${xe}`)}else console.error("[Dashboard]  Connection not found for requestor:",Y)}catch(ce){console.error("[Dashboard] Failed to save auto-approval rule:",ce)}else if(J==="nip04_decrypt"||J==="nip04_encrypt")try{console.log(`[Dashboard] Attempting to save auto-approval rule for ${J}`),console.log("[Dashboard] Requestor pubkey:",Y);let ce;if(I?.connectionId&&(ce=useConnectionsStore.getState().connections.find(de=>de.id===I.connectionId)),ce||(ce=useConnectionsStore.getState().connections.find(de=>de.signerPubkey===Y)),ce){console.log("[Dashboard] Found connection:",ce.id,ce.name);const{addRule:de}=useConnectionsStore.getState(),xe=J==="nip04_decrypt"?-4:-5,te={id:Math.random().toString(36).substring(7),connectionId:ce.id,kinds:[xe],createdAt:Date.now()};console.log("[Dashboard] Calling addRule with:",te),de(te),console.log(`[Dashboard]  Rule saved for ${J}`);const ae=useRequestStore.getState().requests;console.log("[Dashboard] Checking pending requests for auto-approval:",ae.length);const le=ae.filter(ue=>ue.id!==Q&&ue.method===J&&(ue.connectionId===ce.id||ue.requestorPubkey===Y));le.length>0&&(console.log(`[Dashboard] Found ${le.length} pending requests to auto-approve`),setTimeout(async()=>{for(const ue of le)if(console.log(`[Dashboard] Auto-approving pending request: ${ue.id}`),ue.connectionId){const be=q.get(ue.connectionId);be&&await be.approveRequest(ue.id,ue.requestEventId,ue.requestorPubkey,ue.method,ue.params)}else O.current?.approveRequest(ue.id,ue.requestEventId,ue.requestorPubkey,ue.method,ue.params),useRequestStore.getState().removeRequest(ue.id)},100))}else console.error("[Dashboard]  Connection not found for requestor:",Y)}catch(ce){console.error("[Dashboard] Failed to save auto-approval rule:",ce)}}if(J==="connect")try{const ce=useConnectionsStore.getState();ce.connections.find(xe=>xe.signerPubkey===Y)||(console.log("[Dashboard] Saving new connection from connect request"),ce.addConnection({id:Math.random().toString(36).substring(7),keypairId:o,signerPubkey:Y,name:"App "+Y.slice(0,4),relays:["wss://relay.primal.net","wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io"],secret:L[1]||"",status:"connected",startedVia:"bunker",connectedAt:Date.now()}))}catch(ce){console.error("[Dashboard] Failed to save connection:",ce)}if(I?.connectionId){const ce=q.get(I.connectionId);if(ce){console.log("[Dashboard] Approving via ClientService for connection:",I.connectionId),ce.approveRequest(Q,D,Y,J,L,I.encryptionMethod);return}else console.warn("[ClientService] ClientService not found for connection:",I.connectionId)}console.log("[Dashboard] Approving via SignerService"),O.current?.approveRequest(Q,D,Y,J,L),useRequestStore.getState().removeRequest(Q)},H=(Q,D,Y)=>{if(I?.connectionId){const J=q.get(I.connectionId);if(J){console.log("[Dashboard] Rejecting via ClientService for connection:",I.connectionId),J.rejectRequest(Q,D,Y);return}}O.current?.rejectRequest(Q,D,Y),useRequestStore.getState().removeRequest(Q)};return reactExports.useEffect(()=>{if(!I)return;const{method:Q,params:D,connectionId:Y,requestorPubkey:J,id:L}=I;if(Q!=="nip04_decrypt"&&Q!=="nip04_encrypt"&&Q!=="sign_event"&&Q!=="get_public_key")return;const Z=useConnectionsStore.getState();let oe;if(Y?oe=Z.connections.find(ce=>ce.id===Y):oe=Z.connections.find(ce=>ce.signerPubkey===J),oe){const ce=Z.getRulesForConnection(oe.id);let de;if(Q==="sign_event")try{de=JSON.parse(D[0]).kind}catch{return}else if(Q==="nip04_decrypt")de=-4;else if(Q==="nip04_encrypt")de=-5;else if(Q==="get_public_key"){console.log(`[Dashboard]  Safety Net: Auto-approving get_public_key request ${L} for known connection`),K(L,I.requestEventId,J,Q,D,!1);return}de!==void 0&&ce.find(te=>te.kinds.includes(de))&&(console.log(`[Dashboard]  Safety Net: Auto-approving ${Q} request ${L} due to existing rule`),K(L,I.requestEventId,J,Q,D,!1))}},[I]),B?jsxRuntimeExports.jsx(WalletManager,{onBack:()=>j(!1)}):w==="about"?jsxRuntimeExports.jsx(About,{onBack:()=>v("connections"),onNavigateChangelog:()=>v("changelog")}):w==="changelog"?jsxRuntimeExports.jsx(Changelog,{onBack:()=>v("about")}):jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-950 text-white p-4",children:[jsxRuntimeExports.jsx(NotificationBanner,{}),jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center mb-8 border-b border-slate-800 pb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{window.history.pushState({view:"about"},""),v("about")},className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[jsxRuntimeExports.jsx("img",{src:"./pwa-192x192.png",alt:"Logo",className:"w-8 h-8 rounded-lg"}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold text-amber-500",children:"PWANS"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>k("relay-manager",T),className:`flex items-center gap-1 text-xs px-2 py-1 rounded-full transition-colors cursor-pointer hover:opacity-80 ${$()&&y?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,title:`${z.filter(Q=>Q.status==="connected").length}/${z.length} relays connected - Click to manage`,children:[$()&&y?jsxRuntimeExports.jsx(Wifi,{className:"w-3 h-3"}):jsxRuntimeExports.jsx(WifiOff,{className:"w-3 h-3"}),$()&&y?"Online":"Offline"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[W&&jsxRuntimeExports.jsxs("button",{onClick:()=>k("wallet-manager",j),className:"flex items-center gap-2 px-3 py-2 bg-slate-900 hover:bg-slate-800 rounded-lg transition-colors border border-slate-800",children:[jsxRuntimeExports.jsx(Notebook,{className:"w-4 h-4 text-amber-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:W.name})]}),jsxRuntimeExports.jsx("button",{onClick:async()=>{if(O.current&&!_){S(!0);try{await O.current.reconnectSubscription(!0),console.log("Manually reconnected")}catch(Q){console.error("Manual reconnect failed",Q)}finally{S(!1)}}},className:"p-2 hover:bg-slate-900 rounded-lg transition-colors text-slate-400 hover:text-white",title:"Force Reconnect",disabled:_,children:jsxRuntimeExports.jsx(RefreshCw,{className:`w-5 h-5 ${_?"animate-spin text-amber-500":""}`})}),jsxRuntimeExports.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-900 rounded-lg transition-colors",title:"Lock Wallet",children:jsxRuntimeExports.jsx(LogOut,{className:"w-5 h-5 text-slate-400"})})]})]}),jsxRuntimeExports.jsxs("main",{className:"max-w-2xl mx-auto space-y-6 pb-24",children:[U&&jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-xl p-4 border border-slate-800 flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative rounded-lg bg-amber-500 text-slate-950 flex-shrink-0 overflow-hidden cursor-pointer group w-10 h-10",onClick:async Q=>{if(Q.stopPropagation(),!U||!W)return;const D=Q.currentTarget;D.classList.add("opacity-50");try{const{ProfileService:Y}=await __vitePreload(async()=>{const{ProfileService:Z}=await Promise.resolve().then(()=>profile);return{ProfileService:Z}},void 0,import.meta.url),{updateKeypair:J}=useWalletStore.getState(),L=await Y.fetchProfile(U.npub);L&&J(W.id,U.id,{profile:{...L,lastFetched:Date.now()}})}catch(Y){console.error("[Dashboard] Failed to refresh profile:",Y)}finally{D.classList.remove("opacity-50")}},title:"Click to refresh profile",children:[U.profile?.picture?jsxRuntimeExports.jsx("img",{src:U.profile.picture,alt:U.profile.name||"Profile",className:"w-full h-full object-cover",onError:Q=>{Q.currentTarget.style.display="none",Q.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx("div",{className:`w-full h-full flex items-center justify-center bg-amber-500 ${U.profile?.picture?"hidden":""}`,children:jsxRuntimeExports.jsx(User,{className:"w-6 h-6 text-slate-950"})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 text-white"})})]}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg truncate",children:U.profile?.name||U.name}),jsxRuntimeExports.jsx("button",{onClick:()=>k("keypair-switcher",C),className:"p-1 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Switch Address",children:jsxRuntimeExports.jsx(ArrowRightLeft,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-500 text-xs rounded-full flex-shrink-0",children:"Active"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400 font-mono truncate",children:U.npub.length>16?`${U.npub.slice(0,8)}...${U.npub.slice(-6)}`:U.npub})]})]}),F&&W&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:()=>C(!1),children:jsxRuntimeExports.jsxs("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",onClick:Q=>Q.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-white",children:"Switch Address"}),jsxRuntimeExports.jsx("button",{onClick:()=>C(!1),className:"p-1 hover:bg-slate-800 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-slate-400"})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:W.keypairs.map(Q=>jsxRuntimeExports.jsxs("button",{onClick:async()=>{const{password:D}=useAuthStore.getState();if(!D){console.error("[Dashboard] No cached password for keypair switch");return}try{const{CryptoService:Y}=await __vitePreload(async()=>{const{CryptoService:Z}=await Promise.resolve().then(()=>crypto$3);return{CryptoService:Z}},void 0,import.meta.url),J=await Y.decrypt(Q.encryptedNsec,D),L=Y.nsecToHex(J);useWalletStore.getState().setCurrentKeypair(Q.id),useAuthStore.getState().unlock(L,D),C(!1)}catch(Y){console.error("[Dashboard] Failed to switch keypair:",Y)}},className:`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${o===Q.id?"bg-amber-500/10 border-amber-500/50":"bg-slate-950 border-slate-800 hover:border-slate-700 hover:bg-slate-900"}`,children:[jsxRuntimeExports.jsxs("div",{className:`p-1 rounded-lg flex-shrink-0 ${o===Q.id?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:[Q.profile?.picture?jsxRuntimeExports.jsx("img",{src:Q.profile.picture,alt:Q.profile.name||"Profile",className:"w-8 h-8 rounded-lg object-cover",onError:D=>{D.currentTarget.style.display="none",D.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,jsxRuntimeExports.jsx(User,{className:`w-8 h-8 ${Q.profile?.picture?"hidden":""}`})]}),jsxRuntimeExports.jsxs("div",{className:"text-left flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"font-bold text-white truncate",children:Q.profile?.name||Q.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-slate-400 font-mono truncate",children:Q.npub})]}),o===Q.id&&jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5 text-amber-500"})]},Q.id))})]})}),w==="connections"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[useSettingsStore.getState().eventCreatorMode&&jsxRuntimeExports.jsx(EventCreator,{}),jsxRuntimeExports.jsx("div",{className:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden p-6",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Bunker URI"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Copy this bunker string to the nostr client you want to connect to"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:"text",readOnly:!0,value:l,className:"w-full bg-slate-950 border border-slate-800 rounded-lg pl-4 pr-20 py-3 text-sm text-slate-300 font-mono focus:outline-none"}),jsxRuntimeExports.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:()=>x(!f),className:`p-2 rounded-md transition-colors ${f?"bg-amber-500/20 text-amber-500":"hover:bg-slate-800 text-slate-400"}`,title:"Show QR Code",children:jsxRuntimeExports.jsx(QrCode,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:G,className:"p-2 hover:bg-slate-800 rounded-md transition-colors",title:"Copy URI",children:p?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4 text-green-400"}):jsxRuntimeExports.jsx(Copy,{className:"w-4 h-4 text-slate-400"})})]})]}),f&&jsxRuntimeExports.jsx("div",{className:"mt-4 flex justify-center p-4 bg-white rounded-xl",children:jsxRuntimeExports.jsx(QRCodeSVG,{value:l,size:256})})]}),jsxRuntimeExports.jsx("hr",{className:"border-slate-800"}),jsxRuntimeExports.jsx(ConnectSigner,{})]})}),jsxRuntimeExports.jsx(ConnectedAppsList,{})]}),w==="wallet"&&jsxRuntimeExports.jsx(BitcoinWallet,{})]}),jsxRuntimeExports.jsx(BottomNav,{currentView:w,onChange:Q=>{Q==="wallet"?M():v("connections")}}),I&&jsxRuntimeExports.jsx(RequestModal,{request:I,onApprove:Q=>K(I.id,I.requestEventId,I.requestorPubkey,I.method,I.params,Q),onReject:()=>H(I.id,I.requestEventId,I.requestorPubkey)}),N&&jsxRuntimeExports.jsx(RelayManager,{onClose:()=>T(!1)})]})},DisclaimerModal=({onAgree:e})=>jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-[100]",children:jsxRuntimeExports.jsx("div",{className:"bg-slate-900 rounded-2xl p-6 max-w-md w-full border border-slate-800 shadow-2xl",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center text-center space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-amber-500/10 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(TriangleAlert,{className:"w-8 h-8 text-amber-500"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to PWANS"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400",children:"Please read this important disclaimer before continuing."})]}),jsxRuntimeExports.jsx("div",{className:"bg-slate-950 rounded-xl p-4 border border-slate-800 text-left",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm leading-relaxed",children:["PWANS and its creator(s) hold ",jsxRuntimeExports.jsx("strong",{children:"no responsibility"})," for any lost or compromised accounts or funds.",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),"This is a self-custodial application. ",jsxRuntimeExports.jsx("strong",{children:"You"})," hold full responsibility for how you use this PWA and for securing your own keys."]})}),jsxRuntimeExports.jsxs("button",{onClick:e,className:"w-full py-3 bg-amber-500 hover:bg-amber-600 text-slate-950 font-bold rounded-xl transition-colors flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5"}),"I Understand and Agree"]})]})})});function registerSW(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:o,onRegisteredSW:a,onRegisterError:l}=e;let u,f,x;const p=async(y=!0)=>{await f,x?.()};async function g(){if("serviceWorker"in navigator){if(u=await __vitePreload(async()=>{const{Workbox:y}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:y}},[],import.meta.url).then(({Workbox:y})=>new y("./sw-notification-handler.js",{scope:"./",type:"classic"})).catch(y=>{l?.(y)}),!u)return;x=()=>{u?.messageSkipWaiting()};{let y=!1;const b=()=>{y=!0,u?.addEventListener("controlling",w=>{w.isUpdate&&window.location.reload()}),r?.()};u.addEventListener("installed",w=>{typeof w.isUpdate>"u"?typeof w.isExternal<"u"&&w.isExternal?b():!y&&n?.():w.isUpdate||n?.()}),u.addEventListener("waiting",b)}u.register({immediate:t}).then(y=>{a?a("./sw-notification-handler.js",y):o?.(y)}).catch(y=>{l?.(y)})}}return f=g(),p}function useRegisterSW(e={}){const{immediate:t=!0,onNeedRefresh:r,onOfflineReady:n,onRegistered:o,onRegisteredSW:a,onRegisterError:l}=e,[u,f]=reactExports.useState(!1),[x,p]=reactExports.useState(!1),[g]=reactExports.useState(()=>registerSW({immediate:t,onOfflineReady(){p(!0),n?.()},onNeedRefresh(){f(!0),r?.()},onRegistered:o,onRegisteredSW:a,onRegisterError:l}));return{needRefresh:[u,f],offlineReady:[x,p],updateServiceWorker:g}}const UpdatePrompt=()=>{const[e,t]=reactExports.useState(!1),[r,n]=reactExports.useState(!1),{needRefresh:[o,a],updateServiceWorker:l}=useRegisterSW({onRegistered(x){console.log("[PWA] Service Worker registered:",x)},onRegisterError(x){console.error("[PWA] Service Worker registration error:",x)}});reactExports.useEffect(()=>{o&&t(!0)},[o]);const u=async()=>{n(!0),t(!1),a(!1);try{if(l&&await l(!0),"serviceWorker"in navigator){const x=await navigator.serviceWorker.getRegistrations();for(const p of x)await p.unregister()}if("caches"in window){const x=await caches.keys();await Promise.all(x.map(p=>caches.delete(p)))}window.location.reload()}catch(x){console.error("[PWA] Update failed:",x),t(!0),n(!1)}},f=()=>{t(!1),a(!1)};return e?jsxRuntimeExports.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-md z-50 animate-slide-up",children:jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-amber-500 to-amber-600 rounded-xl shadow-2xl border border-amber-400/20 p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 mt-0.5",children:jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(RefreshCw,{className:"w-5 h-5 text-white"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("h3",{className:"text-white font-bold text-sm mb-1",children:" New Version Available!"}),jsxRuntimeExports.jsx("p",{className:"text-amber-50 text-xs mb-3",children:"A new version of PWANS is ready. Reload to get the latest features and improvements."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:u,disabled:r,className:"flex-1 bg-white hover:bg-amber-50 text-amber-600 font-bold py-2 px-4 rounded-lg transition-colors text-sm flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[jsxRuntimeExports.jsx(RefreshCw,{className:`w-4 h-4 ${r?"animate-spin":""}`}),r?"Updating...":"Reload Now"]}),jsxRuntimeExports.jsx("button",{onClick:f,disabled:r,className:"bg-white/10 hover:bg-white/20 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Dismiss",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})]})]})]})})}):null};function promisifyRequest(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function createStore(e,t){let r;const n=()=>{if(r)return r;const o=indexedDB.open(e);return o.onupgradeneeded=()=>o.result.createObjectStore(t),r=promisifyRequest(o),r.then(a=>{a.onclose=()=>r=void 0},()=>{}),r};return(o,a)=>n().then(l=>a(l.transaction(t,o).objectStore(t)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get(e,t=defaultGetStore()){return t("readonly",r=>promisifyRequest(r.get(e)))}function set(e,t,r=defaultGetStore()){return r("readwrite",n=>(n.put(t,e),promisifyRequest(n.transaction)))}function del(e,t=defaultGetStore()){return t("readwrite",r=>(r.delete(e),promisifyRequest(r.transaction)))}function App(){const{isUnlocked:e}=useAuthStore(),[t,r]=reactExports.useState(!1),[n,o]=reactExports.useState(!0);reactExports.useEffect(()=>{(async()=>{try{if(await get("disclaimer_accepted")){o(!1);return}const f=await get("wallet-storage");if(f)try{const x=JSON.parse(f);if(x.state&&x.state.wallets&&x.state.wallets.length>0){await set("disclaimer_accepted","true"),o(!1);return}}catch(x){console.error("Failed to parse wallet storage:",x)}r(!0)}catch(u){console.error("Error checking disclaimer status:",u)}finally{o(!1)}})()},[]);const a=async()=>{await set("disclaimer_accepted","true"),r(!1)};return n?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-8 h-8 text-amber-500 animate-spin"})}):t?jsxRuntimeExports.jsx(DisclaimerModal,{onAgree:a}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[e?jsxRuntimeExports.jsx(Dashboard,{}):jsxRuntimeExports.jsx(Login,{}),jsxRuntimeExports.jsx(UpdatePrompt,{})]})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));export{Buffer as B,getDefaultExportFromCjs$1 as a,del as d,get as g,process$1 as p,set as s};
