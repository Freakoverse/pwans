import{N as p,b as f,c as h,e as d}from"./index-S3E_MV6F.js";const N=["wss://relay.damus.io","wss://nos.lol","wss://relay.nostr.band","wss://relay.primal.net","wss://relay.snort.social"];async function m(u,g,l,i,y,s=3){console.log(`ðŸ“¡ Publishing NutZap for ${l} sats to ${i.substring(0,16)}...`);for(let e=1;e<=s;e++)try{console.log(`ðŸ”„ Attempt ${e}/${s}...`);const t=p.createNutZapEvent(u,g,l,i),o=new f(y),r=new h({explicitRelayUrls:N,signer:o});console.log("ðŸ”Œ Connecting to relays..."),await r.connect(2e3),console.log("âœï¸ Signing event...");const n=new d(r,t);await n.sign(),console.log(`ðŸ“ Event signed, ID: ${n.id}`),console.log("ðŸ“¤ Publishing to relays...");const a=await n.publish();if(a.size>0)return console.log(`âœ… Success! Published to ${a.size} relays on attempt ${e}`),{success:!0,relayCount:a.size};{if(console.warn(`âš ï¸ Attempt ${e} failed: No relays accepted the event`),e===s)return{success:!1,relayCount:0,error:"No relays accepted the NutZap after all retry attempts"};const c=Math.pow(2,e)*1e3;console.log(`â³ Waiting ${c}ms before retry...`),await new Promise(w=>setTimeout(w,c))}}catch(t){if(console.error(`âŒ Attempt ${e} error:`,t),e===s)return{success:!1,relayCount:0,error:t.message||"Unknown error during NutZap publish"};const o=Math.pow(2,e)*1e3;console.log(`â³ Waiting ${o}ms before retry...`),await new Promise(r=>setTimeout(r,o))}return{success:!1,relayCount:0,error:"Max retry attempts reached"}}export{m as publishNutZapWithRetry};
